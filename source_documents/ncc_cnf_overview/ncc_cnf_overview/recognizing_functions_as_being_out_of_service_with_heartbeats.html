<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Recognizing subsystems as being out of service with heartbeats" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="Bookmark51" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Recognizing subsystems as being out of service with heartbeats</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="Bookmark51">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Recognizing subsystems as being out of service with heartbeats</h1>
<div class="body conbody">
    <p class="p">NCC heartbeats communicate and sometimes determine the <code class="ph codeph">In Service/Out Of
        Service</code> state of each NCC subsystem. Heartbeats are actually requests from a given
      NCC subsystem to each of the other NCC subsystems.</p>

    <p class="p">NCC communicates between subsystems with both HTTP and Diameter networks. A healthy subsystem
      must be reachable over both networks. Heartbeats are sent over both networks to validate
      both.</p>

    <p class="p">The heartbeat component runs on the Central Management pod and controls all heartbeat queries
      from an NCC. It sends HTTP heartbeat requests over the OA&amp;M network directly and sends a
      message to a Kafka work queue for a Charging pod to send a Heartbeat request over Diameter via
      the IOHD pod.</p>

    <p class="p">On the receiving end, the Heartbeat component answers HTTP heartbeat requests received via
      API, then Istio ingress controller. The Charging pod receives the request via TCP ingress and
      uses a REST API to get the heartbeat response from the Heartbeat component. If the
      active/standby heartbeat component is down, the Charging pod answers autonomously with an OOS
      status.</p>

    <p class="p">With two-second heartbeats, an NCC subsystem that declares itself OOS due to an internal
      vital service outage with be known quickly by its mate. However, it may take 5-10 seconds for
      an NCC to determine a vital service is down.</p>

    <p class="p">An NCC subsystem that fails completely or both OA&amp;M network and traffic network heartbeat
      requests fail three consecutive tries (could be blocked by an load balancer failure) is marked
      OOS in under eight seconds.</p>

    <p class="p">In this diagram, NCC subsystem A is performing a heartbeat to NCC subsystem B. To clarify
      what is happening, only one direction is shown. A real deployment would also have subsystem B
      performing the same heartbeat to subsystem A.</p>

    <div class="fig fignone">
      <img class="image break" src="../images/resil_img_10.png" />
    </div>

  </div>
<div class="footer"><hr /><p>Overview Guide • P556766-DN1000054925-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>