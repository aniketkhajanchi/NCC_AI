<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Rule" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="id9YZ-09018-UG00-PCZZA-d1e14978" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Rule</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="id9YZ-09018-UG00-PCZZA-d1e14978">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Rule </h1>
<div class="body conbody">
<div class="section"><p class="p">A Rule is a row in the Rule Group that is comprised of a set of Rule Conditions and a
                set of Rule Actions. You decide how the AVPs received in the incoming request will
                influence the call flow by developing customized Rule logic. The rule has a
                precedence that determines its unique order in the rule group evaluation. Rules will
                be executed if and only if all of its conditions are met. The results sent to the
                invoking module, if all the conditions are met, contain a list of actions (“things
                to do”) to be executed by the application module.</p>
 A Rule is made up of an
            optional set of logical conditions (criteria attributes) and a set of attribute results
            (action attributes) constructed as If-Then statements. If no conditions are provided,
            then the results are included. If there are one or more conditions then the results will
            only be included if the Rule evaluates to true. For example, you can create a rule that
            says if the subscriber's category is gold, then send a notification. If the subscribers
            category is not gold, the notification will not be sent. <p class="p">The rule expression is as
                follows:</p>

            <kbd class="ph userinput">if (condition(s)) then (action(s))</kbd>
            <p class="p">The following is an example of a rule written for NCC:</p>

            <kbd class="ph userinput">if GY_MESSAGE.Service-Context-Id = 32274@3gpp.org</kbd>
            <kbd class="ph userinput">then CALL_RESULT.Default-Roaming-Decision=RoamingDecision HOME </kbd>
            <p class="p">A Rule can use attributes provided to the trigger to make its conditions and use
                those values to build the results. Multiple conditions in the rule can be combined
                with either “and” or “or” logical operators. Multiple actions are separated by the
                “and’ logical operator.</p>
When evaluating the Rule, only the conditions specified
            in the Rule instance are considered by the rule engine (for example, any unfilled
            attributes from the Rule Group Definition are considered to be matched/wild-carded).
            When a Rule is invoked, all of its actions are taken together as a whole. The first
            matched Rule from the table whose conditions have been met is executed. After that Rule
            Group evaluation terminates, the next Rule Group belonging to a trigger is evaluated.
                <p class="p">The attributes are provided in a Source Context. The results of a Rule are put
                into a Result Context.</p>
<p class="p"><strong class="ph b">Value type restrictions in this
                release</strong></p>
<p class="p">Certain restrictions on the use of binary arrays apply in this
                release. You must use hexidecimal string in the rule if the AVP is OctectString,
                Date Time, or Address value type. At this time NCC does not decode attributes
                containing binary arrays; therefore, you cannot reference the decoded value in a
                rule condition. Instead, you must reference the encoded value using a specific
                syntax. </p>
<p class="p">For the supported Long and Double value types, the value(s) must be
                parsible as required in the following:</p>
<ul class="ul" id="id9YZ-09018-UG00-PCZZA-d1e14978__ul_tjt_5nb_bnb">
                <li class="li">
                    <p class="p">https://docs.oracle.com/javase/7/docs/api/java/lang/Long.html#parseLong(java.lang.String)</p>

                </li>

                <li class="li">
                    <p class="p">https://docs.oracle.com/javase/7/docs/api/java/lang/Double.html#valueOf(java.lang.String)</p>

                </li>

            </ul>
<p class="p">See the following examples for using an AVP with octet string value types and
                Date Time value types:</p>
<div class="sectiondiv">
                <p class="p"><strong class="ph b">Examples of OctetString usage for ValueTypes in AVPs in rule
                    conditions</strong></p>

                <p class="p">
                    <strong class="ph b">Example 1</strong>
                </p>

                <p class="p">To apply an action when the 3GPP-RAT-Type equals EUTRAN. The encoded value for
                    EUTRAN is 0x06; therefore, you must construct a rule condition referencing the
                    encoded value using the following syntax:</p>

                <ul class="ul">
                    <li class="li">
                        <p class="p">GyCCR.Service-Information.PS-Information.3GPP-RAT-Type = \06</p>

                        <p class="p">where: the criteria are &lt;source context&gt; GyCCR and &lt;attribute
                            name&gt; Service-Information.PS-Information.3GPP-RAT-Type</p>

                        <p class="p">the Operator is Equal</p>

                        <p class="p">
                            <strong class="ph b">Value that is of type STRING (OctetString in 3GPP standard) and a
                                value of \06</strong>
                        </p>

                        <p class="p">\06 = EUTRAN</p>

                    </li>

                </ul>

                <p class="p">
                    <strong class="ph b">Example 2 </strong>
                </p>

                <p class="p">To apply an action when 3GPP-Charging-Id equals 1234. The encoded value for 1234
                    is 0x000004D2; therefore, you must construct a rule condition referencing the
                    encoded value using the following syntax:</p>

                <ul class="ul">
                    <li class="li">
                        <p class="p">GyCCR.Service-Information.PS-Information.PS-Furnish-Charging-Information.3GPP-Charging-Id
                            = \00\00\04\D2</p>

                        <p class="p">where: the criteria are &lt;source context&gt; GyCCR and &lt;attribute
                            name&gt;
                            Service-Information.PS-Information.PS-Furnish-Charging-Information.3GPP-Charging-Id</p>

                        <p class="p">the Operator is Equal</p>

                        <p class="p">
                            <strong class="ph b">Value that is of type STRING (OctetString in 3GPP standard) and a
                                value of \00\00\04\D2</strong>
                        </p>

                        <p class="p">\00\00\04\D2 = 1234</p>

                    </li>

                </ul>

            </div><div class="sectiondiv">
                <p class="p"><strong class="ph b">Example of Date Time usage for ValueTypes in AVPs in rule conditions</strong></p>

                <p class="p">NCC decodes “Date Time” attributes by evaluating the date and time based on the
                    number of milliseconds since 1/1/1970 rather than the number of seconds since
                    1\1\1900 as is encoded in the value.</p>

                <p class="p">To apply an action when User-Location-Info-Time equals Feb 7, 2017 5:25:28 PM.
                    The encoded value for Feb 7, 2017 5:25:28 PM is DC44C7D8; therefore, the user
                    must construct a rule condition referencing the encoded value converted to
                    milliseconds since 1\1\1970.</p>

                <ul class="ul">
                    <li class="li">
                        <p class="p">GyCCR.Service-Information.PS-Information.User-Location-Info-Time =
                            1486506328000</p>

                        <p class="p">where: the criteria are &lt;source context&gt; GyCCR and &lt;attribute
                            name&gt; Service-Information.PS-Information.User-Location-Info-Time</p>

                        <p class="p">the Operator is Equal</p>

                        <p class="p">
                            <strong class="ph b">Value that is of type LONG or BIGINTEGER (Date Time in 3GPP standard)
                                and a value of 1486506328000</strong>
                        </p>

                        <p class="p">The value is derived as follows:</p>

                        <p class="p">User-Location-Info-Time =  Feb 7, 2017 5:25:28 PM = 3695495128 (seconds
                            since 1\1\1900) = DC44C7D8</p>

                        <p class="p">Seconds from 1\1\1900 to 1\1\1970 = 2208988800</p>

                        <p class="p">Seconds from 1\1\1970 to Feb 7, 2017 5:25:28 PM = 3695495128 – 2208988800
                            = 1486506328</p>

                        <p class="p">Milliseconds from 1\1\1970 to Feb 7, 2017 5:25:28 PM = 1486506328000</p>

                    </li>

                </ul>

            </div>
        </div>

</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>