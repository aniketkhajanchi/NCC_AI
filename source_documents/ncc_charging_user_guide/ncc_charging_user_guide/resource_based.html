<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Resource-based notifications" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="id9yz-09126-ug01-pczza-sp1-d1e211819" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Resource-based notifications</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="id9yz-09126-ug01-pczza-sp1-d1e211819">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Resource-based notifications</h1>
<div class="body conbody">
<div class="section">
<p class="p">NCC allows operators to send notifications based on resource usage. The
                    <samp class="ph systemoutput">Send-Notification</samp> action is supported for resource
                based counters. </p>

</div>

<div class="section"><h2 class="title sectiontitle">BUCKET source context</h2>
<p class="p">The following BUCKET source context can be used to select the algorithm to be used for the call.</p>

<table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>BUCKET source context</span></caption><colgroup><col style="width:36.496350364963504%" /><col style="width:63.503649635036496%" /></colgroup><thead class="thead" style="text-align:left;">
                        <tr class="row">
                            <th class="entry cellrowborder" style="vertical-align:top;" id="d57165e56">Attribute name</th>

                            <th class="entry cellrowborder" style="vertical-align:top;" id="d57165e59">Description</th>

                        </tr>

                    </thead>
<tbody class="tbody">
                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e56 "> Bucket-Current-Charging-Step</td>

                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e59 "> The current step if it is a step charge bucket.
                           </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e56 "> Bucket-Name</td>

                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e59 "> The name of the bucket which is being used while
                                rating a call.</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e56 "> Bucket-Unit-Type</td>

                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e59 "> The unit type of bucket such as TIME, MONEY,
                                VOLUME, UNIT.</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e56 "> Bundle-Name</td>

                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e59 "> The name of the bundle which is being used while
                                rating a call.</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e56 "> Regular-Current-Value</td>

                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e59 ">
                                <p class="p">The regular bucket current value before reservation. It is of
                                    type Big decimal.</p>

                                <p class="p">The rules does not support operations between Big decimal and
                                    other types such as integer, long.</p>

                                <p class="p">Equal operation is not supported between Big decimal types. Only
                                    &gt;, &lt;. &gt;=, &lt;= are supported.</p>

                                <p class="p">The following rules can result in failure:</p>

                                <p class="p">
                                    <kbd class="ph userinput">Rule 1: DYNAMIC_SLICE.Slice-Size =
                                        Bucket.Regular-Current-Value</kbd> Here, slice size is
                                    of type Long.</p>

                                <p class="p">
                                    <kbd class="ph userinput">Rule 2 : if Bucket.Regular-Current-Value =
                                        1000</kbd>
                                </p>

                           </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e56 "> Total-Current-Value</td>

                            <td class="entry cellrowborder" style="vertical-align:bottom;" headers="d57165e59 ">
                                <p class="p">The sum of regular bucket current value and it's carryover
                                    current value before reservation. It is of type Big decimal.</p>

                                <p class="p">The rules does not support operations between Big decimal and
                                    other types such as integer, long.</p>

                                <p class="p">Equal operation is not supported between Big decimal types. Only
                                    &gt;, &lt;. &gt;=, &lt;= are supported.</p>

                                <p class="p">The following rules can result in failure:</p>

                                <p class="p">
                                    <kbd class="ph userinput">Rule 1: DYNAMIC_SLICE.Slice-Size =
                                        Bucket.Total-Current-Value</kbd> Here, slice size is
                                    of type Long.</p>

                                <p class="p">
                                    <kbd class="ph userinput">Rule 2 : if Bucket.Total-Current-Value =
                                        1000</kbd>
                                </p>

                           </td>

                        </tr>

                    </tbody>
</table>

</div>

<div class="section"><h2 class="title sectiontitle">Additional information</h2><ul class="ul">
<li class="li">
<p class="p">If a bundle is added or removed, then the configuration of sending RAR must be done by operators.</p>

</li>

<li class="li">
<p class="p">The carryover buckets are excluded from the BUCKET source context. The rules applicable to normal bucket are applicable to carryover buckets as well.</p>

</li>

</ul>

</div>

<div class="section"><h2 class="title sectiontitle">Examples</h2>
<div class="sectiondiv">
<p class="p"><strong class="ph b">Example 1: Toggle speed based on data in XML notification </strong></p>

<p class="p">Consider that a group has a device attached to it. Group has subscribed to unlimited bundles which can be used by devices linked to it. Device has its own bundle. Operators can toggle the QoS based on data received in notification. Once the device bundle is used up completely and there are no more resources available for the call, then unlimited bundles are used for the call. In this case, operators can throttle the speed to LOW. If another bundle becomes active (either by subscription renewal or a new subscription), the speed is set to HIGH. The toggling of speed can be maintained in a custom data of device or can be managed using rules. Once a notification is sent, custom data of device is updated. The bundle usage can be tracked using the resource based counters. Operators can select different slicing algorithm based on the bucket used for the call. That is, select dynamic algorithm for normal buckets and static algorithm for step-buckets.</p>

<p class="p">Configure the following entities:</p>
<ol class="ol">
<li class="li">
<p class="p">Create a custom data for Device <span class="ph uicontrol">IMSI-Throttling</span> with HIGH as default value. Attach this custom data to the Device.</p>

</li>

<li class="li">
<p class="p">Create charging services (<var class="keyword varname">CS1</var> and <var class="keyword varname">CS2</var>) for unlimited
                            bundles to be used for the complex map.</p>

</li>

<li class="li"><p class="p">Create a complex map (<var class="keyword varname">CS-Reserve</var>) to be used in threshold rules.</p>

                        
                        <a href="../images/img9yz-09126-ug01-pczza-sp1-complex_map_default.png" class="image"><img class="image scalefit" src="../images/img9yz-09126-ug01-pczza-sp1-complex_map_default.png" height="144" width="678" /></a>
                    </li>

<li class="li">
<p class="p">Create a resource based counter and attach it to the Device. Ensure to select <span class="ph uicontrol">Resource Based</span> when you create a counter. Note that, based on your requirement you can attach the resource based counter to a Device or Group. </p>

</li>

<li class="li">
<p class="p">Create a Notification Profile that contains the notification text to be sent. In the current case, you can configure the notification content as follows:</p>

<p class="p">
<samp class="ph systemoutput">Device-ID=$[DEVICEID],GROUP-ID=$[GROUPID],IMSI=$[IMSI],E164=$[MSISDN],Throttling-Status=$[IMSI_Throttling_Status]</samp>
</p>

</li>

<li class="li"><p class="p">Configure a rule in Threshold to send notification for HIGH or LOW speed as follows:</p>

                        
                        <a href="../images/img9yz-09126-ug01-pczza-sp1-threshold_default.png" class="image"><img class="image scalefit" src="../images/img9yz-09126-ug01-pczza-sp1-threshold_default.png" height="230" width="567" /></a>
                    </li>

<li class="li"><p class="p">Configure the quota management (slicing profile) as follows to select dynamic or
                            static algorithm based on whether normal or step-bucket is used for the
                            call. For carryover bucket, rules applied for normal bucket are
                            applicable.</p>

                        
                        <a href="../images/img9yz-09126-ug01-pczza-sp1-slicing_algo_default.png" class="image"><img class="image scalefit" src="../images/img9yz-09126-ug01-pczza-sp1-slicing_algo_default.png" height="174" width="407" /></a>
                    </li>

</ol>

</div>
<div class="sectiondiv">
<p class="p"><strong class="ph b">Example 2: Multiple scenarios</strong></p>

<p class="p">Consider that a device is configured with a custom data and has the following subscriptions:</p>
<ul class="ul">
<li class="li">
<p class="p">Unlimited Bundle <var class="keyword varname">B1 BOU</var> with two charging services, having a bucket in
                                <var class="keyword varname">CS1</var> in pass 0 and a free rate in
                                <var class="keyword varname">CS2</var> in pass 1.</p>

</li>

<li class="li">
<p class="p">Bundle <var class="keyword varname">B2 non-BOU</var> having buckets in pass 0.</p>

</li>

<li class="li">
<p class="p">Default bundle <var class="keyword varname">B3 non-BOU</var> having step-bucket in pass 1.</p>

</li>

</ul>

<p class="p">The initial quota management (slicing profile) algorithm configuration is Dynamic slicing
                    algorithm.</p>

<p class="p">
                    <span class="ph uicontrol">Scenario 1: </span>The unlimited Bundle <var class="keyword varname">B1
                        BOU</var> with bucket available is applicable and active. The custom
                    data of device is initially set to false, indicating that speed is HIGH.
                    Subscriber consumes from Bundle <var class="keyword varname">B1</var> and custom data is not
                    changed and throttling notification is not sent.</p>

<p class="p">
                    <span class="ph uicontrol">Scenario 2: </span>The unlimited Bundle <var class="keyword varname">B1
                        BOU</var> with no buckets available and not applicable. Subscriber
                    consumes from Bundle <var class="keyword varname">B2</var>, so custom data is not changed and
                    throttling notification is not sent.</p>

<p class="p">
                    <span class="ph uicontrol">Scenario 3: </span>The unlimited Bundle <var class="keyword varname">B1
                        BOU</var> with no bucket available is applicable and active. There is no
                    other resource available. The custom data of Device is initially set to false,
                    indicating that speed is <var class="keyword varname">HIGH</var>. Subscriber consumes from
                    Bundle <var class="keyword varname">B1</var> as free rate form pass 1. The custom data is
                    changed to True and throttling notification is sent. If a subscriber reports
                    another consumption from <var class="keyword varname">B1</var>, then the custom data is not
                    changed as its already True and notification is not sent.</p>

<p class="p">
                    <span class="ph uicontrol">Scenario 4: </span>The unlimited Bundle <var class="keyword varname">B1</var> is
                    not applicable and there is no other resource available in pass 0. The custom
                    data of device is True. On consumption, default bundle <var class="keyword varname">B3</var> is
                    used and the value of custom data is changed to false and throttling
                    notification is sent. Since <var class="keyword varname">B3</var> is configured with
                    step-bucket, static algorithm is used instead of dynamic algorithm.</p>

<p class="p">
                    <span class="ph uicontrol">Scenario 5: </span>The unlimited Bundle <var class="keyword varname">B1
                        BOU</var> with no bucket available is applicable but expires. There is
                    no other resource available. The custom data of device is True. On consumption,
                    the default bundle <var class="keyword varname">B3</var> is used and the value of custom data is
                    changed to false and throttling notification is sent. Since
                        <var class="keyword varname">B3</var> is configured with step-bucket, static algorithm is
                    used instead of dynamic algorithm.</p>

</div>
</div>

</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>