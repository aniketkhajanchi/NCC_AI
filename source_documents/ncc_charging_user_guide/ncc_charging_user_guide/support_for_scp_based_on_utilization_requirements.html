<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Support for SCP" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="support_for_scp_based_on_utilization_requirements" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Support for SCP</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="support_for_scp_based_on_utilization_requirements">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Support for SCP</h1>
<div class="body conbody">
        <div class="section" id="support_for_scp_based_on_utilization_requirements__section_dkn_dnq_vnb">
            <p class="p">This feature is required in SCP (or Service Communication Proxy) integration and
                resolution of FQDN and addresses for SMF and PCF, which may have retry
                scenarios.</p>

            <p class="p">An SCP is a server that resides between 5G NF to allow routing of messages into the
                respective service meshes that exist within each Containerized Network Function.</p>

            <p class="p">The SCP management falls under the following major areas:</p>

            <ol class="ol" id="support_for_scp_based_on_utilization_requirements__ol_eyb_3nq_vnb">
                <li class="li">
                    <p class="p">Define an SCP address (which is a virtual FQDN address) that can be used to
                        store the SCP location in a way used for processing.</p>

                </li>

                <li class="li">
                    <p class="p">Process and store the callback URI based on the values received, and use the
                        FQDN resolution to determine the actual address to use in messages, whereas,
                        the paired value is used in failed scenarios.</p>

                </li>

                <li class="li">
                    <p class="p">Process responses and notify messages and population of the content of the
                        Location Header based on the addresses managed in the previous two
                        points.</p>

                </li>

            </ol>

            <p class="p">The DNS based resolution of FQDNs for 5G functions is configured with the following
                parameters in the Helm chart:</p>

            <ul class="ul" id="support_for_scp_based_on_utilization_requirements__ul_dhf_fmx_vnb">
                <li class="li">
                    <p class="p"><em class="ph i">charging.enableVfqdnResolution</em></p>

                </li>

                <li class="li">
                    <p class="p"><em class="ph i">charging.destinationRecoveryRetryTimeoutMs</em></p>

                </li>

                <li class="li">
                    <p class="p"><em class="ph i">charging.reqTrackWndSizeForDNS</em></p>

                </li>

                <li class="li">
                    <p class="p"><em class="ph i">charging.accFailRateForDNS</em></p>

                </li>

            </ul>

            <p class="p">The parameters are described within the Helm chart in the Readme file. To enable the
                DNS based resolution of FQDNs for 5G functions, configure the parameters in the
                    <em class="ph i">values.yaml</em>. You can configure the parameters during installation when
                you prepare the input for the Helm charts or after you installed CNF NCC using helm
                upgrade command.</p>

            <p class="p">By default, the feature is disabled.</p>

        </div>

    </div>
<div class="topic concept nested1" aria-labelledby="ariaid-title2" id="concept_es3_kml_r4b"><h2 class="title topictitle2" id="ariaid-title2">Configuration</h2>
<div class="body conbody">
            <div class="section" id="concept_es3_kml_r4b__section_cps_pnq_vnb">
                <p class="p">To configure this feature, enable the following two application preferences
                    available at ME and CHF router level to store the SCP address network
                    function:</p>

                <ul class="ul" id="concept_es3_kml_r4b__ul_lv2_lnq_vnb">
                    <li class="li">
                        <p class="p"><strong class="ph b">SMF SCP</strong>: This application preference holds the SCP address for
                            notify requests towards SMF.</p>

                    </li>

                    <li class="li">
                        <p class="p"><strong class="ph b">PCF SCP</strong>: This application preference holds the SCP address for
                            notify requests towards PCF.</p>

                    </li>

                </ul>

                <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Real SCP is configured with its complete URL (including scheme, authority, and
                    port). The virtual SCP is configured with scheme and vFqdn. It is suggested to
                    configure scheme as Http on CNF based setup.</div>

            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title3" id="concept_vyf_jml_r4b"><h2 class="title topictitle2" id="ariaid-title3">Additional information</h2>
<div class="body conbody">
            <div class="section" id="concept_vyf_jml_r4b__section_kbd_f4q_vnb">
                <p class="p">Following are some important points to note for this functionality:</p>

                <ul class="ul" id="concept_vyf_jml_r4b__ul_pq4_44q_vnb">
                    <li class="li">
                        <p class="p">If CHF router is configured, then SCP selection is done by reading the
                            application preference at CHF router; otherwise, it is done at ME. This
                            is done to facilitate router-wise selection of SCP.</p>

                    </li>

                    <li class="li">
                        <p class="p">While sending request from ME to CHF router, the Network Function and
                            Session Id is set in header attributes.</p>

                    </li>

                    <li class="li">
                        <p class="p">The Network Function header attribute indicates the CHF router which
                            application preference is to be read for sending the request to the
                            corresponding Network Function.</p>

                    </li>

                    <li class="li">
                        <p class="p">Session Id is passed to CHF router to specify in logs.</p>

                    </li>

                    <li class="li">
                        <p class="p">The <strong class="ph b">hostURI</strong> header attribute received at CHF router contains the
                                <em class="ph i">NotifURI</em>, which extracts the <em class="ph i">Notif URI</em> authority and
                            set in <strong class="ph b">3GPP-SBI-Target_APIRoot</strong> header attribute.</p>

                    </li>

                    <li class="li">
                        <p class="p">The request is then sent by router to the SCP (which is, <span class="keyword cmdname">SCP
                                Authority + Notif URI path</span>).</p>

                    </li>

                </ul>

                <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Irrespective of main call or retry calls, only the above selected attributes
                    are considered. The final values of <em class="ph i">Notif URI</em> (as per retry count) and
                    CHF router (as per retry count) are not impacted by this feature.</div>

            </div>

        </div>
</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>