<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="NCC Charging Gateway Function (CGF [DR]) and CDRs" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="charging_gateway_function" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>NCC Charging Gateway Function (CGF [DR]) and CDRs</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="charging_gateway_function">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">NCC Charging Gateway Function (CGF [DR]) and CDRs</h1>
<div class="body conbody">
        <p class="p">The Charging Gateway Function (CGF [DR]) manages all of the CDRs in NCC. The charging
            application creates CDR requests and places them into a Kafka queue. The CGF (DR) reads
            the Kafka queue, creates the resulting CDRs per its configured options, and writes the
            CDRs to files and/or streams them into the operator’s own Kafka queue. In addition, this
            set of microservices manages features that include rerating, late rating, and assume
            positive. This figure shows a functional view of NCC CGF.</p>

        <div class="fig fignone" id="charging_gateway_function__fig_phg_pqk_znb"><span class="figcap"><span class="fig--title-label">Figure: </span>NCC Charging Gateway Function</span>
            
            <img class="image break" id="charging_gateway_function__image_qhg_pqk_znb" src="images/cnf_overview_CDR_diagram_21_0.GIF" height="414" width="462" />
        </div>

        <div class="section" id="charging_gateway_function__section_k35_psc_llb"><h2 class="title sectiontitle">CDRs</h2>
            
            <p class="p">NCC includes CGF (DR) microservices from Nokia CGF (DR) to provide CDR handling and
                mediation features, creating CDR files that can be retrieved by external systems
                using SFTP, or streamed out via a Kafka bus. CGF (DR) provides the flexibility and
                configurability that NCC customers require relative to CDR handling.</p>

            <p class="p">NCC applications create CDR input content and enqueues it in Kafka for consumption by
                the CDR microservice. Kafka enables robust queuing and failure handling to ensure
                that CDR content is not lost, even in the midst of various failure scenarios.</p>

            <p class="p">To process CDRs received over Kafka, CGF (DR) uses three pod types for the CGF (DR)
                streams. Each pod type is used for a specific CGF (DR) stream. The first pod type is
                used for collecting data from Kafka (Kafka input stream). The second pod type is
                used for transforming data into required format (Business logic stream). The third
                pod type is used for creating the actual CDR files (Output streams). Each pod type
                is separately scalable, and N number of these pods provide horizontal scalability.
                Redis database is used as a temporary storage between the CGF (DR) streams.</p>

            <p class="p">The Kafka input stream and the Business logic stream each have one node, whereas the
                output streams have three nodes: collector node, ASN.1 encoder node and distributor
                node. Currently the interface between the nodes in the output streams is file-based.
                The goal is to replace it with a cloud-native interface. However, if the file-based
                interface is still used, the nodes in the output streams must run in a single
                container to continue to use the file-based interface. In addition to stream
                processing, every pod runs a Node Manager that manages CGF (DR) nodes in a CGF (DR)
                stream, while Kubernetes manages the set of pods.</p>

            <p class="p">CGF (DR) provides a UI to manage the configuration parameters among other things by
                directly managing data that is stored in MariaDB. The UI includes only the subset
                necessary for online CDR processing, directly managing data in MariaDB. That portion
                of the CGF (DR) UI is a foundation for expanded functionality as required by other
                features in Convergent Charging. The CGF (DR) UI container uses a singleton pod.
                Given that the UI is lightly used, it is sufficient to have a brief gap in
                availability if Kubernetes has to replace the pod, including for a software
                update.</p>

            <p class="p">This figure shows how CDRs are processed in NCC.</p>

            <div class="fig fignone" id="charging_gateway_function__fig_ajr_ykz_cmb"><span class="figcap"><span class="fig--title-label">Figure: </span>CDR charging</span>
                
                <img class="image imagecenter break" id="charging_gateway_function__image_bjr_ykz_cmb" src="images/cnf_overview_CDR-processing.GIF" height="140" width="554" />
            </div>

        </div>

    </div>
<div class="footer"><hr /><p>Overview Guide • P556766-DN1000054925-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>