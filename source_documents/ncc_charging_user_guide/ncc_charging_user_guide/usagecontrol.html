<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Usage control functionality" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="id9yz-09126-ug01-pczza-sp1-usagecontrol" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Usage control functionality</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="id9yz-09126-ug01-pczza-sp1-usagecontrol">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Usage control functionality</h1>
<div class="body conbody">
<div class="section">
<p class="p">The Usage Control (UC) functionality allows a user to restrict the usage using different configurations. These user-level restrictions include the usage control over consumption of various kinds of unit, such as time, volume, unit, or money.</p>

<p class="p">A user controls the UC restrictions based on the <em class="ph i">Time of day</em> functionality.</p>

<p class="p">Following sections explain the usage control functionality in detail:</p>
<ul class="ul">
<li class="li">
<p class="p"><a class="xref" href="#Emergency">Emergency conditions</a></p>

</li>

<li class="li">
<p class="p"><a class="xref" href="#Globallist">Global Barred List, Allowed List, Always Allowed APN, and Always Allowed RG</a></p>

</li>

<li class="li">
<p class="p"><a class="xref" href="#UCservice">Usage control entity</a></p>

</li>

</ul>

</div>

</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title2" id="concept_nt2_cpl_r4b"><h2 class="title topictitle2" id="ariaid-title2">Configuration</h2>
<div class="body conbody">
            <div class="section" id="concept_nt2_cpl_r4b__section_yps_cpl_r4b">
                <p class="p">UC is designed as a new service type, similar to charging services. When a
                    charging service is created, one or more UC services are included either in the
                    same bundle as the charging service corresponding to the traffic (for example,
                    data, voice, or video) controlled by the UC service, or it is included a
                    separate UC bundle covering the traffic limits for one or more charging
                    services.</p>

                <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Each UC service covers only one or more traffic types.</div>

                <p class="p">Once subscribed, the UC subscription is managed using SM GUI or API interface to
                    set, modify, or remove the following:</p>

                <ul class="ul" id="concept_nt2_cpl_r4b__ul_zps_cpl_r4b">
                    <li class="li">
                        <p class="p">Allowed and barred lists (for calls, messages, and incoming and outgoing
                            traffic)</p>

                    </li>

                    <li class="li">
                        <p class="p">For each traffic type covered by the usage control service:</p>

                        <ul class="ul" id="concept_nt2_cpl_r4b__ul_aqs_cpl_r4b">
                            <li class="li">
                                <p class="p">Time of day limitations</p>

                            </li>

                            <li class="li">
                                <p class="p">Usage limitations</p>

                            </li>

                        </ul>

                    </li>

                </ul>

                <p class="p">Apart from the UC service subscription-level settings, some global UC settings
                    and rules are also defined for globally allowed or barred list, allowed rating
                    groups and APNs, and day types definition. These settings are a part of the
                        <span class="ph uicontrol">Global Configuration</span> tab under the
                        <span class="ph uicontrol">CHARGING</span> section in the SM GUI.</p>

            </div>

            <div class="section" id="concept_nt2_cpl_r4b__section_ghr_dpl_r4b"><h3 class="title sectiontitle">UC service inclusion in bundle</h3>
                
                <p class="p">The UC services linked to an existing charging service bundles covers the traffic
                    types handled by the related charging service or the UC services are linked to a
                    specific bundle covering one or more traffic types.</p>

                <p class="p">The service providers follow one of the given options while defining the services
                    offered by the UC feature to avoid unwanted or unexpected results and improve
                    business performance:</p>

                <ul class="ul" id="concept_nt2_cpl_r4b__ul_bqs_cpl_r4b">
                    <li class="li">
                        <p class="p">Define a single UC service, which includes all potential traffic types
                            (or limits) subjected to UC.</p>

                        <p class="p">For example, one limit for calls, one limit for messages, and one limit
                            for data.</p>

                        <div class="p">
                            <div class="note" id="concept_nt2_cpl_r4b__note_r3d_qgx_p5b"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> This UC service must be included only in a
                                UC bundle that can be subscribed separately from the charging
                                service bundles.</div>

                        </div>

                    </li>

                    <li class="li">
                        <p class="p">Define <var class="keyword varname">N</var> number of UC services, which implies one UC
                            service per traffic type. Each UC service is included in the existing
                            related charging service bundle that handles related traffic type.</p>

                    </li>

                </ul>

            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title3" id="Emergency"><h2 class="title topictitle2" id="ariaid-title3">Emergency conditions</h2>
<div class="body conbody">
            <div class="section">
                <p class="p">The emergency rules evaluate the state of emergency traffic for the incoming
                    calls. Once the emergency scenario starts, it allows the calls of different
                    tariff types based on the priority of the emergency level to skip the following
                    restrictions:</p>

                <ul class="ul" id="Emergency__ul_f2s_v4l_r4b">
                    <li class="li">
                        <p class="p">Barring at global level</p>

                    </li>

                    <li class="li">
                        <p class="p">Barring at UC level</p>

                    </li>

                    <li class="li">
                        <p class="p">Restrictions imposed by UC limits and time of day</p>

                    </li>

                </ul>

                <p class="p">During an ongoing emergency scenario, the counters as configured in the UC
                    configuration are incremented even though UC checks are skipped until the
                    emergency scenario is uplifted.</p>

                <p class="p">The emergency functionality in UC facilitates the creation of RSV based rules,
                    which allow the user to declare the emergency scenario for a device and perform
                    the following actions:</p>

                <ul class="ul" id="Emergency__ul_g2s_v4l_r4b">
                    <li class="li">
                        <p class="p">Declaring the emergency scenario for a time period specified in the RSV
                            based rule.</p>

                    </li>

                    <li class="li">
                        <p class="p">Defining the level of emergency in the rule. Following types of emergency
                            options are available to the user:</p>

                        <ul class="ul" id="Emergency__ul_h2s_v4l_r4b">
                            <li class="li">
                                <p class="p">All</p>

                            </li>

                            <li class="li">
                                <p class="p">Data, voice-video, or eCommerce</p>

                            </li>

                            <li class="li">
                                <p class="p">Data, or voice-video</p>

                            </li>

                            <li class="li">
                                <p class="p">Voice-video</p>

                            </li>

                            <li class="li">
                                <p class="p">SMS or MMS</p>

                            </li>

                            <li class="li">
                                <p class="p">None</p>

                            </li>

                        </ul>

                    </li>

                    <li class="li">
                        <p class="p">Updating the emergency scenario for a device in case another emergency
                            call is received during an ongoing emergency period. The device is
                            updated based on the following conditions:</p>

                        <ul class="ul" id="Emergency__ul_i2s_v4l_r4b">
                            <li class="li">
                                <p class="p">The incoming call must be of same or higher priority than the
                                    existing emergency (which is ongoing). If the incoming call is
                                    of higher emergency level, then the start time is set to current
                                    time and end time is evaluated on the basis of duration
                                    configured in the rule set. Also, the result code and emergency
                                    levels are set as configured in the rule set.</p>

                            </li>

                            <li class="li">
                                <p class="p">The level of emergency call is determined on the basis of the
                                        <samp class="ph systemoutput">Set-Emergency</samp> action defined in
                                    the rule. The priority of emergency level is defined in the
                                    following table in descending order:</p>

                                <table cellpadding="4" cellspacing="0" summary="" id="Emergency__table_j2s_v4l_r4b" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Emergency level types</span></caption><colgroup><col style="width:42.016806722689076%" /><col style="width:57.98319327731092%" /></colgroup><thead class="thead" style="text-align:left;">
                                            <tr class="row">
                                                <th class="entry cellrowborder" style="vertical-align:top;" id="d146172e288">
                                                  <p class="p">Emergency level type</p>

                                               </th>

                                                <th class="entry cellrowborder" style="vertical-align:top;" id="d146172e294">
                                                  <p class="p">Description</p>

                                               </th>

                                            </tr>

                                        </thead>
<tbody class="tbody">
                                            <tr class="row">
                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e288 ">ALL</td>

                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e294 ">The emergency is applicable to all tariff
                                                  types.</td>

                                            </tr>

                                            <tr class="row">
                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e288 ">DATA_VOICE_VIDEO_ECOM</td>

                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e294 ">The emergency is applicable to data, voice,
                                                  video, and eCommerce calls.</td>

                                            </tr>

                                            <tr class="row">
                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e288 ">DATA_VOICE_VIDEO</td>

                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e294 ">The emergency is applicable to data, voice,
                                                  and video calls.</td>

                                            </tr>

                                            <tr class="row">
                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e288 ">VOICE_VIDEO</td>

                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e294 ">The emergency is applicable to voice and
                                                  video calls.</td>

                                            </tr>

                                            <tr class="row">
                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e288 ">SMS_MMS</td>

                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e294 ">The emergency is applicable to SMS and MMS.
                                               </td>

                                            </tr>

                                            <tr class="row">
                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e288 ">NONE</td>

                                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d146172e294 ">This is used for resetting the emergency
                                                  level type.</td>

                                            </tr>

                                        </tbody>
</table>

                            </li>

                        </ul>

                    </li>

                    <li class="li">
                        <p class="p">If a lower priority emergency call arrives during an ongoing emergency
                            period, then the request to update the emergency level for a device is
                            ignored.</p>

                    </li>

                    <li class="li">
                        <p class="p">Emergency level is set in the following ways:</p>

                        <ul class="ul" id="Emergency__ul_k2s_v4l_r4b">
                            <li class="li">
                                <p class="p">Using a self-care API for emergency calls taking the input for
                                    start time, end time, emergency level, and device ID.</p>

                            </li>

                            <li class="li">
                                <p class="p">Executing rules during a call with evaluation of emergency
                                    duration and emergency level as configured in the rule set.</p>

                            </li>

                        </ul>

                    </li>

                    <li class="li">
                        <p class="p">The emergency level for a device is cleared under the following
                            scenarios:</p>

                        <ul class="ul" id="Emergency__ul_l2s_v4l_r4b">
                            <li class="li">
                                <p class="p">The time period set for emergency has elapsed.</p>

                            </li>

                            <li class="li">
                                <p class="p">An API request is received for clearing emergency, that is,
                                    inputs as startTime (0), endTime(0), and emergencyLevel
                                    (NONE).</p>

                            </li>

                            <li class="li">
                                <p class="p">A rule is defined for clearing the emergency with action unset
                                    emergency.</p>

                            </li>

                        </ul>

                    </li>

                </ul>

            </div>

            <div class="section" id="Emergency__section_r5m_z4l_r4b"><h3 class="title sectiontitle">View emergency set on device</h3>
                
                <div class="fig fignone" id="Emergency__fig_m2s_v4l_r4b">
                    <img class="image break" id="Emergency__image_n2s_v4l_r4b" src="../images/img9yz-09126-ug01-pczza-sp1-view_emergency_set_default.png" height="195" width="588" />
                </div>

                <p class="p">The <em class="ph i">SPR_DEVICE.Emergency-Level</em> rule attribute is exposed at device to get
                    the emergency level as already set, which is used to control the notifications
                    that are sent or any other actions that need to be executed. The available
                    values are:</p>

                <ul class="ul" id="Emergency__ul_o2s_v4l_r4b">
                    <li class="li">
                        <p class="p">
                            <var class="keyword varname">ALL</var>
                        </p>

                    </li>

                    <li class="li">
                        <p class="p">
                            <var class="keyword varname">DATA_VOICE_VIDEO_ECOM</var>
                        </p>

                    </li>

                    <li class="li">
                        <p class="p">
                            <var class="keyword varname">DATA_VOICE_VIDEO</var>
                        </p>

                    </li>

                    <li class="li">
                        <p class="p">
                            <var class="keyword varname">SMS_MMS</var>
                        </p>

                    </li>

                    <li class="li">
                        <p class="p">
                            <var class="keyword varname">NONE</var></p>

                    </li>

                </ul>

            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title4" id="Globallist"><h2 class="title topictitle2" id="ariaid-title4">Global Barred List, Allowed List, Always Allowed APN, and Always Allowed RG</h2>
<div class="body conbody">
            <div class="section">
                <p class="p">The <span class="ph uicontrol">Settings</span> tab within the <span class="ph uicontrol">CHARGING
                        MANAGEMENT</span> option in SM GUI is used for provisioning global
                    lists. The following types of lists are available at global level for charging
                    services:</p>

                <ul class="ul" id="Globallist__ul_tdz_jnn_gqb">
                    <li class="li">
                        <p class="p">Allowed Numbers</p>

                    </li>

                    <li class="li">
                        <p class="p">Barred Numbers</p>

                    </li>

                    <li class="li">
                        <p class="p">Allowed RGs</p>

                    </li>

                    <li class="li">
                        <p class="p">Allowed access point names (APN)</p>

                    </li>

                    <li class="li">Time of the day allowed RGs</li>

                </ul>

            </div>

            <div class="section" id="Globallist__section_w2r_znl_r4b"><h3 class="title sectiontitle">Global Barred List</h3>
                
                <p class="p">The global barred functionality facilitates the creation of RSV based rules,
                    which check on calls for <em class="ph i">Barred Numbers</em>, <em class="ph i">Allowed Numbers</em>,
                        <em class="ph i">Allowed access point names</em>, and <em class="ph i">Allowed RGs</em>. The <em class="ph i">Barred
                        Numbers</em> and<em class="ph i"> Allowed</em> rules are applicable to calls received for
                    Mobile Originated (MO) calls and calling party number for Mobile Terminating
                    (MT) calls.</p>

                <p class="p">Following tariff types are applicable on <em class="ph i">Barred Numbers</em> and <em class="ph i">Allowed</em>
                    rules:</p>

                <ul class="ul" id="Globallist__ul_dz3_jnl_r4b">
                    <li class="li">
                        <p class="p">IMS calls</p>

                    </li>

                    <li class="li">
                        <p class="p">SMS</p>

                    </li>

                    <li class="li">
                        <p class="p">MMS</p>

                    </li>

                </ul>

                <p class="p">
                    <em class="ph i">Allow</em> rule checks are related to RG or APN list and these are applicable
                    to following tariff types:</p>

                <ul class="ul" id="Globallist__ul_ez3_jnl_r4b">
                    <li class="li">
                        <p class="p">Data call</p>

                    </li>

                    <li class="li">
                        <p class="p">IMS call</p>

                    </li>

                    <li class="li">
                        <p class="p">SMS</p>

                    </li>

                    <li class="li">
                        <p class="p">MMS</p>

                    </li>

                </ul>

                <p class="p">Following is the behavior for an initial call request or update call request:</p>

                <ol class="ol" id="Globallist__ol_fz3_jnl_r4b">
                    <li class="li">
                        <p class="p">
                            <strong class="ph b">Initial call (CCR-I) request:</strong></p>

                        <ul class="ul" id="Globallist__ul_gz3_jnl_r4b">
                            <li class="li">
                                <p class="p">When an initial call is received on a device, the incoming number
                                    is checked against the <em class="ph i">Barred Numbers</em>. If the incoming
                                    number is available in the list of <em class="ph i">Barred Numbers</em>, then
                                    the call is terminated.</p>

                            </li>

                            <li class="li">
                                <p class="p">If the incoming number is available in the list of <em class="ph i">Allowed
                                        Numbers</em>, then UC check is not applicable and the
                                    incoming call continues.</p>

                            </li>

                            <li class="li">
                                <p class="p">If the incoming number is not present in both <em class="ph i">Allowed
                                        Numbers</em> and <em class="ph i">Barred Numbers</em>, then check is based
                                    on whether APN or RG exists in <em class="ph i">Allowed RGs or APN
                                    List</em>.</p>

                            </li>

                            <li class="li">
                                <p class="p">If the RG or APN for Multiple Service Credit Control (MSCC) is
                                    available in <em class="ph i">Allowed RGs or APN List</em>, then UC check is
                                    not applicable and incoming call continues.</p>

                            </li>

                            <li class="li">
                                <p class="p">If the RG or APN for MSCC is not available in <em class="ph i">Allowed RGs or
                                        APN List</em>, then the incoming call is checked for further
                                    UC checks (if configured).</p>

                            </li>

                        </ul>

                    </li>

                    <li class="li">
                        <p class="p">
                            <strong class="ph b">Update call (CCR-U) request:</strong>
                        </p>

                        <p class="p">For CCR-U scenarios, the incoming or the forwarded number is checked
                            against the <em class="ph i"><em class="ph i">Barred Numbers</em></em>. If the number is found in the
                                <em class="ph i">Barred Numbers</em> as per the rule configured, then the call
                            continues to rate and after committing USU, the result code is evaluated
                            by the rating logic. In this case, USU is committed and GSU is set to
                                <var class="keyword varname">0</var> in update response.</p>

                        <p class="p">In case of <em class="ph i"><em class="ph i">Barred Numbers</em></em>, <em class="ph i">Allowed Numbers</em>, and
                                <em class="ph i">Allowed RGs or APN List</em>, the rule evaluation is done while
                            processing the <em class="ph i">GY_PRE_PROCESSING</em> rule set. In case, the rule is
                            evaluated, then an action is returned that sets the
                                <span class="ph uicontrol">UC-Applicable</span> flag as
                                <var class="keyword varname">false</var>, which means to skip the UC checks.</p>

                        <p class="p">If an emergency scenario is ongoing, then irrespective of the number
                            barred as per rule evaluation, the call continues.</p>

                        <p class="p">For rules, a source context <em class="ph i">GLOBAL</em> is added in the
                                <em class="ph i">GY_PRE_PROCESSING</em> rule set.</p>

                        <p class="p">Following are the attributes added in the <em class="ph i">GLOBAL</em> source
                            context:</p>

                        <ul class="ul" id="Globallist__ul_hz3_jnl_r4b">
                            <li class="li">
                                <p class="p">
                                    <em class="ph i">GLOBAL.AllowedList</em>
                                </p>

                            </li>

                            <li class="li">
                                <p class="p">
                                    <em class="ph i">GLOBAL.BarredList</em>
                                </p>

                            </li>

                            <li class="li">
                                <p class="p">
                                    <em class="ph i">GLOBAL.RatingGroupList</em>
                                </p>

                            </li>

                            <li class="li">
                                <p class="p">
                                    <em class="ph i">GLOBAL.APNList</em>
                                </p>

                            </li>

                        </ul>

                        <p class="p">The <em class="ph i">SESSION_PARAMETERS.UC-Applicable</em> and
                                <em class="ph i">SESSION_PARAMETERS.Return-Result-Cause</em> attributes are added
                            in the <em class="ph i">SESSION_PARAMETERS</em> result context.</p>

                        <div class="p">Following is an example of rule set within <em class="ph i">GY_PRE_PROCESSING</em>
                            trigger. <img class="image" id="Globallist__image_a3b_2d5_pnb" height="288" src="../images/img9yz-09126-ug01-pczza-sp1-gy_pre_processing_trigger_default.png" width="480" />
                            <img class="image break" id="Globallist__image_od4_ynq_nyb" height="288" src="../images/img9yz-09126-ug01-pczza-sp1-gy_pre_processing_trigger_default_2.png" width="480" /></div>

                    </li>

                </ol>

            </div>

            <div class="section" id="Globallist__section_jfj_nnl_r4b"><h3 class="title sectiontitle">Examples</h3>
                
                <div class="sectiondiv"><p class="p"><strong class="ph b">Example 1:</strong></p>
<p class="p">The global barring on MO IMS calls through
                        configurable rule set. The rule conditions in following rules applied for MO
                        IMS, MO-SMS, and MMS-based on origination type and called party
                        address.</p>
<img class="image" id="Globallist__image_jz3_jnl_r4b" src="../images/img9yz-09126-ug01-pczza-sp1-mobarred_default.png" />
                    <ul class="ul" id="Globallist__ul_kz3_jnl_r4b">
                        <li class="li">
                            <p class="p">The <em class="ph i">Barred Numbers</em> in the <span class="ph uicontrol">CHARGING MANAGEMENT →
                                    Usage Control → Settings → ALLOWED AND BARRED LISTS</span>
                                tab needs to be configured with the numbers that are to be
                                barred.</p>

                        </li>

                        <li class="li">
                            <p class="p">For MO IMS call, if the <em class="ph i">Role of Node</em> AVP is of originating
                                type and called party address is found in the <em class="ph i">Barred Numbers</em>,
                                then result code and result cause are set to <em class="ph i">Session Parameter
                                    Result Context</em> to return the call without further
                                processing.</p>

                        </li>

                    </ul>
</div>
                <div class="sectiondiv"><p class="p"><strong class="ph b">Example 2:</strong></p>
<p class="p">A match is found for <em class="ph i">Allowed Numbers</em>,
                            <em class="ph i">Allowed RGs</em>, or <em class="ph i">Allowed access point names</em> through
                        configurable rule set. The rule conditions in following rules apply to IMS,
                        SMS, MMS, and data calls.</p>
<img class="image" id="Globallist__image_lz3_jnl_r4b" src="../images/img9yz-09126-ug01-pczza-sp1-allowedlist_default.png" /><ul class="ul" id="Globallist__ul_mz3_jnl_r4b">
                        <li class="li">The following lists in the <span class="ph uicontrol">CHARGING MANAGEMENT → Usage
                                Control → Settings → ALLOWED AND BARRED LISTS</span> tab need
                            to be configured with APNs to be allowed for skipping UC checks:<ul class="ul" id="Globallist__ul_g25_wxp_nyb">
                                <li class="li"><em class="ph i">Allowed List</em></li>

                                <li class="li"><em class="ph i">Allowed RGs</em></li>

                                <li class="li"><em class="ph i">Allowed access point names</em></li>

                            </ul>
</li>

                        <li class="li">
                            <p class="p">For IMS call, the called party number is matched in the <em class="ph i">Allowed
                                    List</em> and if found, then the
                                    <span class="ph uicontrol">UC-Applicable</span> flag is set as
                                    <var class="keyword varname">false</var>. Similarly, for SMS and MMS calls, the
                                address data in recipient address is matched in the <em class="ph i">Allowed
                                    List</em> and accordingly the
                                    <span class="ph uicontrol">UC-Applicable</span> flag is configured.</p>

                        </li>

                        <li class="li">
                            <p class="p">For data calls, the APN or RG are matched in the <em class="ph i">Allowed RG
                                    List</em> or <em class="ph i">Allowed APN List</em>, and if found, then the
                                    <span class="ph uicontrol">UC-Applicable</span> flag is set as
                                    <var class="keyword varname">false</var>.</p>

                        </li>

                        <li class="li">
                            <p class="p">If the <span class="ph uicontrol">UC-Applicable</span> flag is set as
                                    <var class="keyword varname">false</var> by any of the preceding rules, then the
                                call processing takes decision to skip the UC checks. However, the
                                counter of applicable UC object is incremented for consumption.</p>

                        </li>

                    </ul>
</div>
            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title5" id="UCservice"><h2 class="title topictitle2" id="ariaid-title5">Usage control entity</h2>
<div class="body conbody">
            <div class="section">
                <p class="p">The <span class="ph uicontrol">Usage Control</span> entity allows users to regulate and
                    restrict on the consumption of tariff units based on the usage limit and time of
                    day or day of week selections on the device. The usage control service executes
                    the following actions using threshold levels:</p>

                <ul class="ul" id="UCservice__ul_qyd_rml_r4b">
                    <li class="li">
                        <p class="p">Notification to user on defined threshold limit on usage.</p>

                    </li>

                    <li class="li">
                        <p class="p">Call rejection (hard-stop) on reaching a maximum value of threshold limit
                            on usage.</p>

                    </li>

                </ul>

                <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> For thresholds on self-counter, only notification actions and hard-stop are
                        supported through a threshold and any other configured actions are
                        ignored.</div>

                <p class="p">Usage control facilitates provisioning of barred and allowed lists at user level,
                    which is configurable by users through self-care API. The <span class="ph uicontrol">Usage
                        Control</span> entity allows identification of usage control based on
                    the applicability condition, priority of UC (lowest value have highest priority)
                    and subscription creation time (earliest created have higher precedence), which
                    are used during sorting logic. When a call arrives, multiple usage control
                    services are identified as configured in a subscription bundle for a device.</p>

                <p class="p">The <span class="ph uicontrol">Usage Control</span> entity allows provisioning of usage
                    limits for the following kinds of tariff units:</p>

                <ul class="ul" id="UCservice__ul_ryd_rml_r4b">
                    <li class="li">
                        <p class="p">Voice</p>

                    </li>

                    <li class="li">
                        <p class="p">Video</p>

                    </li>

                    <li class="li">
                        <p class="p">SMS</p>

                    </li>

                    <li class="li">
                        <p class="p">MMS</p>

                    </li>

                    <li class="li">
                        <p class="p">Data</p>

                    </li>

                    <li class="li">
                        <p class="p">eCommerce</p>

                    </li>

                </ul>

                <p class="p">Each usage limit allows provisioning of following parameters:</p>

                <ol class="ol" id="UCservice__ol_syd_rml_r4b">
                    <li class="li">
                        <p class="p">
                            <span class="ph uicontrol">Select Counter</span>: Select one of the following types
                            of counters:</p>

                        <ol class="ol" type="a" id="UCservice__ol_tyd_rml_r4b">
                            <li class="li">
                                <p class="p">Pre-existing counter associated with a charging service, also
                                    referred to as the reference counter.</p>

                            </li>

                            <li class="li">
                                <p class="p">Internal counter for usage control only, also referred to as the
                                    self-counter.</p>

                            </li>

                        </ol>

                        <div class="p">
                            <div class="note" id="UCservice__note_z3m_pgx_p5b"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Policy counters are not supported for UC
                                self-counters.</div>

                        </div>

                    </li>

                    <li class="li">
                        <p class="p">Select the usage limit for the type of counter selected:</p>

                        <ol class="ol" type="a" id="UCservice__ol_uyd_rml_r4b">
                            <li class="li">
                                <p class="p">Override the usage limit of reference counter. The unit type of
                                    usage limit is same as the unit type in the base counter
                                    definition.</p>

                            </li>

                            <li class="li">
                                <p class="p">Define the usage limit for self-counter. The unit of limit is
                                    basic unit corresponding to kind of tariff type.</p>

                            </li>

                        </ol>

                    </li>

                    <li class="li">
                        <p class="p">Select the threshold for the type of counter selected:</p>

                        <ol class="ol" type="a" id="UCservice__ol_vyd_rml_r4b">
                            <li class="li">
                                <p class="p">Accumulate threshold for reference counter. All thresholds
                                    associated to reference counter is applicable, which means
                                    either from charging service or usage control.</p>

                            </li>

                            <li class="li">
                                <p class="p">Define threshold for self-counter.</p>

                            </li>

                        </ol>

                        <div class="p">
                            <div class="note" id="UCservice__note_mms_4gx_p5b"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Policy thresholds are not supported for UC
                                self-counters.</div>

                        </div>

                    </li>

                    <li class="li">
                        <p class="p">Define applicability condition for usage control.</p>

                    </li>

                    <li class="li">
                        <p class="p">Define time of day restriction, which is a period within a day during
                            which the usage restriction is applicable and select a day. Each UC
                            limit defines multiple time of day slots for each day.</p>

                    </li>

                    <li class="li">
                        <p class="p">Use the UC limit ID to identify usage limit associated with tariff
                            units.</p>

                    </li>

                </ol>

            </div>

            <div class="section" id="UCservice__section_pgs_xml_r4b"><h3 class="title sectiontitle">Examples for UC service definitions</h3>
                
                <p class="p">For the examples in this section, define the usage control using the SM GUI. To
                    do this, navigate to <span class="ph uicontrol">Charging → ☰ → Charging Management → Usage
                        Control</span>, and do the following steps:</p>

                <ol class="ol" id="UCservice__ol_xyd_rml_r4b">
                    <li class="li">
                        <p class="p">Configure the name of the usage control service in the
                                <span class="ph uicontrol">Name</span> parameter.</p>

                    </li>

                    <li class="li">
                        <p class="p">Configure the priority of the usage control service in the
                                <span class="ph uicontrol">Priority</span> parameter. In case multiple UC
                            services are provisioned, priority is used in sorting during a call
                            control for identifying the UC service to be applied.</p>

                    </li>

                    <li class="li">
                        <p class="p">The <span class="ph uicontrol">Allowed List</span> and <span class="ph uicontrol">Barred
                                List</span> is configured as per the definition. However, the
                            actual update is done by the user when subscription is created for a
                            bundle having a UC associated with it.</p>

                    </li>

                    <li class="li"><p class="p">Configure the <span class="ph uicontrol">Applicability Condition</span>, which is
                            used for filtering UC services in sorting during a call control for
                            identifying the UC services to be applied. For defining UC applicable
                            for SMS, following applicability condition can be defined:</p>
<img class="image" id="UCservice__image_yyd_rml_r4b" src="../images/img9yz-09126-ug01-pczza-sp1-app_cond_1_default.png" />
                    </li>

                    <li class="li">
                        <p class="p">Click <span class="ph uicontrol">Usage Limit</span> to configure usage limit
                            parameters.</p>

                        <ol class="ol" type="a" id="UCservice__ol_zyd_rml_r4b">
                            <li class="li">
                                <p class="p">Select a <span class="ph uicontrol">Usage Limit Type</span>.</p>

                            </li>

                            <li class="li"><p class="p">Configure the applicability condition at the limit level, which
                                    is basically used at MSCC level for filtering the
                                        <span class="ph uicontrol">Usage Control</span> entities.</p>
<img class="image" id="UCservice__image_azd_rml_r4b" src="../images/img9yz-09126-ug01-pczza-sp1-app_cond_2_default.png" />
                            </li>

                            <li class="li">
                                <p class="p">If a pre-existing counter of charging service needs to be
                                    configured for usage control, then click on the
                                        <span class="ph uicontrol">Select Counter</span> drop-down list and
                                    select the required counter.</p>

                            </li>

                        </ol>

                    </li>

                    <li class="li">
                        <p class="p">Click <span class="ph uicontrol">TIME OF THE DAY</span> to configure the blocked
                            usage time for any day of the week:</p>

                        <ol class="ol" type="a" id="UCservice__ol_bzd_rml_r4b">
                            <li class="li">
                                <p class="p">Configure the time of the day functionality for any day.</p>

                                <p class="p">Blocked usage time can be configured for all days at once or only
                                    for specific days of the week.</p>

                            </li>

                            <li class="li">
                                <p class="p">Select the <span class="ph uicontrol">Start Time</span> and <span class="ph uicontrol">End
                                        Time</span> for the time of day.</p>

                                <div class="note" id="UCservice__note_rxv_ngx_p5b"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Multiple time slots can be configured
                                    per day of week by clicking the <img class="image" id="UCservice__image_g5l_bhq_nyb" src="../images/add_button_default.png" height="24" width="30" /> button against the
                                    specific day.</div>

                            </li>

                            <li class="li">
                                <p class="p">Configure the <span class="ph uicontrol">Usage Limit</span> and select the
                                    threshold from the pre-existing threshold groups.</p>

                                <div class="p">
                                    <div class="note" id="UCservice__note_rgf_ngx_p5b"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> For reference counters, the limit
                                        unit type is same as the base type of counter. The usage
                                        limit overrides the base usage limit of counter. Whereas,
                                        for self-counters, the limit unit type is the basic unit
                                        type corresponding to kind of unit selected.</div>

                                </div>

                            </li>

                        </ol>

                    </li>

                </ol>

            </div>

            <div class="section" id="UCservice__section_hhp_xml_r4b"><h3 class="title sectiontitle">Examples</h3>
                
                <div class="sectiondiv">
                    <p class="p"><strong class="ph b">Example 1:</strong> Usage control service with allowed or barred list, and only
                        one traffic type usage limit using reference counter.</p>

                    <ol class="ol" id="UCservice__ol_czd_rml_r4b">
                        <li class="li">
                            <p class="p">A device is subscribed to be a bundle associated with a charging
                                service.</p>

                        </li>

                        <li class="li">
                            <p class="p">The <span class="ph uicontrol">Usage Control</span> entity needs to be created
                                from the usage service (as defined in the above section) with
                                selecting counter, which is already associated with the charging
                                service.</p>

                        </li>

                        <li class="li">
                            <p class="p">Configure usage limit in usage control to override the base usage
                                limit of reference counter.</p>

                        </li>

                        <li class="li">
                            <p class="p">Associate a threshold with the UC limit with following trigger action
                                configuration:</p>

                            <ol class="ol" type="a" id="UCservice__ol_dzd_rml_r4b">
                                <li class="li">
                                    <p class="p">
                                        <samp class="ph systemoutput">NOTIFICATIONS.Send-Notification</samp>
                                        at 50% consumption (soft-stop)</p>

                                </li>

                                <li class="li">
                                    <p class="p">
                                        <samp class="ph systemoutput">NOTIFICATIONS.Notification-Reject</samp>
                                        at 100% consumption (hard-stop)</p>

                                </li>

                            </ol>

                        </li>

                        <li class="li">
                            <p class="p">Associate the usage control service into the bundle, which is already
                                associated with the charging service.</p>

                        </li>

                        <li class="li">
                            <p class="p">Create a new device subscription for the above bundle.</p>

                            <p class="p">Now, when a call arrives for this device, the usage limit object is
                                selected through sorting logic and counter is incremented based on
                                USUs. Once, the counter consumption reaches 50% of the usage limit,
                                the notification is triggered through threshold.</p>

                            <p class="p">If the counter consumption reaches 100% of the usage limit, the
                                notification is triggered and call is rejected after committing USUs
                                as hard-stop condition is met.</p>

                            <div class="p">
                                <div class="note" id="UCservice__note_onn_mgx_p5b"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Counter consumption is verified during
                                    calls from the SM GUI (navigate to <span class="ph uicontrol">Subscriber
                                        Manager</span> &gt; <span class="ph uicontrol">Devices</span> &gt;
                                        <span class="ph uicontrol">Usage Limit</span> tab).</div>

                            </div>

                        </li>

                    </ol>

                </div>
                <div class="sectiondiv">
                    <p class="p">
                        <strong class="ph b">Example 2:</strong> Usage control service allowed or barred list, and only one
                        traffic type usage limit using self-counter.</p>

                    <ol class="ol" id="UCservice__ol_ezd_rml_r4b">
                        <li class="li">
                            <p class="p">A device is subscribed to be a bundle associated with a charging
                                service.</p>

                        </li>

                        <li class="li">
                            <p class="p">The <span class="ph uicontrol">Usage Control</span> entity needs to be created
                                from usage service (as defined in the above section) without
                                selecting any counter. This creates an internal counter
                                (self-counter) for usage limit.</p>

                        </li>

                        <li class="li">
                            <p class="p">Configure usage limit in usage control, which is the usage limit of
                                self-counter.</p>

                        </li>

                        <li class="li">
                            <p class="p">Associate a threshold with the UC limit with following trigger action
                                configuration:</p>

                            <ol class="ol" type="a" id="UCservice__ol_fzd_rml_r4b">
                                <li class="li">
                                    <p class="p">
                                        <samp class="ph systemoutput">NOTIFICATIONS.Send-Notification</samp>
                                        at 50% consumption (soft-stop)</p>

                                </li>

                                <li class="li">
                                    <p class="p">
                                        <samp class="ph systemoutput">NOTIFICATIONS.Notification-Reject</samp>
                                        at 100% consumption (hard-stop)</p>

                                </li>

                            </ol>

                        </li>

                        <li class="li">
                            <p class="p">Associate the usage control service into the bundle, which is already
                                associated with the charging service.</p>

                        </li>

                        <li class="li">
                            <p class="p">Create a new device subscription for the above bundle.</p>

                            <p class="p">Now, when a call arrives for this device, the usage limit object is
                                selected through sorting logic and counter is incremented based on
                                USUs. Once, the counter consumption reaches 50% of the usage limit,
                                the notification is triggered through threshold.</p>

                            <p class="p">If the counter consumption reaches 100% of the usage limit, the
                                notification is triggered and call is rejected after committing USUs
                                as hard-stop condition is met.</p>

                            <div class="p">
                                <div class="note" id="UCservice__note_jcj_lgx_p5b"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Counter consumption is verified during
                                    calls from the SM GUI (navigate to <span class="ph uicontrol">Subscriber
                                        Manager</span> &gt; <span class="ph uicontrol">Devices</span> &gt;
                                        <span class="ph uicontrol">Usage Limit</span> tab).</div>

                            </div>

                        </li>

                    </ol>

                </div>
            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title6" id="concept_ifd_q4l_r4b"><h2 class="title topictitle2" id="ariaid-title6">Additional information</h2>
<div class="body conbody">
            <div class="section" id="concept_ifd_q4l_r4b__section_mpx_r4l_r4b">
                <p class="p">Following are some important points to note for the UC functionality:</p>

                <ul class="ul" id="concept_ifd_q4l_r4b__ul_npx_r4l_r4b">
                    <li class="li">
                        <p class="p">It is recommended to provision only one UC service per bundle.</p>

                    </li>

                    <li class="li">
                        <p class="p">When a UC service is included in a charging service bundle, it is
                            recommended to configure the included UC service of the same traffic
                            type with same applicability conditions that are supported by the
                            charging service bundles.</p>

                    </li>

                    <li class="li">
                        <p class="p">The traffic types or applicability conditions, and combinations for UC
                            limits inside the same UC service are strictly exclusive.</p>

                    </li>

                    <li class="li">
                        <p class="p">Although several UC services or bundles are defined, the UC service does
                            not allow the service provider to subscribe more than one UC service
                            covering a specific traffic type and applicability conditions. However,
                            if this condition cannot be avoided, then assign a different priority to
                            both UC services.</p>

                    </li>

                    <li class="li">
                        <p class="p">If the service provider needs to override an existing reference charging
                            service counter limit, then the service provider must ensure that the
                            same traffic type and related applicability conditions are used for the
                            charging service counter and for the UC limit, which references this
                            counter. Otherwise, UC specific self-counters must be used.</p>

                        <p class="p">For example, to define specialized usage limits for specialized traffic
                            types, such as voice and video calls, it is done using UC limit
                            applicability conditions. However, if there is only one charging service
                            counter with video and voice calls, then use the self-counters in UC
                            with related exclusive applicability conditions defined for each
                            limit.</p>

                    </li>

                    <li class="li">
                        <p class="p">If the service provider selects the UC only bundle scenario, then there
                            is a single allowed and barred list for all applicable traffic types. If
                            the owner selects the UC service included in a charging service bundle,
                            then there is a different allowed and barred list per charging service
                            bundle. In such cases, service provider includes applicability
                            conditions at the level of UC service corresponding to the charging
                            service traffic types included in related bundle. If this is not done,
                            then allowed and barred lists from a different bundle is selected based
                            on their respective UC service priority.</p>

                    </li>

                    <li class="li">
                        <p class="p">If multiple limits of same type across several UCs that are subscribed
                            for a device refer the same counter, then the limit added last through a
                            UC subscription updates the counter with its usage limit and
                            thresholds.</p>

                    </li>

                    <li class="li">UC self-counter does not increase in Direct Debit call.</li>

                </ul>

            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title7" id="concept_ypq_24l_r4b"><h2 class="title topictitle2" id="ariaid-title7">Examples</h2>
<div class="body conbody">
            <div class="section" id="concept_ypq_24l_r4b__section_lps_44l_r4b">
                <p class="p">The emergency scenario is configured by the rule set. Following examples show the
                    configuration in rule sets that trigger an emergency scenario:</p>

            </div>

            <div class="section" id="concept_ypq_24l_r4b__section_rpf_l4l_r4b"><h3 class="title sectiontitle">Example 1: EmergencLevelType_ALL</h3>
                
                <p class="p">The following figure shows the rule set configuration for initiating an emergency
                    scenario for an incoming call having a length of called party number less than
                    equal to 5:</p>

                <div class="fig fignone" id="concept_ypq_24l_r4b__fig_hkl_l4l_r4b">
                    <img class="image break" id="concept_ypq_24l_r4b__image_ikl_l4l_r4b" src="../images/img9yz-09126-ug01-pczza-sp1-emergency_type_all_default.png" />
                </div>

                <p class="p">This rule configuration sets the emergency level to <em class="ph i">ALL</em> tariff type, that
                    is <var class="keyword varname">EmergencLevelType_ALL</var>and sets the emergency scenario
                    duration as <var class="keyword varname">60 seconds</var>.</p>

                <ul class="ul" id="concept_ypq_24l_r4b__ul_jkl_l4l_r4b">
                    <li class="li">
                        <p class="p">The device for which emergency scenario is to be initiated is identified
                            from the call based on the <em class="ph i">Subscription ID</em> AVP in an IMS
                            message.</p>

                    </li>

                    <li class="li">
                        <p class="p">The emergency level <var class="keyword varname">EmergencLevelType_ALL</var> in rule sets
                            the start time of emergency scenario as the system time at the
                            evaluation of rule during call processing.</p>

                    </li>

                    <li class="li">
                        <p class="p">The end time of emergency scenario is the sum of start time and duration
                            as configured in the rule set.</p>

                    </li>

                    <li class="li">
                        <p class="p">The rule set allows CDR tag to be generated as per the configuration.</p>

                    </li>

                </ul>

            </div>

            <div class="section" id="concept_ypq_24l_r4b__section_ttx_34l_r4b"><h3 class="title sectiontitle">Example 2: EmergencyLevelType_VOICE_VIDEO</h3>
                
                <p class="p">The following figure shows the rule configuration for initiating an emergency
                    scenario for an incoming call based on parameter values defined in the AVP, such
                    as <em class="ph i">service-type</em> in IMS service specific information:</p>

                <div class="fig fignone" id="concept_ypq_24l_r4b__fig_s2q_j4l_r4b">
                    <img class="image break" id="concept_ypq_24l_r4b__image_t2q_j4l_r4b" src="../images/img9yz-09126-ug01-pczza-sp1-emergency_type_voice_video_default.png" />
                </div>

                <p class="p">This rule configuration sets the emergency level for voice and video tariff
                    types, that is <var class="keyword varname">EmergencyLevelType_VOICE_VIDEO</var> and sets the
                    emergency scenario duration as <var class="keyword varname">60 seconds</var>.</p>

                <ul class="ul" id="concept_ypq_24l_r4b__ul_u2q_j4l_r4b">
                    <li class="li">
                        <p class="p">The device for which the emergency scenario is to be initiated is
                            identified from the call based on the <em class="ph i">Subscription ID</em> AVP in an
                            IMS message.</p>

                    </li>

                    <li class="li">
                        <p class="p">The rule validates the condition for emergency based on value of the
                                <em class="ph i">Service-Specific-Type</em> AVP set as <var class="keyword varname">1007</var> and
                                <em class="ph i">Service-Specific-Date</em> AVP set as <var class="keyword varname">255</var>.</p>

                    </li>

                    <li class="li">
                        <p class="p">The emergency level <var class="keyword varname">EmergencyLevelType_VOICE_VIDEO</var> in
                            rule sets the start time of emergency scenario as the system time at the
                            evaluation of rule during call processing.</p>

                    </li>

                    <li class="li">
                        <p class="p">The end time of emergency is the sum of start time and duration as
                            configured in the rule set.</p>

                    </li>

                    <li class="li">
                        <p class="p">The rule set allows CDR tag to be generated as per the configuration.</p>

                    </li>

                </ul>

            </div>

            <div class="section" id="concept_ypq_24l_r4b__section_x12_h4l_r4b"><h3 class="title sectiontitle">Example 3: EmergencyLevelType_None</h3>
                
                <p class="p">The following figure shows the rule configuration for terminating an emergency
                    scenario for an incoming call based on parameter values defined in the AVP, such
                    as <em class="ph i">service-type</em> in IMS service specific information:</p>

                <div class="fig fignone" id="concept_ypq_24l_r4b__fig_hv1_34l_r4b">
                    <img class="image break" id="concept_ypq_24l_r4b__image_iv1_34l_r4b" src="../images/img9yz-09126-ug01-pczza-sp1-emergency_type_none_default.png" />
                </div>

                <p class="p">This rule configuration terminates the emergency scenario by the emergency level
                    as <em class="ph i">None</em>, that is <var class="keyword varname">EmergencyLevelType_None</var>.</p>

                <ul class="ul" id="concept_ypq_24l_r4b__ul_jv1_34l_r4b">
                    <li class="li">
                        <p class="p">The device for which the emergency scenario is to be terminated is
                            identified from the call based on the <em class="ph i">Subscription ID</em> AVP in an
                            IMS message.</p>

                    </li>

                    <li class="li">
                        <p class="p">The rule validates the condition for termination of emergency based on
                            value of the <em class="ph i">Service-Specific-Type</em> AVP set as
                                <var class="keyword varname">1007</var> and <em class="ph i">Service-Specific-Date</em> AVP set as
                                <var class="keyword varname">256</var>.</p>

                    </li>

                    <li class="li">
                        <p class="p">The emergency level <var class="keyword varname">EmergencyLevelType_None</var> in rule
                            sets the start time of emergency scenario as <var class="keyword varname">0</var>.</p>

                    </li>

                    <li class="li">
                        <p class="p">The end time of emergency is set as <var class="keyword varname">0</var>.</p>

                    </li>

                    <li class="li">
                        <p class="p">The rule set allows CDR tag to be generated as per the configuration.</p>

                    </li>

                </ul>

            </div>

        </div>
</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>