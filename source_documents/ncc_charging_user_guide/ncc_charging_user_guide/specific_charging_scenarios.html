<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Specific charging scenarios" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="id9yz-09126-ug01-pczza-sp1-d1e240302" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Specific charging scenarios</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="id9yz-09126-ug01-pczza-sp1-d1e240302">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Specific charging scenarios</h1>
<div class="body conbody">
<div class="section" id="id9yz-09126-ug01-pczza-sp1-d1e240302__cbsc"><h2 class="title sectiontitle">Charging behavior across the subscription billing cycle</h2>
<p class="p">NCC behaves in the following manner when a reservation and its corresponding commit happens
                across a subscription billing cycle reset or renewal time:</p>
<ul class="ul">
<li class="li">
<p class="p">The current values of buckets and counter for each user subscription are memorized during the reset or renewal time, which means the current values of buckets and counters are the values of buckets and counters before the reset or renewal time. Therefore, after reset or renewal of the user subscription, there are two types of values for buckets or counters:</p>
<ol class="ol">
<li class="li">
<p class="p">Memorized values of buckets and counters, also referred to as the <em class="ph i">Previous Billing Cycle (PreBC)</em> values, and</p>

</li>

<li class="li">
<p class="p">Actual values of buckets and counters after the reset or renewal of subscription, also referred to as the <em class="ph i">Post Billing Cycle (PostBC)</em> values.</p>

</li>

</ol>

</li>

<li class="li">
<p class="p">The timestamp when the buckets or counters for a user subscription got reset or renewed is memorized.</p>

</li>

<li class="li">
<p class="p">If an update request is received from the service provider network to report the used quantities, then a check is performed to see whether the subscription reset or renewal time is between the previous request and the current request.</p>

<p class="p">If the check confirms that the subscription reset or renewal time is between the previous request and current request, then quantities of used resources are committed as per the following logic:</p>
<ul class="ul">
<li class="li">
<p class="p">In case of over-commit scenarios, <em class="ph i">PreBC</em> buckets or counters are updated with the last reserved quantities and <em class="ph i">PostBC</em> buckets or counters are updated with over-commit quantities.</p>

</li>

<li class="li">
<p class="p">In case of under-commit scenarios, <em class="ph i">PreBC</em> buckets or counters are updated with the reported
                                quantities. If a bucket is preconfigured for carry-over feature,
                                then unused quantities are evaluated with reference to carry-over
                                feature and the carry over is updated accordingly.</p>

</li>

</ul>

</li>

</ul>

<div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> The behavior of NCC as explained in this section is applicable only when a single reset or
                    renewal of a user subscription takes place between a previous request and
                    current request.</div>

<p class="p">The <em class="ph i">BucketCommittedUnitsBR</em>, <em class="ph i">CounterUpdatedValueBR</em>, and <em class="ph i">CarryOverTRValue</em> CDR tags are generated during an update to <em class="ph i">PreBC</em> buckets or counters.</p>

<p class="p">For information on <em class="ph i">BucketCommittedUnitsBR</em>, <em class="ph i">CounterUpdatedValueBR</em>,
                    <em class="ph i">CarryOverTRValue</em> CDR tags, see the <em class="ph i">NOKIA Converged Charging CDR/EDR
                    Reference</em> guide.</p>

</div>

<div class="section"><h2 class="title sectiontitle">Charging behavior on execution of the Reset Account action</h2>
<p class="p">NCC behaves in the following manner (similar to <a class="xref" href="specific_charging_scenarios.html#id9yz-09126-ug01-pczza-sp1-d1e240302__cbsc">Charging behavior across the subscription billing cycle</a>) when a reservation and its
                corresponding commit happens across the account reset time:</p>
<ul class="ul">
<li class="li">
<p class="p">The values of balance and available balance attributes of the account balance before reset are memorized during reset time. Therefore, after reset there are following two types of values of the account balance:</p>
<ol class="ol">
<li class="li">
<p class="p">Memorized values, that is, also referred as PreBC values.</p>

</li>

<li class="li">
<p class="p">Actual values of an account after the reset, that is, also referred to as Post Billing Cycle (PostBC) values.</p>

</li>

</ol>

</li>

<li class="li">
<p class="p">The timestamp when the account got reset is memorized.</p>

</li>

<li class="li">
<p class="p">If an update request is received from the service provider network to report the used quantities, then a check is performed to see whether the account reset time is between the previous and the current request. </p>

<p class="p">If the check confirms that the account reset time is between the previous and current request, then quantities of used resources are committed as per the following logic:</p>
<ul class="ul">
<li class="li">
<p class="p">In case of over-commit scenarios, <em class="ph i">PreBC</em> balance units are updated with the last reserved quantities and <em class="ph i">PostBC</em> balance units are updated with over-commit quantities.</p>

</li>

<li class="li">
<p class="p">In case of under-commit scenarios, <em class="ph i">PreBC</em> balance units are updated with the reported quantities.</p>

</li>

</ul>

</li>

</ul>

<p class="p">The <em class="ph i">accountCommittedUnitsBR</em> CDR tags are generated during an update to <em class="ph i">PreBC</em>
                balance values. For information on <em class="ph i">accountCommittedUnitsBR</em> CDR tags, see the
                    <em class="ph i">NOKIA Converged Charging CDR/EDR Reference</em> guide.</p>

<p class="p">Also, during cancel reservation or audit request, if reset has occurred between previous and current request, then reservation is canceled from the <em class="ph i">PreBC</em> balance values.</p>

</div>

<div class="section"><h2 class="title sectiontitle">Example: Reset the main balance at the end of a billing cycle</h2>
<p class="p">
<strong class="ph b">Provisioning:</strong>
</p>
<ol class="ol">
<li class="li">
<p class="p">Create an account with customized periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">Configure the <samp class="ph systemoutput">Reset Account</samp> action in the periodic lifecycle with an end time.</p>

</li>

<li class="li">
<p class="p">Set the main account balance to <var class="keyword varname">12</var> using the <em class="ph i">Adjust Account</em> REST API.</p>

</li>

</ol>

<p class="p">
<strong class="ph b">Result:</strong>
</p>

<p class="p">The <samp class="ph systemoutput">Reset Account</samp>  action is triggered without the reset value using the <em class="ph i">Trigger</em> API. The current value of the account is reset to <var class="keyword varname">0</var> considering the reset value is not specified in the <samp class="ph systemoutput">Reset Account</samp> action.</p>

<div class="p">Following is a sample CDR (Note that all parameters are not shown in this sample):<table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><colgroup><col /><col /><col /></colgroup><thead class="thead" style="text-align:left;">
                            <tr class="row">
                                <th class="entry cellrowborder" style="vertical-align:top;" id="d417088e301">
                                    <p class="p">Name</p>

                               </th>

                                <th class="entry cellrowborder" style="vertical-align:top;" id="d417088e307">
                                    <p class="p">Tag</p>

                               </th>

                                <th class="entry cellrowborder" style="vertical-align:top;" id="d417088e313">
                                    <p class="p">Data</p>

                               </th>

                            </tr>

                        </thead>
<tbody class="tbody">
                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e301 "> RecordType</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e307 "> 0</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e313 "> LIFECYCLE_RECORD</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e301 "> invokedBy</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e307 "> 1</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e313 "> ResetAccountAction</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e301 "> triggeredEntityType</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e307 "> 1</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e313 "> Account</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e301 "> resetValue</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e307 "> 1</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e313 "> 0</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e301 "> accountBalanceBeforeReset</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e307 "> 1</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e313 "> 12.0</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e301 "> accountBalanceAfterReset</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e307 "> 1</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e313 "> 0</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e301 "> result</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e307 "> 1</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d417088e313 "> Success</td>

                            </tr>

                        </tbody>
</table>
</div>

</div>

</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>