<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="task" />
<meta name="DC.title" content="Rolling back Release 23.8 to the previous version" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="rolling_back_release_22_0_sp1" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Rolling back Release 23.8 to the previous version</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="rolling_back_release_22_0_sp1">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Rolling back Release 23.8 to the previous version</h1>
<div class="body taskbody">
        <div class="section context"><div class="tasklabel"><h2 class="sectiontitle tasklabel"></h2></div>
            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> 
                <ul class="ul">
                    <li class="li">During rollback, traffic may be impacted. You can divert all traffic to the
                        corresponding geographic site to ensure traffic is not lost.</li>

                    <li class="li">The rollback of some charts may timeout. You must manually increase the
                        timeout value before running the rollback script.</li>

                </ul>

            </div>

            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Make sure you rollback bssc-indexsearch first and then its dependent charts (for
                example: bssc-dashboards and bssc-indexmgr). Until the rollback of bssc-indexsearch
                is complete, the dashboard UI is not accessible and index manager jobs result in
                error. The errors stop when the rollback is complete. <div class="p">This is the suggested
                    rollback sequence: <ol class="ol">
                        <li class="li">bssc-indexsearch</li>

                        <li class="li">bssc-dashboards</li>

                        <li class="li">bssc-indexmgr</li>

                        <li class="li">bssc-fluentd</li>

                    </ol>
</div>
</div>

            <p class="p">The first three steps in this procedure are for bssc-indexsearch rollback.</p>

        </div>

        <div class="tasklabel"><h2 class="sectiontitle tasklabel"></h2></div><ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">Run this command before you start the rollback of NCC Telemetry and wait for
                    the data pods and manager pods to terminate.</span>
                <div class="itemgroup info"><pre class="pre codeblock"><code>helm3 scale &lt;indexsearch-release-name&gt; &lt;indexsearch-chart-path&gt; -f &lt;values-file&gt; --set manager.replicas=0 \
--set data.replicas=0 --namespace &lt;namespace&gt;</code></pre> Example:
                    <pre class="pre codeblock"><code>helm3 scale btel-btel-bssc-indexsearch /home/cloud-user/input-generator/charts/bssc-indexsearch-23.8.1-85.tgz \
 -f /home/cloud-user/input-generator/output/btel1/charts/btel-bssc-indexsearch.yaml \
 --set manager.replicas=0 \
 --set data.replicas=0 \
 --namespace btel1</code></pre></div>
                <div class="tasklabel"><h2 class="sectiontitle tasklabel">Expected outcome</h2></div><div class="itemgroup stepresult">This command deletes all of the old PVC and pods for IndexSearch data
                    and IndexSearch manager resulting in deletion of all of the old data stored in
                    the IndexSearch data pods. The command also increments the chart revision number
                    by 1.</div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Run the rollback command without specifying a wait or timeout value.</span>
                <div class="tasklabel"><h2 class="sectiontitle tasklabel">Expected outcome</h2></div><div class="itemgroup stepresult">Data and manager pods are recreated. However, the indexsearch-client pod
                    creation fails. Until the rollback script in the next step completes
                    successfully, jobs like indexsearch-upg and indexsearch-secadmin might go into
                    an error state. However, these errors can be ignored. </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Run the <span class="ph filepath">bssc-rollback-script.sh</span> script that is present in
                    the <span class="ph filepath">input-generator/output/&lt;&lt;Element&gt;&gt;/examples</span>
                    directory.</span>
                <div class="itemgroup info"><pre class="pre codeblock"><code>sh bssc-rollback-script.sh &lt;releasename&gt; &lt;namespace&gt; &lt;indexsearch-client containername</code></pre>
                    <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Make sure you provide the correct indexsearch-client container name. You
                        can check for the container name by describing the IndexSearch client
                        pod.</div>
</div>
                <div class="tasklabel"><h2 class="sectiontitle tasklabel">Expected outcome</h2></div><div class="itemgroup stepresult">The script deletes the old client pods and recreates new ones. </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Run the helm3 rollback commands or use the orchestrator to rollback <span class="ph">NCC</span> to the previous version in the reverse order in
                    which the charts were updated, for all other charts.</span>
            </li>
</ol>

    </div>
<div class="footer"><hr /><p>Installation and Upgrade Guide • P556766-DN1000055103-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>