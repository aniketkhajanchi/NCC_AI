<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Aggregate view resource breakup notification" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="aggregate_view_resource_breakup_for_notification" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Aggregate view resource breakup notification</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="aggregate_view_resource_breakup_for_notification">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Aggregate view resource breakup notification</h1>
<div class="body conbody">
        <p class="p">NCC provides the functionality to generate a notification upon bucket depletion and when
            bucket threshold is reached. A notification can also be generated upon aggregated view
            depletion and when aggregate view threshold is reached. </p>

        <p class="p">This feature provides the functionality to include both individual bucket values and
            aggregate value in the same notification.</p>

        <p class="p"><strong class="ph b">Aggregate view resource breakup notification when bucket threshold is reached:</strong></p>

        <p class="p">NCC provides the functionality to configure threshold notification generated upon
            reaching individual bucket balance threshold to include both individual bucket values
            and aggregate value.</p>

        <p class="p">While evaluating the bucket level threshold, all the aggregate views that the bucket is a
            part of are fetched, and the oldest created aggregate view is used to fetch the buckets
            of same type to be included in the notification.</p>

        <p class="p"><strong class="ph b">Aggregate view resource breakup notification when aggregate view threshold is
                reached:</strong></p>

        <p class="p">NCC provides the functionality to configure threshold notification generated upon
            reaching aggregate bundle balance threshold to include both individual bucket values and
            aggregate value.</p>

        <p class="p">While evaluating the aggregate view threshold, all the applicable buckets are fetched
            from the aggregate view and included in the threshold notification to be sent for that
            aggregate view.</p>

        <div class="p">
            <div class="div"><strong class="ph b">Aggregating bucket values</strong><p class="p">For individual bucket and aggregate view
                    threshold notifications, only the buckets that are part of the same aggregate
                    view are considered. </p>
<div class="p">The values of buckets with same periodicity, and
                    expiry time are aggregated. That is, buckets in the aggregate view with same end
                    date and periodic length are combined and their values such as current value and
                    unused value are aggregated. The threshold notification contains a single
                    aggregated bucket with aggregated bucket values. <div class="note" id="aggregate_view_resource_breakup_for_notification__note_qrp_1p4_pvb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> The
                        bucket values are aggregated only for notification purpose. Threshold cannot
                        be defined on the aggregated value.</div>
</div>
<p class="p">The values of the buckets
                    that do not belong to the aggregate view are not considered to be included in
                    the threshold notification.</p>
</div>
        </div>

        <div class="section" id="aggregate_view_resource_breakup_for_notification__section_esm_nsn_pvb"><h2 class="title sectiontitle">Configuration</h2>
            
            <div class="sectiondiv"><strong class="ph b">Application preferences</strong><p class="p">This feature can be configured using the
                    application preferences <em class="ph i">Aggregate View Resource Breakup For Notification</em>,
                    and <em class="ph i">Rule Value Delimiter</em>. </p>
<div class="p">
                    <table cellpadding="4" cellspacing="0" summary="" id="aggregate_view_resource_breakup_for_notification__table_jpj_ybp_pvb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Application preferences</span></caption><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead class="thead" style="text-align:left;">
                                <tr class="row">
                                    <th class="entry cellrowborder" style="vertical-align:top;" id="d117930e100">Application preference</th>

                                    <th class="entry cellrowborder" style="vertical-align:top;" id="d117930e103">Description</th>

                                </tr>

                            </thead>
<tbody class="tbody">
                                <tr class="row">
                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d117930e100 "><em class="ph i">Aggregate View Resource Breakup For
                                        Notification</em></td>

                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d117930e103 ">This parameter is used to enable the functionality to
                                        include both individual bucket values and aggregate value in
                                        the same notification when bucket threshold or aggregate
                                        view threshold is reached. It can take the following
                                            values:<ul class="ul" id="aggregate_view_resource_breakup_for_notification__ul_jvp_3pz_4vb">
                                            <li class="li"><var class="keyword varname">BUCKET</var>: Threshold notification
                                                with both individual bucket values and aggregate
                                                value is generated when bucket threshold or
                                                aggregate view threshold is reached. </li>

                                            <li class="li"><var class="keyword varname">NONE</var>: The functionality to
                                                include both individual bucket values and aggregate
                                                value in the same notification is disabled.</li>

                                        </ul>
<p class="p">Default value: <var class="keyword varname">NONE</var></p>
</td>

                                </tr>

                                <tr class="row">
                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d117930e100 "><em class="ph i">Rule Value Delimiter</em></td>

                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d117930e103 ">This value is used as a separator to split the values of
                                        different entity names. <div class="note" id="aggregate_view_resource_breakup_for_notification__note_d5d_3bd_tvb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> The
                                            individual bucket values in the aggregate view resource
                                            breakup notification are concatenated with a delimiter
                                            (;) that is fetched from the application preference
                                                <em class="ph i">Rule Value Delimiter</em>, if configured.
                                            </div>
<p class="p">Default value: <var class="keyword varname">;</var></p>
<p class="p">The
                                                <em class="ph i">Rule Value Delimiter</em> is used as
                                                follows:</p>
<p class="p"><em class="ph i">Bucket1;Bucket2;Bucket3</em>, where
                                                <em class="ph i">Bucket1</em>, <em class="ph i">Bucket2</em>, and <em class="ph i">Bucket3</em>
                                            are the values in the notification variable concatenated
                                            using <em class="ph i">Rule Value Delimiter</em> (;).</p>
<p class="p">If a value
                                            is not present, then it should be empty delimited. For
                                            example: If <em class="ph i">Bucket2</em> value is not available, then
                                                <em class="ph i">Rule Value Delimiter</em> is set to
                                                <em class="ph i">Bucket1</em>;;<em class="ph i">Bucket3</em>.</p>
<div class="p">In
                                            notification template defined to loop over the received
                                            bucket values in notification variables, the loop is
                                            executed over this delimiter.<div class="note" id="aggregate_view_resource_breakup_for_notification__note_ak1_5xx_svb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> For details on loop, see <em class="ph i">Loop pattern for
                                                  applying modifiers on all values concatenated with
                                                  a delimiter</em> section in <em class="ph i">Notification Service
                                                  User Guide</em></div>
</div>
</td>

                                </tr>

                            </tbody>
</table>

                    <div class="note" id="aggregate_view_resource_breakup_for_notification__note_k5b_qsn_pvb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> For details on configuring ME application
                        preferences, see <em class="ph i">Global Configuration Guide</em>.</div>

                </div>
</div>
            <div class="sectiondiv"><strong class="ph b">Rule configuration</strong></div>
            <div class="p">The following attributes are available in <em class="ph i">THRESHOLD_PROFILE</em> source context to
                send the threshold notification with aggregate view resource breakup values.<ul class="ul" id="aggregate_view_resource_breakup_for_notification__ul_dxd_d5n_pvb">
                    <li class="li"><em class="ph i">Buckets-Type</em></li>

                    <li class="li"><em class="ph i">Buckets-CurrentValue</em></li>

                    <li class="li"><em class="ph i">Buckets-UnusedValue</em></li>

                    <li class="li"><em class="ph i">Buckets-UnitValues</em></li>

                    <li class="li"><em class="ph i">Buckets-EndDate</em></li>

                    <li class="li"><em class="ph i">Buckets-Periodic-Length</em></li>

                </ul>
</div>

            <div class="p">Note the following important points about the attributes
                    <em class="ph i">THRESHOLD_PROFILE.Buckets-EndDate</em> and
                    <em class="ph i">THRESHOLD_PROFILE.Buckets-Periodic-Length</em> for configuring aggregate view
                resource breakup notification:<ul class="ul" id="aggregate_view_resource_breakup_for_notification__ul_t52_bcg_pvb">
                    <li class="li">If the bucket has a Period Lifecycle (PLC) attached, then the notification
                        contains bucket end date and periodic length of the bucket PLC. If the
                        bucket does not have an end date, then end date is empty in the
                        notification.</li>

                    <li class="li">If the bucket does not have a PLC, and subscription associated with the
                        bucket has a PLC and end date, then the notification contains subscription
                        end date and periodic length of subscription PLC.</li>

                    <li class="li">If both bucket, and the subscription associated with the bucket do not have
                        an end date, or PLC but the associated account has an end date, then the
                        notification contains account end date and periodic length of account
                        PLC.</li>

                    <li class="li">If the bucket does not have a PLC, subscription associated with the bucket
                        does not have an end date or PLC, and the associated account does not have a
                        PLC, then the notification contains account PLC periodic length, and the end
                        date is empty.</li>

                </ul>
</div>

        </div>

        <div class="section" id="aggregate_view_resource_breakup_for_notification__section_ilr_tv4_pvb">
            <p class="p"><strong class="ph b">Additional information</strong></p>

            <div class="p">
                <ul class="ul" id="aggregate_view_resource_breakup_for_notification__ul_ncg_vcg_pvb">
                    <li class="li">This feature is also applicable for BOU bundles, rollover bundles, and step
                        buckets.</li>

                    <li class="li">Notification contains combined and individual buckets belonging to the same
                        aggregate view. <p class="p">For example, a device has four data buckets B1, B2, B3
                            and B4. Aggregate view is created for B1 and B2. A call is executed from
                            B3 and its threshold is crossed. Its threshold notification contains
                            only about B3. It does not contain the individual and aggregated values
                            of B1 and B2 as B3 is not part of the same aggregate view.</p>
</li>

                    <li class="li">Only same type of buckets can be aggregated.</li>

                    <li class="li">If the bucket’s threshold and aggregate view threshold is crossed while
                        generating the aggregate view resource breakup notification, then two
                        separate notifications (one for reaching bucket threshold and the other for
                        reaching aggregate view threshold) are generated.</li>

                    <li class="li">The values of buckets with same periodicity, and expiry time are aggregated
                        only for the purpose of generating the notification.</li>

                    <li class="li">The <em class="ph i">Buckets-EndDate</em> has epoch time. <em class="ph i">DATE</em> modifier in the
                        notification template can be used to convert it into readable date
                        format.</li>

                    <li class="li">The values of data buckets and aggregate view are represented in bytes.
                            <em class="ph i">BYTE</em> modifier in notification template can be used to convert it
                        into readable format. </li>

                    <li class="li">Threshold should be configured separately for bucket depletion and aggregate
                        view depletion.</li>

                    <li class="li">Subscriptions and buckets in <em class="ph i">BARRED</em> state and <em class="ph i">FINAL</em> state are
                        not part of aggregate resource breakup data in the notification.</li>

                    <li class="li">The expiry time of the notification for a bucket is the end time of
                        subscription which is defined by the PLC attached to the bucket,
                        subscription, or account.</li>

                    <li class="li">Free buckets are treated like normal buckets while generating the
                        notification.</li>

                    <li class="li">Active buckets with zero balance are part of the notification.</li>

                </ul>

            </div>

        </div>

        <div class="section" id="aggregate_view_resource_breakup_for_notification__section_wp5_ftg_pvb"><h2 class="title sectiontitle">Use cases</h2>
            
            <p class="p"><strong class="ph b">Use case 1: Threshold notification of aggregate bundle balance (only for weekly
                    bundles).</strong></p>

            <div class="p"><strong class="ph b">Pre-conditions</strong><ul class="ul" id="aggregate_view_resource_breakup_for_notification__ul_vkt_5sg_pvb">
                    <li class="li">On December 1, a data bundle (<em class="ph i">Data_Bundle1</em>) is purchased. It is valid
                        till December 7. On December 5, the remaining amount of <em class="ph i">Data_Bundle1</em>
                        is 50MB.</li>

                    <li class="li">On December 5, a data bundle (<em class="ph i">Data_Bundle2</em>) is purchased. As a
                        result, the bucket value of data bundle is 200MB (remaining 50MB of
                            <em class="ph i">Data_Bundle1</em> + 150MB of <em class="ph i">Data_Bundle2</em>). The validity of
                            <em class="ph i">Data_Bundle2</em> is 1 week. That is, it expires on December
                        12th.</li>

                    <li class="li">On December 10, the remaining amount is 80MB, and a data bundle
                            (<em class="ph i">Data_Bundle3</em>) is purchased.<p class="p">As a result, the bucket value of
                            the data bundle is 80MB (remaining 80MB coming from <em class="ph i">Data_Bundle1</em>
                            and <em class="ph i">Data_Bundle2</em>). The validity remains as December 12.</p>
</li>

                    <li class="li">
                        <p class="p"><em class="ph i">Data_Bundle3</em> has a bucket value of 200MB, and validity of 1 week.
                            It expires on December 17.</p>

                    </li>

                </ul>
</div>

            <p class="p">If the threshold is set as 300 MB, then the possible notification is as follows:</p>

            <p class="p"><em class="ph i">"Your Weekly bundle balance is below 300MB. Total remaining balance is 280MB.
                    Breakdown: 1 Week[s] Data Bucket has 80MB, expiring on 12/12/2021 00:00:00 | 1
                    Week[s] Data Bucket has 200MB expiring on 17/12/2021 00:00:00"</em></p>

            <div class="p"><strong class="ph b">Configuration</strong><ul class="ul" id="aggregate_view_resource_breakup_for_notification__ol_vk3_xdg_pvb">
                    <li class="li">The application preference <em class="ph i">Aggregate View Resource breakup for
                            Notification</em> is set to <var class="keyword varname">BUCKET</var>.</li>

                    <li class="li">The application preference <em class="ph i">Rule Value delimiter</em> is set to
                            '<var class="keyword varname">;</var>'.</li>

                    <li class="li">Three data bundles each with a validity of 1 week are created.
                            <em class="ph i">Data_Bundle1</em> with <em class="ph i">Data_Bucket1</em> (100MB),
                            <em class="ph i">Data_Bundle2</em> with <em class="ph i">Data_Bucket1</em> (150 MB),
                            and<em class="ph i">Data_Bundle3</em> with <em class="ph i">Data_Bucket1</em> (220MB).<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_up2_qxl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_dyk_dyl_tvb" height="240" src="../images/data_bundle1.png" width="576" />
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_wr3_2yl_tvb" height="288" src="../images/data_bundle2.png" width="576" />
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_bz5_fyl_tvb" height="240" src="../images/data_bundle3.png" width="576" />
                        </div>
</li>

                    <li class="li">The priority of the charging logics is as follows:<p class="p">Charging Logic 3 &gt;
                            Charging Logic 2 &gt; Charging Logic 1</p>
<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_kn2_pxl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_mxx_gyl_tvb" height="192" src="../images/cs1.png" width="576" />
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_igv_hyl_tvb" height="192" src="../images/cs2.png" width="576" />
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_h4v_3yl_tvb" height="192" src="../images/cs3.png" width="576" />
                        </div>
</li>

                    <li class="li">An aggregate view is created for <em class="ph i">Data_Bucket1</em>, <em class="ph i">Data_Bucket2</em>,
                        and <em class="ph i">Data_Bucket3</em>.<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_ehw_qxl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_zpm_nyl_tvb" height="240" src="../images/aggregate_view.png" width="576" />
                        </div>
</li>

                    <li class="li">Aggregate threshold profile [Absolute From Start] is configured to send
                        notification at 300MB.<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_okc_rxl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_nhf_4yl_tvb" height="240" src="../images/aggregate_threshold.png" width="576" />
                        </div>
</li>

                    <li class="li">PLC is configured at subscription.<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_ef5_rxl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_hyd_pyl_tvb" height="240" src="../images/plc_subscription.png" width="576" />
                        </div>
</li>

                    <li class="li">Notification template is configured.<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_zl1_sxl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_igv_ryl_tvb" height="288" src="../images/notification_template.png" width="576" />
                        </div>
</li>

                    <li class="li">Account is created.</li>

                    <li class="li">Device is created.</li>

                </ul>
</div>

            <p class="p"><strong class="ph b">Execution:</strong></p>

            <div class="p">
                <ol class="ol" id="aggregate_view_resource_breakup_for_notification__ol_f4h_mqg_pvb">
                    <li class="li">Account has a balance of €100</li>

                    <li class="li">Device has <em class="ph i">Bundle1</em><p class="p">Account overview before call consumption</p>
<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_uly_tyl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_gqm_b1m_tvb" height="240" src="../images/before_first.png" width="576" />
                        </div>
</li>

                    <li class="li">After call consumption of 50 MB<p class="p">Account overview after call
                            consumption</p>
<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_jj3_5yl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_g3g_f1m_tvb" height="240" src="../images/after_first_call_consump.png" width="576" />
                        </div>
</li>

                    <li class="li">Update device to add subscription 2 (<em class="ph i">Bundle2</em>)<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_ofl_5yl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_y43_h1m_tvb" height="240" src="../images/add_second_sub.png" width="576" />
                        </div>
</li>

                    <li class="li">Call consumption is done of 120 MB <p class="p">Account overview after call
                            consumption of 120 MB</p>
<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_jh4_5yl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_fjb_k1m_tvb" height="240" src="../images/after_second.png" width="576" />
                        </div>
</li>

                    <li class="li">Update device to add subscription 3 (<em class="ph i">Bundle3</em>)<p class="p">Account overview
                            after third subscription</p>
<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_g2r_5yl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_qwy_k1m_tvb" height="288" src="../images/update_thrid_sub.png" width="576" />
                        </div>
</li>

                    <li class="li">Call consumption is of 130 MB<p class="p">Account overview after call consumption of
                            130 MB</p>
<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_dng_vyl_tvb">
                            <img class="image break" id="aggregate_view_resource_breakup_for_notification__image_khv_m1m_tvb" height="288" src="../images/after_third_call_consump.png" width="576" />
                        </div>
</li>

                    <li class="li">Threshold is reached at 300 MB and notification is sent<p class="p">Notification when
                            threshold is reached at 300 MB</p>
<div class="fig fignone" id="aggregate_view_resource_breakup_for_notification__fig_r4j_vyl_tvb">
                            <p class="p"><em class="ph i">"Your Weekly bundle balance is below 300MB. Total remaining
                                    balance is 280MB. Breakdown: 1 Week[s] Data Bucket has 80MB,
                                    expiring on 12/12/2021 00:00:00 | 1 Week[s] Data Bucket has
                                    200MB expiring on 17/12/2021 00:00:00"</em></p>

                        </div>
</li>

                </ol>

            </div>

        </div>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>