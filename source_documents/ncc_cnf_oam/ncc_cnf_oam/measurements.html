<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Metrics overview" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="measurement_collection_overview" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Metrics overview</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="measurement_collection_overview">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Metrics overview</h1>
<div class="body conbody">
        <p class="p"><span class="ph">NCC</span> collects a broad range of metrics to provide a rich set
            of data for understanding the load and behavior of the system and its network
            integration. Network operators can leverage these metrics to monitor the system’s
            behavior, as well as for engineering analysis of the system’s processing and capacity.
            The metrics are available to examine on the system itself, and can also be retrieved by
            external systems for off-board analysis.</p>

        <p class="p">Deployment of the optional <span class="ph">NCC</span> telemetry package provides
            further options for measurement collection, storage, and retrieval. </p>

        <p class="p">NCC measurement pegging is performed by Prometheus, a third-party metrics and monitoring
            software package.</p>

        <div class="p">These Prometheus components are used in <span class="ph">NCC</span> for platform
                metrics:<ul class="ul" id="measurement_collection_overview__ul_a3m_xrw_llb">
                <li class="li">
                    <p class="p">Push gateway: configured on the admincli pod at port 9091, for supporting
                        short-lived jobs.</p>

                    <p class="p">The Prometheus push gateway exists to allow ephemeral and batch jobs to
                        expose their metrics to Prometheus. These kinds of jobs may not exist long
                        enough to be scraped, so they can instead push their metrics to a push
                        gateway. The push gateway then exposes these metrics to Prometheus. See
                            <span class="ph filepath">https://github.com/prometheus/pushgateway/blob/master/README.md</span>
                        for more information.</p>

                </li>

            </ul>

        </div>

        <div class="p">These additional components are optionally used in <span class="ph">NCC</span> for
            platform metrics: <ul class="ul" id="measurement_collection_overview__ul_wrv_wgm_1mb">
                <li class="li">Metrics Viewer: to allow for data visualization with multiple modes of graphing
                    and dashboarding support.</li>

                <li class="li">Alertmanager: to handle alerts.</li>

                <li class="li">Gen3GPPXML: generates a 3GPP XML file according to the customized metric set.
                    The metric value is retrieved from the Prometheus server through its REST
                    API.</li>

            </ul>

        </div>

        <p class="p">The <span class="ph">NCC</span> metrics system includes a Metrics Viewer for
            querying and visualizing metrics that are stored in Prometheus. The Metrics Viewer
            includes built-in Prometheus support with features that include a query editor with
            metric name lookup and template queries for generic dashboards.</p>

        <p class="p">If the optional <span class="ph">NCC</span> telemetry package is deployed, <span class="ph">NCC</span> is also capable of generating alarms when a given
            metric has exceeded a configured threshold. The configuration data controls which
            metrics, at what thresholds, have what alert severities. For more information, see <a class="xref" href="metrics_configuration.html">Metrics configuration with NCC Telemetry package</a></p>

        <p class="p">The <span class="ph">NCC</span> telemetry package offers a VES (Vendor Event Stream)
            option for streaming metrics (and logs, alarms) offboard into a single event stream per
            the VES specification (supporting ONAP, Open Network Automation Platform), to be
            consumed by the operator's VES collector. To enable this option, see the
                <span class="ph uicontrol">CVEA</span> section of the Input Generator spreadsheet.</p>

        <div class="section" id="measurement_collection_overview__section_syk_rzw_llb"><h2 class="title sectiontitle">Measurement structure and optional labels</h2>
            
            <p class="p">NCC metrics are structured with an object model that consolidates a rich set of
                information into a small number of metrics. This is achieved by virtue of adding
                labels to the metrics that provide several more levels of detail. For example, there
                is a single Diameter Inbound Count measurement, but there are labels for recording
                the Application (Gx, Gy, Sy, and so on), the Command (CCR, AAR, RAR, and so on), the
                RequestType (Initial Request, Update Request, and so on), Result code (Diameter
                Success, Diameter Limited Success, and so on), as well as information about the peer
                host and realm.</p>

            <div class="p">With this wealth of data, users can then examine the <span class="ph">NCC</span>
                metrics from a variety of dimensions to gain a detailed understanding of the system
                traffic and behavior. Questions such as the following can be answered:<ul class="ul" id="measurement_collection_overview__ul_n2q_tzw_llb">
                    <li class="li">How many Diameter requests succeeded or failed?</li>

                    <li class="li">How many CCR requests failed?</li>

                    <li class="li">How many CCR requests failed from a given Diameter realm?</li>

                </ul>
</div>

            <p class="p">In addition, some metrics are defined with a custom label. This provides an
                open-ended way of recording additional data in AVPs, with multiple AVPs able to be
                stored as a single custom label.</p>

            <table cellpadding="4" cellspacing="0" summary="" id="measurement_collection_overview__table_ss1_5mx_pxb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Addition of custom label</span></caption><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead class="thead" style="text-align:left;">
                        <tr class="row">
                            <th class="entry cellrowborder" style="vertical-align:top;" id="d46193e149">Scenario</th>

                            <th class="entry cellrowborder" style="vertical-align:top;" id="d46193e152">Examples</th>

                        </tr>

                    </thead>
<tbody class="tbody">
                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d46193e149 ">"chargingCharacteristics", "UUC", "MUU", and AggregatedUUC" in
                                http_3gpp inbound requests<p class="p">where</p>
<ul class="ul" id="measurement_collection_overview__ul_pg5_n4x_pxb">
                                    <li class="li">MUU: count of multiple unit usage per rating group</li>

                                    <li class="li">UUC: count of used unit container</li>

                                    <li class="li">AggregatedUUC: count of aggregated UUC per rating group</li>

                                    <li class="li">chargingCharacteristics: charging characteristics value</li>

                                </ul>
</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d46193e152 ">
                                <pre class="pre codeblock" id="measurement_collection_overview__codeblock_lvg_1nx_pxb"><code>http_3gpp_inbound_count{CustomLabel="{"sd":"AFB148","chargingCharacteristics":"0200","UUC":"7","sst":"1","AggregatedUUC":"2","MUU":"2","NodeFunctionality":"SMF"}",Enterprise="NA",Function="Nchf_ConvergedCharging_Update",Interface="N40",Result="SUCCESS",SourceIP="NA",Status="200",instance="localhost:9111",job="application_metrics"}</code></pre>
                            </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d46193e149 ">"normallyterminated" in http_3gpp inbound requests<p class="p">where</p>
<ul class="ul" id="measurement_collection_overview__ul_f43_q4x_pxb">
                                    <li class="li"><var class="keyword varname">normallyterminated=true</var> indicates that a
                                        call terminated normally</li>

                                    <li class="li"><var class="keyword varname">normallyterminated=false</var> indicates that a
                                        call terminated abnormally.</li>

                                    <li class="li">Terminated session is categorized as normally/abnormally
                                        retained in database for Gy/N40 call</li>

                                </ul>
</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d46193e152 ">
                                <pre class="pre codeblock" id="measurement_collection_overview__codeblock_ycd_dnx_pxb"><code>http_3gpp_inbound_count{CustomLabel="{"sd":"AFB148","chargingCharacteristics":"0200","UUC":"7",normallyterminated":"true","sst":"1","AggregatedUUC":"2","MUU":"2","NodeFunctionality":"SMF"}",Enterprise="NA",Function="Nchf_ConvergedCharging_Release",Interface="N40",Result="SUCCESS",SourceIP="NA",Status="200",instance="localhost:9111",job="application_metrics"}  </code></pre>
                                <pre class="pre codeblock" id="measurement_collection_overview__codeblock_n5j_dnx_pxb"><code>http_3gpp_inbound_count{CustomLabel="{"sd":"AFB148","chargingCharacteristics":"0200","UUC":"7",normallyterminated":"false","sst":"1","AggregatedUUC":"2","MUU":"2","NodeFunctionality":"SMF"}",Enterprise="NA",Function="Nchf_ConvergedCharging_Release",Interface="N40",Result="SUCCESS",SourceIP="NA",Status="200",instance="localhost:9111",job="application_metrics"}</code></pre>
                            </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d46193e149 ">"normallyterminated" in diameter requests<p class="p">where</p>
<ul class="ul" id="measurement_collection_overview__ul_kvy_txx_pxb">
                                    <li class="li"><var class="keyword varname">normallyterminated=true</var> indicates that a
                                        call terminated normally</li>

                                    <li class="li"><var class="keyword varname">normallyterminated=false</var> indicates that a
                                        call terminated abnormally.</li>

                                    <li class="li">Terminated session is categorized as normally/abnormally
                                        retained in database for Gy/N40 call</li>

                                </ul>
</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d46193e152 ">
                                <pre class="pre codeblock" id="measurement_collection_overview__codeblock_zjd_k5x_pxb"><code>diameter_inbound_count{Application="CreditControl",Command="CCR",CustomLabel="{"MSCC":"1","normallyTerminated":"true","ServiceContext":"32251@3gpp.org"}",Enterprise="NA",IngressPeerOriginHost="NA",IngressPeerOriginRealm="NA",OriginHost="NA",OriginRealm="NA",RequestType="INITIAL_REQUEST (1)",Result="DIAMETER_SUCCESS",instance="localhost:9111",job="application_metrics"}</code></pre>
                            </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d46193e149 ">"MSCC" and "ServiceContext" in diameter_inbound
                                    request<p class="p">where</p>
<var class="keyword varname">MSCC</var>: count of MSCC per
                                call</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d46193e152 ">
                                <pre class="pre codeblock" id="measurement_collection_overview__codeblock_jjs_gnx_pxb"><code>diameter_inbound_count{Application="CreditControl",Command="CCR",CustomLabel="{"MSCC":"1","normallyTerminated":"true","ServiceContext":"32251@3gpp.org"}",Enterprise="NA",IngressPeerOriginHost="NA",IngressPeerOriginRealm="NA",OriginHost="NA",OriginRealm="NA",RequestType="IN</code></pre>
                            </td>

                        </tr>

                    </tbody>
</table>

            <div class="note" id="measurement_collection_overview__note_hj2_t5x_pxb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Detailed metric information of each custom label is
                available in the Metrics Spreadsheet.</div>

        </div>

        <div class="section" id="measurement_collection_overview__section_dks_kzw_llb"><h2 class="title sectiontitle">Measurement collection (NCC telemetry package)</h2>
            
            <p class="p">If using the optional <span class="ph">NCC</span> telemetry package, metrics are
                gathered onto the central Prometheus server pods in each NCC. Both Prometheus server
                pods run the Prometheus server and both actively collect measurement data from the
                clients and store the data in their own local databases, such that all metrics data
                continues to be available following a failure of one Prometheus server pods. A
                Prometheus client runs on all the nodes that are recording metrics to be collected
                by the Prometheus server.</p>

            <p class="p">Prometheus provides a multi-dimensional data model with time series data identified
                by metric name and key/value pairs. A flexible query language is supported for
                retrieving data from the database.</p>

            <p class="p">The Prometheus GUI URL can be configured using the helm charts on installation. For
                more information, see the <cite class="cite">Installation and Upgrade Guide</cite>.</p>

        </div>

        <div class="section" id="measurement_collection_overview__section_qq1_wzw_llb"><h2 class="title sectiontitle">Storage and retrieval of metrics in 3GPP XML files (NCC telemetry
                package)</h2>
            
            <p class="p">Each <span class="ph">NCC</span> SM and ME system periodically (for example,
                every 5 minutes) retrieves metrics data from Prometheus and records it into 3GPP XML
                files in the <span class="ph filepath">/var/3gppxml</span> directory. These files are then made
                available for northbound OSS systems (including Nokia NetAct) to retrieve by SFTP.
                This is achieved via the Gen3GPPPXML script that is part of the Gen3GPPPXML
                container in the cpro-gen3gppxml pod.</p>

            <div class="p">The files are named using this
                format:<pre class="pre codeblock"><code>&lt;date&gt;.&lt;starttime&gt;-&lt;endtime&gt;_&lt;sitename&gt;-&lt;nodename&gt;</code></pre></div>

            <div class="p">where:<pre class="pre codeblock"><code>&lt;date&gt; = YYYYMMDD
&lt;starttime&gt; = HHMMZ (where Z is a timezone for example, -0700)
&lt;endtime&gt; = HHMMZ (where Z is a timezone for example, -0700)
&lt;sitename&gt; = The name given to the <span class="ph">NCC</span> site.
&lt;nodename&gt; = The node name or container name in <span class="ph">NCC</span> that recorded the
measurement.</code></pre></div>

            <p class="p">For example: <code class="ph codeph">A20190131.1800+0000-1805+0000_sps-me-1-diameterapp-13</code>
            </p>

            <p class="p">Gen3GPPXML generates one XML file for one instance by default. The instance name is
                appended to the filename. If the postFix is set with an non-empty value all the
                measurement data for all the nodes is written into one XML file, then
                    <code class="ph codeph">gen3gppxmlDefaultPostFix</code> is appended to the filename.</p>

            <p class="p">For example: <code class="ph codeph">A20181226.1849+0000-1850+0000_gen3gppxmlDefaultPostFix</code>
            </p>

            <p class="p">By Default, only those metrics that are configured in the Gen3GPPXML tool and
                available in Prometheus are recorded. If you want to record all of the configured
                metrics in the XML file regardless of their availability in Prometheus, you must
                install Gen3GPPXML with <code class="ph codeph">hideNonExistentMetrics</code> set to
                    <code class="ph codeph">false</code> in the Gen3GPPXML override file. For more information on
                overrides, see the <cite class="cite">Changing values with a custom override YAML file</cite>
                section in the <cite class="cite">Installation and Upgrade Guide</cite>.</p>

            <p class="p">Inside the XML file, there are indicators for the end time of the collection interval
                and the duration of that interval, in seconds. There may be multiple metrics in each
                group, with their names and measurement values clearly indicated.</p>

            <p class="p">There is a separate XML entry for each combination of metric values recorded during
                this interval. If a "Last Interval" type metric value (for example,
                diameter_inbound_average_latency_last_interval) has not changed during the last
                interval, it will not appear in the XML file. Metric values for other metrics are
                continually recorded in the XML file.</p>

            <div class="p">This example shows the format within the XML files. Each metric has many labels but
                each metric has a single value and in the XML
                file.<pre class="pre codeblock"><code>&lt;granPeriod duration="PT300S" endTime="2019-02-05T06:55:00+00:00" /&gt;
&lt;repPeriod duration="PT300S" /&gt;
&lt;measType p="1"&gt;diameter_inbound_sum&lt;/measType&gt;
&lt;measType p="2"&gt;diameter_inbound_count&lt;/measType&gt;
&lt;measType p="3"&gt;diameter_inbound_rate&lt;/measType&gt;
&lt;measType p="4"&gt;diameter_inbound_average_latency_overall&lt;/measType&gt;
&lt;measType p="5"&gt;diameter_inbound_average_latency_last_interval&lt;/measType&gt;
&lt;measValue measObjLdn="app=1, dia=1, host=ME-2-diameterapp-0,
Application=Gx, Command=CCR, RequestType=INITIAL_REQUEST (1),
Result=DIAMETER_SUCCESS, OriginHost=NA, IngressPeerOriginHost=NA,
CustomLabel={}"&gt;
&lt;r p="1"&gt;1390744&lt;/r&gt;
&lt;r p="2"&gt;109246&lt;/r&gt;
&lt;r p="3"&gt;2.7228070175438592&lt;/r&gt;
&lt;r p="4"&gt;12.73076500430395&lt;/r&gt;
&lt;r p="5"&gt;11.13917525773196&lt;/r&gt;
&lt;/measValue&gt;
</code></pre></div>

            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> <p class="p">MVNO Disable:</p>

                <p class="p">If the MVNO feature is disabled, no Enterprise label is added and metrics will go
                    under the common XML files.</p>

                <p class="p">MVNO Enable:</p>

                <p class="p">Example 1:</p>

                <p class="p">If MVNO is enabled from both the application (service providers need to be
                    enabled from the application preferences from SM) and Prometheus (a new flag to
                    enable/disable MVNO is added in <span class="ph filepath">Inputs.xlsx</span> under the
                    common tab), a new Enterprise label is added in the metrics. The Enterprise
                    label can have a value of MNO/MVNO and the Gen3gppxml file is created with the
                    Enterprise value appended to it.</p>

                <p class="p">This is an example metrics in Prometheus:</p>

                <pre class="pre codeblock"><code>http_count_last_interval{ContextRoot="NA", CustomLabel="{}", Enterprise="MVNO1", HttpMethod="GET", SourceIP="NA", Status="200", app="ig-notification", app_kubernetes_io_component="Push-Notifications", app_kubernetes_io_instance="ig-notification", app_kubernetes_io_managed_by="Helm", app_kubernetes_io_name="notification", app_kubernetes_io_part_of="NCC", app_kubernetes_io_version="22.0.1-108", chart="notification-22.0.1-108", heritage="Helm", instance="sps-ig-192.168.9.209:9111", job="kubernetes-istio-secure-endpoints", kubernetes_io_hostname="nc1614node07", kubernetes_name="ig-notification-headless", kubernetes_namespace="sps-ig", kubernetes_pod_name="sps-igig-notification-6cd96d99bb-xwww8", release="ig-notification"}
                </code></pre>
                <pre class="pre codeblock"><code>A20211206.1110+0000-1115+0000_sps-ig-192.168.9.209_MVNO1</code></pre>
                <p class="p">Example 2:</p>

                <p class="p">If MVNO is enabled on both the application and Prometheus level but in some rare
                    case when the application is unable to get the MNO/MVNO Id, then the Enterprise
                    value sent by the application is <code class="ph codeph">NA</code>, which is suppressed at the
                    Prometheus level and the Enterprise label value is shown as
                        <code class="ph codeph">default</code>. </p>

                <pre class="pre codeblock"><code>http_count_last_interval{ContextRoot="NA", CustomLabel="{}", Enterprise="default", HttpMethod="GET", SourceIP="NA", Status="200", app="ig-provisioning", app_kubernetes_io_component="System-Configuration-and-Management", app_kubernetes_io_instance="ig-provisioning", app_kubernetes_io_managed_by="Helm", app_kubernetes_io_name="provisioning", app_kubernetes_io_part_of="NCC", app_kubernetes_io_version="22.0.1-108", chart="provisioning-22.0.1-108", heritage="Helm", instance="sps-ig-192.168.105.112:9111", job="kubernetes-istio-secure-endpoints", kubernetes_io_hostname="nc1614node12", kubernetes_name="ig-provisioning-headless", kubernetes_namespace="sps-ig", kubernetes_pod_name="sps-igig-provisioning-774979f5d9-r7xhf", release="ig-provisioning"}
                </code></pre>
                <pre class="pre codeblock"><code>A20211206.1110+0000-1115+0000_sps-ig-192.168.105.112_default</code></pre>
                
                <p class="p">Example 3:</p>

                <p class="p">If MVNO is enabled on both the application and Prometheus level, but no
                    Enterprise label is sent in the metrics by the application, the Enterprise value
                    is added by the Prometheus with a default label value. This value is
                    configurable by editing the <code class="ph codeph">defaultLabelValue:</code> value in the
                    Prometheus override file
                        (<span class="ph filepath">/input-generator/output/btel1/charts/btel-cpro.yaml</span>).</p>

                <pre class="pre codeblock"><code>mvno:
defaultLabelValue: default
enable: true
labelName: Enterprise
labelValueToBeReplaced: NA</code></pre>
            </div>

            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Some of the metrics are noted as being calculated by applying Prometheus rules on
                other collected metrics, demarcated by the phrase "<code class="ph codeph">(NCC telemetry
                    package)</code>". These are only available if the <span class="ph">NCC</span> Telemetry package is deployed, or if the operator
                implements these rules in their own Prometheus server. Nokia can provide these rules
                upon request.</div>

            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> 
                <div class="p">For average_latency_last_interval, this is the change in latency over a
                    configurable period of time, which can be increasing as well as decreasing. For
                    example, using the diameter_inbound_sum and diameter_inbound_count metrics, the
                    average_latency_last_ interval is calculated as
                    follows:<pre class="pre codeblock"><code>rate(diameter_outbound_sum[&lt;period&gt;]) / rate(diameter_outbound_count[&lt;period&gt;])</code></pre></div>

                <p class="p">Where for example, in the last <code class="ph codeph">&lt;period&gt;</code> (let’s say period of
                    5 minutes), the first value of <code class="ph codeph">diameter_inbound_sum</code> is S1, and
                    the last value of <code class="ph codeph">diameter_inbound_sum</code> is S5. Then:
                    "rate(diameter_inbound_sum[])" is equal to "(S5 - S1) / 300s" and in the last ,
                    the first value of "diameter_inbound_count" is C1, and the last value of
                    "diameter_inbound_count" is C5. Then: "rate(diameter_inbound_count[5 minutes])"
                    is equal to "(C5 - C1) / 300s" Then the average latency in the last 5 minutes is
                    as follows:</p>

                <p class="p">((S5 - S1) / 300s) / ((C5 - C1) / 300s) </p>

            </div>

            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> 
                <p class="p">The value of any of the <code class="ph codeph">count since last interval</code> metrics is an
                    extrapolated value and never an exact value. This behavior is from the way that
                    Prometheus does the calculation. This is calculated using the increase( )
                    function; for example, <code class="ph codeph">increase(diameter_inbound_ count[10m])</code>
                    or <code class="ph codeph">increase(ldap_count[10m])</code>. The "Increase()" function uses a
                    minimum of two data points over a time period and based on these two data points
                    a change in count since last interval value is calculated. Prometheus does an
                    approximation because it calculates count since last interval in a fail safe way
                    that is resistant to failures such as scrape miss, node restarts, and so on.</p>

                <p class="p">The recommended value for last interval (default 10 minutes), should be at least
                    twice that of the granularity period gen3gppxml/default_gran_period) defined in
                    Gen3GPPXML tool. This is to ensure that the Gen3GPPXML tool, would be able to
                    take the snapshot of count since last interval metrics at least once. For
                    example, if the granularity period configured is 300s (5 minutes), configure the
                    last interval window in count since last interval metrics as 10 minutes.</p>

            </div>

            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> 
                <div class="p">When an incoming 5G message arrives at an <span class="ph">NCC</span> ME
                    over HTTP/2, it may be site-routed to another home <span class="ph">NCC</span> ME. For example, consider a case where an
                    incoming N40 request that first lands on ME1 is system-routed to ME2, which is
                    the home for the device (SMF &gt; ME1 &gt; ME2). The metrics for this example are
                    established as follows:<ul class="ul" id="measurement_collection_overview__ul_wv1_pkt_mlb">
                        <li class="li">On ME1, http_3gpp_inbound metrics are pegged along with the site_routing
                            metric pegged with the “InProtocol” label indicating “http_3gpp” and the
                            “Decision” label indicating “message sent to primary”.</li>

                        <li class="li">From ME1 to ME2, the message is forwarded over HTTP/2.</li>

                        <li class="li">On ME2, the http_3gpp_inbound metrics are pegged to set the
                            “DiameterApp” label to N40 (for this example). The site_routing metric
                            is then pegged with the “InProtocol” label indicating ‘http_3gpp’ and
                            the “Decision” label indicating “processed locally”.</li>

                    </ul>
</div>

            </div>

        </div>

        <div class="section"><h2 class="title sectiontitle">Aerospike metrics</h2>
            
            <div class="p">Aerospike metrics are configured via the Input-Generator tool
                    (<span class="ph filepath">Inputs.xlsx</span>). To enable or disable Aerospike metrics, you
                must generate new overrides and perform Helm chart upgrades for Prometheus and
                Aerospike. For more information on configuring these metrics, see the
                    <cite class="cite">Configuring Aerospike metrics for Prometheus</cite> section in the
                    <cite class="cite">Installation and Upgrade Guide</cite>.<div class="note" id="measurement_collection_overview__note_zkh_rxm_jyb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Upgrading the Aerospike charts may cause traffic failures.</div>
</div>

        </div>

    </div>
<div class="footer"><hr /><p>Operations, Administration, and Maintenance Guide • P556766-DN1000055092-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>