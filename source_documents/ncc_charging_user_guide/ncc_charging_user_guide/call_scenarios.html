<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Call scenarios for Event Charging with Unit Reservation calls" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="id9yz-09126-ug01-pczza-sp1-d1e238190" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Call scenarios for Event Charging with Unit Reservation calls</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="id9yz-09126-ug01-pczza-sp1-d1e238190">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Call scenarios for Event Charging with Unit Reservation calls</h1>
<div class="body conbody">
<div class="section"><h2 class="title sectiontitle">Call controller end-to-end SMS call</h2>
<p class="p">Consider that call controller uses a credit request profile and PDF rules to determine <em class="ph i">CallType</em>, <em class="ph i">subCallType</em>, and <em class="ph i">Roaming</em> status. The call controller interface accepts and processes the call from the network, and then interfaces directly with the Rating Engine where rating rules determine the applicable charging service. The Rating Engine uses applicability conditions and tariffs to charge from a bucket using more PDF rules.</p>

<p class="p">After processing the CCR message, call controller retrieves the actions from the Rating Engine and constructs a CCA message by populating its GSU, thresholds, and VT for each MSCC in the MSCC list from the CCR message.</p>

<p class="p">The device lifecycle is invoked on device attached. For CCR-E or CCR-I message with a successful command result code, the call controller <em class="ph i">sessionManager</em> notifies the <em class="ph i">lifeCycleManager</em> to handle the state transition before sending the response with CCA message.</p>

<div class="p">In this example, following CCR-I contains the AVPs available for ECUR for the destination host or
    realm and session ID (pcef1.diam.originRealm1.com;343039;1521266195) on the Gy and Ro
     interface:<table cellpadding="4" cellspacing="0" summary="" id="id9yz-09126-ug01-pczza-sp1-d1e238190__useofcallcontrolavpsiec-6629d81d" class="table" width="100%" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Use of call control AVPs ECUR</span></caption><colgroup><col /><col /><col /><col /></colgroup><thead class="thead" style="text-align:left;">
       <tr class="row">
        <th class="entry cellrowborder" style="vertical-align:top;" id="d12651e74">
         <p class="p">First level AVP name</p>

       </th>

        <th class="entry cellrowborder" style="vertical-align:top;" id="d12651e80">
         <p class="p">Second level AVP name</p>

       </th>

        <th class="entry cellrowborder" style="vertical-align:top;" id="d12651e86">
         <p class="p">Lowest level AVP name</p>

       </th>

        <th class="entry cellrowborder" style="vertical-align:top;" id="d12651e92">
         <p class="p">Example values</p>

       </th>

       </tr>

      </thead>
<tbody class="tbody">
       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Session-Id</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">pcef1.diam.originRealm1.com;343039;1521266195</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Origin-Host</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">pcef1.diam.originRealm1.com</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Origin-Realm</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">originRealm1.com</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Destination-Realm</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">jRealm</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Auth-Application-Id</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 "> -</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 "> -</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 "> 4</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Service-Context-Id</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">32274@3gpp.org</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">CC-Request-Number</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">0</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">CC-Request-Type</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">1 (INITIAL_REQUEST)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Origin-State-Id</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">1473342807</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Event-Timestamp</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">Sep 8, 2016 1:53:31 PM</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="2" style="vertical-align:top;" headers="d12651e74 "> Subscription-Id</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">Subscription-Id-Data</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">390000000000001 and Grouped Value 2</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">Subscription-Id-Type</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">
         <p class="p">IMSI</p>

         <p class="p">E.164</p>

       </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Multiple-Services-Indicator</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">1 (MULTIPLE_SERVICES_SUPPORTED)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">service-context-Id</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">32274@3gpp.org</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">User-Name</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">-</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">CC-Correlation-Id</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 "> -</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 "> -</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 "> &gt;</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e74 ">Termination-Cause</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">5</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="2" style="vertical-align:top;" headers="d12651e74 "> User-Equipment-Info</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">User-Equipment-Info-Type</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">0 (IMEISV)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">User-Equipment-Info-Value</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">4970686f6e65 (iPhone)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="9" style="vertical-align:top;" headers="d12651e74 "> Multiple-Services-Credit-Control</td>

        <td class="entry cellrowborder" rowspan="6" style="vertical-align:top;" headers="d12651e80 "> Requested-Service-Unit</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">CC-Time</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">10</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">CC-Money</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">Unit-Value, Currency-Code</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">CC-Total-Octets</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">225</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">CC-Input-Octets</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">200</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">CC-Output-Octets</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">25</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">CC-Service-Specific-Units</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">1</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">Service-Identifier</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">121</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">Rating-Group</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">8</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">Reporting-Reason</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">-</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">8 (POOL_EXHAUSTED)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="9" style="vertical-align:top;" headers="d12651e74 "> Service-Information</td>

        <td class="entry cellrowborder" rowspan="8" style="vertical-align:top;" headers="d12651e80 ">
         <p class="p">PS-Information</p>

         <p class="p">(based on 32.274, sub set of 32.299)</p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">User-Equipment-Info</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">-</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">User-Equipment-Info-Type</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">0 (IMEISV)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">User-Equipment-Info-Value</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">01010101</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">3GPP-User-Location-Info</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">-</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">3GPP-RAT-Type</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">6 (EUTRAN)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">3GPP-MS-TimeZone</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">1100 (GMT + 2 hours 45 minutes No Adjustment)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">
         <p class="p">PDP-Address</p>

         <p class="p">PDP-Address Family </p>

         <p class="p">PDP-Address Address</p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">
         <p class="p">–PDP-Address Family = 1 (IPv4)</p>

         <p class="p">–PDP-Address Address = 94.1.21.1.1</p>

       </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">3GPP-SGSN-MCC-MNC</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">302720</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">SMS-Information</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">
         <p class="p">Client-Address</p>

         <p class="p">Client-Address Family</p>

         <p class="p">Client-Address Address</p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">
         <p class="p">Client-Address Family = 1 (IPv4)</p>

         <p class="p">Client-Address Address = 94.1.21.1.2</p>

       </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="9" style="vertical-align:top;" headers="d12651e74 "> Service-Information (continued)</td>

        <td class="entry cellrowborder" rowspan="2" style="vertical-align:top;" headers="d12651e80 "> Originating-SCCP-Address</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Originating-SCCP-Address Family</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">1 (IPv4)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Originating-SCCP-Address Address</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">94.1.21.1.3</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="5" style="vertical-align:top;" headers="d12651e80 "> Originator-Received-Address</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Address-Type</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">2 (IPv4 Address)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Address-Data</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">94.21.1.4</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Address-Domain</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 "> </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Domain-Name</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">vfit.com</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">3GPP-IMSI-MCC-MNC</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">310015</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="2" style="vertical-align:top;" headers="d12651e80 "> SMSC-Address</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">SMSC-Address Family</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">1 (IPv4)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">SMSC-Address Address</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">94.1.21.1.5</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="7" style="vertical-align:top;" headers="d12651e74 "> Service-Information (continued)</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e80 ">SM-Message-Type</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 "> </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">0 (SUBMISSION)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="4" style="vertical-align:top;" headers="d12651e80 "> Originator-Interface</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Interface-Id</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">mobile</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Interface-Port</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">8999</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Interface-Text</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">SMSTEXT</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Interface-Type</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">1 (MOBILE_ORIGINATING)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="2" style="vertical-align:top;" headers="d12651e80 "> Recipient Info</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">
         <p class="p">Destination interfaces:</p>

         <ul class="ul">
          <li class="li">
           <p class="p">Interface-Id</p>

          </li>

          <li class="li">
           <p class="p">Interface-Port</p>

          </li>

          <li class="li">
           <p class="p">Interface-Text</p>

          </li>

          <li class="li">
           <p class="p">Interface-Type</p>

          </li>

         </ul>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">
         <p class="p">Destination interfaces (example)</p>

         <ul class="ul">
          <li class="li">
           <p class="p">Interface-Id = mobile</p>

          </li>

          <li class="li">
           <p class="p">Interface-Port = 8999</p>

          </li>

          <li class="li">
           <p class="p">Interface-Text = SMSTEXT</p>

          </li>

          <li class="li">
           <p class="p">Interface-Type = 1 (MOBILE_ORIGINATING)</p>

          </li>

         </ul>

       </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">
         <p class="p">Recipient-Address</p>

         <p class="p">Address-Type </p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">2 (IPv4 Address)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="7" style="vertical-align:top;" headers="d12651e74 "> Service-Information (continued)</td>

        <td class="entry cellrowborder" rowspan="7" style="vertical-align:top;" headers="d12651e80 "> </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Address-Data</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">94.21.1.6</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Address-Domain</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 "> </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">
         <p class="p">Domain-Name</p>

         <p class="p">3GPP-IMSI-MCC-MNC</p>

         <p class="p">Addressee-Type</p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">
         <p class="p">Example values:</p>

         <ul class="ul">
          <li class="li">
           <p class="p">Domain-Name = vfit.com;</p>

          </li>

          <li class="li">
           <p class="p">3GPP-IMSI-MCC-MNC = 310015</p>

          </li>

          <li class="li">
           <p class="p">Addressee-Type = 0 (TO)</p>

          </li>

         </ul>

       </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">
         <p class="p">Recipient-Received-Address</p>

         <p class="p">Address-Type </p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">Address-Type = 2 (IPv4 Address)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Address-Data</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">Address-Data = 94.21.1.7</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">Address-Domain</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 "> </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">
         <p class="p">Domain-Name</p>

         <p class="p">3GPP-IMSI-MCC-MNC </p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">
         <p class="p">Domain-Name = vfit.com</p>

         <p class="p">3GPP-IMSI-MCC-MNC = 310015</p>

       </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" rowspan="3" style="vertical-align:top;" headers="d12651e74 "> Service-Information (continued)</td>

        <td class="entry cellrowborder" rowspan="3" style="vertical-align:top;" headers="d12651e80 "> </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">
         <p class="p">Recipient-SCCP-Address</p>

         <p class="p">SMSC-Address Family </p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">SMSC-Address Family = 1 (IPv4)</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">SMSC-Address Address</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">SMSC-Address Address = 94.1.21.1.8</td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e86 ">SM-Protocol-ID</td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e92 ">00000004</td>

       </tr>

      </tbody>
</table>
</div>

<div class="p">The Call Type is processed from the credit request profile as SMS and generates the following
    rule tables within the contexts of call controller and CCR-I:<table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><colgroup><col /><col /></colgroup><thead class="thead" style="text-align:left;">
       <tr class="row">
        <th class="entry cellrowborder" style="vertical-align:top;" id="d12651e1024">
         <p class="p">If...</p>

       </th>

        <th class="entry cellrowborder" style="vertical-align:top;" id="d12651e1030">
         <p class="p">Then...</p>

       </th>

       </tr>

      </thead>
<tbody class="tbody">
       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e1024 ">
         <p class="p">
          <em class="ph i">Rule table 1:</em>
         </p>

         <p class="p">
          <kbd class="ph userinput">GY_MESSAGE. Service-Context-Id</kbd> == <var class="keyword varname">32274@3gpp.org</var>
         </p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e1030 ">
         <kbd class="ph userinput">CALL_RESULT.Default-Roaming-Decision</kbd> =
          <var class="keyword varname">RoamingDecision.HOME</var>
       </td>

       </tr>

       <tr class="row">
        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e1024 ">
         <p class="p">
          <em class="ph i">Rule table 2:</em>
         </p>

         <p class="p">
          <kbd class="ph userinput">GY_MESSAGE. Multiple-Services-Credit-Control.Rating-Group</kbd> ==
           <var class="keyword varname">8</var>
         </p>

       </td>

        <td class="entry cellrowborder" style="vertical-align:top;" headers="d12651e1030 ">
         <kbd class="ph userinput">CALL_RESULT.Call-Sub-Type</kbd> = <var class="keyword varname">CallSubType.SMS_MO</var>
       </td>

       </tr>

      </tbody>
</table>
</div>

<p class="p">When the credit request profile based rules are evaluated, the <em class="ph i">Call Type</em> is processed and the rule tables are matched to configure the <em class="ph i">Roaming Status</em> as <var class="keyword varname">HOME</var> and the <em class="ph i">call-Sub-Type</em> as <var class="keyword varname">SMS-MO</var> indicating a mobile SMS message, which means the <em class="ph i">CALL_RESULT ResultContext</em> are returned as the following policy decision results:</p>
<ul class="ul">
<li class="li">
<p class="p">
<kbd class="ph userinput">CALL_RESULT.Default-Roaming-Decision</kbd> = <var class="keyword varname">HOME</var>
</p>

</li>

<li class="li">
<p class="p">
<kbd class="ph userinput">CALL_RESULT.Call-Sub-Type</kbd> = <var class="keyword varname">SMS_MO</var>
</p>

</li>

</ul>

<p class="p">Call controller processes the CCR using the <em class="ph i">service Id</em> to request a number of units for the call as follows:</p>
<ul class="ul">
<li class="li">
<p class="p">
<kbd class="ph userinput">requestedUnit</kbd>
</p>

</li>

<li class="li">
<p class="p">
<kbd class="ph userinput">TIME:10</kbd>
</p>

</li>

<li class="li">
<p class="p">
<kbd class="ph userinput">TVOL:225</kbd>
</p>

</li>

<li class="li">
<p class="p">
<kbd class="ph userinput">IVOL:200</kbd>
</p>

</li>

<li class="li">
<p class="p">
<kbd class="ph userinput">OVOL:25</kbd>
</p>

</li>

<li class="li">
<p class="p">
<kbd class="ph userinput">SERVICE_SPECIFIC:1</kbd>
</p>

</li>

</ul>

<p class="p">A call context is created for the session <var class="keyword varname">pcef1.diam.originRealm1.com;343039;1521266195</var> triggering a call to the Rating Engine to get a rating request for the session. Upon evaluating and matching the <span class="ph uicontrol">Rating Rule</span> table, <var class="keyword varname">Applicability Condition_SMS_1</var> (the third rule table), a value of true is added for the <samp class="ph systemoutput">RATING.Charging-Service-Applicable</samp> action.</p>

<p class="p">The <span class="ph uicontrol">Rating Rule</span> table in the Rating Engine evaluates how a call is charged by matching a rule that adds a tariff action to select a value from the <em class="ph i">SMSbucket</em>. The bucket balance is checked and if there is enough in the bucket balance, then the amount requested is deducted and reserved. A response is then updated with the granted service units as requested in a CCA message.</p>

<p class="p">The CCA contains the given AVPs for the destination host/realm and session id (<var class="keyword varname">pcef1.diam.originRealm1.com;343039;1521266195</var>) on the Gy and Ro interface:</p>
<ul class="ul">
<li class="li">
<p class="p">
<em class="ph i">Result-Code with Value(s):2001</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Request-Type with Value(s):1</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Request-Number with Value(s):0</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">Multiple-Services-Credit-Control with Value(s): Grouped Value 1</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">Granted-Service-Unit with Value(s): Grouped Value 1</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Time with Value(s):0</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Money = Unit Value=1, Currency Code=Euro</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Total-Octets with Value(s):0</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Input-Octets with Value(s):0</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Output-Octets with Value(s):0</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Service-Specific-Units with Value(s):1</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">Service-Identifier with Value(s):121</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">Rating-Group with Value(s):8</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">Result-Code with Value(s):2001</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">Validity-Time with Value(s):10</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">Credit-Control-Failure-Handling with Value(s):0</em>
</p>

</li>

<li class="li">
<p class="p">
<em class="ph i">CC-Session-Failover with Values(s):0</em>
</p>

</li>

</ul>

</div>

<div class="section"><h2 class="title sectiontitle">Call Controller failure handling</h2>
<p class="p">A call controller supports the <em class="ph i">Credit-Control-Failure-Handling</em> AVP in the CCA (Initial and Update) and <em class="ph i">CC-Session-Failover</em> in the CCA (Initial and Update) through RSV.</p>

<div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> 
<em class="ph i">CCFH</em> and <em class="ph i">CCSF</em> AVPs are not supported at MSCC level, and are supported at root level only. Therefore, rules cannot be applied at MSCC level for <em class="ph i">CCFH</em> and <em class="ph i">CCSF</em> AVPs, and, <em class="ph i">CCFH</em> and <em class="ph i">CCSF</em> AVPs are not applicable for IEC calls.</div>

<div class="sectiondiv">
<p class="p"><strong class="ph b">Credit-Control-Failure-Handling AVP</strong></p>

<p class="p">NCC supports the following values of the <em class="ph i">Credit-Control-Failure-Handling</em> AVP in a CCA
     message:</p>
<ul class="ul">
<li class="li">
<p class="p">
<var class="keyword varname">TERMINATE (0)</var>
</p>

</li>

<li class="li">
<p class="p">
<var class="keyword varname">CONTINUE (1)</var>
</p>

</li>

<li class="li">
<p class="p">
<var class="keyword varname">RETRY_AND_TERMINATE (2)</var>
</p>

</li>

<li class="li">
<p class="p">
<var class="keyword varname">IGNORE (3)</var>
</p>

</li>

</ul>

<p class="p">NCC performs the following logic based on the values set:</p>
<ul class="ul">
<li class="li">
<p class="p">If the value of <em class="ph i">CCFH</em> AVP is configured as <var class="keyword varname">IGNORE</var> in active RSV, then <em class="ph i">CCFH</em> AVP is not returned in CCA message.</p>

</li>

<li class="li">
<p class="p">If the value is <var class="keyword varname">NULL</var>, then <em class="ph i">CCFH</em> AVP is returned in CCA message as <var class="keyword varname">TERMINATE</var>.</p>

</li>

</ul>

<p class="p">The values of CCFH can be configured as an output of the rule as shown in the following figure.
     To do this, log into the SM GUI and navigate to <span class="ph uicontrol">Common Configuration</span>
     &gt; <span class="ph uicontrol">Charging</span> tab and select <span class="ph uicontrol">Rules and Variables</span>
     from the drop-down list.</p>

<div class="fig fignone"><span class="figcap"><span class="fig--title-label">Figure: </span>CCFH sample </span>
     
     
 <a href="../images/img9yz-09126-ug01-pczza-sp1-ccfh1_default.png" class="image"><img class="image break scalefit" src="../images/img9yz-09126-ug01-pczza-sp1-ccfh1_default.png" height="240" width="720" /></a>
    </div>

</div>
<div class="sectiondiv">
<p class="p"><strong class="ph b">CC-Session-Failover AVP</strong></p>

<p class="p">The <em class="ph i">CC-Session-Failover</em> AVP contains information about whether moving the credit-control message stream to a backup server during an ongoing credit-control session is supported. It can have either of the following values:</p>
<ul class="ul">
<li class="li">
<p class="p">
<var class="keyword varname">FAILOVER_NOT_SUPPORTED (0)</var>
</p>

</li>

<li class="li">
<p class="p">
<var class="keyword varname">FAILOVER_SUPPORTED(1)</var>
</p>

</li>

<li class="li">
<p class="p">
<var class="keyword varname">IGNORE (2)</var>
</p>

</li>

</ul>

<p class="p">The value of this AVP is selected while processing an active RSV. If the value is configured as <var class="keyword varname">IGNORE</var> or the default parameter is missing in the active RSV, then the <em class="ph i">CCSF</em> AVP is not returned in a CCA message.</p>

<div class="p">The values of the <em class="ph i">CCSF</em> AVP can be configured as an output of the rule as shown in the
     following figure. To do this, log into the SM GUI and navigate to <span class="ph uicontrol">Platform &amp;
      Common</span> &gt; <span class="ph uicontrol">Charging</span> tab and select <span class="ph uicontrol">Rules and
      Variables</span> from the drop-down list.<div class="fig fignone"><span class="figcap"><span class="fig--title-label">Figure: </span>CCSF sample</span>
      
      
       <a href="../images/img9yz-09126-ug01-pczza-sp1-ccsf_default.png" class="image"><img class="image break scalefit" src="../images/img9yz-09126-ug01-pczza-sp1-ccsf_default.png" height="252" width="720" /></a>
     </div>
</div>

</div>
</div>

</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>