<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Session virtual counter" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="svc" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Session virtual counter</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="svc">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Session virtual counter</h1>
<div class="body conbody">
        <p class="p">Session virtual counter enables the operator to configure caps for subscribers for the
            entire charging session, whether the session is data, IMS, or SMS/MMS. For example, for
            a subscriber it can be configured in such a way that he cannot spend more than 40 Euros
            from his account per session.</p>

        <div class="section" id="svc__section_wp5_lrl_ypb"><h2 class="title sectiontitle">Configuration</h2><p class="p">Session virtual counter can
                be configured in charging rules using the action attribute
                    <span class="keyword cmdname">SESSION_PARAMETER.Session-Virtual-Counters</span>. For more
                information about the applicable triggers, refere to section <a class="xref" href="resultcontext_and_actions_session_parameters_result_context.html">SESSION_PARAMETERS result context</a>. See
                the following example for configuring two session virtual counters for a
                session:</p>
<img class="image" id="svc__image_hmk_jqk_ypb" src="../images/sessionvc.png" /><p class="p">In the
                applicability condition for the counter, configure it to apply only to a specific
                group of premium numbers by using the <var class="keyword varname">Called-Party-Address</var>
                AVP.</p>
<img class="image" id="svc__image_m32_lrk_ypb" src="../images/sessionvc1.png" height="243" width="694" /><p class="p">Following
                figure shows another example of provisioning session virtual counters for Gy session
                in <var class="keyword varname">GY_SESSION_ESTABLISHMENT</var> rule set:</p>
<img class="image" id="svc__image_cvq_3rl_ypb" src="../images/sessionvc4.jpg" /><p class="p">By assigning a different
                counter and using conditions in rule or counter applicability condition, different
                caps can be applied for to the following:</p>
<ul class="ul" id="svc__ul_jbv_bsk_ypb">
                <li class="li">Call Type</li>

                <li class="li">For IMS calls or SMS/MMS, it can be applied on the basis of premium numbers
                    (called-party numbers).</li>

                <li class="li">For PS calls, it can be applied on the basis of APN by checking
                        <var class="keyword varname">Called-Station-ID</var> AVP in rule.</li>

            </ul>
<p class="p">When there are two usage types, session virtual counter can be configured to
                count only primary rate usage or next rate usage. In this way, different CAP can be
                applied to different usage types. This behavior is same as in normal counter. To
                enable this, in counter applicability condition, the result context
                    <var class="keyword varname">RATING.Select-Counter-Usage</var> can be used as
                    <code class="ph codeph">RATING.Select-Counter-Usage =
            CounterUsageType_PRIMARY</code>.</p>
</div>

        <div class="section" id="svc__section_ejl_vfl_ypb"><h2 class="title sectiontitle">Additional information</h2>
            
            <ul class="ul" id="svc__ul_d2n_bgl_ypb">
                <li class="li">If session virtual counters are configured for a session, the behavior is same
                    as normal counters.</li>

                <li class="li">Limitations for Cap/limit of counter are also applicable for session virtual
                    counters.</li>

                <li class="li">Taxation is included in the call cost.</li>

                <li class="li">Quota is adjusted to reach the call limit, as close as possible, following rate
                    granularity.</li>

                <li class="li">Notification is sent if the call gets disconnected due to reaching the limit. </li>

                <li class="li">In CDR, <var class="keyword varname">recordEventResult</var> 28 (Call is rejected due to call
                    cost cap reached.) is generated for this scenario.</li>

                <li class="li">For IMS session, when call is rejected due to session virtual counter, MSCC
                    level result code in CCA message is 4012 (DIAMETER_CREDIT_LIMIT_REACHED).</li>

                <li class="li">Root level result code is 4012 (by default). It can be configured as 2001
                    (DIAMETER_SUCCESS) using RATING_POST_PROCESSING rule.</li>

                <li class="li">In this scenario, IMS session is kept alive and a CCR-T closes the
                        session.<img class="image break" id="svc__image_vb5_54l_ypb" src="../images/sessionvc2.png" /></li>

            </ul>

        </div>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>