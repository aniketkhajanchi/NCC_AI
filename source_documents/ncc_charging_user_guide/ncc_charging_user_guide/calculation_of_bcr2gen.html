<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Calculation of BCR reporting time and offline TTC" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="calculation_of_bcr2" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Calculation of BCR reporting time and offline TTC</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="calculation_of_bcr2">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Calculation of BCR reporting time and offline TTC</h1>
<div class="body conbody">
        <p class="p">Refer to section <a class="xref" href="disabletcc.html">Disable TTC for prepaid accounts and alignment of TTC and VT for postpaid accounts</a> to know more about
            the parameters used in the formulas. The following tables describe the formula to
            compute BCR reporting time and offline TTC:</p>

        <table cellpadding="4" cellspacing="0" summary="" id="calculation_of_bcr2__table_hxj_4df_1rb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Calculation of BCR reporting time and offline TTC</span></caption><colgroup><col /><col /></colgroup><thead class="thead" style="text-align:left;">
                    <tr class="row">
                        <th class="entry cellrowborder" style="vertical-align:top;" id="d115681e47">If Stored bcrReportingTime is NULL for the device and...</th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d115681e50">Then...</th>

                    </tr>

                </thead>
<tbody class="tbody">
                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e47 ">One or more of the bundles associated with T1 have their
                                <var class="keyword varname">TTC-Disable</var> flag enabled</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e50 ">
                            <p class="p">bcrReportingTime = T1</p>

                            <p class="p">TariffTimeChange = NULL</p>

                       </td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e47 ">At least one of the subscription associated with T1 has a prepaid
                            account and the subscriptions do not have the
                                <var class="keyword varname">TTC-disable</var> flag enabled</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e50 ">
                            <p class="p">TariffTimeChange = NULL</p>

                            <p class="p">bcrReportingTime = T1 + RAND [1 second, MIN(VTAFprepaid, T2 –
                                T1)]</p>

                       </td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e47 ">The Disable TTC parameter configured in a bundle is disabled, 2. The
                            account is of postpaid type, 3. If either of the system-level parameters
                            defined above is enabled (N28 or SY), then when TTC is calculated for an
                            upcoming BCR, this formula is used (regardless of whether or not any
                            policy counters for the device will change status as a result of the
                            BCR):</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e50 ">
                            <p class="p"><strong class="ph b">TariffTimeChange =&gt;</strong></p>

                            <p class="p">IF (T1 + MINspread &gt;= T2) OR (TEMP_INTVL – time to T1 &lt;=
                                MINspread)</p>

                            <p class="p">THEN:</p>

                            <p class="p"> TTC = T1</p>

                            <p class="p">ELSE:</p>

                            <p class="p"> TTC = T1 + RAND[1 second, MIN[TTCAF, TEMP_INTVL-time to
                                T1-MINspread, T2-T1-MINspread)]</p>

                       </td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e47 ">When TTC is initially set for an upcoming BCR, the corresponding
                            “bcrReportingTime” for the device is computed and stored as
                            follows:</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e50 ">
                            <p class="p"><strong class="ph b">a. IF PPC is enabled for N28 (or there are no policy counter which
                                    changes status at the upcoming BCR)</strong></p>

                            <p class="p">IF Calculated TTC + MINspread &gt;= T2</p>

                            <p class="p"> THEN "bcrReportingTime" = T2</p>

                            <p class="p">ELSE IF (current time + TEMP_INTVL &lt;= Calculated TTC +
                                MINspread)</p>

                            <p class="p"> THEN: "bcrReportingTime" = Calculated TTC + MINspread</p>

                            <p class="p"> ELSE:</p>

                            <p class="p"> THEN: "bcrReportingTime" = T1 + RAND[Calculated TTC - T1 +
                                MINspread, </p>

                            <p class="p"> MIN(VTAF, TEMP_INTVL - time to T1, T2 - T1)]</p>

                            <p class="p"><strong class="ph b">b. ELSE if PPC is NOT enabled for N28 but it is enabled for Sy AND
                                    one or more policy counters for the device changes status at the
                                    BCR</strong></p>

                            <p class="p">IF Calculated TTC + MINspread &gt;= T2</p>

                            <p class="p"> THEN: "bcrReportingTime" = T2</p>

                            <p class="p">ELSE IF current time + TEMP_INTVL &lt;= Calculated TTC +
                                MINspread</p>

                            <p class="p"> THEN: “bcrReportingTime” = Calculated TTC + MINspread</p>

                            <p class="p">ELSE: </p>

                            <p class="p"> THEN: “bcrReportingTime" = T1 +RAND[Calculated TTC – T1 + MINspread,
                                MIN(TTCAFlarge,</p>

                            <p class="p"> TEMP_INTVL – time to T1, T2 - T1)]</p>

                       </td>

                    </tr>

                </tbody>
</table>

        <table cellpadding="4" cellspacing="0" summary="" id="calculation_of_bcr2__table_zmt_rdf_1rb" class="table" frame="border" border="1" rules="all"><colgroup><col /><col /></colgroup><thead class="thead" style="text-align:left;">
                    <tr class="row">
                        <th class="entry cellrowborder" style="vertical-align:top;" id="d115681e198"><strong class="ph b">If Stored bcrReportingTime is not NULL for the device
                            and...</strong></th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d115681e202"><strong class="ph b">Then...</strong></th>

                    </tr>

                </thead>
<tbody class="tbody">
                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e198 ">If an update causes a change so that the PC status for one or more
                            policy counters change at the BCR (whereas previously it was not
                            expected to change), then if PPC is enabled for Sy but not N28, the
                            stored “bcrReportingTime” must be updated as follows:</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d115681e202 ">
                            <p class="p">IF the previously stored "bcrReportingTime" &lt;= T1 + TTCAFlarge</p>

                            <p class="p"> THEN: The stored "bcrReportingTime" remains unchanged</p>

                            <p class="p">ELSE:</p>

                            <p class="p"> "bcrReportingTime"= T1 + RAND[Stored TTC – T1 + MINspread,
                                TTCAFlarge]</p>

                       </td>

                    </tr>

                </tbody>
</table>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>