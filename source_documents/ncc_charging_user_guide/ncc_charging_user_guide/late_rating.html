<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Late rating" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="late_rating" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Late rating</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="late_rating">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Late rating</h1>
<div class="body conbody">
        <p class="p">Late rating refers to performing offline rating and charging for services such as voice
            and broadband at a time later than the actual time. This is particularly useful in
            roaming scenarios where the roaming data may be available late. </p>

        <p class="p">Late rating is supported for Gy calls and IMS event requests. </p>

        <p class="p">When NCC receives a late event, the subscription and versioning selection can be based on
            the current time or event timestamp. The consumption of allowance is always from the
            current allowance (and not from historical allowance).</p>

        <div class="p">The application preference <code class="ph codeph">Use Current Time to Charge Late Calls</code> is
            available to configure whether the current time is used to charge late calls. It can
            take the following values:<ul class="ul" id="late_rating__ul_wr5_ds3_nyb">
                <li class="li"><var class="keyword varname">true</var>: If this value is selected, then current time is used to
                    charge late calls.<p class="p">For example: <em class="ph i">Subscription A with Rate of $1/60 min was
                            canceled on 1-June 00:00. Subscription B with Rate of $1/30 min was
                            created at 1-June 00:00. If a late call is received, then subscription B
                            is chosen.</em></p>
</li>

                <li class="li"><var class="keyword varname">false</var>: If this value is selected, then current time is not
                    used to charge late calls.<p class="p">For example: <em class="ph i">Subscription A with Rate of $1/60
                            min was canceled on 1-June 00:00. Subscription B with Rate of $1/30 min
                            was created at 1-June 00:00. If a late call is received from 29-May,
                            then subscription A is chosen.</em></p>
</li>

            </ul>
</div>

        <p class="p">If bundles and charging services are modified, then both old and new data are available
            depending on the time of request. Also, subscription history and group history are
            maintained in Device and Group entities internally.</p>

        
    </div>
<div class="topic concept nested1" aria-labelledby="ariaid-title2" id="concept_gjd_txn_mxb"><h2 class="title topictitle2" id="ariaid-title2">Late event</h2>
<div class="body conbody">
            <p class="p">The system processes late events offline. Therefore, these are integrated via
                diameter as Immediate Event Charging (IEC) and not as Session Charging with Unit
                Reservation (SCUR). This is done because these events have already occurred in the
                past, and there is no option to reject them due to insufficient resource.</p>

            <p class="p">If the resource was fully consumed (for example, time bucket was fully depleted),
                then the units that cannot be charged are reported as Lost Time, Lost Volume, or
                Lost Money in the CDR, to reflect to the downstream system (for example, billing)
                that there was some revenue loss for the event.</p>

            
        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title3" id="concept_jnm_1mw_pxb"><h2 class="title topictitle2" id="ariaid-title3">Late calls on roaming with BOU </h2>
<div class="body conbody">
            <div class="section" id="concept_jnm_1mw_pxb__section_ozq_fmw_pxb"><h3 class="title sectiontitle">DeviceLateConsumptionTime device attribute </h3>
                
                <p class="p">A new attribute is added to the Device entity called
                        <em class="ph i">deviceLateConsumptionTime</em> which denotes if to use the current time or
                    call time to select the services during a late call. This attribute value is set
                    by the rules.</p>

                <div class="p"> If a device was created with <em class="ph i">deviceLateConsumptionTime</em> attribute value
                        <var class="keyword varname">CALL_TIME</var>, the call time is used for  activation, Bundle,
                    Charging Logic and complex mapping table. History is kept at the device under
                        <em class="ph i">subscriptionHistoryList</em> with the call time as the start time for
                    activation check the following example:<div class="fig fignone" id="concept_jnm_1mw_pxb__fig_a2z_pmw_pxb">
                        <img class="image break" id="concept_jnm_1mw_pxb__image_eb4_rmw_pxb" src="../images/hybrid_gui/deviceLateConsumptionTime.png" width="384" />
                    </div>
</div>

                <p class="p">While if the device was created with the <em class="ph i">deviceLateConsumptionTime</em>
                    attribute value CURRENT_TIME then the current time is used for both activation
                    and service selection during the late call, and history is kept but the start
                    time for activation would be the current time means consider it as an online
                    call.</p>

            </div>

            <div class="section" id="concept_jnm_1mw_pxb__section_esw_wmw_pxb"><h3 class="title sectiontitle">BOU past activation</h3>
                
                <p class="p"> It will have scenarios and a brief description as follows:</p>

                <p class="p">For the device attribute <em class="ph i">deviceLateConsumptionTime</em> is set to CALL_TIME
                    then:</p>

                <ol class="ol" id="concept_jnm_1mw_pxb__ol_udw_1nw_pxb">
                    <li class="li">If BOU was already in an active state at the time of the call, it should be
                        used without fee deduction. </li>

                    <li class="li">If BOU was in a pre-active state at the time of the call, it should be
                        activated, the fee should be deducted, and a history item will be added to
                        historylist of the subscription.</li>

                </ol>

                <p class="p">For the device attribute <em class="ph i">deviceLateConsumptionTime</em> is set to CURRENT_TIME
                    then:</p>

                <p class="p"> consider a late call as an online call means no past activation and use the
                    current timestamp.</p>

                <ul class="ul" id="concept_jnm_1mw_pxb__ul_vpk_ymw_pxb">
                    <li class="li">If the current state is active, then there's no need to deduct a fee, and no
                        need to add a history item.</li>

                    <li class="li">If the current state is pre-active, then the subscription is activated and
                        fee is deducted.</li>

                </ul>

            </div>

            <div class="section" id="concept_jnm_1mw_pxb__section_s4b_fnw_pxb"><h3 class="title sectiontitle">BOU overlapping</h3>
                
                <p class="p">If the activation period is overlapping with an active period, then fee is not
                    deducted. The overlapping is when the calculated end time is included in any
                    active history.</p>

                <p class="p"><em class="ph i">Example: BOU was active from 14 May 3:00 pm to 15 May 2:59 pm. A late call
                        comes on 14 May at 2 pm then no activation and fee deduction will
                        happen.</em></p>

                <div class="note" id="concept_jnm_1mw_pxb__note_qpp_cs2_qxb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> BOU overlapping is relevant only with a history.</div>

            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title4" id="concept_n2v_jpm_ysb"><h2 class="title topictitle2" id="ariaid-title4">Late rating with versioning</h2>
<div class="body conbody">
            <div class="section" id="concept_n2v_jpm_ysb__section_pbl_rqx_pxb">
                <p class="p">Previously, late calls were handled based on the subscription history. Currently,
                    the late rating calls use an appropriate charging logic version based on the
                    late event timestamp.</p>

                <div class="p">This feature provides the following functionalities:<ul class="ul" id="concept_n2v_jpm_ysb__ul_uzg_qy5_wsb">
                        <li class="li">Late calls select an appropriate bundle/charging version based on the
                            late event timestamp.</li>

                        <li class="li">In case of BCR, the late event timestamp selects the maximum applicable
                            version activation date. It does not select the time at which the
                            version was published.</li>

                        <li class="li">Versioning is triggered, in case of late call with immediate
                            versioning.</li>

                    </ul>
</div>

                <div class="sectiondiv"><strong class="ph b">Pre-configuration for scenarios</strong><div class="p">Following are the
                        pre-configurations for the scenarios listed further:<ul class="ul" id="concept_n2v_jpm_ysb__ul_hsf_3lp_wsb">
                            <li class="li"><em class="ph i">History Period</em> - Greater than <var class="keyword varname">0</var>.</li>

                            <li class="li"><em class="ph i">Max Number of Histories</em> - Greater than
                                <var class="keyword varname">0</var>.</li>

                            <li class="li"><em class="ph i">Threshold Profile Group (TPG)</em> - A TPG that sends an email
                                notification at 50%.</li>

                            <li class="li"><em class="ph i">Threshold Profile Group (TPG)</em>- A TPG that sends an SNR at
                                20GB, 30GB, and 50GB.</li>

                            <li class="li"><em class="ph i">Allowance Limit 1</em> - With an initial value of 50GB.</li>

                            <li class="li"><em class="ph i">Allowance Limit 2 </em>- With an initial value of 50 min.</li>

                            <li class="li"><em class="ph i">Charging Logic 1</em> - With <em class="ph i">Allowance Limit 1</em>.</li>

                            <li class="li"><em class="ph i">Charging Logic 2</em> - With <em class="ph i">Allowance Limit 2</em>.</li>

                            <li class="li">Create an <em class="ph i">Account</em>, <em class="ph i">User</em>, <em class="ph i">Device</em>,
                                <em class="ph i">Service</em>, and <em class="ph i">Subscription</em>.</li>

                        </ul>
</div>
<div class="p"><strong class="ph b">Scenario 1:</strong> Late rating when versioning is disabled.<ol class="ol" id="concept_n2v_jpm_ysb__ol_rv4_thp_wsb">
                            <li class="li">Disable versioning at SM and ME (Set the application preference
                                    <em class="ph i">Versioning Enabled</em> to <var class="keyword varname">false</var>).</li>

                            <li class="li">Create a subscription to <em class="ph i">ChLogic1</em> with an allowance limit of
                                50GB, and <em class="ph i">ChLogic2</em> with an allowance limit of 50 min/monthly
                                BCR.</li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Trigger BCR again (<em class="ph i">BCR2</em>).</li>

                            <li class="li">Late rating call consumes 10GB and 35 min from the current cycle
                                after <em class="ph i">BCR2</em>.<p class="p"><strong class="ph b">Result:</strong> 10GB and 35 min is consumed from
                                    the current cycle.</p>
</li>

                            <li class="li">Late rating call consumes 2GB and 12 min from the previous cycle
                                after <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 2GB and 12 min is consumed from
                                    the bucket history (second cycle)</p>
</li>

                            <li class="li">Late rating call consumes 4GB and 2 min from the first cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 4GB and 2 min is consumed from the
                                    bucket history (first cycle).</p>
</li>

                            <li class="li">Late rating call consumes 50 min.<p class="p"><strong class="ph b">Result:</strong> Fails with an
                                    error code <var class="keyword varname">4012</var> (Quota Limit
                                Reached).</p>
</li>

                        </ol>
</div>
<div class="p"><strong class="ph b">Scenario 2:</strong> Late rating with versioning at BCR.<ol class="ol" id="concept_n2v_jpm_ysb__ol_yb2_vpv_wsb">
                            <li class="li">Enable versioning at SM and ME (Set the application preference
                                    <em class="ph i">Versioning Enabled</em> to <var class="keyword varname">true</var>).</li>

                            <li class="li">Create a subscription to <em class="ph i">ChLogic1</em> with an allowance limit of
                                50GB, and <em class="ph i">ChLogic2</em> with an allowance limit of 50 min/monthly
                                BCR.</li>

                            <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with an allowance limit of 60GB. Create
                                    <em class="ph i">V2.0 ChLogic2</em> with an allowance limit of 70 min. </li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Late rating call consumes 10GB and 35 min from the current cycle
                                after <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 10GB and 35 min is consumed from
                                    the current cycle (<em class="ph i">V2.0 ChLogic</em>).</p>
</li>

                            <li class="li">Late rating call consumes 2GB and 12 min from the previous cycle
                                before <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 2GB and 12 min is consumed from
                                    the previous cycle - bucket history.</p>
</li>

                            <li class="li">Late rating call consumes 55GB from the previous
                                        cycle.<p class="p"><strong class="ph b">Result:</strong> Fails with an error code
                                        <var class="keyword varname">4012</var> (Quota Limit Reached).</p>
</li>

                        </ol>
</div>
<p class="p"><strong class="ph b">Scenario 3:</strong> Late rating with immediate versioning.</p>
<ol class="ol" id="concept_n2v_jpm_ysb__ol_mfq_xqv_wsb">
                        <li class="li">Enable versioning at SM and ME (Set the application preference
                                <em class="ph i">Versioning Enabled</em> to <var class="keyword varname">true</var>).</li>

                        <li class="li">Create a subscription to <em class="ph i">V1.0 ChLogic1</em> with an allowance limit of
                            50GB, and <em class="ph i">V1.0 ChLogic2</em> with an allowance limit of 50 min/monthly
                            BCR.</li>

                        <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with an allowance limit of 60GB. Create
                                <em class="ph i">V2.0 ChLogic2</em> with an allowance limit of 70 min.</li>

                        <li class="li">Online call</li>

                        <li class="li">Late rating call with timestamp after the online call<p class="p"><strong class="ph b">Result:</strong>
                                Consumed from the current cycle.</p>
</li>

                        <li class="li">Late rating call with timestamp before the online call.<p class="p"><strong class="ph b">Result:</strong>
                                Consumed from the current cycle.</p>
</li>

                    </ol>
<div class="p"><strong class="ph b">Scenario 4:</strong> Late rating with carry-over buckets when versioning
                        is disabled.<ol class="ol" id="concept_n2v_jpm_ysb__ol_b4h_mrv_wsb">
                            <li class="li">Disable versioning at SM and ME (Set the application preference
                                    <em class="ph i">Versioning Enabled</em> to <var class="keyword varname">false</var>).</li>

                            <li class="li">Create a subscription to <em class="ph i">ChLogic1</em> with a bucket of
                                60GB/monthly BCR.</li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Trigger BCR again (<em class="ph i">BCR2</em>).</li>

                            <li class="li">Late rating call consumes 2GB from the current cycle after
                                    <em class="ph i">BCR2</em>.<p class="p"><strong class="ph b">Result:</strong> 2GB is consumed either from
                                    carry-over bucket or original bucket, based on the
                                priority.</p>
</li>

                            <li class="li">Late rating call consumes 4GB from the previous cycle after
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 4GB is consumed from the current
                                    cycle carry-over bucket.</p>
</li>

                        </ol>
</div>
<div class="p"><strong class="ph b">Scenario 5:</strong> Late rating with carry-over buckets when
                        versioning is enabled (BCR versioning).<ol class="ol" id="concept_n2v_jpm_ysb__ol_id3_dsv_wsb">
                            <li class="li">Enable versioning at SM and ME (Set the application preference
                                    <em class="ph i">Versioning Enabled</em> to <var class="keyword varname">true</var>). Enable
                                the <em class="ph i">History</em> (Set the <em class="ph i">Late Call Consumption Logic</em> to
                                    <var class="keyword varname">ORIGINAL_BUCKET</var>).</li>

                            <li class="li">Create a subscription to <em class="ph i">ChLogic1</em> with carry-over bucket of
                                50GB/monthly BCR.</li>

                            <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with carry-over bucket of 60GB.</li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Late rating call consumes 2GB from the current cycle after
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 2GB is consumed either from
                                    carry-over bucket or original bucket, based on the
                                priority.</p>
</li>

                            <li class="li">Late rating call consumes 2GB from the previous cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 2GB is consumed from the
                                    carry-over bucket.</p>
</li>

                            <li class="li">Disable the <em class="ph i">History</em> (Set the <em class="ph i">Late Call Consumption
                                    Logic</em> to <var class="keyword varname">CURRENT_BUCKET</var>).</li>

                            <li class="li">Late rating call consumes 3GB from the previous cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 3GB is consumed either from
                                    carry-over bucket or original bucket, based on the
                                priority.</p>
</li>

                        </ol>
</div>
<div class="p"><strong class="ph b">Scenario 6:</strong> Late rating with carry-over buckets when
                        versioning is enabled (Immediate versioning).<ol class="ol" id="concept_n2v_jpm_ysb__ol_aj3_g5v_wsb">
                            <li class="li">Enable versioning at SM and ME (Set the application preference
                                    <em class="ph i">Versioning Enabled</em> to <var class="keyword varname">true</var>). Enable
                                the <em class="ph i">History</em> (Set the <em class="ph i">Late Call Consumption Logic</em> to
                                    <var class="keyword varname">ORIGINAL_BUCKET</var>).</li>

                            <li class="li">Create a subscription to <em class="ph i">ChLogic1</em> with carry-over bucket of
                                50GB/monthly BCR.</li>

                            <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with carry-over bucket of 60GB.</li>

                            <li class="li">Immediate Event Call (IEC) consumes 1GB.</li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Late rating call consumes 10GB from the current cycle after
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 10GB is consumed either from
                                    carry-over bucket or original bucket, based on the
                                priority.</p>
</li>

                            <li class="li">Late rating call consumes 2GB from the previous cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 2GB is consumed either from
                                    carry-over bucket or original bucket, based on the
                                priority.</p>
</li>

                            <li class="li">Disable the <em class="ph i">History</em> (Set the <em class="ph i">Late Call Consumption
                                    Logic</em> to <var class="keyword varname">CURRENT_BUCKET</var>).</li>

                            <li class="li">Late rating call consumes 3GB from the previous cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> 3GB is consumed either from
                                    carry-over bucket or original bucket, based on the
                                priority.</p>
</li>

                        </ol>
</div>
<div class="p"><strong class="ph b">Scenario 7:</strong> Late rating call triggers the version change,
                        if it is not triggered.<ol class="ol" id="concept_n2v_jpm_ysb__ol_bzh_zvv_wsb">
                            <li class="li">Enable versioning at SM and ME (Set the application preference
                                    <em class="ph i">Versioning Enabled</em> to <var class="keyword varname">true</var>).</li>

                            <li class="li">Create a subscription to <em class="ph i">V1.0 ChLogic1</em> with an allowance
                                limit of 50GB, and <em class="ph i">V1.0 ChLogic2</em> with an allowance limit of
                                50 min.</li>

                            <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with an allowance limit of 60GB, and
                                    <em class="ph i">V2.0 ChLogic2</em> with an allowance limit of 70 min..</li>

                            <li class="li">Late rating call.<p class="p"><strong class="ph b">Result:</strong> Initial Value of allowance limit
                                    1 = 60GB, Initial Value of allowance limit 2 = 70 min.</p>
</li>

                        </ol>
</div>
<div class="p"><strong class="ph b">Scenario 8:</strong> Notifications with late rating calls.<ol class="ol" id="concept_n2v_jpm_ysb__ol_bhm_rwv_wsb">
                            <li class="li">Create a subscription to <em class="ph i">ChLogic1</em> with an allowance limit of
                                10GB, including a threshold that sends an email notification at
                                50%/monthly BCR.</li>

                            <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with an allowance limit of 20GB,
                                including a threshold that sends an email notification at 50%.</li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Late rating call consumes 12GB from the current cycle after
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> Notification is sent</p>
</li>

                            <li class="li">Late rating call consumes 6GB from the previous cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> Notification is not sent.</p>
</li>

                        </ol>
</div>
<div class="p"><strong class="ph b">Scenario 9:</strong> SNR with late rating calls.<ol class="ol" id="concept_n2v_jpm_ysb__ol_bfr_1xv_wsb">
                            <li class="li">Create a subscription to <em class="ph i">V1.0 ChLogic1</em> with an allowance
                                limit of 50GB, and a Policy Counter including a threshold that sends
                                SNR at 20GB, 30GB and 50GB/monthly BCR.</li>

                            <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with an allowance limit of 60GB, and a
                                Policy Counter including a threshold that sends SNR at 20GB, 30GB,
                                and 50GB.</li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Late rating call consumes 21GB from the current cycle after
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> SNR is sent</p>
</li>

                            <li class="li">Late rating call consumes 21GB from the previous cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> SNR is not sent.</p>
</li>

                        </ol>
</div>
<div class="p"><strong class="ph b">Scenario 10:</strong> Late call consumption when the history is
                            disabled.<ol class="ol" id="concept_n2v_jpm_ysb__ol_utq_vxv_wsb">
                            <li class="li">Disable the <em class="ph i">History</em> (Set the <em class="ph i">Late Call Consumption
                                    Logic</em> to <var class="keyword varname">CURRENT_BUCKET</var>).</li>

                            <li class="li">Create a subscription to <em class="ph i">V1.0 ChLogic1</em> with an allowance
                                limit of 50GB, and a rate of 2$/GB.</li>

                            <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with an allowance limit of 60GB, and a
                                rate of 4$/GB.</li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Late rating call consumes 70GB from the previous cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> Consume 60GB from <em class="ph i">Bucket1 V2.0
                                        ChLogic1</em>. Once fully consumed, then charge from <em class="ph i">V1.0
                                        ChLogic1</em> overage rate1 (after bucket) 2$/1GB.</p>
</li>

                        </ol>
</div>
<div class="p"><strong class="ph b">Scenario 11:</strong> Late call consumption when the history is
                        disabled, and bucket consumption exceeds the bucket balance.<ol class="ol" id="concept_n2v_jpm_ysb__ol_n4v_xyv_wsb">
                            <li class="li">Disable the <em class="ph i">History</em> (Set the <em class="ph i">Late Call Consumption
                                    Logic</em> to <var class="keyword varname">CURRENT_BUCKET</var>).</li>

                            <li class="li">Create a subscription to <em class="ph i">V1.0 ChLogic1</em> with an allowance
                                limit of 50GB.</li>

                            <li class="li">Create <em class="ph i">V2.0 ChLogic1</em> with an allowance limit of 60GB.</li>

                            <li class="li">Trigger BCR (<em class="ph i">BCR1</em>).</li>

                            <li class="li">Late rating call consumes 70GB from the previous cycle before
                                    <em class="ph i">BCR1</em>.<p class="p"><strong class="ph b">Result:</strong> Call fails with the result code
                                        <var class="keyword varname">4012</var> (Quota Limit Reached).</p>
</li>

                        </ol>
</div>
</div>
            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title5" id="concept_cny_rh2_qxb"><h2 class="title topictitle2" id="ariaid-title5">Scenarios without versioning</h2>
<div class="body conbody">
            <div class="section" id="concept_cny_rh2_qxb__section_rbl_rqx_pxb"><h3 class="title sectiontitle">Pre-configuration for
                    scenarios</h3><p class="p">Following are the pre-configurations for the scenarios
                    listed further:</p>
<ul class="ul" id="concept_cny_rh2_qxb__ul_ind_cxw_pxb">
                    <li class="li">Disable versioning at SM and ME (Set the application preference Versioning
                        Enabled to false).</li>

                    <li class="li">History Period - Greater than 0.</li>

                    <li class="li">Max Number of Histories and Number of Histories Override - Greater than 0.
                        Take this into consideration for its values:</li>

                </ul>
<img class="image" id="concept_cny_rh2_qxb__image_zyv_hxw_pxb" src="../images/hybrid_gui/preconfig_scenario.PNG" width="576" /><ul class="ul" id="concept_cny_rh2_qxb__ul_p3v_jxw_pxb">
                    <li class="li">BOU – daily PLC/ activationFee=5£ with: <p class="p">Rate - 0.55£/Min.</p>
<p class="p">Counter
                            limit - 100£ per month</p>
</li>

                    <li class="li">Create a postpaid Account - cycle 1st/month with a 100 £ balance and Device
                        for Alex "Set device attribute value "deviceLateConsumptionTime" to
                        CALL_TIME".</li>

                    <li class="li">Create a Subscription for Alex on 1st May 2023 at 00:00</li>

                    <li class="li">Create another postpaid account - cycle 1st/month with a 100 £ balance and a
                        personal device for George "Set device attribute value
                        "deviceLateConsumptionTime" to CURRENT_TIME".</li>

                    <li class="li">Create a Subscription for George on 1st May 2023 at 00:00.</li>

                </ul>
</div>

            <div class="section" id="concept_cny_rh2_qxb__section_z4f_wh2_qxb"><h3 class="title sectiontitle">Scenario1: Late rating when a Device attribute value is CALL_TIME: </h3>
                
                <div class="p"><em class="ph i">For Alex, device attribute value is <var class="keyword varname">CALL_TIME</var>:</em><img class="image" id="concept_cny_rh2_qxb__image_tm3_yyw_pxb" src="../images/hybrid_gui/alex_calltime.PNG" width="768" /><ul class="ul" id="concept_cny_rh2_qxb__ul_rgb_nzw_pxb">
                        <li class="li">
                            <p class="p">An online roaming call came on 18-May at 16:00 with quota=3mins
                                so:</p>

                            <div class="p">
                                <ul class="ul" id="concept_cny_rh2_qxb__ul_sgb_nzw_pxb">
                                    <li class="li">BOU was activated from 18-May 16:00 to 18-May 23:59 and a
                                        fee of 5 £ was deducted. </li>

                                    <li class="li">also 3*0.55=1.65£ was deducted for the 3mins call.</li>

                                    <li class="li">Account balance became 100 - (5+ 1.65) =93.35£</li>

                                </ul>

                            </div>

                        </li>

                        <li class="li">A second online roaming call came on 18-May at 16:10 with quota=2mins
                                so:<ul class="ul" id="concept_cny_rh2_qxb__ul_tgb_nzw_pxb">
                                <li class="li">BOU is already active and hence no fee is deducted.</li>

                                <li class="li">2*0.55=1.1£ is deducted for the 2 mins call</li>

                                <li class="li">The account balance became 93.35 -1.1=92.25£</li>

                            </ul>
</li>

                        <li class="li">A third Late roaming call came on18-May at 11:00 with quota=6mins so:<ul class="ul" id="concept_cny_rh2_qxb__ul_ugb_nzw_pxb">
                                <li class="li"> BOU is overlapping with the active period of "18-May 16:00 to
                                    18-May 23:59" and hence no fee is deducted.</li>

                                <li class="li">6*0.55=3.3£ was deducted for the 6mins call</li>

                                <li class="li">Account balance became 92.25 - 3.3=88.95£</li>

                            </ul>
</li>

                        <li class="li">A fourth Late roaming call came on 10-May at 11:00 with quota=3mins
                                so:<ul class="ul" id="concept_cny_rh2_qxb__ul_vgb_nzw_pxb">
                                <li class="li">BOU was in a pre-active state on 10-May, so it was activated at
                                    that time from 10-May 11:00 to 10-May 23:59 and a fee of 5£ was
                                    deducted.</li>

                                <li class="li">3*0.55=1.65£ was deducted for the 3mins call</li>

                                <li class="li">Account balance became 88.95 -(1.65+5) =82.3£</li>

                            </ul>
</li>

                        <li class="li">A fifth Late roaming call came on 10-May at 00:10 with quota=3mins
                                so:<ul class="ul" id="concept_cny_rh2_qxb__ul_wgb_nzw_pxb">
                                <li class="li">BOU was already active and hence no fee was deducted.</li>

                                <li class="li">3*0.55=1.65£ was deducted for the 3mins call</li>

                                <li class="li">Account balance became 82.3 -1.65=80.65£</li>

                            </ul>
</li>

                        <li class="li">A final Late roaming call came on 9-May at 11:00 with quota=3mins so:<ul class="ul" id="concept_cny_rh2_qxb__ul_xgb_nzw_pxb">
                                <li class="li">BOU was in a pre-active state and hence it was activated from
                                    9-May 11:00 to 9-May 23:59 and 5£ fee was deducted.</li>

                                <li class="li">3*0.55=1.65£ was deducted for the 3 mins call</li>

                                <li class="li">Account balance became 80.65 -(1.65 + 5) = 74</li>

                            </ul>
</li>

                    </ul>
</div>

            </div>

            <div class="section" id="concept_cny_rh2_qxb__section_vd1_yh2_qxb"><h3 class="title sectiontitle">Scenario 2: Late rating when a Device attribute value is CURRENT_TIME</h3>
                
                <div class="p"><em class="ph i">For George, device attribute value is <var class="keyword varname">CALL_TIME</var>: </em><img class="image" id="concept_cny_rh2_qxb__image_zwf_tzw_pxb" src="../images/hybrid_gui/george_calltime.PNG" width="768" /><ul class="ul" id="concept_cny_rh2_qxb__ul_kw3_szw_pxb">
                        <li class="li">
                            <p class="p">An online roaming call came on 18-May at 16:00 with quota=3mins
                                so:</p>

                            <div class="p">
                                <ul class="ul" id="concept_cny_rh2_qxb__ul_lw3_szw_pxb">
                                    <li class="li">BOU was activated from 18-May 16:00 to 18-May 23:59 am and a
                                        fee of 5 £ was deducted. </li>

                                    <li class="li">also 3*0.55=1.65£ was deducted for the 3mins call.</li>

                                    <li class="li">Account balance became 100 - (1.65+5) = 93.35£</li>

                                </ul>

                            </div>

                        </li>

                        <li class="li">A second online roaming call came on 18-May at 16:10 with quota=2mins
                                so:<ul class="ul" id="concept_cny_rh2_qxb__ul_mw3_szw_pxb">
                                <li class="li">BOU is already active now and hence no fee is deducted.</li>

                                <li class="li">2*0.55=1.1£ is deducted for the 2 mins call</li>

                                <li class="li">counter became 93.35 - 1.1= 92.25£</li>

                            </ul>
</li>

                        <li class="li">A third Late roaming call came on18-May at 11:00 with quota=6mins so:<ul class="ul" id="concept_cny_rh2_qxb__ul_nw3_szw_pxb">
                                <li class="li"> BOU is already active now and hence no fee is deducted.</li>

                                <li class="li">6*0.55=3.3£ was deducted for the 6mins call</li>

                                <li class="li">counter became 92.25 - 3.3=88.95£</li>

                            </ul>
</li>

                        <li class="li">A fourth Late roaming call came on 10-May at 11:00 with quota=3mins
                                so:<ul class="ul" id="concept_cny_rh2_qxb__ul_ow3_szw_pxb">
                                <li class="li">BOU is already active now and hence no fee is deducted.</li>

                                <li class="li">3*0.55=1.65£ was deducted for the 3mins call</li>

                                <li class="li">counter became 88.95 - 1.65=87.3£</li>

                            </ul>
</li>

                        <li class="li">A fifth Late roaming call came on 10-May at 00:10 with quota=3mins
                                so:<ul class="ul" id="concept_cny_rh2_qxb__ul_pw3_szw_pxb">
                                <li class="li">BOU is already active now and hence no fee is deducted.</li>

                                <li class="li">3*0.55=1.65£ was deducted for the 3mins call</li>

                                <li class="li">counter became 87.3 - 1.65=85.65£</li>

                            </ul>
</li>

                        <li class="li">A final Late roaming call came on 9-May at 11:00 with quota=3mins so:<ul class="ul" id="concept_cny_rh2_qxb__ul_qw3_szw_pxb">
                                <li class="li">BOU is already active now and hence no fee is deducted.</li>

                                <li class="li">3*0.55=1.65£ was deducted for the 3 mins call</li>

                                <li class="li">counter became 85.65 -1.65 =84</li>

                            </ul>
</li>

                    </ul>
</div>

            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title6" id="concept_rwb_232_qxb"><h2 class="title topictitle2" id="ariaid-title6">Scenarios with versioning</h2>
<div class="body conbody">
            <p class="p">In case there are different versions with different rates, the rate that was
                applicable at the time of the call is charged. </p>

            <p class="p"><strong class="ph b">Scenario1 pre-configurations</strong></p>

            <ul class="ul" id="concept_rwb_232_qxb__ul_uq3_k1x_pxb">
                <li class="li">BOU – daily LC/ activationFee=10$ with: <p class="p"><em class="ph i">Version1.0 V1.0</em>
                        <var class="keyword varname">chLogic</var> contains Rate1 - 1$/Min.</p>
</li>

                <li class="li">Create an Account, Device.</li>

                <li class="li">Subscribe to BOU on 14 May at 1:00 pm.</li>

                <li class="li">create <em class="ph i">Version2.0 V2.0</em>
                    <var class="keyword varname">chLogic</var> contains Rate2- 2$/Min on 15 May 4:00pm.</li>

                <li class="li">make an online call so the BOU state would be Active.</li>

            </ul>

            <div class="section" id="concept_rwb_232_qxb__section_blf_zh2_qxb"><h3 class="title sectiontitle">Late rating with immediate versioning-Device attribute value is
                    CALL_TIME</h3>
                
                <ul class="ul" id="concept_rwb_232_qxb__ul_cls_41x_pxb">
                    <li class="li">Set device attribute value <em class="ph i">deviceLateConsumptionTime</em> to
                        CALL_TIME</li>

                    <li class="li">Late rating call with a timestamp before Version2.0 on 14 May at 2:00 pm
                        (Version1.0 with Rate1 was applicable at the time of the call) and the BOU
                        was in pre-Active at the time of the call so the result would be deducting
                        10$ for activation and 1$/Min so the BOU is activated from 14 May 2:00 pm to
                        15 May 1:59 pm.</li>

                    <li class="li">Late rating call with a timestamp after Version 2.0 on 15 May at 5:00 pm.
                        (Version2.0with Rate2 was applicable at the time of the call) and the BOU
                        was in pre-Active at the time of the call so the result would be deducting
                        10$ for activation and 2$/Min so the BOU is activated from 15 May 5:00 pm to
                        16 May 4:59 pm</li>

                </ul>

            </div>

            <div class="section" id="concept_rwb_232_qxb__section_fmq_332_qxb"><h3 class="title sectiontitle">Late rating with immediate versioning-Device attribute value is
                    CURRENT_TIME</h3>
                
                <div class="p">
                    <ul class="ul" id="concept_rwb_232_qxb__ul_wrz_x1x_pxb">
                        <li class="li">set device attribute value <em class="ph i">deviceLateConsumptionTime</em> to
                            CURRENT_TIME</li>

                        <li class="li">Late rating call with a timestamp before V2.0 on 14 May at 2:00 pm so
                            the result would be current time and BOU in <em class="ph i">Active</em> state at the
                            current time, so that the fee is not deducted and only the Quota is
                            charged(2$/Min).</li>

                    </ul>

                </div>

            </div>

        </div>
</div>
<div class="topic concept nested1" aria-labelledby="ariaid-title7" id="concept_fgx_1f2_qxb"><h2 class="title topictitle2" id="ariaid-title7">End time calculation for BOU in case of late call </h2>
<div class="body conbody">
            <p class="p">Please refer <a class="xref" href="bundle_on_use.html#concept_qbk_r4k_r4b">End time calculation for BOU and non-BOU bundles</a> for more
                information.</p>

            <p class="p">The end time is calculated as per the billing information of the bundle and the
                periodic length of the lifecycle.</p>

            <div class="section" id="concept_fgx_1f2_qxb__section_yw1_z1x_pxb">
                <p class="p">If a BOU bundle has no billing information, then it has an exact period as per
                    the periodic length defined in a lifecycle and also, if the Day of Month and
                    Hour of Day are not mentioned in the bundle object, then the period length
                    defined in the bundle periodic lifecycle is followed so If the bundle periodic
                    lifecycle is having a periodic length of 24-hours, then the periodic length is
                    considered as exact 24-hours.</p>

                <p class="p"><strong class="ph b">Example 1:</strong></p>

                <p class="p">If the Day of Month and Hour of Day values are <em class="ph i">not mentioned</em> in a bundle
                    object, the periodic length in the bundle is 24 hours, and the periodic
                    lifecycle </p>

                <p class="p"><var class="keyword varname">StartTime is 15 May 2023 3:39:23 HRS, then the endTime is 16 May 2023
                        3:39:23 HRS. </var></p>

                <p class="p"><strong class="ph b">Example 2:</strong></p>

                <p class="p">If the Day of Month and Hour of Day values are <em class="ph i">mentioned</em> in a bundle
                    object like (dayOfWeek =1, dayOfMonth=1, hourOfDay = 0 (the starting hour of the
                    day)), and the periodic lifecycle </p>

                <p class="p"><var class="keyword varname">StartTime is 15 May 2023 3:39:23 HRS, then the endTime is 15 May 2023.
                        23:59</var>.</p>

            </div>

        </div>
</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>