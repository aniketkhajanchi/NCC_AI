<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Diameter refund request" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="diameter_refund" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Diameter refund request</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="diameter_refund">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Diameter refund request</h1>
<div class="body conbody">
        <p class="p">Upon a successful <em class="ph i">DIRECT_DEBITING</em> request, if the intended action fails due to any
            reason, then the amount charged for the action from the account main balance can be
            refunded to the account. For example, if the SMS delivery fails, then the amount charged
            for the SMS through <em class="ph i">DIRECT_DEBITING</em> request is refunded to the account main
            balance.</p>

        <div class="p">This feature provides the functionality to enable refund for the following
            Requested-Service-Unit (RSU) AVP unit types:<ul class="ul" id="diameter_refund__ul_s3b_wxd_jyb">
                <li class="li"><em class="ph i">CC-Money</em></li>

                <li class="li"><em class="ph i">CC-Service-Specific-Units</em></li>

            </ul>
</div>

        <div class="p">The refunded amount is added only to the account main balance.<div class="note" id="diameter_refund__note_tks_vzd_jyb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> 
                <ul class="ul" id="diameter_refund__ul_btx_fdp_kyb">
                    <li class="li">This feature is supported only with SMS/MMS <em class="ph i">Service-Context-Id</em>.</li>

                    <li class="li">
                        <p class="p">3GPP <em class="ph i">Refund-information</em> AVP based refund is not supported with
                            this feature.</p>

                    </li>

                </ul>

            </div>
</div>

        <p class="p">Refund request is a Diameter Immediate Event Charging (IEC) call with
                <em class="ph i">Requested-Action</em> as <em class="ph i">REFUND_ACCOUNT</em>.</p>

        <p class="p">There is no correlation between the refund request and any earlier debit request against
            which the refund request is triggered. Hence, the refund request is rated as per the
            rating conditions at the time of refund.</p>

        <p class="p">For example: If SMS-MT debit is 3€, and the rating and charging conditions are updated at
            the time of refund, then refund amount is based on the updated rating and charging
            conditions. (For example, refund amount can be 4€ or 2€.)</p>

        <div class="section" id="diameter_refund__section_kfn_zb2_jyb"><h2 class="title sectiontitle">Configuration</h2>
            
            <div class="p">The ME application preference <code class="ph codeph">Diameter Refund Type</code> can be used to
                enable this feature. It take can the following values:<ul class="ul" id="diameter_refund__ul_erh_jc2_jyb">
                    <li class="li"><var class="keyword varname">WITHOUT_CORRELATION</var>: Set this value to enable the
                        functionality to refund the amount to account main balance.</li>

                    <li class="li"><var class="keyword varname">NONE</var>: Set this value to disable the functionality to
                        refund the amount.</li>

                </ul>
Default value: <var class="keyword varname">NONE</var><div class="note" id="diameter_refund__note_nbx_vc2_jyb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> For details
                    on configuring ME application preferences, see <em class="ph i">Global Configuration
                    Guide</em>.</div>
</div>

            <div class="sectiondiv"><strong class="ph b">Notification rule configuration</strong><p class="p">The rule attribute
                        <em class="ph i">CALL_COMMON.Refund-Amount</em> available in <em class="ph i">GY_POST_PROCESSING</em> and
                        <em class="ph i">RATING_POST_PROCESSING</em> triggers can be used to configure a
                    notification upon successful refund.</p>
<div class="p">See the following image for sample
                    rule configuration:<div class="fig fignone" id="diameter_refund__fig_npj_4d2_jyb">
                        <img class="image break" id="diameter_refund__image_gyl_pg2_jyb" height="192" src="../images/Refund_amount.PNG" width="480" />
                    </div>
</div>
</div>
        </div>

        <div class="section" id="diameter_refund__section_zzv_zb2_jyb"><h2 class="title sectiontitle">Use cases</h2>
            
            <div class="sectiondiv"><strong class="ph b">Use case 1</strong>:<ul class="ul" id="diameter_refund__ul_w1f_l42_jyb">
                    <li class="li">The application preference <code class="ph codeph">Diameter Refund Type</code> is set to
                            <var class="keyword varname">WITHOUT_CORRELATION</var>.</li>

                    <li class="li">Subscriber with the account main balance of 10€ is charged 3€ for an SMS-MT
                        IEC call.</li>

                    <li class="li">The amount of 3€ is deducted from the main balance through direct debit. The
                        remaining account main balance is 7€.</li>

                    <li class="li">The threshold, which is set to be 8€, is crossed.</li>

                    <li class="li">Diameter refund request with <em class="ph i">Requested-Action</em> as
                            <em class="ph i">REFUND_ACCOUNT</em> is triggered to initiate a refund to the account
                        main balance.</li>

                </ul>
<div class="p">Expected behavior:<ul class="ul" id="diameter_refund__ul_yg2_m42_jyb">
                        <li class="li">The refund requested is rated, and the amount to be charged is 3€.
                            Hence, 3€ is refunded to the account main balance. After the refund, the
                            account balance is10€.</li>

                        <li class="li">A notification with refund information is sent to the subscriber.</li>

                        <li class="li">CDR is generated for the refund request with refund amount credited to
                            the account main balance as 3€.</li>

                    </ul>
</div>
</div>
        </div>

        <div class="section" id="diameter_refund__section_t3w_szd_jyb"><h2 class="title sectiontitle">Important points</h2>
            
            <div class="p">Note the following important points about this feature:<ul class="ul" id="diameter_refund__ul_mqc_5zd_jyb">
                    <li class="li">Refund call ignores Device or Account barring. That is, amount is refunded
                        even when Device or Account is barred.</li>

                    <li class="li">Refund is based on rating/tarrif. The refunded amount is added to the
                        account main balance. Rating/tarrif based output is of Money unit type.</li>

                    <li class="li">When a refund is initiated, the counter value is decremented if it is
                        configured with rate or tariff applied to main balance. The counters, which
                        are configured to be incremented during a debit request, are decremented
                        during the refund request. <div class="note" id="diameter_refund__note_gvz_qr2_jyb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> If the counter value
                            is either 0 or less than the refund value, then the current counter
                            value is set to 0 during the refund request.</div>
</li>

                    <li class="li">
                        <p class="p">If versioning is enabled, then the applicable versioning criteria should
                            be based on the <em class="ph i">Submission-Time</em> AVP value in the Diameter IEC
                            refund request. </p>

                        <p class="p">The <em class="ph i">Submission-Time</em> AVP value received during the refund request
                            should be same as the value used during the debit request of the same
                            version.</p>

                    </li>

                    <li class="li">Upon successful refund, any threshold that was crossed due to debit request
                        is reverted.</li>

                    <li class="li">Notification actions (such as <em class="ph i">Notification-Reject</em>,
                            <em class="ph i">Notification-Stop, </em>and so on) in THRESHOLD trigger are not
                        applicable for diameter refund request.</li>

                    <li class="li">Refund feature is not supported for Group/Distributed Group. Hence, counters
                        that are related to Group (such as <em class="ph i">Device Group</em> counter and
                            <em class="ph i">Group</em> counter) are not supported.</li>

                    <li class="li"><em class="ph i">Currency-Code</em> AVP value is ignored, and the NCC currency
                        configuration is considered instead.</li>

                </ul>
</div>

        </div>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>