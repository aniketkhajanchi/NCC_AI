<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Disable TTC for prepaid accounts and alignment of TTC and VT for postpaid accounts" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="id9yz-09126-ug01-pczza-sp1-d1e24011" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Disable TTC for prepaid accounts and alignment of TTC and VT for postpaid accounts</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="id9yz-09126-ug01-pczza-sp1-d1e24011">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Disable TTC for prepaid accounts and alignment of TTC and VT for postpaid accounts</h1>
<div class="body conbody">
<div class="section">
            <p class="p">This feature describes a mechanism of computing VT and TTC in Diameter CCA-I or CCA-U
                requests, and <code class="ph codeph">Nchf_ConvergedCharging</code> create or update responses
                when the validity time interval of a data session exceeds the activation time,
                renewal time, or expiration time for an in-use subscription.</p>

<p class="p">It handles prepaid and postpaid accounts differently:</p>

            <ul class="ul" id="id9yz-09126-ug01-pczza-sp1-d1e24011__ul_p5z_cg5_smb">
                <li class="li">
                    <p class="p">For <strong class="ph b">prepaid</strong> accounts: Irrespective of the account balance, the TTC
                        value is not set and only VT is computed considering the nearest BCR or
                        other event and a configurable parameter <em class="ph i">VTAFprepaid</em> so that a device
                        does not continue to consume data post the current billing cycle.</p>

                </li>

                <li class="li">
                    <p class="p">For <strong class="ph b">postpaid</strong> accounts: In case of BCR or any other similar event, when
                        the policy counter status changes, the data usage done before and after
                        those events should be counted in its respective billing cycle. The TTC and
                        VT values are computed as per the policy counter status change:</p>

                    <ul class="ul" id="id9yz-09126-ug01-pczza-sp1-d1e24011__ul_rds_pcd_ymb">
                        <li class="li">
                            <p class="p">In case, the policy counter status does not change, the usage does
                                not change from unthrottled to throttled at the TTC time. Therefore,
                                NCC allows a larger spread of VT to spread out the traffic.</p>

                        </li>

                        <li class="li">
                            <p class="p">In case, the policy counter status change is expected, for example at
                                    <em class="ph i">T1</em>, then it refers that the device is being throttled at
                                    <em class="ph i">T1</em>. Therefore, to avoid the data usage or to minimize the
                                data usage in the new billing cycle without being throttled, the
                                values of TTC and VT are set close to each other.</p>

                            <div class="p">
                                <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> For information on <em class="ph i">T1</em>, refer to <a class="xref" href="#id9yz-09126-ug01-pczza-sp1-d1e24011__parametervalues">Parameters used in feature configuration</a>.</div>

                            </div>

                        </li>

                    </ul>

                </li>

            </ul>

<div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> <ul class="ul">
<li class="li">
<p class="p">Before this feature, only the next BCR time was considered as TTC entry from the entities where reservation was done but with this feature, the next to upcoming BCR time (which means, the second renewal time) is also considered as the TTC entry for subscriptions whose time is nearest in the sorted entry list. For example, if two subscriptions are getting renewal at the same time, then the first subscription event (<em class="ph i">T1</em>) is the BCR time and the second subscription event (<em class="ph i">T2</em>) is minimum of the next to next BCR time of amongst the two subscriptions. Next to next BCR time can be different due to reasons like change in account or bundle billing information.</p>

</li>

<li class="li">
<p class="p">To consider the second renewal time (<em class="ph i">T2</em>) as TTC entry, in case of subscriptions from where reservation is done, the number of remaining renewals is set to at least 1.</p>

</li>

<li class="li">
<p class="p">If the <em class="ph i">ELC-VT</em> of a subscription is less than the BCR time, then two renewal times of the same subscription are not considered as TTC entries.</p>

</li>

<li class="li">
<p class="p">For accounts, only the upcoming BCR time is fetched as generally, the periodicity of an account is not in days and due to which, the second renewal time (<em class="ph i">T2</em>) is very far away and not required in calculation.</p>

</li>

<li class="li">
<p class="p">If the UC time of day is approaching and it is before any of the tariff change event times, then VT is set as the approaching time of day and no TTC is sent. The UC time of day can be the <em class="ph i">T2</em> value (if found minimum than other TTC entries).</p>

</li>

</ul>

</div>

</div>

<div class="section" id="id9yz-09126-ug01-pczza-sp1-d1e24011__parametervalues"><h2 class="title sectiontitle">Parameters used in feature configuration</h2>
            
            <div class="p">Following parameters are used in formulas mentioned in this feature to compute VT and
                    TTC:<table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><colgroup><col style="width:25.839793281653744%" /><col style="width:74.16020671834626%" /></colgroup><thead class="thead" style="text-align:left;">
                            <tr class="row">
                                <th class="entry cellrowborder" style="vertical-align:top;" id="d169138e167">
                                    <p class="p">Parameter</p>

                               </th>

                                <th class="entry cellrowborder" style="vertical-align:top;" id="d169138e173">
                                    <p class="p">Description</p>

                               </th>

                            </tr>

                        </thead>
<tbody class="tbody">
                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">T1</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">This refers to the upcoming subscription (activation,
                                    renewal, or expiration) event, which is either triggered by an
                                    account BCR or subscription period lifecycle.</td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">T2</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">
                                    <p class="p">This refers to the next subscription (activation, renewal, or
                                        expiration) event after <em class="ph i">T1</em>, which is either triggered
                                        by an account billing cycle or subscription period
                                        lifecycle.</p>

                                    <p class="p">
                                        <em class="ph i">T2</em> can also be a Time-Of-Day (TOD) event.</p>

                               </td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">VTAF</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">
                                    <p class="p">This refers to the VT adjustment factor to randomize VT
                                        intervals.</p>

                               </td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">TTCAF</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">
                                    <p class="p">This refers to the TTC adjustment factor to randomize TTC
                                        intervals.</p>

                               </td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">VTAFprepaid</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">
                                    <p class="p">This refers to the shortened VT adjustment factor, which is
                                        used when TTC is not send for prepaid accounts.</p>

                                    <div class="p">
                                        <div class="note" id="id9yz-09126-ug01-pczza-sp1-d1e24011__note_zpl_2xw_p5b"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> This parameter is only
                                            applicable to prepaid accounts.</div>

                                    </div>

                               </td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">TTCAFlarge</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">
                                    <p class="p">This refers to the upper bound or higher TTC adjustment
                                        factor when VT is set to (<em class="ph i">TTC</em> + <em class="ph i">MINspread</em>) as
                                        per the computation.</p>

                                    <p class="p">Therefore, <em class="ph i">TTCAFlarge</em> can be referred to as the
                                        maximum or higher limit of <em class="ph i">TTCAF</em>.</p>

                               </td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">MINspread</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">
                                    <p class="p">This refers to the minimum interval between the VT and TTC.
                                    </p>

                               </td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">VTs</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">
                                    <p class="p">This refers to the validity time, which is configurable as
                                        per the rule groups or as per static configuration in quota
                                        management (slicing profile).</p>

                               </td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e167 ">TEMP_INTVL</td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e173 ">
                                    <p class="p">Upper bound of the <em class="ph i">BCR Reporting Time</em> interval. It is
                                        set based on the current time when a 4G or 5G transaction is
                                        received from the network.</p>

                                    <ul class="ul" id="id9yz-09126-ug01-pczza-sp1-d1e24011__ul_yxp_gy1_vpb">
                                        <li class="li">
                                            <p class="p">When there are no online flows, or VTs for online
                                                flows in the transaction, the <em class="ph i">OFLint</em> does not
                                                reach T1. Then, <em class="ph i">TEMP_INTVL</em> is set to
                                                  <em class="ph i">OFLint</em>.</p>

                                        </li>

                                        <li class="li">
                                            <p class="p">Else, if VTs reaches T1 but <em class="ph i">OFLint</em> does not
                                                reach T1, then <em class="ph i">TEMP_INTVL= VTs</em>.</p>

                                        </li>

                                        <li class="li">
                                            <p class="p">Else if both <em class="ph i">OFLint</em> and <em class="ph i">VTs</em> reach T1,
                                                then <em class="ph i">TEMP_INTVL = MIN[VTs, OFLint].</em></p>

                                        </li>

                                    </ul>

                               </td>

                            </tr>

                        </tbody>
</table>
</div>

        </div>

<div class="section"><h2 class="title sectiontitle">Computing TTC and VT</h2>
<div class="sectiondiv">
<p class="p"><strong class="ph b">Prepaid accounts behavior</strong></p>

<div class="p">For prepaid accounts, the computation depends on the following factors:<table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><colgroup><col style="width:43.103448275862064%" /><col style="width:56.89655172413792%" /></colgroup><thead class="thead" style="text-align:left;">
                                <tr class="row">
                                    <th class="entry cellrowborder" style="vertical-align:top;" id="d169138e394">
                                        <p class="p">If...</p>

                                    </th>

                                    <th class="entry cellrowborder" style="vertical-align:top;" id="d169138e400">
                                        <p class="p">Then...</p>

                                    </th>

                                </tr>

                            </thead>
<tbody class="tbody">
                                <tr class="row">
                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e394 ">The <span class="ph uicontrol">Disable TTC</span> parameter
                                        configured in a bundle is enabled,</td>

                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e400 ">
                                        <p class="p">Irrespective of the type of device or account and whether
                                            the policy counter status is changed or not, the TTC
                                            value is not returned and VT is computed as per the time
                                            to <em class="ph i">T1</em> parameter.</p>

                                        <p class="p">For example, if a subscription event takes place at
                                                <em class="ph i">T1</em>, then VT is reduced to <em class="ph i">T1</em> and TTC
                                            is not returned.</p>

                                    </td>

                                </tr>

                                <tr class="row">
                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e394 ">
                                        <ol class="ol">
                                            <li class="li">
                                                <p class="p">The <span class="ph uicontrol">Disable TTC</span> parameter
                                                  configured in a bundle is disabled, and</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">The account is of prepaid type,</p>

                                            </li>

                                        </ol>

                                    </td>

                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e400 ">
                                        <p class="p">Irrespective of whether the policy counter status is
                                            changed or not, the TTC value is not returned and VT is
                                            calculated as per the following formula:</p>

                                        <ul class="ul">
                                            <li class="li">
                                                <p class="p">If there is no <em class="ph i">T2</em> or no next subscription
                                                  event takes place before (<em class="ph i">T1</em> +
                                                  <em class="ph i">VTAFprepaid</em>), then <samp class="ph systemoutput">VT = T1 +
                                                  random value between 1 second and
                                                  VTAFprepaid</samp>.</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">If there are two subscription events happening,
                                                  which means both <em class="ph i">T1</em> and <em class="ph i">T2</em> take
                                                  place, then <samp class="ph systemoutput">VT = time to T1 + random
                                                  value between 1 second and (T2-T1)</samp>
                                                </p>

                                            </li>

                                        </ul>

                                    </td>

                                </tr>

                            </tbody>
</table>
</div>

<div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> If <em class="ph i">T1</em> has at least one subscription with validity time from entity lifecycle or the
                    subscription for prepaid account type has reached the maximum renewal attempts,
                    then VT is sent as per the calculation mentioned in the above table.</div>

</div>
<div class="sectiondiv">
                
<p class="p"><strong class="ph b">Postpaid accounts behavior</strong></p>

<div class="p">For postpaid accounts, the computation depends on the following factors:<table cellpadding="4" cellspacing="0" summary="" class="table" width="100%" frame="border" border="1" rules="all"><colgroup><col style="width:48.07692307692307%" /><col style="width:51.92307692307693%" /></colgroup><thead class="thead" style="text-align:left;">
                                <tr class="row">
                                    <th class="entry cellrowborder" style="vertical-align:top;" id="d169138e533">
                                        <p class="p">If...</p>

                                   </th>

                                    <th class="entry cellrowborder" style="vertical-align:top;" id="d169138e539">
                                        <p class="p">Then...</p>

                                   </th>

                                </tr>

                            </thead>
<tbody class="tbody">
                                <tr class="row">
                                    <td class="entry cell-norowborder" style="vertical-align:top;" headers="d169138e533 ">
                                        <ol class="ol">
                                            <li class="li">
                                                <p class="p">The <span class="ph uicontrol">Disable TTC</span> parameter
                                                  configured in a bundle is disabled,</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">The account is of postpaid type, and</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">The policy counter status or virtual policy
                                                  counter (VPC) status does not change, which means
                                                  the usage does not change from throttled to
                                                  unthrottled at the TTC time,</p>

                                            </li>

                                        </ol>

                                   </td>

                                    <td class="entry cell-norowborder" style="vertical-align:top;" headers="d169138e539 ">
                                        <p class="p">First, the TTC (<em class="ph i">TTC_PostPaid_PC_No_Change</em>) is
                                            calculated and the TTC value is further used in
                                            computing the VT value.</p>

                                        <p class="p">
                                            <strong class="ph b">1.</strong> TTC is calculated as per the following
                                            conditions:</p>

                                        <ul class="ul">
                                            <li class="li">
                                                <p class="p">If there is no <em class="ph i">T2</em> or no next subscription
                                                  event takes place before (<em class="ph i">T1</em> +
                                                  <em class="ph i">TTCAF</em>), then <samp class="ph systemoutput">TTC = T1 +
                                                  random value between 1 second and
                                                  TTCAF</samp>.</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">If the value of (<em class="ph i">T1</em> + <em class="ph i">MINspread</em>) is
                                                  greater than <em class="ph i">T2</em> or next subscription event,
                                                  then <samp class="ph systemoutput">TTC = T1</samp>.</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">If there are two subscription events happening,
                                                  which means both <em class="ph i">T1</em> and <em class="ph i">T2</em> take
                                                  place, then <samp class="ph systemoutput">TTC = T1 + random value
                                                  between 1 second and
                                                  (T2-T1-MINspread)</samp>.</p>

                                            </li>

                                        </ul>

                                   </td>

                                </tr>

                                <tr class="row">
                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e533 "> </td>

                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e539 ">
                                        <p class="p">
                                            <strong class="ph b">2.</strong> And, VT is calculated as per the following
                                            conditions:</p>

                                        <ul class="ul">
                                            <li class="li">
                                                <p class="p">If there is no <em class="ph i">T2</em> or no next subscription
                                                  event takes place before (<em class="ph i">T1</em> +
                                                  <em class="ph i">VTAF</em>), then <samp class="ph systemoutput">VT = time to T1 +
                                                  random value between (Calculated TTC - T1 +
                                                  MINspread) and minimum value between VTAF and (VTs
                                                  - Time to T1)</samp>.</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">If the value of (calculated TTC +
                                                  <em class="ph i">MINspread</em>) is greater than or equal to
                                                  <em class="ph i">T2</em> or next subscription event, then
                                                  <samp class="ph systemoutput">VT = time to T2</samp>.</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">If (current time + VTs) is less than or equal to
                                                  ( calculated TTC + <em class="ph i">MINspread</em>), then
                                                  <samp class="ph systemoutput">VT = time to calculated TTC +
                                                  MINspread</samp>.</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">If there are two subscription events happening,
                                                  which means both <em class="ph i">T1</em> and <em class="ph i">T2</em> take
                                                  place, then <samp class="ph systemoutput">VT = time to T1 + random
                                                  value between (calculated TTC - T1 + MINspread)
                                                  and minimum value between (VTs - time to T1) and
                                                  (T2 -T1)</samp>.</p>

                                            </li>

                                        </ul>

                                        <p class="p">Therefore, this computation allows a larger spread of VT
                                            to spread out the traffic using <em class="ph i">VTAF</em> and
                                                <em class="ph i">MINspread</em>.</p>

                                   </td>

                                </tr>

                                <tr class="row">
                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e533 ">
                                        <ol class="ol">
                                            <li class="li">
                                                <p class="p">The <span class="ph uicontrol">Disable TTC</span> parameter
                                                  configured in a bundle is disabled,</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">The account is of postpaid type, and</p>

                                            </li>

                                            <li class="li">
                                                <p class="p">The policy counter status or VPC status changes,
                                                  which means the usage is computed as QoS changes
                                                  from unthrottled to throttled at the TTC time,</p>

                                            </li>

                                        </ol>

                                   </td>

                                    <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e539 ">
                                        <p class="p">First, the TTC (<em class="ph i">TTC_PostPaid_PC_Change</em>) is
                                            calculated and the TTC value is further used in
                                            computing the VT value.</p>

                                        <ol class="ol">
                                            <li class="li">
                                                <p class="p">TTC is computed as per the following
                                                  conditions:</p>

                                                
                                                <ul class="ul">
                                                  <li class="li">
                                                  <p class="p">If there is no <em class="ph i">T2</em> or no next
                                                  subscription event takes place before (<em class="ph i">T1</em> +
                                                  <em class="ph i">TTCAFlarge</em> + <em class="ph i">MINspread</em>), then
                                                  <samp class="ph systemoutput">TTC = T1 + random value between 1
                                                  second and TTCAFlarge</samp>.</p>

                                                  </li>

                                                  <li class="li">
                                                  <p class="p">If there are two subscription events happening,
                                                  which means both <em class="ph i">T1</em> and <em class="ph i">T2</em> take
                                                  place, then <samp class="ph systemoutput">TTC = T1 + random value
                                                  between 1 second and
                                                  (T2-T1-MINspread)</samp>.</p>

                                                  </li>

                                                </ul>

                                            </li>

                                            <li class="li">
                                                <p class="p">And, VT is computed as per the formula:</p>

                                                <p class="p">
                                                  <samp class="ph systemoutput">VT = Time to calculated TTC +
                                                  MINspread</samp>.</p>

                                            </li>

                                        </ol>

                                   </td>

                                </tr>

                            </tbody>
</table>
</div>

</div>
            <div class="sectiondiv">
                
                <p class="p"><strong class="ph b">Postpaid policy counter change</strong></p>

                <table cellpadding="4" cellspacing="0" summary="" id="id9yz-09126-ug01-pczza-sp1-d1e24011__table_dpw_tp5_smb" class="table" frame="border" border="1" rules="all"><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead class="thead" style="text-align:left;">
                            <tr class="row">
                                <th class="entry cellrowborder" style="vertical-align:top;" id="d169138e855">
                                    <p class="p">If...</p>

                               </th>

                                <th class="entry cellrowborder" style="vertical-align:top;" id="d169138e861">
                                    <p class="p">Then...</p>

                               </th>

                            </tr>

                        </thead>
<tbody class="tbody">
                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e855 ">
                                    <p class="p">The postpaid policy counter status does not change,</p>

                               </td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e861 ">
                                    <p class="p">The usage does not change from throttled to unthrottled at
                                        the TTC time.</p>

                                    <p class="p">NCC allows a larger spread of VT to spread out the traffic.
                                        Therefore, VTAF value is used to spread out the traffic for
                                        a longer time.</p>

                                    <p class="p">VTAF value is set as larger, for example <var class="keyword varname">4
                                            hours</var>.</p>

                               </td>

                            </tr>

                            <tr class="row">
                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e855 ">
                                    <p class="p">The postpaid policy counter status changes,</p>

                               </td>

                                <td class="entry cellrowborder" style="vertical-align:top;" headers="d169138e861 ">
                                    <p class="p">The usage is computed as QoS changes from unthrottled to
                                        throttled at the TTC time.</p>

                                    <p class="p">To avoid usage to go beyond the TTC time, the values of TTC
                                        and VT should be close instead of using <em class="ph i">TTCAF</em>.
                                        However, a larger adjustment factor for TTC, which is
                                            <em class="ph i">TTCAFlarge</em> to assure that all throttled sessions
                                        do not return in too short of an interval.</p>

                               </td>

                            </tr>

                        </tbody>
</table>

                <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> <p class="p">If nearest TTC subscriber has at least one subscription with validity time
                        from entity lifecycle or the subscription has maximum renewal reached, then
                        TTC is computed as:</p>

                    <ul class="ul" id="id9yz-09126-ug01-pczza-sp1-d1e24011__ul_upk_n55_smb">
                        <li class="li">For subscription taken from prepaid type account, only VT value is sent
                            and that calculation is same as mentioned in the <em class="ph i">Prepaid accounts
                                behavior</em> section.</li>

                        <li class="li">For subscription taken from postpaid type account, TTC and VT values are
                            computed assuming policy counter change.</li>

                    </ul>

                </div>

            </div>
</div>

<div class="section"><h2 class="title sectiontitle">Additional information</h2>
<p class="p">Following assumptions are applied to this feature:</p>
<ul class="ul">
<li class="li">
<p class="p">The device considered has a bundle subscription from a single prepaid or postpaid account.</p>

</li>

<li class="li">
<p class="p">A BOU bundle has the <span class="ph uicontrol">TTC Disabled Flag</span> parameter set as <var class="keyword varname">true</var> or enabled.</p>

</li>

                <li class="li">
                    <p class="p">The TOD start time needs less time than stop time. However, TOD across days
                        is not supported, which means TOD does not go beyond midnight.</p>

                </li>

<li class="li">
<p class="p">In the <em class="ph i">Tariff-Time-Usage</em> AVP, the TTC intermediate scenario does not work for NCHF.</p>

</li>

                <li class="li">
                    <p class="p">This feature is applicable only to the following entities and under the given
                        condition:</p>

                    <ul class="ul" id="id9yz-09126-ug01-pczza-sp1-d1e24011__ul_kbb_xv5_smb">
                        <li class="li">
                            <p class="p">Centralized charging with static slice configured in quota management
                                (slicing profile) rule. However, it is not applicable to the dynamic
                                slicing mechanism.</p>

                        </li>

                        <li class="li">
                            <p class="p">Subscription and multi-bundle counters</p>

                        </li>

                        <li class="li">
                            <p class="p">Buckets and counters</p>

                        </li>

                        <li class="li">
                            <p class="p">When there is no TOD event, which occurs prior to the <em class="ph i">T1</em>
                                associated with the first subscription event. Also, the <em class="ph i">T2</em> is
                                set to the nearest subscription event or TOD event after the
                                    <em class="ph i">T1</em> event.</p>

                        </li>

                    </ul>

                </li>

<li class="li">
<p class="p">This feature is not applicable to following entities:</p>
<ul class="ul">
<li class="li">
<p class="p">Groups</p>

</li>

<li class="li">
<p class="p">Account main balance or aggregate view (AV)</p>

</li>

</ul>

</li>

                <li class="li">
                    <p class="p">According to the
                            <a class="xref" href="usagecontrol.html">Usage control functionality</a> feature, the
                        self-counter cannot be throttled, which means they cannot be a policy
                        counter. Therefore, this feature related to TTC on postpaid account with
                        policy counter or VPC being throttled is not applicable to UC
                        self-counter.</p>

                </li>

</ul>

<div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> It is recommended to enable the <span class="ph uicontrol">Disable TTC</span> flag in a bundle
                configuration for short subscription lifecycle scenarios, such as hourly and the VT
                in quota management (slicing profile) is recommended to be set to a value less than
                24 hours, such as 8 or 12 hours.</div>

</div>

<div class="section"><h2 class="title sectiontitle">Examples</h2>
<p class="p">Consider the following examples to understand this feature in a better way:</p>

<div class="sectiondiv">
                
<p class="p"><strong class="ph b">Example 1: Set the Disable TTC flag as true</strong></p>

<p class="p">This example considers that the <span class="ph uicontrol">Disable TTC</span> flag in a bundle is set as <var class="keyword varname">true</var> or enabled. The subscription does not have its own periodic lifecycle and is renewed during the funding of BCR processing for a prepaid account.</p>

<p class="p">
<strong class="ph b">Preconditions:</strong>
</p>
<ol class="ol">
<li class="li">
<p class="p">Configure the following ME application preferences:</p>
<ul class="ul">
<li class="li">
<p class="p">Set <span class="ph uicontrol">Min Spread (seconds)</span> as <var class="keyword varname">60</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor Prepaid (seconds)</span> as <var class="keyword varname">1800</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor (seconds)</span> as <var class="keyword varname">14400</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor (seconds)</span> as <var class="keyword varname">300</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor Large (seconds)</span> as <var class="keyword varname">3000</var>.</p>

</li>

</ul>

</li>

<li class="li">
<p class="p">Set the <em class="ph i">Validity Time</em> in quota management (slicing profile) as <var class="keyword varname">43200
                                seconds</var>.</p>

</li>

<li class="li">
<p class="p">Enable the TTC RSV in Gy pre-processing.</p>

</li>

<li class="li">
<p class="p">The charging service has no charge with a subscription counter.</p>

</li>

<li class="li">
<p class="p">Enable the <span class="ph uicontrol">Disable TTC</span> flag in the bundle.</p>

</li>

<li class="li">
<p class="p">Bundle does not have any periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">Create a prepaid account with a daily periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">Set the renewal time as 12 midnight.</p>

</li>

<li class="li">
<p class="p">The device subscribes to the bundle using the prepaid account.</p>

</li>

</ol>

<p class="p">
<strong class="ph b">Post-conditions:</strong>
</p>
<ul class="ul">
<li class="li">
<p class="p">Execute a session-based call, such that VT spans the renewal of account.</p>

</li>

<li class="li">
<p class="p">This example verifies that the TTC is not set and VT is not randomized and set as time to <em class="ph i">T1</em> (Time to BCR).</p>

</li>

</ul>

</div>
<div class="sectiondiv">
                
<p class="p"><strong class="ph b">Example 2: Device with prepaid account</strong></p>

<p class="p">This example considers that the <span class="ph uicontrol">Disable TTC</span> flag in a bundle is set as <var class="keyword varname">false</var> or disabled. There are two subscriptions <var class="keyword varname">S1</var> and <var class="keyword varname">S2</var>, each having its own periodic lifecycle and are subscribed using the same prepaid account. Currently, <var class="keyword varname">S1</var> is active and <var class="keyword varname">S2</var> would get activated in future.</p>

<p class="p">
<strong class="ph b">Preconditions:</strong>
</p>
<ol class="ol">
<li class="li">
<p class="p">Configure the following ME application preferences:</p>
<ul class="ul">
<li class="li">
<p class="p">Set <span class="ph uicontrol">Min Spread (seconds)</span> as <var class="keyword varname">60</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor Prepaid (seconds)</span> as <var class="keyword varname">1800</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor (seconds)</span> as <var class="keyword varname">14400</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor (seconds)</span> as <var class="keyword varname">300</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor Large (seconds)</span> as <var class="keyword varname">3000</var>.</p>

</li>

</ul>

</li>

<li class="li">
<p class="p">Set the <em class="ph i">Validity Time</em> in quota management (slicing profile) as <var class="keyword varname">43200
                                seconds</var>.</p>

</li>

<li class="li">
<p class="p">Enable the TTC RSV in Gy pre-processing.</p>

</li>

<li class="li">
<p class="p">For <var class="keyword varname">Bundle1</var>, there is a charging service having no charge with a multi-bundle counter.</p>

<p class="p">Disable the <span class="ph uicontrol">Disable TTC</span> flag in the bundle and the bundle has a daily periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">For <var class="keyword varname">Bundle2</var>, there is a charging service having no charge with a subscription counter.</p>

<p class="p">Disable the <span class="ph uicontrol">Disable TTC</span> flag in the bundle and the bundle has a different daily periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">Create a prepaid account with a monthly periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">The device subscribes to <var class="keyword varname">Bundle1</var> using the prepaid account, and also subscribes to <var class="keyword varname">Bundle2</var> with a future activation date.</p>

</li>

</ol>

<p class="p">
<strong class="ph b">Post-conditions:</strong>
</p>
<ul class="ul">
<li class="li">
<p class="p">Execute a session-based call, such that VT spans the renewal of <var class="keyword varname">Bundle1</var> and the activation time of <var class="keyword varname">Bundle2</var> is also approaching.</p>

</li>

<li class="li">
<p class="p">This example verifies that TTC is not set and VT is set as time to <samp class="ph systemoutput">T1 + random value between 1 second and (T2-T1)</samp>.</p>

</li>

</ul>

</div>
<div class="sectiondiv">
                
<p class="p"><strong class="ph b">Example 3: Device with postpaid account and without policy counter status change</strong></p>

<p class="p">This example considers that the subscription does not have its own periodic lifecycle and is renewed during the funding of BCR processing for a postpaid account.</p>

<p class="p">
<strong class="ph b">Preconditions:</strong>
</p>
<ol class="ol">
<li class="li">
<p class="p">Configure the following ME application preferences:</p>
<ul class="ul">
<li class="li">
<p class="p">Set <span class="ph uicontrol">Min Spread (seconds)</span> as <var class="keyword varname">60</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor Prepaid (seconds)</span> as <var class="keyword varname">1800</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor (seconds)</span> as <var class="keyword varname">14400</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor (seconds)</span> as <var class="keyword varname">300</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor Large (seconds)</span> as <var class="keyword varname">3000</var>.</p>

</li>

</ul>

</li>

<li class="li">
<p class="p">Set the <em class="ph i">Validity Time</em> in quota management (slicing profile) as <var class="keyword varname">43200
                                seconds</var>.</p>

</li>

<li class="li">
<p class="p">Enable the TTC RSV in Gy pre-processing.</p>

</li>

<li class="li">
<p class="p">The charging service has no charge with a subscription counter.</p>

<p class="p">The counter has a threshold attached, which is <var class="keyword varname">0</var> for unthrottled and <var class="keyword varname">20MB</var> for throttled.</p>

</li>

<li class="li">
<p class="p">The bundle does not have any periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">Create a postpaid account with a daily periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">Set the renewal time as 12 midnight.</p>

</li>

<li class="li">
<p class="p">The device subscribes to bundle using the postpaid account.</p>

</li>

</ol>

<p class="p">
<strong class="ph b">Post-conditions:</strong>
</p>
<ul class="ul">
<li class="li">
<p class="p">Execute a session-based call, such that VT spans the renewal of postpaid account and there is no policy counter status change expected at the renewal of account.</p>

</li>

<li class="li">
<p class="p">This example verifies that TTC is set to <samp class="ph systemoutput">T1 + random value between 1 second and TTCAF</samp>, and VT is set to <samp class="ph systemoutput">Time to T1 + random value between (calculated TTC - T1 + MINspread) and the minimum value between VTAF and (VT - Time to T1)</samp>.</p>

</li>

</ul>

</div>
<div class="sectiondiv">
                
<p class="p"><strong class="ph b">Example 4: Device with postpaid account and policy counter status change</strong></p>

<p class="p">This example considers that the subscription does not have its own periodic lifecycle and is renewed during the funding of BCR processing for a postpaid account.</p>

<p class="p">
<strong class="ph b">Preconditions:</strong>
</p>
<ol class="ol">
<li class="li">
<p class="p">Configure the following ME application preferences:</p>
<ul class="ul">
<li class="li">
<p class="p">Set <span class="ph uicontrol">Min Spread (seconds)</span> as <var class="keyword varname">60</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor Prepaid (seconds)</span> as <var class="keyword varname">1800</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor (seconds)</span> as <var class="keyword varname">14400</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor (seconds)</span> as <var class="keyword varname">300</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor Large (seconds)</span> as <var class="keyword varname">3000</var>.</p>

</li>

</ul>

</li>

<li class="li">
<p class="p">Set the <em class="ph i">Validity Time</em> in quota management (slicing profile) as <var class="keyword varname">43200
                                seconds</var>.</p>

</li>

<li class="li">
<p class="p">Enable the TTC RSV in Gy pre-processing.</p>

</li>

<li class="li">
<p class="p">The charging service has no charge with a subscription counter.</p>

</li>

<li class="li">
<p class="p">The bundle does not have any periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">Create a postpaid account with a daily periodic lifecycle and the renewal time as 12 midnight.</p>

</li>

<li class="li">
<p class="p">The device subscribes to bundle using the postpaid account.</p>

</li>

</ol>

<p class="p">
<strong class="ph b">Post-conditions:</strong>
</p>
<ul class="ul">
<li class="li">
<p class="p">Execute a session-based call, such that VT spans the renewal of postpaid account, and there is a policy counter status change expected at the renewal of account.</p>

</li>

<li class="li">
<p class="p">This example verifies that TTC is set to <samp class="ph systemoutput">T1 + random value between 1 second and TTCAFlarge</samp>, and VT is set to <samp class="ph systemoutput">time to calculated TTC + MINspread</samp>.</p>

</li>

</ul>

</div>
<div class="sectiondiv">
                
<p class="p"><strong class="ph b">Example 5: Travel-pass feature BOU activation</strong></p>

<p class="p">This example considers that the BOU bundle travel-pass subscription has its own periodic lifecycle with the <span class="ph uicontrol">Disable TTC</span> flag set as <var class="keyword varname">true</var>. Both base bundle and travel-pass bundle are subscribed through the same account.</p>

<p class="p">
                    <strong class="ph b">Preconditions:</strong></p>
<ol class="ol">
<li class="li">
<p class="p">Configure the following ME application preferences:</p>
<ul class="ul">
<li class="li">
<p class="p">Set <span class="ph uicontrol">Min Spread (seconds)</span> as <var class="keyword varname">60</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor Prepaid (seconds)</span> as <var class="keyword varname">1800</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">VT Adjustment Factor (seconds)</span> as <var class="keyword varname">14400</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor (seconds)</span> as <var class="keyword varname">300</var>.</p>

</li>

<li class="li">
<p class="p">Set <span class="ph uicontrol">TTC Adjustment Factor Large (seconds)</span> as <var class="keyword varname">3000</var>.</p>

</li>

</ul>

</li>

<li class="li">
<p class="p">Set the <em class="ph i">Validity Time</em> in quota management (slicing profile) as <var class="keyword varname">43200
                                seconds</var>.</p>

</li>

<li class="li">
<p class="p">Enable the TTC RSV in Gy pre-processing.</p>

</li>

<li class="li">
<p class="p">The base bundle has charging service with no charge and a subscription counter. The base bundle does not have any periodic lifecycle.</p>

</li>

<li class="li">
<p class="p">Enable the <span class="ph uicontrol">Disable TTC</span> flag for the BOU travel-pass bundle and its own periodic lifecycle, which is going to expire in 12 hours.</p>

</li>

<li class="li">
<p class="p">Create a prepaid account with a weekly periodic lifecycle and the renewal time is after a week.</p>

</li>

<li class="li">
<p class="p">A device subscribes to base bundle and BOU travel-pass bundle using this prepaid account.</p>

</li>

<li class="li">
<p class="p">The BOU travel-pass bundle is activated during the roaming usage.</p>

</li>

</ol>

<p class="p"><strong class="ph b">Post-conditions:</strong></p>
<ul class="ul">
<li class="li">
<p class="p">Execute a session-based call, such that VT spans the expiry of BOU travel-pass bundle.</p>

</li>

<li class="li">
<p class="p">This example verifies that no TTC is returned and VT is set to time to expiry of BOU travel-pass bundle.</p>

</li>

</ul>

</div>
            <div class="sectiondiv">
                
                <p class="p"><strong class="ph b">Example 6: TTC with UC TOD</strong></p>

                <p class="p">This example verifies that TTC is not set and VT is adjusted with TOD when call
                    is sent before TOD and BCR is after TOD.</p>

                <p class="p"><strong class="ph b">Preconditions:</strong></p>

                <ol class="ol" id="id9yz-09126-ug01-pczza-sp1-d1e24011__ol_zjs_hx5_smb">
                    <li class="li">
                        <p class="p">Create UC with TOD set as <var class="keyword varname">8 to 12 PM</var> on all days and a
                            charging service with no charge.</p>

                    </li>

                    <li class="li">
                        <p class="p">Create a bundle with <strong class="ph b">Disable TTC</strong> parameter set as
                                <var class="keyword varname">false</var> or disabled.</p>

                    </li>

                    <li class="li">
                        <p class="p">Create a postpaid account with default lifecycle.</p>

                    </li>

                    <li class="li">
                        <p class="p">Subscribe the device to the above create bundle with the postpaid
                            account.</p>

                    </li>

                </ol>

                <p class="p"><strong class="ph b">Post-conditions:</strong></p>

                <ol class="ol" id="id9yz-09126-ug01-pczza-sp1-d1e24011__ol_rj5_rx5_smb">
                    <li class="li">
                        <p class="p">Execute an SCUR initial call at <var class="keyword varname">06:59:30 PM</var> and update
                            at <var class="keyword varname">08:00:30 PM</var>.</p>

                    </li>

                    <li class="li">
                        <p class="p">This example verifies that TTC is not set and VT is reduced to TOD in
                            initial and in update as call falls within TOD, and GSU is set to
                                <var class="keyword varname">0</var>.</p>

                    </li>

                </ol>

                <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Start time must be less than stop time. TOD across days is not supported, that
                    is, TOD does not go beyond midnight.</div>

            </div>
</div>

</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>