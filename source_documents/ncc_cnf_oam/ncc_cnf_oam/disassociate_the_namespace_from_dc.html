<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Disassociate the namespace from Data Center" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="Bookmark21" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Disassociate the namespace from Data Center</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="Bookmark21">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Disassociate the namespace from Data Center</h1>
<div class="body conbody">
        <p class="p">Stop forwarder and disassociate all common namespaces between the current site and the
            recovering site with the following commands. Except for the recovering site, these
            commands should be run for all CHF in pair/quad.</p>

        <pre class="pre codeblock"><code># Disassociate all common partition and dscglobal

kubectl -it exec &lt;admincli&gt; -c &lt;container&gt; -n &lt;namespace&gt; -- /opt/tpa/bin/disaster-recovery-helper.py -a remove -s &lt;recovering_site_name&gt; 
# Type y or yes and press enter when it ask for confirmation “Do you want to continue?: y|yes|n|no”
# Verify the result should be 'ok' for every DB pod. If you receive an error, retry the command again and check all DB pods are running or not.

# Verify current association, enabled should be false
kubectl -it exec &lt;admincli&gt; -c &lt;container&gt; -n &lt;namespace&gt; -- /opt/tpa/bin/disaster-recovery-helper.py -g -s &lt;recovering_site_name&gt; </code></pre>
        <div class="p">Where:<ul class="ul" id="Bookmark21__ul_rgh_xdb_bqb">
                <li class="li"><code class="ph codeph">&lt;admincli&gt;</code> is the name of the admincli pod.</li>

                <li class="li"><code class="ph codeph">&lt;container&gt;</code> is the name of the container.</li>

                <li class="li"><code class="ph codeph">&lt;namespace&gt;</code> is the name of the namespace.</li>

                <li class="li"><code class="ph codeph">&lt;recovering_site_name&gt;</code> is the name of the recovering
                    site.</li>

            </ul>
</div>

        <p class="p">For example, this example shows expected output of the above commands with
                <code class="ph codeph">growthme-admincli-7c986dccf8-ptlk8</code> as
                <code class="ph codeph">&lt;admincli&gt;</code>, <code class="ph codeph">growthme-admincli</code> as
                <code class="ph codeph">&lt;container&gt;</code>, <code class="ph codeph">sps-btel-me6</code> as
                <code class="ph codeph">&lt;namespace&gt;</code>, and <code class="ph codeph">me5</code> as
                <code class="ph codeph">&lt;recovering_site_name&gt;</code>.</p>

        <pre class="pre codeblock" id="Bookmark21__codeblock_dwg_xrb_bqb"><code>[root@bcmtvzrm3-control-01 me6]# kubectl -it exec growthme-admincli-7c986dccf8-ptlk8 -c growthme-admincli -n sps-btel-me6 -- /opt/tpa/bin/disaster-recovery-helper.py -a remove -s me5
 2021-06-13T17:00:02,716 INFO: Going to dis-associate the partitions and dscglobal namespaces of target site 'me5' from source site 'me6'. Also, going to disable the forwarder.
 2021-06-13T17:00:02,790 INFO: Going to run following set of commands on 'me6' :
 {
 /opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=spspd5;action=remove'";
 /opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=spspd5;forward=false'";
 /opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=spspd6;action=remove'";
 /opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=spspd6;forward=false'";
 /opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=dscglobal;action=remove'";
 /opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=dscglobal;forward=false'";
 }
 Do you want to continue?: y|yes|n|no
 y
 2021-06-13T17:00:10,111 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=spspd5;action=remove'";'.
 2021-06-13T17:00:10,957 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 ok
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 ok
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 ok
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 ok
 2021-06-13T17:00:10,985 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=spspd5;forward=false'";'.
 2021-06-13T17:00:11,706 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 ok
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 ok
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 ok
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 ok
 2021-06-13T17:00:11,738 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=spspd6;action=remove'";'.
 2021-06-13T17:00:12,431 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 ok
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 ok
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 ok
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 ok
 2021-06-13T17:00:12,464 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=spspd6;forward=false'";'.
 2021-06-13T17:00:13,178 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 ok
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 ok
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 ok
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 ok
 2021-06-13T17:00:13,209 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=dscglobal;action=remove'";'.
 2021-06-13T17:00:13,938 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 ok
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 ok
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 ok
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 ok
 2021-06-13T17:00:13,967 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'set-config:context=xdr;dc=spssite5;namespace=dscglobal;forward=false'";'.
 2021-06-13T17:00:14,730 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 ok
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 ok
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 ok
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 ok
 2021-06-13T17:00:14,763 INFO: Exiting...
 INFO: Logs can be seen in log file '/tmp/disaster-recovery-helper.py.log'.
 [root@bcmtvzrm3-control-01 me6]#
 [root@bcmtvzrm3-control-01 me6]# kubectl -it exec growthme-admincli-7c986dccf8-ptlk8 -c growthme-admincli -n sps-btel-me6 -- /opt/tpa/bin/disaster-recovery-helper.py -g -s me5
 2021-06-13T17:00:30,719 INFO: Getting association details of partitions and dscglobal namespaces for target site 'me5' from source site 'me6'.
 2021-06-13T17:00:30,751 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'get-config:context=xdr;dc=spssite5;namespace=spspd5'";'.
 2021-06-13T17:00:31,518 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 2021-06-13T17:00:31,548 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'get-config:context=xdr;dc=spssite5;namespace=spspd6'";'.
 2021-06-13T17:00:32,281 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 2021-06-13T17:00:32,309 INFO: Going to run command '/opt/aerospike/bin/asadm -e "asinfo -v 'get-config:context=xdr;dc=spssite5;namespace=dscglobal'";'.
 2021-06-13T17:00:33,107 INFO: The result is
 Seed: [('me-aerospike-service.sps-btel-me6.svc.cluster.local', 3010, '*.dyn.nesc.nokia.net')]
 Config_file: /opt/tpa/users/tpaadmin/.aerospike/astools.conf, /etc/aerospike/astools.conf
 growthme-aerospike-rk1-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.76) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk1-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.66.127) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk2-0.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.219) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 growthme-aerospike-rk2-1.me-aerospike-service.sps-btel-me6.svc.cluster.local:3010 (192.168.17.192) returned:
 enabled=false;bin-policy=all;compression-level=1;delay-ms=0;enable-compression=false;forward=false;hot-key-ms=100;ignored-bins=;ignore-expunges=false;ignored-sets=;max-throughput=100000;remote-namespace=null;sc-replication-wait-ms=100;shipped-bins=;ship-nsup-deletes=false;ship-only-specified-sets=false;shipped-sets=;transaction-queue-limit=16384;write-policy=auto
 2021-06-13T17:00:33,139 INFO: Exiting...
 INFO: Logs can be seen in log file '/tmp/disaster-recovery-helper.py.log'.</code></pre>
    </div>
<div class="footer"><hr /><p>Operations, Administration, and Maintenance Guide • P556766-DN1000055092-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>