<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="task" />
<meta name="DC.title" content="Validating installation of an SM, ME, or IG" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="validating_ncc_cnf_installation" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Validating installation of an SM, ME, or IG</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="validating_ncc_cnf_installation">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Validating installation of an SM, ME, or IG</h1>
<div class="body taskbody">
        <div class="section context"><div class="tasklabel"><h2 class="sectiontitle tasklabel"></h2></div>
            <p class="p">This procedure provides instructions on how to validate the installation of an SM,
                ME, or IG.</p>

        </div>

        <div class="tasklabel"><h2 class="sectiontitle tasklabel"></h2></div><ol class="ol steps"><li class="li step stepexpand">
                <span class="ph cmd">Run Helm test by entering:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>cd output/SITENAME
. site.conf
YAML_DIRECTORY="$(realpath charts)"
 
helm -n $NAMESPACE test shared-istio-gateway
 
# If cmdb is installed separately.
if [ -f "${YAML_DIRECTORY}/cmdb-ckey.yaml" ]; then
  helm -n $NAMESPACE test cmdb-ckey
fi
 
if [ -f "${YAML_DIRECTORY}/ckey.yaml" ]; then
  helm -n $NAMESPACE test ckey
fi
 
# For installation of umbrella chart
# helm -n $NAMESPACE test ${SITE_TYPE}
 
# For separate <span class="ph">NCC</span> charts.
helm -n $NAMESPACE test ${SITE_TYPE}-admincli
helm -n $NAMESPACE test ${SITE_TYPE}-aerospike
helm -n $NAMESPACE test ${SITE_TYPE}-centralmanagement
if [ -f "${YAML_DIRECTORY}/chf-charging.yaml" ]; then
  helm -n $NAMESPACE test ${SITE_TYPE}-charging
  helm -n $NAMESPACE test ${SITE_TYPE}-iohd
  helm -n $NAMESPACE test ${SITE_TYPE}-provisioning
fi
if [ -f "${YAML_DIRECTORY}/chf-ldapspr.yaml" ]; then
  helm -n $NAMESPACE test ${SITE_TYPE}-ldapconcentrator
  helm -n $NAMESPACE test ${SITE_TYPE}-ldapspr
fi
if [ -f "${YAML_DIRECTORY}/chf-notification.yaml" ]; then
  helm -n $NAMESPACE test ${SITE_TYPE}-notification
fi
if [ -f "${YAML_DIRECTORY}/chf-servicemanager.yaml" ]; then
  helm -n $NAMESPACE test ${SITE_TYPE}-servicemanager
fi
if [ -f "${YAML_DIRECTORY}/chf-xdrproxy.yaml" ]; then
  helm -n $NAMESPACE test ${SITE_TYPE}-xdrproxy
fi
 
 
helm -n $NAMESPACE test btel-${SITE_TYPE}
 
if [ -f "${YAML_DIRECTORY}/dr.yaml" ]; then
  helm -n $NAMESPACE test dr
fi
 
if [ -f "${YAML_DIRECTORY}/ap-streams.yaml" ]; then
  helm -n $NAMESPACE test ap-streams
fi
 
if [ -f "${YAML_DIRECTORY}/cdr-streams.yaml" ]; then
  helm -n $NAMESPACE test cdr-streams
fi</code></pre>
                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">If <span class="ph">NCC</span> Telemetry is installed, enter:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>helm -n $NAMESPACE test btel</code></pre>
                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">If the system is an ME or IG, access User and Role Management by
                    entering:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>echo "Open a browser to https://$FQDN/auth/"</code></pre>
                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Once the <code class="ph codeph">servicemanager</code> pod is ready, access the SM console by
                    going to <span class="ph filepath">https://$FQDN/servicemanager</span></span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">If you installed <span class="ph">NCC</span> Telemetry, ensure that
                    Prometheus, Alarm Service, OpenSearch Dashboard, and Metrics Viewer are running
                    by accessing their respective GUI.</span>
                <div class="itemgroup info">
                    <p class="p">This table describes the access to services for SM and ME.</p>

                    <table cellpadding="4" cellspacing="0" summary="" id="validating_ncc_cnf_installation__table_pty_3sd_xlb" class="simpletable simpletableborder"><col style="width:14.245014245014245%" /><col style="width:26.780626780626783%" /><col style="width:28.917378917378915%" /><col style="width:30.05698005698006%" /><thead><tr class="sthead">
                            <th style="vertical-align:bottom;text-align:left;" id="d24516e103" class="stentry">Service</th>

                            <th style="vertical-align:bottom;text-align:left;" id="d24516e106" class="stentry">SM <p class="p">(namespace=sps-btel-sm/releasename=btel-sm)</p>
</th>

                            <th style="vertical-align:bottom;text-align:left;" id="d24516e111" class="stentry">ME<p class="p">(namespace=sps-btel-me/releasename=btel-me)</p>
</th>

                            <th style="vertical-align:bottom;text-align:left;" id="d24516e116" class="stentry">NCC
                                Telemetry<p class="p">(namespace=sps-btel/releasename=btel)</p>
</th>

                        </tr>
</thead><tbody><tr class="strow">
                            <td style="vertical-align:top;" headers="d24516e103" class="stentry">OpenSearch Dashboard</td>

                            <td style="vertical-align:top;" headers="d24516e106" class="stentry">https://$FQDN/logviewer-sm</td>

                            <td style="vertical-align:top;" headers="d24516e111" class="stentry">https://$FQDN/logviewer-me</td>

                            <td style="vertical-align:top;" headers="d24516e116" class="stentry">https://$FQDN/logviewer-btel</td>

                        </tr>
<tr class="strow">
                            <td style="vertical-align:top;" headers="d24516e103" class="stentry">Metrics Viewer</td>

                            <td style="vertical-align:top;" headers="d24516e106" class="stentry">https://$FQDN/grafana-sm</td>

                            <td style="vertical-align:top;" headers="d24516e111" class="stentry">https://$FQDN/grafana-me</td>

                            <td style="vertical-align:top;" headers="d24516e116" class="stentry">https://$FQDN/grafana-btel</td>

                        </tr>
<tr class="strow">
                            <td style="vertical-align:top;" headers="d24516e103" class="stentry">Prometheus</td>

                            <td style="vertical-align:top;" headers="d24516e106" class="stentry">https://$FQDN/prometheus-sm</td>

                            <td style="vertical-align:top;" headers="d24516e111" class="stentry">https://$FQDN/prometheus-me</td>

                            <td style="vertical-align:top;" headers="d24516e116" class="stentry">https://$FQDN/prometheus-btel</td>

                        </tr>
<tr class="strow">
                            <td style="vertical-align:top;" headers="d24516e103" class="stentry">Alarm Service</td>

                            <td style="vertical-align:top;" headers="d24516e106" class="stentry">https://$FQDN/calm-sm</td>

                            <td style="vertical-align:top;" headers="d24516e111" class="stentry">https://$FQDN/calm-me</td>

                            <td style="vertical-align:top;" headers="d24516e116" class="stentry">https://$FQDN/calm-btel</td>

                        </tr>
</tbody></table>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">If you installed <span class="ph">NCC</span> and <span class="ph">NCC</span> Telemetry in the same namespace, and if needed,
                    set an OpenSearch Dashboard filter to filter out only <span class="ph">NCC</span>-related pods by entering:</span>
                <div class="itemgroup info">
                    <pre class="pre codeblock"><code>{
  "query": {
    "regexp": {
      "host.keyword": {
        "value": "(kf|zk){0,1}-?sps-.*"
      }
    }
  }
}</code></pre>
                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">If Backup and Recovery is enabled, you can perform <span class="ph">NCC</span> Telemetry backup and restore procedure. For
                    information on the procedure, see the <cite class="cite">Operation, Administration, and
                        Maintenance Guide</cite>.</span>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Verify the Eventlink UI by going to
                        <span class="ph filepath">https://$FQDN/eventlink</span>.</span>
                <div class="itemgroup info">
                    <ul class="ul" id="validating_ncc_cnf_installation__ul_uhn_52g_dmb">
                        <li class="li">Enter <code class="ph codeph">dr-admin</code> for username.</li>

                        <li class="li">Enter your password. <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> To get the password, run:
                                <pre class="pre codeblock"><code>echo -n 'ChangeIt123!' | base64</code></pre></div>
</li>

                    </ul>

                </div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">If mTLS is used, test whether mTLS mode is set up correctly for host
                    ${FQDN_MTLS} by verifying the following:</span>
                <div class="itemgroup info"><ul class="ul" id="validating_ncc_cnf_installation__ul_yqz_bgw_w4b">
                        <li class="li">requests without the client certificate and key fail</li>

                        <li class="li">requests with the correct client certificate and key succeed</li>

                    </ul>
To test mTLS, do the following, assuming that the User and Role Management
                    Helm chart is installed:<ol class="ol" type="a" id="validating_ncc_cnf_installation__ol_ngn_jpw_w4b">
                        <li class="li">Access the User and Role Management admin console, and submit a request
                            without the client certificate and key by entering: <pre class="pre codeblock"><code>
curl --cacert ./ca.nokia.com.crt -i https://${FQDN_MTLS}/auth/</code></pre><p class="p"><strong class="ph b">Expected
                                    output</strong></p>
<pre class="pre codeblock"><code>client certificate not found</code></pre></li>

                        <li class="li">Submit a request with the correct client certificate and key by
                                entering:<p class="p">Example:</p>
<pre class="pre codeblock"><code>cd certs
curl --cert ./wildcard.dyn.nesc.nokia.net.crt --key ./wildcard.dyn.nesc.nokia.net.key --cacert ./ca.nokia.com.crt -i https://${FQDN_MTLS}/auth/ | grep "200 OK"
cd ..</code></pre><p class="p"><strong class="ph b">Expected output</strong></p>
The request
                            succeeds.</li>

                        <li class="li">Repeat both requests for the SM console replacing <code class="ph codeph">/auth</code>
                            with <code class="ph codeph">/servicemanager</code>.</li>

                    </ol>
</div>
            </li>
<li class="li step stepexpand">
                <span class="ph cmd">Verify the status of SS7 pods by entering:</span>
                <div class="itemgroup info">
                    <div class="p">
                        <pre class="pre codeblock"><code>$kubectl get pods -n &lt;namespace&gt; | grep ss7</code></pre>
                    </div>

                    <p class="p"><strong class="ph b">Expected output</strong></p>

                    <div class="p">
                        <pre class="pre codeblock"><code>[root@kubernetes-microk8s-1 sp5]#docker image osp-sdp:21.3.100 localhost:5000/sdp:21.3.100</code></pre>
                    </div>

                    <p class="p">If SS7 pods are not running after helm installation or are in pending or Init
                        state due to resource or other issue, troubleshoot the issue as follows:</p>

                    <ul class="ul" id="validating_ncc_cnf_installation__ul_bww_xdg_1rb">
                        <li class="li">Check logs of events related to a pod using the
                            following:<pre class="pre codeblock" id="validating_ncc_cnf_installation__codeblock_qrw_kxx_5qb"><code>$ kubectl describe pod &lt;pod name&gt; -n &lt;namespace&gt;</code></pre></li>

                        <li class="li">
                            <p class="p">Check individual events related to a pod using the following
                                command:</p>

                            <pre class="pre codeblock" id="validating_ncc_cnf_installation__codeblock_wqf_4xx_5qb"><code>$ kubectl get events -n &lt;namespace&gt; | grep &lt;podname&gt;</code></pre>
                        </li>

                    </ul>

                </div>
            </li>
</ol>

    </div>
<div class="footer"><hr /><p>Installation and Upgrade Guide • P556766-DN1000055103-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>