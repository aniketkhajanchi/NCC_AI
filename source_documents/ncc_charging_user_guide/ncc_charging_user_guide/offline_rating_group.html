<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Allow specific rating groups without counting usage for access barred devices" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="offline_rating_group" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Allow specific rating groups without counting usage for access barred devices</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="offline_rating_group">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Allow specific rating groups without counting usage for access barred devices</h1>
<div class="body conbody">
        <div class="section" id="offline_rating_group__section_ct5_xzf_znb">
            <p class="p">This feature is applicable to Gy and N40 interfaces.</p>

            <p class="p">After configuring the offline rating group values in a rule (RSV), if a Gy call has
                the same rating group value that is configured in the rule, then this Gy (data or
                PS) call is processed as offline charging.</p>

            <p class="p">For a 5G Nchf request, the rating group of muu matched with the offline rating groups
                is configured in RSV, and if one of the following condition is met:</p>

            <ul class="ul" id="offline_rating_group__ul_x4r_21h_znb">
                <li class="li">
                    <p class="p">The <em class="ph i">quotaManagementIndicator</em> attribute value for that muu is
                            <var class="keyword varname">OFFLINE_CHARGING</var>, or</p>

                </li>

                <li class="li">
                    <p class="p"><em class="ph i">uuc</em> is not present and <em class="ph i">requestedUnit</em> is present,</p>

                </li>

            </ul>

            <p class="p">Then, the 5G Nchf request is treated as offline charging.</p>

            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> 
                <ul class="ul" id="offline_rating_group__ul_fn2_mcg_znb">
                    <li class="li">
                        <p class="p">When the rating group value in a Gy or Nchf call request matches the
                            configured offline rating group value in a rule, then a Gy session is
                            created in the database; but no rating session is created in the
                            database as rating logic is not processed for offline charging.</p>

                    </li>

                    <li class="li">
                        <p class="p">If a rating group value does not match with the configured offline rating
                            group value in rule, then the Gy (data or PS) request is processed as
                            online charging.</p>

                        <p class="p">For a 5G Nchf request, if a rating group value does not match with the
                            configured offline rating group value in rule, and if either the
                                <em class="ph i">quotaManagementIndicator</em> attribute value for that muu is
                                <var class="keyword varname">ONLINE_CHARGING</var> or uuc is not present, then the
                            5G Nchf request is treated as online charging.</p>

                    </li>

                    <li class="li">
                        <p class="p">If a Gy (data or PS) call comes with <em class="ph i">Service-Identifier</em> and
                            without a rating group, then this request is processed as online
                            charging and a rating session is created.</p>

                    </li>

                    <li class="li">
                        <p class="p">A Gy (data or PS) call and 5G Nchf request can be processed as offline,
                            online, or both, which is termed as mixed charging.</p>

                    </li>

                    <li class="li">
                        <p class="p">The offline MSCCs or MUUs are not rejected for barred device.</p>

                    </li>

                    <li class="li">
                        <p class="p">In a mixed or offline (MSCC or MUU) charging, if there is even a single
                            offline success MSCC or MUU present in response, then command level
                            result code is <span class="keyword cmdname">SUCCESS</span>.</p>

                    </li>

                </ul>

            </div>

        </div>

        <div class="section" id="offline_rating_group__section_t5b_hcw_xnb"><h2 class="title sectiontitle">Configuring this feature</h2>
            
            <p class="p">To configure the offline rating group feature that allows specific rating groups
                without counting usage for access barred devices,create the following rule in the
                    <em class="ph i">GY_CREDIT_REQUEST</em>:</p>

            <p class="p"><kbd class="ph userinput">SESSION_PARAMETERS.Offline-Rating-Group = [100, 200, 300, 400,
                    500]</kbd></p>

            <p class="p">where <kbd class="ph userinput">100</kbd>, <kbd class="ph userinput">200</kbd>,
                    <kbd class="ph userinput">300</kbd>, <kbd class="ph userinput">400</kbd>, and
                    <kbd class="ph userinput">500</kbd> are the values for rating group of MSCC. Similarly,
                you can configure the desired values for your rating group that must be considered
                as offline rating group:</p>

            <img class="image break" id="offline_rating_group__image_m4y_lbw_xnb" src="../images/offline_rating_group.png" height="195" width="597" />
            <p class="p">Following table provides details on <strong class="ph b">Offline-Rating-Group</strong> parameter:</p>

            <table cellpadding="4" cellspacing="0" summary="" id="offline_rating_group__table_alm_qbw_xnb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Offline-Rating-Group parameter</span></caption><colgroup><col style="width:35.587188612099645%" /><col style="width:64.41281138790036%" /></colgroup><thead class="thead" style="text-align:left;">
                        <tr class="row">
                            <th class="entry cellrowborder" style="vertical-align:top;" id="d163068e180">Action parameter</th>

                            <th class="entry cellrowborder" style="vertical-align:top;" id="d163068e183">Value</th>

                        </tr>

                    </thead>
<tbody class="tbody">
                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e180 ">Name</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e183 ">Offline-Rating-Group</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e180 ">Value Type</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e183 ">BaseValueType</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e180 ">Allow Multiple Values</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e183 ">Multiple values are allowed separated by (,) comma</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e180 ">Occurrence</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e183 ">Single</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e180 ">Result Context</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e183 ">SESSION_PARAMETERS</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e180 ">Rule Set</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e183 ">GY_CREDIT_REQUEST</td>

                        </tr>

                    </tbody>
</table>

            
            <div class="sectiondiv">
                <p class="p"><strong class="ph b">Configuring VT/QHT/VQT/GSU for 4G/5G offline charging</strong></p>

                <ol class="ol" id="offline_rating_group__ol_khg_2fw_xnb">
                    <li class="li">
                        <p class="p">Validation on VT and QHT will be same as for online charging. For
                            example, if a rule in the quota management (slicing profile) is
                            configured without VT, then the rule is considered as invalid and rule's
                            values are not considered; therefore, the default values are
                            considered.</p>

                    </li>

                    <li class="li">
                        <p class="p">GSU and VQT values are populated according to the following formula:</p>

                        <p class="p">Let us consider that the quota management (slicing profile) is
                            configured with <em class="ph i">Slice-Size</em> = <var class="keyword varname">200</var> and
                                <em class="ph i">Volume-Quota-Threshold</em> = <var class="keyword varname">50</var>, then the GSU
                            or VQT values are sent in CCA based on the VQT type configuration as
                            follows:</p>

                        <ol class="ol" type="a" id="offline_rating_group__ol_mpk_4fw_xnb">
                            <li class="li">If VQT type is configured as <strong class="ph b">FIXED_ADD_GSU</strong>, then the
                                following GSU/VQT values are sent in CCA:<p class="p"><kbd class="ph userinput">GSU = 250
                                        (slice size + VQT value)</kbd></p>
<p class="p"><kbd class="ph userinput">VQT =
                                        50 (VQT value configured in slicing
                                profile)</kbd></p>
</li>

                            <li class="li">If VQT type is configured as <strong class="ph b">PERCENTAGE</strong> or not configured,
                                then the following GSU/VQT values are sent in CCA:<p class="p"><kbd class="ph userinput">GSU
                                        = 200 (slice size)</kbd></p>
<p class="p"><kbd class="ph userinput">VQT = 100
                                        (VQT % of slice size)</kbd></p>
If VQT value is greater
                                than 100, then GSU will be 100% of slice size.</li>

                        </ol>

                    </li>

                    <li class="li">Service unit type is to be set as default value
                            <var class="keyword varname">CC-Total-Octets</var> in GSU irrespective of any type
                        coming in the request.</li>

                    <li class="li">The following <strong class="ph b">Is-Offline</strong> attribute checks whether the MSCC is offline
                        or not.<table cellpadding="4" cellspacing="0" summary="" id="offline_rating_group__table_arj_l5x_xnb" class="table" frame="border" border="1" rules="all"><colgroup><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /></colgroup><thead class="thead" style="text-align:left;">
                                    <tr class="row">
                                        <th class="entry cellrowborder" style="vertical-align:top;" id="d163068e336">Attribute name</th>

                                        <th class="entry cellrowborder" style="vertical-align:top;" id="d163068e339">Source context</th>

                                        <th class="entry cellrowborder" style="vertical-align:top;" id="d163068e342">Rule set</th>

                                    </tr>

                                </thead>
<tbody class="tbody">
                                    <tr class="row">
                                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e336 ">Multiple-Services-Credit-Control.Is-Offline</td>

                                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e339 ">GY_MESSAGE</td>

                                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e342 ">SLICING_PROFILE</td>

                                    </tr>

                                    <tr class="row">
                                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e336 ">MUU.Is-Offline</td>

                                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e339 ">NCHF_CHARGING_MESSAGE</td>

                                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d163068e342 ">SLICING_PROFILE</td>

                                    </tr>

                                </tbody>
</table>
</li>

                    <li class="li">
                        <p class="p">The following source contexts are considered to evaluate rules in the
                            quota management (slicing profile) in case of offline
                            charging:</p>

                        <ul class="ul" id="offline_rating_group__ul_ssy_q5x_xnb">
                            <li class="li"><em class="ph i">NCHF_CHARGING_MESSAGE</em></li>

                            <li class="li"><em class="ph i">SPR_DEVICE</em></li>

                            <li class="li"><em class="ph i">SPR_GROUP</em></li>

                            <li class="li"><em class="ph i">GY_MESSAGE</em></li>

                        </ul>

                    </li>

                    <li class="li">
                        <p class="p">Only one group is supported for the <em class="ph i">SPR_GROUP</em> source context. If
                            the device is attached to multiple groups, then the first group is
                            fetched from the list. The first group fetched is considered for the
                                <em class="ph i">SPR_GROUP</em> source context and other groups are ignored.</p>

                    </li>

                </ol>

            </div>
        </div>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>