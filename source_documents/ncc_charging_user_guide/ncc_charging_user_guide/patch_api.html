<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Patch APIs to modify Account BCR date" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="patch_api" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Patch APIs to modify Account BCR date</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="patch_api">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Patch APIs to modify Account BCR date</h1>
<div class="body conbody">
        <div class="section" id="patch_api__section_r2v_wbq_vnb">
            <p class="p">The Account's BCR can be changed by setting the <strong class="ph b">updateTransition</strong> parameter to
                    <var class="keyword varname">true</var> in the patch API and sending the billing information in
                the API request. This feature is only applicable for patch API. Following are the
                cases of BCR:</p>

            <ul class="ul" id="patch_api__ul_tly_zcq_vnb">
                <li class="li"><strong class="ph b">Immediate BCR</strong>: The account's BCR is immediately changed and the next BCR
                    occurs on the scheduled time that is sent in the billing information in API
                    request. All the subscriptions aligned to the Account's BCR date (that is,
                    subscription without its own periodic lifecycle) renews/expires on the new BCR
                    date.</li>

                <li class="li"><strong class="ph b">Future BCR</strong>: The account's BCR is changed to a future date. The billing
                    information is updated and no action is taken since the next BCR date does not
                    change. The same behaviour happens when Account billing information is modified
                    with updateTransition parameter as false.</li>

            </ul>

            <div class="sectiondiv"><strong class="ph b">Immediate BCR</strong><div class="p">NCC performs the following tasks when the BCR is set
                    to <strong class="ph b">Immediate BCR</strong>.<ul class="ul" id="patch_api__ul_z24_5rw_vnb">
                        <li class="li">Updates the Account's billing information and Account's endTime.</li>

                        <li class="li">Deletes the old scheduled transition entry (from TEM) and schedules a
                            new transition as per the new endTime of Account.</li>

                        <li class="li">Sends the <strong class="ph b">Re-authorization request</strong> for all data sessions
                            associated with the Account to assure that the VT alignment is correct
                            based on the new BCR date.</li>

                        <li class="li">Processes the <strong class="ph b">Refund Fee</strong>. If a subscription has prorate
                            configuration, then the prorate calculation is done as per the new BCR
                            date and refund is processed. </li>

                        <li class="li">Checks for the renewal mode of subscription. The following points
                            provide details on the value of renewal mode with different
                                configuration:<ol class="ol" id="patch_api__ul_wkd_xsw_vnb">
                                <li class="li">If a Subscription has it's own PLC with action
                                        <strong class="ph b">RenewSubscriptionAction</strong>, the Renewal Mode = ALL.</li>

                                <li class="li">If a Subscription has it's own PLC with
                                        <strong class="ph b">ResetSubscriptionAction</strong>, the Renewal Mode =
                                    RESET.</li>

                                <li class="li">If a Subscription has it's billing cycle, the Renewal Mode =
                                    BILLING_ONLY. If BundleActivationType = ON_SESSION, the Renewal
                                    Mode = BILLING_ONLY.</li>

                                <li class="li">In all other cases, the Renewal Mode = NONE.</li>

                            </ol>
</li>

                    </ul>
</div>
<p class="p">The fee is refunded only in case 2 (PLC with
                        <strong class="ph b">ResetSubscriptionAction</strong>), case 3 (BundleActivationType = ON_SESSION),
                    and case 4 (no PLC).</p>
<div class="sectiondiv"><strong class="ph b">Example: Immediate BCR </strong><p class="p">Consider
                        that the Account A1 has following billing information:</p>
<ul class="ul" id="patch_api__ul_ad5_fcx_vnb">
                        <li class="li">Day Of Month = 25</li>

                        <li class="li">Day Of Week = SUNDAY</li>

                        <li class="li">Hour Of Day = 0</li>

                        <li class="li">Account Start Time = Oct 1, 2020 11:00 AM IST</li>

                        <li class="li">Account End Time = Oct 25, 2020 12:00 AM IST</li>

                    </ul>
Here, the Account A1 BCR time is Oct 25, 2020 12:00 AM IST.<div class="p">The patch API
                        to update the billing information of Account is triggered on 05-10-2020 with
                        the following billing information parameters:<ul class="ul" id="patch_api__ul_xlv_4cx_vnb">
                            <li class="li">Day Of Month = 20</li>

                            <li class="li">Day Of Week = SUNDAY</li>

                            <li class="li">Hour Of Day = 0</li>

                            <li class="li">updateTransition = true</li>

                        </ul>
</div>
<p class="p">The requestedEndTime &lt; configuredEndTime [20-10-2020 &lt;
                        25-10-2020]. In this case of Immediate BCR, NCC performs the following
                        tasks:</p>
<ul class="ul" id="patch_api__ul_qlc_5cx_vnb">
                        <li class="li">Updates the Account's billing information and Account's endTime.</li>

                        <li class="li">Deletes the old scheduled transition entry (from TEM) and schedules a
                            new transition as per new endTime of Account.</li>

                    </ul>
</div></div>
            <div class="sectiondiv"><strong class="ph b">Future BCR date changes</strong><p class="p">NCC performs the following logic when the
                    BCR is set to <strong class="ph b">Future BCR</strong>:</p>
<ul class="ul" id="patch_api__ul_rjt_zvx_vnb">
                    <li class="li">No action is taken for future BCR date and billing information is updated. </li>

                    <li class="li">For the next BCR date, the Account and all the subscriptions linked to the
                        Account's BCR date are modified to align with the new BCR date. </li>

                    <li class="li">The Account uses the new BCR date going forward.</li>

                    <li class="li">If the patch API request has only billing information (Day Of Month, Day Of
                        Week, Hour Of Day) with <strong class="ph b">updateTransition</strong> parameter set to true, RAR
                        is not triggered.<div class="note" id="patch_api__note_izc_ggs_jvb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Default value of
                                <strong class="ph b">updateTransition</strong> is true.</div>
</li>

                    <li class="li">If the patch API request has billing information along with other parameters
                        such as Overage-Limit, Time-Zone, <strong class="ph b">updateTransition</strong> parameter set to
                        true, RAR is triggered. </li>

                </ul>
</div>
            <div class="sectiondiv"><strong class="ph b">Example: Future BCR </strong><p class="p">Consider that the Account A1 has following
                    billing information:</p>
<ul class="ul" id="patch_api__ul_jd2_qwx_vnb">
                    <li class="li">Day Of Month = 25</li>

                    <li class="li">Day Of Week = SUNDAY</li>

                    <li class="li">Hour Of Day = 0</li>

                    <li class="li">Account Start Time = Oct 1, 2020 11:00 AM IST</li>

                    <li class="li">Account End Time = Oct 25, 2020 12:00 AM IST</li>

                </ul>
Here, the Account A1 BCR time is Oct 25, 2020 12:00 AM IST.<div class="p">The patch API to
                    update the billing information of Account is triggered on 05-10-2020 with the
                    following billing information parameters:<ul class="ul" id="patch_api__ul_ld2_qwx_vnb">
                        <li class="li">Day Of Month = 28</li>

                        <li class="li">Day Of Week = SUNDAY</li>

                        <li class="li">Hour Of Day = 0</li>

                        <li class="li">updateTransition = true</li>

                    </ul>
The requestedEndTime &lt; configuredEndTime [28-10-2020 &lt; 25-10-2020] is
                    false, this is the case of Future BCR. Here, the Account's billing information
                    is updated by Patch API code.</div>
</div>
            <div class="sectiondiv"><strong class="ph b">Additional information related to Immediate and Future BCR </strong><p class="p">While
                    using the <strong class="ph b">Profile Patch</strong> and <strong class="ph b">Account Patch</strong> API to update the
                    Account's billing information, the granularity factor is considered based on the
                    periodicity of lifecycle associated with the Account entity. For example, if the
                    periodicity is Monthly, then granularity is atleast one day.</p>
<p class="p">Consider a
                    scenario where the Account has the monthly periodicity, billing information is
                    as follows:</p>
<ul class="ul" id="patch_api__ul_gjj_pff_wnb">
                    <li class="li">DayOfMonth = 29</li>

                    <li class="li">DayOfWeek = TUESDAY</li>

                    <li class="li">HourOfDay = 0</li>

                </ul>
Operator wants to update the billing cycle to 29-Nov-2020 and passes the
                following billing parameters in the <strong class="ph b">Profile Patch</strong> or <strong class="ph b">Account Patch</strong> API
                on 29-Nov-2020 10:00:00 AM.<ul class="ul" id="patch_api__ul_ibp_xvk_wnb">
                    <li class="li">DayOfMonth = 29</li>

                    <li class="li">DayOfWeek = TUESDAY</li>

                    <li class="li">HourOfDay = 0</li>

                    <li class="li">updateTransition = true</li>

                </ul>
The resultant date is 30-Dec-2020. This is because, the request is sent on
                29-Nov-2020 10:00:00 AM to update the end time to 29-Nov-2020 00:00:00, which is not
                possible since 29-Nov-2020 00:00:00 is already passed. Hence, to update the end date
                to 29-Nov-2020, operator must update the <strong class="ph b">HourOfDay</strong> parameter to 23, instead
                of 0. The new time is calcualted as 29-Nov-2020 23:00 PM IST. <div class="p">For refund fee, if
                    the new BCR date is set to 29-Dec-2020, which is a future date, then no fee is
                    refunded. Fee is refunded only in case of Immediate BCR. For the case where the
                        <strong class="ph b">HourOfDay</strong> parameter is set to 23, the BCR date is 29-Nov-2020, then
                    the refund happens based on the granularity set as follows:<ul class="ul" id="patch_api__ul_kzw_pwk_wnb">
                        <li class="li">Granularity level is set to Default or Days, then no fee is
                            refunded.</li>

                        <li class="li">Granularity level is set to HOURS, then fee is refunded.</li>

                    </ul>
The Granularity level can be set in the Bundle entity as shown in the
                    following figure:<img class="image break" id="patch_api__image_vbv_wwk_wnb" src="../images/prorate.png" /></div>
</div>
        </div>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>