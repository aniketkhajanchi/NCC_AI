<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="NCC architecture" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="id9yz-09126-ug01-pczza-sp1-d1e1261" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>NCC architecture</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="id9yz-09126-ug01-pczza-sp1-d1e1261">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">NCC architecture</h1>
<div class="body conbody">
    <p class="p">NCC is composed of several modules that interact with each other to offer the following
      functionalities:</p>

    <ul class="ul" id="id9yz-09126-ug01-pczza-sp1-d1e1261__ul_xzz_p1j_z5b">
      <li class="li">
        <p class="p">Performs subscriber rating and charging.</p>

      </li>

      <li class="li">
        <p class="p">Enables operators to control their offers and interactions with subscribers.</p>

      </li>

      <li class="li">
        <p class="p">Addresses the data market.</p>

      </li>

      <li class="li">
        <p class="p">Performs the role of an Online Charging Function (OCF).</p>

      </li>

    </ul>

    <p class="p">The Ro and Gy Diameter interfaces are used as native interfaces for charging and rating a
      session-based or event-based charging service.</p>

    <p class="p">The Operations, Administration, and Maintenance (OA&amp;M) module of NCC is responsible for
      file retrieval and generation of alarms in case of error events whereas the Input/Output
      handler (I/O) handles the incoming and outgoing traffic.</p>

    <div class="fig fignone" id="id9yz-09126-ug01-pczza-sp1-d1e1261__fig_yzz_p1j_z5b"><span class="figcap"><span class="fig--title-label">Figure: </span>NCC architecture</span>
      
      <img class="image break" id="id9yz-09126-ug01-pczza-sp1-d1e1261__image_zzz_p1j_z5b" src="../images/img9yz-09126-ug01-pczza-sp1-charging_architecture_default.png" />
    </div>

    <p class="p">Following are the major functions of each component in NCC:</p>

    <ul class="ul" id="id9yz-09126-ug01-pczza-sp1-d1e1261__ul_a11_q1j_z5b">
      <li class="li">
        <p class="p">
          <span class="ph uicontrol">Call controller:</span> This module encodes and decodes the Diameter
          Credit-Control-Request (CCR) or Credit-Control-Answer (CCA) messages. This module
          interfaces with the rating engine for context generation and rating response processing. </p>

        <p class="p">Following are the sub-modules of the call controller:</p>

        <ul class="ul" id="id9yz-09126-ug01-pczza-sp1-d1e1261__ul_b11_q1j_z5b">
          <li class="li">
            <p class="p">
              <span class="ph uicontrol">Protocol specific controller:</span> This module is responsible for
              external protocols, such as Diameter protocol, Hyper Text Transfer Protocol (HTTP),
              File Transfer Protocol (FTP), and Simple Object Access Protocol (SOAP).</p>

          </li>

          <li class="li">
            <p class="p">
              <span class="ph uicontrol">Common call controller:</span> The call controller module contains the
              logic to be executed when an incoming Diameter request is received. It interacts with
              the other modules of NCC during the processing of a received request. It supports
              CCR/CCA, RAR/RAA messages over Gy interface, and SLR/SLA, SNR/SNA messages over Sy
              interface.</p>

          </li>

        </ul>

      </li>

      <li class="li">
        <p class="p">
          <span class="ph uicontrol">Subscriber model:</span> The subscriber model is responsible for managing
          (lookup or update) the subscriber related information in the NCC database.</p>

      </li>

      <li class="li">
        <p class="p">
          <span class="ph uicontrol">Service model:</span> The service model is responsible for managing the
          charging and rating entities in the NCC database like bundles, tariffs and buckets.</p>

      </li>

      <li class="li">
        <p class="p">
          <span class="ph uicontrol">Session management:</span> The session management module is responsible
          for creating, updating and deleting the call sessions from memory.</p>

      </li>

      <li class="li">
        <p class="p">
          <span class="ph uicontrol">Charging and rating engine:</span> The charging and rating engine module
          is responsible for selecting a charging service (from the set of defined charging services
          in the system) and to rate and charge the call according to the definition of the selected
          charging service.</p>

      </li>

      <li class="li">
        <p class="p">
          <span class="ph uicontrol">Charging Data Record (CDR) generation framework:</span> This module is
          responsible for providing framework for generating application CDR in Abstract Syntax
          Notation (ASN) format.</p>

      </li>

    </ul>

<div class="section"><h2 class="title sectiontitle">Interaction between NCC modules during a call </h2>
<div class="fig fignone"><span class="figcap"><span class="fig--title-label">Figure: </span>Call flow showing the interaction between
                                                  NCC modules</span>
                                                  
                                                  <img class="image break" src="../images/img9yz-09126-ug01-pczza-sp1-call_flow_default.png" />
                                                </div>

<p class="p">Following steps describe how the charging modules interact with each other for a call received by
                NCC: </p>
<ol class="ol">
<li class="li">
<p class="p">When a Diameter call is initiated by the Diameter client, a Credit-Control-Request initial (CCR-I) message is sent to the call controller module, which encodes or decodes the Diameter CCR message and performs the message validation.</p>

</li>

<li class="li">
<p class="p">The call controller sends a request to the subscriber model to fetch the subscriber details. In response, the subscriber model sends the requested information to the call controller.</p>

</li>

<li class="li">
<p class="p">The call controller sends a request to the session manager to build a Call-Control (CC) session.</p>

</li>

<li class="li">
<p class="p">After the CC session is established, the call controller requests the rule engine to apply call control rules to identify the call type, call sub-type, and so on at call control level.</p>

</li>

<li class="li">
<p class="p">Once the call validation and subscriber lookup is completed, the call controller sends a charging request to the charging and rating engine.</p>

</li>

<li class="li">
<p class="p">The rating engine interacts with the service model to fetch the subscription details of the device.</p>

</li>

<li class="li">
<p class="p">After fetching the subscription details of the device, the charging and rating engine executes rules for applicability conditions, which means different rules are applied for different conditions. For example, if it is roaming call, then a different tariff is applied for charging. </p>

</li>

<li class="li">
<p class="p">The charging and rating engine then builds a rating session in the session manager itself. </p>

</li>

<li class="li">
<p class="p">Once all reservations are successfully completed, the charging and rating engine sends a charging response to the call controller module.</p>

</li>

<li class="li">
<p class="p">The call controller updates the CC session with the session details fetched from the session manager.</p>

</li>

<li class="li">
<p class="p">After updating the session, the call controller triggers the lifecycle manager to trigger lifecycle events.</p>

</li>

<li class="li">
<p class="p">The lifecycle manager sends a notification to the notification server. The notification server sends an acknowledgment to the Diameter client (PGW) to terminate the call.</p>

</li>

<li class="li">
<p class="p">The lifecycle manager informs the call controller that all the operations associated with the received event are executed.</p>

</li>

<li class="li">
<p class="p">The call controller sends a CCA message to the Diameter client. This message contains the Diameter result code.</p>

</li>

</ol>

</div>

</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>