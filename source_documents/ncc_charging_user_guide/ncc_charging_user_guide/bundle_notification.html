<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Notification when bundle expires but buckets are available" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="bundle_notification" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Notification when bundle expires but buckets are available</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="bundle_notification">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Notification when bundle expires but buckets are available</h1>
<div class="body conbody">
        <p class="p">Notifications can be sent when a subscription expires (end date or validation date
            expires) and the buckets of that bundle subscription have not been completely consumed.
            For example, consider that a subscription has 5 buckets, 4 are empty and 1 is non-empty.
            When the subscription expires or renews, a notification can be sent to subscriber to
            indicate that the subscription is not empty. This functionality is supported for
            Subscription lifecycle only. </p>

        <p class="p">If the following rules are configured on an Account lifecycle, then they are always
            evaluated to <var class="keyword varname">False</var>. </p>

        <p class="p">The following functions provides capability to get the current balance of the buckets
            including and excluding the carry over balance for the subscription before and after
            renewal. </p>

        <p class="p"><strong class="ph b">Has-Previous-Non-Empty-Buckets</strong>: This function is used in lifecycle rule and
            returns true if the subscription contains at least one bucket of its charging services
            that is not fully consumed before renewal or expiration.</p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_tsm_4hd_tmb" src="../images/has_previous.png" />
        </div>

        <p class="p"><strong class="ph b">Has-Non-Empty-Buckets</strong>: This function is used in lifecycle rule and returns true if
            the subscription contains at least one bucket of its charging services that is not fully
            consumed after renewal or starting cycle.</p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_ngq_x3d_tmb" src="../images/has_non_empty.png" />
        </div>

        <p class="p"><strong class="ph b">Get-Previous-Bucket-Total-Value-By-Name</strong>: This function returns the balance value
            of the bucket based on its passed name. It returns the balance including the carry over
            balance before the subscription is renewed or expired. </p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_cj3_3jd_tmb" src="../images/get_previous_bucket.png" height="142" width="416" />
        </div>

        <p class="p"><strong class="ph b">Get-Bucket-Total-Value-By-Name</strong>: This function returns the balance value of the
            bucket based on its passed name. It returns the balance including the carry over
            balance.</p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_ovg_xqd_tmb" src="../images/get_total_value_by_name.png" />
        </div>

        <p class="p"><strong class="ph b">Get-Previous-Bucket-Value-By-Name</strong>: This function returns the regular bucket
            balance based on passed bucket name without carry over balance.</p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_jjs_3sd_tmb" src="../images/get_previous_bucket_name_without_carryover.png" />
        </div>

        <p class="p"><strong class="ph b">Get-Bucket-Value-By-Name</strong>: This function returns the regular bucket balance based
            on passed bucket name without carry over balance.</p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_yn5_gtd_tmb" src="../images/get_bucket_name_without_carryover.png" />
        </div>

        <p class="p"><strong class="ph b">Get-Previous-Bucket-Total-Value-By-Type</strong>: This function returns the balance value
            of the bucket based on its passed type (KindOfUnit). It returns the balance including
            the carry over balance before renewal or expiration.</p>

        <p class="p">Following are the available bucket types (KindOfUnit):</p>

        <ul class="ul" id="bundle_notification__ul_xq2_sjd_tmb">
            <li class="li">TIME</li>

            <li class="li">VOLUME</li>

            <li class="li">UNIT</li>

            <li class="li">MONEY</li>

        </ul>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <img class="image break" id="bundle_notification__image_lf3_1kd_tmb" src="../images/get_previous_bucket_by_type.png" />
        <p class="p"><strong class="ph b">Get-Bucket-Total-Value-By-Type</strong>: This function returns the balance value of the
            bucket based on its passed type. It returns the balance including the carry over
            balance.</p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_lfp_3rd_tmb" src="../images/get_bucket_total_type.png" />
        </div>

        <p class="p"><strong class="ph b">Get-Previous-Bucket-Value-By-Type</strong>: This function returns the regular bucket
            balance based on passed KindOfUnit without carry over balance for previous
            subscription.</p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_kxs_5rd_tmb" src="../images/get_previous_bucket_type_without_carryover.png" />
        </div>

        <p class="p"><strong class="ph b">Get-Bucket-Value-By-Type</strong>: This function returns the regular bucket balance based
            on passed bucket type without carry over balance.</p>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <div class="p">
            <img class="image break" id="bundle_notification__image_gk1_ssd_tmb" src="../images/get_bucket_value_by_type_without_carryover.png" />
        </div>

        <p class="p">Following are some of the sample scenarios listed to understand when notifications can be
            sent:</p>

        <ul class="ul" id="bundle_notification__ul_obp_kmm_5mb">
            <li class="li">
                <p class="p">00:00 time and BOU bundle expires today but any of the bucket is not zero,
                    notification is sent in this case.</p>

            </li>

            <li class="li">
                <p class="p">00:00 time and BOU bundle expires today and all the buckets are consumed,
                    notification is not sent in this case.</p>

            </li>

            <li class="li">
                <p class="p">02:25 time and Bundle renews today and all the buckets are consumed, notification
                    is not sent in this case.</p>

            </li>

            <li class="li">
                <p class="p">00:00 time and Bundle renews today, and any of the bucket is not zero and is &gt;=
                    certain value, notification is sent in this case.</p>

            </li>

            <li class="li">
                <p class="p">At time of Bundle renewal, bucket 1 of type money is empty and bucket 2 of type
                    volume is non empty, the notification is sent.</p>

            </li>

        </ul>

        <p class="p"><strong class="ph b">Reading data from Subscription, Device, and Group</strong></p>

        <p class="p">NCC allows operators to get the required data per request and send them to notification
            template.</p>

        <p class="p">Following are the values that can be read:</p>

        <ul class="ul" id="bundle_notification__ul_sq4_std_tmb">
            <li class="li">MSISDN (E164)</li>

            <li class="li">IMSI</li>

            <li class="li">Group-Id</li>

            <li class="li">Device-Id</li>

            <li class="li">Bundle-Id</li>

            <li class="li">Custom data from Device and Group (for example, Mother Name)</li>

        </ul>

        <p class="p"><strong class="ph b">Example:</strong></p>

        <img class="image break" id="bundle_notification__image_ubz_f5d_tmb" src="../images/reading_data.png" />
    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>