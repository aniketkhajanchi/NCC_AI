<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Versioning" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="versioning" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Versioning</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="versioning">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Versioning</h1>
<div class="body conbody">
        <p class="p">Operators can enable versioning using the following parameters:</p>

        <ul class="ul" id="versioning__ul_nvn_jbs_4wb">
            <li class="li">SM preference: <strong class="ph b">Entity Versioning Enabled</strong>. Once enabled, it cannot be disabled
                as it has adverse effect on backward compatibility.</li>

            <li class="li">ME application preference: <strong class="ph b">Versioning Enabled</strong></li>

        </ul>

        <div class="p">If versioning for discounts is enabled, and the current discount is used in the device
            subscription, then consider the following points:<ul class="ul" id="versioning__ul_s5w_bxm_rwb">
                <li class="li">If the discount version protect is set to <em class="ph i">NOT_PROTECTED</em>, and there is
                    another version of the current discount, then it is used for the new
                    subscription immediately or at Next Account BCR.</li>

                <li class="li">If the discount version protect is set to <em class="ph i">PURCHASE_DATE</em>, and there is a
                    new version of the bundle, then it is not considered after renewal immediately
                    or at Next BCR.</li>

            </ul>
</div>

        <div class="p">All the discount parameters can be updated while creating a new version, except the
            following parameters:<ul class="ul" id="versioning__ul_mjl_lgn_rwb">
                <li class="li">Discount name: Discount name parameter cannot be updated for instances. If
                    discount name parameter is updated in the API, then it is considered as new
                    definition of discount associated to same bundle. Updating the name parameter in
                    the Discount entity in the GUI is also not allowed.</li>

                <li class="li">Description parameter can be updated only for definition and not for
                    instances.</li>

            </ul>
</div>

        <p class="p">When versioning is enabled, and you make a change, a new draft copy (minor) version is
            created (for example, 1.1), which can be published as new major version (for example,
            2.0).</p>

        <p class="p">When versioning is enabled in discount definition, a discount can be created or modified
            only for active and test active bundles (services)</p>

        <p class="p">The API users can continue using APIs without specifying the exact version numbers (minor
            or major). </p>

        <p class="p">NCC uses the following approach to provision, unprovision, or delete a versioned
            entity:</p>

        <table cellpadding="4" cellspacing="0" summary="" id="versioning__table_gjh_lq4_rwb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Provisioning/unprovisioning/deleting a versioned entity without specifying
                version number</span></caption><colgroup><col style="width:23.475046210720887%" /><col style="width:18.484288354898336%" /><col style="width:58.04066543438078%" /></colgroup><thead class="thead" style="text-align:left;">
                    <tr class="row">
                        <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e100">Action</th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e103">Behavior</th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e106">APIs</th>

                    </tr>

                </thead>
<tbody class="tbody">
                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e100 "><strong class="ph b">Provision</strong> a versioned entity without specifying the exact
                            version number in the request</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e103 ">The highest draft version is picked. The withdrawn versions are also
                            considered as drafts. This behavior is same for provisioning as active
                            and test-active. </td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e106 ">
                            <ul class="ul" id="versioning__ul_lw1_5gp_pwb">
                                <li class="li"><em class="ph i">services/ServiceManager/provision/Bundle</em></li>

                                <li class="li"><em class="ph i">services/ServiceManager/testProvision/Bundle</em></li>

                                <li class="li"><em class="ph i">services/ServiceManager/publish/Bundle</em></li>

                                <li class="li"><em class="ph i">services/ServiceManager/testPublish/Bundle</em></li>

                            </ul>

                        </td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e100 "><strong class="ph b">Unprovision</strong> a versioned entity without specifying the exact
                            version number in the request</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e103 ">The highest version among the active and test-active versions is
                            picked. </td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e106 "><em class="ph i">services/ServiceManager/withdraw/Bundle</em></td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e100 "><strong class="ph b">Delete</strong> a versioned entity without specifying the exact version
                            number in the request</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e103 ">The highest draft version is deleted. If the highest version is
                            Active, an exception is thrown. </td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e106 "> </td>

                    </tr>

                </tbody>
</table>

        <div class="p">Pre-requisites applicable for following scenarios:<ul class="ul" id="versioning__ul_b2x_lq4_rwb">
                <li class="li">The versioning flags must be enabled.</li>

                <li class="li"><strong class="ph b">Protect</strong> value is considered for the version change.</li>

                <li class="li">PLC change is not applicable for discount.</li>

            </ul>
</div>

        <table cellpadding="4" cellspacing="0" summary="" id="versioning__table_grk_nj4_bub" class="table" width="100%" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Scenarios</span></caption><colgroup><col style="width:8.873114463176575%" /><col style="width:38.5980479148181%" /><col style="width:28.926353149955634%" /><col style="width:23.602484472049692%" /></colgroup><thead class="thead" style="text-align:left;">
                    <tr class="row">
                        <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e212">No</th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e215">Scenario</th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e218">Behavior</th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e221">Configuration</th>

                    </tr>

                </thead>
<tbody class="tbody">
                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e212 ">1</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e215 ">Create a new version of Discount, then wait for next Account BCR (In
                            case of non-protected version with renewal on the next period).</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e218 ">The new version of the discount contains the updated values.<div class="note" id="versioning__note_dhz_hs4_rwb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Discount definition is updated when the new
                                version of discount is published.</div>
</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e221 ">Create a discount version 1 with override fee =10, discounted renewal
                            periods = 30, version protect type = NOT_PROTECTED, version type =
                                NEXT_BCR.<p class="p">Use the API to create discount version 2 with override
                                fee=5, discounted renewal periods=40. </p>
<p class="p">Wait for next account
                                BCR.</p>
<p class="p">After BCR, the new values of discount instance are the
                                new values in the new version.</p>
</td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e212 ">2</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e215 ">Create a new version of protected Discount, and provision it on the
                            subscriber profile.</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e218 ">The discount definition is updated with the new values in the new
                            version of the discount.<p class="p">Active discount instances are not updated
                                upon creation of the new discount version.</p>
</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e221 ">Create a Discount with Protected version, and provision it on the
                            subscriber profile.<div class="p">For creating discount with protected version
                                settings, add the following block in the request
                                body:<pre class="pre codeblock" id="versioning__codeblock_hjh_lq4_rwb"><code>"versionSettings": {
    "versionProtectType": "PURCHASE_DATE"
},</code></pre></div>
</td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e212 ">3</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e215 ">Create a new version of Discount, then wait for Credit control
                            request (CCR) on the device that is associated with the discount.<div class="note" id="versioning__note_znb_xt4_rwb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> On CCR, the versioning is done only if the
                                subscription's version type is IMMEDIATE.</div>
</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e218 ">The new version of the discount contains the updated values.<div class="note" id="versioning__note_jzf_nt4_rwb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Discount definition is updated when the new
                                version of discount is published.</div>
<div class="note" id="versioning__note_zdw_zt4_rwb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Discount instance is updated upon receiving the Credit control
                                request (CCR).  </div>
</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e221 ">Create a discount version 1 with override fee =10, discounted renewal
                            periods = 30, version protect type = NOT_PROTECTED, version type =
                                IMMEDIATE.<p class="p">Use the API to create discount version 2 with override
                                fee=5, discounted renewal periods=40. </p>
<p class="p">The updated values of
                                the discount instance are the new values in the new
                            version.</p>
</td>

                    </tr>

                </tbody>
</table>

        <div class="section" id="versioning__section_b24_rbp_rwb"><h2 class="title sectiontitle">Calculating remaining discounted periods for the new discount versions</h2>
            
            <p class="p">To change the number of periods for the <em class="ph i">NOT_PROTECTED</em> version protect type,
                the behavior described in the following table is applicable:</p>

            <p class="p">To calculate the remaining discounted periods for the active discount instances, the
                following formula is applicable:<code class="ph codeph">remaining_discounted_periods =
                    remaining_discounted_periods (previous version discount instance) + new
                    verison(Number of discounted periods of definition) - previous version(Number of
                    discounted periods from discount instance )</code></p>

            <table cellpadding="4" cellspacing="0" summary="" id="versioning__table_lyx_xw4_rwb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Calculating remaining discounted periods for the new discount
                    versions</span></caption><colgroup><col style="width:8.992805755395684%" /><col style="width:20.503597122302157%" /><col style="width:70.50359712230217%" /></colgroup><thead class="thead" style="text-align:left;">
                        <tr class="row">
                            <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e335">No</th>

                            <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e338">If number of discounted periods in new version is..</th>

                            <th class="entry cellrowborder" style="vertical-align:top;" id="d422028e341">Behavior</th>

                        </tr>

                    </thead>
<tbody class="tbody">
                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e335 ">1</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e338 ">Greater than the previous version of discounted periods.</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e341 ">
                                <p class="p">Discount periods (discount instance of the previous version) =
                                    10</p>

                                <p class="p">Remaining discounted periods (discount instance of the previous
                                    version) = 9</p>

                                <p class="p">New version (Discount definition) = 15</p>

                                <p class="p">New remaining discounted periods in the new version of discount
                                    instance = 9 + (15 – 10) = 14 </p>

                            </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e335 ">2</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e338 ">Less than the previous version of the discounted periods.</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e341 ">
                                <p class="p">Discount periods (discount instance of the previous version) =
                                    10</p>

                                <p class="p">New version (Discount definition) = 5</p>

                                <p class="p">Remaining discounted periods (discount instance of the previous
                                    version) = 9</p>

                                <p class="p">New remaining discounted periods in the new version of discount
                                    instance = 9 + (5 - 10) = 4</p>

                            </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e335 ">3</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e338 ">Less than the previous version of the discounted periods.</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e341 ">
                                <p class="p">Discount periods (discount instance of the previous version) =
                                    10</p>

                                <p class="p">New version (Discount definition) = 1</p>

                                <p class="p">Remaining discounted periods (discount instance of the previous
                                    version) = 9</p>

                                <p class="p">New remaining discounted periods in the new version of discount
                                    instance = 9 +( 1 - 10) = 0</p>

                            </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e335 ">4</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e338 ">Unlimited.<p class="p">Greater than the previous version of discounted
                                    periods.</p>
</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e341 ">
                                <p class="p">Discount periods (discount instance of the previous version) =
                                    10</p>

                                <p class="p">New version (Discount definition) = Null</p>

                                <p class="p">Remaining discounted periods (discount instance of the previous
                                    version) = 9</p>

                                <p class="p">New remaining discounted periods in the new version of discount
                                    instance = Null</p>

                            </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e335 ">5</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e338 ">Less than the previous version of the discounted periods.</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e341 ">
                                <p class="p">Discount periods (discount instance of the previous version) =
                                    Null (unlimited)</p>

                                <p class="p">New version (Discount definition) = 10</p>

                                <p class="p">Remaining discounted periods (discount instance) = Null</p>

                                <p class="p">New remaining discounted periods in the new version of discount
                                    instance =10</p>

                            </td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e335 ">6</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e338 ">
                                <p class="p">Greater than the previous version of discounted periods.</p>

                            </td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d422028e341 ">
                                <p class="p">Discount periods (discount instance of the previous version) =
                                    Null (unlimited)</p>

                                <p class="p">New version (Discount definition) = 10</p>

                                <p class="p">Remaining discounted periods (discount instance) = 5</p>

                                <p class="p">New remaining discounted periods in the new version of discount
                                    instance = 10</p>

                            </td>

                        </tr>

                    </tbody>
</table>

        </div>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>