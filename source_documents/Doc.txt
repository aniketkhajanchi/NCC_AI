This chapter describes the Online Charging System (OCS) that participates as a charging component in Nokia Converged Charging (NCC) to support real-time data charging, rating, and billing based on the subscriber usage and charging parameters configured in the system for wireless, data, and video services.
The OCS node supports the following interfaces and types of charging: •Sy interface, when the OCS node interacts with the Policy and Charging Rules Function (PCRF) •Gy interface, when the OCS node interacts with the Policy and Charging Enforcement Function (PCEF) •Session-based charging or event-based charging •Centralized or decentralized charging Figure 1: OCS in 3GPP TS 32.296 2.
1 NCC architecture NCC is composed of several modules that interact with each other to offer the following functionalities: •Performs subscriber rating and charging.
•Enables service operators to control their offers and interactions with subscribers.
•Addresses the data market.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.30Charging User Guide Introduction to NCC •Performs the role of an Online Charging Function (OCF).
The Ro and Gy Diameter interfaces are used as native interfaces for charging and rating a session-based or event-based charging service.
The Operations, Administration, and Maintenance (OA&M) module of NCC is responsible for file retrieval and generation of alarms in case of error events whereas the Input/Output handler (I/O) handles the incoming and outgoing traffic.
Figure 2: NCC architecture Following are the major functions of each component in NCC: •Call controller: This module encodes and decodes the Diameter Credit-Control-Request (CCR) or Credit-Control-Answer (CCA) messages.
This module interfaces with the rating engine for context generation and rating response processing.
Following are the sub-modules of the call controller: –Protocol specific controller: This module is responsible for external protocols, such as Diameter protocol, Hyper Text Transfer Protocol (HTTP), File Transfer Protocol (FTP), and Simple Object Access Protocol (SOAP).
–Common call controller: The call controller module contains the logic to be executed when an incoming Diameter request is received.
It interacts with the other modules of NCC during the Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.31Charging User Guide Introduction to NCC processing of a received request.
It supports CCR/CCA, RAR/RAA messages over Gy interface, and SLR/SLA, SNR/SNA messages over Sy interface.
•Subscriber model: The subscriber model is responsible for managing (lookup or update) the subscriber related information in the NCC database.
•Service model: The service model is responsible for managing the charging and rating entities in the NCC database like bundles, tariffs and buckets.
•Session management: The session management module is responsible for creating, updating and deleting the call sessions from memory.
•Charging and rating engine: The charging and rating engine module is responsible for selecting a charging service (from the set of defined charging services in the system) and to rate and charge the call according to the definition of the selected charging service.
•Charging Data Record (CDR) generation framework: This module is responsible for providing framework for generating application CDR in Abstract Syntax Notation (ASN) format.
Interaction between NCC modules during a call Figure 3: Call flow showing the interaction between NCC modules Following steps describe how the charging modules interact with each other for a call received by NCC: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.32Charging User Guide Introduction to NCC 1.When a Diameter call is initiated by the Diameter client, a Credit-Control-Request initial (CCRi) message is sent to the call controller module, which encodes or decodes the Diameter CCR message and performs the message validation.
2.The call controller sends a request to the subscriber model to fetch the subscriber details.
In response, the subscriber model sends the requested information to the call controller.
3.The call controller sends a request to the session manager to build a Call-Control (CC) session.
4.After the CC session is established, the call controller requests the rule engine to apply call control rules to identify the call type, call sub-type, and so on at call control level.
5.Once the call validation and subscriber lookup is completed, the call controller sends a charging request to the charging and rating engine.
6.The rating engine interacts with the service model to fetch the subscription details of the device.
7.After fetching the subscription details of the device, the charging and rating engine executes rules for applicability conditions, which means different rules are applied for different conditions.
For example, if it is roaming call, then a different tariff is applied for charging.
8.The charging and rating engine then builds a rating session in the session manager itself.
9.Once all reservations are successfully completed, the charging and rating engine sends a charging response to the call controller module.
10.The call controller updates the CC session with the session details fetched from the session manager.
11.After updating the session, the call controller triggers the lifecycle manager to trigger lifecycle events.
12.The lifecycle manager sends a notification to the notification server.
The notification server sends an acknowledgment to the Diameter client (PGW) to terminate the call.
13.The lifecycle manager informs the call controller that all the operations associated with the received event are executed.
14.The call controller sends a CCA message to the Diameter client.
This message contains the Diameter result code.
2.2 Types of charging Immediate event charging - IEC Immediate event charging, also referred to as direct charging, is an event-based charging performed by immediate debit on receiving a single charging request.
There is no separate reservation for direct charging and event charging is performed as a single step request.
IEC processes event-based charging for the following Diameter requests: •Immediate debit : Event-based charging with IEC is performed in an immediate debit mode wherein the external entity indicates the origin, destination, service identifier, and requested service units Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.33Charging User Guide Introduction to NCC (for example, volume, time, specific units, and money).
NCC provides an external entity with the information stating whether immediate debit request is granted or not.
•Debit function over Diameter : IEC uses the Direct Debiting One Time Event procedure only when there is no need to maintain any state in the Diameter credit-control server.
For example, it is used for direct debiting without any credit reservation.
•Check balance : IEC uses the Check Balance One Time Event procedure to determine whether account balance is available to process the requested service units.
NCC must check the presence of Requested-Action and Service-Information in the Event Request (CCR), and if Requested-Action is Check-Balance , then it must include Check-Balance-Result AVP in the response (CCA).
NCC must reply with the Check-Balance-Result AVP set as ENOUGH_CREDIT (0) when there is sufficient credit (bucket or main balance) using the incoming RSU to cover the requested service units or else reply with the Check-Balance-Result AVP set as NO_CREDIT (1) in case sufficient credit is unavailable.
Note : When Credit-Control-Request (CCR) event messages are generated, the Network Element (NE) applies IEC and the decision whether to apply IEC is based on the service and/or your policy.
The figure below shows the call flow when an external entity requests immediate charging for a service from NCC.
The Call Transfer Function (CTF) makes the service request and sends a CCR to the NCC as an event request specifying the Requested Service Unit (RSU).
After transmitting the CCR message, the NE starts the communication supervision timer Tx and the server verifies whether the account or device has enough quota available to satisfy the rating based on the RSUs.
If there is sufficient quota, then the server grants all the requested units to the client.
The direct debit is performed after receiving the Credit-Control-Answer (CCA) message, which triggers a response to the CTF with event request, Granted Service Unit (GSU), and Cost Information (CI) and delivers the service.
However, in case there is insufficient quota or bucket available, then the CCR is completely rejected.
Note : Event-based direct debiting transactions are performed over Gy or Ro interface.
The direct debiting operation is carried out prior to service or content delivery but the NE must ensure that the requested service execution is successful.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.34Charging User Guide Introduction to NCC Figure 4: Call flow for IEC direct debiting operation The message flows are in-general driven by the control-point asking for units and the server granting them.
The messages are also generated by other Diameter applications, such as Diameter Network Access Server Requirements (NASREQ) for sessions that are time-limited or usage-limited.
Event charging with unit reservation - ECUR The event charging with unit reservation is a two-stage Diameter event charging wherein: •The first stage is a reservation of a cost amount or reservation of cost for an event •The second stage is to commit that cost amount (calculated in the first stage).
Both request and commit actions are managed using CCR or CCA pairs in the Gy or Ro interface.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.35Charging User Guide Introduction to NCC Figure 5: ECUR call flow Once a CCR message is received and message validation is passed, the call controller determines CallSubType SMS using either of the following methods: •Loading the creditRequestProfile with the highest priority value.
•Searching the map in the creditRequestProfile using the service-context-Id AVP from the CCR message to get the ServiceCallType value.
However, if not provisioned, then the call controller uses the hard-coded 3GPP service-context-Id value to ServiceCallType map.
•Using the ServiceCallType value to find the CallSubTypeMapInfo in the creditRequestProfile .
After this, use the rating-group value from each MSCC to search into the map to determine the CallSubType .
Note : If no rating-group value is matched, then it uses the defaultValue provisioned in CallSubTypeMapInfo .
If the ServiceCallType value is not provisioned, then call controller uses the originator-Interface AVP in the CCR message to map into the CallSubType value.
For more information on different types of call flows and scenarios, see the Custom scenarios appendix.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.36Charging User Guide Introduction to NCC Session charging with unit reservation Session Charging with Unit Reservation (SCUR) is session-based charging with unit reservation when the debit unit and reserve unit operations are both needed and combined in one message.
Session control in this context refers to handling a Diameter session as a complete entity and the session consists of a number of CCR and CCA pairs.
OCS requests the reauthorization through RAR to a gateway.
For SCUR, the consumed units are deducted from the subscriber account after service delivery.
Thus, the reserved and consumed units are not necessarily the same.
The given figure shows the transactions required on the Gy or Ro reference point for SCUR.
Figure 6: SCUR call flow Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.37Charging User Guide Introduction to NCC The following steps show the SCUR call flow as shown in the figure: 1.The NE receives a session initiation.
The session initiation may be done either by the user or the other NE.
2.To perform reserve units operations for a number of units (monetary or non-monetary units), the NE sends a CCR with CC-Request-Type AVP set to INITIAL_REQUEST for the OCS.
If known, the NE may include RSU AVP (monetary or non-monetary units) in the request message.
3.If the service cost information is not received by the OCS, then the OCS determines the price of the desired service according to the service-specific information received by issuing a rating request to the Rating Function.
If the cost of the service is included in the request, the OCS directly reserves the specified monetary amount.
If the credit balance is sufficient, the OCS reserves the corresponding amount from the users account.
4.Once the reservation has been made, the OCS returns CCA message with CC-Request-Type set to INITIAL_REQUEST for the network element to authorize the service execution (Granted-Service- Unit and possibly Cost-Information indicating the cost of the service and Remaining-Balance AVP are included in the CCA message).
The OCS may return the Validity-Time AVP with value field set to a non-zero value.
The OCS may indicate in the Low-Balance-Indication AVP that the subscriber account balance has fallen below a predefined threshold of this account.
5.Content/service delivery starts and the reserved units are concurrently controlled.
6.During session delivery, to perform debit units and subsequent reserve units operations, the NE sends a CCR with CC-Request-Type AVP set to UPDATE_REQUEST , to report the units used and request additional units, respectively.
The CCR message with CC-Request-Type AVP set to UPDATE_REQUEST must be sent by the NE between the INITIAL_REQUEST and TERMINATION_REQUEST either on request of the credit control application within the validity time or if the validity time is elapsed.
When VT is elapsed, TEM removes the session and return the reservations.
If known, the NE may include Requested-Service-Unit AVP (monetary or non-monetary units) in the request message.
The Used- Service-Unit (USU) AVP is complemented in the CCR message to deduct units from both the user's account and the reserved units, respectively.
7.The OCS deducts the amount used from the account.
If the service cost information is not received by the OCS, then the OCS determines the price of the desired service according to the service-specific information received by issuing a rating request to the Rating Function.
If the cost of the service is included in the request, then the OCS directly reserves the specified monetary amount.
If the credit balance is sufficient, then the OCS reserves the corresponding amount from the users account.
8.Once the deduction and reservation have been made, the OCS returns CCA message with CC-Request- Type set as UPDATE_REQUEST to the NE, to allow the content or service delivery to continue (new Granted-Service-Unit (GSU) AVP and possibly Cost-Information (CI) AVP indicating the cumulative cost of the service and Remaining-Balance AVP are included in the CCA message).
The OCS may include in the CCA message the Final-Unit-Indication (FUI) AVP to indicate the final granted units.
The OCS may indicate in the Low-Balance-Indication AVP that the subscriber account balance has fallen below a predefined threshold of this account.
9.The session delivery continues and reserved units are concurrently controlled.
10.The session is terminated at the NE.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.38Charging User Guide Introduction to NCC 11.The NE sends CCR with CC-Request-Type AVP set to TERMINATION_REQUEST for terminating the active credit control session and report the used units.
12.The OCS deducts the amount used from the account.
Unused reserved units are released (if applicable).
13.The OCS acknowledges the reception of the CCR message by sending CCA message with CC-Request- Type AVP indicating TERMINATION_REQUEST (possibly Cost-Information AVP indicating the cumulative cost of the service and Remaining-Balance AVP are included in the CCA message).
5G ECUR calls with NEF and AMF node Important points •Gy Session Authorisation Validity (seconds) application preference should not be enabled in ECUR + AMF/NEF calls.
•NotifyURI is not mandatory for such calls.
•Update result code in 5G ECUR charging calls for AMF and NEF node: 1.If in the response any MSCC has success result code, then root result code is not updated.
2.If in response all MSCCs fail with same reason/result code then the failed result code(of MSCC) will be set in root result code.
3.If in response all MSCCs fail with different reason/result code then 4012 - RATING_FAILED is set in root result code.
•Update result code in OneTimeEvent/IEC in 5G charging calls: 1.If in response any MSCC has success result code, then root result code is not updated.
2.If in response all MSCCs fail with same reason/result code, then the failed result code (of MSCC) is set in root result code.
3.If in response all MSCCs fail with different reason/result code, then 4012 - RATING_FAILED is set in root result code.
•Only first value is dumped for externalGroupIdentifier as specified in 3GPP 32298 Rel 16 specs.
•GroupIdentifiers is dumped in TBCD format in CDR.
•IEC call for NEF and AMF node also works as SMS (Diameter) calls.
2.3 Entities in SM GUI The NCC GUI is being enhanced in a phases.
Some apps are now available the new GUI, and some apps are available in the legacy GUI.
This section describes the different ways to navigate the legacy and new GUI.
New GUI The new GUI can be accessed using one of the following two ways: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.39Charging User Guide Introduction to NCC •access the URL as in https://<SM_IP>:<SM_port>/ncc/ •in the legacy GUI, click the Charging Configuration icon.
Only the apps described in the following table are available in the new GUI.
For rest of the apps, it redirects to the legacy GUI.
Icon Tabs Charging •CATALOG MANAGEMENT –Services ( Bundles) –Loans –Recharge Offers –Discount •CHARGING MANAGEMENT –Charging Logics –Balance Logics –Wholesale Ligics –Category Order •COMPONENT LIBRARY –Actions –Allowance Limits –ConditionsTable 3: Entities in new GUI Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.40Charging User Guide Introduction to NCC Icon Tabs –Custom Counters –Fair Usage Policies –Metering Limits –Rates –Tiered Allowances •Threshold Profiles •Lifecycles •Taxation •Proration Profiles •Bill Cycle Calendars •Mapping Tables •GLOBAL RULES –Rules and Variables –Quota management profile ( slicing profile) Refer to Charging configuration ( new GUI) on page 1331 for details.
Platform •NCC NODES –Nodes –Managed element groups –Service manager overload •Service providers •Network Repository Function •GLOBAL SETTINGS –Currency Languages –Languages Note : Most of the configurations from Global Configuration app ( in legacy GUI) have been moved to this app.
Refer to the Global Configuration Guide for details.Table 3: Entities in new GUI (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.41Charging User Guide Introduction to NCC Icon Tabs Notification •Templates •Profiles •Tracking •Servers •TCP inbound Refer to the Notification Service User Guide for details.Table 3: Entities in new GUI (continued) Legacy GUI The legacy GUI can be accessed using one of the following two ways: •access the URL as in https://<SM_IP>:<SM_port>/servicemanager/v22_9/?ncc •in the new GUI, click the Subscriber Data or Diameter/5G icon.
The apps described in the following table are available in the legacy GUI.
The Charging Configuration app redirects to the new GUI.
Icon Tabs Common Configuration Charging → •Global ConfigurationTable 4: Entities in legacy GUI Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.42Charging User Guide Introduction to NCC Icon Tabs •Usage Control •Aggregate View •Units Mapping •LDAP External Server Configuration Refer to Common configuration ( legacy GUI) on page 1545 for details.
Subscriber Manager •Accounts •Devices •Users •Groups •Custom Data •Sessions •Tracing •Unknown Subscriber •Subscriber Tracing Refer to the Subscriber Manager Guide for details.
Diameter / HTTP Configuration •Peers •Routing •Throttling •Overload •Messages Manipulation Refer to the Diameter/ HTTP Configuration Guide for details.
Global Configuration •Administration –SM Operators –Roles and Access Control •Application Configuration –CDR MappingTable 4: Entities in legacy GUI (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.43Charging User Guide Introduction to NCC Icon Tabs –Throttling Note : Most of the configurations from Global Configuration app have been moved to Platform app in the new GUI.
Refer to the Global Configuration Guide for details.Table 4: Entities in legacy GUI (continued) Configuring objects Log into the new GUI, navigate to the Charging and select any charging components from the hamburger menu (☰) and perform any of the following actions: •Click at the top-right corner of the page to create a new object.
•Select an existing object and click to edit that object details.
•After committing one or more configuration changes to any charging component using the SM GUI, save the change and send the applied configuration to the Charging application by clicking .
This opens a Publish Version form that allows you to select one or more available ME as the target for change.
Note : You can follow the same steps to configure objects in Common option.
2.4 Charging application preferences For details on configuring ME application preferences, see Managed Elements section in Global Configuration Guide .
2.5 Service providers Wireless communications services providers can be of the following types: •MNO (mobile network operator): A primary operator that owns its network infrastructure and provides services to its customers.
•MVNO (mobile virtual network operator): A secondary operator that does not own the network infrastructure over which it provides services to its customers.
It operates as a tenant to the MNO.
Typically, MVNOs enter into an agreement with an MNO to obtain bulk access to network services at wholesale rates, then set retail prices independently.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.44Charging User Guide Introduction to NCC In NCC, the Service Provider entity enables you to configure both MNO and MVNOs.
One MNO and multiple MVNOs can be configured.
MNO (operator) and MVNOs can use the same NCC platform for billing/charging.
Note : •All MVNOs and the MNO in the system must belong to the same country.
•All MVNOs in a system must use the same timezone as of the MNO.
For details about configuring service providers, see Service providers section in Global Configuration Guide .
Service provider in SM GUI If service provider is enabled, the configured service providers (MNO and MVNOs) are available for selection in the right side of the top ribbon, as a drop-down list, as shown in the following figure.
The service providers visible in the top ribbon depends on the user role.
NCC users having permission to operate for a particular service provider only have the that service provider in the drop-down list.
For example, if a user has permission only for MVNO1 , then it can view only MVNO1 in the top-right corner of the page.
Entities created for a particular service provider are available only for that service provider.
If you want to change the service provider, then select it from the drop-down list.
Note that, if an entity is created/displayed for a service provider, then it is available for provisioning in other entities belonging only to the same service provider.
The entity is not available for other service providers; however, the same entity name can be used in different service providers.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.45Charging User Guide Introduction to NCC 2.5.
1 Segregation of data - Charging and Common Only the entity types listed in this section are segregated per service provider for Charging and Common.
That is, entities created in a service provider are available (and can be associated/used by other entities) within that service provider.
These are not available for other service providers.
Entities with the same name can exist across service providers.
However, the database identifier of such entities are prefixed with the service provider name.
An MNO user can view, create, edit, publish data for segregated entities for any MVNO or MNO.
•Complex Map Entry •Complex Map Definition •Aggregate View •Discount •UCService •Unit •Bundle•Mapping Table •ChLogic •BillCycle Calendar •Bucket •Counter •Rate •Taxation•Threshold Profile Group •ChLogic Category •ChRule Component •FairUsage Policy •Proration •Tiered Allowance •LifeCycle •RSVTable 5: Entities segregated per service provider 2.5.2 Default data created at MVNO onboarding The following entities are created when the MVNO is provisioned in SM: •Unit •NotificationProfile •NotificationTemplate •Counter •LifeCycle •AppPreference •CategoryOrder Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.46Charging User Guide Call mangement 3Call mangement When the NCC call controller receives an Event , Initial , Update , or Terminate Diameter request, it interacts with other NCC modules.
Call controller contains the logic to be executed on receiving an incoming Diameter request.
The logic does not depend on the external protocol that triggered the request.
Call controller provides the interface to the network for different Diameter requests and responses that interface with other NCC modules.
It accepts the initial attachment from the gateways and performs the following functions: •Interfaces with the subscriber model to get the device and its lifecycle.
•Creates, modifies, and terminates a Gy session.
•Sends a request object to the charging or rating engine.
•Processes all Credit-Control-Request (CCR) and outgoing Credit-Control-Answer (CCA) messages.
•Generates an alarm for call controller.
When a Diameter CCR is received, call controller retrieves the subscriptionId and uses it to query the subscriber model for the device and determine the existence of the device.
If the device exists, then call controller continues the message processing.
If the device is barred or not found, then the call is rejected.
Online data call charging NCC performs online (or real-time) charging and rating over the Ro and Gy interfaces, along with hosting duties and managing user account information and rating plans.
An account, located in an online charging system, is queried prior to the granting of permission for use of the requested network resources allowing the network to perform real-time monitoring of resource usage and detection of the relevant chargeable events.
Based on the 3GPP TS 32.299 Ro specifications for all Diameter charging details, NCC supports the following three charging modes for online charging of data calls for IMS, SMS, MMS, and PS domains: •Immediate Event Charging (IEC); also known as immediate debit •Event Charging with Unit Reservation (ECUR); also known as two-step debit •Session Charging with Unit Reservation (SCUR); also known as quota-based charging Intended for the transport of charging events, the Rf and the Ro are reference points from the Charging Trigger Function (CTF) to the Charging Data Function (CDF) and the Online Charging Function (OCF) respectively.
NCC communicates with the external entities over the Ro interface for charging requests when triggered by a domain, service node, or sub-system as shown in the following diagram.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.47Charging User Guide Call mangement Figure 7: Charging module interfaces The data service receives a charging request from an external entity through the Diameter interface.
Data charging is managed according to the parameters contained in the request and includes the following capabilities: •Charging according to the event or content accessed (event charging), such as an MMS.
•Charging according to the volume of data exchanged (volume charging).
•Charging according to the duration of the GRPS session (duration charging).
•Charging according to the CC-Money AVP not sent by the client.
•Device-based charging (prepaid or postpaid).
•QoS adaptation and charging based on policy rules.
The data charging function (charging mode) supports session-based and event-based charging modes and requests.
•Session-based requests •Event-based requests Event-based charging is performed either by immediate debit or in a two-step mode as follows: •In immediate debit mode, the external entity indicates the origin, the destination, the service identifier, and the requested units (amount of money), if known.
NCC provides the external entity with the information mentioning whether the immediate debit request is granted or not.
•In the two-step debit mode, there is firstly a credit reservation request (CCRi), where the request is units are reserved and then second request if for commit (CCRt), where there is a debit from account.
CCRt is received by NCC only if the granted units are consumed or Validity-Timer expires.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.48Charging User Guide Call mangement Session-based charging allows you to request a certain amount of "quota", such as a certain volume for a specific URL or a certain amount of time for a video session.
This type of charging is based on allocation of volume, duration, or specialized units slice(s).
Volume/duration slice allocation is performed as follows: •The external entity sends a request to the data charging function to book a volume and / or duration and or / specialized units slice(s).
Note : The volume, time, unit, or money reservation is supported only for a single request.
Multiple types of unit reservation, such as volume + time per volume + units is not supported.
•The data charging function performs a slice price according to the parameters included in the request and the parameters hosted in the accounts and then books a slice.
•A transaction acknowledgement is sent to the external entity.
The operator selects whether the data charging function determines the volume, duration, money, or slice size (auto-determination), or whether this is done by the external entity.
The debit function enables the debit of an end-user account.
For direct debiting with IEC, a single transaction is created where the OCF deducts a specific amount from the user's account immediately after completing the credit authorization.
After receiving the authorization, the CTF delivers services.
This form of credit authorization is a one-time event in which no session state is maintained.
With IEC, the online charging client implements the “CLIENT, EVENT BASED” state machine described in IETF RFC 4006.
The debit may be performed in one step (immediate debit) or two steps (debit with confirmation of the end-user) according to the type of transaction.
Call control credit request profile configuration NCC supports call controller configuration from the credit request profile, which is made up of rules, default actions, and the dynamically generated information from request messages.
Each transaction is processed in the active Rule System Version (RSV) as follows: •Rules: generated from the credit request profile executed by the Rule Engine.
•Default actions: executed only if a similar action is not executed in the selected rule.
•A list of rule tables used for call controller to set conditions and retrieve actions.
Based on the object evaluated and location in the call flow, source contexts vary.
For example, the Credit Request Profile is evaluated first in the flow.
It has access to device and the Gy.Message context only.
When the applicability condition or tariff is evaluated, there is access to more contexts.
The default RSV and default credit request profile provide an out-of-box solution for customizing the credit request profile.
The following table describes the call controller default credit request profile parameters.
Each parameter can have a default value that is automatically provisioned when no provisioning is present.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.49Charging User Guide Call mangement Parameter Description Value profile Name The name of the default profile.
The default Credit Request Profile is named “Default” priority The priority in the default Credit Request Profile is set to the lowest priority, which is the largest number of the type Integer.Integer isActive This parameter exists in the default Credit Request Profile to show its status.true default Actions You can create two default rule variables ( one for Call Type and one for Call SubType) when you create the default charging rule system version ( with RSV name ' default' ).
The rule logic for the rule variables is empty and left for you to provision their evaluation and set the values of the variables.
The default actions here exist for the rule variables that you create.
Other default actions or values can be added to this default profile when needed.Action: Call_ Result.
Call- Type= Variables.
get_ variable( "CallType" ) Action: Call_ Result.
Call- Sub- Type= Variables.
get_ variable( "CallSubType" ) Note : These entity parameters cannot be changed and are valid for Internal purposes only.
It is not exposed in the SM GUI for operators.
When there is a charging rule system version reload, the creditRequestProfieScanner checks to see if the default CreditRequestProfile exists.
If it does not exist, then it creates the default CreditRequestProfile.
The following table describes what can be provisioned for call controller using a call control Credit Request Profile.
Many of the parameters are optional to provision; however, each parameter can have a default value that is automatically provisioned when no provisioning is present.
Parameter Type Description Mandatory/ Optional profile Name String A unique name of the profile that defines theMandatoryTable 6: Call control credit request profile Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.50Charging User Guide Call mangement Parameter Type Description Mandatory/ Optional value of the primary key of this table.
priority Integer The priority of this profile, whose value is also unique.
The priority in the default Credit Request Profile is set to the lowest priority, which is the largest number of the type Integer.Mandatory operator Name String The name of the operator that owns this profile.Optional isActive boolean The status of this profile.
Only the active profile is used.
This parameter exists in the default Credit Request Profile.Mandatory creation Time Long The time stamp of when this profile was created.
The value is automatically generated.- lastUpdate Time Long The time stamp of the updated time of this profile.
This value is automatically generated.- default Zone String The name of the default zone used in zone processing if the mapping table/ rules do not yield a result.Optional; however, if it is not provisioned, Rest of World ( ROW) is used.Table 6: Call control credit request profile (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.51Charging User Guide Call mangement Parameter Type Description Mandatory/ Optional ruleTables List< Charging Rule Table> Contains a list of charging Ruletables.
The same action can be present in both rule tables and default Actions.
The default Action has the lower priority.
All rule tables in the list are automatically generated into individual rule tables in the currently active RSV.Optional default Actions List< Actions> Contains a list of actions used as command level action values, for example: CALL_ RESULT.
DEFAULT_ ROAMING_ DECISION CALL_ RESULT.
CREDIT_ CONTROL_ FAILURE_ HANDLING CALL_ RESULT.
DIRECT_ DEBITING_ FAILURE_ HANDLINGOptionalTable 6: Call control credit request profile (continued) Note : These entity parameters cannot be changed and are valid for Internal purposes only.
It is not exposed in the SM GUI for operators.
The following three rule tables are examples of rules executed using the Credit-Request-Profile and rule engine: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.52Charging User Guide Call mangement Rule table Rule 1 If GY_ MESSAGE.
Service- Context- Id = 32274@ 3gpp.
org Then CALL_ RESUL T. Default- Roaming- Decision= Roaming Decision HOME 2 If GY_ MESSAGE.
Multiple- Services- Credit- Control.
Rating- Group = 8 Then CALL_ RESUL T. Call- Sub- Type = Call SubType SMS_ MO 3 If Device Id is in the list of 2000000000001| 2000000000002| 2000000000003 Then Call- Zones = North America, Canada, OntarioTable 7: Rule table examples Determining CallType and CallSubType with rule variable default actions Call controller resolves the CallType and CallSubType values using rule variables.
Both the values are in common call source context and passed on to rating to allow manipulation of charging services.
The call type and call sub-type determination are defined in a rule associated with the credit request profile object or in a rule variable.
Out of the box, the rule logic for the default actions mentioned in the default Credit Request Profile does not exist; therefore, you must configure each of the rule variables.
You can configure a CallType instance to equal the CallType rule variable value and the CallSubType instance to equal the CallSubType rule variable value in the RSV only.
Then you can use the default Credit Request Profile to use the rule variables.
You can also configure the CallType and CallSubType rule variables directly as a rule action in a rule table without referencing the rule variable inside the Credit Request Profile.
If you do not configure these two rule variables, the call type determination is based on the 3GPP standard described below, and there is no CallSubType mapping.
•SMS_SERVICE_CONTEXT_ID 32274@3gpp.org : SMS call type •PS_SERVICE_CONTEXT_ID 32251@3gpp.org : PS call type Two default rule actions exist in the default ChargingRuleSystemVersion, one for CallType and one for CallSubType.
The default CallType and CallSubType rule variables in the actions are empty rule variables without default values.
You are responsible for configuring the rule variables with conditions and values.
Rule Variable creation is described in Rule system versions on page 259.
For example, within the default ChargingRuleSystemVersion find the default Credit Request Profile and use the default actions for CallType and CallSubType ensuring that the rule variables are configured as follows: •Rule Variable for CallType configured under Variables .
Rule Variable Name: CallType Rule Variable Type: ENUM •Rule Variable for CallSubType configured under Variables .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.53Charging User Guide Call mangement Rule Variable Name: CallSubType Rule Variable Type: STRING •Rule Set Types: GY_CREDIT_REQUEST •Rule Variable Evaluation The default Credit Request Profile is configured with the lowest priority, which is the largest number of the type Integer.
You need to clone the default ChargingRuleSystemVersion, and modify the default CallType and CallSubType rule variables, as needed, to add the evaluations with different conditions and values.
Example of CallType and CallSubType usage The following is a simple example of defining the rule logic inside the rule variable CallType.
In this example, you want to use AVP1 in a Gy Message to determine the CallType inside the variable CallType, the rule logic can be defined as follows: •Rule Variable Name: CallType •Description: CallType variable in Gy Message.
•Rule Variable Type: ENUM •Rule Set Types: GY_CREDIT_REQUEST •If Gy_Message.AVP1 = sms@abc.com then, the value is CallType.SMS •If Gy_Message.AVP1 = ps@abc.com , then the value is CallType.PS The following are more complex examples that define the rule logic inside the rule variable CallSubType, while including the rating-group in MSCC and Service-Context-Id to determine the CallSubType.
For example, you can define a rule in which the CallSubType rule variable is set to the value data stream or SMS_MO depending on some specific values received in the Service-Context-Id and the Rating-Group AVPs.
Complex example 1 •Rule Variable Name: CallSubType •Description: CallSubType variable determination by MSCC and Service-Context-Id in Gy Message.
•Rule Variable Type: STRING •Rule Set Types: GY_CREDIT_REQUEST •If Gy_Message.Service-Context-Id = ps@abc.com AND Gy_Message.Multiple-Services- Credit-Control.Rating-Group = 2 , then the value is dataStream •If Gy_Message.service-Context-Id = sms@abc.com AND Gy_Message.Multiple-Services- Credit-Control.Rating-Group = 3 , then the value is SMS_MO Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.54Charging User Guide Call mangement Complex example 2– Defining the value of CallSubType using the rule variable CallType : •Rule Variable Name: CallSubType •Description: CallSubType variable mapped by Multiple-Services-Credit-Control.Rating-Group and CallType rule variable in the Gy Message.
•Rule Variable Type: STRING •Rule Set Types: GY_CREDIT_REQUEST •If Variables.get_variable callType = CallType.PS AND Gy_Message.Multiple-Services-Credit- Control.Rating-Group = 2 , then the value is dataStream •If Variables.get_variable callType = CallType.SMS AND Gy_Message.Multiple-Services- Credit-Control.Rating-Group = 3 , then the value is SMS_MO Multiple-Services-Credit-Control The Multiple-Services-Credit-Control AVP is of type grouped and contains the AVPs related to the independent credit-control of multiple services feature.
Each instance of this AVP carries units related to one or more services or related to a single rating group.
The Service-Identifier and the Rating-Group AVPs associate the granted units to a given service or rating group.
If both the Service-Identifier and the Rating-Group AVPs are included, the target of the service units is always the services indicated by the value of the Rating-Group AVP.
The Requested-Service-Unit AVP contains the amount of requested service units.
If the Requested- Service-Unit AVP is empty, then the reservation is done as per the central logic.
The Requested-Service- Unit AVP must be present in the initial interrogation and within the intermediate interrogations in which new quota is requested.
If the credit-control client does not include the Requested-Service-Unit AVP in a request command (for example, if it determines that the end user terminated the service) then the server must debit the used amount from the user's account, but must not return a new quota in the corresponding answer.
The Validity-Time and Result-Code are present in an answer command for graceful service termination.
The Multiple-Services-Control AVP is defined as follows: Multiple-Services-Credit-Control ::= < AVP Header: 456 > [ Granted-Service-Unit ] [ Requested-Service-Unit ] *[ Used-Service-Unit ] [ Tariff-Change-Usage ] *[ Service-Identifier ] [ Rating-Group ] *[ G-S-U-Pool-Reference ] [ Validity-Time ] Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.55Charging User Guide Call mangement [ Result-Code ] [ Final-Unit-Indication ] *[ AVP ] Unit determination and rating This section provides information about unit determination and rating from a call controller perspective.
Rating and unit determination can be implemented as centralized (on OCF, that is rating or charging engine) or decentralized (on CTF, that is call controller).
Unit determination refers to calculation of slice size to be allocated for the request received, such as volume, time, unit, money assigned prior to starting service delivery.
Decentralized rating Rating refers to the calculation of a price out of the slice determination calculated by the unit determination function.
For decentralized rating, the corresponding rating control is performed within call controller (CTF).
Consequently, call controller (CTF) and rating or charging engine (OCF) exchange information about monetary units.
Decentralized unit determination With decentralized unit determination, call controller determines how many units are required to start service delivery, and requests these units from rating or charging engine.
After checking the account balance of the service user, the rating or charging engine returns the number of granted units to call controller responsible for the supervision of service delivery.
Call controller limits the service delivery to the corresponding number of granted units.
Currently, NCC uses decentralized unit determination for IEC, ECUR, and SCUR.
Call controller asks rating or charging engine to assure the deduction of an amount of the specified number of monetary units from the subscriber account as shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.56Charging User Guide Call mangement Figure 8: IEC decentralized unit determination The request for resource usage flow is as follows: 1.UE-A requests the desired content from the network element.
2.Units determination depends on the service requested by UE-A, call controller determines the number of units accordingly.
3.Rating control has call controller calculating the number of monetary units that represent the price for the number of units determined.
4.Debit units request has call controller requesting that rating or charging engine assures the deduction of an amount corresponding to the calculated number of monetary units from the subscriber account.
5.Account control has rating or charging engine trigger the deduction of the calculated amount from the subscriber account, provided that the credit balance of user is sufficient.
6.Debit units response has rating or charging engine indicating to call controller the number of deducted monetary units.
7.Content service delivery has call controller delivering the content or service at once, in fractions, or in individually chargeable items, corresponding to the number of units as specified.
8.Credit amount control is a continuation from items 2 to 6.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.57Charging User Guide Call mangement 9.Content service delivery continuation.
10.Session released.
For ECUR-based decentralized unit determination, call controller requests the reservation of units prior to service delivery.
An account debit operation is carried out following the conclusion of service delivery as shown in the following figure.
Figure 9: ECUR decentralized unit determination The request for resource usage flow is as follows: 1.UE-A requests the desired content from the network element.
2.Units determination depends on the service requested by UE-A, call controller determines the number of units accordingly.
3.Reserve units request where the call controller requests rating or charging engine to reserve the number of units determined.
4.Rating control assisted by the rating entity has rating or charging engine calculating the number of monetary units that represent the price for the number of units determined.
5.Account control has the rating or charging engine check the user account balance is sufficient for the requested reservation.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.58Charging User Guide Call mangement 6.Reservation control makes the corresponding reservation in case the user account balance is sufficient.
7.Reserve units response has rating or charging engine inform call controller of the reserved number of units.
8.Reserved units supervision occurs simultaneously with the service delivery, call controller monitors the consumption of the reserved units.
9.Content service delivery has call controller delivering the content or service at once, in fractions, or in individually chargeable items, corresponding to the number of units.
10.Debit units request has call controller requesting rating or charging engine to assure the deduction of an amount corresponding to the consumed number of units from the subscriber account.
In the case that no further units are required for this service, an appropriate indication triggering the release of the remaining reservation is given.
11.Rating control, assisted by the rating entity has rating or charging engine calculate the number of monetary units to deduct from the subscriber account.
12.Account control has the rating or charging engine triggering the deduction of the calculated amount from the subscriber account.
13.Debit units response has rating or charging engine informing the call controller of the units actually deducted.
14.Session released.
For SCUR-based decentralized unit determination, call controller requests rating or charging engine to assure the reservation of an amount of the specified number of monetary units from the subscriber account.
An account debit operation that triggers the deduction of the amount from the subscriber account is carried out following the conclusion of session establishment as shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.59Charging User Guide Call mangement Figure 10: SCUR decentralized unit determination The request for resource usage flow is as follows: 1.UE-A requests the session establishment from call controller.
2.Units determination depends on the requested type by UE-A, call controller determines the number of units accordingly.
3.Rating control has call controller calculating the number of monetary units that represent the price for the number of units determined.
4.Reserve units request where call controller requests rating or charging engine to assure the reservation of an amount corresponding to the calculated number of monetary units from the subscriber account.
5.Account control has rating or charging engine to check the user account balance is sufficient for the requested reservation.
6.Reservation control makes the corresponding reservation whether the user credit balance is sufficient.
7.Reserve units response has rating or charging engine to inform call controller of the reserved number of monetary units.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.60Charging User Guide Call mangement 8.Budget control has call controller monitor the consumption of the granted amount simultaneously with the ongoing session.
9.Session ongoing has call controller maintain the session.
One or more debit and reserve operations are performed when the session is ongoing.
10.Session released.
11.Debit units request where call controller requests rating or charging engine to assure the deduction of an amount corresponding to the consumed number of monetary units from the subscriber account.
12.Account control has the rating or charging engine trigger the deduction of the consumed amount from the subscriber account.
13.Debit units response has rating or charging engine indicate the number of deducted monetary units to call controller.
Centralized rating Rating refers to the calculation of a price out of the non-monetary units calculated by the unit determination function.
With centralized rating, call controller (CTF) and rating or charging engine (OCF) exchange information about non-monetary units.
Rating or charging engine (OCF) translates these units into monetary units.
Three cases for online charging can be distinguished as follows: •Immediate event charging (IEC) •Event charging with unit reservation (ECUR) •Session charging with unit reservation (SCUR) Centralized unit determination With centralized unit determination, OCF determines the number and type of units that a user can consume.
In this approach, the unit determination is based on the rule defined in the credit request profile.
When the call controller receives the CCRi request, if the RSU is empty and centralized charging mode is set, then NCC checks whether a rule is configured for this CCR service context in the credit request profile.
If a rule is configured, the result action of the rule determines the unit for the call.
This information is sent to the rating engine, where the charging services are filtered based on the unit type.
The identified unit type and charging mode are saved in the database and used for the subsequent reservation requests.
If a rule is not configured, then a default value of UnitType.TVOL is used for the call.
Note that, it is not possible to switch between the charging modes (centralized/decentralized) in the same session.
Note : The centralized unit determination is not applicable for IEC calls.
For ECUR-based centralized unit determination, call controller (CTF) requests rating or charging engine (OCF) to reserve units based on the service identifier sent by call controller (CTF).
For SCUR-based centralized unit determination, call controller (CTF) requests rating or charging engine (OCF) to reserve units based on the session identifiers sent by call controller (CTF).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.61Charging User Guide Call mangement Figure 11: SCUR centralized unit determination - CCRi The CCR-I request for resource usage flow is as follows: 1.UE-A (it can be a Diameter client) sends a CCRi message to NCC node with an empty RSU.
2.The call controller (CTF) checks whether the RSU is empty and sets the charging mode to centralized and retrieves the unit type from the credit request profile.
3.Call controller (CTF) sends the request to rating or charging engine (OCF) to add the unit type value.
4.Rating or charging engine (OCF) retrieves the subscription details for the device that returns bundles.
It filters the charging service using the unit type and sorts charging services from bundles.
Rating or charging engine (OCF) executes the applicability conditions applicable for the call and gets the tariff to be applied and sends the response to call controller (CTF) with the results of granted units.
The unit type identified and the charging mode are saved to be used for further reservation requests.
5.Call controller (CTF) sends the CCA message to UA-E. 3.
1 IMS voice call support Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.62Charging User Guide Call mangement 3.
1.
1 Normalization for Subscription ID NCC devices are provisioned with MDNs (as E.164 addresses) and not with SIP_URIs.
It may happen that both E164 and SIP_URI are present in a CCR.
All SIP_URI subscription-IDs received from the network can be normalized to MDNs (prefixes 1 and +1 are removed).
Following are some examples of SIP URI and TEL URI: •sip:+16958882103;rn=9918872101@Nokia.host;npri=888878798 •sip:16958882103;rn=9918872101@Nokia.host;npri=888878798 •sip:16958882103@Nokia.host;npri=888878798 •sip:+16958882103@Nokia.host;npri=888878798 •tel: +16958882103;… For all these examples, the normalized MDN would be 6958882103.
Configure custom attribute First, configure a custom attribute Subscription-Id.SIP-Number .
This attribute allows to extract the number from the SIP URI data.
A null is returned if the Subscription-Id is not SIP.
For example, if SIP URI data is sip:16958882103@Nokia.host;npri=888878798 , then Subscription-Id.SIP-Number becomes 16958882103 .
Rule to get E.164 number from SIP_URI The following rules can be used to get the E.164.
Figure 12: Rule for checking Subscription ID Figure 13: Rule for looping Subscription ID Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.63Charging User Guide Call mangement Figure 14: Rule for trimming Subscription ID 3.
1.2 Normalization for Calling-Party-Address and Called-Party-Address After normalization, Called-Party-Address is used to check blacklist/whitelist in device customer data and UC allowed and barred list.
For blacklist/whitelist in device custom data, IMS_CALL_ESTABLISHMENT trigger is used.
For UC allowed and barred list, GY_PRE_PROCESSING trigger is used.
Note : Blacklist/Whitelist can be provided as custom data in Device context, that is, SPR_DEVICE for triggers specified in the SPR_DEVICE source context on page 1111 section.
This section has details on the custom data and source contexts applicable as per triggers.
Blacklist/Whitelist is not applicable to Group custom data, that is, SPR_GROUP source context.
For multiple occurrence of Calling-Party-Address , only the first number from the platform is normalized.
Following are the rule examples for normalizing Calling-Party-Address and Called-Party-Address.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.64Charging User Guide Call mangement Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.65Charging User Guide Call mangement 3.
1.3 Mobile number portability support The CALL_COMMON.Number-Portability-Routing-Information source context attribute provides support for the Mobile Number Portability (MNP) function for IMS, SMS, and MMS calls.
Number portability attribute in CALL_COMMON source context is available for the following triggers: •APPLICABILITY •TARIFF •THRESHOLD The value of this attribute is read from the Service-Information > IMS-Information > Number-Portability- Routing-Information AVP, and is used without formatting.
Following is an example rule for charging based on number portability.
if CALL_COMMON.Number-Portability-Routing-Information = "33333" then RATING.No-Charge Number portability entity support The NumberPortability entity (MNP DB) supports the MNP data.
This entity can be created only using REST API and there is no GUI support for this entity.
The entity is available in dsc namespace at SM and dsclocal at ME.
Following are the parameters of this entity: •routingNumber: Mandatory field •Info1: Optional field •Info2: Optional field •Info3: Optional field •Info4: Optional field Important : Consult dimensioning team before using the MNP DB.
Following APIs are supported: •create : This API creates a single MNP record at a time if the record doesn't exist.
•update : This API updates a single MNP record at a time if the record exists.
•get: This API retrieves a record based on the routing number.
•delete : This API deletes a record based on the given routing number if it exists •bulkadd : This API adds multiple records at a time.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.66Charging User Guide Call mangement •bulkaddandprovision : This API adds multiple records and provision records at MEs that are provided in the distList parameter.
•bulkprovision : This API distributes the records at MEs that are provided in the distList parameter.
•bulkunprovision : This API removes records at MEs that are provided in the deleteDistList parameter.
•bulkdelete : This API removes records in bulk.
The records provisioned at MEs are removed automatically and once successful, the records get deleted from SM.
The export and import is supported as follows.
The db-list tool can be used to export the records of the NumberPortability entity.
Syntax is as follows: db-list -l numberPortability The import can be done using BULK ADD AND PROVISION API by creating bulk records in a single call.
For provisioning for the first time, the BULK ADD and BULK PROVISION APIs must be used.
Redirecting (non-NR) charging sessions to external OCS Using the number portability entity (MNP DB), operators can configure to redirect the (non-NR) Charging Sessions to an external OCS.
Routing of charging signals (CCR-I, CCR-U, CCR-T) is done based on the information available in MNP table.
Following configurations are required to enable this: •Set the application preference Dual Running Mode to 3.
•Fill the routingNumber and Info1 of number portability entity as described in the following table.
The fields Info2, Info3, Info4 can be empty.
Record number routing Number Info1 1 Subscriber' s MSISDN.
Provide a unique ID ( string) .
This unique ID is then used to create another record in the table.
It must have integer values restricted from 0 to 99.
2 Provide the unique ID provided in Info1 of record 1.Provide the service provider ID, the realm, hosts (up to 10) separated with comma and space characters.Table 8: MNP table Multiple pairs of such info can be created in the MNP table.
However, ensure that the Info1 provided for all subscriber MSISDNs have a corresponding entry (only one) in the routingNumber column available in the table.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.67Charging User Guide Call mangement Record number routing Number Info1 1 123465748 1 2 1 Xphone, realm1, ncc- me1.
realm1, host2 3 762587364576 2 4 2 Yphone, realm2, host99, host98, host97Table 9: Example MNP table Where Xphone and Yphone are examples of service provider names.
Routing number support If Recipient-Address/Address-Domain/Domain-Name AVP is present, then content of Domain-Name is used to impact rating.
Else if Recipient-Address/Address-Domain/3GPP-IMSI-MCC-MNC AVP is present, then content of 3GPP- IMSI-MCC-MNC AVP is used to impact rating.
For certain operators, the recepient address is obtained from Recipient-Info AVP under MMS-Information.
The CALL_COMMON.Routing-Number condition is used to fetch the routing number.
NCC takes the value of routing number from the following AVPs and it is also used to fill the CDR tag of number portability routing number.
For MO-SMS/MMS call, if the Recipient-Address/Address-Domain/Domain-Name AVP is present, then content of Domain-Name is used.
Else if the Recipient-Address/Address-Domain/3GPP- IMSI-MCC-MNC AVP is present then content of 3GPP-IMSI-MCC-MNC AVP is used.
Otherwise, the following existing behavior is used: •For SMS call: Service-Information/SMS-Information/Recipients/Recipient-Address/Address-Data •For MMS call: Service-Information/MMS-Information/Recipient-Address/Address-Data •For IMS call: Service-Information/IMS-Information/Called-Party-Addres Assumption: The Recipient-Address AVP may appear multiple times.
Only the first Recipient-Address AVP Number Portability is checked.
For Recipient-Address/Address-Domain/Domain-Name and Recipient- Address/Address-Domain/3GPP-IMSI-MCC-MNC AVP, the number is obtained directly without checking the RN parameter (remove prefix ‘+’, remove realm).
Following are some examples of parsing with the CALL_COMMON.Routing-Number attribute: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.68Charging User Guide Call mangement Input Output routing number tel:+123610606025; npdi; rn=+12025440000; user= phone12025440000 sip:+917723000006; npdi; rn=1237@ ims.
mnc872.
mcc405.
3gppnetwork.
org;user= phone1237 Rule configuration example for MO-SMS/MMS calls The rule variable is required to determine call sub-type since only MO call is supported when checking the Routing number.
The routing number is obtained from SMS_CALL_ESTABLISHMENT and MMS_CALL_ESTABLISHMENT triggers.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.69Charging User Guide Call mangement The routing number information for number portability can be within any of the following AVPs under IMS- Information in the order of priority: 1.Number-Portability-Routing-Information: This is used to determine the routing number.
2.If the Number-Portability-Routing-Information is not present, then the Called-Party-Address or Application-Provided-Called-Party-Address AVP is used to determine the routing nunber.
Firstly, obtain the value from rn tagging (rn=xxx), then get the number between ‘+’ and the last character till you encounter ‘@’ sign or ‘;’.
This is used for actual MNP number.
3.If both the Called-Party-Address and Application-Provided-Called-Party-Address contains rn parameter, then Called-Party-Address has higher priority.
4.If the routing number cannot be determined, then the existing NCC behavior is followed.
Example of Called-Party-Address: sip:+353870999128;npdi;rn= +35317687@ ims.vendorname.ie ;user=phone Rule Configuration example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.70Charging User Guide Call mangement 3.
1.4 Differential charging for IMS calls This section provides information about various scenarios for differential charging in IMS calls.
Charging based on called party/calling party Calling Party number (CLG) and Called Party number (CLD) for a VoL TE calls are identified as specified in the following table.
Based on this, rules can be configured to set the calling and/or called party.
Differential charging can be configured based on the CLG/CLD set in rules.
Call type CLG CLD MOC Subscription- Id/Subscription- Id-Data Service- Information/ IMS- Information/ Called- Party- Address MTC Service- Information/ IMS- Information/ Calling- Party- Address Note : If Calling- Party- Address AVP appears multiple times, then the first one in the request is used for processing.Subscription- Id/Subscription- Id-Data FWD Service- Information/ IMS- Information/ Calling- Party- AddressService- Information/ IMS- Information/ Called- Party- AddressTable 10: CLG and CLD for different call types Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.71Charging User Guide Call mangement Call type CLG CLD Note : For call forwarding, the actual calling party is provided by this AVP, but the charging party is taken from Subscription- Id/Subscription- Id-Data .Table 10: CLG and CLD for different call types (continued) Figure 15: Example of CLG/CLD based charging Parsing CLG/CLD to E164 format If the incoming calling part address/called party addresses is in SIP/TEL format, then it must be converted to E164 format using rules.
For calling party address, the CALL_COMMON.Calling-Party condition is used to do the parsing.
It takes the value from the Calling-Party-Address AVP.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.72Charging User Guide Call mangement For called party address, the CALL_COMMON.Called-Party condition is used to do the parsing.
It takes the value from the Called-Party-Address AVP.
When the value in SIP/TEL format is converted to E164 format, the escape codes (+, -, and leading zeros) are removed from the number.
Following are some examples of parsing: SIP/ TEL URI Parsed E164 value sip:+919958882103; rn=9918872101@ Nokia.
host; npri= 888878798 919958882103 tel:+919958882103; rn=9918872101@ Nokia.
host; npri= 888878798 919958882103 sip:+915559343211; rn=9918872103@ Nokia.
host; npri= 888878798 915559343211 tel:+915559343211; rn=9918872103@ Nokia.
host; npri= 888878798 915559343211 Note : From the SIP/TEL URI, the value between the first colon (:) and the first semicolon (;) is picked for parsing.
If '@' appears before semicolon (;), then the value between the first colon (:) and '@' is picked for parsing.
Charging based on call sub-type Identification of call sub-type (MOC, MTC, or FWD) is done through rules based on the following logic: AVP Call sub- type Service- Information > IMS- Information > Role- Of-Node = 0 MOC Service- Information > IMS- Information > Role- Of-Node = 1 MTC Service- Information > IMS- Information > Role- Of-Node = 2 or Service- Information > IMS- Information > Role- Of-Node = 0 and Service- Information > MMTel- Information > Supplemantary- Service > MMTel- SService- Type= 6FWD The examples in the following figures demonstrate rules and tariff configuration for call sub-type based charging.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.73Charging User Guide Call mangement Figure 16: Example: IMS rules for call sub-type Figure 17: Example: Tariff configuration for call sub-type Charging based on call time Charging for IMS calls based on call time is done through rules.
The Service-Information > IMS-Information > SIP-Request-Timestamp AVP is used for time-based charging in IMS calls.
If the SIP-Request-Timestamp AVP is available, then the event timestamp is set with this value.
If the SIP-Request-Timestamp AVP is missing, then the event timestamp is set from the value of the Event- Timestamp AVP.
If the Event-Timestamp AVP is also missing, then the current platform time is used.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.74Charging User Guide Call mangement Figure 18: Sample rule for call-time-based charging First call for a device In the device entity, the isFirstCallDone variable determines whether a call is the first call for a device.
For the first call, this parameter can be set to true .
For subsequent calls, this parameter remains false .
Charging based on first call Differential charging for the first call for a device can be configured using the isFirstCall variable in the SPR_DEVICE source context.
The SPR_DEVICE.isFirstCall variable returns true for the first call.
For subsequent calls, this variable returns false .
Figure 19: Example: Tariff formula for differential charging based on first call Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.75Charging User Guide Call mangement Sending notification for the first call To send the notification for the first call for a device, rule in the threshold is as below: 1.Navigate to Charging → ☰ → Threshold profiles .
2.Create a new charging threshold or update an existing one.
3.In the applicability condition, provide the following condition and continue to the next step: SPR_DEVICE.Is-First-Call = true 4.Configure rule for an absolute start threshold as follows: 5.Configure a rule in charging service as follows: Destination-based charging Charging based on onnet or offnet IMS calls Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.76Charging User Guide Call mangement Differential charging for onnet and offnet IMS calls can be done through rules, using the IMS_SERVICE_INFO source context.
This source context is available for the following triggers: •IMS_CALL_ESTABLISHMENT •IMS_CALL_MODIFICATION •APPLICABILITY •TARIFF The following condition is used to check whether a call is onnet or offnet.
IMS_SERVICE_INFO.Is-OnNet = true The default number of starting digits for this condition is 6.
That is, if the starting six digits of the calling and called numbers are the same, then they are considered as onnet.
Otherwise, they are considered as offnet.
Note : +/- and leading zeroes are not considered as starting digits.
CLG CLD Onnet or offnet tel:+919999955555 tel:+919999954321 Onnet tel:+919999955555 tel:-919999954321 Onnet +529999955555 0529999954321 Onnet +529999955555 0000529999954321 Onnet +21669999955555 +66219999944321 Offnet +9999955555 -9999944321 Offnet +9999955555 09999944321 Offnet +19999955555 00009999944321 OffnetTable 11: Examples: Onnet or offnet based on CLG and CLD The default number of starting digits can be changed using the condition shown in the following example: IMS_SERVICE_INFO.Is-OnNet-Explicit-Check (3) = true Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.77Charging User Guide Call mangement The syntax for this context is IMS_SERVICE_INFO.Is-OnNet-Explicit-Check ("Calling_Party_STRING", Called_Party_STRING", Digits_For_Prefix_LONG) .
However, Calling_Party_STRING and Called_Party_STRING are optional.
The following figure provides an example rule for destination-based charging.
Figure 20: Example: Rule configuration for destination-based charging - onnet or offnet IMS calls Charging based on onnet or offnet SMS and MMS calls Differential charging for onnet and offnet SMS and MMS calls can be done through rules, using the GY_MESSAGE source context.
The following conditions are used to check whether an SMS or MMS is onnet or offnet: •GY_MESSAGE.Is-OnNet = True/False This value is taken from the Subscriber-Id and Recipient-Address AVPs.
•GY_MESSAGE.Is-OnNet-Explicit-Check ( "Calling_Party_STRING", Called_Party_STRING", Digits_For_Prefix_LONG ) = True/False Similar to IMS calls, for SMS and MMS also, the default number of starting digits for this condition is 6.
That is, if the starting six digits of the calling and called numbers are the same, then they are considered as onnet.
Otherwise, they are considered as offnet.
Note : +/- and leading zeroes are not considered as starting digits.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.78Charging User Guide Call mangement Figure 21: Example: Tariff configuration for destination-based charging - onnet or offnet SMS or MMS calls Charging based on country of called party Differential charging based on country code of the called party can be done through rules, using the IMS_SERVICE_INFO source context.
The Called-Party-Address AVP extracts the country code, which is mapped to find the destination country name.
Charging is based on the country name through tariff rule.
For differential charging based on called country, the Called-Party-Country value is available in the CALL_COMMON source context.
The Called-Party-CC of IMS_SERVICE_INFO source context is available for the following triggers: •IMS_CALL_ESTABLISHMENT •IMS_CALL_MODIFICATION •IMS_CALL_TERMINATION •APPLICABILITY •TARIFF •THRESHOLD The following table provides the list of the standard one-digit and two-digit country codes.
These country codes are predefined in NCC.
For three-digit country codes, a complex map must be created.
Note : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.79Charging User Guide Call mangement Complex map cannot be used for one-digit and two-digit country codes.
Country Code Country Name Country Code Country Name 1 USA 54 Argentina 7 Russia 55 Brazil 20 Egypt 56 Chile 27 South Africa 57 Colombia 30 Greece 58 Venezuela 31 Netherlands 60 Malaysia 32 Belgium 61 Australia 33 France 62 Indonesia 34 Spain 63 Philippines 36 Hungary 64 New Zealand 39 Italy 65 Singapore 40 Romania 66 Thailand 41 Switzerland 81 Japan 43 Austria 82 Korea 44 UK 86 China 45 Denmark 90 TurkeyTable 12: Predefined one-digit and two-digit country codes and corresponding country names Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.80Charging User Guide Call mangement Country Code Country Name Country Code Country Name 46 Sweden 91 India 47 Norway 92 Pakistan 48 Poland 93 Afghanistan 49 Germany 94 Sri Lanka 51 Peru 95 Myanmar 52 Mexico 98 Iran 53 Cuba - -Table 12: Predefined one-digit and two-digit country codes and corresponding country names (continued) Example: Configuration for pre-defined country code Existing country codes are defined in NCC.
The following figure provides an example tariff formula for differential charging based on predefined country codes (available in Predefined one-digit and two-digit country codes and corresponding country names on page 80).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.81Charging User Guide Call mangement Figure 22: Example: Charging based on Called-Party-Address Example: Configuration for new country code If the operator wants to add a new three-digit country code, it must define it in a complex map and then use it in rules.
1.Navigate to Charging → ≡ → Mapping tables and define a map with key value pares for country name and country code respectively.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.82Charging User Guide Call mangement 2.Use the map name to create a rule variable in the IMS_CALL_ESTABLISHMENT trigger.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.83Charging User Guide Call mangement 3.Use the rule variable in a rule group.
Access-Network-Information (ANI) AVP The Access-Network-Information AVP (AVP code 1263) is of type OctetString and indicates one instance of the SIP P-header P-Access-Network-Info .
In SIP, as per RFC 7315 [404], the content of the P-Access- Network-Info header is known as the access-net-spec.
When multiple access-net-spec values are transported in a single P-Access-Network-Info header in comma-separated format, then multiple Access-Network-Information AVPs are used with one access-net-spec value included in each AVP.
Charging based on ViL TE rating group The VoL TE or ViL TE correlation support over the Diameter 4G interface uses the ViL TE Rating Group system parameter that identifies the ViL TE call over the Gy interface.
However, this functionality is disabled when the ViL TE Rating Group is set as -1.
Otherwise, this functionality is enabled and the configured value is considered as per the rating group of a ViL TE call.
This functionality enhances the capability of L TE Video Call (L TC) for performing smooth transition between voice and LVC.
The hard-stop of a volume limit over ViL TE call is checked when a video call is received over the IMS Ro interface and the ViL TE Rating Group system parameter is enabled.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.84Charging User Guide Call mangement The volume quota is checked over ViL TE call and the following conditions are considered to check the hard- stop limit of volume: •All volume buckets are exhausted.
•The hard-stop limit is reached over a counter, either due to the Reject threshold action or when the maximum limit of a counter is reached.
•No volume resources are available to rate and charge any rating groups when it comes over the Gy interface.
•The account balance is not available to rate and charge any rating groups when it comes over the Gy interface.
•A Usage Control (UC) limit is reached for a device.
•PL or DL check is preformed.
•A Time of Day (TOD) check is performed.
•Minutes allowance (when time bucket is available).
•This rating group is not present in a Gy request on a Ro interface, but when it is an LVC call and the ViL TE Rating Group system parameter is configured similar to that in a rating group to check the data allowance.
The same rating group is present in the Gy request.
When a CCR message is received over the Gy interface containing the rating group for a ViL TE call, the hard- stop limit is checked.
If the hard-stop limit is reached, then it responds with a result code 2001 in a CCA message over the Gy interface and a RAR message is triggered for all active IMS Ro sessions.
When a RAR message is sent over the IMS Ro interface, it leads to the arrival of CCR-U(s) message from TAS.
Whereas, on the arrival of CCR-U message, the hard-stop limit of volume to be checked and if the hard-stop limit is reached, then the video call is responded with result code 2001 at root level and result code 4012 at MSCC level.
The Ro and Gy sessions are not terminated and a CCR-U message is returned from TAS for a voice call, which means transition of video call to voice call, and a CCR-T message from PGW for the Gy session.
Note : Following conditions are assumed: •VoL TE or ViL TE calls are running over Diameter 4G interface and only a single MSCC is supported in an IMS call.
•Only one type of voice media is supported and there is no differentiation between HD or non- HD voice.
•This functionality is applicable to originating, terminating, and forwarding a ViL TE call.
However, starting a new call during an update or terminate operation is not supported for an IMS call.
•There are no retries of RAR, which means in case of any failure, a subscriber would continue to have video call for a short duration till next CCR-U request is received over the IMS Ro interface.
•The CALL_COMMON and Gy_MESSAGE are supported in rules for Gy estimation.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.85Charging User Guide Call mangement •When IMS call returns a result code 4012 or 5031 in CCR-U message, then the validity time value is picked from the Ims session inactivity duration .
•For a soft limit Gy call, the validity time is picked from the Validity Time defined in the quota management profile (slicing profile).
ANI or cell-based charging Location of the subscriber is determined using the Service-Information > IMS-Information > Access- Network-Information AVP.
Decoding of Access-Network-Information AVP is done to extract relevant information.
The decoding takes into consideration the fact that MNC can either be of two digits or three digits in length.
The decoding separates all information of ANI AVP, for example, MCC, MNC, LAC CI, and this information is available for use in rules and custom data.
If the ANI AVP appears multiple times, the first one is considered for processing.
In the example described in the following figure, the following conditions are used to detect EUTRAN and GERAN calls.
IMS_SERVICE_INFO.RAT-TYPE = RATType3Gpp_EUTRAN IMS_SERVICE_INFO.RAT-TYPE = RATType3Gpp_GERAN Figure 23: Sample rule for cell-based charging Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.86Charging User Guide Call mangement Roaming-based charging Roaming is determined based on complex map using MCC and MNC AVP extracted from the ANI AVP.
Roaming information is then used in rules to decide on charging based on roaming location.
Figure 24: Sample complex map for roaming configuration Figure 25: Sample rule variable for roaming Figure 26: Sample rule for roaming For termination calls, the ANI AVP may not be present in the CCR-I.
In this case, the original user location for the terminating call from first CCR-U is considered, if available, irrespective of whether the triggered Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.87Charging User Guide Call mangement feature support is turned on or off, and whether location change trigger is included or not.
This value is set in the origUserLocationInfo CDR tag.
For example, if CCR-I ANI AVP includes a value a, and the first CCR-U ANI AVP includes a value b, then the value of the origUserLocationInfo tag in CDR is as follows: •for CCR-I: the value is a •for CCR-U1: the value is b Media-based charging The media type is determined through rules.
The media type used for the call (whether initial or at media change) is read from the AVP Service-Information > IMS-Information > SDP-Media-Component > SDP- Media-Name .
The following media types are only supported for the VoL TE calls: Media type AVP value format Audio audio 49170 RTP/ AVP 0 Video video 49170/ 2 RTP/ AVP 31 The first string in the AVP value is the media type for the call.
If there are multiple SDP-Media-Name AVPs in the CCR message with both audio and video media names, then the call is considered as a video call.
If SDP- Media-Component AVP is not present, then the media is considered as audio.
Figure 27: Sample rule for media-based charging Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.88Charging User Guide Call mangement Charging based on closed user group calls If both the calling party and called party are part of the same closed user group (CUG), then the call is an in- group call.
Otherwise, the call is an out-group call.
Differential charging can be configured for in-group/out- group calls, for voice, SMS, and MMS.
CUG call is checked only if the call is onnet.
The Cug_Groups attribute in the CALL_COMMON source context configures differential charging based on in-group or out-group calls.
This attribute is available for the following triggers: •APPLICABILITY •TARIFF •THRESHOLD The application preference CUG Based Charging Applicability is used to enable or disable the feature.
It has possible values as 0, 1, 2 and the default value is 0.
See charging application preferences for details.
The cugGroups has the group IDs of the common groups of the calling party and the called party (as shown in the following figure).
Figure 28: CUG groups in SM GUI Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.89Charging User Guide Call mangement Figure 29: Example: Tariff formula for CUG calls The CDR parameter CugGroups is added to the CDR and contains the list of CUG groups of the called and calling party under the following conditions: 1.The CugGroups is enabled in application preference.
2.The calling and called parties contain any common groups.
3.
1.5 Account activation and language update Volte interface between TAS and CHF focus on the Diameter Ro for VoL TE rating and charging control.
When an account is found to be in a specific lifecycle state and need activation during IMS session, a prompt and collect process is invoked to perform language selection and trigger lifecycle event to activate the account.
Following are the call flows: Scenario 1: Normal successful P&C for service setup - collect language for activation Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.90Charging User Guide Call mangement Scenario 2: Successful P&C for service setup after retry twice - collect language for activation Scenario 3: Failure P&C for timeout Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.91Charging User Guide Call mangement The prompt and collect parameters are set through ruleset and carried back to TAS in the CCA message.
Following are examples for rule configuration: IMS_CALL_ESTABLISHMENT ruleset for PROFILE_UPDATE event request IMS_CALL_ESTABLISHMENT ruleset for P&C Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.92Charging User Guide Call mangement IMS_CALL_MODIFICATION ruleset add Rule Variables: CollectDigits rule0 ----- successfully collected digits Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.93Charging User Guide Call mangement rule1 – need re-prompt rule2 – collected failure Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.94Charging User Guide Call mangement IMS_CALL_TERMINATION ruleset add Rule Variables: CollectDigitsTer rule0 - successfully collect digits Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.95Charging User Guide Call mangement rule1 - failed scenario 3.2 5G online call support 3.2.
1 NCHF (5G) online charging NCC provides 5G Nchf_ConvergedCharging interface to support interworking with a 5G PGW (SMF).
NCC supports 4G, L TE, or VoL TE traffic simultaneously with 5G traffic.
It can act both as an OCS and a CHF.
In this release, NCC supports Nchf_ConvergedCharging only for data charging.
A 5G NCHF call is identified by Service-Context-Id = 5G_32251@3gpp.org and Call-Type = NCHF_CHARGING .
NCC supports the following specifications for N40 interface: •N40 December 2020 JSON specifications (3GPP 32.291 V16.6, V3) •V15.5, V2 (responded with release 16 V3 JSON APIs only) Note : •Internally, AUTH-APPLICATION_ID = 40 •session-id formats are the same as used for N7 and N28.
•Custom attributes (if any) in the HTTP request are ignored, and no errors are returned.
•For supported result codes, refer to 5G result codes on page 2271 .
•5G SMS/MMS calls are not supported.
•5G attributes are supported only through rules (these are not provided as part of the application).
•Terminate request does not return any error.
NCC always returns success for Gy.
•timeQuotaThreshold and unitQuotaThreshold attributes are not available in existing rule logic and slicing rule.
These attributes are not included and verified in 5G response.
•In N40 notify request, the default value (that is, ONLINE_CHARGING ) is sent in QuotaManagementIndicator attribute.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.96Charging User Guide Call mangement •Currently none of the supported features for N40 are present in NCC implementation.
The supportedFeature attribute value returns as null, that is, after negotiation this attribute is not sent in the response.
•NCC CHF supports release 15 V2 and release 16 V3 versions of NCHF_ConvergedCharging together in parallel.
•NCC CHF discontinued/stopped the support of version (V1) API.
•Support for supportedFeatures attribute: –Nchf_ConvergedCharging/Nchf_SpendingLimitControl create request contains an attribute supportedFeatures (string) containing a bitmask to indicate supported features in hexadecimal representation.
–NCC does not support supportedFeatures for 5G.
Therefore with this requirement we need to build up a framework that would be applicable for 5G interfaces.
For now it would be for N40 and N28.
•Support for retransmissionIndicator attribute: –In N40 V3 requests, a new optional attributed retransmissionIndicator is added, which indicates the retransmission of an request message.
–For V3 requests if retransmissionIndicator is true then the application preference Enable Duplicate NCHF Request Handling has no significance.
Limitations •New sub-attributes of UserLocationInfo are not supported in CDR.
•Nokia Charging Gateway Function (CGF) only supports P1 attributes in CDR.
SMSCharging and qoSCharacteristics of roamingQBCInformation and eventTimeStamps attributes of P1 are not supported in CDR.
•3gpp-Sbi-Message-Priority header was earlier supported as string value type.
Now it is of integer value type and REST headers are of of String type.
Assuming no rules were present for 3gpp-Sbi- Message-Priority , RSV upgrade/downgrade is not done for this in this release.
•The following attributes are not supported in rules: Attribute Remark SMSCharging Information Rule available ( only for non- complex attributes) .
Location Reporting Charging InformationRule not supported.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.97Charging User Guide Call mangement Attribute Remark NSMCharging Information Rule not Supported.
NSPACharging Information Rule Not Supported.
NSPAContainer Information Rule Not Supported.
Management Operation Rule not Supported.
Management Operation Status Rule not supported.
User Location Info Newly introduced sub- attriutes in user Location Info are not supported in rule.
Rule triggers The following triggers are available for 5G calls: •NCHF_CHARGING_CALL_ESTABLISHMENT : Trigger applied to 5G session establishment request.
•NCHF_CHARGING_CALL_MODIFICATION : Trigger applied to 5G session modification request.
•NCHF_CHARGING_CALL_TERMINATION : Trigger applied to 5G session termination request.
For details on source contexts and attributes, refer to Source context to rule attribute mapping on page 375.
CHF NF services Service Name Service Operations Operation Semantics Mapping to internal operations ( Gy) Create Request/ Response CCRi or CCA Update Request/ Response CCRu or CCANchf_ Converged Charging Release Request/ Response CCRt or CCATable 13: NF services provided by the CHF Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.98Charging User Guide Call mangement Service Name Service Operations Operation Semantics Mapping to internal operations ( Gy) Notify Notify RAR/ RAATable 13: NF services provided by the CHF (continued) 3.2.2 N28 (5G Sy) interface NCC supports charging for N28 interface with AUTH-APPLICATION_ID = 167773025 .
NCC CHF supports the following specifications: •N28 V16.6 (December 2020) JSON specifications (3GPP TS 29.594 V16.6, V3) •N28 V15.5, V2 (with R15 V2 JSON APIs only) Note : •Nchf_SpendingLimitControl_Notify (terminate) is not supported.
•Internally, Nchf_SpendingLimitControl_Subscribe is mapped to SLR, Nchf_SpendingLimitControl_Unsubscribe is mapped to STR, and Nchf_SpendingLimitControl_Notify is mapped to SNR.
N28 session is internally mapped as Sy session.
•5G specific parameter Supported features (optional) is sent in SLA/SNR as received in SLR.
There is no functional support of this parameter in NCC and its value is sent back as received from SLR.
•Only basic HTTP result codes are supported as 200, 201, 204, and 400.
•The N28 interface is tested with HTTP/HTTPS.
It has not been tested with HTTP2.
•The 29.594 release 16.4 contain two new application features, as well as support for the supported features capability: –Expiry Time support (P2) –Notification Correlation (P3) Limitations 3gpp-Sbi-Message-Priority header was earlier supported as string value type.
Now it is of integer value type and REST headers are of of String type.
Assuming no rules were present for 3gpp-Sbi-Message- Priority , RSV upgrade/downgrade is not done for this in this release.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.99Charging User Guide Call mangement Multiple session handling Both 4G and 5G sessions can co-exist for a single device.
There can be multiple Sy/N28 sessions for one device, up to a limit, as defined in the application preference Max Sy Session Limit .
If the configured Max Sy Session Limit is reached, new 4G Sy sessions are rejected with result code 4002, and 5G Sy sessions are rejected with result code 400.
3.2.3 Nchf_ConvergedCharging AMF (N41) interface Post Event Charging over HTTP from AMF Post Event Charging (PEC) generates the CDR after the call has occurred.
It does not perform rating and charging.
Identification of 5G PEC call •If the request has the OneTimeEvent as true , and OneTimeEventType as PEC, then it is a PEC call.
•NCC supports PEC call for both known and unknown devices.
•For a known and unknown device, success PEC CDR is generated with AMF Charging HTTP parameters (RegistrationChargingInfo , N2ConnectionChargingInfo , LocationReportingChargingInfo ).
Important points •Rules are not supported for a PEC call except for the Inbound Roamer Agreement scenario.
For details on this scenario, refer to Support for Inbound Roaming on page 114.
•If any AMF HTTP parameter ( RegistrationChargingInfo , N2ConnectionChargingInfo , LocationReportingChargingInfo ) is present in the request and the value of roamerInOut HTTP parameter in each AMF HTTP parameter is IN_BOUND , then the Inbound Roamer agreement is checked.
•If any one of AMF Charging HTTP parameters are present with the value as OUT_BOUND , then the Inbound Roamer agreement is not validated.
•It is a rare scenario where NCC receives all three AMF HTTP parameters in a single request.
•When the Inbound Roamer agreement is not valid for an unknown device, an error PEC CDR is generated with the error code 403.
This CDR includes information about the AMF Charging HTTP parameters ( RegistrationChargingInfo , N2ConnectionChargingInfo , LocationReportingChargingInfo ).
IEC (without MUU) over HTTP from AMF IEC provides rating, credit checks, balance management and CDR generation.
The following events can be charged with an IEC call: •Registration charging event •N2Connection charging event •Mobility charging event Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.100Charging User Guide Call mangement Identification of 5G IEC call •If the request has OneTimeEvent as true and OneTimeEventType as IEC, then it is considered as an IEC call.
•The request consists of the RegistrationChargingInformation , LocationReportingChargingInformation , and N2ConnectionChargingInformation .
•If MUU is not received in the request, a dummy MUU is created in the request message.
•The dummy MUU is set to a pre-configured rating group whose information is taken from the application preference Default AMF Charging RGs .
•Default AMF Charging RGs is a string, which consists of comma-separated rating group values.
The default value is [NA,NA,NA].
The first, second, and third values correspond to the RegistrationChargingInformation , N2ConnectionChargingInformation , and LocationReportingChargingInformation respectively.
Note : It is not mandatory to add all the values for the application preference.
•If the value for a rating group is NA, then the information corresponding to that value is not processed in the call even if it is present in the request.
For example: If the request message has registrationChargingInformation , but the value of Default AMF Charging RGs is [NA,2,3], then the registrationChargingInformation is not processed in the call.
Note : NCC processes only the first three values (comma-separated) of this application preference.
•The values of the application preference Default AMF Charging RGs can be configured based on the events to be charged.
For example: If the value is set to [2, NA, NA], then only the registration charging event is considered for charging.
•The buckets for charging the events should be of type unit.
Note : If the bucket type is not unit, then the Rating failed error occurs.
IEC over HTTP from AMF Decentralized Decentralized calls work like normal NCHF (5G) charging calls.
Centralized Requests received without RSU or with empty RSU are treated as centralized calls.
In centralized 5G calls for AMF nodes, the slice size is charged only in SERVICE_SPECIFIC unit (from the corresponding charging services) if the requests consist of added chargingInformation .
AMF specific rules must be provided in slicing profile.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.101Charging User Guide Call mangement For 5G calls, allocation of units (during reservation) happen in all-or-nothing mode.
That is, either the entire RSU is allocated (if available from all applicable resources), or user gets nothing (if not available in all applicable resources) and the error Not Enough Credit is returned.
For IEC AMF Calls, slice reduction logic works similar to the SMS (Diameter) call.
Single CDR If Enable-Single-CDR is present in NCHF_CHARGING_CALL_ESTABLISHMENT then a single CDR is generated on call termination.
For this, single CDR must be configured in rules as follows: Common behavior for AMF/NEF Note the following points about updating the result code in 5G charging calls for AMF and NEF node functionality: •Result code and root result code are not updated.
•If all the MUU(s) fail with same reason/result code in the response, then the failed result code (of MUU) is set in the root result code.
•If in response all MUU(s) fail with different reason/result code in the response, then RATING_FAILED (that is, result code 4012 ) is set in the root result code.
Note : •Currently, only a single UUC is supported for IEC charging for AMF/NEF.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.102Charging User Guide Call mangement •Rating and charging for the rest is done as normal N40 Nchf calls.
Additional information: Note the following points about updating the result code in OneTimeEvent/IEC in 5G charging calls: •Result code and root result code are not updated.
•If all the MUU(s) fail with same reason/result code in the response, then the failed result code (of MUU) is set in the root result code.
•If in response all MUU(s) fail with different reason/result code in the response, then RATING_FAILED (that is, result code 4012 ) is set in the root result code.
3.2.4 Nchf_ConvergedCharging NEF (N44) interface Post Event Charging over HTTP from NEF Post Event Charging (PEC) generates the CDR after the call has occurred.
It does not perform rating and charging.
Identification of 5G PEC call •If the request has the OneTimeEvent as true , and OneTimeEventType as PEC, then it is a PEC call.
•NCC supports PEC calls for both known and unknown devices.
•For a known or unknown device, success PEC CDR is generated with NEF Charging HTTP parameter (NEFChargingInformation ).
The CDR tag for it is exposureFunctionAPIInformation .
Important points •Rules are not supported for a PEC call except for the Inbound Roamer Agreement scenario.
For details on Inbound Roamer Agreement scenario, refer Support for Inbound Roaming on page 114.
•When the Inbound Roamer agreement is not valid for an unknown device, an error PEC CDR is generated with the error code 403.
This CDR includes information about the NEF Charging HTTP parameter ( NefChargingInfo ).
IEC (without MUU) over HTTP from NEF IEC provides rating, credit checks, balance management, and CDR generation.
The NEF charging events can be charged with an IEC call.
Identification of 5G IEC call •If the request has OneTimeEvent as true and OneTimeEventType as IEC, then it is considered as an IEC call.
•The request consists of the NEFChargingInformation .
•When MUU is not received in the request, a dummy MUU is created in the request message.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.103Charging User Guide Call mangement •The dummy MUU is set to a pre-configured rating group whose information is taken from the application preference Default NEF Charging RG .
•Default NEF Charging RG is a string which consists a single rating group value.
The default value for Default NEF Charging RG is [NA].
The value corresponds to the NefChargingInformation .
•If the value for a rating group is NA, then the information corresponding to that value is not processed in the call even if it is present in the request.
For example, if the request message is has NefChargingInformation , but the value of Default NEF Charging RG is [NA], then the NefChargingInformation is not processed in the call.
•The buckets for charging the events should be of type unit.
Note : If the bucket type is not unit, then the rating failed error occurs.
IEC over HTTP from NEF Decentralized Decentralized calls work like normal NCHF (5G) charging calls.
Centralized Requests received without RSU or with empty RSU are treated as centralized calls.
In centralized 5G calls for NEF node, the slice size is charged only in SERVICE_SPECIFIC units (from the corresponding charging services) if the requests consist of chargingInformation .
NEF specific rules must be provided in slicing profile.
For 5G calls, allocation of units (during reservation) happen in all-or-nothing mode.
That is, either the entire RSU is allocated (if available from all applicable resources), or user gets nothing (if not available in all applicable resources) and the error code Not Enough Credit is returned.
For IEC NEF Calls, slice reduction logic works similar to the SMS (Diameter) call.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.104Charging User Guide Call mangement Single CDR If Enable-Single-CDR is present in NCHF_CHARGING_CALL_ESTABLISHMENT then a single CDR is generated on call termination.
For this, single CDR must be configured in rules as follows: 3.2.5 Support for SCP This feature is required in SCP (or Service Communication Proxy) integration and resolution of FQDN and addresses for SMF and PCF, which may have retry scenarios.
An SCP is a server that resides between 5G NF to allow routing of messages into the respective service meshes that exist within each Containerized Network Function.
The SCP management falls under the following major areas: 1.Define an SCP address (which is a virtual FQDN address) that can be used to store the SCP location in a way used for processing.
2.Process and store the callback URI based on the values received, and use the FQDN resolution to determine the actual address to use in messages, whereas, the paired value is used in failed scenarios.
3.Process responses and notify messages and population of the content of the Location Header based on the addresses managed in the previous two points.
The DNS based resolution of FQDNs for 5G functions is configured with the following parameters in the Helm chart: •charging.enableVfqdnResolution •charging.destinationRecoveryRetryTimeoutMs •charging.reqTrackWndSizeForDNS •charging.accFailRateForDNS The parameters are described within the Helm chart in the Readme file.
To enable the DNS based resolution of FQDNs for 5G functions, configure the parameters in the values.yaml .
You can configure the parameters during installation when you prepare the input for the Helm charts or after you installed CNF NCC using helm upgrade command.
By default, the feature is disabled.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.105Charging User Guide Call mangement 3.2.5.
1 Configuration To configure this feature, enable the following two application preferences available at ME and CHF router level to store the SCP address network function: •SMF SCP : This application preference holds the SCP address for notify requests towards SMF.
•PCF SCP : This application preference holds the SCP address for notify requests towards PCF.
Note : Real SCP is configured with its complete URL (including scheme, authority, and port).
The virtual SCP is configured with scheme and vFqdn.
It is suggested to configure scheme as Http on CNF based setup.
3.2.5.2 Additional information Following are some important points to note for this functionality: •If CHF router is configured, then SCP selection is done by reading the application preference at CHF router; otherwise, it is done at ME.
This is done to facilitate router-wise selection of SCP.
•While sending request from ME to CHF router, the Network Function and Session Id is set in header attributes.
•The Network Function header attribute indicates the CHF router which application preference is to be read for sending the request to the corresponding Network Function.
•Session Id is passed to CHF router to specify in logs.
•The hostURI header attribute received at CHF router contains the NotifURI , which extracts the Notif URI authority and set in 3GPP-SBI-Target_APIRoot header attribute.
•The request is then sent by router to the SCP (which is, SCP Authority + Notif URI path ).
Note : Irrespective of main call or retry calls, only the above selected attributes are considered.
The final values of Notif URI (as per retry count) and CHF router (as per retry count) are not impacted by this feature.
3.3 Offline call support If the required configurations are done, offline charging is performed irrespective of whether a device, account, or subscription is in the Barred state or not.
In case of offline charging, the usage is only recorded in CDRs; it is not applied to a device or its subscriptions.
3.3.
1 Allow specific rating groups without counting usage for access barred devices This feature is applicable to Gy and N40 interfaces.
After configuring the offline rating group values in a rule (RSV), if a Gy call has the same rating group value that is configured in the rule, then this Gy (data or PS) call is processed as offline charging.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.106Charging User Guide Call mangement For a 5G Nchf request, the rating group of muu matched with the offline rating groups is configured in RSV, and if one of the following condition is met: •The quotaManagementIndicator attribute value for that muu is ONLINE_CHARGING , or •uuc is not present and requestedUnit is present, Then, the 5G Nchf request is treated as offline charging.
Note : •When the rating group value in a Gy or Nchf call request matches the configured offline rating group value in a rule, then a Gy session is created in the database; but no rating session is created in the database as rating logic is not processed for offline charging.
•If a rating group value does not match with the configured offline rating group value in rule, then the Gy (data or PS) request is processed as online charging.
For a 5G Nchf request, if a rating group value does not match with the configured offline rating group value in rule, and if either the quotaManagementIndicator attribute value for that muu is ONLINE_CHARGING or uuc is not present, then the 5G Nchf request is treated as online charging.
•If a Gy (data or PS) call comes with Service-Identifier and without a rating group, then this request is processed as online charging and a rating session is created.
•A Gy (data or PS) call and 5G Nchf request can be processed as offline, online, or both, which is termed as mixed charging.
•The offline MSCCs or MUUs are not rejected for barred device.
•In a mixed or offline (MSCC or MUU) charging, if there is even a single offline success MSCC or MUU present in response, then command level result code is SUCCESS .
Configuring this feature To configure the offline rating group feature that allows specific rating groups without counting usage for access barred devices,create the following rule in the GY_CREDIT_REQUEST : SESSION_PARAMETERS.Offline-Rating-Group = [100, 200, 300, 400, 500] where 100, 200, 300, 400, and 500 are the values for rating group of MSCC.
Similarly, you can configure the desired values for your rating group that must be considered as offline rating group: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.107Charging User Guide Call mangement Following table provides details on Offline-Rating-Group parameter: Action parameter Value Name Offline- Rating- Group Value Type Base Value Type Allow Multiple Values Multiple values are allowed separated by ( ,) comma Occurrence Single Result Context SESSION_ PARAMETERS Rule Set GY_CREDIT_ REQUESTTable 14: Offline-Rating-Group parameter Configuring VT/QHT/VQT/GSU for 4G/5G offline charging 1.Validation on VT and QHT will be same as for online charging.
For example, if a rule in the quota management profile (slicing profile) is configured without VT, then the rule is considered as invalid and rule's values are not considered; therefore, the default values are considered.
2.GSU and VQT values are populated according to the following formula: Let us consider that the quota management profile (slicing profile) is configured with Slice-Size = 200 and Volume-Quota-Threshold = 50, then the GSU or VQT values are sent in CCA based on the VQT type configuration as follows: a.If VQT type is configured as FIXED_ADD_GSU , then the following GSU/VQT values are sent in CCA: GSU = 250 (slice size + VQT value) VQT = 50 (VQT value configured in slicing profile) b.If VQT type is configured as PERCENTAGE or not configured, then the following GSU/VQT values are sent in CCA: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.108Charging User Guide Call mangement GSU = 200 (slice size) VQT = 100 (VQT % of slice size) If VQT value is greater than 100, then GSU will be 100% of slice size.
3.Service unit type is to be set as default value CC-Total-Octets in GSU irrespective of any type coming in the request.
4.The following Is-Offline attribute checks whether the MSCC is offline or not.
Attribute name Source context Rule set Multiple- Services- Credit- Control.
Is- OfflineGY_MESSAGE SLICING_ PROFILE MUU.
Is-Offline NCHF_ CHARGING_ MESSAGE SLICING_ PROFILE 5.The following source contexts are considered to evaluate rules in the quota management profile (slicing profile) in case of offline charging: •NCHF_CHARGING_MESSAGE •SPR_DEVICE •SPR_GROUP •GY_MESSAGE 6.Only one group is supported for the SPR_GROUP source context.
If the device is attached to multiple groups, then the first group is fetched from the list.
The first group fetched is considered for the SPR_GROUP source context and other groups are ignored.
3.3.2 Converged offline charging over standard 5G Nchf_CC interface This feature is applicable to N40 interface.
A 5G Nchf request is processed as offline charging in the following scenarios: •In usedUnitContainer , the attribute quotaManagementIndicator has the value OFFLINE_CHARGING •In usedUnitContainer , the attribute quotaManagementIndicator is not present.
Note : •An Nchf request can be processed as offline, online, or both (that is, mixed charging).
•If an Nchf request is processed as offline charging, then multipleUnitInformation is not sent in response and only CDRs are generated.
The call gets successful with other Nchf response parameter.
•If mixed (offline + online) charging MUUs are present in an Nchf request, then only multipleUnitInformation contains the online MUU in response.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.109Charging User Guide Call mangement •Offline MUUs are not rejected for barred device.
•In mixed or offline MUU, even if a single offline success MUU is present, then command level result code is SUCCESS .
3.3.3 Support for IoT devices with offline charging where no specific device record exists This feature enables the charging of devices that are provided using the session-based interface from the SMF in offline mode, where it is required to both generate a CDR and apply rating to the request in order to ascertain a rated CDR output with a cost.
This cost may not be charged to an explicit end user, but instead may reflect a wholesale cost, or a cost to the OTT provider of the device, such that NCC is then able to provide rated outputs for unknown device inputs.
The following flow diagram shows an example on how this can be implemented, where the CHF decides whether to invoke rating or not before invoking the CGF (DR) for CDR generation.
Identification of IoT call Following are the steps to identify if received requests from SMF/AMF/NEF is IoT devices call.
•For input request, first the Device is identified.
If it is not found and the call is not of inbound or assume positive type, then DEVICE_NOT_FOUNT trigger is executed.
•In DEVICE_NOT_FOUNT trigger, a rule is configured to read a complex map and match one of its key with the received 5G create/update/terminate request parameters like Subscription-Id (SUPI, GPSI, ..etc) or other request parameters like MCC/MNC.
If a match is found, CALL_RESULT result context is set to one of the complex map keys that stores Device Profile name.
This way an unknown device is mapped to a Device Profile .
•If Device Profile mapping is found, then the call is treated as IoT device call.
On the basis of the output (Device Profile/CDR_type) of mapping rule, IoT call is processed as offline UNRATED/RATED call.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.110Charging User Guide Call mangement Configuration The following figure shows an example configure mapping table for mapping IMSI range to Device Profile (Global Group).
The following action attributes are used to configure this feature: •CALL_RESUL T.CDR-Type = CDRType_RATED •CALL_RESUL T.Device-Profile = "GlobalGroup1" The following figure shows an example of rule configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.111Charging User Guide Call mangement CDR for IoT devices with offline charging Refer to section IoT devices with offline charging in CDR/EDR Reference for more information.
Error scenarios At root level, result code is Success.
At MUI level, the error codes appear as described in the following table: Scenario Result code If device profile ( Group) is found but it has no subscriptions attached or the attached subscriptions are in barred state.END_ USER_ SERVICE_ DENIED If device profile ( Group) is attached with subscription, but no rate was identified in tariff rule.RATING_ FAILED Group is attached with subscription, rate is identified in tariff rule, but identified rate has type different than the requested type ( USU type) .END_ USER_ SERVICE_ DENIED Group is attached with subscription, rate is identified in tariff rule, but Bucket provided in rate is non- monetary bucket.RATING_ FAILEDTable 15: Error result code at MUI level in IoT call Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.112Charging User Guide Call mangement Limitations •Requests from IoT Device come only through N40 interface in session-based charging requests (NCHF_CC_Create/Update/Delete).
•All requests (Create/Update/Release) contain the information (for example, imsi, supi), which is needed to map the incoming sensor to a device profile.
•If assume positive is enabled for customer, then this feature is not used.
Rather assume positive behavior is used.
•Global group hierarchy is not traversed for finding the bundles and charging services.
Only the subscriptions that are attached directly to global group (device profile) are considered.
•Tariff output only for Rate is considered to calculate the call cost for rated offline CDRs.
•Only a single pass is traversed to calculate the call cost for rated offline CDRs.
•IoT device calls are not supported in NCHF-Router environment.
3.3.4 Offline CDR generation for 5G inbound roaming Inbound roaming refers to allowing subscribers from other operators to access the home network.
This section provides information about the configurations required to allow 5G inbound roamers to home network.
Rating and charging are not done for the inbound roamer.
However, appropriate CDR is generated for the call.
Identification of 5G inbound roamer For an incoming request if the device is available in NCC, then the call is processed as a normal call.
4G calls are rejected with error 404 - Unknown Subscriber .
If the device is not available in NCC and the call is identified as 5G, and if the parameter / pDUSessionChargingInformation/userInformation/roamerInOut has the value IN_BOUND , then the call is further processed on the basis of the application preference Support for Inbound Roaming .
Application preference The application preference Support for Inbound Roaming is used to allow, deny, and configure the call processing.
Refer to the following table for its valid values and descriptions.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.113Charging User Guide Call mangement Value Enabled/ disabledDescription 0 Disabled ( default)The call is rejected with error 404 - Unknown Subscriber .
1 Enabled A roaming agreement can be configured in a complex map ( see Complex map configuration on page 115).
The call is processed/ rejected on the basis of the availability of the HPLMN ID ( MCC- MNC) of the device in the roaming agreement as follows: •Available: The call is processed.
•Not available: The call is rejected with error 403.
The incoming call is barred for the inbound roamer.
The request parameter /pDUSession Charging Information/ pduSession Information/ hPlmn Id carries the HPLMN ID ( MCC- MNC) of the device.
2 Enabled The call is processed.
The roaming agreement does not matter.
Complex map or rule configuration is not required as described in the following sections.
Inbound roaming facility is enabled for all inbound roamers irrespective of their HPLMN ID ( MCC- MNC) .
3 Enabled The call is processed if it is an inbound roaming call.
The same logic as applicable for value 2 is followed.
For N40 requests where the device identity is unknown and the request is not triggered by inbound roaming, if the value of this parameter is set to 3, then NCC generates the CDR as received in the request.
•Command level SUCCESS result code is returned in the response message •Unknown subscriber metrics is generated •Rating is not processed •The tags corresponding to the request parameters are generated only if they are present in the request.
( NCC generates the CDR only for the information present in the incoming request.
)Table 16: Support for Inbound Roaming Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.114Charging User Guide Call mangement Complex map configuration For outbound roaming, only the MCC-MNC and roaming status are configured as key and values in the complex map.
For inbound roaming, roaming agreement can be configured in the complex map as shown in the following figure.
Rule configuration In the GY_CREDIT_REQUEST trigger, if the concatenation of MCC and MNC (available in HPLMN ID in the / pDUSessionChargingInformation/pduSessionInformation/hPlmnId parameter of the request) matches with the roaming agreement complex map, then this returns Inbound-Roaming-Agreement action as true /false .
If it is true , then the call is processed and a CDR is generated for the call.
Rule 1 Create a rule variable, for example, mccmnc to store the concatenation of MCC and MNC if both are present as shown in the following figure.
MCC value source context: NCHF_CHARGING_MESSAGE.PDUSessionChargingInformation.PDUSessionInfo.hPlmnId.mcc MNC value source context: NCHF_CHARGING_MESSAGE.PDUSessionChargingInformation.PDUSessionInfo.hPlmnId.mnc Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.115Charging User Guide Call mangement Rule 2 The value of SESSION_PARAMETERS.Inbound-Roaming-Agreement is set to true if the agreement matches.
Else it is set to false .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.116Charging User Guide Call mangement 3.4 Sy call support 3.4.
1 Sy/N28 session management Operators can configure to initiate the termination of Sy and N28 sessions toward the network when any of the following conditions occur: •A device is removed.
•A duplicate session is detected for the same device from the same PCRF/PCF.
•A configurable limit is reached for the maximum number of sessions allowed for a single device.
Configuration To configure session management for Sy and N28 sessions, provide the values of parameters in Diameter Sy and HTTP N28 sections, respectively, in Diameter/HTTP Configuration → Session management menu.
For the parameter descriptions, refer to the Diameter Configuration Guide .
Saving the ASR bit in database for Sy session In session management (see Configuration on page 117), if the parameter Enable Initiation of Sy Session Termination is enabled (selected) and if NCC receives an SLR-I which includes the Supported-Features AVP with the ASR bit set, then only ASR bit is saved for that Sy session in the database.
NCC will include the Supported-Features AVP with the ASR bit set in the SLA-I response returned to the PCRF.
Before sending SNR-T for an Sy session, its ASR bit is checked, and if it is ON, then only SNR-T is sent for duplicate Sy session.
For N28 sessions, whenever applicable, the notify-terminate is generated only if the parameter Enable Initiation of Sy Session Termination is enabled (selected).
Identification of duplicate session from same PCRF in Sy SLR-I call Sy session replacement works in any one of the following scenario: •If the Origin-Host AVP value in the new SLR-I exactly matches with the stored Origin-Host AVP for an existing Sy session.
•If one of the defined PCRF name (configured in PCRF Name in Diameter Sy section of Session Management) is a sub-string of the Origin-Host AVP value in the incoming SLR-I and existing sessions for the same device has Origin-Host AVP value as a sub-string of PCRF name.
Identification of duplicate session from same PCF in N28 subscribe call The notifUri of upcoming N28 subscribe request is matched to the notifUri of existing N28 sessions.
If it matches, then replacement works.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.117Charging User Guide Call mangement Sy session replacement scenarios Duplicate (same PCRF) Sy session handling during SLR-I processing If a duplicate Sy session is found on the basis of the identification logic (as explained in section Identification of duplicate session from same PCRF in Sy SLR-I call on page 117) then the ASR bit of the Sy session is checked.
If the ASR bit is ON for that duplicate Sy session, then Sy session is replaced and SNR- T is sent.
Else, that Sy session is replaced with the upcoming Sy session request without sending SNR-T based on identification logic explained in the section Identification of duplicate session from same PCRF in Sy SLR-I call on page 117.
Sy session handling during SLR-I processing when Maximum Sy Sessions Per Device is reached If Maximum Sy Sessions Per Device is configured as non-zero (>0), then following things work: •If duplicate Sy session is found, then it is replaced.
•If duplicate Sy session is not found and Maximum Sy Sessions Per Device has reached, then the least recently used (LRU) Sy session is identified to be replaced.
If the ASR bit is ON for LRU session, then session is replaced and SNR-T is sent.
Else, that Sy session is replaced with the upcoming Sy session request without sending SNR-T.
If Enable Initiation of Sy Session Termination and Maximum Sy Sessions Per Device are configured as non- zero (>0), then the application preference Max Sy Session Limit is not considered.
N28 session replacement scenarios Duplicate (same PCF) N28 session handling during subscribe request processing If duplicate N28 session is found on the basis on the identification logic (explained in section Identification of duplicate session from same PCF in N28 subscribe call on page 117), then Notify-Terminate is sent without including a termCause within the subscriptionTerminationInfo .
If Enable Initiation of N28 session termination is set and Support of Notify Terminate on Duplicate Session Replacement is set to N28_DISABLED , and if duplicate sessions are identified, then all duplicate sessions are removed without sending notify terminate request to PCF.
N28 session handling during SLR-I processing when Maximum N28 Sessions Per Device is reached If Maximum N28 Sessions Per Device is configured as non-zero (>0), then: •If duplicate N28 session is found, then the duplicate N28 session is replaced.
•If duplicate N28 session is not found and Maximum N28 Sessions Per Device has reached, then the LRU N28 session is identified to be replaced.
The LRU session is replaced and Notify-Terminate sent without including termCause within the subscriptionTerminationInfo .
If Enable Initiation of N28 Session Termination and Maximum N28 Session Per Device are configured as non-zero (>0), then the application preference Max Sy Session Limit is not considered.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.118Charging User Guide Call mangement SNR-T/Notify-Terminate triggering event If session termination is enabled for Sy/N28 in session management (see Configuration on page 117), then following are the scenarios for SNR-T/Notify-Terminate are generated: On (During) Call Duplicate/max replacement for Sy/N28 session (as described above) is applicable for (during) call.
Provisioning (deletion of Device) When a device has a Sy/N28 session and if this feature is configured, then at deletion of device, SNR-T/ Notify-Terminate is sent in the following scenarios: •Delete API (/services/ServiceManager/device/delete/Device) •Delete Entity Action In Device Life Cycle •Delete Profile API (/services/ServiceManager/device/delete/Profile) Note : For Sy session, the ASR bit is checked.
If it is configured then SNR-T is sent.
Else, the session is deleted.
When device is deleted through Delete Profile API, the state of the device is marked as final if final state is configured in device life cycle.
Else the device is marked as initial barred state.
This state is saved in DB.
During delete profile cleanup, any new call SLR-Initial/SLR-Intermediate/SNR is not processed as device is initial barred state.
The application preference Send SNR-T/N28 Notify Terminate is used to send SNR-T/Notify-Terminate in delete profile API.
If this feature is configured (session terminate is enabled in session management (see Configuration on page 117)), then the application preference is ignored.
Rule sample for message manipulation When SNR-T or Notify-Terminate are triggered at the time of device deletion, PCRF/PCF will trigger STR/ Nchf_SpendingLimitControl_Unsubscribe request.
If this is received after the device is deleted on NCC, it will respond with 5030-DIAMETER_USER_UNKNOWN/404 NOT FOUND.
In case these codes need to be manipulated, the Message manipulation rule can be configured.
Diameter Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.119Charging User Guide Call mangement 5G-HTTP ASR bit information ASR bit information is not available in getSession API response.
As a result, not all session parameters can pass through the following REST API: GET and POST methods of /services/ServiceManager/getRefData/ChargingSession .
Relation between Maximum Sy Session Limit and Maximum Sy Sessions Per Device/ Maximum N28 Sessions Per Device: Example 1: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.120Charging User Guide Call mangement Max Sy Session Limit = 5 Enable Initiation of Sy Session Termination = True Maximum Sy Sessions Per Device = 3 Enable Initiation of N28 Session Termination = False Consider that device has 2 Sy sessions currently.
Another N28 is initiated.
Here, for N28, since Enable Initiation of N28 Session Termination is off, we fallback to Max Sy Session Limit which says maximum sessions allowed (Sy and N28 together) is 5.
Since the upcoming N28 session is the 3rd session for the device which is less than max allowed (=5), so, N28 is established successfully.
Example 2: Enable Initiation of Sy session termination flag ON Max number of Sy sessions allowed per device = 0 Enable Initiation of N28 session termination flag ON Max number of N28 sessions allowed per device = 5 Max Sy session Limit=2 Notable information •If PCRF/PCF has not responded success to SNR-T/Notify-Terminate outbound request and retry interval configured in outbound configuration to a large time interval, and during that interval if multiple SNR-T/Notify-Terminate are triggered, then it may lead to increase of memory footprint.
•If a Device has 1 Sy and 1 N28 session established, and another Sy session, S2, is initiated: Since the limit for Max number of Sy sessions allowed per device = 0, then fallback to Max Sy session Limit =2.
Since device already has 2 sessions (s1 and N28), S2 will not be allowed.
•If SNR throttling Sy / N28 keep-alive notifications and message throttling is enabled, then this SNR- T/notify-terminate is processed through the Sy/N28 notification throttling client.
•SNR-T/Notify-Terminate is treated as a real SNR (that is, not a keep-alive SNR) by the Sy notification throttling clients.
It is retransmitted on timeouts after the configured backoff intervals after the device and Sy records have been deleted.
•Receipt of the session termination transaction causes the Sy/N28 notification throttling client to drop any other SNR/N28 notifications for the same session from its queues.
If there is an NR/N28 notification for the same session in the waiting for network response queue SNR-T/ Notify-terminate is sent once the previous SNR/N28 notification is removed from the waiting for response queue (either through timeout or receipt of an acknowledgment from the PCRF/PCF).
•After initiating the SNR, the system removes the Sy session from the database, that is, it does not wait for the PCRF to return an SNA before this clean-up occurs.
NCC successfully processes the resulting SNAs received from the PCRF without generating any errors or alarms if the device records and/or Sy session information is no longer present/moved to barred state on the CHF (whether or not the SNR throttling feature is enabled).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.121Charging User Guide Call mangement •When SNR throttling is enabled, the Sy notification throttling clients can silently handle reaching the maximum number of retransmissions and the final timeout for these SNRs when the device and/or Sy session records no longer exist/moved to barred state.
That is, NCC does not triggers another SNR after the maximum retries are sent because there is no device or Sy session available to record the failed SNR sending status information.
•Duplicate Sy session detection applies only during SLR-I processing and not when the PCRF host name table is updated.
For example, if a new PCRF name is added to the PCRF table, it is included in the checks performed after the updated table has been read into memory and the next SLR-I is received for a subscriber which already has one or more active Sy sessions.
•Depending on the sequence of events involving the removal of a device, it is possible that the STR generated by the PCRF in response to SNR with the ASR bit set in the SN-Request-Type AVP may not reach the CHF where the subscriber was removed.
The subscriber may be removed if the Drouter receiving the STR is no longer configured to route the STR to the original CHF.
This is because the device was removed and an index server update is sent to the Drouter.
In such cases, if the Drouter cannot successfully locate the subscriber on another OCS, then a 5030 – DIAMETER_USER_UNKNOWN error is returned to the PCRF directly from the Drouter.
•If the result code for STA/Unsubscribe ack is manipulated using Message Manipulation (when device is not found), the CDR and metrics correspond to the device not found.
CDR and metrics do not correspond to the manipulated result code.
•If SLR-I is received from a PCRF, which is not configured in the PCRF table, and if the origin-host AVP does not exactly match with any of the existing Sy sessions for the device, the request is processed and a new session for the same is created.
If the Max number of Sy sessions Per Device is reached, the LRU session for the device is terminated.
If another SLR-I is received from the same PCRF with a different origin-host AVP, it is not treated as duplicate as this PCRF name is not configured in PCRF table.
Operators should ensure that such situations do not arise.
•Metric sessionlimit_count is updated for max session limit and replacement of active session scenarios.
The metric is incremented regardless of whether or not the N28 notify-terminate message is sent to the network.
CDR/EDR changes Refer to the following sections in the CDR/EDR Reference : •For provisioning EDRs for session management: See section Session management configuration .
•CDR samples: See section Sample CDRs for Sy session .
Metrics changes Refer to the Metrics Spreadsheet .
3.4.2 Sy and N28 keep-alive notifications and message throttling NCC provides the following capabilities for managing Sy and Nchf_SpendingLimitControl (N28) sessions: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.122Charging User Guide Call mangement •The ability to trigger keep-alive notifications if no intermediate SLRs and Nchf_SpendingLimitControl report retrieval are sent within a configurable idle session interval.
•The ability to throttle the overall rate of SNR and Nchf_SpendingLimitControl_Notify messages sent from the system (including both keep-alive and real notifications) can be defined using the following two parameters: –Maximum number of notifications (both keep-alive and real) that can be sent.
–Interval over which they can be sent.
Separate throttling parameters can be defined for 4G Sy and 5G Nchf_SpendingLimitControl sessions.
The message rates and throttling are managed separately for Sy SNRs and Nchf_SpendingLimitControl_Notify .
All notifications for a given Sy and Nchf_SpendingLimitControl session must be sent in the order they are generated.
A retry mechanism is available so that notifications can be resent if no acknowledgement is received from the PCRF/PCF within a configurable timeout interval (or if other send failures are encountered).
Separate 4G and 5G parameters can be configured for retry wait interval.
Maximum retries can be configured for real and keep-alive notifications.
Note : •If keep alive audit is triggered in between real SNR retry then it is dropped and keep alive retry count is not reset.
•For the configuration parameters, refer to section Outbound configuration in the Diameter/ HTTP Configuration Guide .
keep-alive SNR 1.If SLR/SLA or SNR/SNA has not been exchanged in a Sy session for the duration as specified in the application preference OCS Sy Session Inactivity Duration (seconds) , then a keep-alive SNR is sent to the PCRF in order to check whether the Sy session is alive or not.
2.If there is a timeout in the receiving SNA, a retry is made after the time that is configured in the parameter Keep Alive Consecutive Retry Interval (ms) .
This retry is made for the number of retry counts configured into the parameter Max Keep Alive Consecutive Retry Count .
3.When the last retry fails, the next retry is attempted after the time specified in the parameter Keep Alive Retry Interval (min) .
This retry follows the previous step.
The retry mechanism in this step is repeated for a number of retry count configured in Max Keep Alive Retry Count parameter.
4.If there is a timeout on a retry, SNA is returned with the diameter result code configured in Result Codes to Remove Session , for example, 5002 (unknown session ID).
Then the Sy session is cleared.
Else, the Sy session timestamp is updated with the latest timestamp.
5.If Max Keep Alive Retry Count is set to -1, or the application preference Enable SNR Throttling and Keep Alive is disabled, then the session audit removes the session without any retry.
6.If Empty Keep Alive SNR check box is selected in the outbound configuration, then Keep Alive SNR is sent without any Policy Counter ID and status.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.123Charging User Guide Call mangement SNA handling 1.For each SNR sent to Policy, NCC waits and checks for an SNA response.
2.If SNA is received with result code configured in Result Codes to Remove Session , then the session is removed from NCC.
3.For real SNR, if network returns any of the result codes defined in Result Code to Skip Retry (for example, too busy), then retry does take place.
It waits for the occurrence of the next network event (like CCR/SLR/SNA) to send the SNR.
4.For keep-alive SNR, next retry takes place after the time defined in Keep Alive Retry Interval (min) .
5.If the network returns any of the result codes not present in Result Codes to Skip Retry or Result Codes to Remove Session , then NCC retries the SNR with configurable time as per the separate timeout intervals, and number of retries defined for keep-alive and real SNRs.
6.If a response is not received in the configured Response Time for SNA , or if other send failures are encountered, then NCC retries the SNR n times with a configurable interval for SNR retry.
7.The retry is based on a timer value and is as configured in the outbound configuration entity.
8.For session terminate request, if SNA is received with result code other than 2XXX , then the result code is modified to 2001 .
This forces the session terminate request to return a success response.
9.This is applicable for Sy and Nchf_SpendingLimitControl_Notifications .
10.This is applicable for both keep-alive and real SNR.
Re-transmission bit for retry •When retrying any notification, set the re-transmission bit, to indicate retry.
•This is applicable for consecutive retries of SNR messages.
•T-bit is not set for N28 messages as there is no T-bit equivalent in N40 or N28 notifications for 5G standards.
Multiple notifications for the same session 1.The multiple notifications for the same session ( keep-alive /real SNR/retry) is consolidated or sent externally in the same order in which they are generated.
2.If the two SNRs are generated simultaneously for the same session, then only one SNR is sent with latest policy counter status.
If the new notification is generated while waiting for an SNA, then the new SNR is also sent upon receiving the SNA.
3.If a real notification is generated when keep-alive is already in queue, the keep-alive notification is dropped, and is not sent to PCF.
4.In case the keep-alive was sent, and is still in the waiting interval, then the real SNR is on hold till the acknowledgment is received for the keep-alive .
The real SNR is sent upon receiving the acknowledgment.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.124Charging User Guide Call mangement 5.If an unknown session is received, then the real SNR is not sent, and the session is removed.
SNR throttling for external server (PCRF/PCF) 1.To enable the SNR throttling: •Set the application preference Enable SNR Throttling and Keep Alive to true .
•In outbound configuration, configure parameters Max Queue Size for Throttling , Throttle Interval (ms) , and Throttling Limit (SNRs to be sent in the Throttle Interval (ms) ) with a non-zero value.
2.Configurable number of tokens ( Throttling Limit ) are generated at a predefined interval ( SNR Throttle Interval ).
3.All SNRs generated by the application server are inserted into the FIFO queue.
4.Before sending the SNR, it is checked whether SNR throttling is enabled or not.
5.If the throttling is enabled, the SNR is retrieved and removed from the head of the queue.
After checking for the token availability, the SNR is sent to Policy when a token is available.
Thereby reducing the token count for that interval.
6.If a token is not available, it waits for a predefined time for the token availability.
7.There are two queues for SNR throttling: •SNRs (4G) •NCHF_SpendingLimitControl_Notify 8.There are separate throttling configurations for 5G and 4G.
Separate tokens are maintained for SNR and NCHF calls.
Separate throttle limits for Sy and Nchf_SpendingLimitControl Separate throttling parameters are present for Diameter Sy SNR and Nchf_SpendingLimitControl notifications .
EDRs The parameter Generate SNR CDR is used to specify whether EDR should be generated after sending SNR or after receiving SNA.
Following configurations are required to generate SNR EDR for Sy and N28 keep-alive notifications: •Set the application preference OCS Sy CDR Generation to true .
•Set the application preference Enable SNR Throttling and Keep Alive to true .
Following are some scenarios when EDR is generated: Each SNR If the value of Generate CDR SNR is Each SNR , then for all scenarios, EDR is generated immediately after sending SNR.
If while sending SNR, NoRouteToHostException exception is received, then Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.125Charging User Guide Call mangement SY_SNR_CALL_NOK, recordEventResult (04) is sent.
Else, for all the other scenarios, SY_SNR_CALL_OK, recordEventResult (03) is sent irrespective of the resultCode received in SNA.
SNA success EDR is generated if the received SNA is successful.
SY_SNR_CALL_OK, recordEventResult (03) is generated in this scenario.
Error result code or a timeout received in SNA on maximum consecutive retries EDR is not generated on every SNR failure but only when an error or timeout is received on reaching max consecutive retires.
The recordEventResult contains the diameter result code received in SNA for an error scenario.
The recordEventResult contains SY_SNA_TIMEOUT, recordEventResult(28) for timeout scenario.
Skip retry EDR is generated if a diameter result code is received in SNA that is present in Result Codes to Skip Retry list.
The recordEventResult contains the diameter result code received in SNA.
Remove Sy session EDR is generated if a diameter result code is received in SNA that is present in Result Codes to Remove Session .
The recordEventResult contains the diameter result code received in SNA.
SNR queue full and throttling EDR is generated if the SNR is dropped because the SNR queue is full or due to throttling.
In these cases, because SNR is never sent, SNA is never received.
The recordEventResult is 29 for queue full and 30 for throttling.
Note : For information about result codes, refer to CDR/EDR Reference .
Alarm generation •Alarm must be generated when a real SNR is dropped because of the notification send queue being full.
•Alarm must be generated when a real Nchf_SpendingLimitControl_Notification is dropped because of the notification send queue being full.
•An alarm is generated when the queue is near to full (percentage of SNR queue defined in Alarm on near full Queue Percentage (%) for SNR ).
It is an auto clear, and minor alarm.
Logs For logging information, refer to section Logs for failed real/keep-alive SNR and Spending Limit Control Notify in the Diameter/HTTP Configuration Guide .
Additional information •If the same error code is configured for Skip retry , and code to Remove session , then the configuration is considered as wrong.
In this case the priority is given to Skip retry error codes.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.126Charging User Guide Call mangement •To modify Max Queue Size for Throttling in 4G and 5G, it is necessary to restart the diameter app or the charging pod.
•The default values for removing the session are 5002 (for 4G) and 404 (for 5G).
Even if the values are not configured in the GUI, the session is removed on receiving these error codes.
This logic is overridden if the error codes are configured in the Skip retry list of 4G and 5G.
Retry time starts after the error codes are received, or when the SNA timeout is received.
•Only one instance of outbound configuration is considered.
If it is deleted and created again, then the throttling queue size is not initialized.
•If the keep alive audit is triggered in between real SNR retry, then it is dropped.
Hence the keep alive retry count is not reset.
•If Throttling Limit and Throttle Interval (ms) are modified, then the new values are applied only after all the previously created tokens are consumed.
•Pending-Policy-Counter-Information AVP support is available only for real SNR.
•The value of the application preference Default Concurrent Execution Delay for SNR must be set to 0 (zero) for this feature.
3.5 SMS and MMS call support In SMS and MMS calls, Credit-Control-Request (initial/termination) contains some SMS and MMS AVPs.
In NCC, appropriate source contexts, result contexts, triggers, and attributes are available, so that operators can perform some actions based on type of request and the values of these AVPs.
Service-Context-Id AVP is used to differentiate between Gy(SMS) and Gy(MMS) calls as follows: •32274@3gpp.org is used for SMS Charging •32270@3gpp.org is used for MMS Charging SMS and MMS calls are handled in Event Charging Unit Reservation (ECUR) and Immediate Event Charging (IEC) mode.
SMS AVP support in rules The following table provides information about the SMS AVPs and the corresponding rule attributes in NCC.
AVP Rule attribute smsNode SMS- Information.
SMS- Node client Address SMS- Information.
Client- Address.
Address- FamilyTable 17: SMS AVP–rule attribute mapping Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.127Charging User Guide Call mangement AVP Rule attribute SMS- Information.
Client- Address.
Address- Value originator SCCPAddres SMS- Information.
Originator- SCCP- Address.
Address- Family SMS- Information.
Originator- SCCP- Address.
Address- Value smsc Address SMS- Information.
SMSC- Address.
Address- Family SMS- Information.
SMSC- Address.
Address- Value data Coding Scheme SMS- Information.
Data- Coding- Scheme smDischarge Time SMS- Information.
SM-Discharge- Time smMessage Type SMS- Information.
SM-Message- Type originator Interface SMS- Information.
Originator- Interface- Id SMS- Information.
Originator- Interface- Text SMS- Information.
Originator- Interface- Port SMS- Information.
Originator- Interface- Type smProtocol Id SMS- Information.
SM-Protocol- ID reply Path Requested SMS- Information.
Reply- Path- Requested smStatus SMS- Information.
SM-Status smUser Data Header SMS- Information.
SM-User- Data- Header num OfMessage Sent SMS- Information.
Number- Of-Messages- Sent destination Interface SMS- Information.
Recipient- Info.
Destination- Interface- Id SMS- Information.
Recipient- Info.
Destination- Interface- Text SMS- Information.
Recipient- Info.
Destination- Interface- PortTable 17: SMS AVP–rule attribute mapping (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.128Charging User Guide Call mangement AVP Rule attribute SMS- Information.
Recipient- Info.
Destination- Interface- Type recipient Addresses SMS- Information.
Recipient- Info.
Recipient- Addr.
Address- Type SMS- Information.
Recipient- Info.
Recipient- Received- Address.
Address- Data SMS- Information.
Recipient- Info.
Recipient- Addr.
Addressee- Type SMS- Information.
Recipient- Info.
Recipient- Addr.
Address- Data SMS- Information.
Recipient- Info.
Recipient- Addr.
Addr- Domain.
Domain- Name SMS- Information.
Recipient- Info.
Recipient- Addr.
Addr- Domain.
IMSI- MCC- MNC recipient Received Addresses SMS- Information.
Recipient- Info.
Recipient- Received- Address.
Address- Type SMS- Information.
Recipient- Info.
Recipient- Received- Address.
Address- Data SMS- Information.
Recipient- Info.
Recipient- Received- Address.
Domain- Name SMS- Information.
Recipient- Info.
Recipient- Received- Address.
IMSI- MCC- MNC recipient SCCPAddress SMS- Information.
Recipient- Info.
Recipient- SCCP- Add.
Address- Family SMS- Information.
Recipient- Info.
Recipient- SCCP- Add.
Address- value smProtocol ID SMS- Information.
Recipient- Info.
SM-Protocol- ID Address- Domain SMS- Information.
Recipient- Info.
Addr- Domain.
Domain- Name SMS- Information.
Recipient- Info.
Addr- Domain.
IMSI- MCC- MNC originator Received Address SMS- Information.
Originator- Received- Add.
Address- Type SMS- Information.
Originator- Received- Add.
Address- Data SMS- Information.
Originator- Received- Add.
Domain- Name SMS- Information.
Originator- Received- Add.
IMSI- MCC- MNCTable 17: SMS AVP–rule attribute mapping (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.129Charging User Guide Call mangement AVP Rule attribute smService Type SMS- Information.
SM-Service- Type smSequence Number SMS- Information.
SM-Sequence- Number smsResult SMS- Information.
SMS- Result smDevice Trigger Indicator SMS- Information.
SM-Device- Trigger- Indicator smDevice Trigger Info SMS- Information.
SM-Device Trigger Info.
Mtc- Iwf-Address.
Address- Family SMS- Information.
SM-Device Trigger Info.
Mtc- Iwf-Address.
Address- Value SMS- Information.
SM-Device Trigger Info.
Reference- Number SMS- Information.
SM-Device Trigger Info.
Validity- Time SMS- Information.
SM-Device Trigger Info.
Priority- Indication SMS- Information.
SM-Device Trigger Info.
Application- Port- IdentifierTable 17: SMS AVP–rule attribute mapping (continued) MMS AVP support in rules The following table provides information about the SMS AVPs and the corresponding rule attributes in NCC.
AVP Rule attribute originator Address MMS- Information.
Originator- Address.
Address- Type MMS- Information.
Originator- Address.
Address- Data MMS- Information.
Originator- Address.
Domain- Name MMS- Information.
Originator- Address.
IMSI- MCC- MNC recipient Address MMS- Information.
Recipient- Add.
Address- Type MMS- Information.
Recipient- Add.
Addressee- Type MMS- Information.
Recipient- Address.
Address- Data MMS- Information.
Recipient- Address.
Domain- NameTable 18: MMS AVP–rule attribute mapping Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.130Charging User Guide Call mangement AVP Rule attribute MMS- Information.
Recipient- Address.
IMSI- MCC- MNC submission Time MMS- Information.
Submission- Time mmContent Type MMS- Information.
MM- Content- Type.
Additional- Type- Info MMS- Information.
MM- Content- Type.
Content- Size priority MMS- Information.
Priority message ID MMS- Information.
Message- Id message Type MMS- Information.
Message- Type message Size MMS- Information.
Message- Size message Class’ s class identifier MMS- Information.
Message- Class.
Class- Identifier delivery Report Requested MMS- Information.
Delivery- Report- Requested read Reply Report Requested MMS- Information.
Read- Reply- Report- Requested mmBoxStorage Requested MMS- Information.
MM- Box- Storage- Requested applic ID MMS- Information.
Applic- ID reply Applic ID MMS- Information.
Reply- Applic- ID auxApplic Info MMS- Information.
Aux- Applic- Info content Class MMS- Information.
Content- Class drmContent MMS- Information.
DRM- ContentTable 18: MMS AVP–rule attribute mapping (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.131Charging User Guide Call mangement AVP Rule attribute adaptations MMS- Information.
Adaptations vasp ID MMS- Information.
Vasp- Id vasID MMS- Information.
Vas- IdTable 18: MMS AVP–rule attribute mapping (continued) Pre-shipped SMS rules The following figure presents the pre-shipped rules for SMS.
Figure 30: Pre-shipped SMS rules Following are the assumptions while using the SMS rules: 1.Subscription-Id must contains the E164.
2.SMS-Information , Originator-Received-Address , or Address-Type must come as MSISDN.
3.Single instance of SMS-Information or Recipient-Info AVP is present.
4.Single instance of SMS-Information , Recipient-Info , or Recipient-Address AVP is present.
As shown in the preceding figure, there are following three rules present under SMS_CALL_ESTABLISHMENT by default: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.132Charging User Guide Call mangement Note : If SMS_CALL_ESTABLISHMENT trigger is deleted from rules and variables, then only CALL-SUB-TYPE parameter is set as SMS_MO , rest parameters like CALLING-_PARTY , CALLING_PARTY_TYPE , CALLED_PARTY , and CALLED_PARTY_TYPE are set to none .
Rule for mobile originated (SMS-MO) call The Call-Sub-Type is SMS_MO.
if GY_MESSAGE.Subscription-Id-Data-By-Type ( SubscriptionIdType_END_USER_E164 ) = GY_MESSAGE.SMS-Information.Originator-Received-Add.Address-Data then SESSION_PARAMETERS.Call-Sub-Type = "SMS_MO" and SESSION_PARAMETERS.Calling-Party = GY_MESSAGE.Subscription-Id-Data-By-Type ( SubscriptionIdType_END_USER_E164 ) and SESSION_PARAMETERS.Calling-Party-Type = AddressType_MSISDN and SESSION_PARAMETERS.Called-Party = GY_MESSAGE.SMS-Information.Recipient- Info.Recipient-Addr.Address-Data and SESSION_PARAMETERS.Called-Party-Type = GY_MESSAGE.SMS-Information.Recipient- Info.Recipient-Addr.Address-Type Rule for mobile terminated (SMS-MT) call if GY_MESSAGE.Subscription-Id-Data-By-Type ( SubscriptionIdType_END_USER_E164 ) = GY_MESSAGE.SMS-Information.Recipient-Info.Recipient-Addr.Address-Data then SESSION_PARAMETERS.Call-Sub-Type = "SMS_MT" and SESSION_PARAMETERS.Called-Party = GY_MESSAGE.Subscription-Id-Data-By-Type ( SubscriptionIdType_END_USER_E164 ) and SESSION_PARAMETERS.Called-Party-Type = AddressType_MSISDN and SESSION_PARAMETERS.Calling-Party = GY_MESSAGE.SMS-Information.Originator- Received-Add.Address-Data and SESSION_PARAMETERS.Calling-Party-Type = GY_MESSAGE.SMS- Information.Originator-Received-Add.Address-Type Default rule Default actions are the same as for MO Call.
Call-Sub-Type is SMS_MO.
SESSION_PARAMETERS.Call-Sub-Type = "SMS_MO" and SESSION_PARAMETERS.Calling-Party = GY_MESSAGE.SMS-Information.Originator- Received-Add.Address-Data and Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.133Charging User Guide Call mangement SESSION_PARAMETERS.Calling-Party-Type = GY_MESSAGE.SMS- Information.Originator-Received-Add.Address-Type and SESSION_PARAMETERS.Called-Party = GY_MESSAGE.SMS-Information.Recipient- Info.Recipient-Addr.Address-Data and SESSION_PARAMETERS.Called-Party-Type = GY_MESSAGE.SMS-Information.Recipient- Info.Recipient-Addr.Address-Type Identification of SMS MO and SMS MT calls If the Subscription-Id-Data AVP in Subscription ID AVP and Address Data AVP in Originator Address AVP within CCR message are identical, then SMS is considered as MO or MT based on following conditions: •If there is more than one recipient included in the Recipient Address AVP and one of multiple recipients is same as Address Data AVP in Originator Address AVP within CCR message, then SMS is treated as MO-SMS.
•If there is only one recipient included in the Recipient Address AVP and the recipient is same as Address Data AVP in Originator Address AVP within CCR message, then service uses the SM-Interface- ID of SM-Originator-Interface and SM-Interface-ID of SM-Destination-Interface to determine the MO- SMS or MT-SMS.
Else if the Subscription-Id-Data AVP in Subscription ID AVP is equal to Address Data AVP in Originator Address AVP, the call is treated as MO-SMS.
If the Subscription-Id-Data AVP is equal to Address Data AVP in the Recipient Address AVP, the call is treated as MT-SMS.
Else if MO-SMS or MT-SMS cannot be determined based on the Subscription-ID and Originator Address/ Recipient Address, then service uses the SM-Interface-ID of SM-Originator-Interface and SM-Interface- ID of SM-Destination-interface to determine the MO-SMS or MT-SMS.
Else if MO and MT cannot be determined, then the existing NCC logic is followed.
Following assumptions are considered: •If the SM-Interface-ID of originator or destination is not present, MO/MT determination logic is still supported.
•The Recipient-Address AVP may appear multiple times, but, only the first Recipient-Address AVP is fetched to determine MO/MT SMS calls.
Rule configuration example: Configure SMS_CALL_ESTABLISHMENT trigger to determine call sub-type: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.134Charging User Guide Call mangement Identification of MMS MO and MMS MT calls If the Message-Type is included, then service uses Message-Type to determine SESSION_PARAMETERS.Call- Sub-Type = "MMS_MO" or "MMS_MT".
If the MO and MT cannot be determined, then the existing NCC logic is followed.
Rule configuration example: Configure rule in the MMS_CALL_ESTABLISHMENT trigger to determine call sub-type: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.135Charging User Guide Call mangement SMS/MMS IEC interface Rating Group or Service Identifier is mandatory in MSCC AVP for NCC, but not expected by the standard for Immediate Event Charging (IEC).
If the client is not sending this AVP or MSCC at all, it must be added in message manipulation.
Rule example: Mapping VDCCA service-context-id value to 3GPP standard Check if it is IEC call without MSCC Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.136Charging User Guide Call mangement If MSCC is added by rule, remove it before sending back CCA message 3.6 Proactive clearing of stale Diameter/Nchf_ConvergedCharging sessions In NCC, mechanism is available to audit active Diameter and Nchf_ConvergedCharging sessions when a configured threshold of active data sessions is reached.
Separate session limits are available per interface, that is, Ro, Gy, N40.
When the audit session threshold is reached for an interface, the CHF triggers a RAR for all the previously active sessions of the same type, so that the ones for which error/timeout is returned from the network can be cleared.
In addition, when the audit threshold is reached, any new session has a new max limit defined for the validity time (VT) returned to the network.
This is done to detect cases where the network rapidly creates, and immediately abandons, new data sessions due to problems elsewhere in the network.
NCC also provides the ability to initiate ASR towards the network for terminating the least recently used (LRU) session when the Maximum Active Session Limit Per Device is exceeded (separate limits are managed per interface, that is, Ro, Gy, N40).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.137Charging User Guide Call mangement Separate Audit Active Session Limit Per Device , Maximum VT when Audit Active Session Limit Reached , Maximum Active Session Limit Per Device , and Terminate Failure Audit Timer can be configured for Ro, Gy, N40.
For configuring these parameters, refer to section Session Management in the Diameter/HTTP Configuration Guide .
Note : This feature is applicable for new Gy, Ro, N40 session creation, that is, either via CCR-I or via CCR-U (when the application preference New Call Start in Update or Terminate is set to true and a new session is created in CCR-U).
Handling of Audit Active Session Limit Per Device For an interface, when the Audit Active Session Limit Per Device is reached during new session creation, NCC triggers RAR/notify message towards the network for all the existing sessions of that interface.
In addition, NCC returns a successful response for the create transaction.
However, the VT value for each MSCC/MultiUnitInformation is limited to a maximum of the value defined in Maximum VT when Audit Session Limit Reached .
If the RAR/notify is responded by an error/timeout from the network, indicating that the sessions are not known to the network, NCC clears that session.
Also, if a timeout occurs after sending the maximum retries for a notification to the network without receiving any successful response from the network, then the session is removed from the device.
This applies when no response is received on a timeout after max retries for routing outbound transactions through a Drouter (see Routing outbound 4G transactions through Drouter in the Diameter/HTTP Configuration Guide ).
Note : •If for an interface, the Audit Active Session Limit Per Device is set to 3, the audit is triggered when the third session of that interface is received.
•The audit is triggered each time a new session establishment request is received after the Audit Active Session Limit Per Device is crossed.
•If RAR/notify for existing sessions is in progress during a session establishment, and the device receives another session establishment request on that same interface, then RAR/ notify is triggered for only the session for which RAR/notify has not been triggered yet.
If RAR/notify for any session is in flight or its ack is not yet received by NCC, RAR/notify is not sent again.
Handling of Maximum Active Session Limit Per Device When Maximum Active Session Limit Per Device is already reached for an interface during new session creation, NCC identifies the LRU active session to be terminated.
This is defined as the currently active session which received its last transaction from the network least recently.
NCC sends an ASR for this session and immediately removes the session from the system.
The new session is processed successfully.
When ASA is received for the session, it is silently processed without generating any error.
When CCR-T is received, since the session no more exists, it is responded with an unknown session error.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.138Charging User Guide Call mangement If the current number of sessions is at or above the Maximum Active Audit Session Limit Per Device then NCC also initiates RARs/notifies for all the other sessions of the same interface (excluding the newly created session and the session sent an ASR for termination).
Note : If device has 10 active sessions and we configure the Max Session limit to 5, then on CCR-I for the device, we will be sending 5 ASR for LRU active sessions in the system.
Behavior of Maximum Active Session Limit Per Device with Allowed Concurrent Gy sessions per Device This section is applicable only for Gy and N40 sessions.
If the device session limit defined in the application preference Allowed Concurrent Gy sessions per Device (see Charging application preferences on page 44) is reached and if the parameter Maximum Active Session Limit Per Device is: •Disabled (=0): The LRU sessions (active or inactive) are deleted.
•Enabled (>0): The LRU inactive sessions are deleted.
For example, if Maximum Active Session Limit Per Device is set to 5, and Allowed Concurrent Gy sessions per Device sessions (active and inactive for Gy, and N40) is set to 10, then the following cases may occur: –If there are 10 inactive sessions and no active sessions and if a new active Gy session begins, the LRU inactive session is removed from the system.
–If there are 5 active Gy sessions and 5 inactive sessions and a new sessions starts, then both the LRU active Gy session are terminated.
As the terminated Gy session becomes the newest inactive session, the LRU inactive session is also removed.
Note : It is recommended that for cumulative data sessions Allowed Concurrent Gy Sessions per Device should be greater than the sum of Maximum Active Session Limit Per Device (for Gy session) and Maximum Active Session Limit Per Device (for N40 session).
The difference between the maximum cumulative data sessions and the sum of the Gy and N40 active session limits is the number of inactive data sessions, which is retained even if the maximum number of active data sessions is reached.
Behavior of Maximum Active Session Limit Per Device with Time to Live for Terminated Sessions (Seconds) If Maximum Active Session Limit Per Device is reached, and if the application preference Time to Live for Terminated Sessions (Seconds) is: •Enabled (>0): ASR is triggered for the LRU active session, and that session is marked as inactive.
If a session is marked as inactive after sending ASR, if CCR-U reaches to the OCS before CCR-T, then reservation is not processed for the CCR-U.
This CCR-U request is treated as a direct debit request.
If CCR-T is received after ASR, the session ID is matched with the information saved when the session was marked inactive (as the CC-Request-Number is greater than the stored value) all new usage is applied to the subscriptions of the device and the last received USU and CC-Request-Number are Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.139Charging User Guide Call mangement updated in the terminated session database.
NCC returns a result code for success in the CCA-T. For more details about terminated sessions, refer to Duplicate request handling on page 141.
•Disabled (=0): The session is deleted.
Clearing stale sessions using Terminate Failure Audit Timer If NCC receives a terminate/delete request for any session (Sy, HTTP N28, Ro, Gy, N40), and the terminate request returns a success response, then the session is removed.
If the terminate request fails due to some errors (for example: DIAMETER_TOO_BUSY , UNABLE_TO_COMPLY ), then the session accumulates in the database.
All the sessions, for which terminate request fails, are accumulated in the database.
These sessions remain in the database until the audit removes them.
This feature provides the functionality to remove the accumulated sessions without a long delay.
Enabling this feature reduces the time taken by the audit to clear the stale sessions.
This feature can be enabled for each session separately.
If this feature is enabled for a session, and a terminate/delete/STR/unsubscribe request is received for that session, then the session terminate request is forced to return a success response, thereby resulting in session termination.
Configuration Terminate Failure Audit Timer attribute in the session management is used to configure this feature.
It can be configured for each session (Sy, HTTP N28, Ro, Gy, N40) separately.
This feature is enabled only when Terminate Failure Audit Timer is set to a value greater than 0.
Note : For more details on Terminate Failure Audit Timer , see Session Management in the Diameter/HTTP Configuration Guide .
If Terminate Failure Audit Timer is configured, then the following tasks are performed: •Terminate request returns a success response to the network.
•Calculate the new audit-entity time (current system time + value of Terminate Failure Audit Timer attribute).
If the new audit-entity time is less than the earlier expiry time, then the earlier expiry time is replaced with the new audit-entity time.
•Mark the session inactive.
The time taken to process or execute the session terminate request to return a response can be configured using the application preference Terminate Request Execution Timeout (Milli seconds) .
Note : For more details on Terminate Request Execution Timeout (Milli seconds) , refer to section Managed Element application preferences in the Global Configuration Guide .
Constraints •If session termination/delete requests are processed using this feature, then USU in terminate request is not committed, and it is lost.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.140Charging User Guide Call mangement •CDR is not generated for processing a terminate session.
•A CDR is generated only for a success response.
Note : The success response does not contain information related to charging units.
•This feature is applicable only during the device identification.
If the call is stuck after the device identification, then normal call flow is applicable.
CDR changes Refer to section Session audit CDRs in the CDR/EDR Reference .
Metrics changes Refer to the Metrics Spreadsheet .
3.7 Duplicate request handling Before this feature, PGW or TAS supported the Assume positive functionality for both Gy and Ro Diameter sessions in case no response is received from the CHF router.
When this occurs for a CCR-U transaction, the subsequent CCR-U or CCR-T transaction may include an additional usage but uses the same CC-Request- Number .
If the original transaction was not received at the CHF router, then the normal processing is applied and cumulative usage is processed for the device.
However, in cases where the original transaction was received at the CHF router, but the CCA response was lost, this feature requires the CHF router to apply the delta usage between the usage originally reported in the first transaction and the larger value reported in the duplicate transaction received later on.
This requires the CHF router to save the latest usage received per Diameter session, per rating group, and the associated CHF-Request-Number in case a duplicate CHF-Request-Number is received later on.
Also, this information regarding the last Diameter transaction ID and usage per rating group is maintained for sessions terminated on the CHF router, which allows for duplicate transactions received later, including Assume Positive Reconciliation transactions sent from the Drouter.
This is further checked for delta usage reported in duplicate transactions for sessions that are no longer active on the CHF router.
For more information on Assume Positive Reconciliation feature, see the Assume positive functionality on page 248.
3.7.
1 Count delta usage for duplicate Diameter CCR-U/T CC-Request-Numbers Normal update request flow 1.When this feature is configured, the CC-Request-Number AVP value received in incoming request is compared with the previous request's CC-Request-Number received in CCR-U/CCR-T.
In case the Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.141Charging User Guide Call mangement incoming CC-Request-Number is same as the previous request's CC-Request-Number, then the request is considered as duplicate request.
2.For a duplicate request, the Delta (any additional usage reported) is computed and CHF considers this delta for rating as new usage reported by the network.
3.It is assumed that the usage reported in duplicate request is greater than or equal to the usage provided in the previous request, which infers that delta computed is always greater than or equal to Zero (0).
4.In duplicate request, CDR is not generated, only if delta is zero(0).
In duplicate request, a custom tag DUPLICATE_REQUEST is added in call metrics.
Possible values for this custom tag is as follows, a.WITH_ADDITIONAL_USAGE b.WITHOUT_ADDITIONAL_USAGE 5.This feature also works with following request type as well, NewCallStartInUpdateAndTerminate , AP, and TTC Request .
For any kind of session termination either from CCR-T or Audit (VT expire), the session is marked as inactive and is retained till the configured Time to Live for Terminated Sessions (Seconds) value gets expired.
Session marked inactive can only be activated again when the corresponding CCR-U is received.
3.7.
1.
1 Additional information •Configure application preference Time to Live for Terminated Sessions (Seconds) in such way that too many sessions are not collected or stored in DB, as it may lead to DB performance issues.
•In case of duplicate TTC Requests for which additional usage is reported.
Only additional usage from only AFTER USU is considered for rating.
but CDR is generated for both BEFORE with Zero Usage and AFTER with additional usage (if any), similar to as generated in normal TTC requests.
•If a session is terminated normally due to receiving a CCR-T from the network, then the CHF must reduce the amount of storage required for the session (that is, it no longer needs to store reported usage or reactivate the session) to the minimum needed for successfully identifying a duplicate release transaction for the same session.
3.7.2 Nchf_ConvergedCharging support for duplicate ChargingRequest invocationSequenceNumber and UsedUnitContainer localSequenceNumber Normal update request flow 1.When this feature is configured, the InnvocationSequenceNumber attribute value received in incoming request is compared with the previous request's InnvocationSequenceNumber received in Update or Terminate request.
In case incoming InnvocationSequenceNumber is same as with previous request's InvocationSequenceNumber , then the request is considered as duplicate request.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.142Charging User Guide Call mangement 2.The UUC (with LSN higher than max LSN in previous request) and CHF that is newly discovered is considered with the new UUC(s) for rating as new usage is reported by the network.
3.In case the UUC's reported have LSN less than or equal to the max LSN reported in the previous request, then all the UUC's is reset to zero for further rating.
4.In duplicate request, CDR is not generated when there is no new UUC present.
5.In duplicate request, a custom tag DUPLICATE_REQUEST is added in Call Metrics.
Possible values for this custom tag is as follows, a.WITHOUT_ADDITIONAL_USAGE b.WITH_ADDITIONAL_USAGE 6.This feature also works with following request type as well, NewCallStartInUpdateAndTerminate , AP, and TTC Request .
For any kind of session termination either from Terminate request or Audit (VT expire), the session is marked as inactive and is retained till configured Time to Live for Terminated Sessions (Seconds) value gets expired.
Session marked inactive can only be activated again when the corresponding Update Request is received.
3.7.2.
1 Additional information •Configure application preference Time to Live for Terminated Sessions (Seconds) in such way that too many sessions are not collected or stored in DB, as it may lead to DB performance issues.
•In case of Duplicate TTC Requests for which additional usage is reported.
Only additional usage from only AFTER USU is considered for rating.
but CDR is generated for Both BEFORE with Zero Usage and AFTER with additional usage (if any), similar to as generated in normal TTC requests.
•If a session is terminated normally due to receiving a Nchf_ConvergedCharging_Release message from the network, then the CHF must reduce the amount of storage required for the session (that is, it no longer needs to store reported usage or reactivate the session) to the minimum needed for successfully identifying a duplicate release transaction for the same session.
3.7.3 Diameter (Gy/Ro) initial request handling If a diameter (Gy/Ro) initial create request is received for a device which has one or more Gy or Ro sessions, the session information ( SessionID ) of one of the stored sessions matches with that of the received session request, then the received session request is identified as a duplicate request.
When a duplicate request is received, and no update transactions are received for the existing data session (that is, CC-Request-Number AVP is 0), then the old reservation is cleared and new reservation logic is executed according to the new session request.
Note the following points about this feature: •This feature is only applicable to Gy and Ro CCR-I.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.143Charging User Guide Call mangement •For duplicate request, the rating or charging logic is re-executed.
Hence, response or action may differ in some cases as per the rating condition.
•CDR is not generated for duplicate requests.
Hence, timestamps and other information that changes with duplicate request handling is not recorded.
•If diameter retry feature is enabled then T-bit enabled request handling overrides this feature and it also stores the responses.
3.7.4 NCHF (N40) initial request handling Identification of duplicate NCHF initial request: If an NCHF (N40) create request is received for a device which has one or more N40 sessions, and the PDU session information ( pduSessionID ) of one of the stored sessions matches with that of the received session request, then the received session request is identified as a duplicate request.
Handling of duplicate NCHF initial request: When a duplicate request is received, and no update transactions are received for the existing data session, then CHF compares the 3gpp-Sbi-Origination-Timestamp value of the session request against the timestamp of the stored session.
In the following cases, CHF returns a successful result: •The received session request or stored session does not have a 3gpp-Sbi-Origination-Timestamp value.
•The received session request has a 3gpp-Sbi-Origination-Timestamp value which is not earlier than the timestamp of the stored session.
CHF also updates the existing session with the 3gpp-Sbi-Origination-Timestamp value of the received session request.
The old reservation is cleared and new reservation logic is executed according to the new session request.
Metrics are generated.
In the following cases, CHF rejects the received session request: •Update transactions are already received for the existing data session.
•The received session request has a 3gpp-Sbi-Origination-Timestamp value which is earlier than the timestamp of the stored session.
CHF rejects the session request with the HTTP status code 403 and the application error LATE_OVERLAPPING_REQUEST .
Metrics are generated.
Note the following points about this feature: •If the InvocationSequenceNumber of the received request is equal to that of the stored sessions, then it implies that no update transactions are received for the existing data session.
•CDR is not generated for duplicate requests.
Hence, timestamps and other information that changes with duplicate request handling is not recorded.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.144Charging User Guide Call mangement •For duplicate requests, the rating or charging logic is re-executed.
Hence, response or action may differ in some cases as per the rating condition.
•Format of 3gpp-Sbi-Origination-Timestamp : Header encoding follows the ABNF as defined in IETF RFC 7230 [31].
3gpp-Sbi-Origination-Timestamp format = "3gpp-Sbi-Origination-Timestamp" ":" day-name "," SP date1 SP time-of-day "."
milliseconds SP GMT Example: 3gpp-Sbi-Origination-Timestamp: Sun, 04 Aug 2019 08:49:37.845 GMT 3.8 Session-based provisioning RAR throttling This feature provides a method to prevent overloading the PGW with too many RARs in a small timeframe.
REST APIs, such as create_subscription and delete_subscription may send RARs, and in case of many bundle subscriptions or removals API execution, many RARs are triggered in a short span of time.
It is possible to send RAR at least at the end of this provisioning sequence to finally update the Gy session with all the changes.
Therefore, this feature introduces RAR throttling by limiting the number of RARs sent in a defined interval.
In case throttling is applied, a single RAR can be scehduled to be sent after a time interval passes and other RARs are ignored.
3.8.
1 Configuration This feature can be enabled from the SM GUI following the given steps: 1.Navigate to the Diameter / HTTP Configuration and browse to ROUTING .
2.Select Outbound Configuration from the hamburger menu (☰) and select + to create a new outbound configuration.
3.
•For 4G outbound configuration: Note : The Provisioning RAR Delay can have a value that ranges between 0 to 600 in seconds.
•For 5G outbound configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.145Charging User Guide Call mangement Note : The Provisioning RAR Delay can have a value that ranges between 0 to 600 in seconds.
4.Save the configuration.
Note : For more information on Provisioning RAR Delay field, refer to the Diameter/HTTP Configuration Guide .
3.9 Generic RAR Throttling per PGW Currently NCC does not control the count of outbound Request(RAR) sent across the GW and on cases where bulk outbound request are done that can make the GW unstable.
So flexibility is included to NCC which gives the throttling on outbound requests, that defines the limit by which NCC governs control for outbound request and prevents the GW from being bombarded.
Property Name Property Description RAR Scheduler Rate / Notify Scheduler Rate This shows the number of RARs/ Notify to be sent in 1 sec.
If this value is 0, it means throttling is disabled.
If the value is greater than 0 and less than and equal to 99999, it means that the throttling is enabled.
RAR Pacing factor / Notify Pacing factor This determines the pacing at which RAR / Notify is throttled.
This decides how many RAR / Notify is sent in 1 burst and the time interval between two consecutive bursts.
Number of RAR / Notify in 1 burst = ( RAR / Notify Scheduler Rate) / ( RAR / Notify Pacing factor) Time interval between two consecutive bursts ( in milliseconds) = 1000 / ( RAR / Notify) Pacing factorTable 19: Parameters in OutboundConfig Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.146Charging User Guide Call mangement Property Name Property Description Note : This is the tuning parameter, hence its value must not be too large (the recommended value is 1 to 10) .
Default value is 1.
RAR Polling interval / Notify Polling Interval This parameter is used to define the RAR / Notify message timeout.
This value is in milliseconds.
RAR Throttling Category List / Notify Throttling Category ListThis contains the list of categories on which throttling is applied like AUDIT, PROVISIONING and ON_ CALL.
Default value is PROVISIONING.Table 19: Parameters in OutboundConfig (continued) Note : 1.Rate of rar or notify on each app node = ( rarSchedularRate / notifySchedularRate configured) or number of active node .
2.If any calculation ends up with the floating point number, then the fractional part is discarded.
For example: [ 10.4 = 10, 0.4 = 1, 100.9999 = 100 and so on ] 3.
10 Redirection functionality Overview NCC supports redirection to an URL, or graceful termination of the service.
For example, during a session, when the credit runs low or is exhausted, NCC can redirect the call for recharging, and send a RAR for the session after recharge to ensure the continuity of the session.
External Equipment (EE) tries to book quota slices.
But, as there is insufficient credit in the user account to accept the reservation, the charging service responds with a result code to warn the EE of non-availability of credit in the sub-session.
After the account is recharged, the OCS sends RAR for re-authorization of credit and call continuity.
A redirection timer can be used to add to the slice validity time (for the session) when redirection has to happen.
This allows redirection to happen without closing the session.
The corresponding TEMEntities get updated as per the validity time in the rule.
The graceful termination of the ongoing session happens when the subscriber has consumed all the final granted units.
The Final-Unit-Action AVP defines the behavior of service element when the user account cannot cover the cost of the service and must always be present when the Final-Unit-Indication AVP is included in a command.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.147Charging User Guide Call mangement The Restriction-Filter-Rule AVP or the Filter-Id AVP is present in the Credit-Control-Answer message to check whether the user is also allowed to access other services not accessible through the address given in the Redirect-Server AVP.
Following are the Final-Unit-Action AVP values: •TERMINATE : The Final-Unit-Indication AVP with Final-Unit-Action TERMINATE can also include GSU with cc-total-octets , and Tariff-Time-Change .
•REDIRECT : If the Final-Unit-Action AVP is set to REDIRECT , then at least the Redirect-Server AVP must be present.
•RESTRICT_ACCESS (currently not supported): If the Final-Unit-Action AVP is set to RESTRICT_ACCESS , then either the Restriction-Filter-Rule AVP or the Filter-Id AVP must be present.
See FUI AVP on page 152 for FUI AVP format.
Note : Redirection for main balance threshold is not supported.
See section 5.6 Graceful Service Termination in RFC 4006 for more details.
Assumptions Following assumptions apply to redirection feature: •Redirection is not applicable to the threshold linked to group or resources linked to group.
•Redirection support for Ro voice calls is not supported.
•In case of multiple MSCC, if redirection is done for a Rating Group (RG), then same is not applicable for other RG, if applicable.
•In cases of redirection where some grant (GSU) is also given in CCA, it is assumed that PGW does the redirection after consumption of the GSU units.
Redirection and termination behavior NCC behaves differently based on the configurations made.
Few cases are listed as follows: •Graceful session termination : Consider that an IMS session is ongoing.
Subscriber credit finishes including all buckets/balances used for charging the ongoing session.
In this case, Final Unit Indication in CCA.FUA = TERMINATE .
That is, FUI AVP is sent with terminate action.
The session gets terminated gracefully.
See the rule in the following figure.
•Redirection to a new destination number : For the case where OCS instructs MTAS/NGIN AS to connect to a new destination number based on the reported digits, the Service-Parameter-Info AVP can be used to pass the new destination number.
OCS can perform the logic according to Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.148Charging User Guide Call mangement specific configuration, that is, in this case, results in connection to a new destination number.
OCS instructs the MTAS/NGIN to proceed with the current call without OCS control (Result- Code=DIAMETER_CREDIT_CONTROL_NOT APPLICABLE) and pass the new destination number inside the Service-Parameter-Info AVPs (SP Type = 307, SP Value = new destination number in E164 format), together with announcement information, if applicable.
Example : IMS ABD call is made, Service-Parameter-Info AVP is used to carry the redirect information along with announcement information in response.
Pre-condition: Ensure that the following configurations are made: –Following Diameter VSA dictionaries are defined: •/opt/tpa/conf/sac/diameter/vsa/CustomVendorDefinition.xml •/opt/tpa/conf/sac/diameter/vsa/AttributeDefinition.xml •/opt/tpa/conf/sac/diameter/rule/ChargingVsaToContextMapping.xml –Complex map and Charging RSV is configured to set Service-Parameter-Info in response.
–Charging RSV is configured to set Announcement information in response.
–Diameter result code 4011 is configured in response to redirect scenario.
Complex Map table configuration : Charging RSV rule configuration for trigger IMS_CALL_ESTABLISHMENT : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.149Charging User Guide Call mangement Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.150Charging User Guide Call mangement Expected result: The correct Result-Code, Service-Parameter-Info, and announcement information is set to CCA.
•Redirection to a URL : Consider that a Gy session is ongoing.
Subscriber credit finishes including all buckets or balances used for charging the ongoing session.
In this case, consider that a redirection URL is configured.
Subscriber is redirected to the configured URL.
Subscriber recharges.
RAR is sent to gateway in case of Gy session.
To continue the session, the new MSCC in update and terminate feature is used.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.151Charging User Guide Call mangement Note the following additional points: •Operators can configure the redirect URL per Rating Result Code from rating.
This ensures that the redirection is made to the right server based on the condition of the call.
There can be different servers to redirect to based on the status of call (result_code).
For example, if the account is in barred state, redirect to customer care.
If a subscription is exhausted, redirect to self-care.
Operators can create any condition that is supported in the RATING_POST_PROCESSING trigger.
In most of the cases, MSCC and rating result code is used.
•NCC behaves differently based on the value indicated in the Final-Unit-Action AVP.
Based on the value, NCC may perform the actions TERMINATE or REDIRECT .
•Operators can also configure NCC not to send Final-Unit-Action set to REDIRECT , but TERMINATE , which can be done using rules.
•If the Final-Unit-Indication action is set to TERMINATE and if the subsequent call is of type Update , then RSU is ignored and the session is terminated.
•If the MSCC result code is 4012 and FUI rules with redirect action is configured in the RATING_POST_PROCESSING trigger, then the validity time of Gy session is set to 24 hours.
The session audit clears the session after this time.
The Validity Time configured in the rule does not impact the default behavior.
FUI AVP The FUI AVP format is as follows.
Final-Unit-Indication ::= < AVP Header: 430 > { Final-Unit-Action } *[ Restriction-Filter-Rule ] *[ Filter-Id ] [ Redirect-Server ] Terminate action The Final-Unit-Indication AVP with Final-Unit-Action TERMINATE can also include GSU with cc-total-octets, and Tariff-Time-Change .
When the subscriber has consumed the final granted units, the service element terminates the service.
This is the default handling applicable whenever an unsupported Final-Unit-Action value is received.
A final Credit-Control-Request message to NCC is sent when the Final-Unit-Indication AVP indicating action TERMINATE was present.
The CC-Request-Type AVP in the request is set to the value TERMINATION_REQUEST .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.152Charging User Guide Call mangement Redirect action The Final-Unit-Indication AVP with Final-Unit-Action REDIRECT indicates that upon consumption of the final granted units, the subscriber must be redirected to the address specified in the Redirect-Server AVP.
Additional information When NCC is configured to trigger FUI with any FUA value, it grants final zero quota.
When NCC had previously triggered FUI with any FUA value, it can accept the final zero used quota.
NCC accepts any incoming RSU and USU after the Final-Unit-Indication , and grants the quota accordingly or triggers a new Final-Unit-Indication with GSU.
NCC allows the gateway to request new quota even after the target service (MSCC/MUU) has been finalized with CCR that had Reporting-Reason AVP as Final .
Result codes See Appendix: Result codes on page 2265 for charging result codes.
Examples All the scenarios listed in this section work for IMS as well.
Configure FUI rules in GY_CREDIT_REQUEST only in case device is in barred state and request type is INITIAL .
Example 1: Not enough credit (partial reservation case) NCC receives a GY CCR(U) but does not have sufficient balance to reserve all the RSU.
Only partial reservation is possible.
It sends CCA with 2001 result code and FUI AVP with 2002 at MSCC level.
Configure a rule with RATING_POST_PROCESSING trigger as follows: For CCA with FUI AVP within MSCC AVP for update message is received.
AVP Validity-Time: 448 , M: true , V: 0 , value: 390 (unsigned32) Group Final-Unit-Indication: 430 , M: true , V: 0 AVP Final-Unit-Action: 449 , M: true , V: 0 , value: 1 (enumerated) Group Redirect-Server: 434 , M: true , V: 0 AVP Redirect-Address-Type: 433 , M: true , V: 0 , value: 2 (enumerated) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.153Charging User Guide Call mangement AVP Redirect-Server-Address: 435 , M: true , V: 0 , value: www.redirectURLRSV.com (UTF8String) In this example, the validity time is 390.
Out of which, 360 is from quota management profile (slicing profile) and 30 is configured in the rule.
When the call is redirected to the specified URL and the device renews the subscription, NCC sends a RAR message followed by RAA from the PGW.
Thereafter, PGW comes back with CCR(U) for the same session and the call continues.
Example 2: No balance available (4012 case) NCC receives a GY CCR(U) but does not have balance even for partial reservation.
It sends CCA with 2001 result code and FUI AVP with 4012 at MSCC level.
Configure a rule with RATING_POST_PROCESSING trigger as follows: CCA with FUI AVP for update message is received.
Group Final-Unit-Indication: 430 , M: true , V: 0 AVP Final-Unit-Action: 449 , M: true , V: 0 , value: 1 (enumerated) Group Redirect-Server: 434 , M: true , V: 0 AVP Redirect-Address-Type: 433 , M: true , V: 0 , value: 2 (enumerated) AVP Redirect-Server-Address: 435 , M: true , V: 0 , value: www.notEnoughBalanceRedirect.com (UTF8String) In this case, GSU is not granted.
As specified in the assumptions, the validity time of Gy session is set to 24 hours.
Example 3: Account is in barred state Charging is done from the account (main balance) and it is in barred state.
Condition is on rating result code 20007 NOT_ENOUGH_CREDIT_ACCOUNT_BARRED Configure the following charging rule for RATING_POST_PROCESSING trigger.
if CALL_COMMON.Rating.Result-Code = 20007 then RATING.Final-Unit-Action-Redirect ( "http://www.nokia.com" , 60, RedirectAddressType_URL ) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.154Charging User Guide Call mangement CCA with FUI AVP successful initial message received.
Group Final-Unit-Indication: 430 , M: true , V: 0 AVP Final-Unit-Action: 449 , M: true , V: 0 , value: 1 (enumerated) Group Redirect-Server: 434 , M: true , V: 0 AVP Redirect-Address-Type: 433 , M: true , V: 0 , value: 2 (enumerated) AVP Redirect-Server-Address: 435 , M: true , V: 0 , value: http://www.nokia.com (UTF8String) Example 4: Account barred during update NCC receives GY CCRI and sends CCA.
The account state is changed to barred.
NCC receives GY CCRU (an update request) and sends CCA with 4010 mscc result code, FUI AVP at MSCC level.
Charging is done from the main account balance.
Configure a charging rule with RATING_POST_PROCESSING trigger.
Condition is on rating result code that is 41019 NEW_RES_NOT_ALLOWED_ACCOUNT_BARRED .
if CALL_COMMON.Rating.Result-Code = 41019 then RATING.Final-Unit-Action-Redirect ( "http://www.nokia.com" , 60, RedirectAddressType_URL) CCA with FUI AVP for update message is received.
Group Final-Unit-Indication: 430 , M: true , V: 0 AVP Final-Unit-Action: 449 , M: true , V: 0 , value: 1 (enumerated) Group Redirect-Server: 434 , M: true , V: 0 AVP Redirect-Address-Type: 433 , M: true , V: 0 , value: 2 (enumerated) AVP Redirect-Server-Address: 435 , M: true , V: 0 , value: http://www.nokia.com (UTF8String) 3.
11 Stale session audit NCC maintains three kinds of sessions as follows: •Diameter Gy session : It is maintained by the Call Controller and identified by the Diameter Session-Id.
•VoL TE IMS Ro session : It is maintained by the Call Controller.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.155Charging User Guide Call mangement •Charging session : It is maintained by the Rating Engine, and identified by the Diameter Session-Id and MSCC Rating-Group or Service-Identifier.
A Diameter Gy session is considered as a stale session if all of the associated charging sessions have expired.
When a Diameter Gy session expires, audit initiates a re-authorization service for the expired Gy session by issuing a Re-Auth-Request (RAR) message to the network.
Audit for VoL TE IMS Ro session clears the stale IMS session along with the corresponding rating session on the expiry of validity time of MSCC in IMS session.
The audit mechanism triggers a RAR message to check the expiry of the IMS session.
The session is cleared if the RAA message is unsuccessful and session maintained if the RAA message is received successfully.
The expiry of a charging session is determined by the value of Validity-Time (VT) AVP present in the Multiple-Services-Credit-Control (MSCC) AVP.
However, the VT can be modified through rules in the Quota Management Profile (slicing profile) entity using the SM GUI.
When a charging session expires, audit initiates a re-authorization service for the expired charging session by issuing RAR message to the network.
Unlike the RAR sent for re-authorizing a Gy session which consists of Session-Id only, the RAR sent for charging session has either Rating-Group AVP or Service-Identifier AVP.
A successful re-authorization (Diameter result code = 2xxx) indicates that the session is active and should not be cleared.
Otherwise, the session is cleared.
The following figure shows the VT variable in the SM GUI: Audit behaviour Audit Type Result Code Behaviour Session 2001 Extends for Gy Inactivity Timer ( 24 hrs)Table 20: Single MSCC Calls Audit Behaviour Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.156Charging User Guide Call mangement Audit Type Result Code Behaviour Session Any other than 2001 Clear session Session With Unknown Result Any other than 5002 Extends for Gy Inactivity Timer ( 24 hrs) Session With Unknown Result 5002 Clear session MSCC 2001 Extends for Gy Inactivity Timer ( 24 hrs) MSCC Any other than 2001 Clear session MSCC With Unknown Result Any other than 5002 Extends for Gy Inactivity Timer ( 24 hrs) MSCC With Unknown Result 5002 Clear sessionTable 20: Single MSCC Calls Audit Behaviour (continued) Audit Type Result Code for VT1 Expiry Behaviour Session 2001 Extends for VT2- VT1 ( 30 secs) Session Any other than 2001 Clear session Session With Unknown Result Any other than 5002 Extends for VT2- VT1 ( 30 secs) Session With Unknown Result 5002 Clear session MSCC 2001 Extends for VT2- VT1 ( 30 secs) MSCC Any other than 2001 Clear sessionTable 21: Multiple MSCC Calls Audit Behaviour (Assume VT1=30secs, VT2=60secs) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.157Charging User Guide Call mangement Audit Type Result Code for VT1 Expiry Behaviour MSCC With Unknown Result Any other than 5002 Extends for VT2- VT1 ( 30 secs) MSCC With Unknown Result 5002 Clear sessionTable 21: Multiple MSCC Calls Audit Behaviour (Assume VT1=30secs, VT2=60secs) (continued) Note : The application preference Stale N40 Gy Session Audit Algo handles how audit RAR is transmitted.
By default the audit RAR is transmitted per MSCC.
It is applicable for Gy/N40/IMS interface.
1.For 5G Result codes are mapped as 2001 → 201 and 5002 → 404 (with error cause SUBSCRIPTION_NOT_FOUND ).
2.To remove the sessions for Session With Unknown Result and MSCC With Unknown Result in case of 5G, result code mapping has to be added for 404 with error cause code SUBSCRIPTION_NOT_FOUND to 5002 in ChargingServiceConversion.xml as follows: 3.Reload required after changes in ChargingServiceConversion.xml .
<!-- ============= Charging side mapping starts here ================= --> <diameterInitiatedExchange httpType="Nchf_ConvergedCharging_Notify" diameterApplication="N40" diameterCommand="Re-Auth-Request"> <request> <converter ref="ChargingNotifyRequest"/> </request> <response> <diameterResultCodeMap defSuccessResultCode="DIAMETER_SUCCESS" defFailureResultCode="DIAMETER_UNABLE_TO_COMPLY"> <valueMap httpStatusCode="404" httpErrorCause="SUBSCRIPTION_NOT_FOUND" diameterResultCode="DIAMETER_UNKNOWN_SESSION_ID"/> → Only this line to be added </diameterResultCodeMap> </response> </diameterInitiatedEx Previously, session audit was done through TEMEntity (a separate set in DB), and TEMScanner .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.158Charging User Guide Call mangement Currently, session audit can be executed through DDTEMEntity (a part of the tem bin in DynamicData ), and DDTEMScanner .
If the application preference Use DynamicData TEM for sessions is set to 1, then the new DDTEMEntity , and DDTEMScanner are used for session audits.
It is applicable only for CNF environment.
Note : For more details on the application preference Use DynamicData TEM for sessions , refer to section Managed Element application preferences in the Global Configuration Guide .
3.
12 Real-time update and session update NCC supports the Real-time Update for Query and Session Update on Provisioning .
The administrative (provisioning) operations take into account the calls/sessions in progress.
NCC sends a RAR to update existing calls or sessions with a view of the provisioned products, or to retrieve current usage to populate the result.
Real-time update For Real-time Update for Query , when a provisioning request comes to query balance/bucketinstance/ counterinstace data, NCC performs the following tasks: 1.Sends a RAR for all active sessions 2.Collects CCRs and returns unused quota The preceding tasks are performed so that an accurate view of available resources can be returned in the query response.
Session update For Session Update on Provisioning , provisioning commands can request that any sessions in-progress must be updated.
That is, RAR is sent out for these sessions once execution of the command is completed.
Provisioning request The SM REST APIs are supported for the provisioning request.
In these APIs, the parameter updateSession specifies how the calls/sessions in-progress must be informed of the sending RAR operation.
For update/Subscription REST API, the RAR is always sent for ongoing sessions.
update Session Description 0 Sending RAR disabled.
1 Send RAR and Forget.
Not wait for RAA or CCR- U.
Immediate response to HLAPI.
2 Send RAR and wait for CCR- U to get reported.
Mostly to be used for Balance query of accounts or buckets.Table 22: updateSession parameter Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.159Charging User Guide Call mangement update Session Description 3 Send RAR ( to all Gy sessions of Devices/ Groups of Account irrespective of whether they consumed from main balance or not) and forget.Table 22: updateSession parameter (continued) The parameter updateSessionResult in response communicates the result of RAR.
update Session Result Description 0 Sending RAR successful.
1 Sending RAR unsuccessful.
2 All CCR- U received.
Applicable only for Real- time Update for Query.
3 Partial CCR- U received.
Applicable only for Real- time Update for Query.
4 No CCR- U received.
Applicable only for Real- time Update for Query.Table 23: updateSessionResult parameter REST API details The following table provides information on REST APIs, RAR, and updateSessions supported.
Note that 0 indicates that sending of RAR is disabled and by default 0 is supported for all the APIs listed.
REST API Send RAR Before/ After update Session Supported GET: / subscriber/ getData/ AVInstanceBefore 1 GET: /subscriber/ getData/ Bucket InstanceBefore 1 and 2 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.160Charging User Guide Call mangement REST API Send RAR Before/ After update Session Supported PUT: / subscriber/ update/ Bucket InstanceAfter 1 GET: / subscriber/ getData/ Entity Counter InstanceBefore 1 and 2 GET: / subscriber/ getData/ Account Before 1 and 2 GET: / subscriber/ getData/ Device Before 1 GET: / subscriber/ getData/ Group Before 1 PUT: / subscriber/ update/ Device After 1 PUT: / subscriber/ update/ Group After 1 DELETE: / subscriber/ delete/ Device Before 1 DELETE: / subscriber/ delete/ Group Before 1 PUT: /subscriber/ update/ adjustbalance/ AccountAfter 1 PUT: /subscriber/ update/ setaccountbalance/ AccountAfter 1 and 3 PUT: / remove Device Counter/ Counter Before 1 PUT: /remove Device Group Counter/ CounterBefore 1 PUT: /remove Group Counter/ Counter Before 1 PUT: /addDevice Counter/ Counter After 1 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.161Charging User Guide Call mangement REST API Send RAR Before/ After update Session Supported PUT: /addDevice Group Counter/ CounterAfter 1 PUT: /addGroup Counter/ Counter After 1 3.
13 Trigger attribute support 3.
13.
1 Trigger AVP support for VoL TE/ViL TE/Gy calls This section provides information about the support for the Trigger AVP in NCC for VoL TE, ViL TE, Gy calls.
NCC call controller supports Trigger AVP in CCA for VoL TE and ViL TE calls using rules.
This support is also available for Gy interface.
The Trigger AVP is supported for both decentralized and centralized calls.
This AVP comes into picture only if some quantity is reserved and granted in CCA.
A CDR tag is generated with the value of trigger reported in the CCR.
Trigger AVP The Trigger AVP (AVP code 1264) is of type Grouped and holds the trigger types.
The presence of the Trigger AVP without any Trigger-Type AVP in a CCA allows OCS to disable all the triggers.
The presence of the Trigger AVP in the CCR identifies the event(s) triggering the CCR.
It has the following ABNF grammar: Trigger ::= < AVP Header: 1264 > * [ Trigger-Type ] Trigger-Type AVP The Trigger-Type AVP (AVP code 870) is of type Enumerated and indicates a single reauthorization event type.
When included in the Credit-Control-Answer command, the Trigger-Type AVP indicates the events that cause the credit control client to reauthorize the associated quota.
The client do not reauthorize the quota when events, which are not included in the Trigger AVP occur.
When included in the Credit-Control- Request command indicates the specific event which caused the reauthorisation request of the Reporting- Reason with value RATING_CONDITION_CHANGE associated.
Application preference To enable Trigger AVP support in NCC, the application preference Trigger Feature Supported must be set to true .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.162Charging User Guide Call mangement Trigger Feature Supported And.
.. Then False - No change True Trigger Received in CCR- U is armedNo change True Trigger Received in CCR- U is NOT armedIgnores the triggered Value received in the request, takes the appropriate value from DB ( last request) and continue with existing logic.
Rule support In NCC, the Trigger-Type AVP is stored in the CALL_RESUL T.Trigger-Type result context attribute.
This attribute is available in the RATING_POST_PROCESSING rule set.
Example action: CALL_RESULT.Trigger-Type = TriggerType_CHANGE_IN_LOCATION For all valid values of Trigger-Type AVP, see CALL_RESULT result context on page 1264 .
Example: Media-Type trigger Set the application preference Trigger Feature Supported to true .
In initial request, set SDP-Media-Name as m=video 49170 RTP/AVP 0 .
If Trigger-Type CHANGE_IN_MEDIA_COMPOSITION is armed and it is received in CCRu also, then SDP-Media-Name is updated with the new value ( m=audio 49170 RTP/AVP 0 ) received in CCRu and charging happens from bucket bkt_audio .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.163Charging User Guide Call mangement Figure 31: Trigger setup in rules Figure 32: Media-based charging configuration in Tariff When running IMS call with different Media-type values in SDP-Media-Component : •In initial request, set SDP-Media-Name as m=video 49170 RTP/AVP 0 .
•In update request, set SDP-Media-Name as m=audio 49170 RTP/AVP 0 and Trigger-Type AVP as CHANGE_IN_MEDIA_COMPOSITION .
•In terminate request, do not set any SDP-Media-Name .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.164Charging User Guide Call mangement 3.
13.2 Trigger attribute support for 5G calls Overview This section provides information about the support for the Trigger AVP in NCC for 5G calls for both MSCC level and root level.
NCC call controller supports Trigger AVP in CCA for 5G, via rules.
This support is available for Gy interface.
The Trigge AVP is supported for both de-centralized and centralized calls.
This AVP comes into picture only if some quantity is reserved and granted in CCA.
Trigger AVP The Trigger AVP is of type Grouped and holds a single trigger type and other trigger information.
The presence of the Trigger AVP without any Trigger-Type AVP in a CCA allows OCS to disable all the triggers.
The presence of the Trigger AVP in the CCR identifies the event(s) triggering the CCR.
Trigger-Type AVP The Trigger-Type AVP is of type Enumerated and indicates a single re-authorisation event type.
When included in the Credit Control Answer command, the Trigger-Type AVP indicates the events that shall cause the credit control client to re-authorize the associated quota.
The client shall not re-authorize the quota when events which are not included in the Trigger AVP occur.
When included in the Credit Control Request command, it indicates the specific event which caused the re-authorisation request of the Reporting- Reason with value RATING_CONDITION_CHANGE associated.
Trigger-Category AVP This AVP indicates whether the charging data generated for the trigger lead to a charging event towards NCC immediately or not.
The valid values are described in the following table: Trigger category Description Trigger Category_ IMMEDIATE_ REPORT The charging data generated for a trigger leads to charging event towards NCC immediately.
Trigger Category_ DEFERRED_ REPORT The charging data generated for a trigger does not lead to a charging event towards NCC.
Trigger arming Adding triggers to a response is called arming.
This is done by selecting any triggerType except for NCHF_DISARMING .
In this case triggers are sent in response at the selected level.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.165Charging User Guide Call mangement There are a number of mid-session service events (triggers), which affect the rating of the current service usage, for example, end-user QoS changes or location updates.
Some of these services can be enabled/ disabled.
For such events, when allocating resources NCC may instruct to update the unit upon a number of different session-related triggers that can affect the rating conditions.
NCC instructs to monitor for such events by using the Trigger element containing a single trigger type.
Once the triggers are armed then these triggers remain in effect until other triggers are not armed.
Example of armed triggers in response Root level: {"invocationTimeStamp":"2020-07-27T09:05:23Z","invocationSequenceNumber":0,"triggers": [{"triggerType":"QUOTA_THRESHOLD","triggerCategory":"IMMEDIATE_REPORT","timeLimit":2100,"volumeLimit":1,"volumeLimit64":123,"maxNumberOfccc":1234}, {"triggerType":"VALIDITY_TIME","triggerCategory":"IMMEDIATE_REPORT","timeLimit":32100,"volumeLimit":31,"volumeLimit64":3123,"maxNumberOfccc":31234}],"multipleUnitInformation": [{"ratingGroup":5,"resultCode":"SUCCESS","grantedUnit": {"totalVolume":5368709120},"validityTime":"10","quotaHoldingTime":10}]} MSCC level: {"invocationTimeStamp":"2020-07-27T09:07:24Z","invocationSequenceNumber":0,"multipleUnitInformation": [{"ratingGroup":5,"resultCode":"SUCCESS","grantedUnit": {"totalVolume":5368709120},"triggers": [{"triggerType":"OTHER_QUOTA_TYPE","triggerCategory":"IMMEDIATE_REPORT","timeLimit":2100,"volumeLimit":1,"volumeLimit64":123,"maxNumberOfccc":1234}, {"triggerType":"GFBR_GUARANTEED_STATUS_CHANGE","triggerCategory":"IMMEDIATE_REPORT","timeLimit":32100,"volumeLimit":31,"volumeLimit64":3123,"maxNumberOfccc":31234}],"validityTime":"10","quotaHoldingTime":10}]} The following figure provides an example scenario for arming 5G triggers at MSCC level.
Figure 33: Example: Rule for trigger arming Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.166Charging User Guide Call mangement Trigger disarming Disarming can be done when the Triggers element is present without any trigger type in a response message.
This allows NCC to disable all the triggers that were armed in a previous Trigger element of the same service usage/rating group.
Removing triggers from a response is called as disarming.
This is done by selecting the triggerType as NCHF_DISARMING .
In this case, an empty trigger list is sent to SMF, which indicates disarming of all triggers at the selected level.
Note : NCHF_DISARMING is a custom trigger type and is not present in the specification for the triggerType enum.
It is provided for configuring trigger disarming.
Example of disarmed triggers in response Root level: {"invocationTimeStamp":"2020-07-22T14:01:28Z","invocationSequenceNumber":0,"triggers": [],"multipleUnitInformation": [{"ratingGroup":5,"resultCode":"SUCCESS","grantedUnit": {"totalVolume":5368709120},"validityTime":"10","quotaHoldingTime":10}]} MSCC level: {"invocationTimeStamp":"2020-07-27T09:14:08Z","invocationSequenceNumber":0,"multipleUnitInformation": [{"ratingGroup":5,"resultCode":"SUCCESS","grantedUnit": {"totalVolume":5368709120},"triggers": [],"validityTime":"10","quotaHoldingTime":10}]} The following figure provides an example scenario for disarming 5G triggers at MSCC level.
Figure 34: Example: Rule for trigger disarming Configuring triggers in response Application preference Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.167Charging User Guide Call mangement To enable trigger in response, the application preference, Trigger Feature Supported must be set to true .
If it is set to false , then the triggers are not sent in the response, even if configured in rule.
Trigger Feature Supported And.
.. Then False - No change True Trigger Received in CCR- U is armedNo change True Trigger Received in CCR- U is NOT armedIgnores the triggered Value received in the request, takes the appropriate value from DB ( last request) and continue with existing logic.
Rule In rules, configure Arm-Nchf-Trigger attribute.
It has the following parameters: •TriggerLevel The values can be root or mscc .
Trigger type must be considered while adding this input.
•NCHFTriggerType •TriggerCategory •TimeLimit (optional) •VolumeLimit (optional) •VolumeLimit64 (optional) •MaxNumberOfCCC (optional) Consider the following points for NCHF triggers •For an N40 initial/update request, NCHF triggers can be present in both request and response.
•When sending a trigger list in the request, the triggerCategory must be sent.
If it is not available, then an error AVP is returned in response.
Refer to the following example: {"invocationTimestamp":"2020-07-27T14:07:05Z","invocationResult": {"error":{"type":"http:\/\/135.249.88.102:8081\/nchf- convergedcharging\/v1\/chargingdata\/N40-sps-me-b988747c- a282-4491-b5f7-679968eaa955\/update","title":"Attribute missing","status":400,"detail":"triggerCategory is not present Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.168Charging User Guide Call mangement at UsedUnitContainer level in 5G UPDATE_REQUEST","instance":"sps- me\/sps102\/N40-sps-me-b988747c-a282-4491- b5f7-679968eaa955","cause":"MANDATORY_IE_MISSING"}},"invocationSequenceNumber":1} •In requests, NCHF triggers are used in rules with NCHF_CHARGING_MESSAGE source context.
•In responses, NCHF triggers can be sent at two levels (that is, root or MSCC ).
Note : Arming or disarming of triggers at root level disables all the changes accepted at MSCC level.
–Root level: NCHF_CHARGING_CALL_ESTABLISHMENT and NCHF_CHARGING_CALL_MODIFICATION triggers are configured at root level.
.
Note : In this configuration, while arming the trigger, the triggerLevel is set as root .
–MSCC level: RATING_POST_PROCESSING trigger is configured at MSCC level.
Note : In this configuration, while arming the trigger, the triggerLevel is set as mscc 3.
14 5G support for OCS index server Service providers may have an existing OCS with subscriber data.
When they use NCC alongside the existing OCS, the traffic may have to be routed accordingly.
To handle such cases, this feature supports the PGWs to route all the Fixed Wireless Access (FWA) traffic through DRouter.
It does not consider whether the subscriber is from NCC or other OCS such as SurePay.
To get the information about where the subscriber data is present, LDAP interface between NCC and Index server is used.
The following figure shows the flow of messages between NCC, SM, Index server, and DRouter.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.169Charging User Guide Call mangement When a subscriber is added to NCC, the ME updates its local database and triggers the LDAP request to SurePay Index server to sync-up the device data.
The subscriber ID (MDN) and host ME details are stored in the DRouters.
When the SurePay Index server receives the self-learning/self-healing request from DRouters, it broadcasts the request to all the OCS nodes including SMs.
If the device information is present on SM, then NCC sends a response to SurePay Index server including the ME (ME host information) on which the device resides.
In cases where the existing subscribers are removed from NCC, the ME notifies the DRouters to remove the record for that subscriber from their database.
If the assume positive feature is turned off and a subscriber is not found in a call, then the result code 5030 is returned.
Assumptions Following are the assumptions considered for this feature.
•This feature focuses on the LDAP communication between SurePay and Index server.
It has no impact on Diameter call logic.
But, there is one exception, that is, for Gy call, it returns 5030 if the device is not found.
When NCC receives self-learning or self-healing request, it compares the subscriber ID in the LDAP message with device ID in the NCC database with device type E164.
•END_USER_E164 type Subscription ID is always included in the Diameter message and E164 type configured in NCC has highest priority in the Diameter request.
•For self-learning or self-healing, only type S (MSISDN) is supported.
N (IMSI) and G (Group) are not supported.
That is, only device level is supported and group level is not supported.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.170Charging User Guide Call mangement •When NCC receives self-learning or self-healing request, it provides a response to the specific Index server that sent the request.
NCC does not broadcast the subscriber's host name to other Index servers.
•Service sensitive routing is not supported.
Configuration Attention : Ensure that the following external SPR parameters for LDAP are configured.
•tpaproperties/sprexternal/enabled •tpaproperties/sprexternal/concentratortimeout •tpaproperties/sprexternal/concentratorconnections To configure the LDAP connection with SurePay DRouter Index server, perform the following steps: 1.Provision the LDAP External Server Configuration entity with type value as LDAP-INDEX-SERVER .
To do this, navigate to Common Configuration > Charging tab and select LDAP External Server Configuration from the drop-down list.
Click + to create a new record and select the LDAP-INDEX- SERVER as value type.
The following entity must be configured for each SurePay Index server.
2.In the SurePay DRouter Index server, ME host name (ME floating IP) must be added to /etc/hosts .
Note that the ME host name configured in /etc/hosts on ME must be same with that configured in the SmManagedElement table on SM.
3.In the SurePay DRouter Index server, configure the SM IO Node and SM host name in the / etc/hosts directory.
Configure the SurePay platform table (rcv:menu) 9.1 ~ 9.5 to support the Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.171Charging User Guide Call mangement SMHostName_request_data dataview.
In SurePay platform table 9.1, add ME hostname record and in 9.2, add host name, port, and LDAP.
Note the following important points related to LDAP configuration: •Configure the LDAP port and password to be consistent with that configured in the SurePay Index server.
That is, the port and password must be consistent between SM and SurePay Index server.
•Configure the Primary IP Address to be SurePay Index Server IO node ip address.
•Configure the User DN as dview=IndexServerHostname_Hier_Req .
•Configure the LDAP Version as 2 because SurePay index server only supports version 2.
Examples Example 1: Device found for self-healing query from DRouter A Diameter Gy call is triggered to SurePay Drouter and subscriber is found in the GPRSSIM DB.
Following is the flow of events: 1.DRouter routes the call based on the host names (ME) configured in the GPRSSIM DB.
2.ME receives the call and device ID is not found in ME, 5030 is returned to DRouter.
3.Self-learning or self-healing feature is turned on for DRouter.
DRouter sends the self-healing request to Index server.
4.SurePay Index server broadcasts the self-healing query to all the configured OCS, including SM with LDAP dataview request_data.
5.SM finds the subscriber configured in the NCC database.
Therefore, NCC returns the correct Device ID and host ME to Index server.
LDAP server configuration The LDAP server must be configured in the SM Application Preferences.
To configure LDAP server in the SM Application Preferences, 1.Go to PREFERENCES (see Service Managers section in Global Configuration Guide ).
2.Configure the LDAP User Name and LDAP Password.
Note : The LDAP Password must be same in NCC and Index server.
Device ID configuration Consider that a device with Device ID 888000002 is configured in the AppNode as shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.172Charging User Guide Call mangement The device with Device ID 888000002 is not available in the ME.
When queried for Device ID 888000002, the following message is displayed.
SurePay DRouter query When checked in the SurePay DRouter, the device information is not correct for the Device ID 888000002.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.173Charging User Guide Call mangement Self-learning or self-healing in DRouter Since the self-learning/self-healing feature is turned on for DRouter, the DRouter sends the self-healing request to Index server.
LDAP search request is sent to each OCS configured and the response is received from each OCS.
The Gy message is routed to the correct host.
Device record updated in GPRSSIM In SurePay DRouter, the device information is corrected for the Device ID 888000002.
Now, SM finds the subscriber configured in the NCC database and returns the correct Device ID and host ME to Index server.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.174Charging User Guide Call mangement 3.
15 Map lifecycle state to a policy counter ID When subscribers opt for offers such as Fixed Wireless Access (FWA), the new OCS device is put into a temporary lifecycle state.
This is done to prevent the data sessions until all the network elements are configured.
Once the network elements are correctly configured, the device transition to an active lifecycle state that allows the data transfer.
The HLAPI initializes the device lifecycle's initial state when device is created using the AddRTRProfile task and consequently changes the lifecycle state using the UpdateRTRProfile task.
The Policy Counter (PC) status is stored through a Send SNR action for a policy counter so that the value is returned in a subsequent SLR-I received from the PCRF.
This feature is only applicable to the device entity lifecycle.
Assumptions •The lifecycle of the device cannot be changed or removed without removing the device.
Therefore, it is not necessary to define a specific PC status when a device entity lifecycle is removed.
•When a device is created, as a first step, the lifecycle state always changes from Start to Pre-active with timer = 0 configuration.
The further lifecycle states are changed according to the SIM state in the AddRTRProfile task.
Configuration This feature does not contain the Policy Counter Definition.
For example, consider that PLC1 , PLC2 , and PLC3 are existing policy counters whose definition is in a counter or charging service.
To configure this feature, you can enter PLC4 for Policy Counter Name in the Lifecycle entity with a value for policy counter status.
See Example on page 176 for lifecycle related details.
AddRTRProfile task When a device is created using the AddRTRProfile task, the device lifecycle state is set to Pre-Active since timer=0 transition is configured in the Start state.
The Send S N R Action is executed and PCID=LFS and PCS=0 is stored with lifecycle state Pre-Active in database.
See Lifecycle states on page 177 for sample lifecycle states.
In the AddRTRProfile task, the lifecycle states change based on the values passed in the SIM state.
1.If the SIM state is not passed or the value is empty, then the current lifecycle state is retained as Pre- active state.
2.If the SIM state is passed as Pre-Active , same as its current state, then the lifecycle state is retained as Pre-Active .
3.If the SIM state is passed as Suspend , then the device lifecycle state is changed to Suspend state.
A Send S N R Action is executed and Policy Counter Name (PCID) = LFS and Policy Counter Status (PCS) = 2 is stored with the lifecycle state as Suspend in the database.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.175Charging User Guide Call mangement 4.If the SIM state is passed as Suspend2 , and there is no transition defined between Pre-Active and Suspend2 , then the lifecycle state is retained as Pre-active state and an error message in the HLAPI response is returned.
If SLR arrives for this device, SLA is returned with PCID=LFS and PCS=<Memorized Policy Counter Status>.
UpdateRTRProfile task In the UpdateRTRProfile task, the lifecycle states change based on the values passed in the SIM state: 1.If the SIM state is not passed or the value is empty, then the current lifecycle state is retained.
2.If the SIM state is same as the current lifecycle state, then the current lifecycle state is retained.
3.If the SIM state is passed and the value is a valid state of the device lifecycle, and the value is different from the current state, then the device lifecycle is changed to the SIM state and Send S N R Action is executed.
•If a new PCS is same as the current PCS in the device lifecycle, the PCS is not stored again, and irrespective of whether there is an ongoing Sy session or not, SNR is not sent.
•If a new PCS is different from the current PCS in the device lifecycle, then the new PCS is stored in the database and the SNR is sent based on the following scenarios: If... Then.
..
There is an ongoing Sy session for the deviceSNR is sent with the PCID = LFS and PCS = <memorized Policy Counter Status> .
The PCID and PCS is stored in the device information.
There is no ongoing Sy session for the deviceDevice does not send SNR message.
The PCID and PCS is stored in the device information.
Example Consider that a device named FWA_Device with Fixed Wireless Access (FWA) subscription is added using the AddRTRProfile task.
The lifecycle is defined with states Start , Pre-active , Active , Suspend , and Suspend2 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.176Charging User Guide Call mangement The initial device lifecycle state is set to Pre-active with timer = 0 configuration.
A Send SNR is executed and Policy Counter Name (PCID) = LFS and Policy Counter State = 0 is committed to memory with lifecycle state as Pre-active in the database.
After all the network elements are configured correctly, the device lifecycle state is changed from Pre- active to Active state.
Lifecycle states Following figure shows the different states configured in the lifecycle.
Note that the same policy counter name (LFS) is used for all the states.
Start state > Pre-active event Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.177Charging User Guide Call mangement Pre-active state > Active event Pre-active state > Suspend event Active state > Pre-active event Active state > Suspend event Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.178Charging User Guide Call mangement Suspend state > Pre-active event Suspend state > Active event Suspend state > Suspend2 event Suspend2 state > Suspend event 3.
16 TTC and VT management Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.179Charging User Guide Call mangement 3.
16.
1 VT randomization for new data sessions In certain cases, a burst of new data session requests may get triggered within a short interval in the network.
In such cases, randomizing the VT values returned to the network can make the subsequent update transactions triggered by VT expiration to spread over a longer interval reducing the size of subsequent burst if transactions are received at CHF.
The VT randomization feature provides VT randomization for new sessions managed on the CHF-Router when it provides the Assume positive treatment for an NCHF_ConvergedCharging_create request.
This is similar to the capability provided previously on the OCS Drouter.
If this feature is turned on, then the NCC logic randomizes the VT for new data sessions irrespective of whether there is a burst of new session requests or not.
Configuration To enable the VT randomization feature, configure the Interval For VT Adjustment (seconds) application preference.
This application preference generates a random number for VT adjustment.
When a non-zero value is configured, the final VT=VT - Random [0...value of this parameter].
The default value is 0.
VT calculation For the 4G and 5G data calls, when the initial message is received with Interval For VT Adjustment (seconds) configured to a non-zero value and no timed events such as subscription activation, subscription expiration, TOD start/end time are applicable for this data session, the VT is adjusted as VT in quota management profile (slicing profile) - Random [0..value of Interval For VT Adjustment (seconds) ].
If the value of Interval For VT Adjustment (seconds) is equal to or greater than VT in quota management profile (slicing profile), the VT is adjusted to VT in Slicing Profile-Random[0..(VT in Slicing Profile - 1)].
For 5G Assume Positive treatment handled by CHF-Router, the VT = VT from "APConfigurationForPeerGroup" - Random[0..value of Interval For VT Adjustment (seconds) ] .
If the value of Interval For VT Adjustment (seconds) is 0 or this parameter is not configured, then the base logic is used.
That is, VtFactor is obtained from "APConfigurationForPeerGroup".
However, if the value of Interval For VT Adjustment (seconds) is equal to or greater than VT from "APConfigurationForPeerGroup", the VT is adjusted to VT from "APConfigurationForPeerGroup" - Random[0..(VT from "APConfigurationForPeerGroup"-1)] .
3.
16.2 Disable TTC for prepaid accounts and alignment of TTC and VT for postpaid accounts This feature describes a new mechanism of computing VT and TTC in Diameter CCA-I or CCA-U requests, and Nchf_ConvergedCharging create or update responses when the validity time interval of a data session exceeds the activation time, renewal time, or expiration time for an in-use subscription.
It handles prepaid and postpaid accounts differently: •For prepaid accounts: Irrespective of the account balance, the TTC value is not set and only VT is computed considering the nearest BCR or other event and a configurable parameter VTAFprepaid so that a device does not continue to consume data post the current billing cycle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.180Charging User Guide Call mangement •For postpaid accounts: In case of BCR or any other similar event, when the policy counter status changes, the data usage done before and after those events should be counted in its respective billing cycle.
The TTC and VT values are computed as per the policy counter status change: –In case, the policy counter status does not change, the usage does not change from unthrottled to throttled at the TTC time.
Therefore, NCC allows a larger spread of VT to spread out the traffic.
–In case, the policy counter status change is expected, for example at T1, then it refers that the device is being throttled at T1.
Therefore, to avoid the data usage or to minimize the data usage in the new billing cycle without being throttled, the values of TTC and VT are set close to each other.
Note : For information on T1, please refer Parameters used in feature configuration on page 181.
Note : •Before this feature, only the next BCR time was considered as TTC entry from the entities where reservation was done but with this feature, the next to upcoming BCR time (which means, the second renewal time) is also considered as the TTC entry for subscriptions whose time is nearest in the sorted entry list.
For example, if two subscriptions are getting renewal at the same time, then the first subscription event ( T1) is the BCR time and the second subscription event ( T2) is minimum of the next to next BCR time of amongst the two subscriptions.
Next to next BCR time can be different due to reasons like change in account or bundle billing information.
•To consider the second renewal time ( T2) as TTC entry, in case of subscriptions from where reservation is done, the number of remaining renewals is set to at least 1.
•If the ELC-VT of a subscription is less than the BCR time, then two renewal times of the same subscription are not considered as TTC entries.
•For accounts, only the upcoming BCR time is fetched as generally, the periodicity of an account is not in days and due to which, the second renewal time ( T2) is very far away and not required in calculation.
•If the UC time of day is approaching and it is before any of the tariff change event times, then VT is set as the approaching time of day and no TTC is sent.
The UC time of day can be the T2 value (if found minimum than other TTC entries).
Parameters used in feature configuration Following parameters are used in formulas mentioned in this feature to compute VT and TTC: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.181Charging User Guide Call mangement Parameter Description T1 This refers to the upcoming subscription ( activation, renewal, or expiration) event, which is either triggered by an account BCR or subscription period lifecycle.
T2 This refers to the next subscription ( activation, renewal, or expiration) event after T1, which is either triggered by an account billing cycle or subscription period lifecycle.
T2 can also be a Time- Of-Day ( TOD) event.
VTAF This refers to the VT adjustment factor to randomize VT intervals.
TTCAF This refers to the TTC adjustment factor to randomize TTC intervals.
VTAFprepaid This refers to the shortened VT adjustment factor, which is used when TTC is not send for prepaid accounts.
Note : This parameter is only applicable to prepaid accounts.
TTCAFlarge This refers to the upper bound or higher TTC adjustment factor when VT is set to ( TTC + MINspread ) as per the computation.
Therefore, TTCAFlarge can be referred to as the maximum or higher limit of TTCAF .
MINspread This refers to the minimum interval between the VT and TTC.
VTs This refers to the validity time, which is configurable as per the rule groups or as per static configuration in quota management profile ( slicing profile) .
TEMP_ INTVL Upper bound of the BCR Reporting Time interval.
It is set based on the current time when a 4G or 5G transaction is received from the network.
•When there are no online flows, or VTs for online flows in the transaction, the OFLint does not reach T1.
Then, TEMP_ INTVL is set to OFLint .
•Else, if VTs reaches T1 but OFLint does not reach T1, then TEMP_ INTVL= VTs .
•Else if both OFLint and VTs reach T1, then TEMP_ INTVL = MIN[ VTs, OFLint] .
Computing TTC and VT Prepaid accounts behavior Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.182Charging User Guide Call mangement For prepaid accounts, the computation depends on the following factors: If... Then.
..
The Disable TTC parameter configured in a bundle is enabled,Irrespective of the type of device or account and whether the policy counter status is changed or not, the TTC value is not returned and VT is computed as per the time to T1 parameter.
For example, if a subscription event takes place at T1, then VT is reduced to T1 and TTC is not returned.
1.The Disable TTC parameter configured in a bundle is disabled, and 2.The account is of prepaid type,Irrespective of whether the policy counter status is changed or not, the TTC value is not returned and VT is calculated as per the following formula: •If there is no T2 or no next subscription event takes place before ( T1 + VTAFprepaid ), then VT = T1 + random value between 1 second and VTAFprepaid .
•If there are two subscription events happening, which means both T1 and T2 take place, then VT = time to T1 + random value between 1 second and (T2-T1) Note : If T1 has at least one subscription with validity time from entity lifecycle or the subscription for prepaid account type has reached the maximum renewal attempts, then VT is sent as per the calculation mentioned in the above table.
Postpaid accounts behavior For postpaid accounts, the computation depends on the following factors: If... Then.
.. 1.The Disable TTC parameter configured in a bundle is disabled, 2.The account is of postpaid type, and 3.The policy counter status or virtual policy counter (VPC) status does not change, which means the usage does not change from throttled to unthrottled at the TTC time,First, the TTC ( TTC_ Post Paid_ PC_No_Change ) is calculated and the TTC value is further used in computing the VT value.
1.
TTC is calculated as per the following conditions: •If there is no T2 or no next subscription event takes place before ( T1 + TTCAF ), then TTC = T1 + random value between 1 second and TTCAF .
•If the value of ( T1 + MINspread ) is greater than T2 or next subscription event, then TTC = T1 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.183Charging User Guide Call mangement If... Then.
.. •If there are two subscription events happening, which means both T1 and T2 take place, then TTC = T1 + random value between 1 second and (T2-T1- MINspread) .
2.
And, VT is calculated as per the following conditions: •If there is no T2 or no next subscription event takes place before ( T1 + VTAF ), then VT = time to T1 + random value between (Calculated TTC - T1 + MINspread) and minimum value between VTAF and (VTs - Time to T1) .
•If the value of ( calculated TTC + MINspread ) is greater than or equal to T2 or next subscription event, then VT = time to T2 .
•If (current time + VTs) is less than or equal to ( calculated TTC + MINspread ), then VT = time to calculated TTC + MINspread .
•If there are two subscription events happening, which means both T1 and T2 take place, then VT = time to T1 + random value between (calculated TTC - T1 + MINspread) and minimum value between (VTs - time to T1) and (T2 -T1) .
Therefore, this computation allows a larger spread of VT to spread out the traffic using VTAF and MINspread .
1.The Disable TTC parameter configured in a bundle is disabled, 2.The account is of postpaid type, and 3.The policy counter status or VPC status changes, which means the usage is computed as QoS changes from unthrottled to throttled at the TTC time,First, the TTC ( TTC_ Post Paid_ PC_Change ) is calculated and the TTC value is further used in computing the VT value.
1.TTC is computed as per the following conditions: •If there is no T2 or no next subscription event takes place before ( T1 + TTCAFlarge + MINspread ) , then TTC = T1 + random value between 1 second and TTCAFlarge .
•If there are two subscription events happening, which means both T1 and T2 take place, then TTC = T1 + random value between 1 second and (T2-T1-MINspread) .
2.And, VT is computed as per the formula: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.184Charging User Guide Call mangement If... Then.
.. VT = Time to calculated TTC + MINspread .
Postpaid policy counter change If... Then.
..
The postpaid policy counter status does not change,The usage does not change from throttled to unthrottled at the TTC time.
NCC allows a larger spread of VT to spread out the traffic.
Therefore, VTAF value is used to spread out the traffic for a longer time.
VTAF value is set as larger, for example 4 hours .
The postpaid policy counter status changes, The usage is computed as QoS changes from unthrottled to throttled at the TTC time.
To avoid usage to go beyond the TTC time, the values of TTC and VT should be close instead of using TTCAF .
However, a larger adjustment factor for TTC, which is TTCAFlarge to assure that all throttled sessions do not return in too short of an interval.
Note : If nearest TTC subscriber has at least one subscription with validity time from entity lifecycle or the subscription has maximum renewal reached, then TTC is computed as: •For subscription taken from prepaid type account, only VT value is sent and that calculation is same as mentioned in the Prepaid accounts behavior section.
•For subscription taken from postpaid type account, TTC and VT values are computed assuming policy counter change.
Additional information Following assumptions are applied to this feature: •The device considered has a bundle subscription from a single prepaid or postpaid account.
•A BOU bundle has the TTC Disabled Flag parameter set as true or enabled.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.185Charging User Guide Call mangement •The TOD start time needs less time than stop time.
However, TOD across days is not supported, which means TOD does not go beyond midnight.
•In the Tariff-Time-Usage AVP, the TTC intermediate scenario does not work for NCHF.
•This feature is applicable only to the following entities and under the given condition: –Centralized charging with static slice configured in quota management profile (slicing profile) rule.
However, it is not applicable to the dynamic slicing mechanism.
–Subscription and multi-bundle counters –Buckets and counters –When there is no TOD event, which occurs prior to the T1 associated with the first subscription event.
Also, the T2 is set to the nearest subscription event or TOD event after the T1 event.
•This feature is not applicable to following entities: –Groups –Account main balance or aggregate view (AV) •According to the Usage control functionality on page 231 feature, the self-counter cannot be throttled, which means they cannot be a policy counter.
Therefore, this feature related to TTC on postpaid account with policy counter or VPC being throttled is not applicable to UC self-counter.
Note : It is recommended to enable the Disable TTC flag in a bundle configuration for short subscription lifecycle scenarios, such as hourly and the VT in quota management profile (slicing profile) is recommended to be set to a value less than 24 hours, such as 8 or 12 hours.
Examples Consider the following examples to understand this feature in a better way: Example 1: Set the Disable TTC flag as true This example considers that the Disable TTC flag in a bundle is set as true or enabled.
The subscription does not have its own periodic lifecycle and is renewed during the funding of BCR processing for a prepaid account.
Preconditions: 1.Configure the following ME application preferences: •Set Min Spread (seconds) as 60.
•Set VT Adjustment Factor Prepaid (seconds) as 1800 .
•Set VT Adjustment Factor (seconds) as 14400 .
•Set TTC Adjustment Factor (seconds) as 300.
•Set TTC Adjustment Factor Large (seconds) as 3000 .
2.Set the Validity Time in quota management profile (slicing profile) as 43200 seconds .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.186Charging User Guide Call mangement 3.Enable the TTC RSV in Gy pre-processing.
4.The charging service has no charge with a subscription counter.
5.Enable the Disable TTC flag in the bundle.
6.Bundle does not have any periodic lifecycle.
7.Create a prepaid account with a daily periodic lifecycle.
8.Set the renewal time as 12 midnight.
9.The device subscribes to the bundle using the prepaid account.
Post-conditions: •Execute a session-based call, such that VT spans the renewal of account.
•This example verifies that the TTC is not set and VT is not randomized and set as time to T1 (Time to BCR).
Example 2: Device with prepaid account This example considers that the Disable TTC flag in a bundle is set as false or disabled.
There are two subscriptions S1 and S2, each having its own periodic lifecycle and are subscribed using the same prepaid account.
Currently, S1 is active and S2 would get activated in future.
Preconditions: 1.Configure the following ME application preferences: •Set Min Spread (seconds) as 60.
•Set VT Adjustment Factor Prepaid (seconds) as 1800 .
•Set VT Adjustment Factor (seconds) as 14400 .
•Set TTC Adjustment Factor (seconds) as 300.
•Set TTC Adjustment Factor Large (seconds) as 3000 .
2.Set the Validity Time in quota management profile (slicing profile) as 43200 seconds .
3.Enable the TTC RSV in Gy pre-processing.
4.For Bundle1 , there is a charging service having no charge with a multi-bundle counter.
Disable the Disable TTC flag in the bundle and the bundle has a daily periodic lifecycle.
5.For Bundle2 , there is a charging service having no charge with a subscription counter.
Disable the Disable TTC flag in the bundle and the bundle has a different daily periodic lifecycle.
6.Create a prepaid account with a monthly periodic lifecycle.
7.The device subscribes to Bundle1 using the prepaid account, and also subscribes to Bundle2 with a future activation date.
Post-conditions: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.187Charging User Guide Call mangement •Execute a session-based call, such that VT spans the renewal of Bundle1 and the activation time of Bundle2 is also approaching.
•This example verifies that TTC is not set and VT is set as time to T1 + random value between 1 second and (T2-T1) .
Example 3: Device with postpaid account and without policy counter status change This example considers that the subscription does not have its own periodic lifecycle and is renewed during the funding of BCR processing for a postpaid account.
Preconditions: 1.Configure the following ME application preferences: •Set Min Spread (seconds) as 60.
•Set VT Adjustment Factor Prepaid (seconds) as 1800 .
•Set VT Adjustment Factor (seconds) as 14400 .
•Set TTC Adjustment Factor (seconds) as 300.
•Set TTC Adjustment Factor Large (seconds) as 3000 .
2.Set the Validity Time in quota management profile (slicing profile) as 43200 seconds .
3.Enable the TTC RSV in Gy pre-processing.
4.The charging service has no charge with a subscription counter.
The counter has a threshold attached, which is 0 for unthrottled and 20MB for throttled.
5.The bundle does not have any periodic lifecycle.
6.Create a postpaid account with a daily periodic lifecycle.
7.Set the renewal time as 12 midnight.
8.The device subscribes to bundle using the postpaid account.
Post-conditions: •Execute a session-based call, such that VT spans the renewal of postpaid account and there is no policy counter status change expected at the renewal of account.
•This example verifies that TTC is set to T1 + random value between 1 second and TTCAF , and VT is set to Time to T1 + random value between (calculated TTC - T1 + MINspread) and the minimum value between VTAF and (VT - Time to T1) .
Example 4: Device with postpaid account and policy counter status change This example considers that the subscription does not have its own periodic lifecycle and is renewed during the funding of BCR processing for a postpaid account.
Preconditions: 1.Configure the following ME application preferences: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.188Charging User Guide Call mangement •Set Min Spread (seconds) as 60.
•Set VT Adjustment Factor Prepaid (seconds) as 1800 .
•Set VT Adjustment Factor (seconds) as 14400 .
•Set TTC Adjustment Factor (seconds) as 300.
•Set TTC Adjustment Factor Large (seconds) as 3000 .
2.Set the Validity Time in quota management profile (slicing profile) as 43200 seconds .
3.Enable the TTC RSV in Gy pre-processing.
4.The charging service has no charge with a subscription counter.
5.The bundle does not have any periodic lifecycle.
6.Create a postpaid account with a daily periodic lifecycle and the renewal time as 12 midnight.
7.The device subscribes to bundle using the postpaid account.
Post-conditions: •Execute a session-based call, such that VT spans the renewal of postpaid account, and there is a policy counter status change expected at the renewal of account.
•This example verifies that TTC is set to T1 + random value between 1 second and TTCAFlarge , and VT is set to time to calculated TTC + MINspread .
Example 5: Travel-pass feature BOU activation This example considers that the BOU bundle travel-pass subscription has its own periodic lifecycle with the Disable TTC flag set as true .
Both base bundle and travel-pass bundle are subscribed through the same account.
Preconditions: 1.Configure the following ME application preferences: •Set Min Spread (seconds) as 60.
•Set VT Adjustment Factor Prepaid (seconds) as 1800 .
•Set VT Adjustment Factor (seconds) as 14400 .
•Set TTC Adjustment Factor (seconds) as 300.
•Set TTC Adjustment Factor Large (seconds) as 3000 .
2.Set the Validity Time in quota management profile (slicing profile) as 43200 seconds .
3.Enable the TTC RSV in Gy pre-processing.
4.The base bundle has charging service with no charge and a subscription counter.
The base bundle does not have any periodic lifecycle.
5.Enable the Disable TTC flag for the BOU travel-pass bundle and its own periodic lifecycle, which is going to expire in 12 hours.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.189Charging User Guide Call mangement 6.Create a prepaid account with a weekly periodic lifecycle and the renewal time is after a week.
7.A device subscribes to base bundle and BOU travel-pass bundle using this prepaid account.
8.The BOU travel-pass bundle is activated during the roaming usage.
Post-conditions: •Execute a session-based call, such that VT spans the expiry of BOU travel-pass bundle.
•This example verifies that no TTC is returned and VT is set to time to expiry of BOU travel-pass bundle.
Example 6: TTC with UC TOD This example verifies that TTC is not set and VT is adjusted with TOD when call is sent before TOD and BCR is after TOD.
Preconditions: 1.Create UC with TOD set as 8 to 12 PM on all days and a charging service with no charge.
2.Create a bundle with Disable TTC parameter set as false or disabled.
3.Create a postpaid account with default lifecycle.
4.Subscribe the device to the above create bundle with the postpaid account.
Post-conditions: 1.Execute an SCUR initial call at 06:59:30 PM and update at 08:00:30 PM .
2.This example verifies that TTC is not set and VT is reduced to TOD in initial and in update as call falls within TOD, and GSU is set to 0.
Note : Start time need to less than stop time always.
TOD across days is not supported, which means TOD does not go beyond midnight.
3.
16.3 Tariff Time Change (TTC) handling This section explains handling Tariff-Time-Change (TTC), which is the switch time when a tariff is changed for a data session.
After a tariff switch is reached, all active user sessions report their session usage by the end of validity period of the current request or receive new quota for resource usage for the new tariff period.
In order to avoid the need for multiple simultaneous quota refresh trials, the traffic usage is split into resource usage before a tariff switch and resources used after a tariff switch, which means a bundle, bucket, or counter may be changed during this switch time.
During a data call, if the TTC time calculated is nearing, then the quota allocation is handled accordingly.
The portion of the call before and after the TTC time may have different tariff rates.
When a CCR received includes two or three USU instances in one MSCC, the NCC call controller handles the reported usage separately in the USU instances due to the session that ranges crossing TTC times.
NCC handles USU before tariff changes and after tariff change in sequence.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.190Charging User Guide Call mangement TTC candidates are picked from the bucket and subscription counter that are approaching BCR.
The approaching end time of the bucket or counter is considered to calculate a TTC value.
Note : This feature does not addresses the requirement of modifying the start time for subscription, bucket or counter.
TTC handling - before and after BCR time NCC considers the following points while handling the tariff change: •There is no limitation on the number of USUs.
If multiple USUs are received with same Tariff-Change- Usage (TCU) value, then the service accumulates the value of same types of USU.
The ME application parameter Gy TCU Indeterminate identifies whether the first USU value with Tariff-Change-Usage (2 -INDETERMINATE ) is added before the tariff change usage, after the tariff change usage, or is completely ignored.
•If the reported USU Before Tariff Change (BTC) is greater than zero but less than GSU, then the usage is committed before tariff change to pre-BCR version of subscription (from which reservation was done).
In case of carry-over bucket, the initial or unused value in carry-over bucket instance gets updated when the usage is committed before tariff change.
If the reported USU before tariff change is greater than GSU, then GSU is committed on pre-BCR version of subscription, and the over committed part (USU before tariff change – GSU) is added to the usage after tariff change.
Notification is sent when configured in the rule engine.
•The subscriptions are sorted again at the start of CCR message since after the tariff switch time, and if BCR or subscription activation occurred, then some subscriptions may be switched from valid to invalid and vice-versa.
After the subscriptions or charging services are sorted based on predefined priorities, the application condition is checked for each Charging Service (CS) with slice allocation time set to tariff switch time.
•If the reported USU After Tariff Change (ATC) is greater than zero, then the usage is committed based on the newly sorted subscriptions or CS list.
The USU ATC is handled as overcommit since the charging services are re-selected.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.191Charging User Guide Call mangement •A notification is sent after committing the ATC or BTC usage.
To support multiple USU instances in the CCR message, the rule trigger RATING_POST_PROCESSING is changed as shown in the following figure and the notification variable USU is obtained from the RATING_POST_PROCESSING source context.
Supported TTC times Precondition: For the following table, TTC time is enabled in the Gy pre-processing of rules.
Supported TTC times Comments End time of subscription This time refers only to those subscriptions, which are used for reservation.
Start time of subscription This time refers to all subscriptions.
Future activation subscriptions This refers to the future activation time of all subscriptions irrespective of their applicability conditions.
Entity lifecycle state validity time If current state in the entity lifecycle of the resource ( from where reservation is done) has a validity time less than the BCR time of resource ( from periodic lifecycle) , then TTC is not set and instead validity time of the state is set as Validity Time in CCA.
End time of bucket This time refers to all the buckets.
End time of counter This time refers to only the subscription counters.
End time of Account This time refers to period lifecycle of account, which is linked to subscription and is used for reservation.Table 24: Different times used for TTC computation Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.192Charging User Guide Call mangement Supported TTC times Comments End time of multi- bundle counter This time refers to period lifecycle of bundle, which is linked to a subscription containing multi- bundle counter, which is applied during reservation.
End time of device counter This time refers to period lifecycle of a counter, which is attached to device and applied during reservation.Table 24: Different times used for TTC computation (continued) Note : TTC is implemented only for subscription counters.
The final TTC time is the nearest time to the Diameter call found after sorting all the times mentioned in the above table.
Entity lifecycle - validity time of current state Every entity has an entity lifecycle associated to it with defined states and transitions.
The state of the resource may have a validity time linked to it.
If the state validity time is defined, then transition takes place at the same configured time.
The TTC logic considers the minimum of BCR and the validity time of the current state to determine the TTC to be sent to the gateway.
Assume there are two TTC users with the following behavior: •If the BCR value of resource is greater than or equal to the value of entity lifecycle state validity time, then TTC is not configured and VT is set as the state validity time.
•If the BCR value of resource is less than the value of entity lifecycle state validity time, then BCR is configured as TTC.
Note : Only those subscriptions are considered for state validity time and BCR, from where the reservation is performed.
Example Configuration or provisioning: •Consider two subscriptions Sub1 and Sub2 .
•Sub1 has an entity lifecycle with current state Active at 2018/7/25 09:25:00 with validity time of 1 hour and Sub1 has end time 2018/7/25 11:30:00 .
•Sub2 has an end time or BCR at 2018/7/25 14:30:00 .
•Validity time of 86400 seconds in quota management profile (slicing profile).
A user makes a data call at 2018/7/25 9:30:00 .
•Few observations for TTC and VT: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.193Charging User Guide Call mangement During TTC calculation, the end time of Sub1 is compared with its state entity lifecycle.
2018/7/25 10:25:00 (validity time of 1 hour) < end time of Sub1 (2018/7/25 11:30:00 ) < end time of Sub2 (2018/7/25 14:30:00 ) < VT (quota management profile (slicing profile)) Therefore, TTC is not configured and VT is set to 55 minutes ( 2018/7/25 10:25:00 - current call).
Configuring TTC The service operators enable the TTC feature using the following methods: •Complex map : Provision the relationship between Origin-Host and Is-TTC-Enabled flag in the mapping table.
•Rules : Configure the charging GY_PRE_PROCESSING trigger to fetch the Is-TTC-Enabled flag.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.194Charging User Guide Call mangement Note : NCC can send VT = 0.
If the PGW does not support the VT = 0, then service operators configure a rule to send VT = 1 from NCC as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.195Charging User Guide Call mangement TTC and TCU AVP support The Tariff-Time-Change AVP is supported in a CCA message and used within the GSU AVP to determine the tariff switch time.
In this feature, global TTC time configured in the RSV, future activation time of subscriptions, or TTC configured in bundle rules or RSV is Tariff-Time-Change , which is an optional parameter.
The Tariff-Change-Usage AVP is supported in CCR message and its value type is date.
The TCU AVP is used within USU AVP to distinguish reported usage before and after the tariff time change.
<Used-Service-Unit> ::= <AVP Header: 446 > [Tariff-Change-Usage] The value type of Tariff-Change-Usage AVP is enumerated.
•0 - UNIT_BEFORE_TARIFF_CHANGE •1 - UNIT_AFTER_TARIFF_CHANGE •2 - UNIT_INDETERMINATE The ME application preference parameter Gy TCU Indeterminate indicates how to process the usage with the Tariff-Charge-Usage AVP.
See Charging application preferences on page 44 for more details on this parameter.
Automatic TTC calculation •You can enable the automatic calculation of TCU before and after a TTC occurrence even when the Gateway is unable to process the TTC, and report USU before and after the TTC.
•To enable this functionality, you must set the Is-TTC-Enabled flag, and Enable-Silent-TTC to true in the GY_PRE_PROCESSING trigger.
•Slice Duration is the difference between the event timestamps of the CCRs, for the same MSSC, received after and before TTC.
For example: Consider the event timestamps of the following CCRs: –CCR(U)1 for MSCC1 at T1 –CCR(U)2 for MSCC2 at T2 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.196Charging User Guide Call mangement –CCR(U)3 for MSCC1 at T3 Slice Duration is calculated as SD = T3 - T1 .
In general, Slice Duration (SD) = Event Timestamp of CCR after TTC (CCR_After_T) - Event Timestamp of CCR before TTC (CCR_Before_T) •TCU before the TTC occurrence is calculated as follows: TCU_Before = Round (USU * (TTC - CCR_Before_T) / SD) •TCU after the TTC occurrence is calculated as follows: TCU_After = Round (USU * (CCR_After_T - TTC) / SD) •USU can be Volume (octets), Time (secs), or Units (items).
Note : Timestamps, and time calculations are in seconds granularity.
Note : Round function provides the rounding mechanism that rounds up to the next interger.
The result is an integer.
For example: 0.5 → 1.
VT and TTC calculation When the TTC feature is enabled, the GSU AVP in the CCA message is configured under one of the following conditions: •If BCR occurs within the VT of the granted quota and NCC considers the Timezone ID of the account.
•If future activation time of subscription or Subscription State Validity Time (which is, the entity lifecycle current state time).
During quota allocation, the end time or Subscription Current State Validity Time of the subscriptions used in quota reservation, which are associated with subscription used for quota reservation is checked and the start time or the future activation time is retrieved from all subscriptions and corresponding groups.
The start time, end time, and future activation time are sorted, which are later than the call start time and within the VT to get the nearest time and second nearest time.
If the subscription does not attach to any period lifecycle, then the associated account period lifecycle start time or end time is used.
After getting the TTC and VT values, if the values of both TTCAF and VTAF are greater than zero, then the TTC and VT values are adjusted as per the following criteria: •If the (current time + VT) is between TTC time calculated and TTC time calculated + 2 seconds TTC = TTC calculated date + 1 second VT = Time to TTC + 2 seconds •If there is a policy counter attached to a device whose status gets changed during TTC date processing, the TTC and VT is calculated as follows: TTC = TTC calculated date + RAND [1 second, TTCAF] VT = time to TTC + 1 second Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.197Charging User Guide Call mangement •Otherwise, if the device does not currently have one or more policy counters whose status change during TTC calculated processing, then the TTC and VT are calculated as follows: TTC = TTC calculated date + RAND [1 second, MIN(TTCAF, VT-time to TTC-1 second)] VT = TTC Time calculated date + RAND [2 seconds, MIN(VTs-time to TTC, VTAF)] Example: TTC and VT adjustment when device has a policy counter that changes during TTC time calculated Scenario: This example shows a case when there is a policy counter TTC Time calculated within VTs and policy counter status is changed during BCR.
TTC and VT for the session are set as per the following formulae: TTC = TTC Time calculated + RAND[1 second, TTCAF] VT = time to TTC + 1 second Provisioning: Provision the following entities: 1.Enable the TTC feature.
See Configuring TTC on page 194 for more information.
2.Configure VTs (standard VT from quota management profile (slicing profile)) = 18h = 64800 seconds in the quota management profile (slicing profile) entity.
3.Set the VT adjustment factor = 3000 seconds.
4.Set the TTC adjustment factor = 300 seconds.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.198Charging User Guide Call mangement 5.Create a charging service.
6.Create a subscription renewal lifecycle.
Parameter Value Name Subscription Renew Cycle1 Type Bill Cycle Applicable to Subscription Timer value 90 Time units HOURS 7.Create a bundle and link the charging service created in the previous step.
Parameter Value Name Bun1_ V_6789 Charging Service List CS_V_6789 Bundle Activation Type NORMAL Period Subscription Renew Cycle1 Max Renewals 10000 Period Subscription Renew Cycle1 Entity Default Subscription LifeCycle 8.Create an account and attach the Bun1_V bundle.
The current data volume is 15 GB.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.199Charging User Guide Call mangement For account, the period lifecycle is 70 minutes.
9.Create a device and attach the Bun1_V bundle with period lifecycle of 90 hours.
The current data volume is 15 GB.
10.Configure the threshold profile on policy counter.
0 is High, 5 is Low, 10 is Down.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.200Charging User Guide Call mangement Post-conditions: •A Gy call is triggered and CCR(I) status of Device Policy Counter (DPC) is HIGH , CCR(T) USU = 5 GB, and status of DPC is changed to LOW .
•For CCA(I), BCR time (90 hour) for bundle is out of VTs (18 hour) duration.
Even though, policy counter BCR time (70 minutes) is within VT, but since policy counter status is not changed during BCR, it is not considered as time change point.
The TTC AVP is not set.
VTs (18 hour) is used to set VT AVP in the CCA message.
•A second Gy call is triggered and CCR(I) status of DPC is LOW.
CCR(T) USU = 5 GB and the session ends.
For CCA(I), BCR time (90 hour) for bundle is still out of VTs (18 hour) duration.
The policy counter BCR time (70 minutes) is within VT.
The current policy status is LOW and BCR logic throttles the status to HIGH .
The policy counter BCR time is considered as time change point.
BCR date = 1557736980000 ms RAND[1 second, TTCAF] = RAND[1 second, 300 seconds] = 269575 ms New TTC = 1557736980000 ms + 269575 ms = 1557737249575 ms New VT = TTC – current time +1 second =1557737249575 ms -1557733096648 ms + 1000 ms = 4153927 ms = 4154 s Example: TTC when Bucket has a periodic lifecycle.
This example shows a case where the subscription has an end time on 30 June at 00:00 but the bucket is defined with periodicity as daily, and is ending on 22 June at 00:00.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.201Charging User Guide Call mangement While calculating TTC for an initial or update which has arrived on 22 June at 20:00, both the end times are considered.
Since the bucket is the earliest approaching end time, the TTC is sent as 22 June 00:00.
MIN VT and MIN TTC configuration MIN VT and MIN TTC is defined in the quota management profile (slicing profile) ruleset with unit type second.
If TTC and VT calculated with tariff time change point is less than the minimum value, the TTC and VT are adjusted based on the minimum value.
The MIN VT and MIN TTC in SLICING_PROFILE are optional attributes, and if not configured, then they are treated as zero.
If the MIN TTC greater than MIN VT , then the MIN VT value is ignored and treated as zero.
GSU additional check When the TTC feature is enabled, after the quota reservation, NCC performs additional check for all the subscriptions used for quota allocation.
If the Max Renewal time has reached or if the account is PRE_PAID and has insufficient balance for subscription renewal, then the service ignores the TTC and sets the VT to the subscription end time.
In this case, MIN-VT is not used.
Assumptions Following assumptions apply to the TTC feature: •Only the subscription period lifecycle fee is checked.
The account lifecycle is considered when the subscription does not have its own lifecycle or account balance is used for charging calls.
•Irrespective of whether a subscription renewal is checked individually, there may be some instances for which the renewable check is passed.
However, the subscription is not successfully renewed as shown in the following example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.202Charging User Guide Call mangement •There may be cases wherein the TTC logic finds that the subscriptions can be renewed, but they may actually be not renewed when the lifecycle logic checks get executed.
For example, consider that there are three subscriptions with same end time associated with same account.
When the TTC logic checks the subscriptions one-by-one, it finds that the subscription is renewable, that is, account balance (10) > subscription renewal fee (5).
But, all the three subscriptions have same end time as per calculation, the account balance (10) < subscription renewal fees (5*3).
In such cases, NCC logic does not take any action.
Note : While considering activation time of subscription, the applicability condition or priority is not checked.
Examples Consider the following examples for better understanding of this feature: Example 1 Preconditions: Bob makes a data call.
There are two subscriptions SubA and SubB at device level, and SubC at group level.
•There is a volume bucket BK1 of 500M in SubA , where the SubA end time is 2018/7/31 10:30:00 .
•There is a volume bucket BK2 of 1000M in SubB , where the SubB end time is 2018/8/1 00:00:00 .
•There is a volume bucket BK3 in SubC , where the SubC start time is 2018/7/31 10:00:00 and SubC is in a barred state.
The priority is set as BK3 > BK1 > BK2 Post-conditions: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.203Charging User Guide Call mangement •When a CCRi is received on 2018/7/31 9:55:00 , the TTC feature is enabled and VT is 10800 seconds.
Quota size is 100 M, BK1 is reserved for 100M, TTC is set to 2018/7/31 10:00:00 , ad VT is set to 2100 seconds.
•When a CCRu is received on 2018/7/31 10:20:00 , report reason is quota exhausted.
In USU UNIT_BEFORE_TARIFF_CHANGE is 60M, UNIT_AFTER_TARIFF_CHANGE is set as 40M.
BK1 is deducted with 60M and returns 40M, after calculation BK1 is 440M.
When SubC BCR occurs, 40M is deducted from BK3.
After calculation, BK3 is 110M.
100M is reserved from BK3 for new quota allocation, TTC is set to 10:30:00 , and VT is set to 10800 seconds.
•When a CCRt is received on 2018/07/31 10:50:00 , report reason is quota exhausted.
In USU UNIT_BEFORE_TARIFF_CHANGE is 100M, UNIT_AFTER_TARIFF_CHANGE is set as 40M.
BK3 is deducted with 100M after calculation usage and before tariff change, BK3 is 10M.
When BK1 BCR occurs, pre-BCR value is 440M, current BCR version value is 1000M (initial value).
For UNIT_AFTER_TARIFF_CHANGE , BK3 is deducted with 10M, remaining value is 0M.
BK1 current value is updated to 970M, and unused value is updated to 970M.
Example 2 Preconditions: Bob makes a data call at 2018/7/25 9:30:00 .
There is one subscription Sub1 at device level, and two subscriptions Sub3 and Sub4 at group level.
The validity time is 7200 seconds from the quota management profile (slicing profile).
•Sub1 is a monthly renewed subscription with start time set as 2018/6/25 10:00:00 and end time set as 2018/7/25 10:00:00 .
•Sub3 is a one-time (non-renewable) subscription with start time set as 2018/7/18 09:55:00 and end time set as 2018/ 7/25 09:55:00 .
•Sub4 is in the barred state and its future activation time is 2018/7/25 11:00:00 .
Post-conditions: •If Sub1 and Sub3 are used for the quota reservation, then the end time of Sub1 and Sub3 , and activation time of Sub4 are used for TTC calculation.
•After sorting, 2018/7/25 09:55:00 (end time of Sub3 ) < 2018/7/25 10:00:00 (end time of Sub1 ) < 2018/7/25 11:00:00 (activation time of Sub4 ): 2018/7/25 09:55:00 set as VT because its non-renewable (1500 seconds).
Example 3 Preconditions: Bob makes a data call at 2018/7/25 9:30:00 .
There is one subscription Sub1 at device level, and two subscriptions Sub3 and Sub4 at group level.
The validity time is 7200 seconds from the quota management profile (slicing profile).
•Sub1 is a monthly renewed subscription with start time set as 2018/6/25 10:00:00 and end time set as 2018/7/25 10:00:00 .
•Sub3 is a one-time (non-renewable) subscription with start time set as 2018/7/18 09:55:00 and end time set as 2018/ 7/25 09:55:00 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.204Charging User Guide Call mangement •Sub4 is in the barred state and its future activation time is set as 2018/7/25 9:40:00 .
Post-conditions: •If Sub1 and Sub3 are used for the quota reservation, then the end time of Sub1 and Sub3 , and activation time of Sub4 are used for TTC calculation.
•After sorting, 2018/7/25 9:40:00 (activation time of Sub4 ) < 2018/7/25 09:55:00 (end time of Sub3 ) < 2018/7/25 10:00:00 (end time of Sub1 ): TTC is set to 2018/7/25 09:40:00 and VT is set to 1500 seconds.
3.
16.4 Global time configuration (other than BCR) Configuring TTC time A service operator can configure the Tariff-Time-Change , which is an optional parameter wherein the time is aligned with the timezone of an account of the first subscription of the device (if available).
Otherwise, it considers the default timezone.
Apart from the start time, end time or validity time, or activation time associated with the subscription, the TTC time can also be specified.
This TTC time is configured either using Gy pre-processing of rules or through the rules of bundle definition.
However, if a particular device does not have its own subscription and consumes data from the group subscription, then the default system timezone is mapped with the TTC time configured in rules.
The time specified in the Tariff-Time-Change parameter is in hour:min:sec for the 24-hour format as shown in the following figure: The global TTC can be configured in system for the purpose of segregating the data consumed by the devices in the required time frame.
For example, if daily data consumed by a device is required, then global TTC can be configured as the midnight time.
In case, validity time for the granted units to the device crosses the midnight, then the TTC is configured and sent to the gateway leading to multiple USUs sent by the gateway in the form of before and after midnight usage.
The system generates two CDRs one for before TTC usage and another after TTC usage.
The before usage CDR has an attribute named tariffTimeChange and using the same information, the data from before usage can be aggregated to the previous day.
Precondition: For the following table, TTC time is enabled in the Gy pre-processing of rules.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.205Charging User Guide Call mangement Supported TTC times Comments TTC time ( Tariff- Time- Change) of Gy pre- processingThis refers to the global TTC time configured as the Tariff- Time- Change in Gy pre- processing rules.
End time of subscription This time refers only to those subscriptions, which are used for reservation.
Start time of subscription This time refers to all subscriptions.
Future activation subscriptions This refers to the future activation time of all subscriptions irrespective of their applicability conditions.
TTC time ( Tariff- Time- Change) in bundle rules This refers to the time configured as the Tariff- Time- Change only in bundle rules and considered for the subscriptions used in reservation.
Entity lifecycle state validity time If current state in the entity lifecycle of the resource ( from where reservation is done) has a validity time less than the BCR time of resource ( from periodic lifecycle) , then TTC is not set and instead validity time of the state is set as Validity Time in CCA.
Multiple TTC times ( Tariff- Time- Change- Multiple) of Gy pre- processingThis refers to the multiple tariff change time points configured as the Tariff- Time- Change- Multiple in GY_ PRE_ PROCESSING rule.
Multiple TTC times ( Tariff- Time- Change- Multiple) of bundle rulesThis refers to the multiple tariff change time points configured as the Tariff- Time- Change- Multiple in bundle rules and considered for all the subscriptions which may be used in the call.
End time of Account This time refers to period lifecycle of account, which is linked to subscription and is used for reservation.Table 25: Different times used for TTC computation The final TTC time is the nearest time to the Diameter call found after sorting all the times mentioned in the above table.
Note : The TTC time is configured by the Tariff-Time-Change and Tariff-Time-Change-Multiple attributes in the RSV or bundle rules.
The Tariff-Time-Change-Multiple is a list of TTC time where as Tariff-Time-Change is only one TTC time.
The TTC time mentioned in rules is in the format of Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.206Charging User Guide Call mangement hh:mm:ss from the GUI and configured in 24-hour format.
The time conversion is described in the following table: TTC time in rules GUI Hours: Mintues: SecondsSaved in milliseconds in the database as Long Value ( milliseconds) (Hour * 3600 + Minutes * 60 + Seconds) * 1000 14:22:33 51753000 For example; ( (14*3600 + 22* 60 + 33) *1000) 00:00:00 0 01:22:00 4920000 EXAMPLE Preconditions: Bob makes a data call at 2018/7/25 9:30:00 .
There is one subscription Sub1 at device level, and two subscriptions Sub3 and Sub4 at group level.
The validity time is 7200 seconds from the quota management profile (quota management profile (slicing profile)).
Global TTC time configures in the RSV is 9:40:00 .
•Sub1 is a monthly renewed subscription with start time set as 2018/6/25 10:00:00 and end time set as 2018/7/25 10:00:00 .
•Sub3 is a one-time (non-renewable) subscription with start time set as 2018/7/18 09:55:00 and end time set as 2018/ 7/25 09:55:00 .
•Sub4 is in the barred state and its future activation time is 2018/7/25 10:40:00 .
Post-conditions: •If Sub1 and Sub3 are used for the quota reservation, then the end time of Sub1 and Sub3 , and activation time of Sub4 , and global TTC time configured are used for TTC calculation.
•2018/7/25 9:40:00 (Global TTC time) < 2018/7/25 09:55:00 (end time of Sub3 ) < 2018/7/25 10:00:00 (end time of Sub1 ) < 2018/7/25 10:40:00 (activation time of Sub4 ): TTC is set to 2018/7/25 09:40:00 (Global TTC configured in the RSV) and VT (from second TTC of 9:55 ) and VT is set to 1500 seconds.
Global TTC time in RSV The TTC time configured in the RSV rules or bundle rules is considered before any change that may happen in the subscription BCR or activation time.
Under those scenarios, next update of the Diameter call provides data usages before or after the TTC time configured in the rules even when there is no change in the subscription validity.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.207Charging User Guide Call mangement Precondition: The Is-TTC-Enabled flag is set to true .
In the rule group of the GY_PRE_PROCESSING trigger, the global TTC time is configured as the Tariff-Time- Change .
The data type of the Tariff-Time-Change is TimeOfDayValueType and it is represented in 24-hours format (hh:mm:ss) as shown in the following figure: TTC calculation During quota allocation, the global TTC time configured in the Gy pre-processing, the end time or Subscription Current State Validity Time of the subscriptions used in quota reservation, or the TTC configured in bundle rules, which are associated with subscription used for quota reservation is checked and the start time or the future activation time is retrieved from all subscriptions and corresponding groups.
The start time, end time, future activation time, TTC configured in bundle rules, and global TTC time are sorted, which are later than the call start time and within the VT to get the nearest time and second nearest time.
If the subscription does not attach to any period lifecycle, then the associated account period lifecycle start time or end time is used.
While calculating TTC, the global TTC time configured as the Tariff-Time-Change in RSV is considered and timezone for this time is aligned with the timezone of account of first device subscription (if there is only group subscription and no device subscription is available, then default time zone is considered).
If the global TTC time is configured as the Tariff-Time-Change in RSV, then while calculating TTC, this time is considered as the upcoming time of next 24 hours.
For example: 1.If the global TTC time configured as the Tariff-Time-Change in RSV is 11:10:10 and call time is 11:30:00 on 2018/12/21 , then TTC is 11:10:10 of 2018/12/22 (assuming it is within the VT range).
2.If the global TTC time configured as the Tariff-Time-Change in RSV is 11:10:10 and call time is 11:00:00 on 2018/12/21 , then TTC is 11:10:10 of 2018/12/21 (assuming it is within the VT range).
Example Preconditions: Bob makes a data call at 11:00:00 on 2018/11/21 .
•There is a subscription Sub1 at device level.
•The validity time is 86400 seconds in quota management profile (slicing profile).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.208Charging User Guide Call mangement •The global TTC time configured as the Tariff-Time-Change in RSV is 11:10:10 .
•Sub1 is a monthly renewed subscription with start time set as 2018/11/21 10:00:00 and end time set as 2018/12/21 10:00:00 .
Post-conditions: •If Sub1 is used for the quota reservation, then the end time of Sub1 and global TTC time are used for TTC calculation.
•After sorting, 2018/11/21 11:10:10 (configured in RSV as global TTC) < 2018/12/21 10:00:00 (end time of Sub1 ).
TTC is set to 2018/11/21 11:10:10 and VT is set to 86400 seconds.
TTC in bundle rules The TTC time can also be configured in the bundle rules ( BUNDLE.Tariff-Time-Change ) and this time is considered in the TTC time computation only when TTC is enabled in RSV and same subscriptions (having TTC time configured in bundle rules) are used for reservation.
Example Preconditions: Bob makes a data call at 2018/7/25 9:30:00 .
•There are two subscriptions Sub1 and Sub2 at device level.
•The validity time is 7200 seconds from the quota management profile (slicing profile).
•The bundle TTC time configures in the bundle rules of Sub1 is 9:40:00 .
•Sub1 is a monthly renewed subscription with start time set as 2018/6/25 10:00:00 and end time set as 2018/7/25 10:00:00 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.209Charging User Guide Call mangement •Sub2 is a monthly renewed subscription with start time set as 2018/6/25 10:00:00 and end time set as 2018/7/25 11:00:00 .
Post-conditions: •If Sub1 and Sub2 are used for the quota reservation, then the end time of Sub1 , the end time of Sub2 , and bundle TTC time are used for TTC calculation.
•After sorting, 2018/7/25 9:40:00 (configured in bundle rule) < 2018/7/25 10:00:00 (end time of Sub1 ) < 2018/7/25 11:00:00 (end time of Sub2 ).
TTC is set to 2018/7/25 09:40:00 and VT is set to 1800 seconds.
VT adjustment If the global TTC is configured, and TTC and VT adjustment are also provided, then the validity time may be adjusted close to the global TTC leading to increase in traffic around TTC.
Note : tariffTimeChange attribute is present for before tariff time change usage CDRs and it is the same value, which was sent in the previous request (CCA message send to the TTC AVP (considering which gateway sends the USU for before and after data usage).
This attribute is useful in aggregating the data consumed by the device within a given duration.
If this attribute is present in CDR, then units committed from a bucket or account is considered first to be consumed before considering the tariffTimeChange value.
Refer to VT and TTC calculation on page 197 for more information.
3.
16.5 Include usage from previous billing cycle in BCR EDRs In order to derive monthly billing from the Billing Cycle Reset (BCR) EDRs appropriately, all quota allocated from the previous billing cycles (for active voice and data sessions when a BCR occurs) must be factored in when a BCR EDR is generated.
This quota is applicable to account BCR and bundle renewal or expiration.
This also includes quota for an account BCR date, as well as the quota for subscriptions in which the renewal/expiration date is controlled by their own period lifecycle (that is, when subscriptions not linked to the account BCR date).
This is termed as standalone subscription event , that is, the renewal or expiration date for subscriptions is controlled by the subscription’s period lifecycle.
When an account's billing information is updated and BCR period is also modified due to Immediate BCR , NCC updates the callTTC in ratingSession and preReservedValue in reservation-map: •Reservation in account/bucket/counter with preReservedValue (calculated from AccountBCR time) is greater than zero, and •Corresponding ratingSession has callTTC derived from the account entity.
For more information, see Example 2: Modification to account BCR date using API during ongoing BCR on page 218.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.210Charging User Guide Call mangement 3.
16.5.
1 Configuring this functionality The application preference Include Final Usage in BCR EDRs is used to configure whether and how to generate final BCR before first call of the day.
The default value is DISABLED .
Following are some other possible values for this application preference.
Different scenarios for each value is described in this section.
FIRST_CALL •Postpone TEM based on VT To ensure that lifecycle is not triggered by TEM scheduled regularly and thus final BCR is not generated before first call of the day, turn on the following parameters: –Set this application preference to FIRST_CALL .
–Set the application preferences VT Adjustment Factor (seconds) and TTC Adjustment Factor (seconds) to a value greater than 0.
–Set the Is-TTC-Enabled flag to true .
See section Configuring TTC on page 194 for more details.
•Final BCR EDR processing has to wait for the first call of the day after BCR time If active session is in progress, and the account/subscription BCR time is crossed by the allocated slice (VT exceeds BCR time), then lifecycle is not triggered by TEM scheduled regularly.
But, TEM gets triggered by the first call of the day.
This helps to include the total usage of billing cycle in related BCR EDRs.
LAST_DATA_CALL •Postpone TEM based on VT To ensure that lifecycle is not triggered by TEM scheduled regularly and thus final BCR is not generated before first call of the day, configure the following parameters: –Set this application preference to LAST_DATA_CALL .
–Set the application preferences VT Adjustment Factor (seconds) and TTC Adjustment Factor (seconds) to a value greater than 0.
–Set the Is-TTC-Enabled flag to true .
See section Configuring TTC on page 194 for more details.
•Final BCR EDR processing has to wait for the final usage for all the active data sessions –If there are any active data sessions at the time of BCR, then the BCR EDR is not logged at the time of BCR.
It is saved to be dumped when all quota allocated from the previous billing cycle has been accounted for, either when usage is reported in a CCR-U/T after BCR or when the sessions are cleared via Audit.
–If there are active voice sessions at the time of BCR, then the voice usage till BCR is accounted for in the BCR EDR, by deriving the usage based on the interval from the last reported usage through the BCR time.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.211Charging User Guide Call mangement •If TTC is not enabled, then the virtual TTC is enabled to calculate the TTC time (without any adjustments).
•Using the TTC time, units before TTC and cost (final usage) for the same are calculated.
•At the time of BCR, the BCR EDRs are updated with the calculated cost (final usage) for the voice usage till BCR.
•If the session is cleared via audit, then the voice usage till BCR is calculated.
–If there are any active fee reservations (step fee reservation or BOU fee reservation), then it is accounted for in the final BCR EDR as follows: •Fee reserved for data sessions is treated like an active data session, and BCR EDR is dumped only when all quota allocated from the previous billing cycle has been accounted for, either when usage is reported in a CCR-U/T after BCR or when the sessions are cleared via audit, and the fee reserved is charged.
•Fee reserved for voice sessions is treated like an active voice session, and the fee for the voice usage till BCR is accounted for in the BCR EDR, by deriving the fee for the usage based on the interval from the last reported usage till the BCR time.
LAST_CALL •Postpone TEM based on VT To ensure that lifecycle is not triggered by TEM scheduled regularly, and thus final BCR is not generated before first call of the day, configure the following parameters: –Set this application preference to LAST_CALL .
–Set the application preferences VT Adjustment Factor (seconds) and TTC Adjustment Factor (seconds) to a value greater than 0.
–Set the Is-TTC-Enabled flag to true .
See section Configuring TTC on page 194 for more details.
•Final BCR EDR processing has to wait for the final usage for all the active sessions –If there are any active sessions at the time of BCR, the BCR EDR is not logged at the time of BCR; instead the same is saved, only to be dumped when all quota allocated from the previous billing cycle has been accounted for, either when usage is reported in a CCR-U/T after BCR or when the sessions are cleared via Audit.
–If there are any active fee reservations (Step Fee reservation or BOU Fee reservation), the same is accounted for in the final BCR EDR.
Fee reserved for sessions shall be treated like an active session, and BCR EDR shall be dumped only when all quota allocated from the previous billing cycle has been accounted for, either when usage is reported in a CCR-U/T after BCR or when the sessions are cleared via Audit, and the fee reserved is charged.
3.
16.5.2 Applicability This feature is applicable for BCR EDRs for the following lifecycle actions: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.212Charging User Guide Call mangement •Reset account •Renew subscription •Reset subscription •Empty subscription •Account BCR •Bundle renewals/expirations 3.
16.5.3 Additional information •The RecordEventResult tag value (15), overwrites the actual recordEventResult value.
•It is assumed that BCR is triggered via lifecycle audit or On-Call-Pending-PLC execution.
If BCR is triggered before scheduled BCR via lifecycle REST APIs, then values in EDR may not be correct.
•As TTC is not supported for VoL TE sessions, if Include Final Usage In BCR EDRs is set to LAST_DATA_CALL then a virtual TTC is enabled.
The TTC time is calculated without adjustments.
This time is then used to calclulate the amount to be accounted in previous cycle.
•If Include Final Usage In BCR EDRs is set to LAST_DATA_CALL and a VoL TE session is cleared via Audit: –The VoL TE usage till BCR is used in previous values.
–Session audit CDR accounts for the committed usage till BCR.
•If Include Final Usage In BCR EDRs is set to LAST_CALL , then BCR EDR is logged after accounting usage for all sessions (both voice and data).
•If Include Final Usage In BCR EDRs is set to LAST_DATA_CALL /LAST_CALL , then the functionality to postpone TEM based on VT continues to work.
•If Include Final Usage In BCR EDRs is set to LAST_DATA_CALL /LAST_CALL and if neither usage is reported for the active sessions via CCR-U/T, nor the sessions are cleared by audit, within the current bill cycle, then at next BCR the following logic is applied: –The previous BCR already stored is logged first.
•The triggeredAtTime tag gets the time when the previous BCR was triggered, and timestamp tag gets the time when the BCR EDR was dumped.
•Since usage is not reported, the logged EDR may not have the accurate usage from previous cycle.
–The current BCR is processed and logged or stored based on active sessions.
•If Include Final Usage In BCR EDRs is set to LAST_DATA_CALL , then account balance tags in BCR EDR are generated with the following logic: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.213Charging User Guide Call mangement –The accountBalanceBeforeReset tag in ResetAccountAction EDR, accounts for the voice usage till BCR, by deriving the usage based on the interval from the last reported usage through the BCR time along with any applicable fees for the usage till BCR.
–If the account is not reset in the current cycle, then accountBalanceBeforeRenew and accountBalanceAfterRenew tags in RenewSubscriptionAction EDR, account for the voice usage till BCR, by deriving the usage based on the interval from the last reported usage through the BCR time along with any applicable fees for the usage till BCR.
•If a user subscribes to booster bundle again before BCR: –In EDR, CustomData appears twice –Policy counter info appears twice •VT time is calculated with adjustments.
•For pending BCR EDRs, previous values are not adjusted (that is, no CCR/audit is done within the current cycle of the resource).
•Lifecycle actions must be configured in the following order: 1.ResetAccountAction 2.RenewSubscriptionAction 3.ResetPeriodAction If the application preference Include Final Usage in BCR EDRs is set to LAST_DATA_CALL and active IMS sessions are present at BCR, then any different order may result in incorrect account balance in RenewSubscriptionAction EDRs.
However, ResetAccountAction contains correct values.
3.
16.5.4 Examples Example 1 Preconditions: •Include Final Usage In BCR EDRs is set to LAST_DATA_CALL .
•A single postpaid account has the following subscriptions mapped to a single device: –A Base subscription includes: •A domestic data counter ABY (all RG=3300, RG=3303, and RG=100 usage is applicable to the ABY counter).
•A tethered data counter TBY (RG=3303 usage is applicable to TBY, unless there is a tethered databoost bundle available for tethered usage).
•An unlimited VOICE (minutes) counter.
•A base bundle does not have a period lifecycle, it is renewed on the account’s BCR date.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.214Charging User Guide Call mangement –A tethered databoost subscription including a single high-speed bucket TBB (RG=3303 usage is applicable to the TBB bucket), •The tethered databoost bundle is a one shot bundle without renewals, it expires on the account’s BCR date.
•The charging service for the tethered databoost bundle is of higher priority than the base bundle’s charging service containing the TBY counter.
•Few other configurations: –The ABY counter is mapped to a policy counter ID PC1 and has not yet reached its threshold value so its associated PC status is currently unthrottled .
–Both the TBY counter and TBB bucket are mapped to a virtual policy counter ID PC2 with a current PC status of unthrottled , as long as the TBB bucket is not exhausted.
–Current day is the day before the account’s BCR date, and the BCR is scheduled to occur at midnight (12:00 AM).
–There is one active Gy session and one active Sy session in progress for the device, including both a mobile data flow (RG=3300) and a tethered data flow (RG-3303).
–The quota management profile (slicing profile) is configured to use a standard VT value of 12 hours for RGs 3300, 3303, and 100.
•Following features are enabled: –Support aggregate counters within subscriptions/bundles and multiple charging service support for a single counter/bucket/threshold object.
–PC IDs for buckets, SNR for added/dropped policy counters, virtual PCs, and inclusion of all PC IDs in all SNRs/notifications.
–Disable TTC for prepaid and Force VT to align to TTC and a short interval if PC status changes at BCR.
The following parameters are configured: •VTAF: 4 hours •TTCAF: 5 minutes •TTCAFlarge: 45 minutes •MINspread: 1 minute –VolTE and VilTE correlation support Scenario: •At 10 PM , an Ro VoL TE voice session starts (no RG or VT is applicable to the VoL TE voice sessions).
As the BCR is within the standard VT interval, a virtual TTC time is computed and stored, but not sent to the network.
then, the virtual TTC is set to 12:00:00 AM (= BCR Time without any adjustment).
•At 10:30 PM , a CCR-U is received for the active Gy session including usage applicable to RG 3300.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.215Charging User Guide Call mangement –The usage is applied to the base subscription’s ABY counter and a 5G CDR is generated.
–As the current time is within the standard VT (12 hours) of the account’s BCR time, and neither PC1 nor PC2 are expected to change PC status during account BCR processing, the computation of VT and TTC values are returned to the network as follows: •TTC is set to 12:03:30 AM (= 12:00 AM + RAND[1 second, 5 minutes) •VT is set to 4.5 hours (= time to BCR + RAND[TTC – time to BCR + MINspread, VTAF] = 1.5 hours + RAND[3 minutes and 30 seconds + 1 minute, 4 hours]) •At 11 PM , a CCR-U is received for the active Gy session including usage applicable to RG 3303.
–The usage is applied to BOTH the tethered databoost subscription’s TBB bucket and the base subscription’s ABY counter and a 5G CDR is generated.
–In this case, the ABY counter reaches its threshold triggering a PC status change.
An SNR is sent on the active Sy session with a PC status of throttled for PC ID PC1 (associated with the ABY counter).
–As the PC status for PC ID PC1 is now expected to change during the account’s BCR processing, and the BCR is within the standard VT interval, the computation of VT and TTC values to be returned to the network as follows: •TTC is set to 12:29 AM (= 12:00 AM + RAND[1 second, VTAFlarge] = 12:00 AM + RAND[1 second, 45 minutes]) •VT is set to 90 minutes (= time to TTC + MINspread = 1 hour and 29 minutes + 1 minute) •At 12:10 AM , the end-user converts the media in their VoL TE call from voice to video, triggering a CCR- I for a new (second) data session, with an RG of 100.
As this is the first event received on or after the account’s BCR, it triggers the CHF to take the following actions: –The current usage & state info associated with the previous billing cycle is saved so that it can be maintained until all outstanding (data) quota associated with the previous billing cycle is reported resulting in an accurate summary of cumulative usage in the account’s BCR EDR.
Note : For accounts with balance management enabled (for example, prepaid accounts), the pre- and post-event balance value reported in the BCR EDR must be stored as well, including subscription renewal charges and any pay go charges for the 120 voice minutes up through 12:00 for the VoL TE session which spans the BCR but excluding subsequent charges associated with the new billing cycle.
For example, if there are subsequent charges applicable to the new billing cycle applied before all final usage is reported and the final BCR EDR is generated, those charges should NOT be deducted from the balance amount included in the BCR EDR.
–The outstanding 120 minutes for the VoL TE voice call from the previous billing cycle (prior to the virtual TTC or BCR time at 12:00 AM), is added to the previous billing cycle info for the base subscription’s voice counter.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.216Charging User Guide Call mangement –Separate state information is created for the subscriptions applicable to the new bundle.
This includes resetting the ABY , TBY, and VOICE counters to zero and the removal of the tethered databoost bundle from the account/device as it has expired and is no longer available for usage in the new billing cycle.
–As ABY has been reset to 0, and is below its throttle threshold, an SNR is sent over the active Sy session including PC ID PC1 with a PC status unthrottled .
–GSU and VQT are returned to the network based on the current (0) value of ABY for the new billing cycle.
–A VT value of 12 hours is returned as no account BCR or subscription renewal/expiration events would occur within the next 12 hours.
•At 12:30 AM , a CCR-U is received for data session 1 reporting usage for RG 3303.
In this case, since TTC was previously set, both usage before the TTC (up through 12:29 AM) and after the TTC (from 12:29 AM through 12:30 AM) are reported.
The CHF takes the following actions: –The BEFORE usage is applied to the saved values of the tethered databoost subscription’s TBY bucket and the base subscription’s ABY counter from the previous billing cycle.
This results in a 5G CDR record.
–The AFTER usage is applied to the base subscription’s ABY and TBY counters.
This results in a separate 5G CDR.
–New GSU/VQT values are based on the current state of the new billing cycle’s ABY and TBY counters.
–VT is a set to 12 hours as there is no BCR or standalone subscription event within that interval.
•At 12:45 AM , the end user terminates it's video call and VoL TE session resulting in the receipt of two network events: –A CCR-T received for the second Gy data session.
The usage reported is applied to the ABY counter value for the new billing cycle and a 5G CDR will be generated.
–A CCR-T received from the Ro VoL TE session.
This results in 45 minutes of usage being applied to the base subscription’s VOICE counter for the new billing cycle.
A Ro VoL TE CDR is generated, which includes the following: •Start time of 10 PM the previous day.
•The full call duration of 2 hours and 45 minutes.
•An indicator that the VoL TE session spanned the BCR (recordEventResult = 15).
•At 3 AM , data session 1 returns a CCR-U for RG 3300 and the CHF takes the following actions: –The BEFORE usage (up through 12:03:30 AM) is applied to the saved values of the base subscription’s ABY counter from the previous billing cycle.
This results in a 5G CDR record.
–All usage allocated from the previous billing cycle is accounted for and the CHF will generate the BCR EDR including all final usage, which includes the 120 minutes of voice from the VoL TE call Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.217Charging User Guide Call mangement that started at 10 PM.
After generating the final EDR the stored information from the previous billing cycle is no longer needed and can be removed from the system.
–The AFTER usage (recorded after 12:03:30) is applied to the base subscription’s ABY counters.
This results in a separate 5G CDR.
–New GSU/VQT values are based on the current state of the new billing cycle’s ABY counter.
–VT is set to 12 hours as there is no BCR event within that interval.
Example 2: Modification to account BCR date using API during ongoing BCR Preconditions: An account has a periodic lifeycle of 1 day, that is, periodicity is 1 day (1 day data bundle).
The billing information (DayOfMonth is 30).
Bundle has a charging service with a bucket of 50000 seconds.
Device subscribes to bundle that is linked to account.
Include Final Usage in BCR EDRs is set to LAST_DATA_CALL .
Scenario: 1.A CCR-Initial call is received.
2.A CCR-Update call is received and CallTTC is present in ratingSession and BucketInstance has reservation map in which preReservedValue is present.
The Preserved value in reservation-map = 44275 and CallTTC in ratingSession = 1602181800000.
Patch API with updateTransition set to true is used to update the billing information for Account, where, the current HourOfDay is 23 [11:00 PM] is to be decreased by 2 hours.
That is, the HourOfDay must be changed from 11:00 PM to 9:00 PM.
Result: Following changes take place: •The billing information is updated.
•TEMEntity is rescheduled to new endTime.
•preReservedValue [decreased by 2 hours] and callTTC value [set to new endTime] is updated.
[Preserved = 37075 and callTTC = 1602174600000] 3.
16.6 New recordEventResult for data sessions spanning BCR This feature enables to set a special BCR recordEventResult value in CDRs triggered by the final transaction received for an online flow or rating group from the previous billing cycle of an account after the BCR date is reached.
This new BCR recordEventResult value should be included in CDRs associated with online usage when the following conditions are met: •The CDR is triggered by an update or terminate or release transaction received for a data session (Gy or Nchf_ConvergedCharging ) after the BCR date of the funding account of the associated subscription.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.218Charging User Guide Call mangement •The quota previously allocated for one or more of the online flows in the update or terminate/release transaction was allocated prior to the BCR date of the associated account, and •The BCR EDR of the associated account for the end of the previous billing cycle was not generated prior to the receipt of the network transaction.
In case, a Tariff Time Change (TTC) parameter had been previously returned to the network and both usage BEFORE the TTC and AFTER the TTC is included in the transaction, then only the CDR generated with the BEFORE usage for the online flow (which means, with quotaManagementIndicator = ONLINE_CHARGING when the rating group is not configured for faked offline treatment) should have its recordEventResult set to the new BCR value.
Even, in cases where zero usage is included in the transaction, the resultant CDR should still have its recordEventResult set to the new BCR value (except for a CDR triggered by zero AFTER usage reported in the transaction).
Note : The value of recordEventResult is set to 15 in all above cases.
3.
16.6.
1 Configuring this functionality To enable this functionality, we need to enable the application preference Report Session Spanned Across BCR in CDR .
Note : This feature is enabled only when the Include usage from previous billing cycle in BCR EDRs on page 210 feature is already enabled.
3.
16.6.2 Additional information Consider the following points for this feature: •Following scenarios are considered when charging is done from an account: –Case 1: When any entity (such as, a bucket or counter) is reset during BCR Reserve → BCR → Commit In this case, recordEventResult value is set to 15 in Commit CDR.
–Case 2: When no entity is reset during BCR Reserve → BCR→ Commit In this case, recordEventResult value is set to 11 (CALL_OK_RESERVE_FROM_ACCOUNT ).
•BOU bundle is not applicable for this feature because the BOU bundle doesnt reset or renew with the account lifecycle as the BOU bundle has its own lifecycle.
Therefore, a BOU bundle does not have previous values and the new value of recordEventResult is not applicable for this.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.219Charging User Guide Call mangement 3.
16.7 Alignment of Sy/Nchf_SpendingLimitControl PPC change time with GY/ Nchf_ConvergedCharging TTC This feature aligns Sy/Nchf_SpendingLimitControl pending policy counter (PPC) change time with GY/ Nchf_ConvergedCharging tariff time change (TTC).
It also supports sending pending policy counter status information over the N40 interface.
There are separate application preferences available to enable use of pending policy counter status over N28 and Sy.
When this feature is enabled for an interface (N28 or Sy), and if a policy counter status changes for an upcoming BCR, when TTC is set for a device and returned to the network, then an SNR/ Nchf_ConvergedCharging_Notify is also sent with the pending policy counter (PPC) status, indicating that the policy counter status change is expected at the BCR along with Pending-Policy-Counter-Change-Time AVP/PPC activationTime (that is, at the same time as the TTC parameter is returned over Gy/N40).
After the PPC status is sent, if the policy counter status changes to the PPC status value sent earlier when the BCR is reached, then no additional SNR is sent.
When PPC status is sent, then when the policy counter status changes at the BCR to the same value previously sent in the PPC status, no new SNR is generated.
Also, no PPC is sent if there is no expected change of policy counter status for an upcoming BCR.
After the PPC status is sent, then prior to reaching the BCR (T1), any subsequent SNRs or Nchf_SpendingLimitControl_Notify transactions that include the policy counter ID, whose future PPC has been sent, continue to include the PPC status for the policy counter.
If after pending policy counter status has been sent and, prior to reaching the BCR, a subsequent change occurs, causing the current status to change again so that the new policy counter status becomes equal to the expected value at the BCR, then an SNR/Notify is sent with the new current status omitting the pending policy counter status information and the PPCI is cleared from the session.
If the BCR date is changed for an account that is funding one of the device's subscriptions and the next subscription event (T1) is associated with the account’s BCR date or Add/Remove a new subscription, If pending policy counter information is stored for any counter, it is cleared from the session, and a SNR and/ or Nchf_SpendingLimit_Notify is sent without including any PPC status for the counter.
For the BCR date change use case, SNR/Nchf_ConvergedCharging_Notify is triggered on the next call transaction.
The application preference PPCI Feature Supported is configured to true by default.
If this new feature is enabled, then it overrides the application preference PPCI Feature Supported .
As Keep Alive feature must be enabled for this feature, if the retry interval time is configured then there may be a scenario where SNR is retried after a certain interval and PPCI time is over.
However, this is a rare condition.
3.
16.7.
1 Application preferences Set the value of the following application preferences as follows to enable this feature: •Set the value of N28 Pending Policy Counter to Time_Aligned_With_TTC •Set the value of N28 Pending Policy Counter to Time_Aligned_With_TTC Refer to section Charging application preferences on page 44 for details about these application preferences.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.220Charging User Guide Call mangement Note : For this feature to work, the feature described in section Sy and N28 keep-alive notifications and message throttling on page 122 must be enabled.
3.
16.7.2 Calculation of BCR reporting time and offline TTC Refer to section Disable TTC for prepaid accounts and alignment of TTC and VT for postpaid accounts on page 180 to know more about the parameters used in the formulas.
The following tables describe the formula to compute BCR reporting time and offline TTC are as follows: If Stored bcr Reporting Time is NULL for the device and.
..Then.
.. One or more of the bundles associated with T1 have their TTC- Disable flag enabledbcrReporting Time = T1 Tariff Time Change = NULL At least one of the subscription associated with T1 has a prepaid account and the subscriptions do not have the TTC- disable flag enabledTariff Time Change = NULL bcrReporting Time = T1 + RAND [ 1 second, MIN( VTAFprepaid, T2 – T1) ] The Disable TTC parameter configured in a bundle is disabled, 2.
The account is of postpaid type, 3.
If either of the system- level parameters defined above is enabled ( N28 or SY) , then when TTC is calculated for an upcoming BCR, this formula is used ( regardless of whether or not any policy counters for the device will change status as a result of the BCR) :Tariff Time Change = > IF (T1 + MINspread > = T2) OR ( TEMP_ INTVL – time to T1 < = MINspread) THEN: TTC = T1 ELSE: TTC = T1 + RAND[ 1 second, MIN[ TTCAF, TEMP_ INTVL- time to T1- MINspread, T2- T1-MINspread) ] When TTC is initially set for an upcoming BCR, the corresponding “ bcrReporting Time” for the device is computed and stored as follows:a.
IF PPC is enabled for N28 ( or there are no policy counter which changes status at the upcoming BCR) IF Calculated TTC + MINspread > = T2 THEN " bcrReporting Time" = T2 ELSE IF ( current time + TEMP_ INTVL < = Calculated TTC + MINspread) THEN: " bcrReporting Time" = Calculated TTC + MINspreadTable 26: Calculation of BCR reporting time and offline TTC Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.221Charging User Guide Call mangement If Stored bcr Reporting Time is NULL for the device and.
..Then.
..
ELSE: THEN: " bcrReporting Time" = T1 + RAND[ Calculated TTC - T1 + MINspread, MIN( VTAF, TEMP_ INTVL - time to T1, T2 - T1) ] b.
ELSE if PPC is NOT enabled for N28 but it is enabled for Sy AND one or more policy counters for the device changes status at the BCR IF Calculated TTC + MINspread > = T2 THEN: " bcrReporting Time" = T2 ELSE IF current time + TEMP_ INTVL < = Calculated TTC + MINspread THEN: “ bcrReporting Time” = Calculated TTC + MINspread ELSE: THEN: “ bcrReporting Time" = T1 + RAND[ Calculated TTC – T1 + MINspread, MIN( TTCAFlarge, TEMP_ INTVL – time to T1, T2 - T1) ]Table 26: Calculation of BCR reporting time and offline TTC (continued) If Stored bcr Reporting Time is not NULL for the device and.
..Then.
..
If an update causes a change so that the PC status for one or more policy counters change at the BCR (whereas previously it was not expected to change) , then if PPC is enabled for Sy but not N28, the stored “ bcrReporting Time” must be updated as follows:IF the previously stored " bcrReporting Time" < = T1 + TTCAFlarge THEN: The stored " bcrReporting Time" remains unchanged ELSE: "bcrReporting Time" = T1 + RAND[ Stored TTC – T1 + MINspread, TTCAFlarge] Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.222Charging User Guide Call mangement 3.
16.7.3 Validity Time calculation If PPC is enabled for Sy, then the stored bcrReportingTime is used to derive the validity time (VT) returned for online flows within Gy data sessions whenever VT spans T1.
However, if PPC is enabled for N28, but disabled for Sy and the status for one or more policy counter IDs changes at the BCR, then when VT spans T1, the VT returned for Gy data sessions is computed as follows: IF the stored " bcrReporting Time" < = T1 + TTCAFlarge VT = time to stored " bcrReporting Time" ELSE VT = time to T1 + RAND[ Stored TTC – T1 + MINspread, TTCAFlarge] 3.
17 Zoning and localization Zoning, which is permanently on, allows computation of the tariff from the origin of the data session.
A zone is the current location of the owner of the session, which is based on the value of PS- Information.3GPP-SGSN-MCC-MNC/SGSN-Address in the request message.
Zoning is used to fine-tune rating and charging to service provider defined zones.
When roaming, zones are used to fine-tune roaming zones that may have more or less favorable rating and charging relative to each other.
For this purpose, NCC collects a number of parameters in the requests received from the external entity and builds zoning parameters sent to the rating function.
It is the rating function that identifies the areas and applies the corresponding tariff for the communication.
Zoning is independent of roaming; however, the MCC-MNC values are used to determine a zone.
If the MCC- MNC value does not map to a zone, then the SGSN IP address is used to determine zone.
For call control, zoning maps MCC-MNC or SGSN-ip-addresses to a zone(s) and can be used to dictate the tariff applied by the Rating Engine using the following criteria: •Origin •Roaming or non-roaming Roaming and zoning attributes can be configured using complex map.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.223Charging User Guide Call mangement Figure 35: Complex map list Note : For more information on complex mapping list, refer to NOKIA Converged Charging Global Configuration Guide .
3.
18 Roaming Roaming refers to a situation where a subscriber accesses services while it is attached to a visited network, or VPLMN, but it is charged by its home network (the network where the account(s) of the subscriber are managed).
Roaming allows you to adapt the charging and rating applied to the user when located in a visited network that the home operator has a roaming agreement.
Roamer handling is similar to the way users in their home PLMN are handled.
The users trigger the data service, whether they are in their home PLMN or in a visited PLMN and the location of the user is identified by the MCC (Mobile Country Code) and MNC (Mobile Network Code) or (if the MCC/MNC is missing) by the IP address of the SGSN.
The PS-Information AVP value in incoming requests received by the External Equipment is used for roaming identification in the following order: •PS-Information\3GPP-SGSN-MCC-MNC •PS-Information\SGSN-Address •PS-Information\3GPP-SGSN-Address If the location matches a foreign network with a roaming agreement, the service allows for the configuration of a specific Event Type for this service that identifies it as a roaming trigger ( MCC-MNC equals Visited PLMN and networkType equals ROAMING ).
Then the Rating Engine provides a specific rating, tariff, and charging policy for the service.
If an incoming MCC-MNC location matches a visited network configured with no roaming agreement, the user is considered as being attached to the Home PLMN (HPLMN).
If an incoming MCC-MNC location matches no configured visited network, then the request is rejected with the appropriate Result-Code.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.224Charging User Guide Call mangement The call controller roaming decision as to whether or not the call is a roaming scenario, is made internally using configured rules.
The following figure illustrates the flow for roaming status.
Figure 36: Roaming decision flow Using the rule configuration, a rule can be included to determine the roaming decision as follows: If... Then.
..
The GY_MESSAGE.
Service- Context- Id = 32274@ 3gpp.
org,The CALL_ RESULT.
Default- Roaming- Decision = Roaming Decision HOME The value is REJECT The request is rejected with result code 5012 - DIAMETER_ UNABLE_TO_COMPLY with the error message: Rejected because the system cannot get roaming status .
The value is ROAMING or HOME , The call controller sets the roaming status.
The action does not exist, The default value is REJECT .
Configuring roaming attributes Roaming attributes can be configured using the complex map, that is, mapping tables entity in the SM GUI.
The default roaming decision can be configured in the SM GUI.
Navigate to Charging configurator > Charging tab and select Rules And Variables from the hamburger menu (☰).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.225Charging User Guide Call mangement Figure 37: RSV configured for default roaming decision Timing determination The timing determination is the definition of time delay for roaming cases based on either the code of the country where the end-user is calling from (if provided) or on the address of the IP SGSN provided by the network from where the end user is calling.
A table is hosted by the service data to associate a time difference with the country codes.
You can configure the service to rate either on the timing of the visited network or on the timing of the home network.
Notification for specific roaming cases Subscribers can subscribe international roaming subscriptions that are active when subscriber is in a particular zone and uses a specific operator.
Notifications can be sent once the subscriber tries to use the subscription when in a different zone or uses a different operator.
Note that, MCC-MNC or SGSN IP can be used to determine the location of a subscriber.
This can be configured in the Mapping tables.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.226Charging User Guide Call mangement For example, consider that a subscriber has a subscription of day pass bundle that is active only for zone1 and ABC operator.
An SMS notification is sent in the following cases: •If the subscriber tries to use the subscription when not in zone1, then the call is rejected.
•If a subscriber is in a valid network but not allowed to make calls in this network, then the call is rejected.
The notification includes the data defined in the notification template that can indicate that the subscriber is in wrong network.
Whenever there is an error in MCC-MNC or SGSN IP match, the notification can be sent to a subscriber using the rule set RATING_POST_PROCESSING.
See the subsequent section with examples for more information.
Common configuration examples: Ensure that the following entities are configured: •Create a charging service as shown in the following figure.
•Create the following mapping tables.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.227Charging User Guide Call mangement Mapping table 1 Mapping table 2 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.228Charging User Guide Call mangement •Create the notification templates.
•Create a subscription lifecycle to be linked to the bundle.
•Create a bundle and attach the previously created charging service and lifecycle.
•Create a device and account.
Apply the above configuration to following examples: Example 1: MCC collected from network has null value If the MCC is null, the result code 40010 (RULE_NOT_APPLICABLE) is returned and a notification is sent.
Following is the rule configuration for RATING_POST_PROCESSING trigger: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.229Charging User Guide Call mangement Example 2: Roaming to wrong PLMN If a subscriber tries to make calls when in wrong network, the result code 40010 is returned and a notification is sent and the call is terminated.
Following is the rule configuration for RATING_POST_PROCESSING trigger: Example 3: Roaming to correct PLMN without a valid bundle If a subscriber is in the correct network but has no bundle to be used for the call, then the defined result code is returned and a notification is sent and the call is terminated.
Following is the rule configuration for RATING_POST_PROCESSING trigger: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.230Charging User Guide Call mangement 3.
19 Usage control functionality The Usage Control (UC) functionality allows a user to restrict the usage using different configurations.
These user-level restrictions include the usage control over consumption of various kinds of unit, such as time, volume, unit, or money.
A user controls the UC restrictions based on the Time of day and Day of week functionality.
Following sections explain the usage control functionality in detail: •Emergency conditions on page 232 •Global Barred List, Allowed List, Always Allowed APN, and Always Allowed RG on page 235 •Usage control entity on page 238 3.
19.
1 Configuration UC is designed as a new service type, similar to charging services.
When a charging service is created, one or more UC services are included either in the same bundle as the charging service corresponding to the traffic (for example, data, voice, or video) controlled by the UC service, or it is included a separate UC bundle covering the traffic limits for one or more charging services.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.231Charging User Guide Call mangement Note : Each UC service covers only one or more traffic types.
Once subscribed, the UC subscription is managed using SM GUI or API interface to set, modify, or remove the following: •Allowed and barred lists (for calls, messages, and incoming and outgoing traffic) •For each traffic type covered by the usage control service: –Time of day limitations –Usage limitations Apart from the UC service subscription-level settings, some global UC settings and rules are also defined for globally allowed or barred list, allowed rating groups and APNs, and day types definition.
These settings are a part of the Global Configuration tab under the CHARGING section in the SM GUI.
UC service inclusion in bundle The UC services linked to an existing charging service bundles covers the traffic types handled by the related charging service or the UC services are linked to a specific bundle covering one or more traffic types.
The service providers follow one of the given options while defining the services offered by the UC feature to avoid unwanted or unexpected results and improve business performance: •Define a single UC service, which includes all potential traffic types (or limits) subjected to UC.
For example, one limit for calls, one limit for messages, and one limit for data.
Note : This UC service must be included only in a UC bundle that can be subscribed separately from the charging service bundles.
•Define N number of UC services, which implies one UC service per traffic type.
Each UC service is included in the existing related charging service bundle that handles related traffic type.
3.
19.2 Emergency conditions The emergency rules evaluate the state of emergency traffic for the incoming calls.
Once the emergency scenario starts, it allows the calls of different tariff types based on the priority of the emergency level to skip the following restrictions: •Barring at global level •Barring at UC level •Restrictions imposed by UC limits and time of day During an ongoing emergency scenario, the counters as configured in the UC configuration are incremented even though UC checks are skipped until the emergency scenario is uplifted.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.232Charging User Guide Call mangement The emergency functionality in UC facilitates the creation of RSV based rules, which allow the user to declare the emergency scenario for a device and perform the following actions: •Declaring the emergency scenario for a time period specified in the RSV based rule.
•Defining the level of emergency in the rule.
Following types of emergency options are available to the user: –All –Data, voice-video, or eCommerce –Data, or voice-video –Voice-video –SMS or MMS –None •Updating the emergency scenario for a device in case another emergency call is received during an ongoing emergency period.
The device is updated based on the following conditions: –The incoming call must be of same or higher priority than the existing emergency (which is ongoing).
If the incoming call is of higher emergency level, then the start time is set to current time and end time is evaluated on the basis of duration configured in the rule set.
Also, the result code and emergency levels are set as configured in the rule set.
–The level of emergency call is determined on the basis of the Set-Emergency action defined in the rule.
The priority of emergency level is defined in the following table in descending order: Emergency level type Description ALL The emergency is applicable to all tariff types.
DATA_ VOICE_ VIDEO_ ECOM The emergency is applicable to data, voice, video, and e Commerce calls.
DATA_ VOICE_ VIDEO The emergency is applicable to data, voice, and video calls.
VOICE_ VIDEO The emergency is applicable to voice and video calls.
SMS_ MMS The emergency is applicable to SMS and MMS.Table 27: Emergency level types Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.233Charging User Guide Call mangement Emergency level type Description NONE This is used for resetting the emergency level type.Table 27: Emergency level types (continued) •If a lower priority emergency call arrives during an ongoing emergency period, then the request to update the emergency level for a device is ignored.
•Emergency level is set in the following ways: –Using a self-care API for emergency calls taking the input for start time, end time, emergency level, and device ID.
–Executing rules during a call with evaluation of emergency duration and emergency level as configured in the rule set.
•The emergency level for a device is cleared under the following scenarios: –The time period set for emergency has elapsed.
–An API request is received for clearing emergency, that is, inputs as startTime (0), endTime(0), and emergencyLevel (NONE).
–A rule is defined for clearing the emergency with action unset emergency.
View emergency set on device The SPR_DEVICE.Emergency-Level rule attribute is exposed at device to get the emergency level as already set, which is used to control the notifications that are sent or any other actions that need to be executed.
The available values are: •ALL •DATA_VOICE_VIDEO_ECOM Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.234Charging User Guide Call mangement •DATA_VOICE_VIDEO •SMS_MMS •NONE 3.
19.3 Global Barred List, Allowed List, Always Allowed APN, and Always Allowed RG The Global Configuration tab within the CHARGING option in SM GUI is used for provisioning global lists.
The following types of lists are available at global level for charging services: •Global Barred List •Allowed List •Always Allowed APN •Always Allowed RG Global Barred List The global barred functionality facilitates the creation of RSV based rules, which check on calls for Global Barred List , Allowed List , Always Allowed APN , and Always Allowed RG .
The Global Barred and Always Allowed rules are applicable to calls received for Mobile Originated (MO) calls and calling party number for Mobile Terminating (MT) calls.
Following tariff types are applicable on Global Barred and Always Allowed rules: •IMS calls •SMS •MMS Always Allow rule checks are related to RG or APN list and these are applicable to following tariff types: •Data call •IMS call •SMS •MMS Following is the behavior for an initial call request or update call request: 1.Initial call (CCR-I) request: •When an initial call is received on a device, the incoming number is checked against the Global Barred List .
If the incoming number is available in the Global Barred List , then the call is terminated.
•If the incoming number is available in the Allowed List , then UC check is not applicable and the incoming call continues.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.235Charging User Guide Call mangement •If the incoming number is not present in both Allowed List and Global Barred List , then check is based on whether APN or RG exists in Always Allowed RG or APN List .
•If the RG or APN for Multiple Service Credit Control (MSCC) is available in Always Allowed RG or APN List , then UC check is not applicable and incoming call continues.
•If the RG or APN for MSCC is not available in Always Allowed RG or APN List , then the incoming call is checked for further UC checks (if configured).
2.Update call (CCR-U) request: For CCR-U scenarios, the incoming or the forwarded number is checked against the Global Barred List .
If the number is found in the Global Barred List as per the rule configured, then the call continues to rate and after committing USU, the result code is evaluated by the rating logic.
In this case, USU is committed and GSU is set to 0 in update response.
In case of Global Barred , Always Allowed , and Always Allowed RG or APN List , the rule evaluation is done while processing the GY_PRE_PROCESSING rule set.
In case, the rule is evaluated, then an action is returned that sets the UC-Applicable flag as false , which means to skip the UC checks.
If an emergency scenario is ongoing, then irrespective of the number barred as per rule evaluation, the call continues.
For rules, a source context GLOBAL is added in the GY_PRE_PROCESSING rule set.
Following are the attributes added in the GLOBAL source context: •GLOBAL.AllowedList •GLOBAL.BarredList •GLOBAL.RatingGroupList •GLOBAL.APNList The SESSION_PARAMETERS.UC-Applicable and SESSION_PARAMETERS.Return-Result-Cause attributes are added in the SESSION_PARAMETERS result context.
Following is an example of rule set within GY_PRE_PROCESSING trigger.
Examples Example 1: The global barring on MO IMS calls through configurable rule set.
The rule conditions in following rules applied for MO IMS, MO-SMS, and MMS-based on origination type and called party address.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.236Charging User Guide Call mangement •The Barred List in the Global Configuration entity in the charging service needs to be configured with the numbers that are to be barred.
•For MO IMS call, if the Role of Node AVP is of originating type and called party address is found in the Global Barred List , then result code and result cause are set to Session Parameter Result Context to return the call without further processing.
Example 2: A match is found for Always Allowed List , Allowed RG List , or Allowed APN List through configurable rule set.
The rule conditions in following rules apply to IMS, SMS, MMS, and data calls.
•The Allowed List in the Global Configuration entity in the charging service needs to be configured with numbers to be allowed for skipping UC checks.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.237Charging User Guide Call mangement •The Allowed RG List in the Global Configuration entity in the charging service needs to be configured with RGs to be allowed for skipping UC checks.
•The Allowed APN List in the Global Configuration entity in the charging service needs to be configured with APNs to be allowed for skipping UC checks.
•For IMS call, the called party number is matched in the Allowed List and if found, then the UC- Applicable flag is set as false .
Similarly, for SMS and MMS calls, the address data in recipient address is matched in the Allowed List and accordingly the UC-Applicable flag is configured.
•For data calls, the APN or RG are matched in the Allowed RG List or Allowed APN List , and if found, then the UC-Applicable flag is set as false .
•If the UC-Applicable flag is set as false by any of the preceding rules, then the call processing takes decision to skip the UC checks.
However, the counter of applicable UC object is incremented for consumption.
3.
19.4 Usage control entity The Usage Control entity allows users to regulate and restrict on the consumption of tariff units based on the usage limit and time of day or day of week selections on the device.
The usage control service executes the following actions using threshold levels: •Notification to user on defined threshold limit on usage.
•Call rejection (hard-stop) on reaching a maximum value of threshold limit on usage.
Note : For thresholds on self-counter, only notification actions and hard-stop are supported through a threshold and any other configured actions are ignored.
Usage control facilitates provisioning of barred and allowed lists at user level, which is configurable by users through self-care API.
The Usage Control entity allows identification of usage control based on the applicability condition, priority of UC (lowest value have highest priority) and subscription creation time (earliest created have higher precedence), which are used during sorting logic.
When a call arrives, multiple usage control services are identified as configured in a subscription bundle for a device.
The Usage Control entity allows provisioning of usage limits for the following kinds of tariff units: •Voice •Video •SMS •MMS •Data •eCommerce Each usage limit allows provisioning of following parameters: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.238Charging User Guide Call mangement 1.Select Counter : Select one of the following types of counters: a.Pre-existing counter associated with a charging service, also referred to as the reference counter.
b.Internal counter for usage control only, also referred to as the self-counter.
Note : Policy counters are not supported for UC self-counters.
2.Select the usage limit for the type of counter selected: a.Override the usage limit of reference counter.
The unit type of usage limit is same as the unit type in the base counter definition.
b.Define the usage limit for self-counter.
The unit of limit is basic unit corresponding to kind of tariff type.
3.Select the threshold for the type of counter selected: a.Accumulate threshold for reference counter.
All thresholds associated to reference counter is applicable, which means either from charging service or usage control.
b.Define threshold for self-counter.
Note : Policy thresholds are not supported for UC self-counters.
4.Define applicability condition for usage control.
5.Define time of day restriction, which is a period within a day during which the usage restriction is applicable and day type, that is weekday or weekend.
Each UC limit defines multiple time of day slots for each Day Of Week .
The definition of Day Of Week parameter is configured under the Usage Control tab.
6.Use the UC limit ID to identify usage limit associated with tariff units.
Examples for UC service definitions For the examples in this section, define the usage control using the SM GUI.
To do this, navigate to Common Configuration , click the CHARGING tab and select Usage Control from the hamburger menu (☰) and follow the given steps: 1.Configure the name of the usage control service in the Name parameter.
2.Configure the priority of the usage control service in the Priority parameter.
In case multiple UC services are provisioned, priority is used in sorting during a call control for identifying the UC service to be applied.
3.The Allowed List and Barred List is configured as per the definition.
However, the actual update is done by the user when subscription is created for a bundle having a UC associated with it.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.239Charging User Guide Call mangement 4.Configure the Applicability Condition , which is used for filtering UC services in sorting during a call control for identifying the UC services to be applied.
For defining UC applicable for SMS, following applicability condition can be defined: 5.Click ADD LIMIT to expand the panel for configuration of usage limit parameters.
a.Select the required unit from the Kind Of Unit drop-down list.
b.If a pre-existing counter of charging service needs to be configured for usage control, then click on the Select Counter drop-down list and select the required counter.
c.Configure the applicability condition at the limit level, which is basically used at MSCC level for filtering the Usage Control entities.
6.Click ADD DAY OF WEEK to expand the panel for Time Of Day configuration: a.Select a weekday or weekend for the Day Of Week drop-down list.
Select the required options to apply the time of day functionality.
b.Select the Start Time and End Time for the time of day.
Note : Multiple time slots can be configured per day of week by clicking the ADD TIME button.
c.Similarly, multiple day of weeks can be configured by clicking the ADD DAY OF WEEK button.
d.Configure the Usage Limit and select the threshold from the pre-existing threshold groups.
Note : For reference counters, the limit unit type is same as the base type of counter.
The usage limit overrides the base usage limit of counter.
Whereas, for self-counters, the limit unit type is the basic unit type corresponding to kind of unit selected.
Examples Example 1: Usage control service with allowed or barred list, and only one traffic type usage limit using reference counter.
1.A device is subscribed to be a bundle associated with a charging service.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.240Charging User Guide Call mangement 2.The Usage Control entity needs to be created from the usage service (as defined in the above section) with selecting counter, which is already associated with the charging service.
3.Configure usage limit in usage control to override the base usage limit of reference counter.
4.Associate a threshold with the UC limit with following trigger action configuration: a.NOTIFICATIONS.Send-Notification at 50% consumption (soft-stop) b.NOTIFICATIONS.Notification-Reject at 100% consumption (hard-stop) 5.Associate the usage control service into the bundle, which is already associated with the charging service.
6.Create a new device subscription for the above bundle.
Now, when a call arrives for this device, the usage limit object is selected through sorting logic and counter is incremented based on USUs.
Once, the counter consumption reaches 50% of the usage limit, the notification is triggered through threshold.
If the counter consumption reaches 100% of the usage limit, the notification is triggered and call is rejected after committing USUs as hard-stop condition is met.
Note : Counter consumption is verified during calls from the SM GUI (navigate to Subscriber Manager > Devices > Usage Limit tab).
Example 2: Usage control service allowed or barred list, and only one traffic type usage limit using self- counter.
1.A device is subscribed to be a bundle associated with a charging service.
2.The Usage Control entity needs to be created from usage service (as defined in the above section) without selecting any counter.
This creates an internal counter (self-counter) for usage limit.
3.Configure usage limit in usage control, which is the usage limit of self-counter.
4.Associate a threshold with the UC limit with following trigger action configuration: a.NOTIFICATIONS.Send-Notification at 50% consumption (soft-stop) b.NOTIFICATIONS.Notification-Reject at 100% consumption (hard-stop) 5.Associate the usage control service into the bundle, which is already associated with the charging service.
6.Create a new device subscription for the above bundle.
Now, when a call arrives for this device, the usage limit object is selected through sorting logic and counter is incremented based on USUs.
Once, the counter consumption reaches 50% of the usage limit, the notification is triggered through threshold.
If the counter consumption reaches 100% of the usage limit, the notification is triggered and call is rejected after committing USUs as hard-stop condition is met.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.241Charging User Guide Call mangement Note : Counter consumption is verified during calls from the SM GUI (navigate to Subscriber Manager > Devices > Usage Limit tab).
3.
19.5 Additional information Following are some important points to note for the UC functionality: •It is recommended to provision only one UC service per bundle.
•When a UC service is included in a charging service bundle, it is recommended to configure the included UC service of the same traffic type with same applicability conditions that are supported by the charging service bundles.
•The traffic types or applicability conditions, and combinations for UC limits inside the same UC service are strictly exclusive.
•Although several UC services or bundles are defined, the UC service does not allow the service provider to subscribe more than one UC service covering a specific traffic type and applicability conditions.
However, if this condition cannot be avoided, then assign a different priority to both UC services.
•If the service provider needs to override an existing reference charging service counter limit, then the service provider must ensure that the same traffic type and related applicability conditions are used for the charging service counter and for the UC limit, which references this counter.
Otherwise, UC specific self-counters must be used.
For example, to define specialized usage limits for specialized traffic types, such as voice and video calls, it is done using UC limit applicability conditions.
However, if there is only one charging service counter with video and voice calls, then use the self-counters in UC with related exclusive applicability conditions defined for each limit.
•If the service provider selects the UC only bundle scenario, then there is a single allowed and barred list for all applicable traffic types.
If the owner selects the UC service included in a charging service bundle, then there is a different allowed and barred list per charging service bundle.
In such cases, service provider includes applicability conditions at the level of UC service corresponding to the charging service traffic types included in related bundle.
If this is not done, then allowed and barred lists from a different bundle is selected based on their respective UC service priority.
•If multiple limits of same type across several UCs that are subscribed for a device refer the same counter, then the limit added last through a UC subscription updates the counter with its usage limit and thresholds.
•UC self-counter does not increase in Direct Debit call.
3.
19.6 Examples The emergency scenario is configured by the rule set.
Following examples show the configuration in rule sets that trigger an emergency scenario: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.242Charging User Guide Call mangement Example 1: EmergencLevelType_ALL The following figure shows the rule set configuration for initiating an emergency scenario for an incoming call having a length of called party number less than equal to 5: This rule configuration sets the emergency level to ALL tariff type, that is EmergencLevelType_ALL and sets the emergency scenario duration as 60 seconds .
•The device for which emergency scenario is to be initiated is identified from the call based on the Subscription ID AVP in an IMS message.
•The emergency level EmergencLevelType_ALL in rule sets the start time of emergency scenario as the system time at the evaluation of rule during call processing.
•The end time of emergency scenario is the sum of start time and duration as configured in the rule set.
•The rule set allows CDR tag to be generated as per the configuration.
Example 2: EmergencyLevelType_VOICE_VIDEO The following figure shows the rule configuration for initiating an emergency scenario for an incoming call based on parameter values defined in the AVP, such as service-type in IMS service specific information: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.243Charging User Guide Call mangement This rule configuration sets the emergency level for voice and video tariff types, that is EmergencyLevelType_VOICE_VIDEO and sets the emergency scenario duration as 60 seconds .
•The device for which the emergency scenario is to be initiated is identified from the call based on the Subscription ID AVP in an IMS message.
•The rule validates the condition for emergency based on value of the Service-Specific-Type AVP set as 1007 and Service-Specific-Date AVP set as 255.
•The emergency level EmergencyLevelType_VOICE_VIDEO in rule sets the start time of emergency scenario as the system time at the evaluation of rule during call processing.
•The end time of emergency is the sum of start time and duration as configured in the rule set.
•The rule set allows CDR tag to be generated as per the configuration.
Example 3: EmergencyLevelType_None The following figure shows the rule configuration for terminating an emergency scenario for an incoming call based on parameter values defined in the AVP, such as service-type in IMS service specific information: This rule configuration terminates the emergency scenario by the emergency level as None , that is EmergencyLevelType_None .
•The device for which the emergency scenario is to be terminated is identified from the call based on the Subscription ID AVP in an IMS message.
•The rule validates the condition for termination of emergency based on value of the Service-Specific- Type AVP set as 1007 and Service-Specific-Date AVP set as 256.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.244Charging User Guide Call mangement •The emergency level EmergencyLevelType_None in rule sets the start time of emergency scenario as 0.
•The end time of emergency is set as 0.
•The rule set allows CDR tag to be generated as per the configuration.
3.20 Twin SIM functionality Before this feature, NCC supported notification to be sent only to the first E164 identifier of a device.
With this feature, the Notification Server (NS) is enhanced to send notifications to the primary MSISDN, which can be taken from the phone number (E164) configured in a user entity, thus supporting multiple device identities, such as one Device ID , two E164 , and one IMSI for a device.
Note : For this feature, the provisioning system must ensure the following: •MSISDN configured in a user entity is the Primary MSISDN .
•Device should be created with a DeviceID same as the Primary MSISDN for twin SIM devices.
•The user entity should be always be configured and with only MSISDN and not multiple MSISDNs.
Following APIs are supported for this feature: •createDevice API •createProfile API •/services/ServiceManager/subscriber/updateByIdentifier/Device •/services/ServiceManager/subscriber/update/Identities •/services/ServiceManager/subscriber/deltaUpdate/Device?subAction=(add,modify,remove) •/services/ServiceManager/subscriber/update/Device 3.20.
1 Configuration To enable this functionality, set the application preference Send Notification MSISDN as USER_PRIMARY_MSISDN .
However, if the Send Notification MSISDN is set as DEVICE , then the notification is sent to the device E164 identifier.
Note : •If a user entity is configured with multiple phone numbers, then the notification is sent randomly.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.245Charging User Guide Call mangement •If a user entity is configured with a phone number, which is not the MSISDN (that is, E164 identifier of the device), then the notification is sent to the E164 identifier defined in the Device ID .
3.20.2 EDR enhancement When a device is being provisioned or updated with multiple device identities, such as one Device ID , two E164 , and one IMSI , the EDR for the device states all the provisioned E164 and IMSI identifiers.
Only Provisioning EDRs related to device contains the tags and it is required to have a separate distinct tag for each identifier, that is E164 multiple times in an EDR.
Configure the following application preferences: •Set the EDR Enhancement Enabled as DEVICE_UPDATE .
•Set the EDR Generator Flag as true .
•Set the EDR Enabled as true .
For more information on EDR details, refer to the NCC CDR/EDR Reference Guide .
Note : Backward compatibility of EDR for a device update is maintained.
3.20.3 Landing Gateway API The /services/ServiceManager/getRefData/ChargingSession API is used to fetch the Gy session with multiple E164 identifiers.
For example, consider the following images wherein we fetch Gy session with multiple E164: •First E164 set as 1234567890 .
•Second E164 set as 1234567891 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.246Charging User Guide Call mangement Sessions related to Device-1 are fetched in this example: Note : This scenario is also applicable to IMS, Sy, N40, and N28 sessions.
The execution of parallel Gy calls with configuration of different APN or location, and with two E164 Subscription-Id is populated in the CDR tag from the device (E164 or IMSI as per call request); as, in general, all Subscription-Id reported in a CCR request are dumped in CDR.
Multiple Sy sessions support for both E164 identifiers provisioned in the device.
There can be a dedicated Gy and Sy session for each E164 configured in the device; therefore, with respect to the device, it is multiple Gy or Sy for twin E164 sessions.
Note : •To fetch RAR from API to all Gy sessions of a device having two E164 identifiers: services/ServiceManager/sendRARForSubscriber/GySession?
•To fetch ASR from API to all Gy, Ro, or N40 sessions of a device: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.247Charging User Guide Call mangement services/ServiceManager/sendASRForSubscriber/GySession?
•Use /services/ServiceManager/subscriber/getData/Subscription in twin SIM functionality for getData/Subscription API; whereas, use getData/Subscription for multiple Identifiers for twin SIM functionality.
•As sessions contain internal information used by charging logic, not all attributes are returned in the getRefData/ChargingSession API response.
3.20.4 Additional information Consider the following points for this feature: •In NCC, a device can be provisioned with E164s attached to another device.
The application preference Restrict duplicate E164 in device restricts provisioning of devices with duplicate E164 (that is, device with an E164 that is already attached to another device).
If this flag is enabled (= 1) then only unique E164 is provisioned.
If the user is supposed to create a device with existing E164, then an exception is thrown.
•If two devices have the same E164 and the request from network contains input E164, then the call is rejected with an error.
•This feature supports configuring a device identifier with ONL Y two E164s and one IMSI.
It is NOT recommended to use more than two E164s and more than one IMSI.
•Call execution is dependent on the Input Subscription ID AVP.
3.21 Assume positive functionality This functionality facilitates quota allocation for a data session when site routing fails due to device not found in the charging application.
In this case, NCC does not drop the call and if the application preference parameter Assume Positive Flag is enabled, then no error is returned.
However, if the Assume Positive Flag is disabled, then NCC returns an error with a predefined amount of quota granted to the Gy request with result code 2001 in the CCAi response message.
If another CCR-U arrives, then the charging application handles it using the uncorrelated CCR-U or CCR-T flag.
Otherwise, the call is rejected.
Note the following important points: •This feature is applicable only to SCUR (volume) calls, and Gy and NCHF request, centralized, and decentralized calls.
•When this feature is enabled, feature Uncorrelated CCR-U/T does not get triggered.
However, when the Offline CDR Generation for Inbound Roamer feature is enabled, then this feature's logic is followed.
•When the Assume Positive Flag for CCRU and CCRT and Assume Positive Flag application preferences are disabled, then an alarm is generated for device not found case.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.248Charging User Guide Call mangement 3.21.
1 Configuration Configure the following charging application preferences to activate the assume positive functionality: •Assume Positive Flag : If this flag is set as True , then the assume positive functionality is enabled.
The supported values of this flag are True and False .
•Assume Positive GSU : The value of this parameter provides the static GSU to be allocated if the assume positive functionality is enabled.
The supported range for this parameter is greater than zero and less than long maximum value.
•Assume Positive VT : The value of this parameter provides the static VT if the assume positive functionality is enabled.
The supported range for this parameter is greater than zero and less than long maximum value.
Configure the following charging application preferences to activate the assume positive for CCRu and CCRt functionality: •Assume Positive Flag For CCRU And CCRT : If this flag is set as True, then the assume positive functionality for CCRu and CCRt is enabled.
The supported values of this flag are True and False .
•Assume Positive GSU •Assume Positive VT 3.21.2 Examples Consider the following examples for a better understanding of the assume positive functionality: Example 1: Gy CCR-I fails due to no device found NCC receives a Gy CCR-I call and the call controller looks up the device in the database.
If the device is not found, then the assume positive functionality is checked based on which the NCC logic is executed.
Example 2: Gy CCR-U fails due to no device found NCC receives a Gy CCR-U call and the call controller looks up the device in the database.
If the device is not found, then the assume positive for CCRu and CCRt functionality is checked, and based on which the NCC logic is executed.
Example 3: Gy CCR-T fails due to no device found NCC receives a Gy CCR-T call and the call controller looks up the device in the database.
If the device is not found, then the assume positive functionality is checked based on which the NCC logic is executed.
The call logic does not return predefined GSU and VT in CCAt message and does not dump GSU in CDR.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.249Charging User Guide Call mangement Example 4: Assume Positive Flag is enabled NCC handles a call with a predefined GSU (volume only) and VT at each MSCC.
It then provides a static GSU and VT values from the application preferences when the following configuration is applied: •Assume Positive Flag is set as True •Assume Positive GSU is set as 30 •Assume Positive VT is set as 50 The Call Controller puts the CDR structure with tag values of Subscription-ID and GSU value (30) and alarm is not generated for device not found when the Assume Positive feature is turned on.
After this, the Call Controller processes all the MSCCs one after the other with a predefined GSU (30) and VT (50) for each MSCC from application preferences and creates an MSCC CDR.
Example 5: Assume Positive Flag is disabled The call fails with an error in the CDR that a device is not found.
Therefore, GSU and VT are not allocated, MSCC is not logged into the CDR, and session is not created.
Example 6: Assume Positive Flag for CCRu and CCRt is enabled NCC handles a call with a predefined GSU (volume only) and VT at each MSCC.
The values are from the following application preferences: •Assume Positive GSU is set as 30 •Assume Positive VT is set as 50 The call controller creates a CDR structure with tag values of Subscription-ID and GSU value (30) and USU value from request message.
It does not generate alarm when device is not found.
Example 7: Assume Positive Flag for CCR-U and CCR-T is disabled NCC checks whether the feature Uncorrelated CCR-U/T enabled or not.
If enabled, then the Uncorrelated CCRU/T feature logic is followed.
Otherwise, the call is rejected.
Example 8: Uncorrelated CCR-U or CCR-T flag is enabled in a Gy CCR-U message If a CCR-U call arrives and a device exists, then the call is successful, GSU and VT are provided from rating, CDR is logged with no error found, and a session is created.
However, if a CCR-U call arrives and a device does not exist, then the call fails, GSU and VT are not allocated, MSCC is not logged in the CDR, and no session is created.
Example 9: Uncorrelated CCR-U or CCR-T flag is enabled in a Gy CCR-I message If the Uncorrelated CCR-U/T flag is enabled for a Gy CCR-I message, then there is no impact.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.250Charging User Guide Call mangement 3.22 NCC mediation and dual running mode With dual running mode, NCC and NCC-mediation can be configured to co-exist in single a deployment.
Existing external OCS customers can deploy NCC mediation to support rating and charging of 5G subscribers, where NCC mediation converts 5G requests (N40/N28) to 4G diameter requests before forwarding them to the external OCS.
Eventually, this will also lead to gradual migration of these subscribers to NCC.
For a 5G request if the subscriber is found in NCC, then NCC processes the request and all related future requests.
NCC mediation can be controlled by ME application preference Dual Running Mode (refer to Charging application preferences on page 44 for details).
It is disabled by default.
•Dual Running Mode = 0: If the subscriber is not found in NCC, then the N40/N28 call is not redirected to external OCS.
•Dual Running Mode = 1 or 2: If the subscriber is not found in NCC for the N40/N28 request, NCC mediation tries to route the request to other external OCS to check if the subscriber belongs to that external OCS.
–If the subscriber is found at the external OCS, the request is processed and all future related N40/N28 requests are processed in the external OCS.
–If subscriber is not found in the external OCS as well, then the N40 request is sent to NCC for CDR generation with all relevant 5G tags if Dual Running Mode = 2, and Support For inbound roaming = 3 (for generating the CDRs for unknown devices).
•If Dual Running Mode ≠ 2 or Support For inbound roaming ≠ 3, or it is an N28 request, then if the subscriber is not found in the external OCS, then the request is not sent back to NCC for CDR generation.
Rather, the external OCS rejects it with Unknown subscriber error.
•If Dual Running Mode = 4 and Support For inbound roaming = 3 then CDR is generated for all SMF transactions and incoming calls are converted to 4G Diameter and forwarded to external OCS based on 5G parameter charging characteristic values.
For conversion logic of N40/N28 requests to the diameter request sent to external OCS, refer to Standard Compliance and Interface Reference .
Sample configuration for Dual Running Mode = 4 Use mapping table for data provision.
Add new key [KeyToChargeTag] for charging characteristics values.
The tag list takes semi-colon as delimiter, e.g., 0200;0400 for online, 8500 for offline.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.251Charging User Guide Call mangement Map name Map key Map value 1 Map value 2 Map value 3 ... Realm1 Host11 Host12 ... Realm1 Host21 Host22 ...KeyToSites ... ... ...
...External OCS KeyToCharge Tag<Charging characteristic value - online><Charging characteristic value - offline>Table 28: Sample mapping table Note : •The map name must be ExternalOCS .
•Diameter peer/root must be configured appropriately.
3.23 On-call detachment of group in final state When Gy/IMS/5G/ECUR call is received and the parent group for the device is already in final state, that is, the group will be removed later by lifecycle state, after committing the previously reserved unit from group resources, the relationship between group and device is detached.
Group resources are not used to allocate quota for next slice.
Also the group ID is removed directly from device if the group does not exist.
3.24 Handling update request without USU/RSU Request without RSU In a 5G environment, a trigger causing the SMF to report usage for one rating group (RG) may cause the SMF to also piggy-back locally stored UUCs (with a TriggerCategory of DEFERRED_REPORT) for another RG in the same update.
However, the previously allocated quota for the SMF may not be exhausted for this RG, and a new quota allocation may not be needed.
So the MUU does NOT include the requestedUnit IE.
The CHF can record the reported usage and reduce the remaining outstanding allocated quota for the RG, while NOT allocating any new quota (that is, no MUI is expected in the response).
By not allocating new quota additional traffic between the SMF and UPF can be avoided.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.252Charging User Guide Call mangement If the ME application preference Skip New Quota When No RequestUnit is set to true , then usage reported in UUCs is recorded in update transaction and new quota is not allocated if the SMF does not include the requestedUnit within the MUU.
Also if there is no RSU AND the reported usage for the flow is includes a TriggerType of FINAL, then any remaining allocated quota for the flow is canceled (that is, any remaining reservation is canceled).
Request without USU There are scenarios where an SMF can store a number of UUCs for an N40 session for TriggerCategory of DEFERRED_REPORT (for example, CHANGE_OF_UE_PRESENCE_IN and PRESENCE_REPORTING_AREA).
When the SMF sends an update to the CHF, it sends all the stored UUCs and then request new quota in the final update message.
In the final update, the SMF requests quota for all active data flows (that is, irrespective of whether it included any UUCs in the last update transaction or not).
Therefore it is possible (depending on the distribution of UUCs across RGs) that in the last update transaction for transfer of all the UUCs to the CHF, one or more of the active RGs may not include any UUCs within their MUU that includes a requestedUnit IE.
If the ME application preference Allow N40 request Without UUC is set to true , CHF can allow new quota in this case even if no usage is reported for the MUU.
If the ME application preference Allow N40 request Without UUC is set to false , there is currently outstanding quota for the flow, and no UUCs are included within the MUU, then the CHF returns the result code RATING_FAILED .
Work flow for request without USU/RSU The following table describes the result for update/terminate request for various combinations of presence/absence of USU and RSU.
RSU USU Request typeResponse CDR Present Present Update Response with MUU and granted units.CDR with requested and consumed units Absent Present Update No MUU in response for RG without RSU.MUU and UUC present in CDR no reservation info Absent Absent Update No MUU in response for RG without RSU and USUMUU missing in CDR for RG without UUC and RSUTable 29: Update request without USU/RSU - various combinations Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.253Charging User Guide Call mangement RSU USU Request typeResponse CDR Present Absent Update MUU in response for grated unitsMUU in CDR without UUC Absent Absent Terminate No MUU in response for RG without USUMUU missing in CDR for RG without UUCTable 29: Update request without USU/RSU - various combinations (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.254Charging User Guide Charging rules 4Charging rules This chapter describes rule contexts and attributes used between call controller and the rating engine.
Rules are logical expressions constructed as if-then statements established by the user to reflect the unique business needs.
NCC supports rule authoring for all PS-Information attributes defined in 3GPP TS 32.299 (Diameter charging applications) and 32.251 Release 11 (Packet Switched (PS) domain charging).
Note : None of the PS-Information attributes are supported as result context attributes.
CAUTION : When a rule is created, modified, removed, or loaded, it takes a minimum of 30 seconds to load the RSV.
For any action that updates the rules (for example, a TPG value is updated from 10 to 20, an action is updated, or a Tariff Rule action is modified), the changes take effect after ~30 seconds.
Operators must wait for this time interval (30 seconds), to consider the change for feature implementation/execution.
4.
1 Rule engine This chapter describes rule authoring, the common NCC Diameter rule engine architecture and operations, the composition of a rule for all applications, along with variables, and mapping for the specific application rule engine operations used to manage the traffic handled by the NCC.
Each application (Diameter Configuration and NCC) has their own robust rule engine with rule system functionality that is specifically designed for the application.
The application specific rule engines are organized into groups of pre-defined scenarios called rule system versions (RSVs).
Each RSV contains a collection of rule groups that implement a customized NCC message modification and additional behavior each time a Diameter message is received or whenever the rule engine is invoked by the application.
Rule authoring The rule engines evaluate the rules and return the results as shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.255Charging User Guide Charging rules Figure 38: Overall rule processing Rules are used to customize NCC behaviors when certain events occur.
Rules can be used for many things, including sending and customizing notifications, generating event logs, modifying session parameters, defining system charging, and for making customized charging decisions.
For example, when a session is established, you might want to customize getting information from a CCR for a type of roaming to enact the correct rating and charging on a call.
The Rule Engines operates in a simple input and output concept.
The input is the data available for an invocation along with a set of rules to be invoked.
The output is a result returned from the invocation.
The Rule Engine implements an event-driven, forward-chaining rule evaluation algorithm using production style rules on invocation.
When required, NCC requests that the Rule Engine executes a particular Trigger via an interface available to NCC.
All rules in the rule group that make up the Trigger are evaluated by the appropriate rule engines as their conditions are matched.
A top level rule group is generated from any profile that exists.
In each group, the first rule (in the order of precedence ) whose conditions are met is executed.
The actions specified in the rule are returned to NCC, where the appropriate steps are performed for the action (for example, action values to accept or reject the application session request).
After the application plugins have been sequenced, the rules and messages are evaluated and invoked by the system to process the specific functionality in the sequence of, and by, the installed application plugins.
That is, rules are written such that as they cascade through the system the rule whose conditions are matched first is executed offering an order of precedence as shown in the following diagram.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.256Charging User Guide Charging rules Figure 39: Rule precedence by application plugin For the Diameter Rule Engine functionality, when a Diameter message arrives at NCC, the rule engine can be invoked up to two times depending on whether the message is a Diameter Request or Answer: once for the scenario of a basic message type Trigger, and again for the specific message type Trigger.
The rule engine first parses the incoming message as either a Diameter answer or a Diameter request message and invokes the appropriate request/answer Trigger.
Once the generic processing is complete, NCC rule engine may be invoked again to execute the Trigger for the specific message type.
The rule processing flow is shown in the following figure.
Figure 40: Diameter rule processing flow Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.257Charging User Guide Charging rules When a trigger occurs, such as a message arriving at NCC, the associated set of rules from the profiles configured are evaluated.
The rules, with access to all of the data available, determine the service, rating, and charging for the device, group, and account.
NCC will then take the appropriate action as shown in the following figure.
Figure 41: NCC rule processing flow Rules are organized into (potentially large) groups called Triggers.
All triggers are pre-defined in NCC and are evaluated by the appropriate rule engine.
Although you can define the contents of the Triggers, you cannot introduce new Triggers.
A rule group is a set of rules associated with a trigger that may be associated with a rule system version.
Each rule group contains one or more groups of conditions and associated actions.
When an event happens in the system, the corresponding Trigger is invoked, and then all rule groups that belong to the Trigger are evaluated and the Rule Groups are executed in an order of precedence.
For Charging rules, the selection of a specific Trigger is automatic by NCC depending on the profile you are working in and not visible to the operator that is authoring the rules.
However, if you are provisioning with an API or configuring a rule variable, you are required to add the Trigger.
A rule belongs to a rule group and is built from the options available in the rule conditions and actions.
Triggers determine when the associated rule tables are analyzed and as message processing flows are executed in NCC, specific Triggers are applied.
See the respective application user guides for more information about their specific rule engines.
4.
1.
1 Rule dictionaries The dictionaries are XML files containing the definition of all the source contexts, condition attributes, result contexts, and action attributes in the active Rule System Version.
It also contains the definitions of the rule sets and the definitions of some rule variables.
Each application has its own dictionary just as each application has its own RSV.
The following rule dictionaries are supported in NCC: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.258Charging User Guide Charging rules •The Charging common rule attribute dictionary lists all of the attributes that NCC can manage.
It defines the attributes that are available for creating a charging rule, the context in which they are used, and the direction of the attribute.
•Charging custom rule attribute dictionary is configurable.
Use the ChargingCustomRuleAttributeDictionary.xml file to add attributes or customize attributes.
Its structure is the same as the Charging common rule attribute dictionary.
4.
1.2 Rule system versions An Rule system version (RSV) contains the entire collection of rules, logic, and/or rule variable definitions that drive the application specific NCC rule engines.
Each application (NCC and Diameter Rule Engine) has its own RSV.
The RSV supports rule operations such as rule or variable authoring, cloning, exporting, and importing.
This is essential for modifying rule logic.
An RSV is created in the Service Manager and then then it is distributed to the Managed Elements (MEs), which are the NCC sites.
Each application in the same NCC can have different RSVs but all of the RSVs must be of the same release.
An RSV captures a series of triggers and associated rule groups that implement a customized NCC message modification and additional behavior each time a Diameter or HTTP message is received.
When a RSV is active and running, all rule groups that belong to the RSV are evaluated and the rules can be executed by the Rules Engine as triggered in an order of precedence.
NCC supports the export and import of the entire RSV for each application, with its associated profiles, rules, and templates between NCC systems running the same release.
A Default RSV is created for each application automatically when you start NCC for the first time after installation.
The Default RSV contains all of the triggers and rule groups that are required for the startup of an application, and on initial startup of the application, appears in the GUI in the Active state.
The Default RSV is read-only.
You can use the Default RSV as the active version; however, if you need to modify or create rules, you must clone the Default RSV to create a new version for your system.
This version is created in a draft state and can be promoted to the active state when ready.
You can delete any of the Draft versions or Release versions.
An Active RSV cannot be modified or deleted.
You can extensively modify any version that is in a Draft state.
Only the Description field of a RSV in a Release state can be modified.
When you clone or create a new RSV, the new RSV is in a Draft state.
NCC RSV For NCC, rules are generally part of a specific profile and therefore not available in a RSV form; however, rule variables for NCC with their Triggers can be set in the Variables tab of the SM Charging GUI.
Multiple active RSVs can exist, but only one RSV with the state Active can exist at any time.
The default RSV does not contain definitions of rule groups.
Rule groups are defined indirectly in other NCC objects by specifying a collection of rules.
In a geo-redundant deployment at the ME level, SM is managing multiple NCC sites and simply activating an RSV in one ME does not activate that RSV in the other site.
You must provision and activate the RSV on each geo-redundantly related ME.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.259Charging User Guide Charging rules Note : The NCC RSV operates in a slightly different manner as is explained in the section “NCC RSV”.
Rule authoring Within an NCC site there is one active rule system at any given time, which contains the rules and variables that are currently in effect.
NCC allows the creation of multiple RSVs to support having rule systems for different purposes, such as in a lab where different scenarios are being explored, and to maintain previous versions of rule systems as they evolve.
NCC supports a drag and drop editing tree that can be used to associate triggers with one or more rule groups.
Triggers are a message type such as Gx CCR or Gy CCA, or AF establishment.
Rules and rule variables can be configured using the rule text editors or by importing an existing RSV.
You can re-order rule groups within a trigger or re-order rules within a rule group by dragging the rules up or down.
The following options are available to manage an RSV: CAUTION : When a rule is created, modified, removed, or loaded, it takes a minimum of 30 seconds to load the RSV.
For any action that updates the rules (for example, a TPG value is updated from 10 to 20, an action is updated, or a Tariff Rule action is modified), the changes take effect after ~30 seconds.
Operators must wait for this time interval (30 seconds), to consider the change for feature implementation/execution.
•Import To Import Rule Group, tap Add Rule Group, then tap the IMPORT button in the Rule Group window.
Add a name for the rule group and browse to find the file to import.
To reference an existing Rule Group in a different Trigger, select a new Trigger, tap the Add Rule Group button, then tap the REFRENCE RULE GROUP button.
Select the name of the rule group and add the new trigger.
When you open the Rules and Variables tab of the Diameter Rules tab of Diameter Configuration in the SM, you are presented a configurable RSV form.
The Charging application allows you to configure Variables only as the charging rules are configured in the Charging profiles.
When you open the Rule and Variables tab of the Diameter Rules tab of Diameter Configuration in the SM, there is a filter that allows you to search for any specific RSV by name, state, and last time stamp.
Directly under the filter, a list of all RSVs in the application are displayed if you have not used the filter, or a list of all RSVs are displayed for which you have used the filter.
Included in this form, is a button that will allow you to search for, export, and import an RSV, as well as a button that will allow you to add and configure a new RSV.
To create a new RSV, you must, 1.Provide a name for the RSV.
2.Provide an application name.
3.New RSVs are in the draft state automatically; if you need to edit an RSV, ensure the RSV is in a draft state.
After it is created you can edit the RSV to change the state to release, and distribute it to the MEs.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.260Charging User Guide Charging rules 4.Optionally, provide a description.
5.Optionally, provide a security domain.
6.Save and Continue.
When you Save and Continue on this form, you are presented with a rules text editor where you can select the triggers, rule groups, or rule variables required for the rules in the new rule system.
NCC rules text editor presents triggers and rule variables only.
The Diameter Rules text editor presents triggers and rule groups only.
The trigger must always be selected before carrying on to the rule groups or rule variables configuration forms to populate the Triggers parameter in each of those forms.
The Rules System Version List page provides a list of all the RSVs available as well as an ADD button that can be used to add a new draft version RSV.
The Rules System Version form that opens requires that you fill in the parameters as shown in the following table.
Parameter Description Options Name The name of the RSV.
Must be a unique name in the RSV and it is mandatory.
Up to 50 characters only.
State The state of the RSV.
The system sets the initial state to Draft .
Application The application of the RSV required.
The system sets this parameter to Charging or Recharge based on the current listing.
Description Enter an optional description of the RSV.
— Trigger Allows selection of a rule set.
Depending on the application, selection of the Trigger ( Rule Set) can be made from a list of triggers.
Rule Groups Allows you to add and configure rules in the rule groups.
Allows you to select and edit existing rules in the rule group.
Contains an Add New Rule button, if more rules are required.Rule Group name Specify if top level rule group Rule name Rule logic ( if /then statement) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.261Charging User Guide Charging rules Parameter Description Options Rule Variables Allows you to add rule variables or select and edit existing rule variables.Add and configure a rule variable.
Note : There are search filters above the Trigger, Rule Group, and Rule Variables configuration menus that allow you to search for the names of your required Triggers, Rule Groups, and Rule Variables as shown in the following figure.
Figure 42: Trigger, Rule Group, and Rule Variable configuration in RSV 4.
1.3 Rule variables NCC provides a flexible way to define a variable and set its value based on a flexible logic defined in rules.
The rule variable can be used to store values during a rules evaluation and is available to SPS-Charging to simplify the composition of rule logic.
Rule variables are configurable elements that are unique to a Rule System Version (RSV) under the Rules and Variables tab in Policy or the Variables tab in Charging.
They can be configured on SM using either the GUI or north bound API as part of the RSV.
Different values can be assigned to a rule variable based on different conditions.
After a rule variable is configured, it can be used in the rules of either a rule group or rule set in the same RSV, or in a service profile outside of the RSV by using the related rule variable dictionary attributes.
The variable is set based on a rule.
One rule variable can also reference another rule variable defined in the same RSV.
A Rule Variable is associated with a trigger and re-initialized every time the Trigger is invoked.
NCC knows which operations and contexts to make available in the GUI according to the trigger and application.
Only the source contexts that are applicable to the triggers selected for the rule variable can be used in the rule variable definition.
For each rule engine invocation, a new variable context instance is created to keep the status and values of all rule variables used by the evaluated rule trigger and /rule group.
When the rule engine completes the evaluation and returns, the variable context will be removed.
So each rule engine invocation has an independent view of the rule variable instances it used in the evaluation.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.262Charging User Guide Charging rules Rule variables can be imported from other files under the import tab by supplying the name of the rule variable and browsing to the appropriate file.
The Reference Rule Variable tab allows the marking of the variable as a reference for use in other sites.
That is, one rule variable can also reference other rule variables defined in the same RSV.
Basic rule variable usage A rule variable can be defined as a simple variable with only a name and value type or with a list of complicated evaluation rules that are used to set the value of the rule variable based on different conditions.
A default value can also be set for a rule variable.
Basic usage defines the variable with a name (for example, isRural) and type (for example, boolean).
Then the conditions under which it is given a value are defined.
Note : The @ character prefixed to the name of the rule variable allows the variable name to be entered without the Get Variables (Name) argument.
For example: Variables.GetVariable(Name = isRuralAPN) can be written as (@isRuralAPN) in the SM GUI.
For this basic example, a rule could be constructed that looks like: If (IMS_SERVICE_INFO.Carrier-Identification-Code = CustomDataProfile("APN Name", "Rural_APNs")) Then @isRuralAPN = yes Else @isRuralAPN = no Below is a rule variable defined to use other variables: First the definition of the Variable: name : isRuralXampLTE type : boolean Then configuration of a rule to use the variable, for example: If (@isRuralAPN) AND (@isLTEXamp) Then @isRuralXampLTE = true Else @isRuralXampLTE = false Rule variables configuration example The value of each variable is specified using rules logic (rule conditions and actions) where the only permitted value is to set the variable value.
The conditions have the full power of the rule engine; however, Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.263Charging User Guide Charging rules the value of the rule variable is assigned only if the conditions are met.
An optional initializer can also be included to modularize the rules logic and to separate out independent pieces of rules logic for easier reading and maintenance.
For example, the following rule could be written with or without rule variables to accomplish the same outcome.
Without the rule variable: If (IMS_SERVICE_INFO.Carrier-Identification-Code = "vip.apn" or IMS_SERVICE_INFO.Carrier-Identification-Code = "vip2.apn") and SPR_DEVICE.CustomData("VIP") NOT-PRESENT Then SESSION_PARAMETERS.Return-Result-Code =4010 With the rule variable, one variable called "isVIPNet" could be defined which defaults to false with the following initializer and then another variable called "isVIPDevice ", which defaults to false with the initializer that follows "isVIPNet": If (IMS_SERVICE_INFO.Carrier-Identification-Code = "vip.apn" or IMS_SERVICE_INFO.Carrier-Identification-Code = "vip2.apn") Then @isVIPNet = true The "isVIPDevice " initializer, which will be true if the device is connected to one of the ‘vip’ APNs; otherwise false: If (SPR_DEVICE.CustomData("VIP") IS-PRESENT Then @isVIPDevice = true This variable will be true if the device has the "VIP" SOC code; otherwise it will be false.
The same rule written with rule variables becomes: If (@isVIPNet = true) and (@isVIPDevice = false) Then IMS_SERVICE_INFO.Carrier-Identification-Code.Terminate More complex examples can be used as follows to expound the versatility of the rule variable.
Simple value type rule variable with simple value condition Below is a rule variable defining the use of multiple SGSN MCC/MNC and RAT-Type values to be under one variable.
name : isLTEXamp Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.264Charging User Guide Charging rules type : enum of type Boolean If (IMS_SERVICE_INFO Combined Msg/Session.3GPP-SGSN-MCC-MNC.MNC = [630, 880, 640, 610]) AND (IMS_SERVICE_INFO Combined Msg/Session.3GPP-SGSN-MCC-MNC.MCC = 302) AND (IMS_SERVICE_INFO Combined Msg/Session.RAT-Type = RATType.EUTRAN) THEN @isLTEXamp = True ELSE @isLTEXamp = false Simple value type rule variable with attribute condition value using custom data This is a rule variable defining the use of a variable in custom data.
name : isRuralAPN type : enum If (IMS_SERVICE_INFO.Called-Station-ID = CustomDataProfile ("APN Name", "Rural_APNs")) THEN @isRuralAPN = true Else @isRuralAPN = false Simple value type rule variable with attribute condition value using another rule variable Below is a rule variable defining the use of a variable in a condition that uses another rule variable.
name : isRuralXampLTE type : enum If ((Variables.Get-Variable(Name = isRuralAPN) = true) AND (Variables.
Get-Variable(Name = isLTEXamp) = true THEN @isRuralXampLTE = true ELSE @isRuralXampLTE = false Simple value type rule variable with attribute condition value using complex mapping output Below is a rule variable defining the use of a variable in a condition that uses a value from a complex mapping.
name : isRuralAPN type : enum If ((ComplexMap.Load-Row("MapName", "Key1", "key2", "key3", "V1", "V2", "V3") == true) and (Variables.Get-Variable(Name =V1) = "A") and Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.265Charging User Guide Charging rules (Variables.Get-Variable(Name =V2) = "B") and (Variables.Get-Variable(Name =V3) = "C") THEN @isRuralAPN = true ELSE @isRuralAPN = false Simple value type rule variable for a List value type Below is a rule variable defining the use of the List value type.
name : callZoneList type : List If (IMS_SERVICE_INFO-Msg-Session.Called-Station-ID = CustomDataProfile("APN Name", "Rural_APNs")) THEN callZoneList = [zone1, zone2] ELSE callZoneList = [zone3, zone4] Attribute value type rule variable using value from output of complex mapping Below is a rule variable defining the use of an attribute as output from complex mapping.
name : Variable1 type : string If ((IMS_SERVICE_INFO.Called-Station-ID = CustomDataProfile("APN Name", "Rural_APNs")) AND (ComplexMap.Load-Row("CarrierDeviceMappingTable", "Fido", "iPhone", "bandwidthSelectionRow")) = true ) THEN Variable1= QOS_MANAGEMENT.Max-Requested-Bandwidth-UL(ComplexMap.
Get-Row-Integer("bandwidthSelectionRow", 1) ELSE Variable1= QOS_MANAGEMENT.Max-Requested-Bandwidth-DL(ComplexMap.
Get-Row-Integer("bandwidthSelectionRow", 2) Adjustment operator as a rule variable Below is an example of an Adjustment operator used in configuring the value of a rule variable.
name : Variable1 type : string Variable1= "value1" Concat "abc" Mapping lookup with optional default value Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.266Charging User Guide Charging rules Below is an example of using a rule variable in a Complex Mapping lookup.
First the variable is defined: name : RGbyCallType type : String default value: "SMS_INVALID" If (Message.ServiceCallType IS-PRESENT) and (Message.CallSubType IS-PRESENT) and (ComplexMap.Load-Row("CallTypeMappingTable", "Message.ServiceCallType", "Message.CallSubTypeMap-Info", "CallTypeRow")) = true) THEN @RGbyCallType=(CallTypeRow, 1) ELSE @RGbyCallType=(CallTypeRow, 2) The map is assumed to exist.
Using the rule variable in a rule condition, could be as follows: If (@RGbyCallType = "SMS_MO") Note : Although not used in this example, the default value (CallTypeRow, 2) would have been used if the call type was not equal to SMS_MO.
Usage examples of Rule variables Rule variables can be used in rules, in a rule group that is part of an RSV or in a service profile, in a condition, or in an action that is to be assigned to another variable or attribute.
The following are examples of rules that use Rule variables.
Using a rule variable in a condition IF [RULE Rule1](Variables.Get-Variable(Name = Variable1) = abc) THEN (DSC.APN-Aggregate-Max-Bitrate-DL = 10000) Using a rule variable in an action to assign value to a Notification Variable (Notification Variables.Subscriber-User-Id = Variables.Get-Variable(Name = Variable1)) Using a rule variable in an action to clear the value of a rule variable Variables.Clear-Variable = Variable1 Attribute parameters of the rule variable Rule-variables are configured on the Rule System Versions (RSV) page of the SM GUI.
After a Draft RSV is configured and saved, the rule editor for the RSV appears containing a box for Triggers and a box for Rule Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.267Charging User Guide Charging rules Variables.
A trigger must first be selected.
Then select Add Rule Variable.
When the Rule Variable Details window appears, the Rule Variable can be named, select a Value Type, and if needed provide a default value for the rule variable.
The New Rule button can then be clicked to define the value.
The value of each variable is specified using rules logic (rule conditions and actions) where the only permitted value is to set the variable value.
The conditions have the full power of the rule engine; however, the value of the rule variable is assigned only if the conditions are met.
An optional initializer can also be included to modularize the rules logic and to separate out independent pieces of rules logic for easier reading and maintenance.
The following table describes the parameters that can be configured for a rule variable.
Parameter Description Options Rule Variable The name of the rule variable.
The name must be a string and must be unique within the RSV.
Must be 1 to 80 characters in length.
Description A short textual description of the variable.Maximum length: 255 characters.
Applicable Triggers Applicable Triggers ( rule sets) can be selected for a rule variable during the configuration for either Policy or Charging, including those in an RSV and those in profiles.
If a specific rule set is not selected, the default is all rule sets.
Rule sets of the rule group that uses the rule variable should be the same as or a subset of the rule sets in the rule variable definition.For Policy, one of the following rule sets can be chosen: •IpCanSession Establishment •IpCanSession Modification •IpCanSession Termination •AfSession Establishment •AfSession Modification •AfSession Termination •QosManagement •SPRNotification Update Ip CanSession •SPRNotification Update •Dynamic Rule Creation •SySession Update Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.268Charging User Guide Charging rules Parameter Description Options For Charging, one of the following rule sets can be chosen: •Applicablity •GyGredit Request •Tariff •Threshold Value Type The Value Type that can be assigned to the rule variable.One of the following value types can be chosen: •STRING •ENUM •LONG •TIME DURATION •IP ADDRESS •DATE TIME •TIME OF DAY •BASE •FLOAT •DOUBLE Value Type Class Appears only when the Value Type is Enum Value or Boolean.Select the Class from the drop- down menu.
For more information, see Enumeration types and event triggers on page 296.
Default Value A default value can be configured for the rule variable.
If none of the conditions in a rule variables are met, the default value is in effect.
The value must be compatible with the rule variable type.
It canA default value is optional; however, the default value of the rule variable must be compatible with the value type of the rule variable.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.269Charging User Guide Charging rules Parameter Description Options be a single value, a list of values, or an attribute.
The attribute may also be another rule variable or the output from a complex mapping.
New Rule This panel provides the evaluation for the rules using the rule variable.
The rule variable is only evaluated on the first use.
When there are multiple Evaluations present, they are executed in order and the first matched evaluation will set the value of this variable.
Name The name of the evaluation for the rule variable.
This is a mandatory field.The Name must be a string and must be unique within the RSV.
Must be 1 to 80 characters in length.
Description A short textual description of the variable.Maximum length: 255 characters.
ON or OFF toggle button The individual rule can enabled or disabled.
By default, the rule is enabled— toggled ON.
If OFF is displayed, the rule is disabled and stored but not used.
This allows the rule to be stored without activating the rule.Use the toggle button to select whether the rule is enabled, the ON button; or disabled, the OFF button.
if The conditional statement for the rule.
The conditions in the rule variable can be any of the conditions that are supported by the rule engine ( including use of another rule variable or output from a mapping) .Enter the •Source context required •Attribute to which this rule variable will apply.
•Operator ( for example, IS- PRESENT, EQUAL.
..) •Logical operator ( The condition statement of the rule can be configured with a single criterion or with multiple criteria Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.270Charging User Guide Charging rules Parameter Description Options constructed with " and" and "OR" logical operators. )
value The value must be compatible with the rule variable type.
It can be a single value, a list of values, or an attribute.
The attribute may also be another rule variable or the output from a complex mapping.The value is always an equation that has the name of the rule variable equal to any supported value type.
For example: isRural APN = true ( In the case of a boolean ENUM value type. )
or Variable1= Variables.
GetVariable( Name = V1) ( In the case of a string value type.
See the section ") When the condition Container is matched, this Value is the value of the rule variable.
Attributes for use with Rule variables The following table describes the attributes that can be used to perform an action on a rule variable that is a string value.
These actions can be used to access, clear, or set the value of a defined rule variable.
They can be used in rule group to access the value of a rule variable, or to set/clear the value of rule variable when needed.
The Get-Variable attribute can also be used in rule variable definition as a condition to access the value of a rule variable.
Note : For a given rule engine invocation, All the rule variables have two state: •initialized—means a value is set to this variable, a null is also a value.
•uninitialized—means no value is set to this variable yet.
The start state of all rule variable is uninitialized for rule engine invocations.
Attribute Description Input value VARIABLES.
Get- Variable ( ) This attribute gets the named attribute and is used in conditions and actions.<variable- name> Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.271Charging User Guide Charging rules Attribute Description Input value When VARIABLES.
GetVariable ( variable- name) is used: •If the state of this rule variable is uninitialized, the first use of get attribute on this variable will trigger the initialization logic defined in the rule variable and set a value to it.
This value will be returned immediately and will also change the status from uninitialized to initialized.
•If the variable is in an initialized state, the current value is returned.
Variables.
Set — Variable ( ) This attribute sets the named attribute to a specific value.
Use of this attribute always causes the state to become initialized.<variable- name| value> Variables.
Clear- Variable ( ) This attribute clears the value of a rule variable with the name specified in the " variable- name" parameter and cause the attribute to become uninitialized.<variable- name> Variables.
Clear- All-Variables ( ) This attribute clears all the rule variables and causes them to become uninitialized.
Variables.
Evaluate- Regular Expression ( )This is an evaluate Regex attribute.
It is uses a regular_ expression to parse the target_ string, and save the matched results to the variables in the varnames list.
All the variables in vernames are initialized.<target_ String| regular_ expression| varnames> The target_ string is a text string to be parsed.
A regular_ expression contains the parse pattern expression Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.272Charging User Guide Charging rules Attribute Description Input value If the number of matched results is less than the number of variable names, then the extra variables will be initialized with a null value.
If the number of matched results is greater than the number of variable names, then the extra matched result will be discarded.The varnames contain one or multiple variable names used to store the match/ parse results.
For example: target_ string= "The info of a person: name= John, age= 25, he is an engineer" regular_ expression= ".
*name= ( [ A-Za-z]+).
*age= ([0-9]+).
*"; varnames = var1, var2 The result will be: var1= "John" var2= "25" 4.
1.4 Rule A Rule is a row in the Rule Group that is comprised of a set of Rule Conditions and a set of Rule Actions.
You decide how the AVPs received in the incoming request will influence the call flow by developing customized Rule logic.
The rule has a precedence that determines its unique order in the rule group evaluation.
Rules will be executed if and only if all of its conditions are met.
The results sent to the invoking module, if all the conditions are met, contain a list of actions (“things to do”) to be executed by the application module.
A Rule is made up of an optional set of logical conditions (criteria attributes) and a set of attribute results (action attributes) constructed as If-Then statements.
If no conditions are provided, then the results are included.
If there are one or more conditions then the results will only be included if the Rule evaluates to true.
For example, you can create a rule that says if the subscriber's category is gold, then send a notification.
If the subscribers category is not gold, the notification will not be sent.
The rule expression is as follows: if (condition(s)) then (action(s)) The following is an example of a rule written for NCC: if GY_MESSAGE.Service-Context-Id = 32274@3gpp.org then CALL_RESULT.Default- Roaming-Decision=RoamingDecision HOME A Rule can use attributes provided to the trigger to make its conditions and use those values to build the results.
Multiple conditions in the rule can be combined with either “and” or “or” logical operators.
Multiple actions are separated by the “and’ logical operator.
When evaluating the Rule, only the conditions specified in the Rule instance are considered by the rule engine (for example, any unfilled attributes from the Rule Group Definition are considered to be matched/ Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.273Charging User Guide Charging rules wild-carded).
When a Rule is invoked, all of its actions are taken together as a whole.
The first matched Rule from the table whose conditions have been met is executed.
After that Rule Group evaluation terminates, the next Rule Group belonging to a trigger is evaluated.
The attributes are provided in a Source Context.
The results of a Rule are put into a Result Context.
Value type restrictions in this release Certain restrictions on the use of binary arrays apply in this release.
You must use hexidecimal string in the rule if the AVP is OctectString, Date Time, or Address value type.
At this time NCC does not decode attributes containing binary arrays; therefore, you cannot reference the decoded value in a rule condition.
Instead, you must reference the encoded value using a specific syntax.
For the supported Long and Double value types, the value(s) must be parsible as required in the following: •https://docs.oracle.com/javase/7/docs/api/java/lang/Long.html#parseLong(java.lang.String) •https://docs.oracle.com/javase/7/docs/api/java/lang/Double.html#valueOf(java.lang.String) See the following examples for using an AVP with octet string value types and Date Time value types: Examples of OctetString usage for ValueTypes in AVPs in rule conditions Example 1 To apply an action when the 3GPP-RAT-Type equals EUTRAN.
The encoded value for EUTRAN is 0x06; therefore, you must construct a rule condition referencing the encoded value using the following syntax: •GyCCR.Service-Information.PS-Information.3GPP-RAT-Type = \06 where: the criteria are <source context> GyCCR and <attribute name> Service-Information.PS- Information.3GPP-RAT-Type the Operator is Equal Value that is of type STRING (OctetString in 3GPP standard) and a value of \06 \06 = EUTRAN Example 2 To apply an action when 3GPP-Charging-Id equals 1234.
The encoded value for 1234 is 0x000004D2; therefore, you must construct a rule condition referencing the encoded value using the following syntax: •GyCCR.Service-Information.PS-Information.PS-Furnish-Charging-Information.3GPP-Charging-Id = \00\00\04\D2 where: the criteria are <source context> GyCCR and <attribute name> Service-Information.PS- Information.PS-Furnish-Charging-Information.3GPP-Charging-Id the Operator is Equal Value that is of type STRING (OctetString in 3GPP standard) and a value of \00\00\04\D2 \00\00\04\D2 = 1234 Example of Date Time usage for ValueTypes in AVPs in rule conditions Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.274Charging User Guide Charging rules NCC decodes “Date Time” attributes by evaluating the date and time based on the number of milliseconds since 1/1/1970 rather than the number of seconds since 1\1\1900 as is encoded in the value.
To apply an action when User-Location-Info-Time equals Feb 7, 2017 5:25:28 PM.
The encoded value for Feb 7, 2017 5:25:28 PM is DC44C7D8; therefore, the user must construct a rule condition referencing the encoded value converted to milliseconds since 1\1\1970.
•GyCCR.Service-Information.PS-Information.User-Location-Info-Time = 1486506328000 where: the criteria are <source context> GyCCR and <attribute name> Service-Information.PS- Information.User-Location-Info-Time the Operator is Equal Value that is of type LONG or BIGINTEGER (Date Time in 3GPP standard) and a value of 1486506328000 The value is derived as follows: User-Location-Info-Time = Feb 7, 2017 5:25:28 PM = 3695495128 (seconds since 1\1\1900) = DC44C7D8 Seconds from 1\1\1900 to 1\1\1970 = 2208988800 Seconds from 1\1\1970 to Feb 7, 2017 5:25:28 PM = 3695495128 – 2208988800 = 1486506328 Milliseconds from 1\1\1970 to Feb 7, 2017 5:25:28 PM = 1486506328000 4.
1.5 Construction of conditions and actions using attributes The rule engines provide profile oriented provisioning and rule editor provisioning that allows you to enter basic details for the instance that you are configuring a rule for according to the application plugin that is active.
For example, if you are configuring a rule for the active Diameter Routing plugin, your choice of source context and result context narrows to Diameter Request and Diameter Answer.
For profile oriented provisioning, when the basic details of the profile are correct, you can configure the Triggers, Rule Groups and the Rule in the accompanying rule editor window.
Triggers cause the rule engine to act.
Each profile contains a rule editor window where you can author the Conditions and Actions for the application.
The rule editor window in a profile or rule variable usually includes the “if” statement on one line and the “then” statement on the next line; you only need to add the criteria and actions.
For rule editor provisioning, the Triggers, Rule Groups and the Rules are configured using the rule editor available on the Rule System Version.
The rule editor window that is part of each selection box usually requires you to type in the full rule syntax (if/then) statement as shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.275Charging User Guide Charging rules Figure 43: Rule Editor window NCC provides a set of supported attributes in the system’s application-specific rule dictionaries, along with the ability to add other attributes that may have been created by customers or other vendors in custom dictionaries, which feed the auto-complete functionality when composing the rules.
The editor highlights the syntax of rule entry, and flags most errors as editing proceeds, highlighting where the error is located in the buffer, and displaying a message that describes what is wrong (appearing on hover over the error icon).
An auto-complete appears as you enter text, which internally consults a dictionary of possible entries based on context.
If you suspect that you have made an error in entering the rule text, move the cursor over the error icon to check the reason.
All attributes are defined in rule attribute dictionaries using XML.
Rules are constructed in a simple format whereby the conditions result in an action, which can be combined for multi-tiered policy and charging behavior.
The multi-tiered behavior is governed by the action precedence that NCC uses.
There are two types of attributes, Criteria and Action.
A Criteria Attribute is used in conditions.
An Action Attribute is used in results.
Condition criteria definitions include a source context and attribute.
Action attribute definitions include a result context and action attribute.
A condition has a right hand side (RHS) and left hand side (LHS), separated by a relational operator.
Multiple conditions can be combined with the combination operator and/or.
Multiple conditions can be grouped with parentheses.
The combination operator has to be the same for all conditions within a group in parentheses, but the groups can be combined with either operator.
E.g.
(A or B or C) and (D and E and F).
The groupings can also be nested, e.g.
(A or (B and C)).A rule action is specified as an attribute with a parameter list.
If there is only one parameter, it is depicted in the rule editor as CONTEXTNAME.Attribute-Name = arg.
If there are multiple parameters, it is depicted as CONTEXTNAME.Attribute-Name ( arg1, arg2 ).
The following figure illustrates the rule authoring process.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.276Charging User Guide Charging rules Figure 44: Rule construction To build an entire rule with conditions, you must type “if” along with the criteria attributes.
If you do not type “if” in the first line, you are building an action.
In NCC you can copy/paste rules in the rule editor windows when adding multiple rules and use the Expand All button to expand or collapse the view of the rules.
Auto-complete When composing rules following the correct rule syntax, suggestions for input appear below the cursor.
The dictionary may define a particular parameter in the rule as optional.
You can omit the parameter, but you must enter a comma as a place holder.
When entering an attribute that has optional parameters, just after typing in the CONTEXT.Attribute-Name you will see two suggestions for parameter-templates instead of one.
The second has optional parameters missing.
Suggestions pop-up automatically in some cases, but you can also press the <control> + <space> keys to generate suggestions on demand or to invoke an argument template list.
The action provides either one or a list of possible contexts, attributes, Enums, or operators, depending on where the cursor is positioned in the rule editing area.
Any list displayed is compiled according to the position of your cursor in the rule editor (you may need to add a space to be in the correct syntactical position; see the section Rule syntax on page 279).
For example, the following shows how you would choose the EPC_IDENTITY_BIT enum when creating criteria for a rule with the AF-Requested-Data attribute: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.277Charging User Guide Charging rules You enter the conditional statement by typing the word “if”.
Nokia recommends that you type “if” on the first line in the editor and then type the “Return” key to move the cursor to the next line and enter condition criteria.
On the new line, type or choose the source context and attributes from the auto- complete selections.
Wait for the system to prompt you with the correct attributes.
The SM always suggests attributes without concern for the position of the cursor.
The auto-complete will suggest what it thinks is the next entry that should be entered.
Figure 45: Example rule construction with auto-complete sequence step 1 Select the suggestion, then highlight the Bit_Name_ENUM (double click it or drag across it) as shown in the next figure: Figure 46: Example rule construction with auto-complete sequence step 2 Now type a space, or control-space, or the delete key to delete the selected text (any modification triggers it) and you get a suggestion for the argument where the cursor is situated: Figure 47: Example rule construction with auto-complete sequence step 3 Now enter an operator (would have to be = or != for enum).
It is best if you type a space between entries as needed.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.278Charging User Guide Charging rules Figure 48: Example rule construction with auto-complete sequence step 4 When finished with the conditions, type the “Return” key to move the cursor to the next line, choose “then” from the auto-complete and then type the “Return” key to move the cursor to the next line to add the result context and complete the rule with an action.
Figure 49: Example rule construction with auto-complete sequence step 5 You will notice that there is a validation indicator just above the rule editor window that is green with a check mark in it, if you have entered the rule properly with the correct syntax.
However, if you have entered an unsupported attribute or have made a mistake with spacing of the attribute, the validation indicator will change color with an error icon added to the circle instead of a check mark indicating that you have not entered the information correctly.
The list of suggested attributes is filtered based on compatibility in the context of the statement according to the trigger.
For example, specific attributes appear under specific triggers, an attribute on the right side of a condition must be compatible with the left hand side, or attributes in an argument list need to be compatible with the dictionary definition of the arguments.
If the prompts are failing to make suggestions, go back (delete what you have entered) and look again for the prompt.
Rule syntax Rule authoring is not case sensitive, but Nokia recommends that you use lower case letters in the SM GUI; the SM rule editor will correct the case as necessary.
All rules follow the same If/Then model as follows: if Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.279Charging User Guide Charging rules <source_context>.<attribute> <operator> <value> then <result_context>.<attribute> <operator> <value> The “if” statement is the condition and the “then” statement represents the action in the rule.
Action attributes represent the action that NCC sets when a condition is matched successfully.
You can add just an action by omitting the “if” statement in the rule editor.
Simply use the auto-complete functionality to add the action attributes and values required.
The syntax of a rule consists of optional conditions followed by one or more actions.
The conditions are preceded with the “if” keyword and the actions begin after the “then” keyword.
The if/then keywords are entered as seen in the interface; that is, a rule in a profile may be entered using lowercase keywords (if, then) or using uppercase keywords (IF, THEN) in a stand-alone rule depending on the application.
The SM interprets that which is input and applies the proper case automatically.
In some instances, the keywords are automatically configured in the interface and in some cases, you must enter the keywords.
Multiple conditions in the rule are combined with either “and” or “or” logical operators.
Multiple actions are separated by the “and’ logical operator.
Language elements other than keywords are of these types: •Context.attribute typically entered via auto-suggest.
These attributes are defined by the system for use in rules, and are maintained in a dictionary, which the GUI can access.
Attributes are segregated into contexts to make selection easier as NCC supports thousands of attributes.
There is a context defined for each type of Diameter interface, a system context, and some support contexts •String literal enclosed in quotes if contains punctuation characters •Numeric integer value •IP Address an IPV4 or IPV6 formatted address •Date/Time a literal value representing a date/time is entered as a number, in units of milliseconds from epoch in UTC time zone.
•Managed Object references to objects are represented in text form as objectType # objectName.
For example, a reference to a rule group, which is entered as RuleTable#name (where name is the name of a rule group.
Other MO type references appear as objectName # objectType.
•Variable rendered as @VariableName .
A variable definition is a rule table with the resulting action of setting a single value.
This value is then substituted in rules where the variable is referenced.
A variable reference can occur in the rule at all places where an attribute can occur.
Note : Variables are defined in the scope of an RSV.
If variableName is a literal, then the @ notation is rendered in the GUI.
If variableName is an attribute, the long form is rendered as follows: Variable definition or assignment within a rule: VARIABLES.Set-Variable(variableName, value) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.280Charging User Guide Charging rules Variable reference: VARIABLES.Get-Variable(variableName) •Lists of numbers or strings or IP addresses Use parentheses to group parameters that apply to the preceding attribute or to combine multiple conditions that are joined with the “and or “or” logical operator.
Multiple actions are separated by “and’.
The following table shows the usage of some rule syntax elements.
Element Valid for Description // Top lines Lines beginning with / / at the top of the rule text are stored in the description field of the rule.
word containing one or more “.” charactersall The portion before the first “ .” is interpreted as a ( source or destination) context identifier.
The remaining portion is interpreted as an attribute name within the context.
word with no leading or trailing “ .”all a string literal ( ) Valid: •Following an attribute, for grouping associated parameters •Following a relational operator, for grouping subsequent conditionsThis parameter: •specifies parameters to be passed to the attribute •groups conditions to which a single combination operator applies ( and/ or) [ ] Lists of literals: strings, numbers or IP addresses, on right side of conditions or actions, orThe right hand side of some conditions and actions accept a list of literals where a single value normally applies.
See List section below for details.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.281Charging User Guide Charging rules Element Valid for Description in arguments/ parameters “ quote character Delimits a string literal.
The quote character can be embedded by preceding it with a backslash ( \) character; for example: " x\"yz".
Relational Operators > Greater than < Less than >= Greater than or equal <=dates, times or numbers Less than or equal = or equal or = = any Prefix with ~ for case insensitive, prefix with !
to negate.
Attention : The operators = and != do not work for decimal attributes, for example, counter- usage- limit.
( A decimal number has a fractional part, separated by a decimal point, for example, 10.
11) not equal any Prefix with ~ for case insensitive contains The Contains operator is only applied to collection ( multivalue) type attributes to search sets of values.
It returns true when the value is equal to one of the attribute values.
For example, [ 192.
168.
1.1, 1234: :5:6] contains 192.
168.
10.1 contains netmask The Contains Netmask operator is only applied to collection ( multivalue) type attributes and returns true when any of the values are matched by the specified netmask.
For example, [ 123.
123.
123.
123, 124.
124.
124.
124] Contains Netmask 123.
123.
123.
0/24 contains pattern matchThe Contains Pattern Match operator is only applied to collection (multivalue) type attributes and returns true when at least one of the strings in the set matches the regular expression.
The Contains Pattern Match operator allows you to write a regular expression that Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.282Charging User Guide Charging rules Element Valid for Description defines a search for an entire pattern.
The pattern can match only one time.
After a source character is used in a match, it cannot be reused.
For example, the regular expression “ 123” matches the string ( 123) , or *.123.
* matches the string " 543412345" one time ( _123_ ), or as another example, the regular expression 123.
* matches ( 123_ ) on the first occurrence of 123.
The Attribute Value type is not a valid option when you use the regular expression operator Contains pattern Match.
See Appendix 28 for information about writing regular expressions.
does not contain collection ( multivalue) type attributesThe Does Not Contain operator is only applied to collection ( multivalue) type attributes and returns true if the value is not equal to any of the attribute’ s values.
For example, [ 193.
167.
1.1, 1234: :5: 6] does not contain 192.
168.
10.1 does not contain substringcollection ( multivalue) type attributesThe Does Not Contain operator is only applied to collection ( multivalue) type attributes and returns true if the value is not equal to any of the attribute’ s values.
For example, [ 193.
167.
1.1, 1234: :5: 6] does not contain 192.
168.
10.1 match_ substring string The Match Substring operator searches for an instance of a string inside another string.
For example, the substring “ cde” matches when the string “ abcdef” is searched.
Prefix with !
to negate match_ pattern string The Match Pattern operator returns true if the entire string matches the pattern in the regular expression.
The Match Pattern operator allows you to write a regular expression that defines a search pattern for strings.
The pattern can match one time or not at all for the specified string and only returns true if the entire string can be matched.
For example, “ abcd” Match Pattern “ ab.
*” will match as will it match “abcd” .
However, it does not match patterns “ ab” or “ a” The Attribute Value Type is not a valid option when you use the regular expression operator Match Pattern.
Prefix with !
to negate Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.283Charging User Guide Charging rules Element Valid for Description present message- based contextsThe Present operator should only be used with a message- based contexts such as Gx Message or Rx Message.
Using this operator with another type of context may return unexpected results.
The Present operator returns true when the specified attribute has a value.
For example: Gx message.
Framed- IP-Address Present Some criteria attributes are considered opaque objects for which only the Present and Not Present operators are available.
You cannot directly access the object and the size and shape of the object are not visible.
For attributes that always have a value, the Present operator is not allowed.
For example: Account.
Account- ID Present not present message- based contextsThe Not Present operator should only be used with message- based contexts such as Gx Message or Rx Message.
Using this operator with another type of context may return unexpected results.
The Not Present operator returns true when the specified attribute has no value.
For example, " Gx message.
Framed- IPv6- Prefix Not Present" Some criteria attributes are considered opaque objects for which only the Present and Not Present operators are available.
You cannot directly access the object and the size and shape of the object are not visible.
For attributes that always have a value, the Not Present operator is not allowed.
For example: " Account.
Reset- Day- Of-Month Not Present" case- insensitive equal (equal ignore case)~= The Equal Ignore Case operator compares two strings, ignoring the case of the characters, and returns true when the strings are equal.
For example, “ ABC” Equal Ignore Case “ abc” or “ ABC” Equal Ignore Case “ ABC” The comparison is not case sensitive such that when it compares two values, it considers A- Z to be the same as a- z. case- insensitive not equal ( not equal ignore case)!~= The Not Equal Ignore Case operator compares two strings, ignoring the case of the string, and returns true when the strings are not equal.
For example, “ ABC” Not Equal Ignore Case “ dfg” Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.284Charging User Guide Charging rules Element Valid for Description within netmask IP addresses The Within Netmask operator returns true when the address is matched by the netmask.
For example, 123.
123.
123.
123 Within Netmask 123.
123.
123.
0/24 Prefix with !
to negate Combination operators and between multiple conditions or actionsCombines conditions logically or used to separate actions.
or between multiple conditionsCombines conditions such that one or the other is a valid attribute for the rule.
Adjustment operators + Add For numeric type values such as Number, Decimal, Date Time, and Custom Data values, this operator allows you to use addition ( +) to adjust values.
- Subtract For numeric type values such as Number, Decimal, Date Time, and Custom Data values, this operator allows you to use subtraction ( -) to adjust values.
* Multiply For numeric type values such as Number, Decimal, Date Time, and Custom Data values, this operator allows you to use multiplication ( x) to adjust values.
%Numbers Modulus The Modulus ( %) operator allows you to adjust the criteria by the remainder of a division when one number is divided by another.
For example, if you have two positive number integers, in a condition, that when divided by the result in a quotient with a remainder, the remainder is the modulo of the division.
For example, the expression Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.285Charging User Guide Charging rules Element Valid for Description 9 modulus 2 would evaluate to 1 because 9 divided by 2 leaves a quotient of 4 and a remainder of 1, while 9 modulus 3 would evaluate to 0 because the division of 9 by 3 has a quotient of 3 with a remainder of 0.
If the divisor is 0, the operator will return null.
Operations with negative numbers are supported.
If you apply multiple modulus adjustment values, the expression evaluates to ( (( value mod ADJ- 1) mod ADJ- 2) mod ADJ- 3).
concat Strings Concatenate For string values only, the operator allows you to concatenate rule condition or action values, or rule condition and action adjustment values, that exist as strings for both Attribute and non- Attribute values.
For example, if you had a list of ordered strings, string “ ca” , and a number of other strings ( x100, x200, x300) that you want to join to the string “ ca”, you can concatenate ( ca, x100, x200, x300) to join the strings for a value of “ cax100x200x300” .
You can create an action that builds the predefined PCC rule name based on concatenating strings from available context.
This approach is useful when the predefined rule depends on subscriber information.
For example, the subscriber record can contain two attributes: [ Category = VIP/ Gold/ Silver/ Bronze, P2P= Improved/ Normal/ Limited] requiring you to write a total of 12 rules.
Using the Concatenate operator reduces the 12 rules to 1 rule.
union LIST For List values only ( custom data, IP addresses, and strings) , allows you to provide ORing functionality within a list such that a value( s) within the list can be adjusted to satisfy: A = B or C. Lists Rules support lists as follows: •Some condition attributes are defined in the dictionary to be of a list type.
For this, you use the contains operator and a single- or list-value on the right-hand side (RHS).
Note, the '=' operator is not appropriate for these attributes.
To test for multiple values, use multiple conditions combined with 'or'.
•For condition attributes not of list type, you can use either a single value or a list on the RHS.
The rules engine treats applies the operator to each and combines them with logical or.
•For action attributes of list type, you can assign either a list-literal or a single value.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.286Charging User Guide Charging rules •Variable definitions are also considered to be of list type, so can be assigned single values or a list.
•Some action-parameters and condition-arguments are defined as list types in the dictionary as well.
For these, either a single value or list literal can be used.
•For the equal (=) operator in a condition, a single-value on the LHS is required.
•For the contains operator, a list-type value on the left-hand side (LHS) is required.
•For the union operator, a list-type value on both sides is required.
Condition containers Rule conditions are criteria that can be configured in a Condition Container to represent the “If” statement in the processing logic.
The Condition Containers group your condition criteria into single entities as a list using brackets and allows for separation between criteria attributes in the condition.
Within a condition container, the conditions and condition containers are ordered.
When the container is evaluated, the conditions will be evaluated first, and if necessary, the other sub-containers are evaluated second.
If you need to set multiple conditions with an AND operation along with conditions for an OR operation that result in an action, you can use the AND and OR functionality to derive a complex logical function for any number of criteria.
For example, if you need to disable the Offline function when the ((Count-Of-Unique- QCIs-In-PCC-Rules equals 3) AND (Count-Of-PCC-Rules-For-IP-CAN-Session equals 6)) OR (Count-Of-AF- Sessions-For-IP-CAN-Session equals 100).
The rule logic to be configured in this example is as follows: IF (DSC.Count-Of-AF-Sessions-For-IP-CAN-Session equals 100) OR ((DSC.Count-Of-Unique-QCIs-In-PCC-Rules equals 3) AND (DSC.Count-Of-PCC-Rules-For-IP-CAN-Session equals 6)) Then Disable Offline The Or and AND statements are explicit.
Notice that each Condition Container used is represented by brackets.
The first container will have single brackets around the conditions and the next condition will be contained in double brackets.
You can have multiple containers in one logical expression.
Values The Value parameter defines how the value(s) are input for the comparison or collection.
Adjustments can be made on the value as well by selecting an adjustment operator and configuring the adjustment value.
The value appears in the Value column of the Conditions panel after the condition is configured.
Note : All criteria operators support Lists as a value type.
When you choose a criteria that first appears with a singular Value Type; for example, Number, Enum, String, or IP Address, you can change the Value Type to List and enter a list of values.
Enums that are compiled into a List value type must be of the same type.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.287Charging User Guide Charging rules Certain criteria attributes have been flagged as non-nullable types.
These attributes do not have default values and are not given a value until they are given a value; for example, attributes for system time and session count.
When you use a List value type with a condition, the list always forms an OR statement.
For example, if you use a multivalue type attribute such as Framed-IP-Address with an Equal operator and Value type of List, you can enter the list of framed IP addresses such as [192.168.1.1, 1234::5:6].
The following rule condition is generated to indicate that the AF Session.Framed-IP- Address can be equal to one of the IP addresses in the list: IF (AF Session.Framed-IP-Address Equal [123.123.123.123 OR 234.234.234.234 OR 345.345.345.345]) THEN Perform action When you use a List operator with a negated condition value, (for example, Not Equal), the list forms an AND statement.
For example, if you use a multivalue type attribute such as Framed- IP-Address with a Not Equal operator and a Value type of List, you can enter the list of framed IP addresses such as [192.168.1.1, 1234::5:6].
The following rule condition is generated to indicate that the AF Session.Framed-IP-Address cannot be equal to any of the IP addresses in the list: if (AF Session.Framed-IP-Address Not Equal [123.123.123.123 AND 234.234.234.234 AND 345.345.345.345]) then Perform action Lists of numbers and lists of enums are not applicable for the substring operators.
The values can be input as: •Attribute Attributes are pre-defined in the system and selectable from a Rule Attribute table that lists the attribute names, which can be filtered by Source Context and Domain.
When you choose the Attribute option, you can choose an attribute from the Rule Attributes table.
To open the Rule Attributes table, click on the Select Object button beside the parameter.
The Rule Attributes table has three columns that you can use to determine and choose the Name of the attribute from the choices available using the filters at the top of the Source Context and Domain Type columns.
The contents of the columns are dynamic based on the Criteria parameter that you chose when defining the conditions.
Value arguments may also appear in the form depending on the attribute that you choose in the Value panel.
The value arguments have predefined names and require you to configure the type and value for each.
•Decimal When you choose the Decimal option, you can enter any set of numbers that contains a decimal; for example: 1.0456.
That is, any value of a floating-point type, taking into account both precision and magnitude.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.288Charging User Guide Charging rules You can also change the Type parameter to the List option and enter a list of Decimal values.
To create a list of multiple Decimal value types, enter each value in the list using the “+” icon.
To remove items from the list, click on the “x” icon.
See http://java.sun.com/docs/books/jls/third_edition/html/typesValues.html#4.2.3 for more information about floating-point values.
•Enum When you choose the Enum option for the Value Type parameter, an enumeration type appears in the Value panel and provides you with a list of Enum values.
Enumeration types are pre-defined in the system.
The types are available depending on the specified Criteria attribute.
You can also change the Type parameter to the List option and enter a list of Enums.
Enums that are compiled into a List value type must be of the same type.
For example, you can list three RATType3Gpp Enums, each with a different value.
To create a list of multiple Enums, enter each Enum with its value in the list using the “+” icon.
When presented, you can use the Argument Template to choose a specific enum value from that made available in the auto-suggest panel.
In this case you are given an argument template related to the attribute that you provision, place your curser within the bracketed template, and press the CTRL + space bar to get the one or a list of enums that you need.
To remove items from the list, click on the “x” icon.
•IP Address When you choose the IP Address option for the Value Type parameter, you can enter a single IP address in any of the accepted IP address formats.
You can also change the Type parameter to the List option and enter a list of IP addresses for the comparison.
The Value text box that appears only accepts correctly formatted IPv4 and IPv6 addresses.
To create a list of multiple IP addresses, enter each IP address to the list using the “+” icon.
To remove items from the list, click on the “x” icon.
The list treats each IP address as an OR logical operation.
In the following example, the comma represents the OR operation: [123.123.123.123, 124.124.124.124, 125.125.125.125] You can enter IPv4 and IPv6 addresses with or without subnet masks in the following formats: –IPv4—dotted-decimal-notation ; for example: xxx.xxx.xxx.xxx/zz –IPv6—standard notation ; eight 16-bit hexadecimal words separated by colons; for example, FEDC:BA98:0332:0000:CF8A:000C:2154:7313 –IPv6—compressed notation ; uses a double colon to represent a single contiguous group of zero fields in an IPv6 address; for example, FF01::CA:0:0:2:1 –IPv6—Mixed notation ; IPv4 addresses that are encapsulated in IPv6 addresses; for example, 25:1:5:0:9:0:127.32.67.25, or with zeros such as 0:0:0:0:0:0:127.32.67.15, or compressed without the zeros using the double colons such as, “::127.32.67.15” •Number Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.289Charging User Guide Charging rules When you choose the number option for the Value Type parameter, you can enter any whole number for example: 123.
You can enter Long values of up to a maximum of 4503599627370495, or 252, in the parameter field for this parameter.
This is a GUI limitation only; the server handles all 64 bits.
You can also change the Type parameter to the List option and enter a list of Numbers.
To create a list of Number value types, enter each value in the list using the “+” icon.
To remove items from the list, click on the “x” icon.
•String When you choose the String option for the Value Type parameter, you can enter a text string of the exact value that you require for the criteria or a wildcard.
When you choose the String option for a criteria, you can enter the string that you require in either ASCII or Hexadecimal (0xFFFF) formats.
You can also use the ASCII or Hexadecimal (0xFFFF) options to convert between an ASCII and Hexadecimal (0xFFFF) value.
You can also enter null values as data in the ASCII input field to be converted to HEX.
Enter the value as ASCII with the characters <NUL> positioned where needed in the string.
The conversion from Hexadecimal (0xFFFF) to ASCII is only available to the strings that contain printable characters.
You can also change the Type parameter to the List option and enter a list of strings.
When you change to the List option, you can enter the multiple strings in either ASCII or Hexadecimal (0xFFFF) formats.
You can convert lists of ASCII or Hexadecimal (0xFFFF) values from one format to another.
The Value text box that appears accepts any type of string with any type of character.
The text box appears in the value area with “+” and “x” icons that allow you to add and remove values from the list.
To create a list of multiple strings, enter each string into the list using the “+” icon.
To remove items from the list, click on the “x” icon.
The list treats each string as an OR logical operation.
In the following example, the comma represents the OR operation: [abc, acd, afe12] •Time Of Day When you choose the Time Of Day option, you can enter the value for a 24-h clock in the format: hh:mm:ss.
•Time Duration When you choose the Time Duration option, you can enter the value as a period of time; for example, 2h 30min 20s.
•Date Time When you choose Date Time option, you can choose a date from the calendar and enter the time in the format: hh:mm:ss.
The time zone of the local client is automatically included in the configuration.
On the GUI display, the values indicate the local time zone.
•List When you choose the List option, you must also choose the type of list.
The options for type of list are as follows: –Decimal—allows you to enter a list of decimal numbers Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.290Charging User Guide Charging rules –Enum—allows you to enter a list of Enums –IP Address—allows you to enter a list of IP addresses –Number—allows you to enter a list of numbers –String—allows you to enter a list of strings Adjustment operators Numbers, enums, custom data, lists of IP addresses, lists of strings and so on can be configured to include Adjustment Operators.
The Adjustment Operator parameter appears for most criteria and action selections and can be applied to criteria values and action values.
When you use any of the adjustment operators, an Adjustment Value panel appears for entry of the adjustment values.
You can enter multiple values in some cases and single values in others, which is apparent by the type of field displayed when you choose the adjustment operator.
When you click on the Add item button in the Adjustment Value panel, the Adjustment Value form appears.
You can then enter the Adjustment Data Type and a value in the Adjustment Value form.
You cannot use a list of numbers as an adjustment value.
However, you can use a number as an adjustment value that can be applied to a list of numbers.
Adjustment values appear in the Criteria list and Action list as well as in the Summary windows.
The Adjustment Operators are: •Add— For numeric type values such as Number, Decimal, Date Time, and Custom Data values, this operator allows you to use addition (+) to adjust values.
•Subtract —For numeric type values such as Number, Decimal, Date Time, and Custom Data values, this operator allows you to use subtraction (-) to adjust values.
•Multiply —For numeric type values such as Number, Decimal, Date Time, and Custom Data values, this operator allows you to use multiplication (x) to adjust values.
•Union —For List values only (custom data, IP addresses, and strings), the operator allows you to provide OR functionality within a list so that a value within the list can be adjusted to A = B or C. •Concatenate —For string values only, the operator allows you to concatenate (Concat) rule condition or action values, or rule condition and action adjustment values, that exist as strings for both Attribute and non-Attribute values.
For example, if you had a list of ordered strings, string “ca”, and a number of other strings (x100, x200, x300) that you want to join to the string “ca”, you can concatenate (ca, x100, x200, x300) to join the strings for a value of “cax100x200x300”.
You can create an action that builds the predefined PCC rule name based on concatenating strings from available context.
This approach is useful when the predefined rule depends on subscriber information.
For example, the subscriber record can contain two attributes [Category = VIP/Gold/Silver/Bronze, P2P=Improved/ Normal/Limited] requiring you to write a total of 12 rules.
Using the Concatenate operator reduces the 12 rules to 1 rule.
•Modulus The Modulus (%) operator allows you to adjust the criteria by the remainder of a division when one number is divided by another.
For example, if you have two positive number integers, in a condition, Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.291Charging User Guide Charging rules that when divided by the result in a quotient with a remainder, the remainder is the modulo of the division.
For example, the expression 9 modulus 2 would evaluate to 1 because 9 divided by 2 leaves a quotient of 4 and a remainder of 1, while 9 modulus 3 would evaluate to 0 because the division of 9 by 3 has a quotient of 3 with a remainder of 0.
If the divisor is 0, the operator will return null.
Operations with negative numbers are supported.
If you apply multiple modulus adjustment values, the expression evaluates to (((value mod ADJ-1) mod ADJ-2) mod ADJ-3).
Attribute and operator usage for adjustments The items available for the type of value associated with the criteria, criteria argument, or action for the Adjustment Operator is displayed in the auto-suggest.
For example, if the value type is String for the criteria that you have configured, only the concatenate adjustment operator is applicable, and therefore displayed as the only option to include.
The following defines how the options are available: •When the type of value is "List", only the Union adjustment operator is applicable.
•When the type of value is "String", only the Concatenate adjustment operator is applicable.
•When the type of value is Numeric (for example, Number, Time of Day, Time Duration, Date Time, and Decimal) only the numeric adjustment operators are applicable.
•Any other types do not have adjustments; for example, "IP Address" and "Enum" do not have adjustment operators.
The following table lists the relationships between value types, operators, and adjustment values based on the criteria, action, or Attribute types that are adjusted.
For example, if you choose a criteria type other than custom and then choose an attribute value for the condition, the attribute value type can be a number added to or subtracted from a number.
Criteria or Action Type Attribute Value Type Operator Adjustment Value Add SubtractNumber Time of Day Time Duration Date Time CustomAll Number Time of Day Time Duration Date Time Custom Multiply ModulusNumber Time of Day Time DurationTable 30: Attribute and operator usage for adjustment values Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.292Charging User Guide Charging rules Criteria or Action Type Attribute Value Type Operator Adjustment Value Date Time Decimal Custom Decimal Add Subtract Multiply ModulusDecimal Custom String Concatenate String List String Attribute List String Union List String Custom List IP Address Union List IP Address Custom List Enum Union List Enum Custom Add SubtractNumber Time of Day Time Duration Date Time CustomNumber Time of Day Time Duration Date Time CustomCustom Multiply ModulusNumber Time of Day Time DurationTable 30: Attribute and operator usage for adjustment values (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.293Charging User Guide Charging rules Criteria or Action Type Attribute Value Type Operator Adjustment Value Date Time Custom DecimalTable 30: Attribute and operator usage for adjustment values (continued) The following table shows the relationships between comparison operators, adjustment operators, and types given the List value types with Custom as both the criteria type and Attribute Value Type.
Comparison Operator Adjustment Operator Type Within Netmask Not Within Netmask Contains Netmask Does Not Contain NetmaskUnion List IP Address Custom Contains Substring Does Not Contain Substring Match Substring Does Not Match SubstringUnion List String Custom List Decimal Contains Substring Does Not Contain Substring Match Substring Does Not Match SubstringConcatenate List String Custom Equal Equal Ignore Case Not Equal Not Equal Ignore Case Greater thanAdd Subtract Multiply ModulusNumber Time of Day Time Duration Date Time DecimalTable 31: Usage for custom-custom condition attribute types Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.294Charging User Guide Charging rules Comparison Operator Adjustment Operator Type Less than Greater than or equal to Less than or equal to Present Not PresentCustom List Decimal List Number Contains Does not containUnion List String List IP Address Custom List Decimal List Enum List Number Contains Does not containConcatenate List String Custom Add Subtract Multiply ModulusNumber Time of Day Time Duration Date Time Decimal Custom List Decimal List Number Union List String List IP Address CustomEqual Equal Ignore Case Not Equal Not Equal Ignore Case Concatenate List StringTable 31: Usage for custom-custom condition attribute types (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.295Charging User Guide Charging rules Comparison Operator Adjustment Operator Type CustomTable 31: Usage for custom-custom condition attribute types (continued) 4.
1.6 Rule Groups A Rule Group is a grouping of related Rules that can be run as a logical group.
A Rule Group is usually associated with one or more Triggers.
Rule groups can be used in one or more triggers to optimize rules and consistency across different operations.
Only the applicable rule criteria are allowed in a rule group based on the source context and the trigger to which the rule group belongs.
Then, only the rule actions applicable to those criteria and triggers can be configured.
In the SM rule list, you can drag the various rules in the rule group to a level that shows hierarchy to allow for priority.
Rule groups are configured and applied as parent-child sets related by rule set.
You can place the rules required in one or more top-level stand-alone rule groups or configure a parent-child set of rule groups that use the Rule-Table action in the parent rule group to execute other rule groups.
The execution of all rule groups depend on the conditions met and associated rule sets.
Whether a top-level stand-alone rule group or the top-level parent rule group of a parent-child type set of rule groups, you must select the Top Level check box to ensure that the rule group runs when required.
A top-level standalone rule group does not have actions that call other rules.
The parent-child set of rule groups and pointing the action to another rule group, you can group rules into numerous child rule groups whose actions are run when the correct conditions are met.
For this parent- child type of rule group usage, you must designate the parent rule group by selecting the Top Level check box and identify the children by ensuring that the Top Level check box is not selected.
Further more, The triggers configured for the child rule groups must include those from the parent rule group.
4.
1.7 Enumeration types and event triggers Enumeration types This section describes the enumeration types available for rule variables.
The enumeration type parameters are described in the following table.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.296Charging User Guide Charging rules Parameter Description Options Address FamilyUsed by the Tunnel- Medium Type AVP to specify the address family.The following options are supported for address family: •Not Set •AS Number •Apple Talk •BBN 1822 •Banyan Vines •DNS ( Domain Name System) •Decnet IV •Distinguished Name •E-163 •E-164 ( SMDS, Frame Relay, ATM) •E-164 ( with NSAP format address) •EIGRP Common Service Family •EIGRP IPv4 Service Family •EIGRP IPv6 Service Family •F.69 (Telex) •Fiber Channel World- Wide Node Name •Fiber Channel World- Wide Port Name •GWID •HDLC ( 8-bit multidrop) •IEEE 802 Media + Ethernet •IPX •IPV4 •IPV6 •NSAP •Reserved •X.121 ( X.25, Frame Relay)Table 32: Enumeration Type parameters Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.297Charging User Guide Charging rules Parameter Description Options •XTP native mode XTP •XTP over IPv4 •XTP over IPv6 Bearer Control ModeThe Bearer- Control- Mode AVP type is Enumerated and is sent from the PCRF to the PCEF or BBERF; indicates the PCRF- selected bearer control mode.
When Network- Request_ Supported AVP is absent from the CCR- I, the default behavior is to set Bearer- Control- Mode to " UE_only" in CCA- I.
CAUTION: When importing a rules system version saved from a previous release, do not use the Bearer- Control- Mode action UE_NW in the operator policy rule engine to override a UE_ only downlink network ( access network and SGSN. )
If this takes place, this action would most likely to be rejected.
When importing such a rule system version, change the Bearer- Control- Mode value from UE_NW to " Not Set" .
Note: If a gateway expects no Bearer- Control- Mode in CCA- I when Network- Request Supported AVP is absent from the CCR- I, an operator policy rule should be created in the IP- CAN session or gateway control session establishment rule set ( and session modification rule set, if required) , with a condition " if NRS not present" , and action " BCM= Remove- BCM" .Not Set Indicates that the value field is empty; therefore, there is no value configured.
Reserved This option is not used in this release.
User Equipment Only The UE can request any resource establishment, modification, or termination.
User Equipment and Network The UE and PCEF can request any resource establishment, modification, or termination by adding, modifying, or removing traffic flow information.
Bearer OperationThe Bearer- Operation AVP type is Enumerated, and indicates the bearer event that initiates a request for PCC rules.
The AVP is provided if the bearer event relates to an IP- CAN bearer initiated by the UE.Not Set Indicates that the value field is empty; therefore, there is no value configured.
EstablishmentTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.298Charging User Guide Charging rules Parameter Description Options A new bearer is being established.
Modification A bearer is being modified.
Termination A bearer is being terminated.
Bearer UsageThe Bearer- Usage AVP type is Enumerated, and indicates how the bearer is used.
If the AVP has not been previously provided, its absence indicates that specific information is not available.
If the Bearer- Usage AVP is provided, the value is valid until the next time a value is provided.
The AVP is used for GPRS and EPS access types.Not Set Indicates that the value field is empty; therefore, there is no value configured.
General Specific bearer usage information is not available.
IMS Signaling The bearer is used for IMS signaling only.
BitRate Check ResultDefines whether NCC is allowed to negotiate the requested QoS.
This action provides a method to change the behavior of QoS authorization when the UE requests a QoS negotiation using the QoS- Negotiation AVP in the IP- CAN establishment or modification request.
Applies to GPRS IP- CAN sessions.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Not Supported Reject authorization if the UE has requested more than the authorized bandwidth limits.
Supported Authorize requests beyond the authorized limits by lowering the authorized QoS to the maximum available.
Boolean EnumUsed with the ALLOW_ ROAMING parameter to disable roaming privileges for a subscriber.
Used with the Subscriber- IsUnknown criteria to determine whether the subscriber isFalse For the Subscriber- Is-Unknown criteria, set this parameter to false if this subscriber is known.
Set this option to disable roaming for the subscriber for the ALLOW_ ROAMING parameter.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.299Charging User Guide Charging rules Parameter Description Options a generated Unknown subscriber or a provisioned Known subscriber.True For the Subscriber- Is-Unknown criteria, if this subscriber is unknown, set this parameter to true.
Do not use this option for the ALLOW_ ROAMING parameter, as subscribers are, by default, already allowed to roam.
The purpose of the ALLOW_ ROAMING/ Boolean Enum parameter s is to disable roaming.
Charging Characteristics Selection ModeThe Charging- Characteristics Selection- Mode AVP is of type Enumerated and indicates how the applied Charging Characteristics was selected.The following values are available: •<Not Set> •APN Specific •Home Default •Roaming Default •Serving Node Supplied •Subscription Specific •Visiting Default DSCRequest TypeUsed for session- specific conditions and can be set to establish, update, or terminate depending on the type of message being processed.
Request- Type is available in all rule sets and is useful for doing specific logic in the QoS Management and Dynamic Rule Creation rule sets.Not Set Indicates that the value field is empty; therefore, there is no value configured.
The following options are available: •AF Establish •AF Terminate •AF Update •GWC Establish •GWC Terminate •GWC Update •IP-CAN Establish •IP-CAN Terminate •IP-CAN UpdateTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.300Charging User Guide Charging rules Parameter Description Options •Subscriber Update •Sy Session Update Dayof WeekIndicates a reference to the day; for example, Monday.Not Set Indicates that the value field is empty; therefore, there is no value configured.
The following options are available: •Monday •Tuesday •Wednesday •Thursday •Friday •Saturday •Sunday Daylight Saving TimeIndicates the offset between universal time and local time in 15- min increments where the MS/ UE residesNot Set Indicates that the value field is empty; therefore, there is no value configured.
+1 hour adjustment for Daylight Saving Time One hour adjustment for Daylight Saving Time.
+2 hours adjustment for Daylight Saving Time Two hours adjustment for Daylight Saving Time.
No Adjustment for Daylight Saving Time No Adjustment for Daylight Saving Time.
Reserved ReservedTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.301Charging User Guide Charging rules Parameter Description Options Dynamic Address FlagThe Dynamic- Address- Flag AVP) is of type Enumerated, and indicates whether the PDP context/ PDN address is statically or dynamically allocated.
If this AVP is not present, the address is statically allocated.<Not Set> Indicates that the address is statically allocated.
Dynamic The PDP context/ PDN address is dynamically allocated.
Static The PDP context/ PDN address is statically allocated.
Event Trigger Note: NCC sends NO_ EVENT_ TRIGGER in a CCA (IMS_ SERVICE_ INFO) or RAR (IMS_ SERVICE_ INFO) for a session that previously had registered event trigger( s) but no longer does.
NO_ EVENT_The Event- Trigger AVP type is Enumerated.
When the Event- Trigger AVP is sent from the PCRF to the PCEF/ BBERF, it indicates an event that initiates a re- request for the PCC/ QoS rules.
When the Event- Trigger AVP is sent from the PCEF/ BBERF to the PCRF, it indicates that the corresponding event occurred at the gateway.
For a description of the event triggers available for each environment, see Event triggers on page 354.
Note : NCC also accepts unknown event triggers that are not based on the 3GPP specifications; however, NCC does not take any action when unknown event triggers are sent.Not Set Indicates that the value field is empty; therefore, there is no value configured.
ADC Revalidation Timeout This value is used in CCA and RAR commands by the PCRF to indicate that upon ADC revalidation timeout, the PCEF will inform the PCRF.
When used in a CCR command, this value indicates that the PCEF generated the request because there has been an ADC revalidation timeout.
APN AMBR Modification Failure The PCEF uses this value to indicate to the PCRF that APN- AMBR modifications have failed.
The PCEF uses this value in a new CCR command that indicates the failure of either a PUSH initiated modification or a PULL initiated modification.
This event trigger needs no subscription.
Applicable to functionality introduced with the Rel8 feature as described in clause 5.
4.1.
Access Network Info Report This value is used in CCA and RAR commands by the PCRF to indicate that upon completion of an IP- CAN bearer establishment,Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.302Charging User Guide Charging rules Parameter Description Options TRIGGER is not available as a user selectable action in Event Trigger.modification or termination procedure, or upon termination of the IP- CAN session, and if the AF requests the PCRF to report the access network information, the PCEF reports the corresponding user location ( or PLMN identifier if the user location is not available) and/ or UE Timezone to the PCRF accordingly.
When used in a CCR command, this value indicates that the PCEF generated the request because the PCEF reports the corresponding access network information to the PCRF as requested.
On an AF establish with the specific action for access network information report, the current IP- CAN location information is returned.
Note: When the PCEF supports the IMS_ SERVICE_ INFO Net Loc Feature Bit ( 10) as specified under the IMS_ SERVICE_ INFO Supported- Features of Feature- List- ID 1, NCC only forwards the user location ( or PLMN identifier if the user location is not available) and/ or the UE Timezone to the AF when the information is sent to the PCRF in IMS_ SERVICE_ INFO CCR- u that has event- trigger ACCESS_ NETWORK_ INFO_ REPORT.
When the PCEF supports the IMS_ SERVICE_ INFO Net Loc Feature Bit ( 10) the PCRF does not automatically send the current IP- CAN location information on AF establishment with the specific action for access network information report.
It does not forward the information when information is sent to PCRF in IMS_ SERVICE_ INFO RAA, and does not forward the information when event- trigger ACCESS_ NETWORK_ INFO_ REPORT is not present in IMS_ SERVICE_ INFO CCR- u Access Node Gateway ChangeTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.303Charging User Guide Charging rules Parameter Description Options IPv4, IPv6 or both addresses of the SGW.
If the SGW has an IPv4 and IPv6 address, two instances of this AVP ( one for each address type) are used to indicate the IPv4 and the IPv6 address of the SGW.
Used in CCA and RAR commands by the PCRF to indicate when the serving access node gateway changes, the PCC rules are requested.
When used in a CCR command, Access Node Gateway Change indicates that the PCEF generated the request because the serving access node gateway changed.
The new value of the serving Access Node gateway is in the AN- GW- Address AVP.
Application Change From Tethering State When used in CCA and RAR commands by the PCRF, this value indicates that when the subscriber is entering into tethering state, the PCEF informs the PCRF.
When used in a CCR command, this value indicates that the PCEF generated the request because the subscriber is entering into tethering state.
Application Start This value is used in CCA and RAR commands by the PCRF to indicate that the PCEF will inform the PCRF when the start of the application' s traffic for the application, required for detection, has been identified, unless a request to mute such a notification (Mute- Notification AVP) is part of the corresponding ADC- Rule- Definition AVP.
When used in a CCR command, this value indicates that the PCEF identified the start of the corresponding application' s traffic for an application identified by a TDF- Application- Identifier AVP.
The detected application( s)Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.304Charging User Guide Charging rules Parameter Description Options are identified by the Application Detection- Information AVP( s).
For unsolicited application reporting, the Application Start Event Trigger does not need to be subscribed by the PCRF.
For Sd originated flow creation, the corresponding TDF- Application- Identifier AVP is included under the Application- Detection- Information AVP.
When the Event trigger indicates APPLICATION_ START, the Flow- Information AVP for the detected application may be included under the Application- Detection Information AVP, if deducible.
The Flow- Information AVP, if present, shall contain the Flow- Description AVP and Flow- Direction AVP.
The TDF- Application- Instance- Identifier, which is dynamically assigned by the TDF in order to allow correlation of APPLICATION_ START and APPLICATION_ STOP Event- Triggers to the specific Flow- Information AVP.
If the service data flow descriptions are deducible, they are provided and along with the above, the corresponding Event- Trigger ( APPLICATION_ START or APPLICATION_ STOP) are provided to the PCRF.
When the TDF- Application- Instance- Identifier is provided along with the APPLICATION_ START, it shall also be provided along with the corresponding APPLICATION_ STOP.
The PCRF then may make the policy decision based on the information received and send the updated PCC rules to the PCEF, updated QoS rules to the BBERF, if applicable, and the updated ADC rules to the TDF.
Note: Application Start is always provided together with Application Stop, when used byTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.305Charging User Guide Charging rules Parameter Description Options the PCRF in CCA and RAR commands sent to the PCEF.
Application Stop This value is used in a CCA and RAR commands by the PCRF to indicate that the PCEF will notify the PCRF when the stop of the application’ s traffic for the application, required for detection, has been identified, unless a request to mute such a notification ( Mute- Notification AVP) is part of the corresponding ADC- Rule- Definition AVP.
When used in a CCR command, this value indicates that the PCEF identified the stop of the corresponding application' s traffic for an application identified by a TDF- Application- Identifier AVP.
The detected application( s) is identified by the Application Detection- Information AVP( s).
For unsolicited application reporting, the Application Stop Event Trigger does not need to be subscribed by the PCRF.
Charging Correlation Exchange The PCRF uses this value in CCA and RAR commands to indicate that the PCEF reports the access network charging identifier associated to one or more dynamic PCC Rules within the Access- Network- Charging- Identifier- IMS_ SERVICE_ INFO AVP.
The Charging- Correlation- Indicator AVP with value CHARGING_ IDENTIFIER_ REQUIRED is provided.
When used in a CCR command, this value indicates that an access network charging identifier has been assigned.
The actual value is reported with the Access- Network- Charging- Identifier- IMS_ SERVICE_ INFO AVP.
Applicable to functionality introduced with the Rel8 feature as described in clause 5.
4.1.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.306Charging User Guide Charging rules Parameter Description Options Default EPS Bearer QoS Change Indicates a change in the subscriber default EPS bearer QoS.
Not applicable to e HRPD.
Used in CCA and RAR commands by the PCRF to indicate that PCEF informs the PCRF when a change occurs in the default EPS Bearer QoS.
When used in a CCR command, Default EPS Bearer QoS Change indicates that the PCEF generated the request because the default EPS Bearer QoS changed.
The new value is provided in the Default- EPS- Bearer QoS AVP.
Not applicable to 3GPP- GPRS access type.
Default EPS Bearer QoS Modification Failure The PCEF uses this value to indicate to the PCRF that Default EPS Bearer QoS modifications have failed.
The PCEF uses this value in a new CCR command that indicates the failure of either a PUSH initiated modification or a PULL initiated modification.
This event trigger needs no subscription.
Applicable to functionality introduced with the Rel8 feature as described in clause 5.
4.1.
ECGI Change This value is used in CCA and RAR commands by the PCRF to indicate that upon a change in the ECGI, PCEF informs the PCRF.
When used in a CCR command, this value indicates that the PCEF generated the request because there has been a change in the ECGI.
The new ECGI value is provided in the 3GPP- User- Location- Info AVP.
If the ECGI has been changed but the PCEF cannot get the detail location information, the PCEF sends the 3GPP- User Location- Info AVP to the PCRF by setting the ECI of the ECGI to value 0x0000.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.307Charging User Guide Charging rules Parameter Description Options Applicable only to 3GPP- EPS access type and to functionality introduced with the Rel8 feature as described in clause 5.
4.1.
IP-CAN Change Change of IP- CAN ( for example, GPP2 to 3GPP EPS) .
Used in CCA and RAR commands by the PCRF to indicate that when the IP- CAN type changes, the PCC rules are requested.
When used in a CCR command, IP- CAN Change indicates that the PCEF generated the request because the IP- CAN type changed.
Loss of Bearer Used in CCA and RAR commands by the PCRF to indicate that when there is a loss of the bearer, and the GW informs the PCRF.
When used in a CCR command, Loss of Bearer indicates that the PCEF generated the request because the bearer associated with the PCC rules indicated by the corresponding Charging- Rule- Report AVP was lost.
The PCC- Rule- Status AVP in the Charging- Rule- Report AVP indicates that the PCC rules are temporarily inactive.
Max MBR APN AMBR Change When used in a CCR command, this value indicates that the PCEF generated the request because there has been a change of MBR/ APN- AMBR, Maximum- Bandwidth AVP is required to be provided in the same request with the new value.
This event trigger needs no subscription.
Applicable only to 3GPP- GPRS and 3GPP- EPS access types.
Out of CreditTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.308Charging User Guide Charging rules Parameter Description Options User ran out of credit for the service.
The Charging- Rule- Report indicates the affected rules, as specified in TS 29.
212 [ 1].
When used in CCA and RAR commands by the PCRF, Out of Credit indicates that the PCEF informs the PCRF about the PCC rules for which credit is no longer available, along with the applied termination action.
When used in a CCR command, Out of Credit indicates that the PCEF generated the request because the PCC rules indicated by the corresponding Charging- Rule- Report AVP have run out of credit, and that the termination action indicated by the corresponding Final- Unit- Indication AVP applies.
PCC rules that run out of credit can be reauthorized using the IP- CAN Session Modification rule set with the Session- Command type set to Reauthorize.
PGW Trace Control Indicates that the command contains a trace activation or deactivation request for the PGW.
Trace activation is indicated by the Trace- Data AVP with the relevant trace parameters.
Trace deactivation is indicated by the Trace- Reference AVP.
This event trigger does not need a subscription.
PLMN Change Indicates a change in the network operator MCC or MNC used for roaming scenarios.
The 3GPP- SGSN- MCC- MNC indicates the MCC- MNC where the user is attached, as specified in TS 29.
212 [ 1].
QoS ChangeTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.309Charging User Guide Charging rules Parameter Description Options When used in CCA and RAR commands by the PCRF, QoS Change indicates that when any QoS is changed ( even within the limits of the current authorization) at the bearer or APN level, the PCC rules are requested.
When used in a CCR command, the QoS Change indicates that the PCEF generated the request because the requested QoS for a specific bearer ( for example, the previously maximum Authorized QoS is exceeded) or the APN changed.
QoS Change Exceeding Authorization Used in CCA and RAR commands by the PCRF to indicate that when a requested QoS change is outside of the current authorized values at bearer level, the PCC rules are requested.
When used in a CCR command, QoS Change Exceeding Authorization indicates that the PCEF generated the request because a change in the requested QoS is outside of the authorized values for a specific bearer.
The Bearer- Identifier AVP is provided to indicate the affected bearer.
The QoS- Information AVP must be provided in the same request with the new value.
RAI Change When used in CCA and RAR commands by the PCRF, RAI Change indicates that when the RAI changes, the PCEF informs the PCRF.
When used in a CCR command, RAI Change indicates that the PCEF generated the request because the RAI changed.
The new RAI value is provided in the RAI AVP.
If the user location has changed but the PCEF cannot get the location information ( for example, because of a hand- over from a 3GTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.310Charging User Guide Charging rules Parameter Description Options to a 2G network) , the PCEF sends the RAI AVP to the PCRF by setting the LAC of the RAI to 0x0000.
RAT Change When used in CCA and RAR commands by the PCRF, RAT Change indicates that when a RAT changes, the PCC rules are requested.
When used in a CCR command, RAT Change indicates that the PCEF generated the request because of a RAT change.
Reallocation of Credit User topped up.
The Charging- Rule- Report indicates the affected rules, as specified in TS 29.
212 [ 1].
When used in CCA and RAR commands by the PCRF, Reallocation of Credit indicates that the PCEF informs the PCRF about the PCC rules for which credit is reallocated after an out of credit indication.
When used in a CCR command, Reallocation of Credit indicates that the PCEF generated the request because the PCC rules indicated by the corresponding Charging- Rule- Report AVP are reallocated credit after an out of credit indication.
PCC rules that have their credit reallocated can be reauthorized using the IP- CAN Session Modification rule set with the Session- Command type set to Reauthorize.
Recovery of Bearer Used in CCA and RAR commands by the PCRF to indicate that when the bearer is recovered, the GW informs the PCRF.
When used in a CCR command, Recovery of Bearer indicates that the PCEF generated the request because the bearer associated with the PCC rules ( as indicated by theTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.311Charging User Guide Charging rules Parameter Description Options corresponding Charging- Rule- Report AVP) was recovered.
Resource Modification Request Initiates the PCRF interaction for all resource modification requests that do not depend on a specific IP- CAN bearer received by the PCEF/ BBERF.
The resource modification request received by the PCEF/ BBERF may include a request for GBR changes for a traffic aggregate and/ or the association/ disassociation of a traffic aggregate with a QCI and/ or a modification of a traffic aggregate.
Revalidation Timeout Used in CCA and RAR commands by the PCRF to indicate that when a revalidation timeout occurs, the PCEF informs the PCRF.
When used in a CCR command, Revalidation of Timeout indicates that the PCEF generated the request because there is a PCC revalidation timeout.
SGSN Change When used in CCA and RAR commands by the PCRF, SGSN Change indicates that when the serving SGSN change, PCC rules are requested.
When used in a CCR command, SGSN Change indicates that the PCEF generated the request because the serving SGSN changed.
The new value of the serving SGSN is in the 3GPP- SGSN- Address AVP or 3GPP- SGSN- IPv6- Address AVP.
Applies to 3GPP- GPRS and 3GPP- EPS access types.
Note: The SGSN Change event trigger is not compliant to 3GPP specification 29.
212 over 3GPP2.
However, if the 3GPP- SGSN- Address AVP or 3GPP- SGSN- IPv6- Address AVP is provided, NCC uses IP- Can Type 3GPP2Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.312Charging User Guide Charging rules Parameter Description Options as part of the validation process and will process the request.
Service Flow Detection This value is used in CCAi, CCAu and RAR commands by the PCRF to indicate that the PCEF can inform the PCRF of service flow detection for those rules that require it.
When used in a CCR, this value indicates that the PCEF informs the PCRF that traffic matching the rule has been detected.
The affected rules are indicated within the Charging- Rule- Report AVP with the PCC- Rule- Status AVP set to the value ACTIVE ( 0).
Subnet Change This value is used in CCA and RAR commands by the PCRF to indicate that upon a change in Subnet Identifier, PCEF informs the PCRF.
When used in a CCR command, this value indicates that the PCEF generated the request because there has been a change in the Subnet Identifier.
Successful Resource Allocation When used in CCA and RAR commands by the PCRF, Successful Resource Allocation indicates that the PCEF can inform the PCRF of a successful resource allocation for the rules that requires the information.
When used in a CCR or RAA command, Successful Resource Allocation indicates that the PCEF informs the PCRF that the resources for a rule are successfully allocated.
The affected rules are indicated in the Charging- Rule- Report AVP with the PCC- Rule- Status AVP set to Active ( 0).
TAI Change This value is used in CCA and RAR commands by the PCRF to indicate that upon a change inTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.313Charging User Guide Charging rules Parameter Description Options the TAI, PCEF informs the PCRF.
When used in a CCR command, this value indicates that the PCEF generated the request because there has been a change in the TAI.
The new TAI value is provided in the 3GPP- User Location- Info AVP.
If the user tracking area location has been changed but the PCEF cannot get the detail location information, the PCEF sends the 3GPP- User- Location- Info AVP to the PCRF by setting the TAC of the TAI to value 0x0000.
Applicable only to 3GPP- EPS access type and to functionality introduced with the Rel8 feature as described in clause 5.
4.1.
TFT Change When used in CCA and RAR commands by the PCRF, TFT Change indicates that when a TFT changes at bearer level, the PCC rules are requested.
When used in a CCR command, the TFT Change indicates that the PCEF generated the request because of a change in the TFT.
UE Address Allocate When used in a CCR command, UE IP Address Allocate indicates that the PCEF generated the request because a UE IPv4 address is allocated.
The Framed- IP-Address AVP is provided in the same request.
UE IPv4 Address Allocate is reported when the corresponding event occurs, even if the event trigger is not provisioned by the PCRF.
UE Address Release When used in a CCR command, UE IPv4 Address Release indicates that the PCEF generated the request because a UE IPv4 address is released.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.314Charging User Guide Charging rules Parameter Description Options The Framed- IP-Address AVP is provided in the same request.
UE IPv4 Address Release is reported when the corresponding event occurs, even if the event trigger is not provisioned by the PCRF.
UE Time Zone Change Used in CCA and RAR commands by the PCRF to indicate that when the time zone for the UE changes, the PCC rules are requested.
When used in a CCR command, this value indicates that the PCEF generated the request because the time zone for the UE changed.
The new value of the UE time zone is in the 3GPP- MS-Time Zone AVP.
Usage Report Used in a CCA and RAR commands by the PCRF when requesting usage monitoring at the PCEF.
The PCRF also provides in the CCA or RAR command the Usage- Monitoring- Information AVPs including the Monitoring- Key AVP.
When used in a CCR command, this value indicates that the PCEF generated the request to report the accumulated usage for one or more monitoring keys.
The PCEF also provides the accumulated usage volume using the Usage- Monitoring- Information AVPs, including the Monitoring- Key AVP and the Used- Service- Unit AVP.
User CSG Hybrid Subscribed Information Change The PCRF uses this value to indicate a request of reporting the event that the user enters/ leaves a hybrid cell that the user subscribes to.
When the user enters a hybrid cell where the user is a member, the User- CSG-Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.315Charging User Guide Charging rules Parameter Description Options Information AVP is also provided with the event report in the CCR command.
Applicable to functionality introduced with the Rel9 feature as described in clause 5.
4.1.
User CSG Hybrid Un Subscribed Information Change The PCRF uses this value to indicate a request of reporting the event that the user enters/ leaves a hybrid cell that the user does not subscribe to.
When the user enters a hybrid cell where the user is not a member, the User- CSG- Information AVP is provided with the event report in the CCR command.
Applicable to functionality introduced with the Rel9 feature as described in clause 5.
4.1.
User CSG Information Change The PCRF uses this value to indicate a request of reporting the event that the user enters/ leaves a CSG cell.
When the user enters a CSG cell, the User- CSG- Information AVP is also provided with the event report in the CCR command.
Applicable to functionality introduced with the Rel9 feature as described in clause 5.
4.1.
User Location Change New location info.
For E- UTRAN, change in ECGI, TAI, or both.
Not applicable to e HPRD.
When used in CCA and RAR commands by the PCRF, User Location Change indicates that when the user location changes, the PCEF informs the PCRF.
When used in a CCR command, User Location Change indicates that the PCEF generated the request because the user location changed.
The new location value is provided in the 3GPP- User- Location Info AVP.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.316Charging User Guide Charging rules Parameter Description Options If the user location has changed but the PCEF cannot get the location information ( for example, because of a handover from a 3G to 2G network) , the PCEF sends the 3GPP- User- Location- Info AVP to the PCRF by setting the LAC of the CGI/ SAI to 0x0000.
Applicable to 3GPP- GPRS, 3GPP- EPS, and NON 3GPP_ EPS access types.
For 3GPP2 access User Location Change is used to report and request changes to the 3GPP2- BSID.
Note: The User Location Change event trigger is not compliant to 3GPP specification 29.
212 over 3GPP2.
However, if BSID is provided, NCC processes the request provided that the IP- Can Type is 3GPP2.
Final Unit ActionThe Final- Unit- Action AVP type is Enumerated and indicates to the credit- control client the action to be performed if the user account cannot cover the service cost.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Redirect The service element must redirect the user to the address specified in the Redirect- Server- Address AVP.
Restrict Access Indicates that the access device must restrict the user access according to the IP packet filters defined in the Restriction- Filter- Rule AVP or according to the IP packet filters identified by the Filter- Id AVP.
Packets that do not match the filters must be dropped.
Terminate The credit- control client must terminate the service session.
This is the default handling that applies if the credit- control client receives a Final- Unit-Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.317Charging User Guide Charging rules Parameter Description Options Action value that is not supported and must be supported by all of the Diameter credit- control client implementations that conform to this specification.
Flow DirectionThe Flow- Direction AVP type is Enumerated, and specifies the direction of the IP flows.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Bidirectional Specifies all IP flows in both directions.
Downlink Specifies downlink IP flows.
Unspecified Indicates there is no specified IP flow Uplink Specifies uplink IP flows .
Flow StatusThe Flow- Status AVP type is Enumerated, and specifies whether the IP flows are enabled.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Disabled Disables all associated IP flows in both directions.
Enabled Enables all associated IP flows in both directions.
Enabled Downlink Enables associated downlink IP flows and disables associated uplink IP flows.
Enabled Uplink Enables associated uplink IP flows and disables associated downlink IP flows.
RemovedTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.318Charging User Guide Charging rules Parameter Description Options Removes all associated IP flows and the IP filters for the associated IP flows.
The associated IP flows are not used to derive the authorized QoS.
Flow UsageThe Flow- Usage AVP is of type Enumerated, and provides information about the usage of IP Flows.AF Signaling Indicates that the IP flow is used to transport AF Signaling Protocols ( for example, SIP/ SDP) .
No Information Indicates that no information about the usage of the IP flow is being provided.
RTCP Indicates that an IP flow is used to transport RTCP.
Framed ProtocolIndicates the framing to be used for framed access.
It may be used in both Access- Request and Access- Accept packets.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Appletalk Remote Access Protocol Enables the Appletalk Remote Access Protocol for accessing Appletalk networks.
GPRS PDP Context Enables the GPRS PDP Context data structure on both GGSN and SGSN gateway nodes.
The GPRS PDP Context data structure contains the subscriber session information for use when a mobile device needs to use GPRS.
Gandalf Proprietary Singlelink Multilink Protocol Enables the Singlelink/ Multilink Protocol for Gandalf.
PPPTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.319Charging User Guide Charging rules Parameter Description Options Enables the Point- to-Point Protocol, which is a multiprotocol serial datalink.
SLIP Enables the Serial Line Internet Protocol for a serial data link that only supports IP.
X75 Synchronous Enables the X75 Synchronous Protocol for communication between synchronous terminals and networks.
Xylogics Proprietary IPX SLIP Enables the IPX Slip Protocol for Xylogics.
Framed RoutingIndicates the routing method for the user, when the user is a router to a network.
It is only used in Access- Accept packets.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Listen For Routing Packets A type of routing method.
Send And Listen A type of routing method.
Send Routing Packets A type of routing method.
Generic Value TypeNot Set Indicates that the value field is empty; therefore, there is no value configured.
The following options are available: •Attribute •Charging Information •Date Time •Decimal •EnumTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.320Charging User Guide Charging rules Parameter Description Options •IP Address •List •Managed Object •No Value •Number •String •Subscriber QoS Override •Time Duration •Time Of Day Geographic Location TypeThe Geographic Location Type AVP is used to provide the actual geographic information instead of where the timing source is located.Not Set Indicates that the value field is empty; therefore, there is no value configured.
CGI Indicates the CGI of where the user is registered.
CGI is defined in sub- clause 4.
3.1 of 3GPP TS 23.
003 [ 2].
ECGI Indicates the ECGI* .
Applicable for E- UTRAN.
RAI Indicates the RAI of the SGSN where the UE is registered.
Not applicable for e HRPD or E- UTRAN.
SAI Indicates the SAI of where the user is registered.
SAI is defined in sub- clause 9.
2.3.
9 of 3GPP TS 25.
413 [ 7].
TAI Indicates the TAI.
Applicable for E- UTRAN.
TAI and ECGI Indicates the TAI and ECGI.
Applicable for E- UTRAN.
FutureTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.321Charging User Guide Charging rules Parameter Description Options Indicates future use.
IMSIUnauthenticated FlagThe IMSI- Unauthenticated- Flag AVP is of type Enumerated, and indicates the served IMSI is not authenticated.
This may occur when emergency bearer service is provided ( refer to TS 23.
060 [ 74] and TS 29.
274 [ 91]).
If this flag is not present, this means the served IMSI is authenticated.Authenticated Indicates that the served IMSI is authenticated.
Unauthenticated Indicates the served IMSI is not authenticated.
IPCANType The IP- CAN- Type AVP type is Enumerated, and indicates the type of CAN in which the user is connected.
The IP- CAN- Type AVP is always present during the IP- CAN session establishment.
During an IP- CAN session modification, the AVP is present when the IP- CAN type changes and the PCRF requested to be informed of this event.Not Set Indicates that the value field is empty; therefore, there is no value configured.
3GPP- EPS Indicates that the IP- CAN is associated with a 3GPP EPS access.
For more information, see the RAT- Type AVP.
3GPP- GPRS Indicates that the IP- CAN is associated with a 3GPP GPRS access.
For more information, see the RAT- Type AVP.
The RAT- Type AVP includes applicable 3GPP values, except E- UTRAN.
3GPP2 Indicates that the IP- CAN is associated with a 3GPP2 access.
For more information, see the RAT- Type AVP.
DOCSIS Indicates that the IP- CAN is associated with a DOCSIS access.
Non- 3GPP- EPS Indicates that the IP- CAN is associated with an EPC based non- 3GPP access.
For more information, see the RAT- Type AVP.
WiMAXTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.322Charging User Guide Charging rules Parameter Description Options Indicates that the IP- CAN is associated with a WiMAX access ( IEEE 802.
16).
xDSL Indicates that the IP- CAN is associated with an xDSL access.
IPCANSession Modification ResultSpecifies whether NCC should remove or attempt to move the affected PCC rules when an IP- CAN session modification involves the termination of IP- CAN bearers.
Applicable for GPRS IP- CAN sessions.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Move Move affected PCC rules.
Remove Remove affected PCC rules.
Low Priority IndicatorThe Low- Priority- Indicator AVP is of type Enumerated and indicates if the PDN connection has a low priority, i. e. for Machine Type Communications.The value can be Yes or No.
Media TypeThe Media- Type AVP type is Enumerated and determines the media type of a session component.Not Set Indicates that the value field is empty; therefore, there is no value configured.
The following options are available: •Application •Audio •Control •Data •Message •Other •Text •VideoTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.323Charging User Guide Charging rules Parameter Description Options Multiple Services IndicatorDefines if the Diameter credit- control client is capable of handling multiple services independently within a ( sub- ) session.Multiple Services Not Supported Client does not support independent credit- control of multiple services within a ( sub- ) session.
Multiple Services Supported Client supports independent credit- control of multiple services within a ( sub- )session.
NASPort TypeThe NAS- Port- Type AVP type is enumerated and contains the type of the port on which the NAS authenticates the user.
The AVP is required when the NAS uses the same NAS- Port number ranges for different service types concurrently.The supported values are defined in [ RADIUSTypes] .
The following list is for information only and is subject to change by the IANA.
•ADSL- CAP - Asymmetric DSL, Carrierless Amplitude Phase Modulation •ADSL- DMT - Asymmetric DSL, Discrete Multi- Tone •Async •Cable •Ethernet •FDDI •FTTP- Fiber to the Premises •G.3 Fax •HDLC Clear Channel •IAPP •IDSL - ISDN Digital Subscriber Line •ISDN Async V. 110 •ISDN Async V. 120 •ISDN Sync •PIAFS •PPPoA - PPP over ATMTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.324Charging User Guide Charging rules Parameter Description Options •PPPo EoA- PPP over Ethernet over ATM •PPPo EoE- PPP over Ethernet over Ethernet •PPPo EoQinQ- PPP over Ethernet over IEEE 802.
1QinQ •PPPo EoVLAN- PPP over Ethernet over VLAN •SDSL - Symmetric DSL •Sync •Token- Ring •Virtual •Wireless - 1X- EV •Wireless - CDMA2000 •Wireless - IEEE 802.
11 •Wireless - IEEE 802.
16 •Wireless - IEEE 802.
20 •Wireless - IEEE 802.
22 •Wireless - Other •Wireless - UMTS •Wireless - XGP •X.25 •X.75 •xDSL - Digital Subscriber Line of unknown type •xPON - Passive Optical Network Network Request SupportThe Network- Request- Support AVP type is Enumerated; indicates the UE and network support of network- initiated procedures.
If the AVP is not previously provided, its absence indicates the Network Request NotNot Set Indicates that the value field is empty; therefore, there is no value configured.
Network Request Not SupportedTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.325Charging User Guide Charging rules Parameter Description Options Supported value.
If the Network Request Support AVP is provided, its value is valid until a value is provided.Indicates that the UE and the access network do not support the network- initiated bearer establishment request procedure.
Network Request Supported Indicates that the UE and the access network support the network- initiated bearer establishment request procedure.
Offline In offline charging, the resource usage is reported from the network to the billing domain after the resource usage occurs.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Disable Offline Indicates that the offline charging interface for the associated PCC rule is disabled.
Enable Offline Indicates that the offline charging interface for the associated PCC rule is enabled.
Online In online charging, a subscriber account in an Online Charging System, is queried before permission to use the requested network resources is granted.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Disable Online Indicates that the online charging interface for the associated PCC rule is disabled.
Enable Online Indicates that the online charging interface for the associated PCC rule is enabled.
PCCRule StatusThe PCC- Rule- Status AVP type is Enumerated, and describes the status of one or a group of PCC rules.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Active Indicates that the PCC rules are successfully installed ( for the rules provisioned fromTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.326Charging User Guide Charging rules Parameter Description Options the PCRF) or activated ( for the rules pre- provisioned in PCEF) .
Inactive Indicates hat the PCC rules are removed ( for rules provisioned from PCRF) or inactive ( for the rules pre- provisioned in the PCEF) .
Temporarily Inactive Indicates that, for some reason ( for example, loss of bearer) , already installed or activated PCC rules are temporarily disabled.
PDPContext TypeThe PDP- Context- Type AVP is of type Enumerated and indicates the type of a PDP context.
This AVP is only be present in the CCR Initial.The following values are available: •Not Set •Primary •Secondary PSAppend Free Format DataThe PS- Append- Free- Format Data AVP is of type enumerated and indicates if the information sent in the PS- Free- Format- Data AVP must be appended to the PS- free- format- data stored for the online- session.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Append If this AVP is present and indicates Append, the P- GW appends the received PS free format data to the PS free format data stored for the online charging session.
Overwrite If this AVP is absent or in value Overwrite, the P- GW overwrites all PS free format data already stored for the online charging session.
Packet Filter OperationThe Packet- Filter- Operation AVP type is Enumerated, which indicates that a UE- initiated resource operation initiates a request for PCC rules.Not Set Indicates that the value field is empty; therefore, there is no value configured.
AdditionTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.327Charging User Guide Charging rules Parameter Description Options Indicates that the UE requests resources allocated for the provided packet filters.
Deletion Indicates that the resources reserved for the provided packet filter identifiers are to be deleted and are no longer used by the UE.
Modification Indicates the reserved QoS, the filter, the precedence, or any of the fields for the provided packet filter identifiers are being modified.
Packet Filter UsageIndicates whether the UE is provisioned with the related traffic mapping information ( that is the packet filter) .
Traffic mapping information may be sent to the UE as per the relevant IP- CAN specifications even if not instructed to do so with the Packet- Filter- Usage AVP.Send To UE This value is used to indicate that the related traffic mapping information ( that is, the packet filter is sent to the UE, if applicable to the IP- CAN type as per relevant IP- CAN specifications.
Note: The maximum number of packet filters sent to UE is limited by the IP- CAN type.
Policy Command TypeThreshold session action in metering limit.
Not Set Indicates that the value field is empty; therefore, there is no value configured.
Re-Evaluate QoS Re-evaluates QoS.
Terminate Allows an action to be set at a threshold where the termination of the subscriber session will occur.
Pre Emption CapabilityThe Pre- emption- Capability AVP type is Enumerated.
The AVP defines whether a service data flow can get resources that areNot Set Indicates that the value field is empty; therefore, there is no value configured.
Pre- emption Capability DisabledTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.328Charging User Guide Charging rules Parameter Description Options already assigned to another service data flow with a lower priority level.Indicates that the service data flow is not allowed to get resources that are already assigned to another service data flow with a lower priority level.
This is the default value if the AVP is not provided.
Pre- emption Capability Enabled Indicates that the service data flow is allowed to get resources that are already assigned to another service data flow with a lower priority level.
Pre Emption VulnerabilityThe Pre- emption Vulnerability AVP is Enumerated, which defines whether a service data flow can lose the assigned resources in deference to a service data flow with higher priority level.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Pre- emption Vulnerability Disabled Indicates that the resources assigned to the service data flow cannot be pre- empted and allocated to a service data flow with a higher priority level.
Pre- emption Vulnerability Enable Indicates that the resources assigned to the service data flow can be pre- empted and allocated to a service data flow with a higher priority level.
This is the default value if this AVP is not provided.
Qo SNegotiationThe QoS- Negotiation AVP type is Enumerated.
The value of the AVP specifies a single PCC rule request if the PCRF is allowed to negotiate the QoS by supplying an Authorized QoS that differs from the requested QoS.Not Set Indicates that the value field is empty; therefore, there is no value configured.
No QoS Negotiation A QoS negotiation is not allowed for the corresponding PCC rule request.
QoS Negotiation Supported A QoS negotiation is allowed for the corresponding PCC rule request.
This is theTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.329Charging User Guide Charging rules Parameter Description Options default value applicable if the AVP is not provided.
Qo SUpgradeThe Qo SUpgrade indicates whether the SGSN that supports the GGSN upgrades the QoS in a create PDP context response or an update PDP context response.Not Set Indicates that the value field is empty; therefore, there is no value configured.
QoS Upgrade Not Supported The IP- CAN bearer does not support the upgrade of the requested QoS.
This is the default value if a QoS- Upgrade AVP is not provided for an IP- CAN bearer.
QoS Upgrade Supported The IP- CAN bearer supports the upgrade of the requested QoS.
Qo SUpgrade Check ResultDefines whether NCC allows the upgrade of the requested QoS.
This action provides a method to change the QoS authorization when the UE requests a QoS upgrade using the QoS- Upgrade AVP in the IP- CAN establishment or modification request.
Applicable for GPRS IP- CAN sessions.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Authorize at a Higher Rate Authorize at a QoS at a higher rate ( that is, upgrade the requested QoS) .
Do Not Authorize at a Higher Rate Reject authorization if the UE requests a QoS upgrade.
RATType Identifies the RAT that is serving the UE.
Not Set Indicates that the value field is empty; therefore, there is no value configured.
CDMA2000 1X The RAT is CDMA2000 1x.
For more information, see 3GPP2 X. S0011- D [20].
EHRPD The RAT is e HRPD.
For more information, refer to 3GPP2 X. S0057 [ 24].Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.330Charging User Guide Charging rules Parameter Description Options EUTRAN The RAT is E- UTRAN.
For more information, see 3GPP TS 29.
274 [ 22].
GAN The RAT is GAN.
For more information, see 3GPP TS 29.
060 [ 18].
GERAN The RAT is GERAN.
For more information, see 3GPP TS 29.
060 [ 18].
HRPD The RAT is HRPD.
For more information, see 3GPP2 X. S0011- D [20].
HSPA Evolution The RAT is HSPA Evolution.
For more information, see 3GPP TS 29.
060 [ 18].
UMB The RAT is UMB.
For more information, see 3GPP2 X. S0011- D [20].
UTRAN The RAT is UTRANF.
For more information, see 3GPP TS 29.
060 [ 18].
VIRTUAL This value is used to indicate that the RAT is unknown.
For further details refer to 3GPP TS 29.
274 [ 22].
WLAN The RAT is WLAN.
RATType3Gpp The RATType3GPP AVP type is Octet String and indicates the RAT that is serving the UE.Not Set Indicates that the value field is empty; therefore, there is no value configured.
EUTRAN The RAT is E- UTRAN.
For more information, see 3GPP TS 29.
274 [ 22].Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.331Charging User Guide Charging rules Parameter Description Options GAN The RAT is GAN.
For more information, see 3GPP TS 29.
060 [ 18].
GERAN The RAT is GERAN.
For more information, see 3GPP TS 29.
060 [ 18].
HSPA Evolution The RAT is HSPA Evolution.
For more information, see 3GPP TS 29.
060 [ 18].
Reserved The RAT is reserved.
UTRAN The RAT is UTRANF.
For more information, see 3GPP TS 29.
060 [ 18].
VIRTUAL This value is used to indicate that the RAT is unknown.
For further details refer to 3GPP TS 29.
274 [ 22].
WLAN The RAT is WLAN.
Redirect Address TypeThe Redirect- Address- Type AVP type is Enumerated and defines the address type of the address in the Redirect- Server- Address AVP.Not Set Indicates that the value field is empty; therefore, there is no value configured.
IPv4 Address type is in the IPv4 dotted- decimal address format.
IPv6 Address type is in the IPv6 address format and is a text representation of the address in the preferred or alternate text form.
SIP URI Address type is in the SIP URL format.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.332Charging User Guide Charging rules Parameter Description Options URL Address type is in the URL format.
Reporting LevelThe Reporting- Level AVP type is Enumerated, and defines the level at which the PCEF reports usage for the related PCC rule.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Rating Group Level The usage is reported on rating group level.
Service Identifier Level The usage is reported on service ID and rating group combination level.
Sponsored Connectivity Level Indicates that the usage is reported on sponsor identity and rating group combination level, and is applicable when the Sponsor- Identity AVP, Application- Service- Provider- Identity AVP and Rating- Group AVP have been provisioned within the Charging- Rule- Definition AVP.
Applicable for offline charging.
Reporting ReasonThe Reporting- Reason AVP is of type Enumerated and specifies the reason for usage reporting for one or more types of quota for a particular category.Final Indicates that the reason for usage reporting of all quota types of the Multiple- Service- Credit- Control AVP where its appears is that a service termination has happened ( for example, PDP context or IP- CAN bearer termination) .
Forced Reauthorization Determines that the reason for usage reporting of all quota types of the Multiple- Service- Credit- Control AVP where it appears is because there has been a Server initiated re-authorization procedure ( such as a receipt of a RAR command) .Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.333Charging User Guide Charging rules Parameter Description Options Other Quota Type Indicates that the reason for usage reporting of the particular quota type indicated in the Used- Service Units AVP where it appears is that, for a multi- dimensional quota, one reached a trigger condition and the other quota is being reported.
Pool Exhausted Indicates that the reason for usage reporting of the particular quota type indicated in the Used- Service Units AVP where it appears is that granted units are still available in the pool but are not sufficient for a rating group using the pool.
QHT Indicates that the reason for usage reporting of all quota types of the Multiple- Service- Credit- Control AVP where its appears is that the quota holding time specified in a previous CCA command has been hit ( for example, the quota has been unused for that period of time) .
Quota Exhausted Indicates that the reason for usage reporting of the particular quota type indicated in the Used- Service Units AVP where it appears is that the quota has been exhausted.
Rating Condition Change Indicates that the reason for usage reporting of all quota types of the Multiple- Service- Credit- Control AVP where its appears is that a change has happened in some of the rating conditions that were previously armed through the Trigger AVP ( for example, QoS) .
The specific conditions that have changed are indicated in an associated Trigger AVP.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.334Charging User Guide Charging rules Parameter Description Options Reporting Reason ( continued)Threshold Indicates that the reason for usage reporting of the particular quota type indicated in the Used- Service Units AVP where it appears is that the threshold has been reached.
Validity Time Indicates that the reason for usage reporting of all quota types of the Multiple- Service- Credit- Control AVP where its appears is that the credit authorization lifetime provided in the Validity- Time AVP has expired.
Reservation PriorityThe Reservation- Priority at the AA- Request level provides the relative priority for a session.
The Reservation- Priority at the media- component- description level provides the relative priority for an IP flow in a session.Not Set Indicates that the value field is empty; therefore, there is no value configured.
0 to 15 Rule Failure CodeRule- Failure- Code is sent by the PCEF to the PCRF in a Charging- Rule- Report AVP to identify the reason that a PCC rule is reported.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Gateway/ PCEF Malfunction Indicates that the PCC rule cannot be successfully installed ( for those provisioned from the PCRF) or activated ( for those pre- provisioned in PCEF) or enforced ( for those already successfully installed) because of a GW/ PCEF malfunction.
Incorrect Flow Information Indicates that the PCC rule could not be successfully installed or modified at the PCEF because the provided flow information is not supported by the network ( for example, the provided IP address( es) or IPv6Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.335Charging User Guide Charging rules Parameter Description Options prefix( es) do not correspond to an IP version applicable for the IP- CAN session) .
Maximum NR Bearers Reached The PCC rule cannot be successfully installed (for rules provisioned from the PCRF) or activated ( for rules pre- provisioned in the PCEF) or enforced ( for rules already successfully installed) because the maximum number of bearers is reached for the IP- CAN session.
Missing Bearer ID The PCC rule cannot be successfully installed or enforced at the PCEF because the Bearer- Id is not specified in the Charging- Rule- Install AVP by the PCRF.
Applicable only for GPRS when the PCRF performs the bearer binding.
Missing Flow Information The PCC rule cannot be successfully installed or enforced because the Flow- Description AVP is not specified in the Charging- Rule- Definition AVP by the PCRF during the first installation request for the PCC rule.
No Bearer Bound Indicates that there is no IP- CAN bearer without traffic mapping information which the PCEF can bind the PCC rule( s) including Rule- Activation- Time AVP to.
PS to CS Handover Indicates that the PCC rule could not be maintained because of PS to CS handover.
This value is only applicable for 3GPP- GPRS and 3GPP- EPS.
Applicable to functionality introduced with the Rel9 feature as described in clause 5.
4.1 Rating Group ErrorTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.336Charging User Guide Charging rules Parameter Description Options The PCC rule cannot be successfully installed or enforced because the Rating- Group specified in the Charging- Rule- Definition AVP by the PCRF is unknown or invalid.
Rule Failure Code ( continued)Resource Allocation Failure The PCC rule cannot be successfully installed because the bearer establishment or modification procedure cannot be completed successfully.
Resources Limitation The PCC rule cannot be successfully installed (for rules provisioned from the PCRF) or activated ( for rules pre- provisioned in the PCEF) or enforced ( for rules already successfully installed) because of a limitation of resources at the PCEF.
Service Identifier Error The PCC rule cannot be successfully installed or enforced because the Service- Identifier specified in the Charging- Rule- Definition AVP by the PCRF is invalid, unknown, or not applicable to the service being charged.
TDF Application Identifier Error Indicates that the rule could not be successfully installed or enforced because the TDF- Application Identifier is invalid, unknown, or not applicable to the application required for detection.
Unknown Bearer ID The PCC rule cannot be successfully installed or enforced at the PCEF because the Bearer- Id specified in the Charging- Rule- Install AVP by the PCRF is unknown or invalid.
Applicable only for GPRS when the PCRF performs the bearer binding.
Unknown Rule NameTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.337Charging User Guide Charging rules Parameter Description Options The pre- provisioned PCC rule cannot be successfully activated because the Charging- Rule- Name or Charging- Rule- Base- Name is unknown to the PCE.
Unsuccessful QoS Validation Indicates that the QoS validation has failed.
SIPForking IndicationThe SIP- Forking- Indication AVP type is Enumerated and describes whether several SIP dialogs are related to one Diameter session.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Several Dialogues The Diameter session is related to several SIP dialogs.
Single Dialogue The Diameter session is related to one SIP dialog.
This is the default value if the AVP is omitted.
Service Info StatusService- Info- Status indicates the status of the service information that the AF is providing to the PCRF.
If the Service- Info- Status AVP is not provided in the AA request, the value Final Service Information is assumed.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Final Service Information The service is fully negotiated between the two ends and the service information provided is the result of the negotiation.
Preliminary Service Information The service information that the AF has provided to the PCRF is preliminary and needs to be further negotiated between the two ends ( for example, for IMS when the service information is sent based on the SDP offer) .
Note 1: The AF may additionally provide preliminary service information not fully negotiated yet ( for example, based onTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.338Charging User Guide Charging rules Parameter Description Options the SDP offer) at an earlier stage.
The AF includes the Service- Info- Status AVP with the value set to Preliminary Service Information.
Upon receipt of Preliminary Service Information, the PCRF performs an early authorization check of the service information.
The PCRF does not provision PCC rules towards the PCEF.
However, the PCRF may authorize a PCC/ QoS rule request received from the PCEF/ BBERF as per 3GPP TS 29.
212 [ 8].
Note 2: The AF may additionally provide Preliminary Service Information not fully negotiated yet ( for example, based on the SDP offer) at an earlier stage.
The AF includes the Service- Info- Status AVP with the value set to Preliminary Service Information.
Upon receipt Preliminary Service Information, the PCRF performs an early authorization check of the service information.
The PCRF does not provision PCC rules towards the PCEF unsolicited.
However, the PCRF may authorize a PCC/ QoS rule request received from the PCEF/ BBERF as per 3GPP TS 29.
212 [ 8].
Serving Node TypeThe Serving- Node- Type is of type Enumerated and identifies the type of Serving Node.The following values are available: •Evolved Packet Data Gateway •GTP Serving Gateway •HRPD Serving Gateway •Mobile Management Entity •PMIP Serving Gateway •Serving GPRS Support Node •Trusted WLAN Access NetworkTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.339Charging User Guide Charging rules Parameter Description Options Session Command TypeAllows the required action to occur at the session level and determines whether a request should be authorized or terminated based on the type of request.Not Set Indicates that the value field is empty; therefore, there is no value configured.
The Serving- Node- Type AVP ( AVP Code 2047) is of type Enumerated and identifies the type of Serving Node.
Reauthorize To reauthorize the IP- CAN session.
Terminate To terminate or reject the session establishment/ modification request, or to terminate the existing session.
Session TypeDetermines whether to use a local session or a roaming session.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Local Session This is for a local session.
Roaming Session This is for a roaming session.
Specific ActionThe Specific- Action AVP type is Enumerated.
In a PCRFinitiated reauthorization request, the Specific- Action AVP determines the type of the action.Not Set Indicates that the value field is empty; therefore, there is no value configured.
Access Network Info Report In the RA- Request ( RAR) , this value is used by the PCRF to report access network information when the PCRF receiving an Access Network Information report corresponding to the AF session from the PCEF/ BBERF.
In the AA- Request ( AAR) , this value indicates that the AF requests PCRF to report access network information when the PCRFTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.340Charging User Guide Charging rules Parameter Description Options receiving an Access Network Information report corresponding to the AF session from the PCEF/ BBERF.
Note: When the PCEF supports the IMS_ SERVICE_ INFO Net Loc Feature Bit ( 10) as specified under the IMS_ SERVICE_ INFO Supported- Features of Feature- List- ID 1, NCC only forwards the user location ( or PLMN identifier if the user location is not available) and/ or the UE Timezone to the AF when the information is sent to the PCRF in IMS_ SERVICE_ INFO CCR- u that has event- trigger ACCESS_ NETWORK_ INFO_ REPORT.
When the PCEF supports the IMS_ SERVICE_ INFO Net Loc Feature Bit ( 10) the PCRF does not automatically send the current IP- CAN location information on AF establishment with the specific action for access network information report.
It does not forward the information when information is sent to PCRF in IMS_ SERVICE_ INFO RAA, and does not forward the information when event- trigger ACCESS_ NETWORK_ INFO_ REPORT is not present in IMS_ SERVICE_ INFO CCR- u Charging Correlation Exchange Used in the RAR command to indicate when the server reports the access network charging identifier to the AF.
The Access- Network- Charging- Identifier AVP is included in the request.
In the AAR, this value indicates that the AF requests the server to provide an access network charging identifier to the AF at each bearer establishment/ modification when a new access network charging identifier becomes available.
IP-CAN Change Used in the RAR command by the PCRF to indicate a change in the IP- CAN type.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.341Charging User Guide Charging rules Parameter Description Options In an AAR command, this value indicates that the AF is requesting subscription for IP-CAN change notification.
In RAR, the value indicates that the PCRF generated the request because of an IP- CAN change.
The IP-CAN- Type AVP is provided with the new value in the same request.
The RAT- Type AVP is also provided when applicable for the specific IP- CAN Type ( for example, 3GPP IP- CAN Type) .
Indication Bearer Loss Used in the RAR command to indicate when the server reports a loss of a bearer ( for example, for a GPRS PDP context bandwidth modification to 0 kb) to the AF.
The SDFs that are deactivated because of this loss of bearer are provided in the Flows AVP.
In the AAR, this value indicates that the AF requests the server to provide a notification at the loss of a bearer.
Indication of Bearer Recovery Used in the RAR command to indicate when the server reports a recovery of a bearer ( for example, for a GPRS PDP context bandwidth modification from 0 kb to another value) to the AF.
The SDFs that are reactivated because of the recovery of bearer are provided in the Flows AVP.
In the AAR, this value indicates that the AF requests the server to provide a notification at the recovery of a bearer.
Indication of Bearer Release Used in the RAR command to indicate when the server reports the release of a bearer ( for example, PDP context removal for GPRS) to the AF.
The SDFs that are deactivated because of this release of bearer are provided in the Flows AVP.
In the AAR,Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.342Charging User Guide Charging rules Parameter Description Options this value indicates that the AF requests the server to provide a notification at the removal of a bearer.
Indication of Establishment of Bearer Used in the RAR command to indicate when the server reports the establishment of a bearer ( for example, PDP context activation for GPRS) to the AF.
In the AAR, this value indicates that the AF requests the server to provide a notification at the establishment of a bearer.
Indication of Failed Resources Allocation Used in the RAR command by the PCRF to indicate that the resources requested for a service information cannot be successfully allocated.
The SDFs corresponding to the resources that cannot be allocated are provided in the Flows AVP.
In the AAR, this value indicates that the AF requests the PCRF to provide a notification when the resources associated with the corresponding service information cannot be allocated.
Indication of Limited PCC Deployment Used in the RAR command to indicate when the server reports the limited PCC deployment ( that is, dynamically allocated resources are not applicable) , as specified at Annex L in 3GPP TS 23.
203 [ 2] to the AF.
In the AAR, this value indicates that the AF requests the server to provide a notification for the limited PCC deployment.
Indication of Successful Resources Allocation Used in the RAR command by the PCRF to indicate that the resources requested for service information are successfully allocated.
The SDFs corresponding to the resources successfully allocated are provided in the Flows AVP.
In the AAR, this valueTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.343Charging User Guide Charging rules Parameter Description Options indicates that the AF requests the PCRF to provide a notification when the resources associated with the corresponding service information are allocated.
Out- of-Credit Used in the RAR command to indicate when the PCRF reports to the AF that SDFs have run out of credit, and that the termination action indicated by the corresponding Final- Unit- Action AVP applies ( 3GPP TS 32.
240 [23] and 3GPP TS 32.
299 [ 24).
The SDFs that are impacted because of the out of credit condition are provided in the Flows AVP.
In the AAR, this value indicates that the AF requests the PCRF to provide a notification of SDFs for which credit is no longer available.
Service Information Request Used in the RAR command to indicate when the server requests the service information from the AF for the bearer event.
In the AAR, this value indicates that the AF requests the server to demand service information at each bearer authorization.
Usage Report In the RA- Request ( RAR) , this value reports accumulated usage volume when the usage threshold provided by the AF has been reached.
In the AA- Request ( AAR) , this value indicates that the AF requests PCRF to report accumulated usage volume when it reaches the threshold.
Subscriber Qos Override DirectionSpecifies the direction for the QoS Override when the override using the Queue and Rate parameters is configured.Not Set Indicates that the value field is empty; therefore, there is no value configured.
The following values are available:Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.344Charging User Guide Charging rules Parameter Description Options •Egress •Ingress Subscriber Qos Override FormatSpecifies the format of the QoS Override.
Not Set Indicates that the value field is empty; therefore, there is no value configured.
Custom When this parameter is chosen, the Value parameter is displayed.
A raw string value may be entered to configure a custom QoS Override parameter.
Queue When this parameter is chosen, parameters may be configured for a particular queue.
The Direction, Queue ID, PIR, CIR, MBS and CBS parameters are displayed.
Rate When this parameter is chosen, an aggregate rate for all queues may be defined.
The Direction and Rate parameters are displayed.
Subscriber StateThe Subscriber- State AVP type is Enumerated, and is used to determine the type of identifier that is carried by the Subscription- Id AVP.Disabled ( excl.
emergency services) Used to indicate the subscriber is disabled in the account but emergency services are not.
Enabled Used to indicate the subscriber is enabled in the account.
Subscription IdTypeThe Subscription- Id-Type AVP type is Enumerated, and is used to determine the type of identifier that is carried by the Subscription- Id AVP.Not Set Indicates that the value field is empty; therefore, there is no value configured.
End User E. 164 International E. 164 format ( for example, MSISDN) , according to the ITU- T E.164Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.345Charging User Guide Charging rules Parameter Description Options numbering plan defined in [ E164] and [ CE164] .
End User IMSI IMSI format, according to the ITU- T E.212 numbering plan as defined in [ E212] and [ CE212] .
End User NAI NAI, as defined in [ NAI] .
End User Private Credit- control server private identifier.
End User SIP URI SIP URI, as defined in [ SIP].
Terminate Result CodeUsed to reject/ terminate an unknown subscriber.Diameter User Unknown Used when it is desired to reject/ terminate an unknown subscriber with the result code Diameter User Unknown using Session- Command Terminate.
Trigger TypeThe Trigger- Type AVP is of type Enumerated and indicates a single re- authorization event type.Change in Location Indicates that a change in the end user location causes the credit control client to request a re- authorization of the associated quota.
Change in Hybrid Subscribed User CSG Information Indicates a request to report the event that the user enters/ leaves a hybrid cell that the user subscribes to.
When used in a CCR, at entry to a hybrid cell where the user is a member, the User- CSG- Information AVP is provided with the event report.
Change in Hybrid Unsubscribed User CSG InformationTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.346Charging User Guide Charging rules Parameter Description Options Indicates a request of reporting the event that the user enters/ leaves a hybrid cell that the user does not subscribe to.
When used in a CCR, at entry to a hybrid cell where the user is not a member, the User- CSG- Information AVP is provided with the event report.
Change in Location Cell Id Indicates that a change in the Cell Identity where the end user is located causes the credit control client to request a re- authorization of the associated quota.
Change in Location Cell ECGI Indicates that a change in the ECGI where the end user is located causes the credit control client to request a re- authorization of the associated quota.
Change in Location Cell LAC Indicates that a change in the LAC where the end user is located causes the credit control client to request a re- authorization of the associated quota.
Change in Location Cell MCC Indicates that a change in the MCC of the serving network causes the credit control client to request a re- authorization of the associated quota.
Change in Location Cell MNC Indicates that a change in the MNC of the serving network causes the credit control client to request a re- authorization of the associated quota.
Change in Location Cell RAC Indicates that a change in the RAC where the end user is located causes the credit controlTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.347Charging User Guide Charging rules Parameter Description Options client to request a re- authorization of the associated quota.
Change in Location Cell TAC Indicates that a change in the TAC where the end user is located causes the credit control client to request a re- authorization of the associated quota.
Change in Maximum Bit Rate for Downlink Indicates that a change in the end user negotiated downlink maximum bit rate causes the credit control client to ask for a re-authorization of the associated quota.
Change in Maximum Bit Rate for Uplink Indicates that a change in the end user negotiated uplink maximum bit rate causes the credit control client to ask for a re- authorization of the associated quota.
Change in Mean Throughput Indicates that a change in the end user negotiated mean throughput causes the credit control client to ask for a re- authorization of the associated quota.
Change in Media Composition Indicates that a change in the media composition ( as identified within SDP) for an existing SIP session causes the credit control client to ask for a re- authorization of the associated quota.
Change in Participants NMB Used specifically for multi participating sessions to indicate that a change in the number of active participants within a session cause the credit control client to ask for a re- authorization of the associated quota.
Change in Peak ThroughputTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.348Charging User Guide Charging rules Parameter Description Options Indicates that a change in the end user negotiated peak throughput shall cause the credit control client to ask for a re- authorization of the associated quota.
Change in Precedence Class Indicate that a change in the end user negotiated precedence class causes the credit control client to request a re- authorization of the associated quota.
Change in QoS Indicates that a change in the end user negotiated QoS causes the credit control client to ask for a re- authorization of the associated quota.
Change in QoS Delay Class Indicates that a change in the end user negotiated delay class causes the credit control client to ask for a re- authorization of the associated quota.
Change in QoS Guaranteed Bit Rate for Downlink Indicates that a change in the end user negotiated downlink guaranteed bit rate shall cause the credit control client to ask for a re- authorization of the associated quota.
Change in QoS Guaranteed Bit Rate for Uplink Indicates that a change in the end user negotiated uplink guaranteed bit rate shall cause the credit control client to ask for a re- authorization of the associated quota.
Change in QoS Residual BER Indicates that a change in the end user negotiated residual BER causes the credit control client to ask for a re- authorization of the associated quota.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.349Charging User Guide Charging rules Parameter Description Options Change in QoS SDU Error Ratio Indicates that a change in the end user negotiated SDU error ratio shall cause the credit control client to ask for a re- authorization of the associated quota.
Change in QoS Traffic Class Indicates that a change in the end user negotiated traffic class causes the credit control client to ask for a re- authorization of the associated quota.
Change in QoS Traffic Handling Priority Indicates that a change in the end user negotiated traffic handling priority causes the credit control client to ask for a re- authorization of the associated quota.
Change in QoS Transfer Delay Indicates that a change in the end user negotiated transfer delay causes the credit control client to ask for a re- authorization of the associated quota.
Change in RAT Indicates that a change in the radio access technology causes the credit control client to ask for a re- authorization of the associated quota.
Change in Reliability Class Indicates that a change in the end user negotiated reliability class causes the credit control client to ask for a re- authorization of the associated quota.
Change in SGSN IP Address Indicates that a change in the SGSN IP address causes the credit control client to ask for a re- authorization of the associated quota.Table 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.350Charging User Guide Charging rules Parameter Description Options Change in Service Condition Indicates that a change in rating conditions associated with a service occurs.
The description of the conditions causing a change are service specific and may be documented in middle- tier specifications or may be configurable.
Change in Serving Node Indicates that a change in serving node causes the credit control client to request re- authorization of the associated quota.
Change in Threshold of Participants NMB Indicate that a change in the threshold of participants number within a session causes the credit control client to request re- authorization of the associated quota.
Change in UE Timezone Indicates that a change in the Time Zone where the end user is located causes the credit control client to request re- authorization of the associated quota.
Change in User CSG Information Indicates a request of reporting the event that the user enters/ leaves a CSG cell.
When used in a CCR, at entry to a CSG cell, the User- CSG- Information AVP is provided with the event report.
Change in User Participating Type Indicates that a change in the user participating type within a session causes the credit control client to ask for a re- authorization of the associated quota.
Tunnel TypeIndicates the type of tunnel to be started.
The supported values are defined in [ RFC 2868] .
•Not SetTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.351Charging User Guide Charging rules Parameter Description Options •Ascend Tunnel Management Protocol ( ATMP) •Bay Dial Virtual Services ( DVS) •Generic Route Encapsulation ( GRE) •IP Authentication Header in the Tunnel- mode ( AH) •IP Encapsulating Security Payload in the Tunnel- mode ( ESP) •IP-in-IP Encapsulation ( IP-IP) •IP-in-IP Tunneling •Layer Two Forwarding ( L2F) •Layer Two Tunneling Protocol ( L2TP) •Minimal IP- in-IP Encapsulation ( MIN- IP- IP) •Point- to-Point Tunneling Protocol ( PPTP) •Reserved •Virtual LAN ( VLAN) •Virtual Tunneling Protocol ( VTP) User Equipment InfoTypeThe User- Equipment- Info AVP type is grouped, and allows the credit- control client to indicate the identity and capability of the terminal that the subscriber is using for the connection to network.Not Set Indicates that the value field is empty; therefore, there is no value configured.
EU-164 The 64- bit identifier is used to identify the hardware instance of the product, as defined in [EUI64] .
IMEISV The identifier contains the International Mobile Equipment Identifier and Software Version in the international IMEISV format, according to 3GPP TS 23.
003 [ 3GPPIMEI] .
MACTable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.352Charging User Guide Charging rules Parameter Description Options The 48- bit MAC address is formatted, as described in [ RAD802.
1X].
MEID The MEID contains a globally unique number that identifies a physical part of CDMA mobile station equipment.
The number format is defined by the 3GPP2 report S. R0048.
Modified EU- 164 There are a number of types of terminals that have identifiers other than IMEI, IEEE 802 MACs, or EUI- 64.
The identifiers can be converted to modified EUI- 64 format, as described in [ IPv6Addr] , or by using another method that is referred to in the service- specific documentation.
User Location Identity TypeThe PCEF sends the 3GPP- User- Location- Info AVP to the PCRF by setting the LAC of the CGI/ SAI to 0x0000.
Applicable only to 3GPP- GPRS and 3GPP- EPS access types.Not Set Indicates that the value field is empty; therefore, there is no value configured.
CGI Indicates the CGI of where the user is registered.
CGI is defined in sub- clause 4.
3.1 of 3GPP TS 23.
003 [ 2].
ECGI Indicates the ECGI* .
Applicable for E- UTRAN.
RAI Indicates the RAI of the SGSN where the UE is registered.
Not applicable for e HRPD or E- UTRAN.
SAI Indicates the SAI of where the user is registered.
SAI is defined in sub- clause 9.
2.3.
9 of 3GPP TS 25.
413 [ 7].
TAITable 32: Enumeration Type parameters (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.353Charging User Guide Charging rules Parameter Description Options Indicates the TAI.
Applicable for E- UTRAN.
Future Indicates future use.Table 32: Enumeration Type parameters (continued) Event triggers This section describes the event triggers used in SPS-Charging.
The event trigger parameters are described in the this table.
Event TriggerR7 GX GPRSR8 Gx MarR8 Gx DecR8 Gx Mar GPRSR8 Gx Dec GPRSR8 Gx Mar EPSR8 Gx Dec EPSR9 Gx DecR9 Gx Dec GPRSR9 Gx Dec EPSR10 Gx DecR910 Gx Dec GPRSR10 Gx Dec EPSGx Sandvine AN GW Changex x x x x x x x Access Node Gateway Changex x x x x x x x Default EPS Bearer QoS Changex x x x x x x x Default EPS Bearer QoSx x x x x x x x x xTable 33: Applicable event triggers Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.354Charging User Guide Charging rules Event TriggerR7 GX GPRSR8 Gx MarR8 Gx DecR8 Gx Mar GPRSR8 Gx Dec GPRSR8 Gx Mar EPSR8 Gx Dec EPSR9 Gx DecR9 Gx Dec GPRSR9 Gx Dec EPSR10 Gx DecR910 Gx Dec GPRSR10 Gx Dec EPSGx Sandvine Modification Failure IP- CAN Changex x x x x x x x x x x x x Loss of Bearerx x x x x x x x x Max MBR APN AMBR Changex x x x x x x x x x x x x Out of Creditx x x x x x x x x x x x x x PGW Trace Controlx x x x x x x x x PLMN Changex x x x x x x x x x x x x x QoS Changex x x x x x x x x x x x x QoS Changex x x x x x x x xTable 33: Applicable event triggers (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.355Charging User Guide Charging rules Event TriggerR7 GX GPRSR8 Gx MarR8 Gx DecR8 Gx Mar GPRSR8 Gx Dec GPRSR8 Gx Mar EPSR8 Gx Dec EPSR9 Gx DecR9 Gx Dec GPRSR9 Gx Dec EPSR10 Gx DecR910 Gx Dec GPRSR10 Gx Dec EPSGx Sandvine Exceeding Authorization RAI Changex x x x x x x x x x RAT Changex x x x x x x x x x x x x x Reallocation of Creditx x x x x x x x x x x x x x Recovery of Bearerx x x x x x x x x Resource Modification Requestx x x x x x x x x Revalidation of Timeoutx x x x x x x x x x x x x x SGSN Changex x x x x x x x x x Service Flow Detectionx x x x x x x x x x x x xTable 33: Applicable event triggers (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.356Charging User Guide Charging rules Event TriggerR7 GX GPRSR8 Gx MarR8 Gx DecR8 Gx Mar GPRSR8 Gx Dec GPRSR8 Gx Mar EPSR8 Gx Dec EPSR9 Gx DecR9 Gx Dec GPRSR9 Gx Dec EPSR10 Gx DecR910 Gx Dec GPRSR10 Gx Dec EPSGx Sandvine Successful Resource Allocationx x x x x x x x x x x x TAI Changex x x x x x x x x x x TFT Changex x x x x UE Address Allocatex x x x x x x x x x x x UE Address Releasex x x x x x x x x x x x UE Time Zone Changex x x x x x x x x x Usage Reportx x x x x x x x x x x x x User Location Changex x x x x x x x x xTable 33: Applicable event triggers (continued) Note : NCC has predefined default event triggers in the rule set that are defined by 3GPP TS 29.212; however, the default event triggers may be overwritten by defining custom event triggers Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.357Charging User Guide Charging rules to meet custom requirements.
The Event Triggers marked with an asterisk (*) are dynamically added because they are added based on the IP-CAN type, interface type, and device type.
4.2 Triggers A trigger is an event that occurs on a system and starts an evaluation, like session establishment.
Rule groups are combined within a given trigger to increase execution speed for the rules that are relevant to the specific event.
Each session type has its own trigger allowing for customization based on specific session type attributes.
Some triggers like QoS Management run at multiple events and can use and modify attributes that are common between the events.
This reduces the duplication of rules for each event type.
The rules are organized by trigger and are used to separate the rule base.
The triggers improve processing speed and efficiency by grouping common sets of decisions to facilitate configuration.
Triggers determine when the associated rule groups are analyzed and provide filtering for the options available when you configure rules.
That is, specific rule criteria and action options appear and can be selected for each trigger type.
Triggers (ruleSet) for charging The following table describes the triggers available for charging and the source contexts available for each trigger.
These triggers are configurable for APIs but are automatically initiated for rules and rule tables configured using profiles and the SM GUI.
Trigger Invoked By Description charging module pcrf module rating module/ Charging serviceTrigger applicable to rating for evaluating applicability of a charging logic ( charging service) .
Threshold Trigger applicable to rating for evaluating applicability of a Threshold Profile Group and Threshold Profile.
Bundle Trigger applicable to rating for evaluating applicability of a Bundle.
Counter Trigger applicable to rating for evaluating applicability of a counter.
Taxation Profile Trigger applicable to rating for evaluating applicability of a Taxation Profile.APPLICABILITY servicemodel module/ Counter Trigger applied to rating for evaluating the counter rules.
BUNDLE rating module/ Bundle Trigger applied to evaluate the tariff of the call.
CALL_ RULE_ VARIABLES charging module Trigger applied for creating a particular rule variable, which is available to all Rule- Set for read and update.
This trigger has the following constraints: •One rule variable should be available to all specified triggers.Table 34: Triggers for charging Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.358Charging User Guide Charging rules Trigger Invoked By Description •The available rules variable can be updated from different rules ( such as tariff or counter rules) .
•The updated value of rule variable should be available during the next rule set evaluation.
•The changed value of rule variable has a scope in a call.
Note the following points: •The value of rule variables in CALL_ RULE_ VARIABLES trigger can only be updated in GY_ PRE_ PROCESSING, RATING_ POST_ PROCESSING, RESOURCE_ POST_ PROCESSING, GY_ POST_ PROCESSING, GY_ CREDIT_ REQUEST, SLICING_ PROFILE, THRESHOLD rulesets.
•For an IMS call, the value of rule variables in CALL_ RULE_ VARIABLES trigger cannot be updated in GY_ CREDIT_ REQUEST for CCRu and CCRt message, that is, the value of rule variables added in CALL_ RULE_ VARIABLES trigger in GY_ CREDIT_ REQUEST ruleset for an IMS call CCRu/ CCRt message are not refreshed.
COUNTER servicemodel module/ counter rating module/ counterTrigger applied to rating for evaluating the counter rules.
DEVICE_ NOT_ FOUND Command Dispatcher module Trigger applied for scenario when device is not found in NCC for Gy calls.
GY_CREDIT_ REQUEST spccontrol module Trigger applied to the call controller.
GY_MESSAGE Trigger applied to check AVPs in a call.
GY_POST_ PROCESSING spccontrol module Trigger applied for any actions to be taken at Gy Post processing.
It is for processing trigger at call control and should be evolved per use case.
GY_PRE_ PROCESSING spccontrol module Trigger applied for any actions to be taken at Gy Pre processing.
It is for processing trigger at call control and should be evolved per use case.
GY_SESSION_ ESTABLISHMENT pcrf module spccontrol moduleTrigger applied to Gy CCR session establishment request ( CC-Request- Type AVP is set to the value INITIAL_ REQUEST ) GY_SESSION_ MODIFICATION pcrf module spccontrol moduleTrigger applied to Gy CCR session update request ( CC-Request- Type AVP is set to the value UPDATE_ REQUEST ) GY_SESSION_ TERMINATION pcrf module spccontrol moduleTrigger applied to Gy CCR session terminate request ( CC-Request- Type AVP is set to the value TERMINATE_ REQUEST ) IMS_ CALL_ ESTABLISHMENT spccontrol module Trigger applied to Ro IMS session establishment request.
IMS_ CALL_ MODIFICATION spccontrol module Trigger applied to Ro IMS session update request.
IMS_ CALL_ TERMINATION spccontrol module Trigger applied to Ro IMS session terminate request.
LOAN_ PRE_ PROCESSING This trigger is evaluated during the loan request processing.Trigger applied to loan request processing.
It contains the rule sets for rejection and pre- validations.Table 34: Triggers for charging (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.359Charging User Guide Charging rules Trigger Invoked By Description LOAN_ POST_ PROCESSING This trigger is evaluated during the loan request processing.Currently, LOAN_ POST_ PROCESSING trigger is not supported.
It is reserved for future use.
MMS_ CALL_ ESTABLISHMENT spccontrol module Trigger applied to MMS session establishment request.
MMS_ CALL_ TERMINATION spccontrol module Trigger applied to MMS session termination request.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT spccontrol module Trigger applied for 5G calls.
NCHF_ CHARGING_ CALL_ MODIFICATION spccontrol module Trigger applied for 5G calls.
NCHF_ CHARGING_ CALL_ TERMINATION spccontrol module Trigger applied for 5G calls.
POLICY_ COUNTER_ STATUS_ CHANGE spccontrol module This trigger is applicable to the following types of policy counters: •Policy counters ( device, subscription, group, multi- bundle, and so on) •Virtual Policy Counters based on counters •Virtual Policy Counters based on buckets •Lifecycle policy- counters This trigger is applied for the purpose of sending Policy- Counter- Status- Change notification upon the policy counter status change, regardless of the Sy session.
Note : POLICY_ COUNTER_ STATUS_ CHANGE trigger is applicable only when the application preference Enable SNR throttling and Keep Alive is set to true .
RATING_ POST_ PROCESSING rating module Trigger applied for any action to be taken at rating post- processing RESOURCE_ POST_ PROCESSING rating module Trigger is evaluated only after COMMIT of every resource.
RESOURCE_ PRE_ SORTING rating module Trigger is evaluated for auto- manage bundle functionality SLICING_ PROFILE rating module/ quota management ( slicing profile)Trigger applied to determine the dynamic slicing parameters like validity time, quota holding time, static slice/ algorithm name, slice reduction parameters, and minimum slice.
SMS_ CALL_ ESTABLISHMENT spccontrol module Trigger applied to SMS session establishment request.
SMS_ CALL_ TERMINATION spccontrol module Trigger applied to SMS session termination request.
SNA_ MANAGEMENT spccontrol module Trigger applied to Sy SNA messages for the purpose of sending SNA notifications when the application preference Virtual Policy Counter Support is set to BUCKET_ COUNTER .
SNR_ RESUL T spccontrol module Trigger applied to Sy SNR messages for the purpose of deciding whether the SNR message is dropped.
SUBSCRIBER_ PRE_ PROVISIONING charging RSV Trigger is applied whenever a Profile, Device, Account, User, Group or Subscriptions are created, deleted or updated using REST APIs.Table 34: Triggers for charging (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.360Charging User Guide Charging rules Trigger Invoked By Description SY_SESSION_ ESTABLISHMENT spccontrol module Trigger applied to Sy SLR session establishment, such as SL-Request- Type = INITIAL_ REQUEST requests.
SY_SESSION_ MODIFICATION spccontrol module Trigger applied to Sy SLR session modification SL-Request- Type = INTERMEDIATE_ REQUEST requests.
TARIFF charging module rating moduleTrigger applied to rating for evaluating the tariff of the call.
THRESHOLD charging module pcrf module rating moduleTrigger applied to evaluate the threshold of the call.
EDR_ PROCESSING subscriber module Trigger is evaluated for EDR processing when provisioning is triggered to NCC via any provisioning API.
UC_PROCESSING spccontrol module Trigger applied to set the Response Code and filter Id when a call is rejected due to processing at UC level.
For example, called party number is in barred list configured at UC or counter usage limit reached due a threshold configured with the hard- stop.Table 34: Triggers for charging (continued) 1.The source contexts COMPLEX_MAP , CONVERSION , PROPERTIES , SYSTEM , and VARIABLES are available for all the triggers.
2.The triggers SNR_RESULT , SY_SESSION_ESTABLISHMENT , and SY_SESSION_MODIFICATION are available in the GUI, but are presently not used.
These are reserved for future use.
Note : It is not recommended to use SNA_MANAGEMENT and POLICY_COUNTER_STATUS_CHANGE triggers at the same time, as this results in increased notification traffic.
4.2.
1 Trigger evaluation order NCC evaluates rule triggers in a particular order for different calls.
The following section describes the trigger evaluation order and flow of events for different call types.
Note : 1.Trigger evaluation order depends on the use case configuration for rating, which derives the trigger for rule set at rating.
All combinations are not explained in this section.
2.In case of OVER COMMIT in TERMINATION_REQUEST, triggers for Tariff are executed after RESOURCE_POST_PROCESSING trigger.
Gy call The flow of triggers in different requests of Gy call is as mentioned in the following table: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.361Charging User Guide Charging rules Request type Trigger evaluation order Flow of events INITIAL_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.GY_SESSION_ ESTABLISHMENT 4.RESOURCE_ PRE_ SORTING 5.Tariff: Rule Table: cl1_ Charging Rules 6.Quota management profile ( slicing profile) : Rule Table: default_ profile# Default 7.RESOURCE_ POST_ PROCESSING 8.RATING_ POST_ PROCESSING 9.GY_POST_ PROCESSING1.First, the triggers for call controller are executed, that is, GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.GY_PRE_ PROCESSING is evolves as per use case.
3.GY_SESSION_ ESTABLISHMENT is applied to Gy CCR session establishment request ( CC-Request- Type AVP is set to the value INITIAL_ REQUEST) .
4.The triggers for tariff and quota management profile ( slicing profile) are executed.
5.RESOURCE_ POST_ PROCESSING trigger is executed after the COMMIT of every resource.
6.RATING_ POST_ PROCESSING is applicable for any action necessary for rating post- processing.
7.GY_POST_ PROCESSING trigger is executed at call control and is evolved as per use case.
UPDATE_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.RESOURCE_ POST_ PROCESSING 4.RESOURCE_ PRE_ SORTING 5.Tariff: Rule Table: cl1_ Charging Rules 6.quota management profile ( slicing profile) Rule Table: default_ profile# Default 7.GY_SESSION_ MODIFICATION 8.RATING_ POST_ PROCESSING 9.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST, GY_ PRE_ PROCESSING, and RESOURCE_ POST_ PROCESSING.
2.The triggers for tariff and quota management profile ( slicing profile) are executed.
3.GY_SESSION_ MODIFICATION is applied to Gy CCR session update request ( CC-Request- Type AVP is set to the value UPDATE_ REQUEST) .
4.The triggers RATING_ POST_ PROCESSING and GY_ POST_ PROCESSING are executed.
TERMINATION_ REQUEST1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.RESOURCE_ POST_ PROCESSING 4.GY_SESSION_ TERMINATION 5.RATING_ POST_ PROCESSING 6.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST, GY_ PRE_ PROCESSING, and RESOURCE_ POST_ PROCESSING.
2.GY_SESSION_ TERMINATION is applied to Gy CCR session terminate request ( CC-Request- Type AVP is set to the value TERMINATE_ REQUEST) .
3.The triggers RATING_ POST_ PROCESSING and GY_ POST_ PROCESSING are executed.
IMS Call The flow of triggers in different requests of IMS call is as mentioned in the following table: Request type Trigger evaluation order Flow of events INITIAL_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.IMS_ CALL_ ESTABLISHMENT 4.RESOURCE_ PRE_ SORTING 5.Tariff: Rule Table: CS_ Voice_ Charging Rules1.First, the triggers for call controller are executed that are GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.GY_PRE_ PROCESSING is to be evolved as per use case.
3.IMS_ CALL_ ESTABLISHMENT is applied to Ro IMS session establishment request.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.362Charging User Guide Charging rules Request type Trigger evaluation order Flow of events 6.Quota management profile ( slicing profile) Rule Table: default_ profile# Default 7.RESOURCE_ POST_ PROCESSING 8.RATING_ POST_ PROCESSING 9.GY_POST_ PROCESSING4.The triggers for tariff and quota management profile ( slicing profile) are executed.
5.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
UPDATE_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.IMS_ CALL_ MODIFICATION 4.RESOURCE_ PRE_ SORTING 5.Rule Table: CS_ Voice_ Charging Rules 6.Rule Table: default_ profile# Default 7.RESOURCE_ POST_ PROCESSING 8.RATING_ POST_ PROCESSING 9.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.IMS_ CALL_ MODIFICATION is applied to Ro IMS session update request.
3.The triggers for tariff and quota management profile ( slicing profile) are executed.
4.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
TERMINATION_ REQUEST1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.IMS_ CALL_ ESTABLISHMENT 4.IMS_ CALL_ TERMINATION 5.RESOURCE_ PRE_ SORTING 6.RESOURCE_ POST_ PROCESSING 7.RATING_ POST_ PROCESSING 8.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST, GY_ PRE_ PROCESSING, and IMS_ CALL_ ESTABLISHMENT.
2.IMS_ CALL_ TERMINATION is applied to Ro IMS session terminate request.
3.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
SMS IEC call The flow of triggers in different requests of SMS ICE call is as mentioned in the following table: Trigger evaluation order Flow of events 1.GY_PRE_ PROCESSING 2.GY_CREDIT_ REQUEST 3.SMS_ CALL_ ESTABLISHMENT 4.RESOURCE_ PRE_ SORTING 5.Rule Table: CS_ SMS_ Charging Rules 6.Rule Table: default_ profile# Default 7.RESOURCE_ POST_ PROCESSING 8.GY_POST_ PROCESSING 9.RATING_ POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.SMS_ CALL_ ESTABLISHMENT is applied to SMS session establishment request.
3.The triggers for tariff and quota management profile ( slicing profile) are executed.
4.The triggers RESOURCE_ POST_ PROCESSING, GY_ POST_ PROCESSING and RATING_ POST_ PROCESSING are executed.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.363Charging User Guide Charging rules MMS IEC Call The flow of triggers in different requests of MMS IEC call is as mentioned in the following table: Trigger evaluation order Flow of events 1.GY_PRE_ PROCESSING 2.GY_CREDIT_ REQUEST 3.MMS_ CALL_ ESTABLISHMENT 4.RESOURCE_ PRE_ SORTING 5.Rule Table: CS_ MMS_ Charging Rules 6.Rule Table: default_ profile# Default 7.RESOURCE_ POST_ PROCESSING 8.GY_POST_ PROCESSING 9.RATING_ POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.MMS_ CALL_ ESTABLISHMENT is applied to MMS session establishment request.
3.The triggers for tariff and quota management profile ( slicing profile) are executed.
4.The triggers RESOURCE_ POST_ PROCESSING, GY_ POST_ PROCESSING, and RATING_ POST_ PROCESSING are executed.
SMS ECUR Call The flow of triggers in different requests of SMS ECUR call is as mentioned in the following table: Request type Trigger evaluation order Flow of events INITIAL_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.SMS_ CALL_ ESTABLISHMENT 4.Rule Table: CS_ SMS_ Charging Rules 5.Rule Table: default_ profile# Default 6.RESOURCE_ POST_ PROCESSING 7.RATING_ POST_ PROCESSING 8.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST, and GY_ PRE_ PROCESSING.
2.SMS_ CALL_ ESTABLISHMENT is applied to SMS session establishment request.
3.The triggers for tariff and quota management profile ( slicing profile) are executed.
4.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
TERMINATION_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.SMS_ CALL_ TERMINATION 4.RESOURCE_ POST_ PROCESSING 5.RATING_ POST_ PROCESSING 6.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.SMS_ CALL_ TERMINATION is applied to SMS session termination request.
3.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
MMS ECUR call The flow of triggers in different requests of MMS ECUR call is as mentioned in the following table: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.364Charging User Guide Charging rules Request type Trigger evaluation order Flow of events INITIAL_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.MMS_ CALL_ ESTABLISHMENT 4.Rule Table: CS_ MMS_ Charging Rules 5.Rule Table: default_ profile# Default 6.RESOURCE_ POST_ PROCESSING 7.RATING_ POST_ PROCESSING 8.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.MMS_ CALL_ ESTABLISHMENT is applied to MMS session establishment request.
3.The triggers for tariff and quota management profile ( slicing profile) are executed.
4.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
TERMINATION_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.MMS_ CALL_ TERMINATION 4.RESOURCE_ POST_ PROCESSING 5.RATING_ POST_ PROCESSING 6.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.MMS_ CALL_ TERMINATION is applied to SMS session termination request.
3.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
5G call The flow of triggers in different requests of 5G call is as mentioned in the following table: Request type Trigger evaluation order Flow of events INITIAL_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.NCHF_ CHARGING_ CALL_ ESTABLISHMENT 4.RESOURCE_ PRE_ SORTING 5.Rule Table: CS400_ Tariff1400 6.Rule Table: default_ profile# Default 7.RESOURCE_ POST_ PROCESSING 8.RATING_ POST_ PROCESSING 9.GY_POST_ PROCESSING1.First, the triggers for call controller are executed that are GY_ CREDIT_ REQUEST and GY_PRE_ PROCESSING 2.NCHF_ CHARGING_ CALL_ ESTABLISHMENT is applied to 5g session establishment request.
3.The triggers for tariff and quota management profile ( slicing profile) are executed.
4.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
UPDATE_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.NCHF_ CHARGING_ CALL_ MODIFICATION 4.RESOURCE_ PRE_ SORTING 5.Rule Table: CS400_ Tariff1400 6.Rule Table: default_ profile# Default 7.RESOURCE_ POST_ PROCESSING 8.RATING_ POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST and GY_ PRE_ PROCESSING.
2.NCHF_ CHARGING_ CALL_ MODIFICATION is applied to 5g session update request.
3.The triggers for tariff and quota management profile ( slicing profile) are executed.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.365Charging User Guide Charging rules Request type Trigger evaluation order Flow of events 9.GY_POST_ PROCESSING 4.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
TERMINATION_ REQUEST 1.GY_CREDIT_ REQUEST 2.GY_PRE_ PROCESSING 3.NCHF_ CHARGING_ CALL_ TERMINATION 4.RESOURCE_ PRE_ SORTING 5.RESOURCE_ POST_ PROCESSING 6.RATING_ POST_ PROCESSING 7.GY_POST_ PROCESSING1.Trigger processing starts with GY_ CREDIT_ REQUEST, GY_ PRE_ PROCESSING, and NCHF_ CHARGING_ CALL_ TERMINATION.
2.NCHF_ CHARGING_ CALL_ TERMINATION is applied to 5g session terminate request.
3.The triggers RESOURCE_ POST_ PROCESSING, RATING_ POST_ PROCESSING, and GY_ POST_ PROCESSING are executed.
4.3 Contexts and attributes in call controller Rule contexts and attributes Attention : For Boolean type rule attributes including custom-data from SPR_DEVICE or SPR_GROUP , only the lower case true or false values are supported.
NCC uses rule engine to evaluate values of specific attributes in input contexts, that is, source contexts provide result attributes which are received in result context.
Call controller provides all the input in a rating request to the rating engine for rating to include DeviceContext , CommonCallContext , and ServiceInfoContext .
Rating uses the rule engine to determine charging service applicability and performs rating using tariffs.
However, if optional threshold rules are applicable, then the rating evaluates these rules and applies any necessary actions.
Rating responds to call controller with a rating engine answer that contains the GSU, rating engine result codes, and a collection of result contexts.
After rating is completed, call controller uses the actions from the rating engine answer to construct the Multiple Services Credit Control (MSCC) and CCA message.
Based on the object evaluated and location in the call flow, source contexts vary.
For example, the Credit Request Profile is evaluated first in the flow.
It has access to device and the Gy.Message context only.
When the applicability condition or tariff is evaluated, it has access to more contexts.
4.4 Source contexts Source contexts for charging Source Contexts are grouped by the data they provide and provide a place where Rules can get data to make conditions and populate values from results.
The contexts are different for the Charging and Policy application types; however, the Diameter Request provides common contexts across NCC.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.366Charging User Guide Charging rules The source context provides data about the specific context for use during rules evaluation and the various Source Contexts are available specific to the assigned Rule Sets.
For example, if your Rule Set has access to the Gy-Message source context for a Rule Set, you can make rules with conditions or results that depend on Gy message information.
Source contexts provide input attributes to the rule engine for evaluation of criteria.
This section describes the source contexts for charging.
Note : The dictionary only supports attributes for the PS-Information AVP at this time.
Any of the PS-Information attributes can be selected in the rules editor by source context.
CAUTION : When a rule is created, modified, removed, or loaded, it takes a minimum of 30 seconds to load the RSV.
For any action that updates the rules (for example, a TPG value is updated from 10 to 20, an action is updated, or a Tariff Rule action is modified), the changes take effect after ~30 seconds.
Operators must wait for this time interval (30 seconds), to consider the change for feature implementation/execution.
Diameter Request source context for common rule engine plugin To support the primary Diameter message routing functions of the NCC, the NCC rule engine creates message context objects, which provide a flexible framework for Diameter message representation and manipulation.
The message context is a wrapper around a Diameter message and makes the Diameter AVPs for a message type available in the same hierarchical structure as defined in the relevant standards document for the Diameter application.
The Diameter Request source context encapsulates the common AVPs that any Diameter request can contain, for example, Origin-Host or Route-Record.
When NCC receives a Diameter Request message, the rule engine is first invoked to execute the generic Diameter Request rule set, which makes the message available as a source context so that you can write rules that apply to many or all Diameter request message types.
For example, if you wanted to change the value of the destination-host AVP for all request messages, you would write the rule in the Diameter Request rule set.
Once the rule tables for the generic Diameter Request rule have been evaluated, the NCC rule engine is invoked a second time with the rule set that matches the specific request type (for example, the Gy CCR).
After evaluating the rule tables for both the generic Diameter Request and application message-specific rule sets, NCC checks to see whether the Result-Code or the Experimental-Result-code attributes of the Diameter Answer are populated, indicating that the request has been answered.
If so, NCC responds to the request with a Diameter Answer after invoking the rule engine on the response.
Otherwise, NCC forwards the request.
Source context Applicable triggers Description BUCKET SLICING_ PROFILE This context can be used to select the algorithm for the call, for example, Dynamic Slice Algorithm.Table 35: Source contexts for charging Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.367Charging User Guide Charging rules Source context Applicable triggers Description BUNDLE RESOURCE_ POST_ PROCESSING BUNDLEThis context is used for BOU type of bundles.
CALL_ COMMON APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER TARIFF THRESHOLD SLICING_ PROFILE GY_CREDIT_ REQUEST GY_POST_ PROCESSING RATING_ POST_ PROCESSING UC_PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION RESOURCE_ PRE_ SORTING RESOURCE_ POST_ PROCESSINGThis context provides the NCC rule engine with access to attributes used in triggers evaluated by rating or call control module for any call.
COMPLEX_ MAP All Triggers This context is used for converting the Complex Map operations into provisioned generic bindings and handling returned values.
CONVERSION All Triggers This context is used in all triggers for conversions, for example, boolean to enum, string to double, and so on.
COUNTERINFO COUNTER This context exposes the attributes of the Counter under evaluation to the rules engine.
ECOMMERCE APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER TARIFFThis context is used for the Ecommerce Calls.Table 35: Source contexts for charging (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.368Charging User Guide Charging rules Source context Applicable triggers Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GLOBAL GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGThis context provides the global- level checks on attributes.
GY_MESSAGE APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER TARIFF THRESHOLD SLICING_ PROFILE GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SNA_ MANAGEMENT SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION UC_PROCESSING DEVICE_ NOT_ FOUNDThis context contains command level Gy message attributes.Table 35: Source contexts for charging (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.369Charging User Guide Charging rules Source context Applicable triggers Description RESOURCE_ PRE_ SORTING GyCCR APPLICABILITY GY_CREDIT_ REQUEST IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION SLICING PROFILE THRESHOLD GY_PRE_ PROCESSING DEVICE_ NOT_ FOUNDThis context provides the NCC rule engine with access to AVPs.
This context is used to report the credit control service information received for Gy, Vo L TE, SMS, and MMS requests.
It is for use in rules.
IMS_ SERVICE_ INFO APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER TARIFF THRESHOLD IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING RESOURCE_ PRE_ SORTINGThis context contains context information for the IMS calls.
LOAN_ REQUEST LOAN_ PRE_ PROCESSING LOAN_ PRE_ PROCESSINGThis context contains the Loan Request attributes that are used as a condition in rules.
NCHF_ CHARGING_ MESSAGE CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ POST_ PROCESSINGThis context is used for 5G calls.Table 35: Source contexts for charging (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.370Charging User Guide Charging rules Source context Applicable triggers Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING NUMBER_ PORTABILITY All Triggers This context holds special data for the users.
POLICY_ COUNTER_ STATUS_ CHANGE POLICY_ COUNTER_ STATUS_ CHANGE This context can be used to send Policy- Counter- Status- Change notification upon the policy counter status change, regardless of the Sy session.
PROPERTIES All Triggers This context can be used to check the system environment related data, for example, Get System property.
RATING_ POST_ PROCESSING GY_POST_ PROCESSING RATING_ POST_ PROCESSING THRESHOLDThis context contains the context information required for rating post processing such as call common context, SPR device, subscription, threshold.
RESOURCE_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING This context is evaluated on COMMIT of every resource, such as bucket, counter, main account balance, and NoCharge.
SERVICE_ INFO APPLICABILITY CALL_ RULE_ VARIABLES GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD SLICING_ PROFILE BUNDLE COUNTERThis context provides the NCC rule engine with access to the call sub- type information.
SESSION_ PARAMETERS RESOURCE_ POST_ PROCESSING RATING_ POST_ PROCESSING APPLICABILITY CALL_ RULE_ VARIABLES TARIFF GY_PRE_ PROCESSING GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONThis context provides the NCC rule engine with access to a session specific information.Table 35: Source contexts for charging (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.371Charging User Guide Charging rules Source context Applicable triggers Description MMS_ CALL_ TERMINATION SMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTING SNA_ MANAGEMENT SNA_ MANAGEMENT This context is used to send notification parameters, TCP/ IP notifications sent from the NS.
SPR_ ACCOUNT SUBSCRIBER_ PRE_ PROVISIONING This context provides the account information.
SPR_ DEVICE APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD SLICING_ PROFILE GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThis context provides device specific details to the NCC rule engine.Table 35: Source contexts for charging (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.372Charging User Guide Charging rules Source context Applicable triggers Description SNA_ MANAGEMENT SNR_ RESUL T SUBSCRIBER_ PRE_ PROVISIONING SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION UC_PROCESSING CALL_ RULE_ VARIABLES GY_MESSAGE RESOURCE_ PRE_ SORTING SPR_ DEVICE_ NEW SUBSCRIBER_ PRE_ PROVISIONING This context provides information of the Device Entity attributes that are going to be changed in an API operation ( or after the change) .
SPR_ GROUP APPLICABILITY TARIFF GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE THRESHOLD CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING GY_CREDIT_ REQUEST COUNTER UC_PROCESSING BUNDLE RESOURCE_ PRE_ SORTINGThis context contains the group information.
SUBSCRIBER_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING This context provides subscription information at the time of evaluation of provisioning request which arrived from upstream system.
SUBSCRIPTION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING THRESHOLD LIFECYCLEThis context provides subscription specific details to the NCC rule engine.Table 35: Source contexts for charging (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.373Charging User Guide Charging rules Source context Applicable triggers Description SY_COUNTER SNR_ RESUL T SNA_ MANAGEMENTThis context provides the NCC rule engine with access to the policy counter status information from the existing Sy session and from rating evaluation.
SY_COUNTER_ EVAL SNR_ RESUL T This context evaluates the current policy counter status against the previous status.
Using this context, the NCC rule engine can determine whether the policy counter status has changed or not.
SY_MESSAGE SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATIONThis context provides the NCC rule engine with access to data from an incoming Sy SLR message.
SYSTEM All Triggers This context can be used to check the system- related data, for example, Site - id, Host- Id, Time, and so on.
THRESHOLD_ PROFILE THRESHOLD BUNDLEThis context provides the NCC rule engine with access to the threshold specific information.
UC UC_PROCESSING This context exposes the attributes of the usage control under evaluation to the rules engine.
VARIABLES All Triggers This context can be used for supporting the rule variables.Table 35: Source contexts for charging (continued) 4.5 Multi-value AVPs in PS-Information attributes The Diameter protocol specifies that multiple instances of an AVP may occur within a single message.
An AVP defined as multi-valued is a container for one or more AVPs.
Further, an AVP might be single-valued but due to a multi-valued parent ancestor, may appear multiple times within the message.
In general, the multiplicity of the multi-value AVPs is often unbounded.
As a result, multi-value Diameter messages may be arbitrarily complex in terms of the number of and location of the occurrence of particular AVPs.
For example, consider the case of the Rx AAR message, which contains a group-type AVP Media-Component- Description .
This AVP contains, among other AVPs, a multi-valued, grouped Media-Sub-Component AVP that in turn contains a multi-valued Flow-Description AVP.
The following is an example of a specific multi-value Service-Information.PS-Information attribute with the potential to return a list or collection of values.
The attributes have a “[ ]” notation directly following them to indicate that they return a list or collection of values; for example, Service-Information.PS- Information.SGSN-Address[] .
There are two different NCC multi-value rule attribute examples shown in this section to illustrate attributes with the [ ] notation and attributes with the “Total-Number-Of-Values” notation.
In this example, each multi-value example uses the Service-Information.PS-Information.SGSN-Address attribute contained in the Gy message as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.374Charging User Guide Charging rules Service-Information PS-Information SGSN-Address = 94.21.1.1 SGSN-Address = 94.21.1.2 SGSN-Address = 94.21.1.3 •In the first example, the following rule condition evaluates to true and the associated action is applied: If GyCCR.Service-Information.PS-Information.SGSN-Address[] contains 94.21.1.2 , then Example-action .
This is because SGSN-Address 94.21.1.2 exists within the set of the Service-Information.PS- Information.SGSN-Address AVP contained in the Gy message.
•In the second example, an attribute with the “Total-Number-Of-Values” notation is used; for example, Service-Information.PS-Information.SGSN-Address.Total-Number-Of-Values .
The “Total-Number-Of-Values” notation evaluates to true if the total number of values that exist in the AVP match the rule.
The following rule condition evaluates to true and the associated action is applied because there is a total of three Service-Information.PS-Information.SGSN-Addresses that exist in the request or message.
If GyCCR.Service-Information.PS-Information.SGSN-Address.Total-Number-Of- Values equals 3, then Example-action .
If the rule condition value were set to another value (for example, 1 or 2), then the rule condition is evaluated to false and no action is applied.
4.6 Source context to rule attribute mapping The common source context attributes include a cross-section of command-level Gy message attributes and internally derived attributes.
The subsequent blocks provide information on the attributes and triggers for a specific source context.
4.6.
1 ANNOUNCEMENT source context Attribute name Trigger Description RePrompt- AllowedIMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONThis attribute provides the functionality to check if re- prompt is allowed and max retry times is not reached for current PAC action.
Validate- Collected- DigitsIMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONThis attribute provides the functionality to check if the length of collected digits matchTable 36: ANNOUNCEMENT source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.375Charging User Guide Charging rules Attribute name Trigger Description the range defined by minimum digits and maximum digits.
Is-Language- SelectionIMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONThis attribute is used to indicate that the current IMS session is in PAC state for language selection.Table 36: ANNOUNCEMENT source context (continued) 4.6.2 BUCKET source context Attribute name Trigger Description Bucket- Current- Charging- Step SLICING_ PROFILEThis attribute shows the Current Charging Step of the Bucket under evaluation to the rules engine.
Bucket- Name SLICING_ PROFILEThis attribute shows the Name ( Bucket Id) of the Bucket under evaluation to the rules engine.
Bucket- Unit- Type SLICING_ PROFILEThis attribute shows the Unit Type of the Bucket under evaluation to the rules engine.
Bundle- Name SLICING_ PROFILEThis attribute shows the Bundle Name of the Bucket under evaluation to the rules engine.
Regular- Current- Value SLICING_ PROFILEThis attribute shows the current Value of the Regular Bucket under evaluation to the rules engine.
Total- Current- Value SLICING_ PROFILEThis attribute shows the current Value of the Bucket under evaluation to the rules engine.Table 37: BUCKET source context 4.6.3 BUNDLE source context Attribute name Trigger Description Description RESOURCE_ POST_ PROCESSINGThis attribute provides the description of subscription.Table 38: BUNDLE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.376Charging User Guide Charging rules Attribute name Trigger Description No-Of-Activation BUNDLEThis attribute provides the number of activation done for BOU Type bundle.Table 38: BUNDLE source context (continued) 4.6.4 CALL_COMMON source context Attribute name Trigger Description Add- CDR RESOURCE_ POST_ PROCESSINGIt is used to add a new CDR tag with value, it is a command level.
BUNDLE COUNTER RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESApplication- ID RESOURCE_ PRE_ SORTINGThis attribute provides the Application id for the Server Notification.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILECall- Is-In-Zone TARIFFThis attribute provides either true or false value depending upon whether the call is in zone or not.Table 39: CALL_COMMON source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.377Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESCall- Protocol RESOURCE_ PRE_ SORTINGThis attribute provides the type of Triggering Protocol, for example, HTTP, DIAMETER.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGCall- Request- Type SLICING_ PROFILEThis attribute provides the request type such as INITIAL, UPDATE, TERMINATE, EVENT_ REQUEST.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.378Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESCall- Roaming- Status RESOURCE_ PRE_ SORTINGThis attribute provides the roaming state of a call, for example, HOME, ROAMING.
APPLICABILITY BUNDLE COUNTER TARIFFCall- Sub- Type THRESHOLDThis attribute provides the sub type of a call.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.379Charging User Guide Charging rules Attribute name Trigger Description UC_PROCESSING RATING_ POST_ PROCESSING GY_POST_ PROCESSING GY_PRE_ PROCESSING GY_CREDIT_ REQUEST DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING RATING_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESCall- Trigger- Type RESOURCE_ PRE_ SORTINGThis attribute provides the trigger Type as per the current state of a call such as HARD- STOP, TOD.
APPLICABILITY Call- Type BUNDLEThis attribute provides the call type.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.380Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST TARIFF THRESHOLD RATING_ POST_ PROCESSING UC_PROCESSING GY_CREDIT_ REQUEST GY_PRE_ PROCESSING DEVICE_ NOT_ FOUNDCalled- Party CALL_ RULE_ VARIABLESThis attribute provides the called party.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.381Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGCalled- Party- Country RESOURCE_ PRE_ SORTINGThis attribute provides the called party country.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD UC_PROCESSING DEVICE_ NOT_ FOUNDCalled- Type CALL_ RULE_ VARIABLESThis attribute provides the called type.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.382Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGCalling- Party RESOURCE_ PRE_ SORTINGThis attribute provides the calling party.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESCalling- Type RESOURCE_ PRE_ SORTINGThis attribute provides the calling type.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.383Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESCGI.CI RESOURCE_ PRE_ SORTINGThis attribute provides the Cell Identifier ( CI) of a CGI.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESCGI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the Location Area Code (LAC) of a CGI.
RATING_ POST_ PROCESSING THRESHOLD TARIFF DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESCheck- Balance- Result RESOURCE_ PRE_ SORTINGThis attribute provides a reason for sending the check balance result, for example, Enough Credit, No credit.
Consumption- Speed SLICING_ PROFILE RESOURCE_ PRE_ SORTINGThis attribute is used to configure consumption speed for a slicing profile.
TheTable 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.384Charging User Guide Charging rules Attribute name Trigger Description attribute returns a float number and its units depend on quota type: •Volume: bytes consumed/ slice duration in seconds •Time: seconds consumed/ slice duration in seconds •Units: units consumed/ slice duration in seconds APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESCug- Groups RESOURCE_ PRE_ SORTINGThis attribute provides the cug group for calling and called party.
GY_POST_ PROCESSING CALL_ RULE_ VARIABLES RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGCumulative- Call- Cost RESOURCE_ PRE_ SORTINGThis attribute contains the sum of utilization of main balance and cost bucket.
It also includes any cost of surcharges ( next rate) .
GY_POST_ PROCESSING CALL_ RULE_ VARIABLESCumulative- USU- Time RESOURCE_ PRE_ SORTINGThis attribute provides the cumulative time- based USU value.
APPLICABILITY TARIFFDay- Of-Month RESOURCE_ PRE_ SORTINGThis attribute provides the day of month.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.385Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESDay- Of-Month- GMT RESOURCE_ PRE_ SORTINGThis attribute provides the day of month in the GMT format.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLESDay- Of-Month- TZ RESOURCE_ PRE_ SORTINGThis attribute provides the day of month in the account Timezone format.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.386Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLESDay- Of-Week RESOURCE_ PRE_ SORTINGThis attribute provides the day of week.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESDay- Of-Week- GMT RESOURCE_ PRE_ SORTINGThis attribute provides the day of week in the GMT format.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.387Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESDay- Of-Week- TZ RESOURCE_ PRE_ SORTINGThis attribute provides the day of week in the account Time Zone format.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD UC_PROCESSINGDate- Time DEVICE_ NOT_ FOUNDThis attribute generates the values for time- related attributes.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.388Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESDate- Time- String- GMT RESOURCE_ PRE_ SORTINGThis attribute provides the value of time related attributes in the GMT format.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFDate- Time- String THRESHOLDThis attribute converts the date and time in string format.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.389Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLESDate- Time- String- TZ RESOURCE_ PRE_ SORTINGThis attribute provides the value of time related attributes in the Account timezone.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFDefault- Roaming- Decision THRESHOLDThis attribute determines the roaming state of a call, for example, HOME, ROAMING.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.390Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING Get- Match- String ALL RESOURCE_ PRE_ SORTINGThis attribute checks whether a string matches with another string.
If the string matches, it returns true .
Else, it returns false .
It takes the following input parameters: •Input- String1 : The first string ( string1; string2; string3 ).
•Input- String2 : The string to be matched with the first string ( string1 ).
•Separator ( ;): It separates the strings in the Input- String1 .
For example: CALL_ COMMON.
Get- Match- String( "string1; string2; string3" , "string1" , ";") TARIFF RESOURCE_ POST_ PROCESSINGGet- Tax- Id-from- Rate APPLICABILITYThis attribute is used to fetch the taxation defined in the applied rate is fetched.
If the taxation reference is provided in the charging logic tariff rule using Get- Tax- Id- from- Rate attribute, then the taxation defined in the applied rate is fetched.
BUNDLE COUNTER RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESHost- ID RESOURCE_ PRE_ SORTINGThis attribute provides the local host name.
APPLICABILITY BUNDLEHour- Of-Day COUNTERThis attribute provides the hour of the day.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.391Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLESHour- Of-Day- GMT RESOURCE_ PRE_ SORTINGThis attribute provides the hour of the day in the GMT format.
APPLICABILITY BUNDLEHour- Of-Day- TZ COUNTERThis attribute provides the hour of the day in the account Timezone format.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.392Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESHSPA.
LAC RESOURCE_ PRE_ SORTINGThis attribute provides the 3GPP- HSPA LAC for an HSPA.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLDHSPA.
SAC DEVICE_ NOT_ FOUNDThis attribute provides the 3GPP- HSPA SAC from an HSPA.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.393Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLESIn-Time- Period Attention: Note that this parameter is obsolete.
RESOURCE_ PRE_ SORTINGThis attribute checks whether the time is within a given time period.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDIn-Time- Period- GMT Attention: Note that this parameter is obsolete.
DEVICE_ NOT_ FOUNDThis attribute checks whether the time is within a given time period in the GMT format.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.394Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESIn-Time- Period- TZ Attention: Note that this parameter is obsolete.
RESOURCE_ PRE_ SORTINGThis attribute checks whether the time is within a given time period in the account Timezone format.
RESOURCE_ POST_ PROCESSING APPLICABILITY TARIFF SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING THRESHOLD BUNDLEisAPR COUNTERThis attribute checks whether it is APR request or not.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.395Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING TARIFF RESOURCE_ PRE_ SORTINGIs-Specified- CS-Selected RATING_ POST_ PROCESSINGThis attribute indicates whether the specified CS has been selected.
RATING_ POST_ PROCESSING CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTINGIs-Gsu- Zero RESOURCE_ PRE_ SORTINGThis attribute provides the value of the Is- GSU- Zero flag.
The flag is set to True if the GSU is zero.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESIs-OnNet RESOURCE_ PRE_ SORTINGThis attribute checks if its onnet call or not.
RATING_ POST_ PROCESSING CALL_ RULE_ VARIABLESgetGSUValue RESOURCE_ PRE_ SORTINGThis attribute provides the granted service units of an MSCC.
APPLICABILITY Kind- Of-Unit BUNDLEThis attribute provides the kind of unit, for example, Time, Money, Volume, Unit.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.396Charging User Guide Charging rules Attribute name Trigger Description COUNTER RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND UC_PROCESSINGLong ToString RESOURCE_ PRE_ SORTINGThis attribute converts the long value to a string value.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.397Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD CALL_ RULE_ VARIABLESMax- Requested- Bandwidth- DL RESOURCE_ PRE_ SORTINGThis attribute provides the maximum bit rate allowed for a downlink direction.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD CALL_ RULE_ VARIABLESMax- Requested- Bandwidth- UL RESOURCE_ PRE_ SORTINGThis attribute provides the maximum bit rate allowed for an uplink direction.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESMCC RESOURCE_ PRE_ SORTINGThis attribute provides the MCC value.
MCCMNC APPLICABILITY This attribute provides the MCCMNC value.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.398Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESMNC RESOURCE_ PRE_ SORTINGThis attribute provides the MNC value.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGMultiple- Services- Credit- Control.
Rating- Group SLICING_ PROFILEThis attribute provides the Rating Group of an MSCC.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.399Charging User Guide Charging rules Attribute name Trigger Description TARIFF UC_PROCESSING THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING BUNDLE COUNTER RATING_ POST_ PROCESSING THRESHOLD UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESMultiple- Services- Credit- Control.
Result- Code RESOURCE_ PRE_ SORTINGThis attribute provides the MSCC result code.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEMultiple- Services- Credit- Control.
Service- Identifier TARIFFThis attribute provides the Service Identifier of an MSCC.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.400Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND UC_PROCESSING RESOURCE_ PRE_ SORTING BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESNotification- Event RESOURCE_ PRE_ SORTINGThis attribute provides the type of request which triggered the notification, for example, Update, Terminate.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESNumber- Portability- Routing- Information RESOURCE_ PRE_ SORTINGThis attribute provides the number portability routing info from the CC Request.
CALL_ RULE_ VARIABLES Number- Of-Non- Free- Opened- RGs SLICING_ PROFILEThis attribute defines the value calculated number of opened RGs excluding free RGs for a CCR.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.401Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING Pre- Rating- Simulation- Bundle APPLICABILITY BUNDLE COUNTER TARIFF RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGThis attribute indicates the bundle name for the highest priority applicable charging logic selected in pre- rating- simulation.
Pre- Rating- Simulation- CS APPLICABILITY BUNDLE COUNTER TARIFF RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTINGThis attribute indicates the name of the CS for a Pre- Rating- Simulation- CS.
Pre- Rating- Simulation- Rate APPLICABILITY BUNDLE COUNTER TARIFF RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute indicates the name of the rate for a Pre- Rating- Simulation- Rate.
APPLICABILITY BUNDLE COUNTER TARIFF RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLESPre- Rating- Simulation- Next- Rate RESOURCE_ PRE_ SORTINGThis attribute indicates the name of the next rate for a Pre- Rating- Simulation Next Rate.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.402Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESRAI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the Location Area Code (LAC) of an RAI.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESRAI.RAC RESOURCE_ PRE_ SORTINGThis attribute provides the Routing Area Code( RAC) of an RAI.
APPLICABILITY BUNDLE COUNTER RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILERAT- TYPE TARIFFThis attribute provides the radio access technology serving the UE.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.403Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING BUNDLE COUNTER RATING_ POST_ PROCESSING THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESRating.
Result- Code RESOURCE_ PRE_ SORTINGThis attribute provides the result code given by rating.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESRequest- Action RESOURCE_ PRE_ SORTINGThis attribute provides the type of Requested Action.
For example, Direct Debit, Check balance, refund account, price inquiry, ecommerce_ uc_remaining_ balance.
Routing- Number APPLICABILITYThis attribute provides the routing number from the CC Request.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.404Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING IMS_ CALL_ ESTABLISHMENT MMS_ CALL_ ESTABLISHMENT SMS_ CALL_ ESTABLISHMENT RATING_ POST_ PROCESSING RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESSAI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the Location Area Code (LAC) of an SAI.
SAI.SAC APPLICABILITYThis attribute provides the Service Area Code ( SAC) of an SAI.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.405Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESSDP- Media- Component.
SDP- Media- Name RESOURCE_ PRE_ SORTINGThis attribute provides the Media Type.
RATING_ POST_ PROCESSING TARIFF DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESSelected Charging Services.
Id RESOURCE_ PRE_ SORTINGThis attribute provides the selected charging service Ids.
APPLICABILITY TARIFFSelected- Rate CALL_ RULE_ VARIABLESThis attribute provides the selected rate as a string.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.406Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING UC_PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESService- Context- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Service - Context- Id.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESService- Info.
MMTel- Info.
Supp- Service.
Number- Of-Participants RESOURCE_ PRE_ SORTINGThis attribute provides the number of participants.
APPLICABILITY Session- Id BUNDLEThis attribute provides the Session Id.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.407Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF UC_PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING BUNDLE COUNTER RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESSite- ID RESOURCE_ PRE_ SORTINGThis attribute provides the Id of the site.
APPLICABILITY BUNDLE COUNTER TARIFFStarts- With THRESHOLDThis attribute returns true or false depending on whether the value starts with the defined numbers or not.
For example, the following rule checks whether a number starts with the value 919898 .
CALL_COMMON.Starts-With ( CALL_ COMMON.Called-Party, "919898" ) = trueTable 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.408Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESTAI.ECI RESOURCE_ PRE_ SORTINGThis attribute provides the E- UTRAN cell identifier ( ECI) of an ECGI.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESTAI.TAC RESOURCE_ PRE_ SORTINGThis attribute provides the Tracking area code ( TAC) of a TAI.
APPLICABILITY BUNDLE COUNTERTime- Start- Of-Day GY_POST_ PROCESSINGThis attribute provides the time at start of a day.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.409Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESTime- Start- Of-Day- GMT RESOURCE_ PRE_ SORTINGThis attribute provides the time at the start of a day in the GMT format.
APPLICABILITY BUNDLETime- Start- Of-Day- TZ COUNTERThis attribute provides the time at start of a day in account Time Zone.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.410Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESTime- Of-Day RESOURCE_ PRE_ SORTINGThis attribute provides the time of the day in milliseconds.
It allows operators to configure special tariff plans based on the specific time and day.
Example: CALL- COMMON.
Time- Of-Day > 64800000 and CALL- COMMON.
Time- Of-Day < 82800000 Time- Of-Day- TZ APPLICABILITY BUNDLE COUNTER TARIFFThis attribute provides the time of the day in Account Timezone.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.411Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLESTime- Of-Day- GMT RESOURCE_ PRE_ SORTINGThis attribute provides the time of the day in the GMT format.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGDay- Of-Week SLICING_ PROFILEThis attribute provides the time of the day in an account.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.412Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESUCGI.
CI RESOURCE_ PRE_ SORTINGThis attribute provides the 3GPP- UTRAN CI for an UCGI.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESUCGI.
LAC RESOURCE_ PRE_ SORTINGThis attribute provides the 3GPP- UTRAN LAC for an UCGI.
GY_POST_ PROCESSING CALL_ RULE_ VARIABLESUnable- Fund- Call- Flag RATING_ POST_ PROCESSINGThis attribute provides the value of unable fund call flag.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.413Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING THRESHOLD BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESUsed- Service- Units RESOURCE_ PRE_ SORTINGThis attribute provides the Used Service Units AVP value.
APPLICABILITY BUNDLE COUNTER TARIFF RATING_ POST_ PROCESSING CALL_ RULE_ VARIABLESWholesale- CL RESOURCE_ PRE_ SORTINGThis attribute contains the applicable and highest priority Wholesale Charging Logic.
APPLICABILITY BUNDLE COUNTER TARIFF RESOURCE_ POST_ PROCESSINGWholesale- Rate CALL_ RULE_ VARIABLESThis attribute contains the applicable and highest priority Wholesale Rate.Table 39: CALL_COMMON source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.414Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER TARIFF RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLESWholesale- Next- Rate RESOURCE_ PRE_ SORTINGThis attribute contains the applicable and highest priority Wholesale Next Rate.
APPLICABILITY BUNDLE COUNTER TARIFF THRESHOLD DEVICE_ NOT_ FOUND CALL_ RULE_ VARIABLESWLAN- ID RESOURCE_ PRE_ SORTINGThis attribute provides the Wlan id.Table 39: CALL_COMMON source context (continued) 4.6.5 COUNTERINFO source context Attribute name Trigger Description Counter- Def- Name COUNTER This attribute indicates the name of counter.
Counter- Current- Value COUNTER This attribute provides the current value of counter.Table 40: COUNTERINFO source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.415Charging User Guide Charging rules Attribute name Trigger Description Counter- Usage- Limit COUNTER This attribute provides the usage limit of counter.
Counter- Overage- Limit COUNTER This attribute provides the overage limit of counter.
Counter- TPG- List COUNTER This attribute provides a list of the threshold profile group attached with counter.
Counter- CAP- List COUNTER This attribute provides a list of cap attached with counter.
Counter- Overage TPG- List COUNTER This attribute provides a list of overage threshold profile group attached with counter.
Counter- Current- Reserve- Value COUNTER This attribute indicates the total reserve value of counter.
Counter- Update- Event COUNTER This attribute indicates the event name when counter is updated through API, for example, usage limit update.
Cancel- Counter- Update- Attempt COUNTER When this command is executed, any attempt to modify or change the affected counter is rejected.
When NCC encounters this command, it reverts the counter to the previous state.Table 40: COUNTERINFO source context (continued) •You can use a counter with Usage Limit (ULI), and also with the rule that is configured as follows: if Counter-Update-Event = "ULI Updated" and Counter-Current-Value >= Counter-Usage-Limit then NOTIFICATION.Cancel-Counter-Update-Attempt •The REST API command /services/ServiceManager/subscriber/update/EntityCounterInstance can be used to modify the Usage Limit (ULI) on the target device that has an active charging session.
•You can increase the ULI since the counter’s value is smaller than the new limit.
•When the ULI is decreased below the current value, the action is rejected, and the ULI remains unchanged.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.416Charging User Guide Charging rules 4.6.6 COMPLEX_MAP source context Attribute name Trigger Description Complex- Map- Version All triggers This attribute provides the version of the complex map.
It takes two mandatory input parameters Map- Name and Map- Date .
If Map- Date is not provided, then it is considered as an empty string.
Get- 1Key- List All Triggers This attribute provides the list of keys for a complex map.
Get- Row- Boolean All Triggers This attribute provides a boolean value within string for a complex map.
Get- Row- Decimal All Triggers This attribute provides a decimal value within string for a complex map.
Get- Row- IPAddress All Triggers This attribute provides an ip address value within string for a complex map.
Get- Row- IPAddress- List All Triggers This attribute provides a Hash Set of ip addresses for a complex map.
Get- Row- Long All Triggers This attribute provides a long value within string for a complex map.
Get- Row- Date Time All Triggers This attribute provides a date time value within string for a complex map.
Get- Row- Time OfDay All Triggers This attribute provides a time value within string for a complex map.
Get- Row- Time Duration All Triggers This attribute provides a time duration value within string for a complex map.
Get- Row- String All Triggers This attribute provides a string value within string for a complex map.
Get- Row- Input- Key- By-Index All Triggers This attribute provides the Regex key of given index.
Get- Row- Key- By-Index All Triggers This attribute provides the Regex key of given index.
Get- Row- Input- Keys All Triggers This attribute provides the keys.
Get- Row- Keys All Triggers This attribute provides the Regex keys.
Load- Row- 1Key All Triggers This attribute wraps one key into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the keyTable 41: COMPLEX_MAP source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.417Charging User Guide Charging rules Attribute name Trigger Description into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 2Key All Triggers This attribute wraps two keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 2 keys into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 3Key All Triggers This attribute wraps three keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 3 keys into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 4Key All Triggers This attribute wraps four keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 4 keys into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 5Key All Triggers This attribute wraps five keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 5 keys into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 6Key All Triggers This attribute wraps six keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 6 keys into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 7Key All Triggers This attribute wraps seven keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a In Row Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 7 keys into a Generic Binding key and then retrieving theTable 41: COMPLEX_MAP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.418Charging User Guide Charging rules Attribute name Trigger Description ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 8Key All Triggers This attribute wraps eight keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 8 keys into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 9Key All Triggers This attribute wraps nine keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 9 keys into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.
Load- Row- 10Key All Triggers This attribute wraps ten keys into a list and pass to map.
Loads the values from a row in a complex map table, and caches them in map String Values under the key a InRow Label for future calls to the various get Row functions.
It does this by concatenating the map name and the 10 keys into a Generic Binding key and then retrieving the ordered values map for that Generic Binding.
If the row is retrieved successfully, the function returns true, false otherwise.
If one of the parameters is null, returns null.Table 41: COMPLEX_MAP source context (continued) 4.6.7 ECOMMERCE source context Attribute name Trigger Description APPLICABILITY TARIFF BUNDLE COUNTER RATING_ POST_ PROCESSINGMerchant- Id CALL_ RULE_ VARIABLESThis attribute is an identifier of the merchant used to purchase the service.
It is just an alphanumerical identifier.Table 42: ECOMMERCE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.419Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING Transaction- Id RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING ECOMMERCE_ CALL_ ESTABLISHMENTThis attribute is a unique identifier of the e- commerce transaction.
It is an alphanumerical identifier.
rated Product Usage.
taxIncluded Rating Amount.
value RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF CALL_ RULE_ VARIABLES ECOMMERCE_ CALL_ ESTABLISHMENTThis attribute identifies the amount ( VAT included) to be charged for the e- commerce usage.
It is a string.
Note : The input float value is converted to a string which is null in the following cases: •It is missing.
•Its value is 0.
•It has a negative value.
rated Product Usage.
taxIncluded Rating Amount.
unitRATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF CALL_ RULE_ VARIABLES ECOMMERCE_ CALL_ ESTABLISHMENTThis attribute identifies the currency in which the amount is expressed.
It is a string Note : Its value is a null string in case it is missing or entered as an empty string.
rated Product Usage.
taxRate RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF CALL_ RULE_ VARIABLES ECOMMERCE_ CALL_ ESTABLISHMENTThis attribute identifies the applied tax percentage.
It is a string Note : The input float value is converted to a string which is null in case it is missing or negative.
Read- Usage- Characteristic APPLICABILITY BUNDLE COUNTER RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF CALL_ RULE_ VARIABLES ECOMMERCE_ CALL_ ESTABLISHMENTThis action scans the list of input usage characteristics, and it returns the string value for the specified characteristic, if found in the list.
Else, it returns a null string as value.
For example: ECOM- Service Type = ECOMMERCE.
Read- Usage- Characteristic ( "debit Type" ) Each usage Characteristic in the dynamic list can appear only once.
Incorrectly formatted usage Characteristic is skipped.
Traffic- Type APPLICABILITYThis attribute is used to identify and allow throttling cases.Table 42: ECOMMERCE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.420Charging User Guide Charging rules Attribute name Trigger Description TARIFF BUNDLE COUNTER RATING_ POST_ PROCESSING CALL_ RULE_ VARIABLES RESOURCE_ POST_ PROCESSINGTable 42: ECOMMERCE source context (continued) 4.6.8 GLOBAL source context Attribute name Trigger Description Allowed List GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGThis attribute provides the global allowed list.
APNList GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGThis attribute provides the APN list.
Barred List GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGThis attribute provides the global barred list.
Rating Group List GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGThis attribute provides the global rating group list.Table 43: GLOBAL source context 4.6.9 GY_MESSAGE source context Note : See msTimezone and sgsnMccMnc variables on page 507 for output of the GY_MESSAGE msTimeZone and sgsnMccMnc variables based on the values set in Store location updates , Use stored location updates (IMS) , and Re-Rating on Location updates (IMS) application preferences.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.421Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_PRE_ PROCESSINGCalled- Party- CC RESOURCE_ PRE_ SORTINGThis attribute provides the called party country code.
It takes Called- Party- Address- Data and Address- Type as input parameters.
Note : This attribute returns the called party country code only when the value of Address- Type is MSISDN.
For other values of Address- Type, the return value is null.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING TARIFF THRESHOLD CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDCGI.CI RESOURCE_ PRE_ SORTINGThis attribute provides the CGICI value as string.Table 44: GY_MESSAGE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.422Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING TARIFF THRESHOLD DEVICE_ NOT_ FOUNDCGI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the CGILAC value as string.
BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES IMS_ CALL_ ESTABLISHMENTCredit- Control- Request- Type SMS_ CALL_ TERMINATIONThis attribute provides the type of request.
For example, INITIAL, UPDATE, TERMINATE, EVENT.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.423Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING Enable- Silent- TTC GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGThis action works only when the Is-TTC- Enabled is set to true .
When this action is used in RSV, and the TCC is enabled, NCC calculates the TCU.
If the Gateway sends the TCU, NCC does not calculate the TCU as the Gateway has higher priority.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING TARIFF THRESHOLDSMS- Information.
SMS- Node DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides the EGCIECI value as string.
BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENTEvent- Time- Stamp MMS_ CALL_ TERMINATIONThis attribute provides the event timestamp.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.424Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING GY_POST_ PROCESSINGGet- CLD- Country RESOURCE_ PRE_ SORTINGThis attribute provides the called party country name.
It takes Called- Party- Address and Address- Type as input parameters.
Note : This attribute returns the called party country name only when the value of Address- Type is MSISDN.
For other values of Address- Type, the return value is null.
GY_PRE_ PROCESSING CALL_ RULE_ VARIABLES IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDGet- SIP-Number RESOURCE_ PRE_ SORTINGThis attribute provides SIP URI.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.425Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING THRESHOLD DEVICE_ NOT_ FOUNDGet- Trimmed- Value RESOURCE_ PRE_ SORTINGThis attribute is primarily used to get trimmed values of phone numbers.
This removes all default escape characters (that is, + , -, leading zeroes) from the input value and returns a trimmed value.
For example, + 918010022536 is trimmed to 918010022536 and 00000918010022536 is trimmed to 918010022536.
APPLICABILITY BUNDLE COUNTERLong ToString CALL_ RULE_ VARIABLESThis attribute converts long value to string.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.426Charging User Guide Charging rules Attribute name Trigger Description GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATIONTrim- Country- Code IMS_ CALL_ ESTABLISHMENTThis attribute provides country code.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.427Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING CALL_ RULE_ VARIABLES RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ ESTABLISHMENTIs-Late- Rating NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute indicates whether last rating call is there or not.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.428Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION RESOURCE_ POST_ PROCESSING SNA_ MANAGEMENT RATING_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING RESOURCE_ POST_ PROCESSING GY_CREDIT_ REQUEST CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATIONis-Location- Update GY_SESSION_ TERMINATIONThis attribute checks whether the location is updated or not.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.429Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDIs-OnNet RESOURCE_ PRE_ SORTINGThis attribute checks if its onnet call or not.
APPLICABILITY BUNDLE COUNTERIs-OnNet- Explicit- Check GY_POST_ PROCESSINGThis attribute validates if call flow is onnet or not.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.430Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFFIs-TTC- Enabled CALL_ RULE_ VARIABLESThis attribute provides the value of TTC enabled flag.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.431Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING isAPRCallGY_CREDIT_ REQUESTThis attribute indicates whether the call is an APR call.
BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDLocal- System- Time RESOURCE_ PRE_ SORTINGThis attribute provides the current time in milliseconds.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING CALL_ RULE_ VARIABLESMCC GY_PRE_ PROCESSINGThis attribute provides the MCC value from ULI.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.432Charging User Guide Charging rules Attribute name Trigger Description MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFFMCCMNC THRESHOLDThis attribute provides the MCCMNC value from ULI.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.433Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Adaptations RESOURCE_ PRE_ SORTINGThe adaptations indicate whether the originator allows adaptation of the content or not.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSINGMMS- Information.
Applic- ID MMS_ CALL_ ESTABLISHMENTThis attribute provides the Applic id.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.434Charging User Guide Charging rules Attribute name Trigger Description MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Aux- Applic- Info RESOURCE_ PRE_ SORTINGThis attribute provides the Aux Applic info.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSINGMMS- Information.
Content- Class GY_PRE_ PROCESSINGThe Content- Class classifies the content of the MM to the highest content class to which the MM belong.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.435Charging User Guide Charging rules Attribute name Trigger Description MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Delivery- Report- Requested RESOURCE_ PRE_ SORTINGThis attribute provides the Delivery Report requested by originator or not.
APPLICABILITY BUNDLEMMS- Information.
DRM- Content CALL_ RULE_ VARIABLESThe DRM- Content indicates if the MM contains DRM- protected content.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.436Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Message- Class.
Class- Identifier RESOURCE_ PRE_ SORTINGThis attribute provides the Class Identifier Value.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.437Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Message- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Type of MMS according to MMS Transactions.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATIONMMS- Information.
Message- Size TARIFFThis attribute provides the message size.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.438Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Message- Type RESOURCE_ PRE_ SORTINGThis attribute provides the message type.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENTMMS- Information.
MM- Box- Storage- Requested MMS_ CALL_ TERMINATIONThe Mbox Storage request indicates whether an MBox Storage has been requested by the originator MMS user agent or not.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.439Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
MM- Content- Type.
Additional- Type- Info RESOURCE_ PRE_ SORTINGThis attribute provides the Additional Type Information.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSINGMMS- Information.
MM- Content- Type.
Content- Size MMS_ CALL_ ESTABLISHMENTThis attribute provides the content size.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.440Charging User Guide Charging rules Attribute name Trigger Description MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Originator- Address.
Address- Data RESOURCE_ PRE_ SORTINGThis attribute provides the Address data.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTERMMS- Information.
Originator- Address.
Address- Type GY_POST_ PROCESSINGThis attribute provides the Address Type.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.441Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Originator- Address.
Domain- Name RESOURCE_ PRE_ SORTINGThis attribute provides the Domain Name.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.442Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Originator- Address.
IMSI- MCC- MNC RESOURCE_ PRE_ SORTINGThis attribute provides the 3gpp- imsi- mcc- mnc value.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATIONMMS- Information.
Priority SMS_ CALL_ ESTABLISHMENTThis attribute provides the priority of message.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.443Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Read- Reply- Report- Requested RESOURCE_ PRE_ SORTINGThe Read- Reply- Report- Requested indicates whether a read reply report has been requested by the originator MMS user agent or not.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLESMMS- Information.
Recipient- Add.
Address- Type GY_PRE_ PROCESSINGThis attribute provides the Address Type of Recipient- Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.444Charging User Guide Charging rules Attribute name Trigger Description MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Recipient- Add.
Addressee- Type RESOURCE_ PRE_ SORTINGThis attribute provides the Addressee Type information.
MMS- Information.
Recipient- Address.
Address- Data APPLICABILITYThis attribute provides the Address data.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.445Charging User Guide Charging rules Attribute name Trigger Description BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF GY_CREDIT_ REQUEST THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_POST_ PROCESSING CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT DEVICE_ NOT_ FOUNDMMS- Information.
Recipient- Address.
Address- Data.
Length RESOURCE_ PRE_ SORTINGThis attribute provides length of address data.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.446Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING GY_PRE_ PROCESSING CALL_ RULE_ VARIABLES SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT DEVICE_ NOT_ FOUNDMMS- Information.
Recipient- Address.
Address- Data.
Trimmed- Length RESOURCE_ PRE_ SORTINGThis attribute provides the Length of Address Data of Recipient Address of MMS info that has trimmed escape characters.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Recipient- Address.
Domain- Name RESOURCE_ PRE_ SORTINGThis attribute provides the Domain name of Recipient Address.
MMS- Information.
Recipient- Address.
IMSI- MCC- MNC APPLICABILITYThis attribute provides the 3gpp- imsi- mcc- mnc value.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.447Charging User Guide Charging rules Attribute name Trigger Description BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFFMMS- Information.
Reply- Applic- ID THRESHOLDThis attribute provides the Reply Applic id.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.448Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Submission- Time RESOURCE_ PRE_ SORTINGThis attribute provides the Submission Time.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSINGMMS- Information.
Vas- Id MMS_ CALL_ ESTABLISHMENTThis attribute provides Vas Id.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.449Charging User Guide Charging rules Attribute name Trigger Description MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMMS- Information.
Vasp- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Vasp Id.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSINGMNC CALL_ RULE_ VARIABLESThis attribute provides the MNC value from 3GPP- User- Location- Info.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.450Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_PRE_ PROCESSING GY_POST_ PROCESSING THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING Multiple- Services- Credit- Control.
Reporting- ReasonsRATING_ POST_ PROCESSING GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute sets the notification variable of reporting- reasons in case reporting reasons should be included in the notification content.
Multiple- Services- Credit- Control.
Reporting- Reason- ListRATING_ POST_ PROCESSING GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_SESSION_ ESTABLISHMENTThis attribute retrieves all the Reporting- Reasons from MSCC and USU levels.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.451Charging User Guide Charging rules Attribute name Trigger Description GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SLICING_ PROFILE TARIFF UC_PROCESSING CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUNDMultiple- Services- Credit- Control.
Rating- Group RESOURCE_ PRE_ SORTINGThis attribute provides the rating group.
SLICING_ PROFILE Multiple- Services- Credit- Control.
Is- Offline CALL_ RULE_ VARIABLESThis attribute is the flag to indicate whether MSCC is offline or online.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.452Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLES UC_PROCESSING DEVICE_ NOT_ FOUNDMultiple- Services- Credit- Control.
Service- Identifier RESOURCE_ PRE_ SORTINGThis attribute provides the MSCC Service Identifier.
APPLICABILITY TARIFFMultiple- Services- Credit- Control.
Service- Specific- Info COUNTERThis attribute provides the Service Specific info from current MSCC.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.453Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING CALL_ RULE_ VARIABLES BUNDLE THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY TARIFF COUNTER GY_PRE_ PROCESSING CALL_ RULE_ VARIABLES BUNDLE THRESHOLDMultiple- Services- Credit- Control.
Service- Specific- Info.
Service- Specific- Type RESOURCE_ PRE_ SORTINGThis attribute provides the Service Specific type from Current MSCC.
APPLICABILITY TARIFF COUNTER GY_PRE_ PROCESSING CALL_ RULE_ VARIABLES BUNDLE THRESHOLDMultiple- Services- Credit- Control.
Service- Specific- Info.
Service- Specific- Data RESOURCE_ PRE_ SORTINGThis attribute provides the Service Specific data from current MSCC.
GY_CREDIT_ REQUEST Multiple- Services- Credit- Control.
Trigger.
Trigger- Type- List CALL_ RULE_ VARIABLESThis attribute provides the MSCC level Trigger type.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.454Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING GY_POST_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING DEVICE_ NOT_ FOUND SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION RESOURCE_ PRE_ SORTING APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSINGmsTime Zone SMS_ CALL_ ESTABLISHMENTThis attribute provides the MS- Timezone.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.455Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF CALL_ RULE_ VARIABLES THRESHOLDOrigin- Host DEVICE_ NOT_ FOUNDThis attribute provides the origin host.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.456Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING TARIFF THRESHOLD DEVICE_ NOT_ FOUNDRAI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the RAILAC value as string.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING TARIFF THRESHOLD DEVICE_ NOT_ FOUNDRAI.RAC RESOURCE_ PRE_ SORTINGThis attribute provides the RAIRAC value as string.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.457Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDRAT- TYPE RESOURCE_ PRE_ SORTINGThis attribute provides the radio access technology that is serving the UE.
BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSINGRequested- Action MMS_ CALL_ ESTABLISHMENTThis attribute provides the requested action.
For example, DIRECT_ DEBITING, REFUND_ ACCOUNT, CHECK_ BALANCE, PRICE_ ENQUIRY, LOCATION_ UPDATE.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.458Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION IMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSAI.SAC RESOURCE_ PRE_ SORTINGThis attribute provides the SAILAC value as string.
APPLICABILITY BUNDLESAI.SAC CALL_ RULE_ VARIABLESThis attribute provides the SAISAC value as string.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.459Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES UC_PROCESSING DEVICE_ NOT_ FOUNDService- Context- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Session context id.
SMS_ CALL_ ESTABLISHMENT Service- Info.
PS-Information.
GGSN- Address.
Address- Family SMS_ CALL_ TERMINATIONThis attribute provides the GGSN Address Family in PS information of Service Information.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.460Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
SGSN- Address.
Address- Family RESOURCE_ PRE_ SORTINGThis attribute provides the SGSN Address family in PS information of Service Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
GGSN- Address.
Address- Value RESOURCE_ PRE_ SORTINGThis attribute provides the GGSN Address in PS information of Service Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENTService- Info.
PS-Information.
SGSN- Address.
Address- Value MMS_ CALL_ TERMINATIONThis attribute provides the SGSN Address value in PS information of Service Information.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.461Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
PDP- Address.
Address- Value RESOURCE_ PRE_ SORTINGThis attribute provides PDP Address in PS information of Service Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_PRE_ PROCESSING GY_POST_ PROCESSING MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND GY_CREDIT_ REQUEST APPLICABILITYService- Info.
PS-Information.
3GPP- User- Location- Info.
MNC TARIFFThis attribute provides the MNC value from 3GPP- User- Location- Info AVP in PS information of Service Information.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.462Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD BUNDLE COUNTER RESOURCE_ PRE_ SORTING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- User- Location- Info.
SAI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the SAILAC value in PS Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- User- Location- Info.
SAI.SAC RESOURCE_ PRE_ SORTINGThis attribute provides the SAISAC value in PS Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENTService- Info.
PS-Information.
3GPP- User- Location- Info.
ECGI.
ECI MMS_ CALL_ TERMINATIONThis attribute provides the EGIECI value in PS Information.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.463Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- User- Location- Info.
RAI.RAC RESOURCE_ PRE_ SORTINGThis attribute provides the RAIRAC value in PS Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- User- Location- Info.
RAI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the RAILAC value in PS Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- User- Location- Info.
TAI.TAC RESOURCE_ PRE_ SORTINGThis attribute provides the TAITAC value in PS Information.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.464Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- User- Location- Info.
CGI.CI RESOURCE_ PRE_ SORTINGThis attribute provides the CGICI value in PS Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- User- Location- Info.
CGI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the CGILAC value in PS Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_PRE_ PROCESSING GY_POST_ PROCESSINGService- Info.
PS-Information.
3GPP- User- Location- Info.
MCC MMS_ CALL_ TERMINATIONThis attribute provides the MCC value from 3GPP- User- Location- Info AVP in PS information of Service Information.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.465Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND GY_CREDIT_ REQUEST APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER RESOURCE_ PRE_ SORTING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_PRE_ PROCESSING GY_POST_ PROCESSING MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND GY_CREDIT_ REQUEST APPLICABILITY TARIFF THRESHOLDService- Info.
PS-Information.
3GPP- User- Location- Info.
MCCMNC BUNDLEThis attribute provides the MCCMNC value from 3GPP- User- Location- Info AVP in PS information of Service Information.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.466Charging User Guide Charging rules Attribute name Trigger Description COUNTER RESOURCE_ PRE_ SORTING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- GPRS- Negotiated- QoS- Profile RESOURCE_ PRE_ SORTINGThis attribute provides GPRS Negotiated Qos profile in PS information of Service Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
PDP- Address.
Address- Family RESOURCE_ PRE_ SORTINGThis attribute provides the PDP Address family in PS information of Service Information.
SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDService- Info.
PS-Information.
3GPP- Charging- Id RESOURCE_ PRE_ SORTINGThis attribute provides the charging Id.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.467Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDService- Info.
MMTel- Info.
Supp- Service.
MMTel Service- Type RESOURCE_ PRE_ SORTINGThis attribute provides the MMTel Service Type value from MMTel- Information AVP.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSINGService- Info.
MMTel- Info.
Supp- Service.
Number- Of-Participants IMS_ CALL_ ESTABLISHMENTThis attribute provides the Number of Participants.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.468Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ MODIFICATION CALL_ RULE_ VARIABLES IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENTService- Info.
MMTel- Info.
Supp- Service.
Participant- Action- Type CALL_ RULE_ VARIABLESThis attribute provides Participant Action Type.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.469Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDService- Info.
MMTel- Info.
Supp- Service.
Service- Mode RESOURCE_ PRE_ SORTINGThis attribute provides the Service Mode.
Service- Parameter- Value- By-Type APPLICABILITYThis attribute provides the service parameter value.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.470Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING BUNDLE COUNTER GY_CREDIT_ REQUESTSession- Id GY_POST_ PROCESSINGThis attribute provides the Session id.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.471Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES UC_PROCESSING DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES MMS_ CALL_ TERMINATIONsgsn MccMnc DEVICE_ NOT_ FOUNDThis attribute provides the SGSN- MCC- MNC value.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.472Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Client- Address.
Address- Family RESOURCE_ PRE_ SORTINGThis attribute provides the Type of Address.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES SMS_ CALL_ TERMINATION TARIFFSMS- Information.
Client- Address.
Address- Value THRESHOLDThis attribute provides the Address Value part of Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.473Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Data- Coding- Scheme RESOURCE_ PRE_ SORTINGThis attribute provides the Data Coding Scheme.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATIONSMS- Information.
Number- Of-Messages- Sent TARIFFThis attribute provides the number of messages sent.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.474Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Originator- Interface- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Originator Interface id.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATIONSMS- Information.
Originator- Interface- Port CALL_ RULE_ VARIABLESThis attribute provides the Interface port.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.475Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Originator- Interface- Text RESOURCE_ PRE_ SORTINGThis attribute provides the Interface text.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING GY_PRE_ PROCESSINGSMS- Information.
Originator- Interface- Type SMS_ CALL_ ESTABLISHMENTThis attribute provides the Interface Type.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.476Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
Originator- Received- Add.
Address- Data RESOURCE_ PRE_ SORTINGThis attribute provides the Address data of Originator Received Address.
APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLDSMS- Information.
Originator- Received- Add.
Domain- Name BUNDLEThis attribute provides the Domain name in Originator Received Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.477Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
Originator- Received- Add.
Address- Type RESOURCE_ PRE_ SORTINGThis attribute provides the Address Type of Originator Received Address.
APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFFSMS- Information.
Originator- Received- Add.
IMSI- MCC- MNC THRESHOLDThis attribute provides the IMSI- MCC_ MNC value in Originator Received Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.478Charging User Guide Charging rules Attribute name Trigger Description BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Originator- SCCP- Address.
Address- Family RESOURCE_ PRE_ SORTINGThis attribute provides the Type of Address.
APPLICABILITY BUNDLE COUNTERSMS- Information.
Originator- SCCP- Address.
Address- Value GY_CREDIT_ REQUESTThis attribute provides the Address Value of SCCP address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.479Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF GY_CREDIT_ REQUEST THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Addr- Domain.
Domain- Name RESOURCE_ PRE_ SORTINGThis attribute provides the Domain name in Address Domain of Recipient Info.
SMS- Information.
Recipient- Info.
Addr- Domain.
IMSI- MCC- MNC APPLICABILITYThis attribute provides the IMSI- MCC- MNC value in Address Domain of Recipient Info.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.480Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Destination- Interface- Id RESOURCE_ PRE_ SORTINGThis attribute provides the interface port of Destination.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.481Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Destination- Interface- Port RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLDSMS- Information.
Recipient- Info.
Destination- Interface- Text DEVICE_ NOT_ FOUNDThis attribute provides the Interface Text of Destination.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.482Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Destination- Interface- Type RESOURCE_ PRE_ SORTINGThis attribute provides the Destination Interface Type.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFFSMS- Information.
Recipient- Info.
Recipient- Addr.
Addr- Domain.
Domain- Name THRESHOLDThis attribute provides the Domain name in Address Domain.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.483Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Recipient- Addr.
Addr- Domain.
IMSI- MCC- MNC RESOURCE_ PRE_ SORTINGThis attribute provides the IMSI- MCC_ MNC value in Address Domain.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENTSMS- Information.
Recipient- Info.
Recipient- Addr.
Address- Data SMS_ CALL_ TERMINATIONThis attribute provides the Address data of Recipient Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.484Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD GY_CREDIT_ REQUEST DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Recipient- Addr.
Address- Data.
Length RESOURCE_ PRE_ SORTINGThis attribute provides the Length of Address data in Recipient Address.
BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Recipient- Addr.
Address- Data.
Trimmed- Length RESOURCE_ PRE_ SORTINGThis attribute provides the Trimmed Length of Address data in Recipient Address.
APPLICABILITY SMS- Information.
Recipient- Info.
Recipient- Addr.
Address- Type BUNDLEThis attribute provides the Address Type of Recipient Adrress.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.485Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Recipient- Addr.
Addressee- Type RESOURCE_ PRE_ SORTINGThis attribute provides the Address Type in Recipient Received Address.
SMS- Information.
Recipient- Info.
Recipient- Received- Address.
Address- Type APPLICABILITYThis attribute provides the Address Type in Recipient Received Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.486Charging User Guide Charging rules Attribute name Trigger Description COUNTER TARIFF THRESHOLD CALL_ RULE_ VARIABLES BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER TARIFF THRESHOLD CALL_ RULE_ VARIABLES BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATIONSMS- Information.
Recipient- Info.
Recipient- Received- Address.
Address- Data DEVICE_ NOT_ FOUNDThis attribute provides the Address data in Recipient Received Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.487Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER TARIFF THRESHOLD CALL_ RULE_ VARIABLES BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Recipient- Received- Address.
Domain- Name RESOURCE_ PRE_ SORTINGThis attribute provides the Domain name in Recipient Received Address.
APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENTSMS- Information.
Recipient- Info.
Recipient- Received- Address.
IMSI- MCC- MNC SMS_ CALL_ TERMINATIONThis attribute provides the IMSI MCC MNC value in Recipient Received Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.488Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
Recipient- SCCP- Add.
Address- Family RESOURCE_ PRE_ SORTINGThis attribute provides the Address Family value in Recipient SCCP Address.
APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSINGSMS- Information.
Recipient- Info.
Recipient- SCCP- Add.
Address- value SMS_ CALL_ ESTABLISHMENTThis attribute provides the Address value in Recipient SCCP Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.489Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
Recipient- Info.
SM- Protocol- ID RESOURCE_ PRE_ SORTINGThis attribute provides the Sm protocol Id.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENTSMS- Information.
Reply- Path- Requested SMS_ CALL_ TERMINATIONThis attribute provides the Reply Path requested.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.490Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
SM-Device- Trigger- Indicator RESOURCE_ PRE_ SORTINGThis attribute provides the Sm Device Trigger Indicator.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSINGSMS- Information.
SM-Device Trigger Info.
Application- Port- Identifier SMS_ CALL_ ESTABLISHMENTThis attribute provides the Application Port Idenitifier.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.491Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
SM-Device Trigger Info.
Mtc- Iwf-Address.
Address- Family RESOURCE_ PRE_ SORTINGThis attribute provides the Address Type, for example, IP, IP6, NSAP, HDLC.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSINGSMS- Information.
SM-Device Trigger Info.
Mtc- Iwf-Address.
Address- Value GY_PRE_ PROCESSINGThis attribute provides the Address value.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.492Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
SM-Device Trigger Info.
Priority- Indication RESOURCE_ PRE_ SORTINGThis attribute provides the Type of priority Indication.
APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTERSMS- Information.
SM-Device Trigger Info.
Reference- Number GY_POST_ PROCESSINGThis attribute provides the Reference number.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.493Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
SM-Device Trigger Info.
Validity- Time RESOURCE_ PRE_ SORTINGThis attribute provides the Validity Time.
APPLICABILITY BUNDLE COUNTERSMS- Information.
SM-Discharge- Time GY_POST_ PROCESSINGThis attribute provides the Sm Discharge time.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.494Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
SM-Message- Type RESOURCE_ PRE_ SORTINGThis attribute provides the Sm Message Type.
APPLICABILITY BUNDLESMS- Information.
SM-Protocol- ID CALL_ RULE_ VARIABLESThis attribute provides the Sm protocol Id.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.495Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
SM-Sequence- Number RESOURCE_ PRE_ SORTINGThis attribute provides the Sm Sequence Number in SMS Information.
APPLICABILITY SMS- Information.
SM-Service- Type COUNTERThis attribute provides the Sm Service Type.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.496Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
SM-Status RESOURCE_ PRE_ SORTINGThis attribute provides the Sm Status.
SMS- Information.
SM-User- Data- Header APPLICABILITYThis attribute provides the Sm User Data Header.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.497Charging User Guide Charging rules Attribute name Trigger Description BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLES SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
SMS- Node RESOURCE_ PRE_ SORTINGThis attribute provides the Type of SMS Node information.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.498Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY COUNTER CALL_ RULE_ VARIABLES TARIFF THRESHOLD BUNDLE GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
SMS- Result RESOURCE_ PRE_ SORTINGThis attribute provides the Sms Result in SMS Information.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSMS- Information.
SMSC- Address.
Address- Family DEVICE_ NOT_ FOUNDThis attribute provides the Address Type of SMSC Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.499Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING CALL_ RULE_ VARIABLES SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD DEVICE_ NOT_ FOUNDSMS- Information.
SMSC- Address.
Address- Value RESOURCE_ PRE_ SORTINGThis attribute provides the Address Value of SMSC address.
GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING CALL_ RULE_ VARIABLES IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATIONStarts- With RATING_ POST_ PROCESSINGThis attribute returns true or false depending on whether the value starts with the defined numbers or not.
Usage example: GY_MESSAGE.Starts-With ( " Value_To_Check_STRING", " Starting_Value_STRING" ) = trueTable 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.500Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDSubscription- Id-Data RESOURCE_ PRE_ SORTINGThis attribute provides the subscription id.
Subscription- Id-Data- By-Type APPLICABILITYThis attribute provides the subscription Id by type.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.501Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD BUNDLE COUNTER SLICING_ PROFILE GY_PRE_ PROCESSING GY_POST_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING CALL_ RULE_ VARIABLES RESOURCE_ POST_ PROCESSING DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING Subscription- Id-Type APPLICABILITYThis attribute provides the subscription id.
For example, E164, IMSI, NAI, SIP URI, PRIVATE, EXTERNALID.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.502Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSINGTAI.TAC GY_PRE_ PROCESSINGThis attribute provides the TAITAC value as string.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.503Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY TARIFF CALL_ RULE_ VARIABLES THRESHOLD BUNDLE COUNTER GY_PRE_ PROCESSING GY_POST_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDMMS- Information.
Recipient- Address- List.
Address- Data RESOURCE_ PRE_ SORTINGThis attribute provides the Address Data in Recipient address.
APPLICABILITY TARIFF CALL_ RULE_ VARIABLES THRESHOLDMMS- Information.
Recipient- Address- List.
Address- Data.
Size BUNDLEThis attribute provides the Size of address data in the Recipient Address.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.504Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_PRE_ PROCESSING GY_POST_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING APPLICABILITY TARIFF THRESHOLD BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUNDSMS- Information.
Converted- Originator- Interface- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Interface id.
APPLICABILITY SMS- Information.
Recipient- Info.
Converted- Destination- Interface- Id TARIFFThis attribute provides the Destination interface id.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.505Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES THRESHOLD BUNDLE COUNTER GY_PRE_ PROCESSING GY_POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDUncorrelated- Session RESOURCE_ PRE_ SORTINGThis attribute checks if Uncorrelated Session is on CCRU/ CCRT.
IMS_ CALL_ ESTABLISHMENT GY_PRE_ PROCESSINGUnix- Timestamp UC_PROCESSINGThis attribute provides the Timestamp when notification was generated.
IMS_ CALL_ ESTABLISHMENT GY_PRE_ PROCESSINGUnix- Timestamp- Ms UC_PROCESSINGThis attribute provides the timestamp when notification was generated in milliseconds.
APPLICABILITY BUNDLEUser- Equipment- Info- Value.
IMEISV.
TAC- String COUNTERThis attribute provides the value of User Equipment Info.Table 44: GY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.506Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING GY_PRE_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGTable 44: GY_MESSAGE source context (continued) The Service-Specific-Data and Service-Specific-Type are delimited by “,” and each Service-Specific-Info is delimited by “;”.
Hence, the final Service-Specific-Info is in the following format: Service-Specific-Data1,Service-Specific-Type1;Service-Specific-Data2,Service- Specific-Type2; For example, the first Service-Specific-Info is [data:”ssd1”,type:123] and second Service-Specific- Info is [data:”ssd2”,type:456], then the result of Multiple-Services-Credit-Control-Service-Info is 123,ssd1;456,ssd2; msTimezone and sgsnMccMnc variables Following tables provide information on the value of msTimezone and sgsnMccMnc variables for various combinations of the Store location updates, Use stored location updates (IMS), and Re-Rating on Location updates (IMS) application preferences for Gy calls.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.507Charging User Guide Charging rules Store location updatesUse stored location updates ( IMS)Re-Rating on Location updates ( IMS)Value of ms Timezone and sgsn MccMnc variables false false false Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC in Ps Information false false true Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC in Ps Information false true false In CCR- I, the Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC is considered, where as, in CCR- U, the value stored in session ( of CCRI- I) of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC is considered.
false true true In CCR- I and CCRU both Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC is considered.
true false false Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC in Ps Information true false true Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC in Ps Information true true false The value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC stored in Device is preferred.
If there is no Gy call executed before IMS call, then, in CCR- I, Network AVP value of 3GPP- MS- Time Zone and 3GPP- SGSN- MCC- MNC is considered, where as, in CCR- U, the value stored in session ( of CCRI- I) of 3GPP- MS- Time Zone and 3GPP- SGSN- MCC- MNC is considered.
true true true Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC in Ps InformationTable 45: msTimezone and sgsnMccMnc variable output for Gy calls Extracting TAC from User-Equipment-Info-Value The User-Equipment-Info-Value AVP is received at command level from network as a hexadecimal value.
This has to be converted to ASCII and then the first 8 digits of the ASCII is extracted as the Type Allocation Code (TAC).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.508Charging User Guide Charging rules Example for User-Equipment-Info-Value AVP: <avp name="User-Equipment-Info-Value" value="0x38363630383930313733323831303034"></avp> The value needs to be converted as follows: AVP Value in HEX38 36 36 30 38 39 30 31 37 33 32 38 31 30 30 34 Converted to Decimal56 54 54 48 56 57 48 49 55 51 50 56 49 48 48 52 Converted to Ascii8 6 6 0 8 9 0 1 7 3 2 8 1 0 0 4 TAC String (First 8 digits)8 6 6 0 8 9 0 1 The TAC value is 86608901 .
4.6.
10 CONVERSION source context Attribute name Trigger Description Boolean- To-Enum All triggersThis attribute returns the native boolean as an enum.
Date- Time- String- To-Date- Time All triggersThis attribute converts the string containing a date and time, to time Value Generator value containing time and timezone.
Double- To-String All triggersThis attribute takes double value as input and returns string value as output.
Enum- To-Boolean All triggersThis attribute returns a native boolean from given boolean ( represented as an enum) .
Length- Of-String All triggersThis attribute returns the length of the string at the current read index.Table 46: CONVERSION source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.509Charging User Guide Charging rules Attribute name Trigger Description Match- Regular- Expression All triggersThis attribute matches a regular expression, and returns the first matching group.
String- To-Double All triggers This attribute converts String to Double.
String- To-Integer All triggers This attribute converts String to Integer.
String- To-List- Of-Strings All triggersThis attribute takes a string, split it' s content using the defined delimiter and populate a list of strings.
String- To-Long All triggers This attribute converts String to Long.
Round- Down All triggers This attribute converts Decimal to Long.
Substring- Of-String All triggersThis attribute returns a substring of the given string, from the specified start index up to but not including the end index.
In case of an invalid value or index being specified, a null value is returned.
Indices are zero- based, hence valid indices are 0 to string.
length( ) - 1.Table 46: CONVERSION source context (continued) 4.6.
11 GY_POSTPROCESSING source context Attribute name Trigger Description Result_ Code GY_POST_ PROCESSING This attribute is reserved for future use.
Is-ReRate- ME-Configured GY_POST_ PROCESSING This attribute is reserved for future use.Table 47: GY_POSTPROCESSING source context 4.6.
12 IMS_SERVICE_INFO source context Note : See msTimezone and sgsnMccMnc variables on page 578 for output of the IMS_SERVICE_INFO msTimeZone and sgsnMccMnc variables based on the values set in Store location updates , Use stored location updates , and Re-Rating on Location updates application preferences.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.510Charging User Guide Charging rules Attribute name Trigger APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDAccess- Network- Information RESOURCE_ PRE_ SORTINGThis attribute provides the Access- Network- Information value from the IMS- Information.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLESAccess- Network- Information- Full RESOURCE_ PRE_ SORTINGThis attribute provides the entire value of the Access Network Information.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLESAccess- Network- Information.
Geo- Loc- Type RESOURCE_ PRE_ SORTINGThis attribute provides the ANI Geography Location Type.
BUNDLE COUNTERAccess- Transfer- Information.
Access- Network- Information IMS_ CALL_ ESTABLISHMENTThis attribute provides the Access- Transfer- Information.
Access- Network- Information value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.511Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDAccess- Transfer- Information.
Access- Transfer- Type RESOURCE_ PRE_ SORTINGThis attribute provides the Access- Transfer- Information.
Access- Transfer- Type value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTINGAccess- Transfer- Information.
Cellular- Network- Information TARIFFThis attribute provides the Access- Transfer- Information.
Cellular- Network- Information value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.512Charging User Guide Charging rules Attribute name Trigger THRESHOLD APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDAccess- Transfer- Information.
Change- Time RESOURCE_ PRE_ SORTINGThis attribute provides the Access- Transfer- Information.
Change- Time value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDAccess- Transfer- Information.
Instance- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Access- Transfer- Information.
Instance- Id value from the IMS- Information.
APPLICABILITY Access- Transfer- Information.
Inter- UE-Transfer BUNDLEThis attribute provides the Access- Transfer- Information.
Inter- UE-Transfer value from the IMS- Infromation.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.513Charging User Guide Charging rules Attribute name Trigger COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDAccess- Transfer- Information.
Related- IMS- Charging- Identifier RESOURCE_ PRE_ SORTINGThis attribute provides the Access- Transfer- Information.
Related- IMS- Charging- Identifier value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENTAccess- Transfer- Information.
Related- IMS- Charging- Identifier- Node.
Address- Family IMS_ CALL_ MODIFICATIONThis attribute provides the Access- Transfer- Information.
Related- IMS- Charging- Identifier- Node.
Address- Family value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.514Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDAccess- Transfer- Information.
Related- IMS- Charging- Identifier- Node.
Value RESOURCE_ PRE_ SORTINGThis attribute provides the Access- Transfer- Information.
Related- IMS- Charging- Identifier- Node.
Value value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLESAccess- Transfer- Information.
User- Equipment- Info.
User- Equipment- Info- Type TARIFFThis attribute provides the Access- Transfer- Information.
User- Equipment- Info.
User- Equipment- Info- Type value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.515Charging User Guide Charging rules Attribute name Trigger THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDAccess- Transfer- Information.
User- Equipment- Info.
User- Equipment- Info- Value RESOURCE_ PRE_ SORTINGThis attribute provides the Access- Transfer- Information.
User- Equipment- Info.
User- Equipment- Info- Value value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDAccount- Expiration RESOURCE_ PRE_ SORTINGThis attribute provides the Account- Expiration value from the IMS- Information.
Alternate- Charged- Party- Address APPLICABILITY This attribute provides the Alternate- Charged- Party- Address value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.516Charging User Guide Charging rules Attribute name Trigger BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDApplication- Server- Information.
Application- Provided- Called- Party- Address RESOURCE_ PRE_ SORTINGThis attribute provides the Called Party Address values from the IMS information.
APPLICABILITY BUNDLE COUNTERApplication- Server- Information.
Application- Server IMS_ CALL_ ESTABLISHMENTThis attribute provides the Application- Server- Information.
Application- Server value from the IMS information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.517Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDApplication- Server- Information.
Status- AS- Code RESOURCE_ PRE_ SORTINGThis attribute provides the Application- Server- Information.
Status- AS-Code value from the IMS information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONAssociated- URI CALL_ RULE_ VARIABLESThis attribute provides the Associated- URI value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.518Charging User Guide Charging rules Attribute name Trigger TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDBearer- Service RESOURCE_ PRE_ SORTINGThis attribute provides the Bearer- Service value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDCalled- Asserted- Identity RESOURCE_ PRE_ SORTINGThis attribute provides the Called- Asserted- Identity value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.519Charging User Guide Charging rules Attribute name Trigger APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDCalled- Identity- Change.
Called- Identity RESOURCE_ PRE_ SORTINGThis attribute provides the Called- Identity- Change.
Called- Identity value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDCalled- Identity- Change.
Change- Time RESOURCE_ PRE_ SORTINGThis attribute provides the Called- Identity- Change.
Change- Time value from the IMS- Information.
APPLICABILITY BUNDLECalled- Party- Address COUNTERThis attribute provides the Called Party Address values from IMS information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.520Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RATING_ POST_ PROCESSING GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTING BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLESCalled- Party- Address- Length RESOURCE_ PRE_ SORTINGThis attribute provides the Length of Called Party Address value from the IMS information.
BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT CALL_ RULE_ VARIABLESCalled- Party- Address- Trimmed- Length RESOURCE_ PRE_ SORTINGThis attribute provides the Length of Called Party Address value after Trimming Escape Characters from the IMS information.
APPLICABILITY BUNDLE COUNTERCalled- Party- CC IMS_ CALL_ ESTABLISHMENTThis attribute provides the Called Party Country Code.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.521Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDCalling- Party- Address RESOURCE_ PRE_ SORTINGThis attribute provides the Calling Party Address value from the IMS information.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION APPLICABILITY TARIFFCarrier- Identification- Code THRESHOLDThis attribute extracts the carrier identification code from the Carrier- Select- Routing- Information AVP.
The first four digits of Carrier- Select- Routing- Information AVP constitute the carrier identification code.
For example: Carrier- Select- Routing- Information = 0010; cic-context= +1.
Carrier identification code extracted is 0010 ( first four digits of the AVP) .Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.522Charging User Guide Charging rules Attribute name Trigger BUNDLE GY_PRE_ PROCESSING RATING_ POST_ PROCESSING GY_POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDCarrier- Select- Routing- Information RESOURCE_ PRE_ SORTINGThis attribute provides the Carrier- Select- Routing- Information value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONCause- Code IMS_ CALL_ TERMINATIONThis attribute provides the Cause- Code value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.523Charging User Guide Charging rules Attribute name Trigger CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDCellular- Network- Information RESOURCE_ PRE_ SORTINGThis attribute provides the Cellular- Network- Information value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFFCGI.CI THRESHOLDThis attribute provides the Cell identifier( CI) of a CGI.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.524Charging User Guide Charging rules Attribute name Trigger RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDCGI.LAC RESOURCE_ PRE_ SORTINGThis attribute provides the Location Area Code (LAC) of CGI.
APPLICABILITY BUNDLE COUNTER TARIFF RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLESDirectory- Assistance RESOURCE_ PRE_ SORTINGThis attribute provides the Type of Directory Assistance.
APPLICABILITY BUNDLE COUNTEREarly- Media- Description.
SDP- Media- Component.
3GPP- Charging- Id IMS_ CALL_ ESTABLISHMENTThis attribute provides the Early- Media- Description.
SDP- Media- Component.
3GPP- Charging- Id value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.525Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEarly- Media- Description.
SDP- Media- Component.
Access- Network- Charging- Identifier- Value RESOURCE_ PRE_ SORTINGThis attribute provides the Early- Media- Description.
SDP- Media- Component.
Access- Network- Charging- Identifier- Value value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONEarly- Media- Description.
SDP- Media- Component.
IP-Realm- Default- Indication CALL_ RULE_ VARIABLESThis attribute provides the Early- Media- Description.
SDP- Media- Component.
IP- Realm- Default- Indication value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.526Charging User Guide Charging rules Attribute name Trigger TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEarly- Media- Description.
SDP- Media- Component.
Media- Initiator- Flag RESOURCE_ PRE_ SORTINGThis attribute provides the SDP- Media- Component.
Media- Initiator- Flag value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEarly- Media- Description.
SDP- Media- Component.
Media- Initiator- Party RESOURCE_ PRE_ SORTINGThis attribute provides the Early- Media- Description.
SDP- Media- Component.
Media- Initiator- Party value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.527Charging User Guide Charging rules Attribute name Trigger APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEarly- Media- Description.
SDP- Media- Component.
SDP- Type RESOURCE_ PRE_ SORTINGThis attribute provides the Early- Media- Description.
SDP- Media- Component.
SDP- Type value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEarly- Media- Description.
SDP- Media- Component.
Transcoder- Inserted- Indication RESOURCE_ PRE_ SORTINGThis attribute provides the Early- Media- Description.
SDP- Media- Component.
Transcoder- Inserted- Indication value from the IMS- Information.
APPLICABILITY BUNDLEEarly- Media- Description.
SDP- Media- Component.
Local- GW- Inserted- Indication COUNTERThis attribute provides the Early- Media- Description SDP- Media- Component.
Local- GW- Inserted- Indication value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.528Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEarly- Media- Description.
SDP- Media- Component.
SDP- Media- Description RESOURCE_ PRE_ SORTINGThis attribute provides the Early- Media- Description.
SDP- Media- Component.
SDP- Media- Description value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONEarly- Media- Description.
SDP- Media- Component.
SDP- Media- Name IMS_ CALL_ TERMINATIONThis attribute provides the SDP- Media- Component.
SDP- Media- Name value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.529Charging User Guide Charging rules Attribute name Trigger CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEarly- Media- Description.
SDP- Time Stamps.
SDP- Answer- Timestamp RESOURCE_ PRE_ SORTINGThis attribute provides the Early- Media- Description.
SDP- Time Stamps.
SDP- Answer- Timestamp value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFFEarly- Media- Description.
SDP- Time Stamps.
SDP- Offer- Timestamp THRESHOLDThis attribute provides the Early- Media- Description.
SDP- Time Stamps.
SDP- Offer- Timestamp value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.530Charging User Guide Charging rules Attribute name Trigger RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEarly- Media- Description.
SDP- Session- Description RESOURCE_ PRE_ SORTINGThis attribute provides the Early- Media- Description.
SDP- Session- Description value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEvent- Type.
Event RESOURCE_ PRE_ SORTINGThis attribute provides the event header value from the IMS Information.
APPLICABILITY Event- Type.
Expires BUNDLEThis attribute provides the expire header value from the IMS information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.531Charging User Guide Charging rules Attribute name Trigger COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDEvent- Type.
SIP-Method RESOURCE_ PRE_ SORTINGThis attribute provides the name of the SIP Method, for example, INVITE, UPDATE.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENTFrom- Address IMS_ CALL_ MODIFICATIONThis attribute provides the From- Address value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.532Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDHSPA.
LAC RESOURCE_ PRE_ SORTINGThis attribute provides the LAC value from the Access- Network- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLESHSPA.
SAC TARIFFThis attribute provides the SAC value from the Access- Network- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.533Charging User Guide Charging rules Attribute name Trigger THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDIMS- Application- Reference- Identifier RESOURCE_ PRE_ SORTINGThis attribute provides the IMS- Application- Reference- Identifier value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDIMS- Charging- Identifier RESOURCE_ PRE_ SORTINGThis attribute provides the IMS- Charging- Identifier value from the IMS- Information.
IMS- Communication- Service- Identifier APPLICABILITY This attribute provides the IMS- Communication- Service- Identifier value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.534Charging User Guide Charging rules Attribute name Trigger BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLESIMS- Emergency- Indicator RESOURCE_ PRE_ SORTINGThis attribute provides the IMS- Emergency- Indicator value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONIMS- Visited- Network- Identifier CALL_ RULE_ VARIABLESThis attribute provides the IMS- Visited- Network- Identifier value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.535Charging User Guide Charging rules Attribute name Trigger TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDInitial- IMS- Charging- Identifier RESOURCE_ PRE_ SORTINGThis attribute provides the Initial- IMS- Charging- Identifier value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDInstance- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Instance- Id value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.536Charging User Guide Charging rules Attribute name Trigger APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDInter- Operator- Identifier.
Originating- IOI RESOURCE_ PRE_ SORTINGThis attribute provides the Inter- Operator- Identifier.
Originating- IOI value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDInter- Operator- Identifier.
Terminating- IOI RESOURCE_ PRE_ SORTINGThis attribute provides the Inter- Operator- Identifier.
Terminating- IOI value from the IMS- Information.
APPLICABILITY BUNDLEIs-OnNet COUNTERThis attribute checks if it is onnet call or not.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.537Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDIs-OnNet- Explicit- Check RESOURCE_ PRE_ SORTINGThis attribute validates if the call flow is onnet or not.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST IMS_ CALL_ ESTABLISHMENTMCC IMS_ CALL_ MODIFICATIONThis attribute provides the MCC value from the Access- Network- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.538Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_PRE_ PROCESSING GY_POST_ PROCESSING CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_PRE_ PROCESSING GY_POST_ PROCESSING TARIFFMCCMNC THRESHOLDThis attribute provides the MCCMNC value from the Access- Network- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.539Charging User Guide Charging rules Attribute name Trigger RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDMessage- Body.
Content- Disposition RESOURCE_ PRE_ SORTINGThis attribute provides the Message- Body.
Content- Disposition value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDMessage- Body.
Content- Length RESOURCE_ PRE_ SORTINGThis attribute provides the Message- Body.
Content- Lengthvalue from the IMS- Information.
APPLICABILITY Message- Body.
Content- Type BUNDLEThis attribute provides the Message- Body.
Content- Type value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.540Charging User Guide Charging rules Attribute name Trigger COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDMessage- Body.
Originator RESOURCE_ PRE_ SORTINGThis attribute provides the Message- Body.
Originator value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUESTMNC IMS_ CALL_ ESTABLISHMENTThis attribute provides the MNC value from the Access- Network- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.541Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING GY_PRE_ PROCESSING GY_POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES BUNDLE COUNTER APPLICABILITY TARIFF THRESHOLD DEVICE_ NOT_ FOUND GY_CREDIT_ REQUESTmsTime Zone RESOURCE_ PRE_ SORTINGThis attribute provides the MS- Time Zone.
NNI- Information.
Neighbour- Node- Address.
Address- FamilyAPPLICABILITY This attribute provides the NNI- Information.
Neighbour- Node- Address.
Address- Family value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.542Charging User Guide Charging rules Attribute name Trigger BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDNNI- Information.
Neighbour- Node- Address.
Value RESOURCE_ PRE_ SORTINGThis attribute provides the NNI- Information.
Neighbour- Node- Address.
Value value from the IMS- Information.
APPLICABILITY BUNDLE COUNTERNNI- Information.
NNI- Type IMS_ CALL_ ESTABLISHMENTThis attribute provides the NNI- Information.
NNI- Type value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.543Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDNNI- Information.
Relationship- Mode RESOURCE_ PRE_ SORTINGThis attribute provides the NNI- Information.
Relationship- Mode value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONNNI- Information.
Session- Direction CALL_ RULE_ VARIABLESThis attribute provides the NNI- Information.
Session- Direction value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.544Charging User Guide Charging rules Attribute name Trigger TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDNode- Functionality RESOURCE_ PRE_ SORTINGThis attribute provides the functionality identifier of the node such as S- CSCF, P- CSCF.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDNumber- Portability- Routing- Information RESOURCE_ PRE_ SORTINGThis attribute provides the Number- Portability- Routing- Information value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.545Charging User Guide Charging rules Attribute name Trigger APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDOnline- Charging- Flag RESOURCE_ PRE_ SORTINGThis attribute provides the Online- Charging- Flag value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDOutgoing- Session- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Outgoing- Session- Id AVP value from the IMS information.
APPLICABILITY BUNDLERAT- TYPE COUNTERThis attribute provides the RAT- TYPE value from the Access- Network- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.546Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT DEVICE_ NOT_ FOUND MMS_ CALL_ TERMINATION RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Currency- Code RESOURCE_ PRE_ SORTINGThis attribute provides the Currency code from the current tariff.
Real- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Scale- Factor.
Value- DigitsIMS_ CALL_ ESTABLISHMENT This attribute provides the Scale factor' s value digits from the current tariff.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.547Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Scale- Factor.
Exponent RESOURCE_ PRE_ SORTINGThis attribute provides the Scale factor' s exponent from the current tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Rate- Element.
CC- Unit- Type CALL_ RULE_ VARIABLESThis attribute provides the Rate element' s cc unit type from the current tariff.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.548Charging User Guide Charging rules Attribute name Trigger APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Rate- Element.
Charge- Reason- Code RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s charge reason from the current tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFFReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Rate- Element.
Unit- Value.
Value- Digits THRESHOLDThis attribute provides the Rate element' s value digits from the current tariff.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.549Charging User Guide Charging rules Attribute name Trigger BUNDLE COUNTER RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Rate- Element.
Unit- Value.
Exponent RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s exponent from the current tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Rate- Element.
Unit- Cost.
Value- Digits RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s unit cost value digits from the current tariff.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.550Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Rate- Element.
Unit- Cost.
Exponent RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s unit cost exponent from the current tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Current- Tariff.
Rate- Element.
Unit- Quota- Threshold RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s unit quota THRESHOLD from the current tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONReal- Time- Tariff- Information.
Tariff- Information.
Tariff- Time- Change IMS_ CALL_ TERMINATIONThis attribute provides the Tariff time change from the tariff information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.551Charging User Guide Charging rules Attribute name Trigger CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Currency- Code RESOURCE_ PRE_ SORTINGThis attribute provides the Currency Code from the next tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITYReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Scale- Factor.
Value- Digits TARIFFThis attribute provides the Scale factor' s value digits from the next tariff.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.552Charging User Guide Charging rules Attribute name Trigger THRESHOLD BUNDLE COUNTER RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Scale- Factor.
Exponent RESOURCE_ PRE_ SORTINGThis attribute provides the Scale factor' s exponent from the next tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLEReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Rate- Element.
CC-Unit- Type COUNTERThis attribute provides the Rate element' s cc unit type from the next tariff.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.553Charging User Guide Charging rules Attribute name Trigger RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Rate- Element.
Charge- Reason- Code RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s charge reason from the next tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Rate- Element.
Unit- Value.
Value- Digits RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s value digits from the next tariff.
IMS_ CALL_ ESTABLISHMENT Real- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Rate- Element.
Unit- Value.
Exponent IMS_ CALL_ MODIFICATIONThis attribute provides the Rate element' s exponent from the next tariff.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.554Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTER RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Rate- Element.
Unit- Cost.
Value- Digits RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s unit cost value digits from the next tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLESReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Rate- Element.
Unit- Cost.
Exponent APPLICABILITYThis attribute will provide Rate element' s unit cost exponent from next tariff.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.555Charging User Guide Charging rules Attribute name Trigger TARIFF THRESHOLD BUNDLE COUNTER RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReal- Time- Tariff- Information.
Tariff- Information.
Next- Tariff.
Rate- Element.
Unit- Quota- Threshold RESOURCE_ PRE_ SORTINGThis attribute provides the Rate element' s unit cost THRESHOLD from the next tariff.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLDReal- Time- Tariff- Information.
Tariff- XML BUNDLEThis attribute provides an XML for the real- time tariff information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.556Charging User Guide Charging rules Attribute name Trigger COUNTER RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDReason- Header RESOURCE_ PRE_ SORTINGThis attribute provides the Reason- Header value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDRelated- IMS- Charging- Identifier RESOURCE_ PRE_ SORTINGThis attribute provides the Related- IMS- Charging- Identifier value from the IMS- Information.
Related- IMS- Charging- Identifier- Node.
Address- FamilyAPPLICABILITY This attribute provides the Related- IMS- Charging- Identifier- Node.
Address- Family value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.557Charging User Guide Charging rules Attribute name Trigger BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDRelated- IMS- Charging- Identifier- Node.
Value RESOURCE_ PRE_ SORTINGThis attribute provides the Related- IMS- Charging- Identifier- Node.
Value value from the IMS- Information.
APPLICABILITY BUNDLE COUNTERRequested- Party- Address IMS_ CALL_ ESTABLISHMENTThis attribute provides the Requested- Party- Address value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.558Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD GY_PRE_ PROCESSINGRole- Of-Node RESOURCE_ PRE_ SORTINGThis attribute indicates whether the IMS node (except the MRFC) is serving the calling, the called or a forwarding party.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENTRoute- Header- Received IMS_ CALL_ MODIFICATIONThis attribute provides the Route- Header- Received value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.559Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDRoute- Header- Transmitted RESOURCE_ PRE_ SORTINGThis attribute provides the Route- Header- Transmitted value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLESSAI.LAC TARIFFThis attribute provides the Location Area Code (LAC) of an SAI.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.560Charging User Guide Charging rules Attribute name Trigger THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSAI.SAC RESOURCE_ PRE_ SORTINGThis attribute provides the Service Area Code ( SAC) of an SAI.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSDP- Media- Component.
3GPP- Charging- Id RESOURCE_ PRE_ SORTINGThis attribute provides the SDP- Media- Component.
3GPP- Charging- Id value from the IMS- Information.
SDP- Media- Component.
Access- Network- Charging- Identifier- ValueAPPLICABILITY This attribute will provide SDP- Media- Component.
Access- Network- Charging- Identifier- Value value from IMS Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.561Charging User Guide Charging rules Attribute name Trigger BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSDP- Media- Component.
IP-Realm- Default- Indication RESOURCE_ PRE_ SORTINGThis attribute provides the SDP- Media- Component.
IP-Realm- Default- Indication value from the IMS- Infromation.
APPLICABILITY BUNDLE COUNTERSDP- Media- Component.
Local- GW- Inserted- Indication IMS_ CALL_ ESTABLISHMENTThis attribute provides the SDP- Media- Component.
Local- GW- Inserted- Indication value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.562Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSDP- Media- Component.
Media- Initiator- Flag RESOURCE_ PRE_ SORTINGThis attribute provides the SDP- Media- Component.
Media- Initiator- Flag value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONSDP- Media- Component.
Media- Initiator- Party CALL_ RULE_ VARIABLESThis attribute provides the SDP- Media- Component.
Media- Initiator- Party value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.563Charging User Guide Charging rules Attribute name Trigger TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSDP- Media- Component.
SDP- Media- Description RESOURCE_ PRE_ SORTINGThis attribute provides the SDP- Media- Component.
SDP- Media- Description value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSDP- Media- Component.
SDP- Type RESOURCE_ PRE_ SORTINGThis attribute provides the SDP- Media- Component.
SDP- Type value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.564Charging User Guide Charging rules Attribute name Trigger APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSDP- Media- Component.
Transcoder- Inserted- Indication RESOURCE_ PRE_ SORTINGThis attribute provides the SDP- Media- Component.
Transcoder- Inserted- Indication value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSDP- Session- Description RESOURCE_ PRE_ SORTINGThis attribute provides the SDP- Session- Description value from the IMS- Information.
Service- Specific- Info- List.
Get- Service- Specific- DataIMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGThis attribute provides the value of service- specific- data according to the service- specific- type.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.565Charging User Guide Charging rules Attribute name Trigger APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDServed- Party- IP-Address.
Address- Family RESOURCE_ PRE_ SORTINGThis attribute provides the Served- Party- IP- Address.
Address- Family value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDServed- Party- IP-Address.
Value RESOURCE_ PRE_ SORTINGThis attribute provides the Served- Party- IP- Address.
Value value from the IMS- Information.
APPLICABILITY BUNDLEServer- Capabilities.
Mandatory- Capabilities COUNTERThis attribute provides the Server- Capabilities.
Mandatory- Capabilities value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.566Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDServer- Capabilities.
Optional- Capabilities RESOURCE_ PRE_ SORTINGThis attribute provides the Server- Capabilities.
Optional- Capabilities value from the IMS- Information.
BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONServer- Capabilities.
Server- Name CALL_ RULE_ VARIABLESThis attribute provides the Server- Capabilities.
Server- Name value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.567Charging User Guide Charging rules Attribute name Trigger RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDService- Id RESOURCE_ PRE_ SORTINGThis attribute provides the Service- Id value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD GY_POST_ PROCESSING RATING_ POST_ PROCESSINGService- Specific- Info RESOURCE_ POST_ PROCESSING This attribute provides the concatenated string of all values of the Service- Specific- Info.
Service- Specific- Type and Service- Specific- Info.
Service- Specific- Data.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.568Charging User Guide Charging rules Attribute name Trigger RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGService- Specific- Info.
Service- Specific- Data RESOURCE_ PRE_ SORTINGThis attribute provides the Service- Specific- Info.
Service- Specific- Data value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFFService- Specific- Info.
Service- Specific- Type THRESHOLDThis attribute provides the Service- Specific- Info.
Service- Specific- Type value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.569Charging User Guide Charging rules Attribute name Trigger GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDSession- Priority RESOURCE_ PRE_ SORTINGThis attribute provides the Session Priority value from the IMS information.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES BUNDLE COUNTER APPLICABILITY TARIFFsgsn MccMnc THRESHOLDThis attribute provides the SGSN- MCC- MNC.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.570Charging User Guide Charging rules Attribute name Trigger DEVICE_ NOT_ FOUND GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTING APPLICABILITY IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDTAD- Identifier RESOURCE_ PRE_ SORTINGThis attribute provides the TAD- Identifier value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDTAI.ECI RESOURCE_ PRE_ SORTINGThis attribute provides the E- UTRAN cell identifier ( ECI) value from the Access Network information.
APPLICABILITY TAI.TAC BUNDLEThis attribute provides the Tracking area code ( TAC) of a TAI.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.571Charging User Guide Charging rules Attribute name Trigger COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDTime- Stamps.
SIP-Request- Timestamp RESOURCE_ PRE_ SORTINGThis attribute provides the Time- Stamps.
SIP-Request- Timestamp value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENTTime- Stamps.
SIP-Request- Timestamp- Fraction IMS_ CALL_ MODIFICATIONThis attribute provides the Time- Stamps.
SIP- Request- Timestamp- Fraction value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.572Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDTime- Stamps.
SIP-Response- Timestamp RESOURCE_ PRE_ SORTINGThis attribute provides the Time- Stamps.
SIP- Response- Timestamp value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLESTime- Stamps.
SIP-Response- Timestamp- Fraction TARIFFThis attribute provides the Time- Stamps.
SIP- Response- Timestamp- Fraction value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.573Charging User Guide Charging rules Attribute name Trigger THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDTransit- IOI-List RESOURCE_ PRE_ SORTINGThis attribute provides the Transit- IOI-List value from the IMS- Information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDTrunk- Group- ID.Incoming- Trunk- Group- ID RESOURCE_ PRE_ SORTINGThis attribute provides the Trunk- Group- ID.
Incoming- Trunk- Group- ID value from the IMS- Information.
Trunk- Group- ID.Outgoing- Trunk- Group- ID APPLICABILITY This attribute provides the Trunk- Group- ID.
Outgoing- Trunk- Group- ID value from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.574Charging User Guide Charging rules Attribute name Trigger BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLDUCGI.
CI RESOURCE_ PRE_ SORTINGThis attribute provides the CI value from the Access- Network- Information.
APPLICABILITY BUNDLE COUNTERUCGI.
LAC IMS_ CALL_ ESTABLISHMENTThis attribute provides the LAC value from the Access- Network- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.575Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES TARIFF RESOURCE_ PRE_ SORTINGUser- Session- ID THRESHOLDThis attribute provides the User- Session- ID AVP value from the IMS information.
APPLICABILITY BUNDLE COUNTER IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONWLAN- ID CALL_ RULE_ VARIABLESThis attribute provides the WLAN- ID value from the Access- Network- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.576Charging User Guide Charging rules Attribute name Trigger TARIFF THRESHOLD RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERReason- Header- List RESOURCE_ PRE_ SORTINGThis attribute provides the Reason- Header values from the IMS- Information.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERRequested- Party- Address- List RESOURCE_ PRE_ SORTINGThis attribute provides the Requested- Party- Address values from the IMS- Information.Table 48: IMS_SERVICE_INFO source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.577Charging User Guide Charging rules Attribute name Trigger IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERCalled- Asserted- Identity- List RESOURCE_ PRE_ SORTINGThis attribute provides the Called- Asserted- Identity values from the IMS- Information.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION CALL_ RULE_ VARIABLES APPLICABILITY TARIFF THRESHOLD BUNDLE COUNTERCalling- Party- Address- List RESOURCE_ PRE_ SORTINGThis attribute provides the Calling Party Address values from the IMS information.Table 48: IMS_SERVICE_INFO source context (continued) msTimezone and sgsnMccMnc variables Following tables provide information on the value of msTimezone and sgsnMccMnc variables for various combinations of the Store location updates, Use stored location updates (IMS), and Re-Rating on Location updates (IMS) application preferences for IMS calls.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.578Charging User Guide Charging rules Store location updates Use stored location updates ( IMS)Re-Rating on Location updates ( IMS)Value of ms Timezone and sgsn MccMnc variables false false false Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC false false true Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC false true false In CCR- I, Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC is considered, where as, in CCR- U, the value stored in session ( of CCRI- I) of 3GPP- MS- Time Zone and 3GPP- SGSN- MCC- MNC is considered.
false true true In CCR- I and CCRU, both Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC is considered.
true false false Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC true false true Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC true true false The value of 3GPP- MS- Time Zone and 3GPP- SGSN- MCC- MNC stored in Device is preferred.
If there is no Gy call executed before IMSTable 49: msTimezone and sgsnMccMnc variable output for IMS calls Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.579Charging User Guide Charging rules Store location updates Use stored location updates ( IMS)Re-Rating on Location updates ( IMS)Value of ms Timezone and sgsn MccMnc variables call, then In CCR- I, Network AVP, value of 3GPP- MS- Time Zone and 3GPP- SGSN- MCC- MNC is considered, where as, in CCR- U, value stored in session ( of CCRI- I) of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC is considered.
true true true The value of 3GPP- MS- Time Zone and 3GPP- SGSN- MCC- MNC stored in Device is preferred.
If there is no Gy call executed before IMS call, in CCR- I and CCRU both Network AVP value of 3GPP- MS-Time Zone and 3GPP- SGSN- MCC- MNC is considered.Table 49: msTimezone and sgsnMccMnc variable output for IMS calls (continued) 4.6.
13 LIFECYCLE source context Attribute name Trigger Description From- State LIFECYCLE_ PROFILE This attribute displays the current state of a subscription or account.
LifeCycle- Id LIFECYCLE_ PROFILE This attribute is the Id of lifecycle.
Next- Validity- Time LIFECYCLE_ PROFILE This attribute displays the new validity time of a subscription or account.
Old- Validity- Time LIFECYCLE_ PROFILE This attribute displays the old validity time of a subscription or account.Table 50: LIFECYCLE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.580Charging User Guide Charging rules Attribute name Trigger Description To-State LIFECYCLE_ PROFILE This attribute displays the state to which a subscription or account transitions.Table 50: LIFECYCLE source context (continued) 4.6.
14 LOAN source context Attribute Description Loan- Id LOAN_ POST_ PROCESSING This attribute defines ID of loan.
Loan- Amount LOAN_ POST_ PROCESSING This attribute defines loan amount.
Loan- Bundle- Name LOAN_ POST_ PROCESSING Reference to bundle definition.
Loan- Activation- Fee LOAN_ POST_ PROCESSING This attribute defines loan activation fee, that is, fee to be deducted during opt- in.
Loan- Service- Fee LOAN_ POST_ PROCESSING This attribute defines Service fee of loan, that is, fee to be deducted during payback.
Type- Of-Loan LOAN_ POST_ PROCESSING This attribute defines loan type.
Loan- Pay- Service- Fee- If-Loan- UsedLOAN_ POST_ PROCESSING Fee is paid only if loan used.
Service fee is deducted on the basis this parameter.
Its default value is true.
Transaction- Id LOAN_ POST_ PROCESSING It indicates the transaction Id.
It is taken from the loan request.
If it is not present in the loan request, then it is generated internally in UUID format.Table 51: LOAN source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.581Charging User Guide Charging rules 4.6.
15 LOAN_REQUEST source context Attribute Trigger Description Device- Type LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGIt indicates the device identity types.
Example: E164, IMSI, NAI, SIP_ UR, and so on.
Device- Value LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGIt indicates the value of the device identity.
Account- Name LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGIt indicates the name of the account Account- Id LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGIt indicates the ID of the account.
Note : Only the first account of the subscription is considered for this attribute.
If device has multiple subscriptions, purchased by multiple accounts, then this attribute is filled by the first fetched account of the subscription.
Operation LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGIt indicates the operation that the request should perform.
It is a mandatory parameter.
Its possible values are as follows: •Opt- In •Opt- Out •Reset Transaction- Id LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGIt indicates the transaction Id.Table 52: LOAN_REQUEST source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.582Charging User Guide Charging rules Attribute Trigger Description It is taken from the loan request.
If it is not present in the loan request, then it is generated internally in UUID format.
Loan- Id LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGIndicates the ID of the loan.Table 52: LOAN_REQUEST source context (continued) 4.6.
16 NCHF_CHARGING_MESSAGE source context Consider the following important points for NCHF_CHARGING_MESSAGE source context: •In the request, if any list type attribute contains multiple elements, then only the first element in the list is evaluated.
•If a request has multiple MUU and internally the current MUU becomes available to the rule, then the following attributes get evaluated for the current MEE: –ratingGroup –requestedUnit –uPFID –usedUnitContainer Note : usedUnitContainer evaluates the first UUC of the current MUU.
In the UUC if UUC.triggers , UUC.PDUContainerInfo.servingNodeID , and UUC.PDUContainerInfo.presenceReportingAreaInformation have multiple elements in the list, then only the first occurrence is considered for rule evaluation.
Attribute name Trigger Description APPLICABILITY BUNDLE COUNTERCredit- Control- Request- Type GY_POST_ PROCESSINGThis attribute provides the type of request.
For example: INITIAL, UPDATE, TERMINATE, and EVENT.Table 53: NCHF_CHARGING_MESSAGE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.583Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGDestination- Host SLICING_ PROFILEThis attribute provides the value of Destination- Host in a request.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.584Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTINGDestination- Realm GY_PRE_ PROCESSINGThis attribute provides the value of Destination- Realm in a request.
APPLICABILITY TARIFF THRESHOLDHttp Header.
3gpp- Sbi-Message- Priority CALL_ RULE_ VARIABLESThis attribute provides the 3gpp- Sbi-Message- Priority header value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.585Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLEHttp Header.
3gpp- Sbi-Callback COUNTERThis attribute provides the 3gpp- Sbi-Callback header value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.586Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGHttp Header.
3gpp- Sbi-Target- apiRoot GY_PRE_ PROCESSINGThis attribute provides the 3gpp- Sbi-Target- api Root header value.
APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLESHttp Header.
3gpp- Sbi-Routing- Binding NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the 3gpp- Sbi-Routing- Binding header value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.587Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTERHttp Header.
3gpp- Sbi-Binding DEVICE_ NOT_ FOUNDThis attribute provides the 3gpp- Sbi-Binding header value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.588Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGHttp Header.
3gpp- Sbi-Producer- Id GY_PRE_ PROCESSINGThis attribute provides the 3gpp- Sbi-Producer- Id header value.
APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENTHttp Header.
3gpp- Sbi-Oci NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the 3gpp- Sbi-Oci header value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.589Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUNDHttp Header.
3gpp- Sbi-Lci RESOURCE_ PRE_ SORTINGThis attribute provides 3gpp- Sbi-Lci header value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.590Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGHttp Header.
3gpp- Sbi-Origination- Timestamp GY_PRE_ PROCESSINGThis attribute provides the 3gpp- Sbi- Origination- Timestamp header value.
APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONHttp Header.
3gpp- Sbi-Sender- Timestamp NCHF_ CHARGING_ CALL_ TERMINATIONThis header is used to indicate the date and time ( with a millisecond granularity) at which an HTTP request or response is originated.
This can be used, for example, for measuring signaling delays between different NF service instances.
It is an optional custom header.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.591Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGHttp Header.
3gpp- Sbi-Max- Rsp- Time GY_PRE_ PROCESSINGThis attribute provides the 3gpp- Sbi-Max- Rsp- Time header value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.592Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGHttp Header.
3gpp- Sbi-Correlation- Info GY_PRE_ PROCESSINGIt is an optional custom header, used to carry correlation info via header.
APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILEHttp Header.
3gpp- Sbi-Binding- Header GY_POST_ PROCESSINGThis header is used to signal binding information related to an NF Service Resource to a future consumer ( HTTP client) of that resource It is a mandatory HTTP custom headers.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.593Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING Http Header.
3gpp- Sbi-Target- Nf-Id APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis header is used in a 307 Temporary Redirect or 308 Permanent Redirect response, to identify the target NF ( service) instance towards which the request is redirected.
It is a mandatory HTTP custom header.
Http Header.
Via APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLESThis header is inserted by HTTP proxies.
This header is inserted by an SCP or SEPP when relaying an HTTP error response.
It may be inserted when relaying other HTTP responses.
When inserted by an SCP or SEPP, the pattern of the header should be formatted as follows: •SCP- <SCP FQDN> for an SCP •SEPP- <SEPP FQDN> for a SEPP This is a mandatory standard header.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.594Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING Http Header.
3gpp- Sbi-Discovery- target- nf-type APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGHeaders beginning with the prefix 3gpp- Sbi- Discovery- are used in indirect communication mode for discovery and selection of a suitable producer by the SCP.
Such headers can be included in any SBI message and include information allowing an SCP to find a suitable producer as per the consumer' s included target- nf-type.
This is a mandatory HTTP custom headers.
Http Header.
3gpp- Sbi-Client- Credentials APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis header may be used by an NF Service consumer to send client credentials assertion to the NRF or to the NF Service producer.
This is a mandatory HTTP custom headers.
Http Header.
3gpp- Sbi-Discovery- target- nf- instance- idAPPLICABILITY TARIFF THRESHOLDHeaders beginning with the prefix 3gpp- Sbi- Discovery- are used in indirect communication mode for discovery and selection of a suitable producer by the SCP.
Such headers may be included in any SBI message and includeTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.595Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGinformation allowing an SCP to find a suitable producer as per the consumer' s included target- nf-instance- id.
This is a mandatory HTTP custom headers.
Http Header.
3gpp- Sbi-Discovery- snssais APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGHeaders beginning with the prefix 3gpp- Sbi- Discovery- are used in indirect communication mode for discovery and selection of a suitable producer by the SCP.
Such headers may be included in any SBI message and include information allowing an SCP to find a suitable producer as per the consumer' s included snssais.
This is a mandatory HTTP custom headers.
Http Header.
3gpp- Sbi-Nrf- Uri APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSINGThis header can be used to indicate the NRF API URIs to be used for a given service request, for example, in indirect communication with delegated discovery as a result of an NSSF query.
This is a mandatory HTTP custom headers.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.596Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGHttp Header.
User- Agent GY_PRE_ PROCESSINGThis header is mainly used to identify the NF type of the HTTP/ 2 client.
The pattern of the content should start with the value of NF type ( for example, udm) and followed by a " -" and any other specific information if needed afterwards.
This is a mandatory standard header.
APPLICABILITY BUNDLE COUNTERinvocation Sequence Number CALL_ RULE_ VARIABLESThis attribute provides the value of Invocation Sequence Number in a request.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.597Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFInvocation Time Stamp CALL_ RULE_ VARIABLESThis attribute provides the value of Invocation Time Stamp in a request.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.598Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY GY_CREDIT_ REQUEST GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION GY_PRE_ PROCESSING TARIFF THRESHOLD BUNDLE COUNTER GY_POST_ PROCESSING RATING_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENTIs-Re-Rating MMS_ CALL_ TERMINATIONThis attribute indicates if the charging call is of Re_ Rating type for Re_ Rating calls that are generated from the old CDRs.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.599Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION RESOURCE_ POST_ PROCESSING SNA_ MANAGEMENT SLICING_ PROFILE RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFMultiple- Services- Indicator THRESHOLDThis attribute provides the Multiple- Services- Indicator value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.600Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
Is-Offline GY_PRE_ PROCESSINGThis attribute checks whether MSCC is offline or not.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
rating Group GY_PRE_ PROCESSINGThis attribute provides the rating group.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.601Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
requested Unit.
downlink Volume GY_PRE_ PROCESSINGThis attribute provides the CC Input Octets from MSCC RSU.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTMUU.
requested Unit.
service Specific Units NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the CC Service Specific Units from MSCC RSU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.602Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDMUU.
requested Unit.
time DEVICE_ NOT_ FOUNDThis attribute provides the CC Time from MSCC RSU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.603Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
requested Unit.
total Volume GY_PRE_ PROCESSINGThis attribute provides the CC Total Octets from MSCC RSU.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESMUU.
requested Unit.
uplink Volume GY_POST_ PROCESSINGThis attribute provides the CC Output Octets from MSCC RSU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.604Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILEMUU.
uPFID TARIFFThis attribute provides the UPF Identifier.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.605Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
downlink Volume GY_PRE_ PROCESSINGThis attribute provides the CC Input octets from MSCC USU.
APPLICABILITY BUNDLEMUU.
used Unit Container.
event Time Stamp COUNTERThis attribute provides the Event Timestamp of specific units in the used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.606Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGMUU.
used Unit Container.
local Sequence Number RESOURCE_ POST_ PROCESSINGThis attribute provides the local sequence number of the used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.607Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
3gpp PSData OffStatus GY_PRE_ PROCESSINGThis attribute provides the 3GPP data off status during the used unit interval.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.608Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
aFCorrelation Information GY_PRE_ PROCESSINGThis attribute provides the correlation information from AF regarding the charging service identifers.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONMUU.
used Unit Container.
pDUContainer Information.
applicationservice Provider Identity NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the Identifier of the application service provider.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.609Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLES TARIFF THRESHOLDMUU.
used Unit Container.
pDUContainer Information.
charging Rule Base Name DEVICE_ NOT_ FOUNDThis attribute provides the reference to a group of PCC rules that are predefined in the SMF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.610Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
ecgi.
eutra CellId GY_PRE_ PROCESSINGThis attribute provides the Eutra Cell Id of the presence information in the PDU Container Information of used service unit.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
ecgi.
plmn Id.mcc GY_CREDIT_ REQUESTThis attribute provides the MCC of Ecgi of presence information in PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.611Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
ecgi.
plmn Id.mnc RESOURCE_ POST_ PROCESSINGThis attribute provides the MNC of Ecgi of presence information in PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.612Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
global RanNode Id.gNbId.bitLength GY_PRE_ PROCESSINGThis attribute provides the bit length of presence information in the PDU Container Information of used service unit.
MUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
global RanNode Id.gNbId.gNbValueAPPLICABILITY This attribute provides the gNbValue of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.613Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
global RanNode Id.n3Iwf Id NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the N3IWFId of Global RanNode Id of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.614Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
global RanNode Id.ngeNbId RESOURCE_ PRE_ SORTINGThis attribute provides the ngeNbId of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.615Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
global RanNode Id.ngRanNode Id GY_PRE_ PROCESSINGThis attribute provides the NgRanNode Id of Global RanNode Id of presence information in the PDU Container Information of used service unit.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUESTMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
global RanNode Id.plmn Id.mcc GY_POST_ PROCESSINGThis attribute provides the MCC of Global Ran Node Id of presence info in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.616Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
global RanNode Id.plmn Id.mnc SLICING_ PROFILEThis attribute provides the MNC of Global Ran Node Id of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.617Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
ncgi.
nrCellId GY_PRE_ PROCESSINGThis attribute provides the Ncgi Cell id of Ncgi of presence information in the PDU Container Information of used service unit.
APPLICABILITY MUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
ncgi.
plmn Id.mcc BUNDLEThis attribute provides the MCC of Ncgi of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.618Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
ncgi.
plmn Id.mnc NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the MNC of Ncgi of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.619Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
praId DEVICE_ NOT_ FOUNDThis attribute provides the PraId of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.620Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
presence State GY_PRE_ PROCESSINGThis attribute provides the Presence State of presence information in the PDU Container Information of used service unit.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
tai.plmn Id.mcc GY_CREDIT_ REQUESTThis attribute provides the MCC of Tracking Area list of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.621Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
tai.plmn Id.mnc RESOURCE_ POST_ PROCESSINGThis attribute provides the MNC of tracking area list of presence information in the PDU Container Information of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.622Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
presence Reporting Area Information.
tai.tac GY_PRE_ PROCESSINGThis attribute provides the TAC of tracking area list of presence information in the PDU Container Information of used service unit.
MUU.
used Unit Container.
pDUContainer Information.
qoSData.
5qiAPPLICABILITY This attribute provides the 5qi from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.623Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONMUU.
used Unit Container.
pDUContainer Information.
qoSData.
arp.preempt Cap NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the ArpPreempt Cap from the PDU Container Information of Qos Data .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.624Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMUU.
used Unit Container.
pDUContainer Information.
qoSData.
arp.preempt Vuln RESOURCE_ PRE_ SORTINGThis attribute provides the ArpPreempt Value from PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.625Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
qoSData.
arp.priority Level GY_PRE_ PROCESSINGThis attribute provides the aprPriority Level from the PDU Container Information of Qos Data .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
qoSData.
aver Window NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the Aver Window from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.626Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFMUU.
used Unit Container.
pDUContainer Information.
qoSData.
defQosFlow Indication THRESHOLDThis attribute provides the qosFlow Indication flag from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.627Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
qoSData.
gbrDl GY_PRE_ PROCESSINGThis attribute provides the GBit Rate DL from the PDU Container Information of QosData .
APPLICABILITY BUNDLE COUNTERMUU.
used Unit Container.
pDUContainer Information.
qoSData.
gbrUl CALL_ RULE_ VARIABLESThis attribute provides the GBit Rate UL from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.628Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
qoSData.
maxbr Dl SLICING_ PROFILEThis attribute provides the MaxBitRate DL from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.629Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
qoSData.
maxbr Ul GY_PRE_ PROCESSINGThis attribute provides the MaxBitRate UL from the PDU Container Information of QosData .
APPLICABILITY MUU.
used Unit Container.
pDUContainer Information.
qoSData.
max Data Burst Vol BUNDLEThis attribute provides the MaxData Burst Vol from the PDU Container Information of Qos Data .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.630Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONMUU.
used Unit Container.
pDUContainer Information.
qoSData.
max Packet Loss Rate Dl RATING_ POST_ PROCESSINGThis attribute provides the MaxPacket Loss Rate from the PDU Container Information of Qos Data .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.631Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
qoSData.
priority Level GY_PRE_ PROCESSINGThis attribute provides the Priority Level from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.632Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
qoSData.
qnc GY_PRE_ PROCESSINGThis attribute provides the QNC from the PDU Container Information of QosData .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTMUU.
used Unit Container.
pDUContainer Information.
qoSData.
qosId NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the qosId from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.633Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDMUU.
used Unit Container.
pDUContainer Information.
qoSData.
reflective Qos DEVICE_ NOT_ FOUNDThis attribute provides the Reflective Qos from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.634Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
qoSData.
sharing KeyDl GY_PRE_ PROCESSINGThis attribute provides the Sharing KeyDL from the PDU Container Information of QosData .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESMUU.
used Unit Container.
pDUContainer Information.
qoSData.
sharing KeyUl GY_POST_ PROCESSINGThis attribute provides the Sharing KeyUL from the PDU Container Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.635Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLESMUU.
used Unit Container.
pDUContainer Information.
ratType TARIFFThis attribute provides the RAT type of the used unit container.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.636Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
serving Node ID.aMFId GY_PRE_ PROCESSINGThis attribute provides the AMF identifier.
APPLICABILITY BUNDLEMUU.
used Unit Container.
pDUContainer Information.
serving Node ID.serving Network Function Information.
nodefunctionality COUNTERThis attribute provides the node functionality of Serving Network Function Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.637Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
serving Node ID.serving Network Function Information.
nFFqdn RESOURCE_ POST_ PROCESSINGThis attribute provides the FQDN of the NF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.638Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
serving Node ID.serving Network Function Information.
nFIPv4Address GY_PRE_ PROCESSINGThis attribute provides the the IPv4 address of the NF.
MUU.
used Unit Container.
pDUContainer Information.
serving Node ID.serving Network Function Information.
nFIPv6AddressAPPLICABILITY This attribute provides the the IPv6 address of the NFTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.639Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONMUU.
used Unit Container.
pDUContainer Information.
serving Node ID.serving Network Function Information.
nfName NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the NF instance Identifier.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.640Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMUU.
used Unit Container.
pDUContainer Information.
serving Node ID.serving Network Function Information.
nFPLMNID.
mcc RESOURCE_ PRE_ SORTINGThis attribute provides the mobile country code.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.641Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
serving Node ID.serving Network Function Information.
nFPLMNID.
mnc GY_PRE_ PROCESSINGThis attribute provides the mobile network code.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTMUU.
used Unit Container.
pDUContainer Information.
sponsor Identity NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the sponsor identity of a specific used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.642Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFFMUU.
used Unit Container.
pDUContainer Information.
timeof First Usage THRESHOLDThis attribute provides the first usage timestamp of the reported used unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.643Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING PDUSession Charging Information.
home Provided Charging IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Nchf Home Provided Charging Id.
MUU.
used Unit Container.
event Time Stamps APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides USU Event Time Stamps.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.644Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING MUU.
used Unit Container.
pDUContainer Information.
qoSCharacteristics.
5qiAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides 5qi value for PDU Container QoS.
MUU.
used Unit Container.
pDUContainer Information.
qoSCharacteristics.
resource TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Resource Type for PDU Container QoS.
MUU.
used Unit Container.
pDUContainer Information.
qoSCharacteristics.
priority LevelAPPLICABILITY THRESHOLD TARIFFThis attribute provides Priority Level value for PDU Container QoS.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.645Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING MUU.
used Unit Container.
pDUContainer Information.
qoSCharacteristics.
packet Del BudgetAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Packet Delete Budget value for PDU Container QoS.
MUU.
used Unit Container.
pDUContainer Information.
qoSCharacteristics.
packet ErrRateAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILEThis attribute provides Packet Error Rate value for PDU Container QoS.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.646Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING MUU.
used Unit Container.
pDUContainer Information.
qoSCharacteristics.
aver WindowAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Average Window for PDU Container QoS.
MUU.
used Unit Container.
pDUContainer Information.
qoSCharacteristics.
max Data Burst VolAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLEThis attribute provides Maximum Data Burst Volume for PDU Container QoS.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.647Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING MUU.
used Unit Container.
pDUContainer Information.
qoSCharacteristics.
extMaxData Burst VolAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Maximum Data Burst Volume for PDU Container QoS.
MUU.
used Unit Container.
pDUContainer Information.
afCharging IdentifierAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides Af Charging Id for PDUContainer.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.648Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING MUU.
used Unit Container.
pDUContainer Information.
afCharging IdStringAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Af Charging Id for PDUContainer.
MUU.
used Unit Container.
pDUContainer Information.
mAPDUSteering FunctionalityAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides PDU Steering Functionality.
MUU.
used Unit Container.
pDUContainer Information.
mAPDUSteering Mode.
steer Mode ValueAPPLICABILITY THRESHOLD TARIFFThis attribute provides Steer Mode Value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.649Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING MUU.
used Unit Container.
pDUContainer Information.
mAPDUSteering Mode.
activeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Steering Mode Active value.
MUU.
used Unit Container.
pDUContainer Information.
mAPDUSteering Mode.
standbyAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILEThis attribute provides Steering Mode Standby value.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.650Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING MUU.
used Unit Container.
pDUContainer Information.
mAPDUSteering Mode.
prioAccAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Steering Mode Priority Access value.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONMUU.
used Unit Container.
pDUContainer Information.
timeof Last Usage NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the last usage timestamp of the reported used unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.651Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLDMUU.
used Unit Container.
pDUContainer Information.
uetime Zone DEVICE_ NOT_ FOUNDThis attribute provides the UE timezone during the used unit container interval.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.652Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
ageOfLocation Information GY_PRE_ PROCESSINGThis attribute provides the Eutra Location , and AgeOfLocation Information from the USU.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
ecgi.
eutra CellId GY_POST_ PROCESSINGThis attribute provides the Eutra Location Ecgi Eutra CellId from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.653Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
ecgi.
plmn Id.mcc SLICING_ PROFILEThis attribute provides the Eutra Location Ecgi MCC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.654Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
ecgi.
plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Ecgi MNC from USU.
MUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
geodetic InformationAPPLICABILITY This attribute provides the Eutra Location Geodetic Information from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.655Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
geographical Information NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the Eutra Location Geographical Information from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.656Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
global Ngenb Id.
n3Iwf Id RESOURCE_ PRE_ SORTINGThis attribute provides the Eutra Location N3Iwf Id from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.657Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
global Ngenb Id.
ngRanNode Id GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Ng RanNode Id from USU.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUESTMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
global Ngenb Id.
plmn Id.mcc GY_POST_ PROCESSINGThis attribute provides the Eutra Location Global Ngenb Id MCC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.658Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
global Ngenb Id.
plmn Id.mnc SLICING_ PROFILEThis attribute provides the Eutra Location Global Ngenb Id MNC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.659Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
tai.plmn Id.mcc GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Tai MCC from USU.
MUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
tai.plmn Id.mncAPPLICABILITY This attribute provides the Eutra Location Tai MNC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.660Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
tai.tac NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the Eutra Location Tai Tac from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.661Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDMUU.
used Unit Container.
pDUContainer Information.
ULI.eutra Location.
ueLocation Timestamp DEVICE_ NOT_ FOUNDThis attribute provides the Eutra Location Ue Location Timestamp from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.662Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.n3ga Location.
port Number GY_PRE_ PROCESSINGThis attribute provides the N3ga Location port number from USU.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESMUU.
used Unit Container.
pDUContainer Information.
ULI.n3ga Location.
ueIPv4Addr GY_POST_ PROCESSINGThis attribute provides the N3ga Location Ue IPV4Addr from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.663Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEMUU.
used Unit Container.
pDUContainer Information.
ULI.n3ga Location.
ueIPv6Addr TARIFFThis attribute provides the N3ga Location Ue IPV6Addr from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.664Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.n3ga Location.
n3gpp Tai.plmn Id.mcc GY_PRE_ PROCESSINGThis attribute provides the N3ga Location N3gpp Tai MCC from USU.
APPLICABILITY MUU.
used Unit Container.
pDUContainer Information.
ULI.n3ga Location.
n3gpp Tai.plmn Id.mnc BUNDLEThis attribute provides the N3ga Location N3gpp Tai MNC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.665Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONMUU.
used Unit Container.
pDUContainer Information.
ULI.n3ga Location.
n3gpp Tai.tac NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the N3ga LocationN3gpp Tai Tac from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.666Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMUU.
used Unit Container.
pDUContainer Information.
ULI.n3ga Location.
n3Iwf Id RESOURCE_ PRE_ SORTINGThis attribute provides the N3ga Location N3Iwf Id from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.667Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
ageOfLocation Information GY_PRE_ PROCESSINGThis attribute provides the NrLocation AgeOf Location Information from USU.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
geodetic Information NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the NrLocation Geodetic Information from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.668Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
geographical Information THRESHOLDThis attribute provides the NrLocation Geographical Information from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.669Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
global GnbId.gNbId.
bitLength GY_PRE_ PROCESSINGThis attribute provides the NrLocation bit length from USU.
APPLICABILITY BUNDLE COUNTERMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
global GnbId.gNbId.
gNbValue CALL_ RULE_ VARIABLESThis attribute provides the NrLocation gNb Value from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.670Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
global GnbId.n3Iwf Id SLICING_ PROFILEThis attribute provides the NrLocation N3Iwf Id from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.671Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
global GnbId.nge Nbid GY_PRE_ PROCESSINGThis attribute provides the NrLocation ngeNbId from USU.
APPLICABILITY MUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
global GnbId.ngRan Node Id BUNDLEThis attribute provides the NrLocation NgRan Node Id from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.672Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
global GnbId.plmn Id.mcc NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the NrLocation Global Ngenb Id MCC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.673Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
global GnbId.plmn Id.mnc DEVICE_ NOT_ FOUNDThis attribute provides the NrLocation Global Ngenb Id MNC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.674Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
ncgi.
nrCellId GY_PRE_ PROCESSINGThis attribute provides the NrLocation Ncgi Nr CellId from USU.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
ncgi.
plmn Id.mcc GY_CREDIT_ REQUESTThis attribute provides the NrLocation Ncgi MCCC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.675Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
ncgi.
plmn Id.mnc RESOURCE_ POST_ PROCESSINGThis attribute provides the NrLocation Ncgi MNC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.676Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
tai.plmn Id.mcc GY_PRE_ PROCESSINGThis attribute provides the NrLocation Tai MCC from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.677Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
tai.plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the NrLocation Tai MNC from USU.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
tai.tac NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the NrLocation Tai Tac from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.678Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFMUU.
used Unit Container.
pDUContainer Information.
ULI.nrLocation.
ueLocation Timestamp THRESHOLDThis attribute provides the NrLocation Ue Location Timestamp from USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.679Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
quota Management Indicator GY_PRE_ PROCESSINGThis attribute indicates whether the reported used units are with, or without quota management control.
Default value: Without quota management control.
APPLICABILITY BUNDLE COUNTERMUU.
used Unit Container.
service Id GY_POST_ PROCESSINGThis attribute provides the Service Identifier of used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.680Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGMUU.
used Unit Container.
service Specific Units SLICING_ PROFILEThis attribute provides the CC Service specific units from MSCC USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.681Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
time GY_PRE_ PROCESSINGThis attribute provides the CC Time from MSCC USU.
APPLICABILITY MUU.
used Unit Container.
total Volume BUNDLEThis attribute provides the CC Total octets from MSCC USU.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.682Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGMUU.
used Unit Container.
trigger Timestamp RESOURCE_ POST_ PROCESSINGThis attribute provides the Trigger Time Stamp of Used Service Unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.683Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDMUU.
used Unit Container.
triggers.
max Number Ofccc RESOURCE_ PRE_ SORTINGThis attribute provides the maximum number of charging condition changes for a used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.684Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
triggers.
time Limit GY_PRE_ PROCESSINGThis attribute provides the time limit for an used unit.
( If the trigger type is Data volume limit expiry. )
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTMUU.
used Unit Container.
triggers.
Trigger Category NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the trigger category of the triggers at the used service unit level.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.685Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFFMUU.
used Unit Container.
triggers.
Trigger Type THRESHOLDThis attribute provides the triggers of the type NCHF at the used service unit level.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.686Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
triggers.
Trigger Type List GY_PRE_ PROCESSINGThis attribute provides the NCHF trigger type list of triggers at the used service unit level.
APPLICABILITY BUNDLE COUNTERMUU.
used Unit Container.
triggers.
volume Limit GY_POST_ PROCESSINGThis attribute provides the volume limit for an used service unit.
( If the trigger type is Data volume limit expiry.
)Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.687Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSINGMUU.
used Unit Container.
triggers.
volume Limit64 BUNDLEThis attribute provides the volume limit if the trigger type at USU level is expiry of data volume.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.688Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGMUU.
used Unit Container.
uplink Volume GY_PRE_ PROCESSINGThis attribute provides the CC output octets from MSCC USU.
APPLICABILITY nfConsumer Identification.
nFIPv4Address BUNDLEThis attribute provides the NF IPv4 address.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.689Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONnfConsumer Identification.
nFIPv6Address RATING_ POST_ PROCESSINGThis attribute provides the NF IPv6 address.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.690Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGnfConsumer Identification.
nFFqdn GY_PRE_ PROCESSINGThis attribute provides the NF Consumer Identification nFFqdn .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.691Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGnfConsumer Identification.
nfName GY_PRE_ PROCESSINGThis attribute provides the NF Consumer Identification nFName .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSINGnfConsumer Identification.
nFPLMNID.
mcc NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the NF Consumer Identification MCC.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.692Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
roamer InOut APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIdentifies in- bound or out- bound roamer.
sMSCharging Information.
user Equipment Info APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONIdentifies the terminal.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.693Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
rATType APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIdentifies the RAT type.
sMSCharging Information.
sMMessage Type APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSINGIdentifies the message that triggered the generation of charging information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.694Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
sMUser Data Header APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGCarries the user data header extracted from the user data of the SM.
The user data header ( TP-UDH) is specified in TS 23.
040 [ x].
sMSCharging Information.
sMStatus APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLESThe information from the TP- Status field in a Status- Report TPDU.
It carries the value in hexadecimal representation pattern: ' ^[0-7]?
[ 0-9a-fA-F]$'Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.695Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
numberof Messages SentAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe number of SMSs sent by the IMS application or the total number of short messages when this SM is part of concatenated short message, if applicable.
sMSCharging Information.
sMSequence Number APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe sequence number of this SM within the concatenated short message.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.696Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
sMSresult APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe result of the attempted SM transaction, if unsuccessful.
This field is only applicable for offline charging.
sMSCharging Information.
message Reference APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe identity used to identify an SM in the SMS node associated with entity that submitted it.
sMSCharging Information.
message Size APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTThe total number of short messages when this SM is part of concatenated short message.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.697Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
delivery Report RequestedAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates whether a delivery report is requested by the SM originator.
sMSCharging Information.
sMData Coding SchemeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGThe data coding scheme used within the SM.
The information to populate this field is obtained from TP- DCS header.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.698Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
sMReply Path RequestedAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGAn indication of whether a reply SM to an original SM was requested to follow the same path as identified by the TP- Reply- Path ( TP-RP) flag.
sMSCharging Information.
sMpriority APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERAny priority information associated with an SM.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.699Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
sMService Type APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe type of SM service that caused the charging interaction.
It is only applicable for SM supplementary service procedures.
sMSCharging Information.
sMSCAddress APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe SMSC address.
It is the address ( for example, E. 164) of the SMS- service centre sending the Charging Data Request used for producing the record.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.700Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
uetime Zone APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe UE time zone the UE is currently located.
sMSCharging Information.
sMDischarge Time APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe time associated with the event being reported in the SM Status field.
This information is only applicable to delivery report charging procedures.
sMSCharging Information.
submission Time APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTThe timestamp of when the submitted SM arrived at the originating SMS node.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.701Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
originator Info.
originator GPSIAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGGPSI of the originator of the SMS.
sMSCharging Information.
originator Info.
originator SUPIAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGSUPI of the originator of the SMS.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.702Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
originator Info.
originator SCCPAddressAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGSCCP calling address used to receive the SM at the SMS node.
sMSCharging Information.
originator Info.
s MOriginator Protocol IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERThe protocol used for the SM by originator.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.703Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
originator Info.
s MOriginator Interface.
interface IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe interface identification provided by the messaging node ( originator/ destination) .
sMSCharging Information.
originator Info.
s MOriginator Interface.
interface TextAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe consolidation information about the application associated with the charging event.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.704Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
originator Info.
s MOriginator Interface.
interface PortAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe port- identification or information about the transport layer port used by the application associated with the charging event.
sMSCharging Information.
originator Info.
s MOriginator Interface.
interface TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGType of interface/ nature of the transaction in the messaging node for which the charging event occurs.
sMSCharging Information.
originator Info.
originator Other Address.
sMaddress TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTThe type of address carried.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.705Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
originator Info.
originator Other Address.
sMaddress DataAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe address information formatted according type of address.
sMSCharging Information.
originator Info.
originator Other Address.
sMaddress Domain.
domain NameAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGRepresents a fully qualified domain name ( FQDN) .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.706Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
originator Info.
originator Other Address.
sMaddress Domain.
3GPPIMSIMCCMNCAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMCC and MNC extracted from the user’ s IMSI (first 5 or 6 digits) , as applicable from the presented IMSI.
sMSCharging Information.
originator Info.
originator Received Address.
sMaddress TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERThe type of address carried.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.707Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
originator Info.
originator Received Address.
sMaddress DataAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe address information and formatted according type of address.
sMSCharging Information.
originator Info.
originator Received Address.
sMaddress Domain.
domain NameAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGRepresents a fully qualified domain name ( FQDN) .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.708Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
originator Info.
originator Received Address.
sMaddress Domain.
3GPPIMSIMCCMNCAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMCC and MNC extracted from the user’ s IMSI (first 5 or 6 digits) , as applicable from the presented IMSI.
sMSCharging Information.
recipient Info.
recipient SUPIAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGSUPI of the recipient of the SM, as received by the SMS node.
sMSCharging Information.
recipient Info.
recipient GPSIAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTGPSI of the recipient of the SM, as received by the SMS node.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.709Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
recipient Info.
recipient SCCPAddressAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGSCCP called address used by the SMS node to onward deliver the SM.
sMSCharging Information.
recipient Info.
s MRecipient Protocol IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGIt holds the TP- PROTOCOL- ID (TP-PID).Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.710Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
recipient Info.
s MDestination Interface.
interface IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe interface identification provided by the messaging node ( originator/ destination) .
sMSCharging Information.
recipient Info.
s MDestination Interface.
interface TextAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERIt is the consolidation information about the application associated with the charging event.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.711Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
recipient Info.
s MDestination Interface.
interface PortAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe port- identification or information about the transport layer port used by the application associated with the charging event.
sMSCharging Information.
recipient Info.
s MDestination Interface.
interface TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGType of interface/ nature of the transaction in the messaging node for which the charging event occurs.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.712Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
recipient Info.
recipient Other Address.
recipient Address Info.
s Maddress TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe type of address carried.
sMSCharging Information.
recipient Info.
recipient Other Address.
recipient Address Info.
s Maddress DataAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe address information, formatted according type of address.
sMSCharging Information.
recipient Info.
recipient Other Address.
recipient Address Info.
s Maddress Domain.
domain NameAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTRepresents a fully qualified domain name ( FQDN) .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.713Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
recipient Info.
recipient Other Address.
recipient Address Info.
s Maddress Domain.
3GPPIMSIMCCMNCAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMCC and MNC extracted from the user’ s IMSI (first 5 or 6 digits) , as applicable from the presented IMSI.
sMSCharging Information.
recipient Info.
recipient Received Address.
sMaddress TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGThe type of address carried.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.714Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
recipient Info.
recipient Received Address.
sMaddress DataAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe address information and formatted according type of address.
sMSCharging Information.
recipient Info.
recipient Received Address.
sMaddress Domain.
domain NameAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERRepresents a fully qualified domain name ( FQDN) .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.715Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
recipient Info.
recipient Received Address.
sMaddress Domain.
3GPPIMSIMCCMNCAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMCC and MNC extracted from the user’ s IMSI (first 5 or 6 digits) , as applicable from the presented IMSI.
Http Request Version APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis field is used to identify the Request Version for 5G Call.
( used for internal purpose only) .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.716Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
registration MessagetypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMessage type received by the AMF: registration (initial, initial, mobility, periodic, emergency) , deregistration.
registration Charging Information.
user Information.
served GPSIAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Generic Public Subscription Identifier ( GPSI) of the served party, if available.
registration Charging Information.
user Information.
served PEIAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTThe identification of Permanent Equipment Identifier.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.717Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Information.
unauthenticated FlagAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates the served SUPI is not authenticated.
registration Charging Information.
user Information.
roamer InOutAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGIn-bound or Out- bound roamer.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.718Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
rATType APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGRAT type of the registration.
registration Charging Information.
5g MMCapabilityAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER5GMM capability IE as specified in clause 9.
11.
3.1 of 3GPP TS 24.
501 [ 303] .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.719Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
mICOMode IndicationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates whether the requested use of MICO mode is accepted or not by the network.
registration Charging Information.
smsIndication APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates whether the SMS delivery over NAS is supported.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.720Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
service Area Restriction.
max Num OfTAsAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMaximum number of allowed tracking areas for use when restriction Type indicates " ALLOWED_ AREAS" .
This attribute is absent when attribute "restriction Type" takes the value " NOT_ ALLOWED_ AREAS" .
registration Charging Information.
service Area Restriction.
max Num OfTAsForNotAllowed AreasAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMaximum number of allowed tracking areas for use when restriction Type indicates " NOT_ ALLOWED_ AREAS" .
This attribute is absent when attribute " restriction Type" takes the value " ALLOWED_ AREAS" .
registration Charging Information.
service Area Restriction.
restriction TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTThe restriction type: " ALLOWED_ AREAS" or " NOT_ ALLOWED_ AREAS" .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.721Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
service Area Restriction.
areas.
area CodeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe area code.
It is present if and only if TAC is absent.
registration Charging Information.
service Area Restriction.
areas.
tacsAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGThe list of TACs.
It is present if and only if area Code is absent.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.722Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
requested NSSAI.
sstAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer, within the range 0 to 255, representing the Slice/ Service Type.
It indicates the expected Network Slice behaviour in terms of features and services.
Values 0 to 127 correspond to the standardized SST range.
Values 128 to 255 correspond to the operator- specific range.
registration Charging Information.
requested NSSAI.
sdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERA 3-octet string, representing the slice differentiator, in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represent four bits.
The most significant character representing the four most significant bits of the SD appears first in the string, and the character representing the four least significant bit of the SD appears last in the string.
This is an optional parameter that complements the Slice/ Service type( s) to allow to differentiate amongst multiple Network Slices of the same Slice/ Service type.
This IE is absent if no SD value is associated with the SST.
Pattern: ' ^[A-Fa-f0-9]{6}$'Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.723Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
allowed Nssai.
sstAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer, within the range 0 to 255, representing the Slice/ Service Type.
It indicates the expected Network Slice behaviour in terms of features and services.
Values 0 to 127 correspond to the standardized SST range.
Values 128 to 255 correspond to the operator- specific range.
registration Charging Information.
allowed Nssai.
sdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGA 3-octet string, representing the slice differentiator, in hexadecimal representation.
Each character in the string shall take a value of 0- 9, a- f, or A- F and shall represent four bits.
The most significant character representing the four most significant bits of the SD appears first in the string, and the character representing the four least significant bit of the SD appears last in the string.
This is an optional parameter that complements the Slice/ Service type( s) to allow to differentiate amongst multiple Network Slices of the same Slice/ Service type.
This IE is absent if no SD value is associated with the SST.
Pattern: ' ^[A-Fa-f0-9]{6}$'Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.724Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
rejected NSSAI.
sstAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer, within the range 0 to 255, representing the Slice/ Service Type.
It indicates the expected Network Slice behaviour in terms of features and services.
Values 0 to 127 correspond to the standardized SST range.
Values 128 to 255 correspond to the Operator- specific range.
See clause 28.
4.2 of 3GPP TS 23.
003 [ 7].
Standardized values are defined in clause 5.
15.
2.2 of 3GPP TS 23.
501 [ 8].
registration Charging Information.
rejected NSSAI.
sdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGA 3-octet string, representing the slice differentiator, in hexadecimal representation.
Each character in the string shall take a value of 0- 9, a- f, or A- F and shall represent four bits.
The most significant character representing the four most significant bits of the SD appears first in the string, and the character representing the four least significant bit of the SD appears last in the string.
This is an optional parameter that complements the Slice/ Service type( s) to allow to differentiate amongst multiple Network Slices of the same Slice/ Service type.
This IE is absent if no SD value is associated with the SST.
Pattern: ' ^[A-Fa-f0-9]{6}$' registration Charging Information.
taiList.
tac APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTTracking Area Code from registration Charging Information.
This attribute provides the tai List tac from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.725Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
taiList.
plmn Id.
mccAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Country Code from registration Charging Information.
This attribute provides the tai List plmn Id mcc from registration Charging Information.
registration Charging Information.
taiList.
plmn Id.
mncAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGMobile Network Code from registration Charging Information.
This attribute provides the tai List plmn Id mnc from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.726Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
taiList.
nid APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Network Identity.
It is present if Plmn IdNid identifies an SNPN; otherwise it is absent.
registration Charging Information.
user Locationinfo.
eutra Location.
tai.plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLEThe Mobile Country Code.
This attribute provides the eutra Location tai plmn Id mcc from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.727Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
tai.plmn Id.mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the eutra Location tai plmn Id mnc from registration Charging Information.
registration Charging Information.
user Locationinfo.
eutra Location.
tai.tacAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDThe Tracking Area Code.
This attribute provides the eutra Location tai tac from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.728Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
ecgi.
plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the eutra Location ecgi plmn Id mcc from registration Charging Information.
registration Charging Information.
user Locationinfo.
eutra Location.
ecgi.
plmn Id.mncAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the eutra Location ecgi plmn Id mnc from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.729Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
user Locationinfo.
eutra Location.
ecgi.
eutra CellIdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe E- UTRA Cell Identity.
This attribute provides the eutra Location ecgi eutra CellId from registration Charging Information.
registration Charging Information.
user Locationinfo.
eutra Location.
ageOfLocation InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe value represents the elapsed time in minutes since the last network contact of the mobile station.
A value of 0 indicates that the location information was obtained after a successful paging procedure for Active Location Retrieval when the UE is in idle mode or after a successful NG- RAN location reporting procedure with the e NB when the UE is in connected mode.
Any value other than 0 indicates that the location information is the last known one.
See 3GPP TS 29.
002 [ 21] clause 17.
7.8. registration Charging Information.
user Locationinfo.
eutra Location.
geographical InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTRefer to geographical Information.
See 3GPP TS 23.
032 [ 23] clause 7.
3.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.730Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGAllowed characters are 0- 9 and A- F. registration Charging Information.
user Locationinfo.
eutra Location.
geodetic InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGRefers to Calling Geodetic Location.
See ITU- T Recommendation Q.
763 ( 1999) [ 24] clause 3.
88.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.
Allowed characters are 0- 9 and A- F. registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILEThe Mobile Country Code.
This attribute provides the eutra Location global Ngenb Id plmn Id mcc from registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.731Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
plmn Id.mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the eutra Location global Ngenb Id plmn Id mnc from registration Charging Information.
registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
n3Iwf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.732Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.ng RanNode IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.
registration Charging Information.
user Locationinfo.
nrLocation.
tai.plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLESThe Mobile Country Code.
This attribute provides the nr Location tai plmn Id mcc from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.733Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
nrLocation.
tai.plmn Id.mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the nr Location tai plmn Id mnc from registration Charging Information.
registration Charging Information.
user Locationinfo.
nrLocation.
tai.tacAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Tracking Area Code.
This attribute provides the nr Location tai tac from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.734Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
user Locationinfo.
nrLocation.
ncgi.
plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the nr Location ncgi plmn Id mcc from registration Charging Information.
registration Charging Information.
user Locationinfo.
nrLocation.
ncgi.
plmn Id.mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the nr Location ncgi plmn Id mnc from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.735Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
user Locationinfo.
nrLocation.
ncgi.
nrCellIdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe NR Cell Identity.
This attribute provides the nr Location ncgi nr CellId from registration Charging Information.
registration Charging Information.
user Locationinfo.
nrLocation.
ageOfLocation InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe value represents the elapsed time in minutes since the last network contact of the mobile station.
A value of 0 indicates that the location information was obtained after a successful paging procedure for Active Location Retrieval when the UE is in idle mode or after a successful NG- RAN location reporting procedure with the g NB when the UE is in connected mode.
Any value other than 0 indicates that the location information is the last known one.
See 3GPP TS 29.
002 [ 21] clause 17.
7.8. registration Charging Information.
user Locationinfo.
nrLocation.
geographical InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTRefer to geographical Information.
See 3GPP TS 23.
032 [ 23] clause 7.
3.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.736Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGAllowed characters are 0- 9 and A- F. registration Charging Information.
user Locationinfo.
nrLocation.
geodetic InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGRefers to Calling Geodetic Location.
See ITU- T Recommendation Q.
763 ( 1999) [ 24] clause 3.
88.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.
Allowed characters are 0- 9 and A- F. registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.plmn Id.
mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILEThe Mobile Country Code.
This attribute provides the nr Location global GnbId plmn Id mcc from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.737Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.plmn Id.
mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the nr Location global GnbId plmn Id mcc from registration Charging Information.
registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.n3Iwf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.738Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.ngRan Node IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.
registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.gNbId.bit LengthAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.739Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.gNbId.g NbValueAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa- f0-9]{6,8}$' The value of the g NB ID is encoded in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Examples: A 30 bit value " 382A3F47" indicates a g NB ID with value 0x382A3F47 A 22 bit value " 2A3F47" indicates a g NB ID with value 0x2A3F47 registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.ngeNbIdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.740Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.plmn Id.
mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the n3ga Location n3gpp Tai plmn Id mcc from registration Charging Information.
registration Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.plmn Id.
mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the n3ga Location n3gpp Tai plmn Id mnc from registration Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.741Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.tacAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Tracking Area Code.
This attribute provides the n3ga Location n3gpp Tai tac from registration Charging Information.
registration Charging Information.
user Locationinfo.
n3ga Location.
n3Iwf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE contains the N3IWF identifier received over NGAP and is encoded as a string of hexadecimal characters.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The most significant character representing the four most significant bits of the N3IWF ID appears first in the string, and the character representing the four least significant bit of the N3IWF ID appears last in the string.
Pattern: ' ^[A-Fa-f0-9]+$' Example: The N3IWF Id 0x5BD6 is encoded as " 5BD6" .
It is present over the 3GPP PLMN internal interfaces if the UE is accessing the 5GC via an untrusted non- 3GPP access, but is present over the N5 interface.
registration Charging Information.
user Locationinfo.
n3ga Location.
ueIPv4AddrAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTUE/N5CW device local IPv4 address ( used to reach the N3IWF, TNGF or TWIF) .
The ue IPv4Addr or the ue IPv6Addr is present if the UE is accessing the 5GC via a trusted or untrusted non- 3GPP access and the information is available.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.742Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
n3ga Location.
ueIPv6AddrAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe UE/ N5CW device local IPv6 address ( used to reach the N3IWF, TNGF or TWIF) .
The ue IPv4Addr or the ue IPv6Addr is present if the UE is accessing the 5GC via a trusted or untrusted non- 3GPP access and the information is available.
registration Charging Information.
user Locationinfo.
n3ga Location.
port NumberAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGUDP or TCP source port number.
It is present if the UE is accessing the 5GC via a trusted or untrusted non- 3GPP access and NAT is detected.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.743Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING charging Id APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGCharging identifier for correlation between different records.
Only applicable if not available in the service specific information.
retransmission Indicator APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERThis field indicates, if included, this is a retransmitted request message.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.744Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING MUU.
used Unit Container.
pDUContainer Information.
qoSData.
max Packet Loss Rate UlAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates the uplink maximum rate for lost packets that can be tolerated for the service data flow.
MUU.
multihomed PDUAddress.
pduIPv4Address APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe IPv4 address of the served SUPI allocated for the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.745Charging User Guide Charging rules Attribute name Trigger Description MUU.
multihomed PDUAddress.
pdu IPv6Addresswith PrefixAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe IPv6 address with prefix of the served SUPI allocated for PDU session.
MUU.
multihomed PDUAddress.
pdu AddressprefixlengthAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGPDU Address prefix length of an IPv6 typed served PDU Address.
This field needs not available for prefix length of 64 bits.
MUU.
multihomed PDUAddress.
iPv4dynamic Address FlagAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis field indicates whether served IPv4 address is dynamically allocated.
This field is missing if address is static.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.746Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING MUU.
multihomed PDUAddress.
iPv6dynamic Prefix FlagAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis field indicates whether served IPv6 address prefix is dynamically allocated.
This field is missing if address is static.
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSCharacteristics.
5qiAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGIdentifier for the authorized QoS parameters for the service data flow.
Applies to PPC rule and PDU session level.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.747Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSCharacteristics.
resource TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates whether the resource type is GBR, delay critical GBR, or non- GBR.
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSCharacteristics.
priority LevelAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERUnsigned integer indicating the 5QI Priority Level, within a range of 1 to 127.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.748Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSCharacteristics.
packet Del BudgetAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer indicates the packet delay budget.
Packet Delay Budget expressed in milliseconds.
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSCharacteristics.
packet Err RateAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGString indicating packet error rate.
Example: Packet error rate 4* 10^ ( -6) is encoded as “ 4E- 6”.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.749Charging User Guide Charging rules Attribute name Trigger Description Roaming QBC- Info.
multiple QFIcontainer.
qFIContainer Info.
qoSCharacteristics.
aver WindowAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates the averaging window.
This IE is present only for a GBR QoS flow or a Delay Critical GBR QoS flow.
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSCharacteristics.
max Data Burst VolAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned Integer.
Indicates the maximum data burst volume.
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSCharacteristics.
extMaxData Burst VolAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTUnsigned Integer.
Indicates the maximum data burst volume.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.750Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
charging Id3GPPAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIP-CAN bearer Charging identifier used to identify this IP- CAN bearer in different records created by PGW- C+SMF.
Charging Id is generated by P- GW at IP- CAN bearer activation and is included in all containers in order to identify the containers which pertain to the IP- CAN bearer.
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
diagnosticsAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGProvides a more detailed cause value for the release.
Only applicable for 5GS and EPS interworking.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.751Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
enhanced DiagnosticsAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGProvides a more detailed cause value for the release.
Only applicable for 5GS and EPS interworking.
n2Connection Charging Information.
n2Connection Message TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERN2 message type received by the AMF specified in clause 9.
7 3GPP TS 24.
501[ 303] .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.752Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Information.
served GPSIAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Generic Public Subscription Identifier( GPSI) of the served party, if available.
n2Connection Charging Information.
user Information.
served PEIAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe identification of Permanent Equipment Identifier.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.753Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Information.
unauthenticated FlagAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates the served SUPI is not authenticated.
n2Connection Charging Information.
user Information.
roamer InOutAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIn-bound or out- bound roamer.
n2Connection Charging Information.
rATType APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTRAT Type of the registration.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.754Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
amfUeNgap IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUE association over the N2 interface within the AMF.
n2Connection Charging Information.
ranUeNgap IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGRAN UE NGAP ID over N2 interface.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.755Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
ranNode Id.
plmn Id.mccAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Country Code This attribute provides the ran Node Id plmn Id mcc from n2Connection Charging Information.
n2Connection Charging Information.
ranNode Id.
plmn Id.mncAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERMobile Network Code.
This attribute provides the ran Node Id plmn Id mcc from n2Connection Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.756Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
ranNode Id.
n3Iwf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier N3IWF.
n2Connection Charging Information.
ranNode Id.
gNbId.gNBValueAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis represents the identifier of g NB.
The string is formatted with pattern: ‘ ^[A-Fa-f0-9] {6,8}$’.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.757Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
ranNode Id.
gNbId.bitLengthAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 o 3GPP TS 38.
413[ 11], within the range of 22 to 32. n2Connection Charging Information.
ranNode Id.
ngeNbIdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node Id represents the NG- eNB.
When present, this IE contains the identifier of an NG- eNB.
n2Connection Charging Information.
ranNode Id.
wagf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis IE is included if the AN node represents the W- AGF.
When present, this IE contains the identifier of the W- AGF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.758Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
ranNode Id.
tngf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the AN node represents the W- TNGF.
When present, this IE contains the identifier of the W- TNGF.
n2Connection Charging Information.
ranNode Id.
nidAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGNetwork identifier is present in case of SNPN, Plmn Id together with Nid indicates the identity of the SNPN to which the Ran Node belongs to.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.759Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
ranNode Id.
eNbIdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if RAN Node Id represents an e NB.When present, this IE contains the identifier of e NB.
n2Connection Charging Information.
forbidden Area List.
area CodeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERArea code; it is present if and only if TAC is absent.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.760Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
forbidden Area List.
tacsAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGList of TACs; It is present if and only if area Code is absent.
n2Connection Charging Information.
restricted RatListAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGList of RAT types that are restricted for the UE.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.761Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
restricted CnListAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGList of Core Network Types that are restricted for the UE.
n2Connection Charging Information.
service Area Restriction.
max Num OfTAsAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMaximum number of allowed tracking areas for use when restriction Type indicates " ALLOWED_ AREAS" .
This attribute is absent when attribute "restriction Type" takes the value " NOT_ ALLOWED_ AREAS" .
n2Connection Charging Information.
service Area Restriction.
max Num OfTAsForNotAllowed AreasAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTMaximum number of allowed tracking areas for use when restriction Type indicates " NOT_ ALLOWED_ AREAS" .
This attribute is absent when attribute " restriction Type" takes the value " ALLOWED_ AREASTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.762Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
service Area Restriction.
restriction TypeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe restriction type.
Valid values are " ALLOWED_ AREAS" or " NOT_ ALLOWED_ AREAS" .
It is present if and only if the areas attribute is present.
n2Connection Charging Information.
service Area Restriction.
areas.
area CodeAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGArea Code; is present if and only if tacs is absent.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.763Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
service Area Restriction.
areas.
tacsAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGList of TACs; is present if and only if area Code is absent.
n2Connection Charging Information.
allowed Nssai.
sstAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERUnsigned integer, within the range 0 to 255, representing the Slice/ Service Type.
It indicates the expected Network Slice behaviour in terms of features and services.
Values 0 to 127 correspond to the standardized SST range.
Values 128 to 255 correspond to the Operator- specific range.
See clause 28.
4.2 of 3GPP TS 23.
003 [ 7].
Standardized values are defined in clause 5.
15.
2.2 of 3GPP TS 23.
501 [ 8].Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.764Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
allowed Nssai.
sdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGA 3-octet string, representing the slice differentiator, in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The most significant character representing the four most significant bits of the SD appears first in the string, and the character representing the four least significant bit of the SD appears last in the string.
This is an optional parameter that complements the Slice/ Service type( s) to allow to differentiate amongst multiple Network Slices of the same Slice/ Service type.
This IE is absent if no SD value is associated with the SST.
Pattern: ' ^[A-Fa-f0-9]{6}$' n2Connection Charging Information.
rrcEstCause APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGRRC Establishment Cause, if received from the 5G-AN, specified in TS 38.
413 [ 304] , clause 9.
3.1.111.
It carries the value in hexadecimal representation.
Pattern: ' ^[0-9a-fA-F]+$'Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.765Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Locationinfo.
eutra Location.
tai.plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Country Code part of the PLMN, comprising 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{3}$' n2Connection Charging Information.
user Locationinfo.
eutra Location.
tai.plmn Id.mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Network Code part of the PLMN, comprising 2 or 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{2,3}$' n2Connection Charging Information.
user Locationinfo.
eutra Location.
tai.tacAPPLICABILITY THRESHOLDA 2 or 3- octet string identifying a tracking area code as specified in clause 9.
3.3.10 of 3GPP TS 38.
413 [ 11], in hexadecimal representation.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.766Charging User Guide Charging rules Attribute name Trigger Description TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGEach character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The most significant character representing the four most significant bits of the TAC appears first in the string, and the character representing the four least significant bit of the TAC appears last in the string.
Examples: A legacy TAC 0x4305 is encoded as " 4305" .
An extended TAC 0x63F84B is encoded as " 63F84B" n2Connection Charging Information.
user Locationinfo.
eutra Location.
ecgi.
plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Country Code part of the PLMN, comprising 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{3}$' n2Connection Charging Information.
user Locationinfo.
eutra Location.
ecgi.
plmn Id.mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTMobile Network Code part of the PLMN, comprising 2 or 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{2,3}$'Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.767Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
eutra Location.
ecgi.
eutra CellIdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGA 28- bit string identifying an E- UTRA Cell Id as specified in clause 9.
3.1.9 of 3GPP TS 38.
413 [ 11], in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The most significant character representing the four most significant bits of the Cell Id appears first in the string, and the character representing the four least significant bit of the Cell Id appears last in the string.
Pattern: ' ^[A-Fa-f0-9]{7}$' Example: An E- UTRA Cell Id 0x5BD6007 is encoded as " 5BD6007" .
n2Connection Charging Information.
user Locationinfo.
eutra Location.
ageOfLocation InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGThe value represents the elapsed time in minutes since the last network contact of the mobile station.
Value " 0" indicates that the location information was obtained after a successful paging procedure for Active Location Retrieval when the UE is in idle mode or after a successful NG- RAN location reporting procedure with the e NB when the UE is in connected mode.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.768Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGAny other value than " 0" indicates that the location information is the last known one.
See 3GPP TS 29.
002 [ 21] clause 17.
7.8. n2Connection Charging Information.
user Locationinfo.
eutra Location.
geographical InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGRefer to geographical Information.
See 3GPP TS 23.
032 [ 23] clause 7.
3.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.
Allowed characters are 0- 9 and A- F. n2Connection Charging Information.
user Locationinfo.
eutra Location.
geodetic InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTERRefers to Calling Geodetic Location.
See ITU- T Recommendation Q.
763 ( 1999) [ 24] clause 3.
88.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.
Allowed characters are 0- 9 and A- F.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.769Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Country Code part of the PLMN, comprising 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{3}$' n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
plmn Id.mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDMobile Network Code part of the PLMN, comprising 2 or 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{2,3}$'Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.770Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
n3Iwf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIt represents the identifier of the N3IWF ID as specified in clause 9.
3.1.57 of 3GPP TS 38.413 [ 11] in hexadecimal representation.
Each character in the string takes a value of 0-9, a- f, or A- F and represents four bits.
The most significant character representing the four most significant bits of the N3IWF ID appears first in the string, and the character representing the four least significant bit of the N3IWF ID appears last in the string.
Pattern: ' ^[A-Fa-f0-9]+$' Example: The N3IWF Id 0x5BD6 is encoded as " 5BD6" .
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.ng RanNode IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.771Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Locationinfo.
nrLocation.
tai.plmn Id.mccAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Country Code part of the PLMN, comprising 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{3}$' n2Connection Charging Information.
user Locationinfo.
nrLocation.
tai.plmn Id.mncAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Network Code part of the PLMN, comprising 2 or 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{2,3}$' n2Connection Charging Information.
user Locationinfo.
nrLocation.
tai.tacAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTA 2 or 3- octet string identifying a tracking area code as specified in clause 9.
3.3.10 of 3GPP TS 38.
413 [ 11], in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.772Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe most significant character representing the four most significant bits of the TAC appears first in the string, and the character representing the four least significant bit of the TAC appears last in the string.
Examples: A legacy TAC 0x4305 is encoded as " 4305" .
An extended TAC 0x63F84B is encoded as " 63F84B" n2Connection Charging Information.
user Locationinfo.
nrLocation.
ncgi.
plmn Id.mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Country Code part of the PLMN, comprising 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{3}$' n2Connection Charging Information.
user Locationinfo.
nrLocation.
ncgi.
plmn Id.mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONMobile Network Code part of the PLMN, comprising 2 or 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{2,3}$'Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.773Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
nrLocation.
ncgi.
nrCellIdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGA 36- bit string identifying an NR Cell Id as specified in clause 9.
3.1.7 of 3GPP TS 38.
413 [ 11], in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The most significant character representing the four most significant bits of the Cell Id appears first in the string, and the character representing the four least significant bit of the Cell Id appears last in the string.
Pattern: ' ^[A-Fa-f0-9]{9}$' Example: An NR Cell Id 0x225BD6007 is encoded as " 225BD6007" .
2Connection Charging Information.
user Locationinfo.
nrLocation.
ageOfLocation InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThe value represents the elapsed time in minutes since the last network contact of the mobile station.
Value " 0" indicates that the location information was obtained after a successful paging procedure for Active Location Retrieval when the UE is in idle mode or after a successful NG- RAN location reporting procedure with the g NB when the UE is in connected mode.
Any other value than " 0" indicates that the location information is the last known one.
See 3GPP TS 29.
002 [ 21] clause 17.
7.8Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.774Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
nrLocation.
geographical InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGRefer to geographical Information.
See 3GPP TS 23.
032 [ 23] clause 7.
3.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.
Allowed characters are 0- 9 and A- F. n2Connection Charging Information.
user Locationinfo.
nrLocation.
geodetic InformationAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDRefers to Calling Geodetic Location.
See ITU- T Recommendation Q.
763 ( 1999) [ 24] clause 3.
88.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.
Allowed characters are 0- 9 and A- F.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.775Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.plmn Id.
mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Country Code part of the PLMN, comprising 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{3}$' n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.plmn Id.
mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMobile Network Code part of the PLMN, comprising 2 or 3 digits, as defined in clause 9.
3.3.5 of 3GPP TS 38.
413 [ 11].
Pattern: ' ^[0-9]{2,3}$'Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.776Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.n3Iwf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWF.
n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.ngRan Node IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.
n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.gNbId.bit LengthAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENTUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.777Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.gNbId.g NbValueAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa-f0-9] {6,8}$' The value of the g NB ID is encoded in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Examples: A 30 bit value " 382A3F47" indicates a g NB ID with value 0x382A3F47 A 22 bit value " 2A3F47" indicates a gNB ID with value 0x2A3F47 n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.ngeNbIdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.778Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.plmn Id.
mccAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the n3ga Location n3gppp plmnid mcc from n2Connection Charging Information.
n2Connection Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.plmn Id.
mncAPPLICABILITY THRESHOLD GY_CREDIT_ REQUEST TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThe Mobile Network Code.
This attribute provides the n3ga Location n3gpp Tai plmn Id mnc from n2Connection Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.779Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.tacAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Tracking Area Code.
This attribute provides the n3ga Location n3gpp Tai tac from n2Connection Charging Information.
n2Connection Charging Information.
user Locationinfo.
n3ga Location.
n3Iwf IdAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDThis IE contains the N3IWF identifier received over NGAP and is encoded as a string of hexadecimal characters.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The most significant character representing the four most significant bits of the N3IWF ID appears first in the string, and the character representing the four least significant bit of the N3IWF ID appears last in the string.
Pattern: ' ^[A-Fa- f0-9]+$' Example: The N3IWF Id 0x5BD6 is encoded as " 5BD6" .
It is present over the 3GPP PLMN internal interfaces if the UE is accessing the 5GC via an untrusted non- 3GPP access, but is not present over the N5 interface.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.780Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
n3ga Location.
ueIPv4AddrAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUE/N5CW device local IPv4 address ( used to reach the N3IWF, TNGF or TWIF) .
The ue IPv4Addr or the ue IPv6Addr is present if the UE is accessing the 5GC via a trusted or untrusted non- 3GPP access and the information is available.
n2Connection Charging Information.
user Locationinfo.
n3ga Location.
ueIPv6AddrAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUE/N5CW device local IPv6 address ( used to reach the N3IWF, TNGF or TWIF) .
The ue IPv4Addr or the ue IPv6Addr is present if the UE is accessing the 5GC via a trusted or untrusted non- 3GPP access and the information is available.
n2Connection Charging Information.
user Locationinfo.
n3ga Location.
port NumberAPPLICABILITY THRESHOLDUDP or TCP source port number.
It is present if the UE is accessing the 5GC via a trustedTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.781Charging User Guide Charging rules Attribute name Trigger Description TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGor untrusted non- 3GPP access and NAT is detected.
nEFCharging Information.
group Identifier APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Identifier identifying the served group associated to the SUPI or GPSI.
nEFCharging Information.
aPITarget Network FunctionAPPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThe identifier of the network function that either is the destination of the API invocation or triggers the notification.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.782Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING nEFCharging Information.
aPIName APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe name of the API invoked.
nEFCharging Information.
aPIReference APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThe reference to the definition of the format of the API invocation.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.783Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING nEFCharging Information.
aPIContent APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe actual content of the API invocation, in the format described by the a PIReference.
nEFCharging Information.
aPIDirection APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDThe direction to indicate if it is an API invocation from an AF or notification to an AF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.784Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING nEFCharging Information.
aPIResult Code APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe result of API Invocation.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGnfConsumer Identification.
nFPLMNID.
mnc RESOURCE_ POST_ PROCESSINGThis attribute provides the NF Consumer Identification MNC.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.785Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGnfConsumer Identification.
nodefunctionality GY_PRE_ PROCESSINGThis attribute provides the NF Consumer Identification Node Functionality.
notify Uri APPLICABILITY This attribute provides the Notify URI.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.786Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONoneTime Event RATING_ POST_ PROCESSINGThis attribute provides the one time event.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.787Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDoneTime Event Type RESOURCE_ PRE_ SORTINGThis attribute provides the one time event type.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.788Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGOrigin- Host GY_PRE_ PROCESSINGThis attribute provides the origin host.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGOrigin- State- Id NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the Origin State Id from the CCR.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.789Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLES TARIFF THRESHOLDPDUSession Charging Information.
charging Id DEVICE_ NOT_ FOUNDThis attribute provides the Nchf Charging Id from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.790Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
GGSN- Address GY_PRE_ PROCESSINGThis attribute provides the GGSN address from the PS information.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESPDUSession Charging Information.
Node- Id GY_POST_ PROCESSINGThis attribute provides the Node Id from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.791Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEPDUSession Charging Information.
PDUSession Info.
3gpp PSData OffStatus TARIFFThis attribute provides the 3gpp PS Data Off Status from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.792Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
5qi GY_PRE_ PROCESSINGThis attribute provides the 5G QoS Identifier of Authorized QosInformation .
APPLICABILITY BUNDLEPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
aver Window COUNTERThis attribute provides the Aver Window from the PDU session for Authorized QosInfo.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.793Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
gbrDl RATING_ POST_ PROCESSINGThis attribute provides the gbrDl of the Authorized QosInformation from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.794Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
gbrUl GY_PRE_ PROCESSINGThis attribute provides the gbrUl of the Authorized QosInformation from the PDU session information.
PDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
maxbr DlRESOURCE_ POST_ PROCESSING This attribute provides the maxbr Dl of the Authorized QosInformation from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.795Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
maxbr Ul SLICING_ PROFILEThis attribute provides the maxbr Ul of the Authorized QosInformation from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.796Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
max Data Burst Vol RESOURCE_ PRE_ SORTINGThis attribute provides the MaxData Burst Vol from the Authorized QosInfo.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.797Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
arp.preempt Cap GY_PRE_ PROCESSINGThis attribute provides the preemption capability from the USU of the Authorized Qos Info.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
arp.preempt Vuln NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the preemption vulnerability from the USU for the Authorized QosInfo.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.798Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
arp.priority Level THRESHOLDThis attribute provides the ArpPriority Level from the USU of the Authorized QosInfo.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.799Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
priority Level GY_PRE_ PROCESSINGThis attribute provides the priority level from the USU of the Authorized QosInfo.
PDUSession Charging Information.
PDUSession Info.
enhanced Diagnostics.
ranNasCause List.
eps CauseAPPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILEIndicates the RAN/ NAS cause value for EPS.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.800Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING PDUSession Charging Information.
PDUSession Info.
enhanced Diagnostics.
ranNasCause List.
5g SmCauseAPPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGIndicates the cause value of 5GSM protocol.
PDUSession Charging Information.
PDUSession Info.
enhanced Diagnostics.
ranNasCause List.
5g MmCauseAPPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLEIndicates the cause value of 5GMM protocol.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.801Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING PDUSession Charging Information.
PDUSession Info.
enhanced Diagnostics.
ranNasCause List.
ng ApCause.
valueAPPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE carries the NG AP cause value in specific cause group identified by the " group" attribute, as specified in clause 9.
4.5 of 3GPP TS 38.
413 [ 11].
PDUSession Charging Information.
PDUSession Info.
enhanced Diagnostics.
ranNasCause List.
ng ApCause.
groupAPPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis IE indicates the group of the NGAP cause.
The value of this IE equals to the ASN.
1 value of the specified NGAP cause group.
NGAP supports following cause groups defined as separate enumerations, as specified in clause 9.4.5 of 3GPP TS 38.
413 [ 11], with following values: 0 – radio Network, 1 – transport, 2 – nas, 3 – protocol, 4 – misc.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.802Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING PDUSession Charging Information.
PDUSession Info.
mAPDUSession Information.
a TSSSCapabilityAPPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGATSSS capability.
PDUSession Charging Information.
PDUSession Info.
mAPDUSession Information.
m APDUSession IndicatorAPPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGMA PDU session indication, i. e., MA PDU Request or MA PDU Network- Upgrade Allowed.
RESOURCE_ POST_ PROCESSING PDUSession Charging Information.
PDUSession Info.
authorized QoSInformation.
qnc APPLICABILITYThis attribute provides the qnc of the Authorized QosInformation from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.803Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONPDUSession Charging Information.
PDUSession Info.
charging Characteristics RATING_ POST_ PROCESSINGThis attribute provides the charging characteristics from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.804Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
charging Characteristics Selection Mode GY_PRE_ PROCESSINGThis attribute provides the charging characteristics selection mode from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.805Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
diagnostics GY_PRE_ PROCESSINGThis attribute provides a more detailed cause value from SMF.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING GY_PRE_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
dnnId NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the Nchf Dnn Id from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.806Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTERPDUSession Charging Information.
PDUSession Info.
dnnSelection Mode CALL_ RULE_ VARIABLESThis attribute provides the Dnn selection mode from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.807Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
hPlmn Id.mcc GY_PRE_ PROCESSINGThis attribute provides the HPLMN ID MCC from the PDU session information.
APPLICABILITY BUNDLEPDUSession Charging Information.
PDUSession Info.
hPlmn Id.mnc COUNTERThis attribute provides the HPLMN ID MNC from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.808Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
Network Slicing Info.
sNSSAI.
sd SLICING_ PROFILEThis attribute provides the SD from the PDU session information, or network slicing information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.809Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
Network Slicing Info.
sNSSAI.
sst GY_PRE_ PROCESSINGThis attribute provides the SST from the PDU session information, or network slicing information.
PDUSession Charging Information.
PDUSession Info.
pduAddress.
iPv4dynamic Address FlagAPPLICABILITY This attribute provides the IPv4 dynamic address flag from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.810Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONPDUSession Charging Information.
PDUSession Info.
pduAddress.
iPv6dynamic Prefix Flag NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the IPv6 dynamic address flag from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.811Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDPDUSession Charging Information.
PDUSession Info.
pduAddress.
pduAddressprefixlength RESOURCE_ PRE_ SORTINGThis attribute provides the PDU address prefix length from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.812Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
pduAddress.
pduIPv4Address GY_PRE_ PROCESSINGThis attribute provides the PDU IPv4 address from the PDU session information.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
pduAddress.
pduIPv6Addresswith Prefix NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the PDU IPv6 address from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.813Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFPDUSession Charging Information.
PDUSession Info.
pduSession ID THRESHOLDThis attribute provides the PDU session ID from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.814Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
pduType GY_PRE_ PROCESSINGThis attribute provides the PDU type from the PDU session information.
APPLICABILITY BUNDLE COUNTERPDUSession Charging Information.
PDUSession Info.
qoSInformation.
5qi CALL_ RULE_ VARIABLESThis attribute provides the PDU 5qi from the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.815Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
qoSInformation.
arp.preempt Cap SLICING_ PROFILEThis attribute provides the PduArpPreempt Capthe from PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.816Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
qoSInformation.
arp.preempt Vuln GY_PRE_ PROCESSINGThis attribute provides the ArpPreempt Vuln from the PDU session.
APPLICABILITY PDUSession Charging Information.
PDUSession Info.
qoSInformation.
arp.priority Level BUNDLEThis attribute provides the PduArpPriority Level from the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.817Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONPDUSession Charging Information.
PDUSession Info.
qoSInformation.
dynamic5Qi.
aver Window RATING_ POST_ PROCESSINGThis attribute provides the Dynamic5Qi_ Aver Window from the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.818Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
qoSInformation.
dynamic5Qi.
max Data Burst Vol GY_PRE_ PROCESSINGThis attribute provides the Dynamic5Qi_ Max Data Burst Vol from the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.819Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
qoSInformation.
dynamic5Qi.
packet Delay Budget GY_PRE_ PROCESSINGThis attribute provides the Dynamic5Qi_ Packet Delay Budget from the PDU session.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTPDUSession Charging Information.
PDUSession Info.
qoSInformation.
dynamic5Qi.
packet Err Rate NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the Dynamic5Qi_ Packet ErrRate from the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.820Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDPDUSession Charging Information.
PDUSession Info.
qoSInformation.
dynamic5Qi.
priority Level DEVICE_ NOT_ FOUNDThis attribute provides the Dynamic5Qi_ Priority Level from the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.821Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
qoSInformation.
dynamic5Qi.
resource Type GY_PRE_ PROCESSINGThis attribute provides the PduDynamic5Qi_ Resource Type from the PDU session.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESPDUSession Charging Information.
PDUSession Info.
qoSInformation.
nonDynamic5Qi.
aver Window GY_POST_ PROCESSINGThis attribute provides the NonDynamic5Qi_ Aver Window from the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.822Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEPDUSession Charging Information.
PDUSession Info.
qoSInformation.
nonDynamic5Qi.
max Data Burst Vol TARIFFThis attribute provides the NonDynamic5Qi_ MaxData Burst Vol from the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.823Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
qoSInformation.
nonDynamic5Qi.
priority Level GY_PRE_ PROCESSINGThis attribute provides the NonDynamic5Qi_ Priority Level from the PDU session.
APPLICABILITY BUNDLEPDUSession Charging Information.
PDUSession Info.
ratType COUNTERThe RAT Type of the PDU session.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.824Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY TARIFF CALL_ RULE_ VARIABLES THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILEPDUSession Charging Information.
PDUSession Info.
serving CNPlmn Id.mcc GY_POST_ PROCESSINGThis attribute provides the Serving CNPlmn ID MCC from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.825Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING GY_CREDIT_ REQUEST BUNDLE COUNTER DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY TARIFF THRESHOLD NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING GY_CREDIT_ REQUEST BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDPDUSession Charging Information.
PDUSession Info.
serving CNPlmn Id.mnc RESOURCE_ PRE_ SORTINGThis attribute provides the Serving CNPlmn ID MNC from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.826Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
serving Network Function ID.aMFId GY_PRE_ PROCESSINGThis attribute provides the AMF identifier.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
serving Network Function ID.serving Network Function Information.
nFFqdn NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the FQDN of the NF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.827Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFPDUSession Charging Information.
PDUSession Info.
serving Network Function ID.serving Network Function Information.
nFIPv4Address THRESHOLDThis attribute provides the IPv4 address of the NF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.828Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
serving Network Function ID.serving Network Function Information.
nFIPv6Address GY_PRE_ PROCESSINGThis attribute provides the The IPv6 address of the NF.
APPLICABILITY BUNDLE COUNTERPDUSession Charging Information.
PDUSession Info.
serving Network Function ID.serving Network Function Information.
nfName CALL_ RULE_ VARIABLESThis attribute provides the NF instance Identifier.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.829Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
serving Network Function ID.serving Network Function Information.
nFPLMNID.
mcc SLICING_ PROFILEThis attribute provides the mobile country code.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.830Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
serving Network Function ID.serving Network Function Information.
nFPLMNID.
mnc GY_PRE_ PROCESSINGThis attribute provides the mobile network code.
APPLICABILITY PDUSession Charging Information.
PDUSession Info.
serving Network Function ID.serving Network Function Information.
nodefunctionality BUNDLEThis attribute provides the node functionality of the Serving Network Function Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.831Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
serving Node ID RESOURCE_ POST_ PROCESSINGThe list of serving node identifiers during the used unit container interval.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.832Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
session Stop Indicator GY_PRE_ PROCESSINGThis attribute provides the session stop indicator from the PDU session information.
PDUSession Charging Information.
PDUSession Info.
sscModeAPPLICABILITY This attribute provides the SSC mode from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.833Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONPDUSession Charging Information.
PDUSession Info.
start Time NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the start time from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.834Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDPDUSession Charging Information.
PDUSession Info.
stop Time RESOURCE_ PRE_ SORTINGThis attribute provides the stop time from the PDU session information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.835Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
subscribed QoSInformation.
5qi GY_PRE_ PROCESSINGThis attribute provides the 5G QoS Identifier of the Subscribedd QosInfo.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
subscribed QoSInformation.
arp.preempt Cap NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the preemption capability from the USU of Subscribedd Qos Info.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.836Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFPDUSession Charging Information.
PDUSession Info.
subscribed QoSInformation.
arp.preempt Vuln THRESHOLDDefines whether a service data flow may lose the resources assigned to it in order to admit a service data flow with higher priority level.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.837Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
subscribed QoSInformation.
arp.priority Level GY_PRE_ PROCESSINGThis attribute provides the Arp Priority Level from the USU of Subscribed QosInfo.
APPLICABILITY BUNDLE COUNTERPDUSession Charging Information.
PDUSession Info.
subscribed QoSInformation.
priority Level CALL_ RULE_ VARIABLESThis attribute provides the priority level from the USU of Subscribed QosInfo.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.838Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGPDUSession Charging Information.
PDUSession Info.
subscribed Session AMBR.
uplink SLICING_ PROFILEThis attribute provides the uplink.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.839Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
PDUSession Info.
subscribed Session AMBR.
downlink GY_PRE_ PROCESSINGThis attribute provides the downlink.
APPLICABILITY PDUSession Charging Information.
presence Reporting Area Information.
ecgi.
eutra CellId BUNDLEThis attribute provides the Eutra Cell Id of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.840Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONPDUSession Charging Information.
presence Reporting Area Information.
ecgi.
plmn Id.mcc RATING_ POST_ PROCESSINGThis attribute provides the MCC of Ecgi of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.841Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
presence Reporting Area Information.
ecgi.
plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the MNC of Ecgi of presence information in PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.842Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
presence Reporting Area Information.
global RanNode Id.g NbId.bitLength GY_PRE_ PROCESSINGThis attribute provides the Global RanNode Id bit length of presence information in the PS information.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENTPDUSession Charging Information.
presence Reporting Area Information.
global RanNode Id.g NbId.gNbValue NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the Global RanNode Id gNbValue of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.843Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDPDUSession Charging Information.
presence Reporting Area Information.
global RanNode Id.
n3Iwf Id DEVICE_ NOT_ FOUNDThis attribute provides the N3IWFId (of Global RanNode Id) of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.844Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
presence Reporting Area Information.
global RanNode Id.
ngeNbId GY_PRE_ PROCESSINGThis attribute provides the ngeNbId of Global RanNode Id of presence information in the PS information.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSINGPDUSession Charging Information.
presence Reporting Area Information.
global RanNode Id.ng RanNode Id CALL_ RULE_ VARIABLESThis attribute provides the NgRanNode Id of Global RanNode Id of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.845Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGPDUSession Charging Information.
presence Reporting Area Information.
global RanNode Id.
plmn Id.mcc SLICING_ PROFILEThis attribute provides the MCC of Global Ran Node Id of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.846Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
presence Reporting Area Information.
global RanNode Id.
plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the MNC of Global RanNode Id of presence information in the PS information.
PDUSession Charging Information.
presence Reporting Area Information.
ncgi.
nrCellIdAPPLICABILITY This attribute provides the Ncgi Cell id of Ncgi of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.847Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONPDUSession Charging Information.
presence Reporting Area Information.
ncgi.
plmn Id.mcc NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the MCC of Ncgi of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.848Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF GY_CREDIT_ REQUEST THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDPDUSession Charging Information.
presence Reporting Area Information.
ncgi.
plmn Id.mnc DEVICE_ NOT_ FOUNDThis attribute provides the MNC of Ncgi of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.849Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
presence Reporting Area Information.
praId GY_PRE_ PROCESSINGThis attribute provides the Pra Id of presence information in the PS information.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSINGPDUSession Charging Information.
presence Reporting Area Information.
presence State NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the Presence State of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.850Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILEPDUSession Charging Information.
presence Reporting Area Information.
tai.plmn Id.mcc TARIFFThis attribute provides the MCC of tracking area list of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.851Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING CALL_ RULE_ VARIABLES NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
presence Reporting Area Information.
tai.plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the MCC of tracking area list of presence information in the PS information.
APPLICABILITY BUNDLEPDUSession Charging Information.
presence Reporting Area Information.
tai.tac COUNTERThis attribute provides the TAC of tracking area list of presence information in the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.852Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGPDUSession Charging Information.
RANSecondary RATUsage Report.
QosFlows Usage Reports.
downlink Volume RESOURCE_ POST_ PROCESSINGThis attribute provides the down link volume.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.853Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
RANSecondary RATUsage Report.
QosFlows Usage Reports.
endTimestamp GY_PRE_ PROCESSINGThis attribute provides the end timestamp.
PDUSession Charging Information.
RANSecondary RATUsage Report.
QosFlows Usage Reports.
qFIAPPLICABILITY This attribute provides the QoS Flow Identifier ( QFI) in the QFIContainer Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.854Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONPDUSession Charging Information.
RANSecondary RATUsage Report.
QosFlows Usage Reports.
start Timestamp NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the start timestamp.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.855Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDPDUSession Charging Information.
RANSecondary RATUsage Report.
QosFlows Usage Reports.
uplink Volume RESOURCE_ PRE_ SORTINGThis attribute provides the uplink volume.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.856Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
RANSecondary RATUsage Report.
rANSecondary RATType GY_PRE_ PROCESSINGThis attribute provides the Ran Secondary RAT Type.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGPDUSession Charging Information.
uetime Zone NCHF_ CHARGING_ CALL_ ESTABLISHMENTThe UE Time Zone during the used unit container interval.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.857Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFPDUSession Charging Information.
ULI.eutra Location.
ageOfLocation Information THRESHOLDThis attribute provides the Eutra Location AgeOfLocation Information from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.858Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.eutra Location.
ecgi.
eutra CellId GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Ecgi Eutra CellId from the PS information.
APPLICABILITY BUNDLE COUNTERPDUSession Charging Information.
ULI.eutra Location.
ecgi.
plmn Id.mcc CALL_ RULE_ VARIABLESThis attribute provides the Eutra Location Ecgi MCC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.859Charging User Guide Charging rules Attribute name Trigger Description GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONPDUSession Charging Information.
ULI.eutra Location.
ecgi.
plmn Id.mnc RATING_ POST_ PROCESSINGThis attribute provides the Eutra Location Ecgi MNC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.860Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.eutra Location.
geodetic Information GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Geodetic Information from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.861Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.eutra Location.
geographical Information GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Geographical Information from the PS information.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTPDUSession Charging Information.
ULI.eutra Location.
global Ngenb Id.n3Iwf Id NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the Eutra Location N3Iwf Id from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.862Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDPDUSession Charging Information.
ULI.eutra Location.
global Ngenb Id.ngRanNode Id DEVICE_ NOT_ FOUNDThis attribute provides the Eutra Location Ng RanNode Id from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.863Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.eutra Location.
global Ngenb Id.plmn Id.mcc GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Global Ngenb Id MCC from the PS information.
APPLICABILITY BUNDLE COUNTERPDUSession Charging Information.
ULI.eutra Location.
global Ngenb Id.plmn Id.mnc CALL_ RULE_ VARIABLESThis attribute provides the Eutra Location Global Ngenb Id MNC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.864Charging User Guide Charging rules Attribute name Trigger Description GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONPDUSession Charging Information.
ULI.eutra Location.
tai.plmn Id.mcc RATING_ POST_ PROCESSINGThis attribute provides the Eutra Location Tai MCC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.865Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDPDUSession Charging Information.
ULI.eutra Location.
tai.plmn Id.mnc RESOURCE_ PRE_ SORTINGThis attribute provides the Eutra Location Tai MNC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.866Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.eutra Location.
tai.tac GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Tai Tac from the PS information.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGPDUSession Charging Information.
ULI.eutra Location.
ueLocation Timestamp NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the Eutra Location Ue Location Timestamp from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.867Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEPDUSession Charging Information.
ULI.n3ga Location.
n3gpp Tai.plmn Id.mcc TARIFFThis attribute provides the N3ga Location N3gpp Tai MCC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.868Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.n3ga Location.
n3gpp Tai.plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the N3ga Location N3gpp Tai MNC from the PS information.
APPLICABILITY PDUSession Charging Information.
ULI.n3ga Location.
n3gpp Tai.tac BUNDLEThis attribute provides the N3ga Location N3gpp Tai Tac from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.869Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONPDUSession Charging Information.
ULI.n3ga Location.
n3Iwf Id RATING_ POST_ PROCESSINGThis attribute provides the N3ga Location N3Iwf Id from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.870Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.n3ga Location.
port Number GY_PRE_ PROCESSINGThis attribute provides the N3ga Location Port Number from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.871Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.n3ga Location.
ueIPv4Addr GY_PRE_ PROCESSINGThis attribute provides the N3ga Location Ue IPV4Addr from the PS information.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTPDUSession Charging Information.
ULI.n3ga Location.
ueIPv6Addr NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the N3ga Location Ue IPV6Addr from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.872Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDPDUSession Charging Information.
ULI.nr Location.
ageOfLocation Information DEVICE_ NOT_ FOUNDThis attribute provides the NrLocation AgeOf Location Information from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.873Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.nr Location.
geodetic Information GY_PRE_ PROCESSINGThis attribute provides the NrLocation Geodetic Information from the PS information.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESPDUSession Charging Information.
ULI.nr Location.
geographical Information GY_POST_ PROCESSINGThis attribute provides the NrLocation Geographical Information from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.874Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEPDUSession Charging Information.
ULI.nr Location.
global GnbId.gNbId.bitLength TARIFFThis attribute provides the NrLocation bit Length from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.875Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.nr Location.
global GnbId.gNbId.gNbValue GY_PRE_ PROCESSINGThis attribute provides the NrLocation gNb Value from the PS information.
APPLICABILITY BUNDLEPDUSession Charging Information.
ULI.nr Location.
global GnbId.n3Iwf Id COUNTERThis attribute provides the NrLocation N3Iwf Id from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.876Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGPDUSession Charging Information.
ULI.nr Location.
global GnbId.ngeNbId RESOURCE_ POST_ PROCESSINGThis attribute provides the NrLocation ngeNbId from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.877Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.nr Location.
global GnbId.ngRanNode Id GY_PRE_ PROCESSINGThis attribute provides the NrLocation NgRan Node Id from the PS information.
PDUSession Charging Information.
ULI.nr Location.
global GnbId.plmn Id.mccAPPLICABILITY This attribute provides the NrLocation Global Ngenb Id MCC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.878Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSINGPDUSession Charging Information.
ULI.nr Location.
global GnbId.plmn Id.mnc NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the NrLocation Global Ngenb Id MNC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.879Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDPDUSession Charging Information.
ULI.nr Location.
ncgi.
nrCellId DEVICE_ NOT_ FOUNDThis attribute provides the NrLocation Ncgi Nr CellId from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.880Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.nr Location.
ncgi.
plmn Id.mcc GY_PRE_ PROCESSINGThis attribute provides the NrLocation Ncgi MCC from the PS information.
APPLICABILITY BUNDLE COUNTERPDUSession Charging Information.
ULI.nr Location.
ncgi.
plmn Id.mnc CALL_ RULE_ VARIABLESThis attribute provides the NrLocation Ncgi MNC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.881Charging User Guide Charging rules Attribute name Trigger Description GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONPDUSession Charging Information.
ULI.nr Location.
tai.plmn Id.mcc RATING_ POST_ PROCESSINGThis attribute provides the NrLocation Tai MCC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.882Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDPDUSession Charging Information.
ULI.nr Location.
tai.plmn Id.mnc RESOURCE_ PRE_ SORTINGThis attribute provides the NrLocation Tai MNC from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.883Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
ULI.nr Location.
tai.tac GY_PRE_ PROCESSINGThis attribute provides the NrLocation Tai Tac from the PS information.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGPDUSession Charging Information.
ULI.nr Location.
ueLocation Timestamp NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the NrLocation Ue Location Timestamp from the PS information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.884Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFPDUSession Charging Information.
unitCount Inactivity Timer THRESHOLDThis attribute provides the unit count inactivity time.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.885Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
unused Quota Timer GY_PRE_ PROCESSINGDo not configure this because this attribute is not supported.
APPLICABILITY BUNDLE COUNTERPDUSession Charging Information.
user Information.
roamer InOut GY_POST_ PROCESSINGThis attribute provides the Roamer In and Out from the PS information, or user information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.886Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGPDUSession Charging Information.
user Information.
served GPSI RESOURCE_ POST_ PROCESSINGThis attribute provides the served GPSI.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.887Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGPDUSession Charging Information.
user Information.
served PEI GY_PRE_ PROCESSINGThis attribute provides the served PEI.
PDUSession Charging Information.
user Information.
unauthenticated FlagAPPLICABILITY This attribute provides the unauthenticated flag.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.888Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONPDUSession Charging Information.
user Location Time NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the user location time.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.889Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDRoaming QBC- Info.
multiple QFIcontainer.
downlink Volume RESOURCE_ PRE_ SORTINGThis attribute provides the amount of volume in downlink direction in the Multiple QFIcontainer .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.890Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
local Sequence Number GY_PRE_ PROCESSINGThis attribute provides the local sequence number in the Multiple QFIcontainer .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
ecgi.
eutra CellId NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the Eutra Cell Id of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.891Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILERoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
ecgi.
plmn Id.mcc TARIFFThis attribute provides the MCC of Ecgi of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.892Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
ecgi.
plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the MNC of Ecgi of presence information in the QFIContainer- Information .
APPLICABILITY Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
global RanNode Id.gNbId.bit Length BUNDLEThis attribute provides the bit length of Global RanNode Id of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.893Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
global RanNode Id.gNbId.g NbValue RATING_ POST_ PROCESSINGThis attribute provides the g Nb value of Global RanNode Id of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.894Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
global RanNode Id.n3Iwf Id GY_PRE_ PROCESSINGThis attribute provides the N3IWFId of Global RanNode Id of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.895Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
global RanNode Id.ngeNbId GY_PRE_ PROCESSINGThis attribute provides the ngeNbId of Global RanNode Id of presence information in the QFIContainer- Information .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
global RanNode Id.ngRan Node Id NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the NgRanNode Id of Global RanNode Id of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.896Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
global RanNode Id.plmn Id.
mcc THRESHOLDThis attribute provides the MCC of Global RanNode Id of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.897Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
global RanNode Id.plmn Id.
mnc GY_PRE_ PROCESSINGThis attribute provides the MNC of Global RanNode Id of presence information in the QFIContainer- Information .
APPLICABILITY BUNDLERoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
ncgi.
nrCellId COUNTERThis attribute provides the Ncgi Cell id of Ncgi of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.898Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
ncgi.
plmn Id.mcc RATING_ POST_ PROCESSINGThis attribute provides the MCC of Ncgi of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.899Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
ncgi.
plmn Id.mnc RESOURCE_ PRE_ SORTINGThis attribute provides the MNC of Ncgi of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.900Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
praId GY_PRE_ PROCESSINGThis attribute provides the Pra Id of presence information in the QFIContainer- Information .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
presence State NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the Presence State of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.901Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILERoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
tai.plmn Id.mcc TARIFFThis attribute provides the MCC of tracking area list of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.902Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
tai.plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the MNC of tracking area list of presence information in the QFIContainer- Information .
APPLICABILITY Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
PRA.
tai.tac BUNDLEThis attribute provides the TAC of tracking area list of presence information in the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.903Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
psData OffStatus3GPP RATING_ POST_ PROCESSINGThis attribute provides the 3GPP- PS-Data- Off- Status of the QFIContainer Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.904Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qFI GY_PRE_ PROCESSINGThis attribute provides the QoS Flow Identifier ( QFI) in the QFIContainer Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.905Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
5qi GY_PRE_ PROCESSINGThis attribute provides the 5qi from the q FIContainer Information of QosData .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
arp.preempt Cap NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the ArpPreempt Cap from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.906Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
arp.preempt Vuln DEVICE_ NOT_ FOUNDThis attribute provides the ArpPreempt Value from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.907Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
arp.priority Level GY_PRE_ PROCESSINGThis attribute provides the aprPriority Level from the qFIContainer Information of QosData .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
aver Window GY_POST_ PROCESSINGThis attribute provides the Aver Window from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.908Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILERoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
defQosFlow Indication TARIFFThis attribute provides the qosFlow Indication flag from the qFIContainer Information of Qos Data .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.909Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
gbrDL GY_PRE_ PROCESSINGThis attribute provides the GBit Rate DL from the qFIContainer Information of QosData .
APPLICABILITY BUNDLERoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
gbrUl COUNTERThis attribute provides the GBit Rate UL from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.910Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
maxbr Dl RESOURCE_ POST_ PROCESSINGThis attribute provides the MaxBitRate DL from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.911Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
maxbr Ul GY_PRE_ PROCESSINGThis attribute provides the MaxBitRate UL from the qFIContainer Information of QosData .
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
max Data Burst VolAPPLICABILITY This attribute provides the MaxData Burst Vol from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.912Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
max Packet Loss Rate Dl NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the MaxPacket Loss Rate from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.913Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
max Packet Loss Rate Ul RESOURCE_ PRE_ SORTINGThis attribute provides the MaxPacket Loss Rate from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.914Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
priority Level GY_PRE_ PROCESSINGThis attribute provides the priority level from the qFIContainer Information of QosData .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
qnc NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the QNC from the q FIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.915Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
qosId THRESHOLDThis attribute provides the qosId from the q FIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.916Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
reflective Qos GY_PRE_ PROCESSINGThis attribute provides the Reflective Qos from the qFIContainer Information of QosData .
APPLICABILITY BUNDLE COUNTERRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
sharing KeyDl CALL_ RULE_ VARIABLESThis attribute provides the sharing KeyDL from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.917Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
qoSInfo.
sharing KeyUl SLICING_ PROFILEThis attribute provides the sharing KeyUL from the qFIContainer Information of QosData .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.918Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
rATType GY_PRE_ PROCESSINGThis attribute provides the RAT type of QFIContainer Information .
APPLICABILITY Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
report Time BUNDLEThis attribute provides the timestamp of the closure of QFI data container.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.919Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
SNF- ID.aMFId RATING_ POST_ PROCESSINGThis attribute provides the AMF Identifier for QFI container information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.920Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
SNF- ID.SNF- Info.
nFFqdn GY_PRE_ PROCESSINGThis attribute provides the FQDN of the NF for the QFI container information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.921Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
qFIContainer Info.
SNF- ID.SNF- Info.
n FIPv4Address GY_PRE_ PROCESSINGThis attribute provides the IPv6 address of the NF for the QFI container information.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTRoaming QBC- Info.
multiple QFIcontainer.
qFIContainer Info.
SNF- ID.SNF- Info.
n FIPv6Address NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the IPv4 address of the NF for the QFI container information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.922Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
SNF- ID.SNF- Info.
nfName DEVICE_ NOT_ FOUNDThis attribute provides the NF instance identifier for the QFI container information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.923Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
SNF- ID.SNF- Info.
nFPLMNID.
mcc GY_PRE_ PROCESSINGThis attribute provides the mobile country code.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
SNF- ID.SNF- Info.
nFPLMNID.
mnc GY_POST_ PROCESSINGThis attribute provides the mobile network code.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.924Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILERoaming QBC- Info.
multiple QFIcontainer.
qFIContainer Info.
SNF- ID.SNF- Info.
nodefunctionality TARIFFThis attribute provides the node functionality of Serving Network Function Information for the QFI container information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.925Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
timeof First Usage GY_PRE_ PROCESSINGThis attribute provides the time stamp for the first IP packet to be transmitted, and mapped to the QFI container.
APPLICABILITY BUNDLERoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
timeof Last Usage COUNTERThis attribute provides the time stamp for the last IP packet to be transmitted, and mapped to the QFI container.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.926Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
uetime Zone RESOURCE_ POST_ PROCESSINGThis attribute provides the UE Time Zone.
UE is currently located in the QFIContainer Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.927Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
ageOf Location Information GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Age OfLocation Information from the QFIContainer- Information .
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
ecgi.
eutra CellIdAPPLICABILITY This attribute provides the Eutra Location Ecgi Eutra CellId from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.928Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
ecgi.
plmn Id.
mcc NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the Eutra Location Ecgi MCC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.929Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
ecgi.
plmn Id.
mnc THRESHOLDThis attribute provides the Eutra Location Ecgi MNC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.930Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
geodetic Information GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Geographical Information from the QFIContainer- Information .
APPLICABILITY BUNDLE COUNTERRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
geographical Information CALL_ RULE_ VARIABLESTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.931Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
global Ngenb Id.n3Iwf Id SLICING_ PROFILEThis attribute provides the Eutra Location N3Iwf Id from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.932Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
global Ngenb Id.ngRanNode Id GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Ng RanNode Id from the QFIContainer- Information .
APPLICABILITY Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
global Ngenb Id.plmn Id.mcc BUNDLEThis attribute provides the Eutra Location Global Ngenb Id MCC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.933Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
global Ngenb Id.plmn Id.mnc NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the Eutra Location Global Ngenb Id MNC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.934Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
tai.plmn Id.
mcc THRESHOLDThis attribute provides the Eutra Location Tai MCC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.935Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
tai.plmn Id.
mnc GY_PRE_ PROCESSINGThis attribute provides the Eutra Location Tai MNC from the QFIContainer- Information .
APPLICABILITY BUNDLERoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
tai.tac COUNTERThis attribute provides the Eutra Location Tai Tac from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.936Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.eutra Location.
ueLocation Timestamp RESOURCE_ POST_ PROCESSINGThis attribute provides the Eutra Location Ue Location Timestamp from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.937Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.n3ga Location.
n3gpp Tai.
plmn Id.mcc GY_PRE_ PROCESSINGThis attribute provides the N3ga Location N3gpp Tai MCC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.938Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.n3ga Location.
n3gpp Tai.
plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the N3ga Location N3gpp Tai MNC from the QFIContainer- Information .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.n3ga Location.
n3gpp Tai.tac NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the N3ga Location N3gpp Tai tac from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.939Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.n3ga Location.
n3Iwf Id THRESHOLDThis attribute provides the N3ga Location N3Iwf Id from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.940Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.n3ga Location.
port Number GY_PRE_ PROCESSINGThis attribute provides the N3ga Location port number from the QFIContainer- Information .
APPLICABILITY BUNDLE COUNTERRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.n3ga Location.
ueIPv4Addr CALL_ RULE_ VARIABLESThis attribute provides the N3ga Location Ue IPV4Addr from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.941Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.n3ga Location.
ueIPv6Addr SLICING_ PROFILEThis attribute provides the N3ga Location Ue IPV6Addr from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.942Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
ageOfLocation Information GY_PRE_ PROCESSINGThis attribute provides the NrLocation AgeOf Location Information from the QFIContainer- Information .
APPLICABILITY Roaming QBC- Info.
multiple QFIcontainer.
qFIContainer Info.
ULI.nrLocation.
geodetic Information BUNDLEThis attribute provides the NrLocation AgeOf Location Information from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.943Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
geographical Information RATING_ POST_ PROCESSINGThis attribute provides the NrLocation Geographical Information from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.944Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
global GnbId.g NbId.bitLength GY_PRE_ PROCESSINGThis attribute provides the NrLocation bit length from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.945Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
global GnbId.g NbId.gNbValue GY_PRE_ PROCESSINGThis attribute provides the NrLocation gNb Value from the QFIContainer- Information .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
global GnbId.
n3Iwf Id NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the NrLocation N3Iwf Id from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.946Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
global GnbId.
ngeNbId DEVICE_ NOT_ FOUNDThis attribute provides the NrLocation ngeNbId from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.947Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
global GnbId.ng RanNode Id GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
global GnbId.
plmn Id.mcc GY_CREDIT_ REQUESTThis attribute provides the NrLocation Global Ngenb Id MCC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.948Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
global GnbId.
plmn Id.mnc RESOURCE_ POST_ PROCESSINGThis attribute provides the NrLocation Global Ngenb Id MNC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.949Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
ncgi.
nrCellId GY_PRE_ PROCESSINGThis attribute provides the NrLocation Ncgi Nr CellId from the QFIContainer- Information .
Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
ncgi.
plmn Id.
mccAPPLICABILITY This attribute provides the NrLocation Ncgi MCC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.950Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
ncgi.
plmn Id.
mnc NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the NrLocation Ncgi MNC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.951Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILERoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
tai.plmn Id.mcc TARIFFThis attribute provides the NrLocation Tai MCC from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.952Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
tai.plmn Id.mnc GY_PRE_ PROCESSINGThis attribute provides the NrLocation Tai MNC from the QFIContainer- Information .
APPLICABILITY Roaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
tai.tac BUNDLEThis attribute provides the NrLocation Tai tac from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.953Charging User Guide Charging rules Attribute name Trigger Description COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONRoaming QBC- Info.
multiple QFIcontainer.
q FIContainer Info.
ULI.nrLocation.
ueLocation Timestamp RATING_ POST_ PROCESSINGThis attribute provides the NrLocation Ue Location Timestamp from the QFIContainer- Information .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.954Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
time GY_PRE_ PROCESSINGThis attribute provides the amount of time in the Multiple QFIcontainer .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.955Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
total Volume GY_PRE_ PROCESSINGThis attribute provides the amount of volume in both uplink and donwlink directions in the Multiple QFIcontainer .
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTRoaming QBC- Info.
multiple QFIcontainer.
trigger Timestamp NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the timestamp of the reporting trigger occurence in the Multiple QFIcontainer .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.956Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDRoaming QBC- Info.
multiple QFIcontainer.
triggers.
max Number Ofccc DEVICE_ NOT_ FOUNDThis attribute provides the maximum number of charging condition changes for a list of QFI containers.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.957Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
triggers.
time Limit GY_PRE_ PROCESSINGThis attribute provides the time limit for a list of QFI containers.
( If the trigger type is data volume limit expiry. )
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLESRoaming QBC- Info.
multiple QFIcontainer.
triggers.
Trigger Category GY_POST_ PROCESSINGThis attribute provides the trigger category of triggers for a list of QFI containers.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.958Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILERoaming QBC- Info.
multiple QFIcontainer.
triggers.
Trigger Type TARIFFThis attribute provides the NCHF trigger type of triggers for a list of QFI containers.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.959Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
multiple QFIcontainer.
triggers.
volume Limit GY_PRE_ PROCESSINGThis attribute provides the volume limit for a list of QFI containers.
( If the trigger type is expiry of data volume. )
APPLICABILITY BUNDLERoaming QBC- Info.
multiple QFIcontainer.
triggers.
volume Limit64 COUNTERThis attribute provides the volume limit for a list of QFI containers.
( If the trigger type is expiry of data volume.
)Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.960Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGRoaming QBC- Info.
multiple QFIcontainer.
uplink Volume RESOURCE_ POST_ PROCESSINGThis attribute provides the amount of volume in uplink direction in the Multiple QFIcontainer .Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.961Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
Roaming Charging Profile.
partial Record Method GY_PRE_ PROCESSINGThis attribute provides the Partial Record Method of the Roaming Charging Profile.
Roaming QBC- Info.
Roaming Charging Profile.
trigger.
max Number OfcccAPPLICABILITYTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.962Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the maximum number of charging condition changes for a Roaming Charging Profile.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONRoaming QBC- Info.
Roaming Charging Profile.
trigger.
time Limit NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the time limit for the Roaming Charging Profile.
( If the trigger type is data volume limit expiry.
)Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.963Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDRoaming QBC- Info.
Roaming Charging Profile.
trigger.
Trigger Category RESOURCE_ PRE_ SORTINGThis attribute provides the trigger category of triggers for the Roaming Charging Profile.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.964Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
Roaming Charging Profile.
trigger.
Trigger Type GY_PRE_ PROCESSINGThis attribute provides the NCHF trigger type of triggers for the Roaming Charging Profile.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSINGRoaming QBC- Info.
Roaming Charging Profile.
trigger.
volume Limit NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the volume limit for the Roaming Charging Profile.
( If the trigger type is data volume limit expiry.
)Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.965Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFRoaming QBC- Info.
Roaming Charging Profile.
trigger.
volume Limit64 THRESHOLDThis attribute provides the volume limit for the Roaming Charging Profile.
( If the trigger type is data volume limit expiry.
)Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.966Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGRoaming QBC- Info.
uPFID GY_PRE_ PROCESSINGThis attribute provides the UPF Identifier in the Roaming QBCInformation .
APPLICABILITY BUNDLE COUNTERService- Context- Id GY_POST_ PROCESSINGThis attribute provides the service context Id.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.967Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLES UC_PROCESSING DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSINGservice Specification Information RATING_ POST_ PROCESSINGThis attribute provides the service specific information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.968Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD CALL_ RULE_ VARIABLES UC_PROCESSING DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGSession- Id GY_PRE_ PROCESSINGThis attribute provides the session Id.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.969Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGSubscription- Id-Data GY_PRE_ PROCESSINGThis attribute provides the subscription Id data value.
APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLDSubscription- Id-Data- By-Type DEVICE_ NOT_ FOUNDThis attribute provides the subscription Id by type.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.970Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGSubscription- Id-Type GY_PRE_ PROCESSINGThis attribute provides the type of subscription Id.
APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLEStriggers.
max Number Ofccc GY_POST_ PROCESSINGThis attribute provides the maximum number of charging condition changes for an used service unit.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.971Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING BUNDLEtriggers.
Trigger Type List COUNTERThe events whose occurrence lead to charging event is issued towards the CHF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.972Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGtriggers.
time Limit GY_PRE_ PROCESSINGThis attribute provides the time limit for a request.
( If the trigger type is data volume limit expiry. )
APPLICABILITY BUNDLEtriggers.
Trigger Categories CALL_ RULE_ VARIABLESThis attribute provides the trigger category of triggers at the root level.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.973Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGtriggers.
Trigger Types RESOURCE_ POST_ PROCESSINGThis attribute provides the NCHF trigger type of triggers at the root level.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.974Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGtriggers.
volume Limit GY_PRE_ PROCESSINGThis attribute provides the volume limit at the root level.
( If trigger type is expiry of data volume. )
triggers.
volume Limit64 RESOURCE_ POST_ PROCESSING This attribute provides the volume limit at the root level.
( If the trigger type is expiry of data volume.
)Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.975Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY THRESHOLD TARIFF NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION SLICING_ PROFILE GY_POST_ PROCESSING RATING_ POST_ PROCESSING BUNDLE COUNTER CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING GY_PRE_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONTrim- Country- Code NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the country code.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.976Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING CALL_ RULE_ VARIABLES SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDUser- Equipment- Info.
User- Equipment- Info- Type RESOURCE_ PRE_ SORTINGThis attribute provides the User Equipment Information type.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.977Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTINGUser- Equipment- Info.
User- Equipment- Info- Value GY_PRE_ PROCESSINGThis attribute provides the User Equipment Information value.
registration Charging Information.
user Locationinfo.
eutra Location.
tai.nidAPPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUNDThis attribute provides eutra Location tai nid of user Locationinfo from registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.978Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
ecgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location ecgi nid of user Locationinfo from registration Charging Information registration Charging Information.
user Locationinfo.
eutra Location.
ignore EcgiAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the eutra Location ignore Ecgi of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.gNb Id.bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.979Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.gNb Id.gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa-f0-9] {6,8}$' The value of the g NB ID is encoded in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Example: A 30 bit value " 382A3F47" indicates a gNB ID with value 0x382A3F47 A 22 bit value " 2A3F47" indicates a g NB ID with value 0x2A3F47 registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.nge NbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB.
registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDThis attribute provides eutra Location global Ngenb Id wagf Id of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.980Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global Ngenb Id tngf Id of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global Ngenb Id nid of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.eNb IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis attribute provides eutra Location global Ngenb Id eNbId of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.981Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.plmn Id.
mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the nr Location global EnbId plmn Id mcc from registration Charging Information.
registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.plmn Id.
mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the nr Location global EnbId plmn Id mcc from registration Charging Information.
registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWFTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.982Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.ngRan Node IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.
registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.gNbId.
bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32. registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.gNbId.
gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa- f0-9]{6,8}$' The value of the g NB ID is encoded in hexadecimal representation.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.983Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGEach character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Examples: A 30 bit value " 382A3F47" indicates a gNB ID with value 0x382A3F47 A 22 bit value " 2A3F47" indicates a g NB ID with value 0x2A3F47 registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.ngeNb IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global EnbId wagf Id of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.984Charging User Guide Charging rules Attribute name Trigger Description registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global EnbId tngf Id of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global EnbId nid of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
eutra Location.
global EnbId.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides eutra Location global EnbId eNbId of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.985Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
nrLocation.
tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location tai nid of user Locationinfo from registration Charging Information registration Charging Information.
user Locationinfo.
nrLocation.
ncgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location ncgi nid of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
nrLocation.
ignore NcgiAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides nr Location ignore Ncgi of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.986Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location global Gnb Id wagf Id of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location global GnbId tngf Id of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDThis attribute provides nr Location global Gnb Id nid of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.987Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
nrLocation.
global GnbId.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location global GnbId eNbId of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides n3gpp Tai tai nid of n3ga Location of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.ssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDThis attribute provides tnap Id ss Id of n3ga Location of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.988Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.bssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides tnap Id bss Id of n3ga Location of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.civic AddressAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides tnap Id civic Address of n3ga Location of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
n3ga Location.
twap Id.ssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis attribute provides twap Id ss Id of n3ga Location of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.989Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
n3ga Location.
twap Id.bssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides twap Id bss Id of n3ga Location of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
n3ga Location.
twap Id.civic AddressAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides twap Id civic Address of n3ga Location of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
n3ga Location.
hfcNode Id.hfcNIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThis attribute provides hfc Node Id hfc NId of n3ga Location of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.990Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING registration Charging Information.
user Locationinfo.
n3ga Location.
gliAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides gli of n3ga Location of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
n3ga Location.
gciAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides gci of n3ga Location of user Locationinfo registration Charging Information registration Charging Information.
user Locationinfo.
n3ga Location.
w5gban Line TypeAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides w5gban Line Type of n3ga Location of user Locationinfo registration Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.991Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
ranNode Id.
ngRanNode IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.
sMSCharging Information.
user Locationinfo.
eutra Location.
tai.plmn Id.mccGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDThis attribute provides the SMS ULI Eutra Location Tai Mcc in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.992Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
tai.plmn Id.mncGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location Tai Mnc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
tai.tacAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location Tai Tac in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.993Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
user Locationinfo.
eutra Location.
tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location Tai Nid in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
ecgi.
plmn Id.mccGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location Ecgi Mcc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
ecgi.
plmn Id.mncGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLESThis attribute provides the SMS ULI Eutra Location Ecgi Mnc in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.994Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
ecgi.
eutra CellIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location Ecgi Eutra Cell Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
ecgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides the SMS ULI Eutra Location Ecgi Nid in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.995Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
ignore EcgiAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI Eutra Location Ignore Ecgi in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
ageOfLocation InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFThis attribute provides the SMS ULI Eutra Location age OfLocation Information in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.996Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
geographical InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location geographical Information in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
geodetic InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location geodetic Information in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.997Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.plmn Id.mccGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global Ngenb Id Mcc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.plmn Id.mncGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global Ngenb Id Mnc in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.998Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global Ngenb Id n3Iwf Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.ngRanNode IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global Ngenb Id ng RanNode Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.gNbId.bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis attribute provides the SMS ULI Eutra Location global Ngenb Id gNbId bit Length in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.999Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.gNbId.gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global Ngenb Id gNbId gNBValue in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.ngeNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the SMS ULI Eutra Location global Ngenb Id nge NbId in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1000Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global Ngenb Id wagf Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFThis attribute provides the SMS ULI Eutra Location global Ngenb Id tngf Id in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1001Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global Ngenb Id nid in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global Ngenb Id eNbId in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1002Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.plmn Id.mccGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global EnbId Mcc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.plmn Id.mncGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global EnbId Mnc in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1003Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global EnbId n3Iwf Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.ngRanNode IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global EnbId ng RanNode Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.gNbId.bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis attribute provides the SMS ULI Eutra Location global EnbId gNbId bit Length in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1004Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.gNbId.gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global EnbId gNbId gNBValue in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.ngeNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the SMS ULI Eutra Location global EnbId nge NbId in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1005Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global EnbId wagf Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDThis attribute provides the SMS ULI Eutra Location global EnbId tngf Id in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1006Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global EnbId nid in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
eutra Location.
global EnbId.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI Eutra Location global EnbId eNbId in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1007Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
user Locationinfo.
nr Location.
tai.plmn Id.mccGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI nr Location tai Mcc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
tai.plmn Id.mncGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI nr Location tai Mnc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
tai.tacAPPLICABILITY CALL_ RULE_ VARIABLESThis attribute provides the SMS ULI nr Location tai tac in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1008Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
nr Location.
tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI nr Location tai nid in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
ncgi.
plmn Id.mccGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides the SMS ULI nr Location ncgi Mcc in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1009Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
nr Location.
ncgi.
plmn Id.mncGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI nr Location ncgi Mnc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
ncgi.
nrCellIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFThis attribute provides the SMS ULI nr Location ncgi nr CellId in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1010Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
nr Location.
ncgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI nr Location ncgi nid in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
ignore NcgiAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI nr Location ignore ncgi in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
ageOfLocation InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEThis attribute provides the SMS ULI nr Location ageOfLocation Information in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1011Charging User Guide Charging rules Attribute name Trigger Description TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLD sMSCharging Information.
user Locationinfo.
nr Location.
geographical InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI nr Location geographical Information in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
geodetic InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI nr Location geodetic Information in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.plmn Id.mccGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThis attribute provides the SMS ULI nr Location global GnbId Mcc in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1012Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.plmn Id.mncGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI nr Location global GnbId Mnc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI nr Location global GnbId n3Iwf Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.ngRanNode IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_This attribute provides the SMS ULI nr Location global GnbId ng RanNode Id in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1013Charging User Guide Charging rules Attribute name Trigger Description CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.gNbId.bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI nr Location global GnbId gNbId bit Length in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.gNbId.gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER DEVICE_ NOT_ FOUND GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI nr Location global GnbId gNbId gNBValue in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.ngeNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER DEVICE_ NOT_ FOUND GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_This attribute provides the SMS ULI nr Location global GnbId nge NbId in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1014Charging User Guide Charging rules Attribute name Trigger Description CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER DEVICE_ NOT_ FOUND GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI nr Location global GnbId wagf Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER DEVICE_ NOT_ FOUND GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI nr Location global GnbId tngf Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThis attribute provides the SMS ULI nr Location global GnbId nid in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1015Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLD sMSCharging Information.
user Locationinfo.
nr Location.
global GnbId.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI nr Location global GnbId eNbid in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.plmn Id.mccGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF RESOURCE_ PRE_ SORTING THRESHOLD DEVICE_ NOT_ FOUND GY_PRE_ PROCESSINGThis attribute provides the SMS ULI n3ga Location n3gpp Tai Mcc in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.plmn Id.mncGY_CREDIT_ REQUEST APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis attribute provides the SMS ULI n3ga Location n3gpp Tai Mnc in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1016Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLD sMSCharging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.tacAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location n3gpp Tai tac in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location n3gpp Tai nid in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis attribute provides the SMS ULI n3ga Location n3Iwf Id in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1017Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLD sMSCharging Information.
user Locationinfo.
n3ga Location.
tnap Id.ssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location tnap Id ss Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
tnap Id.bssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location tnap Id bss Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
tnap Id.civic AddressAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_This attribute provides the SMS ULI n3ga Location tnap Id civic Address in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1018Charging User Guide Charging rules Attribute name Trigger Description CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLD sMSCharging Information.
user Locationinfo.
n3ga Location.
twap Id.ssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location twap Id ss Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
twap Id.bssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location twap Id bss Id in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
twap Id.civic AddressAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThis attribute provides the SMS ULI n3ga Location twap Id civic Address in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1019Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLD sMSCharging Information.
user Locationinfo.
n3ga Location.
hfcNode Id.hfcNIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location hfc Node Id hfc NId in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
gliAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location gli in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
gciAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEThis attribute provides the SMS ULI n3ga Location gci in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1020Charging User Guide Charging rules Attribute name Trigger Description TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLD sMSCharging Information.
user Locationinfo.
n3ga Location.
w5gban Line TypeAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location w5gban Line Type in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
ueIPv4AddrAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location ue IPv4Addr in s MSCharging Information.
sMSCharging Information.
user Locationinfo.
n3ga Location.
ueIPv6AddrAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the SMS ULI n3ga Location ue IPv6Addr in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1021Charging User Guide Charging rules Attribute name Trigger Description sMSCharging Information.
user Locationinfo.
n3ga Location.
port NumberAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the SMS ULI n3ga Location port Number in s MSCharging Information.
sMSCharging Information.
Message- Class.
Class- IdentifierAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the Message class identifier in s MSCharging Information.
sMSCharging Information.
Message- Class.
Token- TextAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING THRESHOLDThis attribute provides the Message class token text in s MSCharging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1022Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Locationinfo.
eutra Location.
tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the eutra Location tai nid of user Locationinfo N2Connection Charging Information.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
ecgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the eutra Location ecgi nid of user Locationinfo N2Connection Charging Information.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
ignore EcgiAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis attribute provides eutra Location ignore Ecgi of user Locationinfo N2Connection Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1023Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.gNb Id.bitLengthAPPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32. n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.gNb Id.gNBValueAPPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa-f0-9] {6,8}$' The value of the g NB ID is encoded in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Examples: A 30 bit value " 382A3F47" indicates a g NB ID with valueTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1024Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING0x382A3F47 A 22 bit value " 2A3F47" indicates a gNB ID with value 0x2A3F47.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.nge NbIdAPPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
wagf IdAPPLICABILITY BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global Ngenb Id wagf Id of user Locationinfo N2Connection Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1025Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.tngf IdAPPLICABILITY BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global Ngenb Id tngf Id of user Locationinfo N2Connection Charging Information.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.nidAPPLICABILITY BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global Ngenb Id nid of user Locationinfo N2Connection Charging Information.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.eNb IdAPPLICABILITY BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThis attribute provides eutra Location global Ngenb Id eNbId of user Locationinfo N2Connection Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1026Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.plmn Id.
mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the eutra Location global EnbId plmn Id mcc from n2Connection Charging Information.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.plmn Id.
mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEThe Mobile Network Code.
This attribute provides the eutra Location global EnbId plmn Id mnc from n2Connection Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1027Charging User Guide Charging rules Attribute name Trigger Description TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWF.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.ngRan Node IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1028Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.gNbId.
bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32. n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.gNbId.
gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa- f0-9]{6,8}$' The value of the g NB ID is encoded in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Example: A 30 bit value " 382A3F47" indicates a gNB ID with value 0x382A3F47 A 22 bit value " 2A3F47" indicates a g NB ID with value 0x2A3F47Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1029Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.ngeNb IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global EnbId wagf Id of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis attribute provides eutra Location global EnbId tngf Id of user Locationinfo N2Connection Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1030Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global EnbId nid of user Locationinfo N2Connection Charging Information.
n2Connection Charging Information.
user Locationinfo.
eutra Location.
global EnbId.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides eutra Location global EnbId eNbId of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1031Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
nrLocation.
tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location tai nid of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
nrLocation.
ncgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFThis attribute provides nr Location ncgi nid of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1032Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
nrLocation.
ignore NcgiAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location ignore Ncgi of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location global Gnb Id wagf Id of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1033Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location global Gnb Id tngf Id of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location global GnbId nid of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
nrLocation.
global GnbId.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis attribute provides nr Location global Gnb Id eNbId of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1034Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides n3gpp Tai nid n3ga Location of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.ssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides tnap Id ss Id of n3ga Location of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1035Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.bssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides tnap Id bss Id of n3ga Location of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.civic AddressAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFThis attribute provides tnap Idcivic Address of n3ga Location of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1036Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
n3ga Location.
twap Id.ssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides twap Id ss Id of n3ga Location of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
n3ga Location.
twap Id.bssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides twap Id bss Id of n3ga Location of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1037Charging User Guide Charging rules Attribute name Trigger Description n2Connection Charging Information.
user Locationinfo.
n3ga Location.
twap Id.civic AddressAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides twap Id civic Address of n3ga Location of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
n3ga Location.
hfcNode Id.hfcNIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides hfc Node Id hfc NId of n3ga Location of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
n3ga Location.
gliAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis attribute provides gli of n3ga Location of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1038Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING n2Connection Charging Information.
user Locationinfo.
n3ga Location.
gciAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides gci of n3ga Location of user Locationinfo N2Connection Charging Information n2Connection Charging Information.
user Locationinfo.
n3ga Location.
w5gban Line TypeAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides w5gban Line Type of n3ga Location of user Locationinfo N2Connection Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1039Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
location Reporting Message TypeAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGLocation reporting message type location Reporting Charging Information.
user Information.
served GPSIAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides served GPSI from location Reporting Charging Information/ User Information location Reporting Charging Information.
user Information.
served PEIAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides served PEI from location Reporting Charging Information/ User InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1040Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING location Reporting Charging Information.
user Information.
unauthenticated FlagAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides unauthenticated Flag from location Reporting Charging Information/ User Information location Reporting Charging Information.
user Information.
roamer InOutAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides Roamer In and Out from location Reporting Charging Information/ User Information location Reporting Charging Information.
rATType APPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDThis attribute provides ra TType from location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1041Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
tai.plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the eutra Location tai plmn Id mcc from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
eutra Location.
tai.plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the eutra Location tai plmn Id mnc from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
eutra Location.
tai.tacAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThe Tracking Area Code.
This attribute provides the eutra Location tai tac from location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1042Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location tai nid of user Locationinfo from location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
ecgi.
plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the eutra Location ecgi plmn Id mcc from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
eutra Location.
ecgi.
plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONThe Mobile Network Code.
This attribute provides the eutra Location ecgi plmn Id mcc from location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1043Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
ecgi.
eutra CellIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe E- UTRA Cell Identity.
This attribute provides the eutra Location ecgi eutra CellId from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
eutra Location.
ecgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location ecgi nid of user Locationinfo from location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
ignore EcgiAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSINGThis attribute provides eutra Location ignore Ecgi of user Locationinfo from location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1044Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
ageOfLocation InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe value represents the elapsed time in minutes since the last network contact of the mobile station.
A value of 0 indicates that the location information was obtained after a successful paging procedure for Active Location Retrieval when the UE is in idle mode or after a successful NG- RAN location reporting procedure with the e NB when the UE is in connected mode.
Any value other than 0 indicates that the location information is the last known one.
See 3GPP TS 29.
002 [ 21] clause 17.
7.8 location Reporting Charging Information.
user Locationinfo.
eutra Location.
geographical InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGRefer to geographical Information.
See 3GPP TS 23.
032 [ 23] clause 7.
3.2.
Only the description of an ellipsoid point with uncertainty circle is allowed to be used.
Allowed characters are 0- 9 and A- F. location Reporting Charging Information.
user Locationinfo.
eutra Location.
geodetic InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLERefers to Calling Geodetic Location.
See ITU- T Recommendation Q.
763 ( 1999) [ 24] clause 3.
88.2.
Only the description of an ellipsoid pointTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1045Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGwith uncertainty circle is allowed to be used.
Allowed characters are 0- 9 and A- F. location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the eutra Location global Ngenb Id plmn Id mcc from location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLESThe Mobile Network Code.
This attribute provides the eutra Location global Ngenb Id plmn Id mnc from location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1046Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWF.
location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.ng RanNode IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN nodeTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1047Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.gNb Id.bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32. location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.gNb Id.gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa- f0-9]{6,8}$' The value of the g NB ID is encoded in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Example: A 30 bit value " 382A3F47" indicates a gNB ID with value 0x382A3F47 A 22 bit value " 2A3F47" indicates a g NB ID with value 0x2A3F47 location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.nge NbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTERThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1048Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.
wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global Ngenb Id wagf Id of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThis attribute provides eutra Location global Ngenb Id tngf Id of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1049Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global Ngenb Id nid of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
global Ngenb Id.eNb IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDThis attribute provides eutra Location global Ngenb Id eNbfId of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1050Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.plmn Id.
mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the eutra Location global EnbId plmn Id mcc from location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.plmn Id.
mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the eutra Location global EnbId plmn Id mnc from location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLEThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWF.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1051Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.ngRan Node IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.
location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.gNbId.
bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1052Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.gNbId.
gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa- f0-9]{6,8}$' The value of the g NB ID is encoded in hexadecimal representation.
Each character in the string takes a value of 0- 9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Example: A 30 bit value " 382A3F47" indicates a gNB ID with value 0x382A3F47 A 22 bit value " 2A3F47" indicates a g NB ID with value 0x2A3F47 location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.ngeNb IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB.
location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides eutra Location global EnbId wagf Id of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1053Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global EnbId tngf Id of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides eutra Location global EnbId nid of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
eutra Location.
global EnbId.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDThis attribute provides eutra Location global EnbId eNbId of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1054Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
nrLocation.
tai.plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the nr Location tai plmn Id mcc from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
nrLocation.
tai.plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the nr Location tai plmn Id mnc from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
nrLocation.
tai.tacAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSINGThe Tracking Area Code.
This attribute provides the nr Location tai tac from location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1055Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
nrLocation.
tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location tai nid of user Locationinfo from location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
nrLocation.
ncgi.
plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the nr Location ncgi plmn Id mcc from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
nrLocation.
ncgi.
plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONThe Mobile Network Code.
This attribute provides the nr Location ncgi plmn Id mnc from location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1056Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
nrLocation.
ncgi.
nrCellIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location ncgi nr Cell Id of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
nrLocation.
ncgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location ncgi nid of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
nrLocation.
ignore NcgiAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSINGThis attribute provides nr Location ignore Ncgi of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1057Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
nrLocation.
ageOfLocation InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location age Of Location Information of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
nrLocation.
geographical InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location geographical Information of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
nrLocation.
geodetic InformationAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLEThis attribute provides nr Location geodetic Information of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1058Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.plmn Id.
mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the nr Location global GnbId plmn Id mcc from location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.plmn Id.
mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the nr Location global GnbId plmn Id mnc from location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1059Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWF location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.ngRan Node IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN node belongs to 3GPP access type.
If included, this IE includes the identity of the RAN node.
location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.gNbId.bit LengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGUnsigned integer representing the bit length of the g NB ID as defined in clause 9.
3.1.6 of 3GPP TS 38.
413 [ 11], within the range 22 to 32.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1060Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.gNbId.g NBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis represents the identifier of the g NB.
The string is formatted with pattern: ' ^[A-Fa- f0-9]{6,8}$' The value of the g NB ID is encoded in hexadecimal representation.
Each character in the string takes a value of 0-9, a- f, or A- F and represents four bits.
The padding 0 is added to make multiple nibbles, the most significant character representing the padding 0 if required together with the four most significant bits of the g NB ID appears first in the string, and the character representing the four least significant bit of the g NB ID appears last in the string.
Example: A 30 bit value " 382A3F47" indicates a gNB ID with value 0x382A3F47 A 22 bit value " 2A3F47" indicates a g NB ID with value 0x2A3F47 location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.ngeNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the RAN Node Id represents a NG- eNB.
When present, this IE contains the identifier of an NG- eNB.
location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUNDThis attribute provides nr Location global GnbId wagf Id of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1061Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location global GnbId tngf Id of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nr Location global Gnb Id nid of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
nrLocation.
global GnbId.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDThis attribute provides nr Location global GnbId eNbId of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1062Charging User Guide Charging rules Attribute name Trigger Description DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.plmn Id.
mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Country Code.
This attribute provides the n3ga Location n3gpp Tai plmn Id mcc from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.plmn Id.
mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe Mobile Network Code.
This attribute provides the n3ga Location n3gpp Tai plmn Id mnc from location Reporting Charging Information.
location Reporting Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.tacAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThe Tracking Area Code.
This attribute provides the n3ga Location n3gpp Tai tac from location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1063Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
n3ga Location.
n3gpp Tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides n3ga Location n3gpp Tai nid of user Locationinfo from location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
n3ga Location.
n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis IE is included if the AN node represents a N3IWF.
When present, this IE contains the identifier of the N3IWF location Reporting Charging Information.
user Locationinfo.
n3ga Location.
ueIPv4AddrAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONUE/N5CW device local IPv4 address ( used to reach the N3IWF, TNGF or TWIF) .
The ue IPv4Addr or the ue IPv6Addr is present if the UE is accessing the 5GC via a trusted or untrusted non- 3GPP access and the information is availableTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1064Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
n3ga Location.
ueIPv6AddrAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThe UE/ N5CW device local IPv6 address ( used to reach the N3IWF, TNGF or TWIF) .
The ue IPv4Addr or the ue IPv6Addr is present if the UE is accessing the 5GC via a trusted or untrusted non- 3GPP access and the information is available.
location Reporting Charging Information.
user Locationinfo.
n3ga Location.
port NumberAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGUDP or TCP source port number.
It is present if the UE is accessing the 5GC via a trusted or untrusted non- 3GPP access and NAT is detected.
location Reporting Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.ssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTThis attribute provides tnap Id ss Id of n3ga Location of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1065Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.bssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides tnap Id bss Id of n3ga Location of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.civic AddressAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides tnap Id civic Address of n3ga Location of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
n3ga Location.
twap Id.ssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSINGThis attribute provides twap Id ss Id of n3ga Location of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1066Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.bssIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides twap Id bss Id of n3ga Location of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
n3ga Location.
tnap Id.civic AddressAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides twap Id civic Address of n3ga Location of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
n3ga Location.
hfcNode Id.hfcNIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLEThis attribute provides hfc Node Id hfc NId of n3ga Location of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1067Charging User Guide Charging rules Attribute name Trigger Description COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
user Locationinfo.
n3ga Location.
gliAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides gli of n3ga Location of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
user Locationinfo.
n3ga Location.
gciAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides gci of n3ga Location of user Locationinfo in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1068Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
user Locationinfo.
n3ga Location.
w5gban Line TypeAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides w5gban Line Type of n3ga Location of user Locationinfo in location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
praIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides pra Id of presence Reporting Area Information of in location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
presence StateAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides presence State of presence Reporting Area Information of in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1069Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
tai.plmn Id.
mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the MCC of tracking area list of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
tai.plmn Id.
mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the MNC of tracking area list of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
tai.tacAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThe Tracking Area Code.
This attribute provides the presence Reporting Area Information tai tac from location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1070Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
tai.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides presence Reporting Area Information tai nid from location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
ecgi.
eutra CellIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides presence Reporting Area Information ecgi eutra CellId from location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
ecgi.
plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTERThis attribute provides the MCC of Ecgi of presence Reporting Area Information in the location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1071Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
ecgi.
plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the MNC of Ecgi of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
ecgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONThis attribute provides presence Reporting Area Information ecgi nid of in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1072Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
ncgi.
plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the MCC of Ncgi of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
ncgi.
plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEThis attribute provides the MNC of Ncgi of presence Reporting Area Information in the location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1073Charging User Guide Charging rules Attribute name Trigger Description CALL_ RULE_ VARIABLES TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
ncgi.
nrCell IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides presence Reporting Area Information ncgi nr CellId of in location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
ncgi.
nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides presence Reporting Area Information ncgi nid of in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1074Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the MCC of Global Ran Node Id of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the MNC of Global Ran Node Id of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.ngRanNode IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the Ng RanNode Id of Global RanNode Id of presence Reporting Area Information in the location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1075Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the n3Iwf Id of Global RanNode Id of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.gNbId.bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the bit Length of Global RanNode Id.gNbId of presence Reporting Area Information in the location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1076Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.gNbId.gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the g NBValue of Global RanNode Id.gNbId of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.ngeNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the nge NbId of Global RanNode Id of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONThis attribute provides the wagf Id of Global Ran Node Id of presence Reporting Area Information in the location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1077Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the tngf Id of Global Ran Node Id of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the nid of Global Ran Node Id of presence Reporting Area Information in the location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1078Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
presence Reporting Area Information.
global Ran Node Id.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the e NbId of Global Ran Node Id of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
additional PraIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the additional PraId of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.plmn Id.mccAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis attribute provides the MCC of global Enb Id of presence Reporting Area Information in the location Reporting Charging Information.Table 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1079Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.plmn Id.mncAPPLICABILITY GY_CREDIT_ REQUEST BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides the MNC of global Enb Id of presence Reporting Area Information in the location Reporting Charging Information.
location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.ngRanNode IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides ng RanNode Id of global EnbId of presence Reporting Area Information of in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1080Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.n3Iwf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides n3Iwf Id of global Enb Id of presence Reporting Area Information of in location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.gNbId.bitLengthAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides bit Length of global Enb Id of presence Reporting Area Information of in location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.gNbId.gNBValueAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis attribute provides g NBValue of global Enb Id of presence Reporting Area Information of in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1081Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSING location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.ngeNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nge NbId of global Enb Id of presence Reporting Area Information of in location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.wagf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides wagf Id of global Enb Id of presence Reporting Area Information of in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1082Charging User Guide Charging rules Attribute name Trigger Description location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.tngf IdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides tngf Id of global EnbId of presence Reporting Area Information of in location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.nidAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGThis attribute provides nid of global EnbId of presence Reporting Area Information of in location Reporting Charging Information location Reporting Charging Information.
presence Reporting Area Information.
global Enb Id.eNbIdAPPLICABILITY CALL_ RULE_ VARIABLES BUNDLE COUNTER GY_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis attribute provides e NbId of global EnbId of presence Reporting Area Information of in location Reporting Charging InformationTable 53: NCHF_CHARGING_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1083Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY BUNDLE COUNTER CALL_ RULE_ VARIABLES GY_POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD RESOURCE_ PRE_ SORTINGUser- Name GY_PRE_ PROCESSINGThis attribute provides the user name from the CCR.Table 53: NCHF_CHARGING_MESSAGE source context (continued) 4.6.
17 NUMBER_PORTABILITY source context Attribute name Trigger Description External- MNP- Query IMS_ CALL_ ESTABLISHMENT MMS_ CALL_ ESTABLISHMENT SMS_ CALL_ ESTABLISHMENT GY_PRE_ PROCESSING GY_CREDIT_ REQUESTThis attribute queries external MNP server through the REST API to get the routing number for a specified B- number.Table 54: NUMBER_PORTABILITY source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1084Charging User Guide Charging rules Attribute name Trigger Description GY_POST_ PROCESSING RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION GY_PRE_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION TARIFF RATING_ POST_ PROCESSING APPLICABILITYGet- Record RESOURCE_ PRE_ SORTINGThis attribute returns the map entry fetched from the database.
IMS_ CALL_ ESTABLISHMENT Get- Value IMS_ CALL_ MODIFICATIONThis attribute provides id for the number portability entry table.Table 54: NUMBER_PORTABILITY source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1085Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION GY_PRE_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION TARIFF RATING_ POST_ PROCESSING APPLICABILITY RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENTSubscriber- Is-Present SMS_ CALL_ TERMINATIONThis attribute returns Boolean values for whether the subscriber is present in NCC.
The attribute has the following arguments: •Called Party_ STRING: A valid IMSI/ MSISDN ( E.164) /NAI/ SIP URI string for the device.
•Index OfType_ ENUM: Indicates the type for the value provided: IMSI, MSISDN, NAI, SIP URI, etc.
If the value belongs to a saved device it returns true .
Otherwise, it returns false .Table 54: NUMBER_PORTABILITY source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1086Charging User Guide Charging rules Attribute name Trigger Description MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION GY_PRE_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION TARIFF RATING_ POST_ PROCESSING APPLICABILITY RESOURCE_ PRE_ SORTINGNote : •NR is also supported.
•GPSI is mapped to E164.
If GSPI is needed, operator can provide it without providing type.
•SUPI is mapped to IMSI or NAI ( depending on its form) .
So, if SUPI is required, either IMSI or NAI format is used.Table 54: NUMBER_PORTABILITY source context (continued) 4.6.
18 POLICY_COUNTER_STATUS_CHANGE source context Attribute name Trigger Description Class- Of-Service POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the Class of Service as defined in the Custom Data Dictionary of device.
If Segment custom data is not present in the device, then thisTable 55: POLICY_COUNTER_STATUS_CHANGE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1087Charging User Guide Charging rules Attribute name Trigger Description attribute contains the charging service Id.
Billing- Account- Id POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the Billing Account Id as defined in the Custom Data Dictionary of Device.
If Billing Account ID custom data is not present in the device, then this attribute contains the account Id.
Unix- Timestamp POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the Timestamp when notification was generated.
Unix- Timestamp- Ms POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the Timestamp when notification was generated in milliseconds.
Discount- Id POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the bucket or counter definition Id.
Policy- Counter- Id POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the Id of policy counter.
Bundle- Name POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the bundle name ( without MVNO) corresponding to the subscription that is present in the bucket, or counter.
Charging- Service POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the charging service name ( without MVNO) that is present in the bucket, or counter.Table 55: POLICY_COUNTER_STATUS_CHANGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1088Charging User Guide Charging rules Attribute name Trigger Description Usage- From- Last- CCR POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the Used Service Units corresponding to a single MSCC.
Note : This attribute is present only for CALL scenario ( that is, when the value of Trigger- Source is CALL .
Account- Id POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the Account Id ( without MVNO) corresponding to the subscription that is present in the bucket, or counter.
Note : Only the first account of the subscription is considered for this attribute.
If device has multiple subscriptions, purchased by multiple accounts, then this attribute is filled by the first fetched account of the subscription.
Policy- Counter- Previous- State POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the previous state of policy counter.
Policy- Counter- New- State POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the current state of policy counter.
Trigger- Source POLICY_ COUNTER_ STATUS_ CHANGEIt specifies the event which triggers this notification.
It has the following possible values:Table 55: POLICY_COUNTER_STATUS_CHANGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1089Charging User Guide Charging rules Attribute name Trigger Description •CALL •LIFECYCLE •PROVISIONINGTable 55: POLICY_COUNTER_STATUS_CHANGE source context (continued) 4.6.
19 PROPERTIES source context Attribute name Trigger Description Get- Java- Property All Triggers This attribute retrieves the value of the Java property with the given name.
Get- Java- Property- With- Default All Triggers This attribute retrieves the value of the Java property with the given name.
If the property is not defined, then the supplied default value is returned.
Get- System- Property All Triggers This attribute provides the value of the given system ( managed object) property either from the DB.Table 56: PROPERTIES source context 4.6.20 RATING_POSTPROCESSING source context Attribute name Trigger Description Billing- Account- Id RATING_ POST_ PROCESSING This attribute provides the Billing Account id defined in the Custom Data Dictionary of Device.
Bundle- Name RATING_ POST_ PROCESSING This attribute provides the name of the Bundle, subscribed by the device.
Class- Of-Service RATING_ POST_ PROCESSING This attribute provides the Class of Service as defined in the Custom Data Dictionary of Device.
Counter- Current- Value RATING_ POST_ PROCESSING This attribute provides current value of the counter.Table 57: RATING_POSTPROCESSING source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1090Charging User Guide Charging rules Attribute name Trigger Description Counter- Overage- Count RATING_ POST_ PROCESSING This attribute provides overage count of the counter.
Counter- Overage- Limit RATING_ POST_ PROCESSING This attribute provides overage limit of the counter.
Counter- Usage- Limit RATING_ POST_ PROCESSING This attribute provides usage limit of the counter.
Current- Value RATING_ POST_ PROCESSING This attribute provides current value of resource without reservation.
Discount- Id RATING_ POST_ PROCESSING This attribute provides the discount Id.
Last- Billing- Cycle- Timestamp RATING_ POST_ PROCESSING This attribute provides the timestamp of Last billing cycle reset.
Last- Crossed- Threshold- Value RATING_ POST_ PROCESSING This attribute provides the value of last crossed threshold.
Reset- Timestamp RATING_ POST_ PROCESSING This attribute provides the timestamp of last reset of resource.
Resource- Type RATING_ POST_ PROCESSING This attribute provides the Type of Resource.
Type- Of-Service RATING_ POST_ PROCESSING This attribute provides the Type of Service.
Resource- Trigger- Type RATING_ POST_ PROCESSING This attribute checks whether the resource is triggered for Reservation/ Commit.
Unit- Of-Remaining- Allowance RATING_ POST_ PROCESSING This attribute provides the Unit of Remaining Allowance for Resource.
Unix- Timestamp RATING_ POST_ PROCESSING This attribute provides the Timestamp when notification was generated.
Unix- Timestamp- Ms RATING_ POST_ PROCESSING This attribute provides the timestamp when notification was generated in milliseconds.
THRESHOLD GY_POST_ PROCESSINGUsed- Service- Units RATING_ POST_ PROCESSINGThis attribute provides the AVP value of used service units.Table 57: RATING_POSTPROCESSING source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1091Charging User Guide Charging rules 4.6.21 RESOURCE_POST_PROCESSING source context Attribute name Trigger Description Balance- Committed- Amount RESOURCE_ POST_ PROCESSING This attribute provides the balance committed amount.
Billing- Account- Id RESOURCE_ POST_ PROCESSING This attribute provides the Billing Account id defined in the Custom Data Dictionary of Device.
Bucket- Committed- Units RESOURCE_ POST_ PROCESSING This attribute provides the committed units of a bucket.
Bucket- Current- Step RESOURCE_ POST_ PROCESSING This attribute provides the current step of the bucket.
Bucket- Step- Size RESOURCE_ POST_ PROCESSING This attribute indicates the bucket step size of current step.
Bucket- Step Up RESOURCE_ POST_ PROCESSING This attribute provides the value of a bucket step up flag.
Bundle- Name RESOURCE_ POST_ PROCESSING This attribute provides the name of the bundle, subscribed by the device.
Charging- Service RESOURCE_ POST_ PROCESSING This attribute provides the charging service identifier.
Class- Of-Service RESOURCE_ POST_ PROCESSING This attribute provides the Class of Service defined in the Custom Data Dictionary of Device.
Counter- Mode RESOURCE_ POST_ PROCESSING This attribute provides the charging service identifier.
Counter- Overage- Count RESOURCE_ POST_ PROCESSING This attribute provides the overage count of the counter.
Counter- Overage- Limit RESOURCE_ POST_ PROCESSING This attribute provides the overage limit of the counter.
Counter- Usage- Limit RESOURCE_ POST_ PROCESSING This attribute provides the usage limit of the counter.
Current- Resource- Type RESOURCE_ POST_ PROCESSING This attribute provides the type of a current resource.
Current- Value RESOURCE_ POST_ PROCESSING This attribute provides the current value of resource without reservation.
Discount- Id RESOURCE_ POST_ PROCESSING This attribute provides the discount id.Table 58: RESOURCE_POST_PROCESSING source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1092Charging User Guide Charging rules Attribute name Trigger Description Find- TPG- By-Prefix* RESOURCE_ POST_ PROCESSING This attribute finds the TPG Name by Prefix.
Is-Threshold- Crossed RESOURCE_ POST_ PROCESSING This attribute checks whether the threshold is crossed or not.
Last- Billing- Cycle- Timestamp RESOURCE_ POST_ PROCESSING This attribute provides the timestamp of the last billing cycle reset.
Last- Crossed- Threshold- Name RESOURCE_ POST_ PROCESSING This attribute provides the name of a last crossed threshold.
Last- Crossed- Threshold- Profile RESOURCE_ POST_ PROCESSING This attribute provides the profile of a last crossed threshold.
Last- Crossed- Threshold- Value RESOURCE_ POST_ PROCESSING This attribute provides the value of last crossed threshold.
Last- Crossed- Threshold- Of-TPG* RESOURCE_ POST_ PROCESSING This attribute provides the last crossed threshold of a given TPG.
Previous- Threshold- Name- Of-TPG RESOURCE_ POST_ PROCESSING This attribute provides the previous threshold name of a Threshold Profile Group.
Reset- Timestamp RESOURCE_ POST_ PROCESSING This attribute provides the timestamp of the last reset of a resource.
BOU- Is-Activated RESOURCE_ POST_ PROCESSING This attribute checks whether the BOU is active or not.
Resource- Type RESOURCE_ POST_ PROCESSING This attribute provides the type of resource.
Resource- Trigger- Type RESOURCE_ POST_ PROCESSING This attribute checks whether the resource is triggered for Reservation/ Commit.
Threshold- Crossed- By-Of-TPG RESOURCE_ POST_ PROCESSING This attribute returns the last crossed threshold of a threshold profile group.
Threshold- Crossed- Status RESOURCE_ POST_ PROCESSING This attribute checks whether the threshold crossed status in the current call.
TPG- Crossed- Status RESOURCE_ POST_ PROCESSING This attribute checks if any threshold of a given Threshold Profile Group is crossed or not.
Type- Of-Service RESOURCE_ POST_ PROCESSING This attribute provides the type of service.Table 58: RESOURCE_POST_PROCESSING source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1093Charging User Guide Charging rules Attribute name Trigger Description Unit- Of-Remaining- Allowance RESOURCE_ POST_ PROCESSING This attribute provides unit of remaining allowance.
Unix- Timestamp RESOURCE_ POST_ PROCESSING This attribute provides the timestamp when notification was generated.
Unix- Timestamp- Ms RESOURCE_ POST_ PROCESSING This attribute provides the timestamp when notification was generated in milliseconds.
Used- Service- Units RESOURCE_ POST_ PROCESSING This attribute provides the value of used service unit AVP.Table 58: RESOURCE_POST_PROCESSING source context (continued) Note : * The attributes Last-Crossed-Threshold-Of-TPG and Find-TPG-By-Prefix are also available for reservation.
Example: Following is an example to check whether the tag CStariffAMAcode is dumped at the charging service level and the tag tariffAMAcode at the bucket level on all the respective update and terminate requests if the threshold crosses when the attribute Last-Crossed-Threshold-Of-TPG is used in RESOURCE_POST_PROCESSING : Pre-conditions 1.Create a charging step object as follows: Field Value Name Charging Step Unit Byte Step size 200 and 50Table 59: Charging 2.Create a threshold of percentage type with percentage set at 20%.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1094Charging User Guide Charging rules Field Value Name TPG1 Percentage type Threshold Percent1Table 60: Threshold 3.Create the Charging Service object and add bucket into it with the value 128, then choose the already defined Charging step and apply the previously defined threshold into the bucket.
Field Value Name CS_1 Bucket 128 Thresholds TPG1 Charging Step Charging StepTable 61: Charging Service 4.Create bundle account and device objects as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1095Charging User Guide Charging rules Field Value Name Bundle Fee 0 Charging Service List CS_1 Usage Control [] Bundle Activation Type Normal Usage Control Service List( Policy) * []Table 62: Bundle Figure 50: Device Object Figure 51: Device Overview 5.Create a complex map object as follows: Field Value Map Name Threshold_ AMA_ MappingTable 63: Complex map object values Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1096Charging User Guide Charging rules Field Value MAP Keys Bucket ID, Threshold Name, Bucket Step MAP Values AMACodeTable 63: Complex map object values (continued) Bucket ID Threshold Name Bucket Step AMACode 128 Threshold Percent2 1 5463 128 Threshold Percent1 1 5465Table 64: Complex map object value details Figure 52: Complex map object 6.Create the rule object with rule variable and rule group under trigger ( RESOURCE_POST_PROCESSING ) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1097Charging User Guide Charging rules Figure 53: Rule Object Execution : Execute the single MSCC decentralized SCUR call with ( RG=3300 ) as follows: 1.CCR(I): RG=3300 : RSU= 30 bytes , GSU=30 bytes.
2.CCR(U1): RG=3300 : USU=30 bytes, RSU= 30 bytes, GSU=30 bytes.
3.CCR(U2): RG=3300 : USU= 30 bytes, RSU= 30 bytes, GSU=30 bytes ( ThresholdPercent1 is reached and as the total usage now becomes 60 bytes as percentage applied is of 20%) (tag CStariffAMAcode is dumped in the CDR for this request at Charging service (CS) level and tag tariffAMAcode is dumped at bucket level with value 5465.)
4.CCR(U3): RG=3300 : USU= 30 bytes, RSU= 30 bytes, GSU=30 bytes (tag CStariffAMAcode is dumped in CDR for this request at Charging service level (CS) and tag tariffAMAcode is dumped at bucket level with value 5465 as threshold was crossed in Update2 request).
5.CCR(T'): RG=3300 : USU=30 bytes (tag CStariffAMAcode is dumped in CDR for this request at Charging service level (CS) and tag tariffAMAcode is dumped at bucket level with value 5465 as threshold was crossed in Update2 request).
Figure 54: Update 2 request Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1098Charging User Guide Charging rules Figure 55: Update 3 request Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1099Charging User Guide Charging rules Figure 56: Terminate request Verification 1.Verify that in CCR(U2) when 60 bytes are consumed for RG 3300, then the threshold is crossed for ThresholdPercent1 and tag CStariffAMAcode is dumped in CDR for this request at Charging service level (CS) and tag tariffAMAcode is dumped at the bucket level.
2.Verify that in CCR(U3) also and tag CStariffAMAcode is dumped in CDR for this request at Charging service level (CS) and tag tariffAMAcode is dumped at bucket level as threshold was crossed in the CCR(U2) request.
3.Check that in CCR(T) also and tag CStariffAMAcode is dumped in CDR for this request at Charging service level (CS) and tag tariffAMAcode is dumped at bucket level as threshold was crossed in CCR(U2) request.
4.6.22 SESSION PARAMETERS source context Attribute name Trigger Description SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONRouting- Number IMS_ CALL_ TERMINATIONThis action fetches the routing number.Table 65: SESSION_PARAMETERS source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1100Charging User Guide Charging rules Attribute name Trigger Description MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING RESOURCE_ PRE_ SORTING IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION SMS_ CALL_ TERMINATION MMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION GY_PRE_ PROCESSING GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION TARIFF RATING_ POST_ PROCESSING CALL_ RULE_ VARIABLES RESOURCE_ POST_ PROCESSING APPLICABILITYGet- Custom Field- From- Session RESOURCE_ PRE_ SORTINGThis attribute returns the custom field based on a given key.Table 65: SESSION_PARAMETERS source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1101Charging User Guide Charging rules 4.6.23 SERVICE_INFO source context Attribute name Trigger Description APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD SLICING_ PROFILE BUNDLE CALL_ RULE_ VARIABLES DEVICE_ NOT_ FOUNDCall- Sub- Type COUNTERThis attribute provides the sub type of call type.Table 66: SERVICE_INFO source context 4.6.24 SNA_MANAGEMENT source context Attribute name Trigger Description Bucket- Name SNA_ MANAGEMENTThis attribute provides the Bucket Name for which SNA is being processed.
Site- ID SNA_ MANAGEMENTThis attribute provides the Site Id value from local geo- redundant site.
Host- ID SNA_ MANAGEMENT This attribute provides the local Host name.
Application- ID SNA_ MANAGEMENTThis attribute provides the Application- Id used for DVS Server Notification.Table 67: SNA_MANAGEMENT source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1102Charging User Guide Charging rules Attribute name Trigger Description Class- Of-Service SNA_ MANAGEMENTThis attribute provides the Class of Service as defined in the Custom Data Dictionary of Device.
Billing- Account- Id SNA_ MANAGEMENTThis attribute provides the Billing Account Id as defined in the Custom Data Dictionary of Device.
Unix- Timestamp SNA_ MANAGEMENTThis attribute provides the Timestamp when notification was generated.
Unix- Timestamp- Ms SNA_ MANAGEMENTThis attribute provides the Timestamp when notification was generated in milliseconds.
Discount- Id SNA_ MANAGEMENT This attribute provides the Discount Id.
Pre- Policy- Counter- Status SNA_ MANAGEMENTThis attribute provides the pre- event policy counter status from Sy Session.
Post- Policy- Counter- Status SNA_ MANAGEMENTThis attribute provides the post- event policy counter status from Sy Session.
Policy- Counter- Id SNA_ MANAGEMENT This attribute provides Id of policy counter.
Policy- Counter- Previous- State SNA_ MANAGEMENTThis attribute provides the previous state of Policy counter.
Total- SySession- Count SNA_ MANAGEMENTThis attribute provides the total count of Sy Sessions that exist in the database.
Current- SySession- Index SNA_ MANAGEMENTThis attribute provides the Sy Session for which SNA is being processed.
Bundle- Name SNA_ MANAGEMENTThis attribute provides the bundle name (without MVNO) corresponding to the subscription that is present in the bucket, or counter.
Charging- Service SNA_ MANAGEMENTThis attribute provides the charging service name ( without MVNO) that is present in the bucket, or counter.
Current- Value SNA_ MANAGEMENTThis attribute provides the current value of the bucket, or counter.
Usage- From- Last- CCR SNA_ MANAGEMENTThis attribute provides the Used Service Units corresponding to a single MSCC.
Account- Id SNA_ MANAGEMENTThis attribute provides the Account Id ( without MVNO) corresponding to the subscription that is present in the bucket, or counter.Table 67: SNA_MANAGEMENT source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1103Charging User Guide Charging rules Attribute name Trigger Description Note : Only the first account of the subscription is considered for this attribute.
If device has multiple subscriptions, purchased by multiple accounts, then this attribute is filled by the first fetched account of the subscription.Table 67: SNA_MANAGEMENT source context (continued) The attribute Policy-Counter-Previous-State is used to provide signalling state as present in Bucket/ Counter instance.
This state can be different from signalling state present in Sy session if SNA is not received for SNR sent.
CC-Money is not supported for this feature.
Value of USU (Usage-From-Last-CCR) variable is the used service units corresponding to a single MSCC.
The USU value is not cumulative when a counter is updated through multiple MSCCs.
Value of USE (Current usage in Bytes) variable is the current value of bucket/counter (cumulative value) even if it is updated through multiple MSCCs.
In case of commit, or overcommit scenarios, the value of USE (Current-Value) variable is the value at which threshold is triggered.
In case of a 5G call when multiple UUCs/USUs are sent for a single MSCC, then the USU for which SNR is triggered is dumped in the USU variable.
USE and USU values corespond to the SNR for which SNA is received.
For example: In case SNR1 is triggered but the corresponding SNA is not received.
•When SNR2 is triggered, and the SNA corresponding to SNR1 is received, then USE and USU values are updated corresponding to the SNA received for SNR1.
•If the SNA corresponding to SNR2 is received, then the USE and USU values are updated corresponding to the SNA received for SNR2.
The custom variables that are supported when an SNA is sent, and the notification is triggered are shown in the following images: • Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1104Charging User Guide Charging rules • 4.6.25 SPR_ACCOUNT source context Attribute name Trigger Description Account- End- Date LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the end date of the account.
Account- id THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONING SUBSCRIBER_ POST_ PROVISIONINGThis attribute provides the account id of the account.
Note : Only the first account of the subscription is considered for this attribute.
If device has multiple subscriptions, purchased by multiple accounts, then this attribute is filled by the first fetched account of the subscription.
Account- Name LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONING SUBSCRIBER_ POST_ PROVISIONINGThis attribute provides the account name of the account.
Account- Type LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGThis attribute provides the type of the account ( Prepaid or Postpaid) .Table 68: SPR_ACCOUNT source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1105Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD RATING_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING Available- Balance RATING_ POST_ PROCESSING EDR_ PROCESSING LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONING RESOURCE_ PRE_ SORTINGThis attribute provides the available account balance including the reservation amount.
adjust- Balance- Mode SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the mode of mode of value adjustment for the account value.
Balance RATING_ POST_ PROCESSING LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONING RESOURCE_ PRE_ SORTINGThis attribute provides the account balance without reservation amount.
DayOfMonth LIFECYCLE_ PROFILE This attribute provides the day OfMonth parameter configured for the account entity.
DayOfWeek LIFECYCLE_ PROFILE This attribute provides the day OfWeek parameter configured for the account entity.
Entity- LifeCycle_ State APPLICABILITY TARIFF BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis attribute provides the entity life cycle state of the account.
Definition : SPR_ACCOUNT.Entity-LifeCycle_State="Value_ STRING" Example: SPR_ACCOUNT.Entity-LifeCycle_State= "VF_ACTIVE1" .
If used as defined it will set the Entity Lifecycle state of Account as VF_ACTIVE1 .Table 68: SPR_ACCOUNT source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1106Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING EDR_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONING Hour OfDay LIFECYCLE_ PROFILE This attribute provides the hour OfDay parameter configured for the account entity.
Is-Barred LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONINGThis attribute indicates whether the account is in barred state.
Is-Final LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONINGThis attribute indicates whether the account is in final state.
Overage Limit LIFECYCLE_ PROFILE This attribute indicates the account balance overage Limit.
Overage- Value EDR_ PROCESSING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the overage value of an account.
Periodic- LifeCycle_ State APPLICABILITY TARIFF BUNDLE CALL_ RULE_ VARIABLES COUNTER GY_POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis attribute provides the periodic life cycle state of the account.
Definition : SPR_ACCOUNT.Periodic-LifeCycle_State=" Value_STRING" Example: SPR_ACCOUNT.Periodic-LifeCycle_ State= "SUSPENDED" .
If used as defined it will set the Period Lifecycle state of Account as SUSPENDEDTable 68: SPR_ACCOUNT source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1107Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE THRESHOLD RATING_ POST_ PROCESSING LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING EDR_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONING SUBSCRIBER_ POST_ PROVISIONING Prev- Balance LIFECYCLE_ PROFILE This attribute provides the previous balance of the account.
Prev- Available- Balance LIFECYCLE_ PROFILE This attribute provides the previous available balance of the account.
Subscriber- Custom- Attribute THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONINGThis attribute provides the User Custom data.
Subscriber- Data RATING_ POST_ PROCESSINGThis attribute provides the user data.
Loan- Id LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONINGIndicates the ID of the loan.
Loan- State LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSINGIndicates the state of the loan.Table 68: SPR_ACCOUNT source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1108Charging User Guide Charging rules Attribute name Trigger Description SUBSCRIBER_ PRE_ PROVISIONING Loan- Amount LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONINGIndicates the loan amount.
Loan- Creation- Time LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONINGIndicates the time at which the loan is created.
Loan- Service- Fee LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONINGIndicates the loan service fee.
Loan- Remaining- Debt LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONINGIndicates the remaining debt in loan.
Loan- Bundle- Name LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING THRESHOLDThis attribute is being used for reference to Bundle definition.Table 68: SPR_ACCOUNT source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1109Charging User Guide Charging rules Attribute name Trigger Description SUBSCRIBER_ PRE_ PROVISIONING Loan- Bundle- Fee LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING THRESHOLD SUBSCRIBER_ PRE_ PROVISIONINGThis attribute defines fee of Bundle.
TaxId LIFECYCLE_ PROFILE This attribute provides the tax ID parameter for the account entity.
Time Zone Id LIFECYCLE_ PROFILE This attribute provides the time zone Id parameter configured for the account entity.
Total- Loan- Remaining- Debt LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONINGIndicates the total remaining debt of the loan.
Validity- Date LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the validity time of the account.
Entity- LifeCycle_ Name SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the entity life cycle name.
Periodic- LifeCycle_ Name SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the period life cycle name.
Definition : SPR_ACCOUNT.Periodic-LifeCycle_ Name="Value_STRING" Example: SPR_ACCOUNT.Periodic-LifeCycle_ Name= "Prepid_APLC_01"Table 68: SPR_ACCOUNT source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1110Charging User Guide Charging rules Attribute name Trigger Description If used as defined it will set the Period Lifecycle of Account to Prepid_ APLC_ 01.Table 68: SPR_ACCOUNT source context (continued) 4.6.26 SPR_DEVICE source context Attention : The SNR_RESULT , SY_SESSION_ESTABLISHMENT , and SY_SESSION_MODIFICATION triggers are not supported on the SM GUI.
Attribute name Trigger Description IMS_ CALL_ ESTABLISHMENT GY_PRE_ PROCESSINGAccount- Id UC_PROCESSINGThis attribute provides the ID of the account.
Note : Only the first account of the subscription is considered for this attribute.
If device has multiple subscriptions, purchased by multiple accounts, then this attribute is filled by the first fetched account of the subscription.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLDActive Subscriptions.
Bundle.
Id LOAN_ PRE_ PROCESSINGThis attribute provides the Bundle Id of the active subscriptions.Table 69: SPR_DEVICE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1111Charging User Guide Charging rules Attribute name Trigger Description LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING Add- Bundle SUBSCRIBER_ PRE_ PROVISIONING RESOURCE_ PRE_ SORTINGThis action provides the bundle name to be added.
The bundle name provided in the action is used to create a new subscription.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGAllow- Overage SUBSCRIBER_ PRE_ PROVISIONINGThis attribute checks if the overage is allowed or not.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1112Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGAvInstance IdsMap.
Name SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the key of an AV Instance Id map.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFAvInstance IdsMap.
Size THRESHOLDThis attribute provides a map of the AV instance Id' s.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1113Charging User Guide Charging rules Attribute name Trigger Description LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGCategory- List SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the list of category order attached with a device.
TARIFF RATING_ POST_ PROCESSING LOAN_ PRE_ PROCESSINGCharging Services.
Ids LOAN_ POST_ PROCESSINGThis attribute indicates the charging service Ids.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1114Charging User Guide Charging rules Attribute name Trigger Description POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGClass OfService SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the class of service custom data of the device.
IMS_ CALL_ ESTABLISHMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGCompared- Emergency- Level SUBSCRIBER_ PRE_ PROVISIONINGThis attribute compares the device emergency level with input.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILECounter- Ids TARIFFThis attribute provides a list of counter Id' s list attached with a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1115Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGCounter- Current Value SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the current value of a counter.
THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGCounter- EndDate SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the end date of a counter.
Creation- Time APPLICABILITY This attribute provides the time when a device was created.
If left blank, the systemTable 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1116Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNA_ MANAGEMENT SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF LIFECYCLE_ PROFILE ( Creation- Time attribute is available in lifecycle) THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONINGuses the current time as the creation time.
Otherwise, it uses the provided value.
Device- Id APPLICABILITY This attribute provides Id of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1117Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF THRESHOLD LIFECYCLE_ PROFILE ( Device- Id attribute is available in lifecycle) SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING IMS_ CALL_ ESTABLISHMENTTable 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1118Charging User Guide Charging rules Attribute name Trigger Description UC_PROCESSING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGDevice- Name SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the Device Name.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSINGDevice- Type RESOURCE_ POST_ PROCESSINGThis attribute provides a device type.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1119Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGDevice Primary Acc SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the primary account of the device.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSINGE164 RESOURCE_ POST_ PROCESSINGThis attribute provides the E164 value of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1120Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF THRESHOLD LIFECYCLE_ PROFILE SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING IMS_ CALL_ ESTABLISHMENT UC_PROCESSING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSINGEmergency- Level IMS_ CALL_ ESTABLISHMENTThis attribute provides the emergency level type of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1121Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING Entity- LifeCycle_ Name SUBSCRIBER_ PRE_ PROVISIONING RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the entity life cycle name.
GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGEEntity- LifeCycle_ State SUBSCRIBER_ PRE_ PROVISIONINGThis attribute indicates the entity life cycle state.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1122Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNA_ MANAGEMENT SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF LIFECYCLE_ PROFILE THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGEExternal- Id EDR_ PROCESSINGThis attribute provides the device External Id.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1123Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY TARIFF RATING_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGGet- Bucket- Total- Value- By-Name SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the remaining bucket balance for a bucket that has the passed key as name of bucket.
It also returns the balance including carry over balance.
APPLICABILITY TARIFF RATING_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGGet- Bucket- Value- By-Name SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the remaining bucket balance for a regular bucket that has the passed key as name of bucket.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSINGGroups.
Ids LOAN_ POST_ PROCESSINGThis attribute provides the List of Group id' s with which a device is attached.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1124Charging User Guide Charging rules Attribute name Trigger Description POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING Groups.
Size APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONINGThis attribute indicates the number of Groups that a device belongs to.
THRESHOLD GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SNA_ MANAGEMENT LIFECYCLE_ PROFILE IMS_ CALL_ ESTABLISHMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGGPSI SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the GPSI format for E164 of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1125Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGIs-Exist- Bundle SUBSCRIBER_ PRE_ PROVISIONINGThis attribute checks if an auto install bundle exist or not in a device.
THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGIs-Exist- Bundle- In-Parent- Group SUBSCRIBER_ PRE_ PROVISIONINGThis attribute checks if an auto install bundle exist or not in an immediate Parent Group.
THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGIs-Exist- Bundle- In-Top- Group SUBSCRIBER_ PRE_ PROVISIONINGThis attribute checks if an auto install bundle exist or not in the Top Group.
isUCSubs APPLICABILITY SLICING_ PROFILE TARIFF THRESHOLD GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGThis attribute is used to validate if the UC subscription is present.
It takes either True or False value.
Different actions get triggered based on the rule.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1126Charging User Guide Charging rules Attribute name Trigger Description BUNDLE LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING Is-ULI- Stored IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONINGThis attribute checks the ULI.
APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFFIMSI LIFECYCLE_ PROFILEThis attribute provides the IMSI of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1127Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING IMS_ CALL_ ESTABLISHMENT UC_PROCESSING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILEIs-Barred THRESHOLDThis attribute indicates whether the device is in Barring State or not.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1128Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING Is-Bundle- In-Active Subs APPLICABILITY CALL_ RULE_ VARIABLES GY_CREDIT_ REQUEST GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD GY_POST_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONINGThis attribute takes the following parameters: •Input- String : It consists of bundles separated by the separator.
•Separator ( ;): It separates the bundles in the input string.
For example: Is-Bundle- In-Active Subs( " bundle1; bundle2; bundle3" , ";") This attribute checks whether the bundles in Input- String are in active subscription list in the current device.
If at least one bundle from the bundle list provided in the input string is present in the active subscription list of the device, then this action returns the matched bundle name.
Else, it returns null.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSINGIs-First- Call RESOURCE_ POST_ PROCESSINGThis attribute indicates whether the device is used the first time in a call request or used previously also.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1129Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF THRESHOLD LIFECYCLE_ PROFILE SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSINGIs-First- Call- Done LOAN_ POST_ PROCESSINGThis attribute provides the value of a Device First Call Done Flag.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1130Charging User Guide Charging rules Attribute name Trigger Description POLICY_ COUNTER_ STATUS_ CHANGE EDR_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING TARIFF RATING_ POST_ PROCESSING LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGIs-Specified- CS-Subscribed SUBSCRIBER_ PRE_ PROVISIONINGThis attribute indicates whether the specified CS has been subscribed.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSINGLdap- Search- Device LOAN_ POST_ PROCESSINGThis attribute provides the value of Ldap Search Flag of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1131Charging User Guide Charging rules Attribute name Trigger Description POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNA_ MANAGEMENT SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF THRESHOLD IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGLanguage POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the language defined in a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1132Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF THRESHOLD LIFECYCLE_ PROFILE SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGELast- Update- Time EDR_ PROCESSINGThis attribute provides the last time when a device was updated.
The system does not set this automatically when a device is created.
Also, when updating a device, the system ignores any value set by the user and generates a new value all the time.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1133Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNA_ MANAGEMENT SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGLocation- PC-Status SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the device Location PC Status.
MCC APPLICABILITY This attribute provides the MCC value.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1134Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD BUNDLE COUNTER GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY SLICING_ PROFILE TARIFFMNC THRESHOLDThis attribute provides the MNC value.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1135Charging User Guide Charging rules Attribute name Trigger Description BUNDLE COUNTER GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY SLICING_ PROFILE TARIFF THRESHOLD BUNDLE COUNTERMCCMNC GY_CREDIT_ REQUESTThis attribute provides the MCCMNC value.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1136Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY SLICING_ PROFILE TARIFF THRESHOLD BUNDLE COUNTER GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSINGTime Zone Id RATING_ POST_ PROCESSINGThis attribute provide the timezone value defined in a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1137Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATIONMSISDN TARIFFThis attribute provides the MSISDN of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1138Charging User Guide Charging rules Attribute name Trigger Description LIFECYCLE_ PROFILE THRESHOLD SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION THRESHOLDNAI LIFECYCLE_ PROFILEThis attribute provides the NAI of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1139Charging User Guide Charging rules Attribute name Trigger Description SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGNon- Unique- Identities.
Size SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the Non Unique Identities of a device.
APPLICABILITY GY_CREDIT_ REQUESTNon- Unique- Identities.
Identity- Types GY_POST_ PROCESSINGThis attribute provides the Identify Type of Non Unique Identities of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1140Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGNon- Unique- Identities.
Identity- Values POLICY_ COUNTER_ STATUS_ CHANGEThis attribute identify values of Non Unique Identities of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1141Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE SUBSCRIBER_ PRE_ PROVISIONING RESOURCE_ PRE_ SORTINGNotification- Profile SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the notification profile attached with a device.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSINGOcs- Host RESOURCE_ POST_ PROCESSINGThis attribute provides an OCS Host Name corresponding to a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1142Charging User Guide Charging rules Attribute name Trigger Description SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGOcs- Realm SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the OCS Realm Name corresponding to a device.
Offline- Timestamp APPLICABILITY This attribute provides the offline Time ( Termination Time) of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1143Charging User Guide Charging rules Attribute name Trigger Description GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDOwner- Id LOAN_ PRE_ PROCESSINGThis attribute provides the owner id of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1144Charging User Guide Charging rules Attribute name Trigger Description LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGPassword SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the device password.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSINGPassword- Encrypted RATING_ POST_ PROCESSINGThis attribute checks if the device password is encrypted or not.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1145Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFFPrivate- Id THRESHOLDThis attribute provides the private Identifier of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1146Charging User Guide Charging rules Attribute name Trigger Description LIFECYCLE_ PROFILE SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING Remove- Bundle SUBSCRIBER_ PRE_ PROVISIONING RESOURCE_ PRE_ SORTINGThis action provides the bundle name to be removed.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGReports.
Ids SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the Report Id' s.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1147Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGReports.
Size SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the number of reports.
THRESHOLD GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SNA_ MANAGEMENT LIFECYCLE_ PROFILE IMS_ CALL_ ESTABLISHMENT LOAN_ PRE_ PROCESSINGSUPI LOAN_ POST_ PROCESSINGThis attribute provides the SUPI format for IMSI of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1148Charging User Guide Charging rules Attribute name Trigger Description POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGSGSNMCC SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the MCC value in the SGSNMCCMNC field.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1149Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSING RATING_ POST_ PROCESSING GY_PRE_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGSGSNMCCMNC SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the SGSN MCC MNC value.
APPLICABILITY BUNDLESGSNMNC COUNTERThis attribute provides the MNC value in the SGSNMCCMNC field.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1150Charging User Guide Charging rules Attribute name Trigger Description GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY BUNDLE COUNTER GY_CREDIT_ REQUEST GY_POST_ PROCESSINGSIP-URI GY_PRE_ PROCESSINGThis attribute provides the SIP URI of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1151Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF LIFECYCLE_ PROFILE THRESHOLD SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY TARIFF GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGSubscriber- Custom- Attribute SLICING_ PROFILEThis attribute provides the User Custom data.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1152Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD COUNTER BUNDLE IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION UC_PROCESSING SNA_ MANAGEMENT SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION CALL_ RULE_ VARIABLES GY_MESSAGE GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION LIFECYCLE_ PROFILETable 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1153Charging User Guide Charging rules Attribute name Trigger Description GY_SESSION_ TERMINATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING ECOMMERCE_ CALL_ ESTABLISHMENT SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY TARIFF GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE THRESHOLD COUNTER BUNDLE IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONService- Provider SMS_ CALL_ ESTABLISHMENTThis attribute indicates the service provider defined in a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1154Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION UC_PROCESSING SNA_ MANAGEMENT SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION CALL_ RULE_ VARIABLES LIFECYCLE_ PROFILE ( Service- Provider attribute is available in lifecycle) GY_MESSAGE GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONINGTable 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1155Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGSubscription- Index SUBSCRIBER_ PRE_ PROVISIONINGThis attribute returns the Index at which device subscription is inserted in a list of subscriptions.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFFSubscriptions.
Bundle.
Id THRESHOLDThis attribute provides the Bundle id of a subscription.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1156Charging User Guide Charging rules Attribute name Trigger Description LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGSubscriptions.
Size SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the number of subscriptions attached with a device.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSINGSy-Ocs- Enabled GY_PRE_ PROCESSINGThis attribute checks whether the Sy OCS is enabled or not.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1157Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGETime OfDay.
Daylight Savings RESOURCE_ PRE_ SORTINGThis attribute provides the value of the device Day Light Saving flag.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1158Charging User Guide Charging rules Attribute name Trigger Description SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGTime OfDay.
Time Zone SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the time zone of a device.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILETrigger- Source TARIFFThis attribute provides a trigger source of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1159Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGUnique- Identities.
Identity- Types SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the Unique Identity Type of a device.
APPLICABILITY GY_CREDIT_ REQUESTUnique- Identities.
Identity- Values GY_POST_ PROCESSINGThis attribute provides the Unique Identify Value of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1160Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGUnique- Identities.
Size POLICY_ COUNTER_ STATUS_ CHANGEThis attribute provides the number of Unique Identities of a device.Table 69: SPR_DEVICE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1161Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ PRE_ PROVISIONING LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGUnknown_ cause SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the unknown cause.
APPLICABILITY GY_CREDIT_ REQUEST GY_POST_ PROCESSING GY_PRE_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING POLICY_ COUNTER_ STATUS_ CHANGE RESOURCE_ PRE_ SORTINGUsage- Control- Services SUBSCRIBER_ PRE_ PROVISIONINGThis attribute provides the usage control services of a device.Table 69: SPR_DEVICE source context (continued) Note : Currently, LOAN_POST_PROCESSING trigger is not supported.
It is reserved for future use.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1162Charging User Guide Charging rules 4.6.27 SPR_DEVICE_NEW source context Attribute name Trigger Description Subscriber- Custom- Attribute SUBSCRIBER_ PRE_ PROVISIONING This attribute provides the User Custom data.Table 70: SPR_DEVICE_NEW source context 4.6.28 SPR_GROUP source context Attribute name Trigger Description APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF CALL_ RULE_ VARIABLES THRESHOLDActive Subscriptions.
Bundle.
Id RESOURCE_ PRE_ SORTINGThis source context returns the list of Active subscriptions attached to the Group.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEActive- Device- Group- Reports.
Report- Ids TARIFFThis attribute provides the active report ids for Device in a Group.Table 71: SPR_GROUP source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1163Charging User Guide Charging rules Attribute name Trigger Description LIFECYCLE_ PROFILE THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDActive- Device- Group- Reports.
Size RESOURCE_ PRE_ SORTINGThis attribute provides the active reports size for Device in a Group.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDActive- Group- Reports.
Report- Ids RESOURCE_ PRE_ SORTINGThis attribute provides the active report ids for a group.
APPLICABILITY GY_POST_ PROCESSINGActive- Group- Reports.
Size RATING_ POST_ PROCESSINGThis attribute provides the size of the active report for a group.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1164Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDAdministrators.
Size RESOURCE_ PRE_ SORTINGThis attribute provides the size of administrators of a group.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILEAdministrators.
User- Ids THRESHOLDThis attribute provides the administrators Ids of the group.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1165Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDAvInstance IdsMap.
Name RESOURCE_ PRE_ SORTING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDAvInstance IdsMap.
Size RESOURCE_ PRE_ SORTINGThis attribute provides the map of the Av instance id' s. APPLICABILITY GY_POST_ PROCESSINGChild- Device- Ids RATING_ POST_ PROCESSINGThis attribute provides the child device id' s.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1166Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLD RESOURCE_ PRE_ SORTING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDChild- Device- Names RESOURCE_ PRE_ SORTINGThis attribute provides the child device names.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILEChild- Group- Ids THRESHOLDThis attribute provides the child group Id' s.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1167Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDChild- Group- Names RESOURCE_ PRE_ SORTINGThis attribute provides the child group names.
Counter- Current Value THRESHOLD RESOURCE_ PRE_ SORTINGThis attribute provides the current value of a counter.
Counter- EndDate THRESHOLD RESOURCE_ PRE_ SORTINGThis attribute provides the end date of a counter.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDCreation- Time RESOURCE_ PRE_ SORTINGThis attribute provides the time when group was created.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1168Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF THRESHOLDDevice- Counter- Ids RESOURCE_ PRE_ SORTINGThis attribute provides the device counter id' s that are attached to a group.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDGroup- Counter- Ids RESOURCE_ PRE_ SORTINGThis attribute provides the Group Counter id' s. APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILEGroup- Id TARIFFThis attribute provides the Group Id.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1169Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLD RESOURCE_ PRE_ SORTINGGroup- Name SUBSCRIBER_ POST_ PROVISIONINGThis attribute provides the name of a group.
Is-Exist- Bundle THRESHOLD RESOURCE_ PRE_ SORTINGThis attribute checks if the auto install bundle exist or not in a device.
Is-Exist- Bundle- In-Parent- Group THRESHOLD RESOURCE_ PRE_ SORTINGThis attribute checks if the auto install bundle exist in the immediate parent group.
Is-Exist- Bundle- In-Top- Group THRESHOLD RESOURCE_ PRE_ SORTINGThis attribute checks if the auto install bundle exist or not in a top group.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGLast- Update- Time SLICING_ PROFILEThis attribute provides the last time when the group was updated.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1170Charging User Guide Charging rules Attribute name Trigger Description TARIFF LIFECYCLE_ PROFILE THRESHOLD RESOURCE_ PRE_ SORTING Max- Bundle- Instances LIFECYCLE_ PROFILE RESOURCE_ PRE_ SORTING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLD SUBSCRIBER_ PRE_ PROVISIONINGNotification- Profile RESOURCE_ PRE_ SORTING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILEParent- Group- Id THRESHOLDThis attribute provides the parent group Id.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1171Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF BUNDLE UC_PROCESSING CALL_ RULE_ VARIABLES LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLDSubscriber- Custom- Attribute RESOURCE_ PRE_ SORTINGThis attribute provides the user custom data attached with a group.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILESubscriptions.
Bundle.
Id THRESHOLDThis attribute provides the bundle id of subscriptions.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1172Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDSubscriptions.
Size RESOURCE_ PRE_ SORTINGThis attribute provides the number of subscriptions attached with a group.
APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE TARIFF LIFECYCLE_ PROFILE THRESHOLDTraversal- Order RESOURCE_ PRE_ SORTINGThis attribute provides the group hierarchy traversal order.Table 71: SPR_GROUP source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1173Charging User Guide Charging rules 4.6.29 SUBSCRIBER_PROVISIONING source context Attribute name Trigger Description SUBSCRIBER_ PRE_ PROVISIONING Method- Name SUBSCRIBER_ POST_ PROVISIONINGThis attribute reads the invoke method of provisioning request and stores in it.Table 72: SUBSCRIBER_PROVISIONING source context 4.6.30 SUBSCRIPTION source context Attribute name Trigger Description THRESHOLD RATING_ POST_ PROCESSING LIFECYCLE_ PROFILEAccount- Id RESOURCE_ POST_ PROCESSINGThis attribute provides the account id of subscription.
Note : Only the first account of the subscription is considered for this attribute.
If device has multiple subscriptions, purchased by multiple accounts, then this attribute is filled by the first fetched account of the subscription.
Bundle- Activation- Type LIFECYCLE_ PROFILE This attribute indicates the activation type of the bundle.
THRESHOLD APPLICABILITY TARIFF RESOURCE_ POST_ PROCESSING RATING_ POST_ PROCESSING CALL_ RULE_ VARIABLESBundle- Id BUNDLEThis attribute provides the bundle Id of subscriptions.
Note : RATING_ POST_ PROCESSING trigger is supported only when the Dynamic Notification Custom flag is enabled.
Note : THRESHOLD trigger does not support Aggregate View ( AV) functionality.Table 73: SUBSCRIPTION source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1174Charging User Guide Charging rules Attribute name Trigger Description Counter- Current Value THRESHOLD This attribute provides the current value of counter.
Counter- EndDate THRESHOLD This attribute provides the end Date of counter.
Creation- Time LIFECYCLE_ PROFILE This attribute indicates the creation time of the subscription.
Charging- Service SLICING_ PROFILE This attribute provides the charging service name ( without MVNO) that is present in the bucket, or counter.
APPLICABILITY TARIFF THRESHOLD RATING_ POST_ PROCESSINGCustom Data RESOURCE_ POST_ PROCESSINGThis attribute is used to send custom data value as a notification variable.
It takes custom data attribute as an input parameter.
For example: custom Data( "custom Data name" ) RESOURCE_ POST_ PROCESSING LIFECYCLE_ PROFILEDescription THRESHOLDThis attribute provides the description of subscription.
End- Time LIFECYCLE_ PROFILE This attribute indicates the end time of the subscription.
First- Applied- Discount LIFECYCLE_ PROFILE This attribute is used to differentiate the notification templates, if discount is applied.
Get- Bucket- Total- Value- By-Type THRESHOLD LIFECYCLE_ PROFILEThis attribute provides the remaining bucket balance of a bucket that has the passed key as type of bucket.
Get- Bucket- Value- By-Type THRESHOLD LIFECYCLE_ PROFILEThis attribute provides the remaining bucket balance for regular bucket that has the passed key as type of bucket.
Get- Previous- Bucket- Total- Value- By-Name THRESHOLD LIFECYCLE_ PROFILEThis attribute provides the previous subscription remaining bucket balance for a bucket that has the passed key as name of bucket.
Get- Previous- Bucket- Total- Value- By-Type THRESHOLD LIFECYCLE_ PROFILEThis attribute provides the previous subscription remaining bucket balance for aTable 73: SUBSCRIPTION source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1175Charging User Guide Charging rules Attribute name Trigger Description bucket that has the passed key as the type of bucket.
Get- Previous- Bucket- Value- By-Name THRESHOLD LIFECYCLE_ PROFILEThis attribute provides the previous subscription remaining bucket balance for a regular bucket that has the passed key as the name of bucket.
Get- Previous- Bucket- Value- By-Type THRESHOLD LIFECYCLE_ PROFILEThis attribute provides the previous subscription remaining bucket balance for a regular bucket that has the passed key as the type of bucket.
Has- Non- Empty- Buckets THRESHOLD LIFECYCLE_ PROFILEThis attribute checks whether the subscription has non- empty buckets.
Has- Previous- Non- Empty- Buckets THRESHOLD LIFECYCLE_ PROFILEThis attribute checks whether the previous subscription has non- empty buckets.
Is-Bucket- Exhausted- In-CS APPLICABILITY This attribute indicates whether the bucket is exhausted in charging service.
Remaining- Renewals LIFECYCLE_ PROFILE Remaining- Discount- Renewals- Count LIFECYCLE_ PROFILE This attribute returns the remaining number of renewal discounts for a specific discount.
This is a comparison and is used to detect last renewal which has been applied.
Exception for standalone discounts must return none .
For In-Bundle , there shall be only one discount Instance for it, so that remaining renewal count can be returned.
Subscription Id LIFECYCLE_ PROFILE This attribute indicates the Id of the subscription.
THRESHOLD APPLICABILITY TARIFF RESOURCE_ POST_ PROCESSING RATING_ POST_ PROCESSINGSubscriber- Custom- Attribute CALL_ RULE_ VARIABLESThis attribute provides the custom data attached with a subscription.
Note : RATING_ POST_ PROCESSING trigger is supported only when the Dynamic Notification Custom flag is enabled.
Note : THRESHOLD trigger does not support Aggregate View ( AV) functionality.Table 73: SUBSCRIPTION source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1176Charging User Guide Charging rules Attribute name Trigger Description BUNDLE Start- Time LIFECYCLE_ PROFILE This attribute indicates the start time of the subscription.
State- Validity- End- Date THRESHOLD This attribute indicates the end date of subscription.
Type- Of-Count APPLICABILITY This attribute indicates the count of subscription type.
•BOU- Activation- Fee: Indicates BOU activation fee charged for BOU Bundle during activation.
•Usage: Indicates usage cost deducted from main balance or bucket.
( It is the default value. )
•Bundle- Subscription- Renewal- Fee: Indicates Bundle subscription and Bundle renewal fee.
Counter update logic for Bundle subscription/ renewal fee is applicable only for COST based counters.
If applicability condition of counter does not contain Type- Of-Count attribute, then counter counts depending on the value of ME application preference Increase Counter for Bundle Fee .
THRESHOLD is-Queued- Instance LIFECYCLE_ PROFILE ( Accessible through Send Notification Action in Lifecycle)This attribute checks whether the subscription is queued or not.
THRESHOLD is-Last- In-Queue LIFECYCLE_ PROFILE ( Accessible through Send Notification Action in Lifecycle)This attribute checks whether the queued subscription is last in the queue or not.
THRESHOLD alternate Id LIFECYCLE_ PROFILEThis attribute provides the alternate ID of subscription.Table 73: SUBSCRIPTION source context (continued) 4.6.31 SY_COUNTER source context In SNA_MANAGEMENT trigger, the SY_COUNTER source context is reserved for future use.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1177Charging User Guide Charging rules Attribute name Trigger Description SNR_ RESUL T Is-First- Use- Counter SNA_ MANAGEMENTThis attribute checks whether counter is used for the first time.
SNR_ RESUL T Policy- Counter- Id-New SNA_ MANAGEMENTThis attribute provides the policy counter Id' s from Sy result answer.
SNR_ RESUL T Policy- Counter- Id-Old SNA_ MANAGEMENTThis attribute provides the old policy counter id.
SNR_ RESUL T Policy- Counter- Status- New SNA_ MANAGEMENTThis attribute provides the signaling state of counter from Sy result answers.
SNR_ RESUL T Policy- Counter- Status- Old SNA_ MANAGEMENTThis attribute indicates the Old Signaling state of Policy Counter.Table 74: SY_COUNTER source context 4.6.32 SY_COUNTER_EVAL source context Attribute name Trigger Description All-Policy- Counter- Statuses- Unchanged SNR_ RESUL T This attribute returns true/ false depending on all the policy counter statuses unchanged between Sy session and rating evaluation ( sy result answers) .Table 75: SY_COUNTER_EVAL source context 4.6.33 SY_MESSAGE source context Attribute name Trigger Description SY_SESSION_ ESTABLISHMENT Auth- Application- Id SY_SESSION_ MODIFICATIONThis attribute provides the Auth- Application- Id from SLR.Table 76: SY_MESSAGE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1178Charging User Guide Charging rules Attribute name Trigger Description SY_SESSION_ ESTABLISHMENT Logical- Access- Id SY_SESSION_ MODIFICATIONThis attribute provides the Logical- Access- id from SLR.
SY_SESSION_ ESTABLISHMENT notif Uri SY_SESSION_ MODIFICATIONThis attribute provides the notification Uri from SLR.
SY_SESSION_ ESTABLISHMENT Origin- Host SY_SESSION_ MODIFICATIONThis attribute provides the Origin Host from Sy message.
SY_SESSION_ ESTABLISHMENT Origin- Realm SY_SESSION_ MODIFICATIONThis attribute provides the Origin Relam from Sy message.
SY_SESSION_ ESTABLISHMENT Physical- Access- Id SY_SESSION_ MODIFICATIONThis attribute provides the Physical- Access- id from SLR.
SY_SESSION_ ESTABLISHMENT Policy- Counter- Identifier SY_SESSION_ MODIFICATIONThis attribute provides the identifier of policy counter.
SY_SESSION_ ESTABLISHMENT Session- Id SY_SESSION_ MODIFICATIONThis attribute provides the Session id from Sy message.
SY_SESSION_ ESTABLISHMENT SL-Request- Type SY_SESSION_ MODIFICATIONThis attribute provides SL- Request- Type from SLR, for example, INITIAL_ REQUEST, INTERMEDIATE_ REQUEST.
SY_SESSION_ ESTABLISHMENT Subscription- Id-Data SY_SESSION_ MODIFICATIONThis attribute provides the Subscription Id Data AVP value.
SY_SESSION_ ESTABLISHMENT Subscription- Id-Data- By-Type SY_SESSION_ MODIFICATIONThis attribute fetches the Subscription Id by Type.
SY_SESSION_ ESTABLISHMENT Subscription- Id-Type SY_SESSION_ MODIFICATIONThis attribute provides the value of Subscription Id Identifier.
supported Features SY_SESSION_ ESTABLISHMENT This attribute provides the supported features from SLR.Table 76: SY_MESSAGE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1179Charging User Guide Charging rules Attribute name Trigger Description SY_SESSION_ MODIFICATIONTable 76: SY_MESSAGE source context (continued) 4.6.34 SYSTEM source context Attribute name Trigger Description Current- Date- Time All Triggers This attribute provides the Date and Time in milliseconds.
Current- Date- Time- String All Triggers This attribute provides the date and time in string format.
Current- Date- Time- String- GMT All Triggers This attribute provides the date and time in the GMT format.
Time- Start- Of-Today All Triggers This attribute provides the time at the start of the day.
Time- Start- Of-Today- GMT All Triggers This attribute provides the time at start of the day in the GMT format.
Current- Time- Of-Day All Triggers This attribute provides the time of the day in milliseconds.
Current- Time- Of-Day- GMT All Triggers This attribute provides the time of the day in the GMT format.
Current- Day- Of-Week All Triggers This attribute provides day of week.
Current- Day- Of-Week- GMT All Triggers This attribute provides the day of the week in the GMT format.
Current- Day- Of-Month All Triggers This attribute provides the day of month.
Current- Day- Of-Month- GMT All Triggers This attribute provides the day of month in the GMT format.
Current- Hour- Of-Day All Triggers This attribute provides the hour of the day.
Current- Hour- Of-Day- GMT All Triggers This attribute provides the hour of the Day in the GMT format.
In-Time- Period All Triggers This attribute checks whether the time is within a given time period.
In-Time- Period- GMT All Triggers This attribute checks whether the time is within a given time period in the GMT format.
Is-String- Null All Triggers This attribute checks whether the input string is null or empty.
Write- To-Log All Triggers This attribute writes an entry to the log.Table 77: SYSTEM source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1180Charging User Guide Charging rules Attribute name Trigger Description Length- Of All Triggers This attribute provides the length of Input String.
OCS- Application- ID All Triggers This attribute provides the application Id for an OCS.
Host- ID All Triggers This attribute provides the host name.
Site- ID All Triggers This attribute provides the site id.
Site- Name All Triggers This attribute provides the site name.
Next- Random- Integer All Triggers This attribute provides the next random integer.
Next- Random- Long All Triggers This attribute provides the next random long.
Next- Bounded- Random- Integer All Triggers This attribute provides the next random integer, with an upper bound.
The value returned is between 0 ( inclusive) and the upper bound ( exclusive) .
The upper bound must be at least 1, otherwise there will be no upper bound.
Generate- UUID All Triggers If this attribute is used, a time- based UUID string ( with five parts separated with " -") is created.
Example of type 1 UUID: a89e6d7b- f2ec- 11e3- bcfb- 5c514fe65f28 Where, timestamp is formed from 1e3 f2ec a89e6d7b ; 5c514fe65f28 represents the MAC address ( for example, 5c: 51:4f:e6:5f:28).
The date 15/ 10/1582 is, in general, used as a staring point for UUID generation.
This is the day when the Gregorian Calendar started.
•NCC uses the first three parts of UUID as described in the calculation algorithm above.
•The third part starts with 1 ( that is, type 1) , which indicates that it is a time- based string.
•The fourth part can be any random UInt16.
•The fifth part is the first six characters of the ME Node ID that triggered the notification.
NCC uses ME host name in hex.Table 77: SYSTEM source context (continued) 4.6.35 THRESHOLD_PROFILE source context Attribute name Trigger Description Account- Current- Value THRESHOLD This attribute provides the current value of the account ( that is, account balance without reservation amount) .Table 78: THRESHOLD_PROFILE source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1181Charging User Guide Charging rules Attribute name Trigger Description Account- Def- Name THRESHOLD This attribute provides the account name.
Account- End- Date THRESHOLD This attribute provides the end date of a periodic lifecycle attached with an account.
Account- Entity- End- Date THRESHOLD This attribute provides the end date of an entity lifecycle attached with an account.
Account- Unused- Value THRESHOLD This attribute provides the remaining value of the account including the reservation amount.
Action- Type THRESHOLD This attribute provides the actions configured for the threshold.
Only some specific actions are considered for this parameter, such as: •Notification- Continue •Notification- Stop •Notification- Reject •Reject •Send- Notification •Send- SNR Note : If multiple actions are configured, then the concatenated value of all actions separated by comma ( ,) is given.
AV-Unit THRESHOLD Holds AV definition unit value.
AV-Current- Value THRESHOLD This attribute provides the AV value with reservation ( current value of the AV) .
AV-Def- Name THRESHOLD This attribute provides the aggregate view name.
THRESHOLD AV-Initial- Value BUNDLEThis attribute provides the initial value of an Aggregate View.
AV-Unused- Value THRESHOLD This attribute provides the AV value without reservation ( unused value of AV) .
Block- Next- Rate THRESHOLD This attribute provides the threshold block next rate value.
Bucket- Balance- Value THRESHOLD This attribute provides the balance of bucket.
Bucket- Current- Step THRESHOLD This attribute provides the current step of bucket.Table 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1182Charging User Guide Charging rules Attribute name Trigger Description Bucket- Current- Value THRESHOLD This attribute provides the remaining value of the bucket without reservation amount.
Note : The maximum value allowed for bucket initial/ current is 922337203685477600.
Bucket- Def- Name THRESHOLD This attribute provides the bucket ID for which the threshold value is defined that triggers a notification.
Bucket- End- Date THRESHOLD This attribute provides the bucket expiration time received from the subscription of that bucket.
Bucket- End- Value THRESHOLD This attribute provides the initial minus current, which refers to the bucket value that has been used till date.
If a threshold has not been reached, then there is no notification with notification variables.
Do not configure CAP and threshold together.
If configured, then the latest one is considered.
Note : This variable value is automatically generated by NCC and not specified by the service operator.
Bucket- Initial- Value THRESHOLD This attribute provides the bucket initial value.
Bucket- Or-Counter- Current- Value THRESHOLD This attribute provides the bucket or counter current value whatever is available.
Bucket- Or-Counter- Def- Name THRESHOLD This attribute provides ID of a bucket or counter for which the notification has to be sent.
Bucket- Step Up-Time THRESHOLD This attribute provides the last step uptime of step bucket, which is null for a normal bucket.
Bucket- Step Up-Value THRESHOLD This attribute provides the cumulative value of top- up done at a particular time in a slice, which is null for a normal.
Bucket- Unit THRESHOLD Hold the bucket definition unit value.
Buckets- Unused Value THRESHOLD This attribute provides the remaining value of the bucket including the reservation amount.
Bundle- Name- Reserve THRESHOLD This attribute provides name of the bundle from which the maximum reservation has been done.Table 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1183Charging User Guide Charging rules Attribute name Trigger Description Bundle- Reserve- Type THRESHOLD This attribute provides the name of the resource ( DEVICE/ GROUP) to which the bundle with maximum reservation belongs.
Buckets- Unit Values THRESHOLD This attribute provides the unit type of bucket definition.
Buckets- Type THRESHOLD This attribute provides the Kind of Unit.
Buckets- Periodic- Length THRESHOLD This attribute provides the periodic length of the buckets.
Carry- Over- Bucket- Current- Value THRESHOLD This attribute provides the carry over current value of a bucket with reservation.
Carry- Over- Bucket- End- Date THRESHOLD This attribute provides the carryover bucket expiration time that comes from subscription of that bucket.
Charging- Service THRESHOLD This attribute provides the name of the charging service.
It can also be mapped to a custom data with name, such as segment defined in the device.
Charging- Service- Reserve THRESHOLD This attribute provides the name of the charging service from which the maximum reservation has been done.
Charging- Service- Reserve- Type THRESHOLD This attribute provides the name of the resource ( DEVICE/ GROUP) to which the charging service with maximum reservation belongs.
Counter- Current- Value THRESHOLD This attribute provides the current value of a counter.
Note : If usage limit and overage limit are configured for a counter, and multiple overage blocks are being consumed in a single call, then this attribute has an overage usage till the previous overage block for which threshold is being executed.
For example, if Usage Limit is 10 GB and Overage Limit is 1 GB with threshold notification configured on 100% usage, and Counter Current- Value increases from 10 GB to 12 GB, then threshold notification has the following two notifications: •On consumption of 11 GB usage with Counter- Current- Value as 11 GB, theTable 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1184Charging User Guide Charging rules Attribute name Trigger Description Current Overage- Usage is 1 GB for Counter- Overage Count of 1.
•On consumption of 12 GB usage with Counter- Current- Value as 12 GB, the Current Overage- Usage is 1 GB for Counter- Overage Count of 2.
Counter- Current- Reserve- Value THRESHOLD This attribute provides the current reserve value of a counter.
Counter- Def- Name THRESHOLD This attribute provides the counter name for which the threshold value is defined that triggers a notification.
Counter- End- Date THRESHOLD For subscription counter, the counter end date is the end date of the subscription to which the counter is linked.
For device counter, group counter, and device group counter, the counter end date is taken from the account linked to the subscription.
Note : If multiple subscriptions are used in a call, then the Counter End Date is taken from the account ID of the first subscription used in the call.
Example: THRESHOLD_ PROFILE.
Counter- End- Date SPR_ GROUP.
Counter Current Value ( " < Counter- Def- Name> " ) SPR_ DEVICE.
Counter Current Value ( " <Counter- Def- Name> " ) SUBSCRIPTION.
Counter- Current Value ( " < Counter- DefName> " ) wherein Counter- Def Name is GC1 and GC2.
Counter- End- Value THRESHOLD This attribute provides the maximum limit value stored in a counter.
This is an absolute value of the counter threshold corresponding to the Notification- Stop, Notification- Reject, and Reject actions.
Note : Counter percentage type thresholds and overage thresholds are not considered for this attribute.
Counter- Overage- Count THRESHOLD As overage limit blocks keep on repeating multiple times, this attribute provides the count of the ongoing overage block.
For example, if usage limit is 5 GB, overage limit is 2 GB, and Counter- Current Value is 9.
5 GB, then this attribute gives 3 depicting third overage block, which is ongoing.Table 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1185Charging User Guide Charging rules Attribute name Trigger Description Note : If multiple overage blocks are being consumed in a single call, then this parameter has an overage count of overage block (current or previous) , for which threshold is being executed.
For example, if Usage Limit is 10 GB, Overage Limit is 1 GB with threshold notification on 100% usage, and Counter Current- Value increases from 10 GB to 12 GB in a call, then threshold notification for overage count is 1 ( on 11 GB usage) and Counter Overage- Count is 2 ( on 12 GB usage) .
Counter- Overage- Limit THRESHOLD This attribute provides the overage limit of the counter.
Counter- Overage- Usage THRESHOLD This attribute provides the overage usage of the counter.
Counter- Threshold- Percentage THRESHOLD This attribute provides the percentage threshold value defined for a counter.
For example, if a threshold is applied at 90% , then this attribute value is 90.
Note : For absolute thresholds, this attribute value remains 0.
Counter- Reset- Timestamp THRESHOLD This attribute provides the last reset time of a counter.
Counter- Unit THRESHOLD Holds counter definition unit value.
Counter- Update- Timestamp THRESHOLD This attribute provides the timestamp when a counter was updated by the create/ update/ delete/ read operation or BCR, such as, Last Admin Update or Billing Cycle Timestamp.
Counter- Usage- Limit THRESHOLD This attribute provides the prorated usage limit defined in a counter.
Current- Overage- Usage THRESHOLD If the overage limit is specified, then current usage in ongoing overage block is calculated as: Current counter value – ( Usage limit + ( Overage limit * ( overage count - 1) ) For example, if Usage Limit is 5 GB, Overage Limit is 2 GB, and Counter- Current Value is 9.
5 GB, then this attribute value is 0.
5 GB.
If no overage limit is defined, then this attribute value remains 0.Table 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1186Charging User Guide Charging rules Attribute name Trigger Description If multiple overage blocks are being consumed in a single call, then this attribute has an overage usage of that overage block only ( current or previous) , for which threshold is being executed.
For example, if Usage Limit is 5 GB and Overage Limit is 1 GB with threshold notification configured on 50% and 100% usage, and also Counter- Current Value jumps from 10 GB to 12.
5 GB in a call, then the threshold notification has three notifications: •On 100% consumption of first overage block ( previous) , which means on 11 GB usage, with Counter- Current- Value as 11 GB, Current Overage- Usage as 1 GB, and Counter- Overage Count as 1.
•On 100% consumption of second overage block ( previous) , which means on 12 GB usage, with Counter- Current- Value as 12 GB, Current Overage- Usage as 1 GB, and Counter- Overage Count as 2.
•On 50% consumption of third overage block ( current) , which means on 12.
5 GB usage, with Counter- Current- Valueas 12.
5 GB, Current Overage- Usage as 0.
5 GB and Counter Overage- Count as 3.
Current- Overage- Usage- Cost THRESHOLD This attribute provides the cost of current on- going overage block.
Counter- Overage- Max- Resets THRESHOLD This attribute provides the maximum number of overage block counts.
Current- Used- Value THRESHOLD This attribute indicates the amount used towards the threshold in bucket and is the current consumption towards bucket.
Delta- To-Next- Threshold THRESHOLD This attribute provides the delta value to next threshold, that is, the difference between a counter current value and upcoming Threshold/ CAP value.
Note : Counter percentage type thresholds and overage thresholds are not considered for this attribute.
has- More- Steps THRESHOLD This attribute returns true, if there is outstanding steps left in the bucket.Table 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1187Charging User Guide Charging rules Attribute name Trigger Description Is-Balance- Increased THRESHOLD This attribute returns true if balance is increased on reset, otherwise it is false.
Is-Diameter- Call THRESHOLD This attribute returns true if request is from a diameter call.
Last- Update- Timestamp THRESHOLD This attribute provides the value when a counter/ bucket was updated by an operation such as CRUD or BCR.
Notification- Generation- Timestamp THRESHOLD This attribute provides the Unix timestamp when the notification is generated.
This is the current time period in seconds.
Notification- Generation- Timestamp- Millis THRESHOLD This attribute provides time when the notification is generated for a counter.
Overage- Allowance THRESHOLD This attribute provides the overage allowance limit.
Overage- Flag THRESHOLD This attribute provides the flag value to identify whether the current threshold is on account overage value.
Overage- Value THRESHOLD This attribute provides the overage value of an account to which a threshold is attached.
Reset- Timestamp THRESHOLD This attribute provides the timestamp of last reset of the counter or bucket.
Subscription- State- Validity- End- Date THRESHOLD This attribute provides the end date of entity lifecycle attached with the subscription.
This value is null when there is no time configured in the entity lifecycle state.
Note : This time is available only when threshold is applied on subscription or subscription counter.
For example, Entity End Time = 2019- 11-11 17: 36:56 IST.
In this case, the date format of end time depends on how the notification template is configured.
Reserve- Entity- Name THRESHOLD This attribute provides the Entity name ( Bucket Def Id, Account Id or Counter Def Id) from which reservation is done.
Reserve- Entity- Type THRESHOLD This attribute provides the Entity Type ( ENTITY_ BUCKET, ENTITY_ ACCOUNT or NOCHARGE) from which reservation is done.Table 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1188Charging User Guide Charging rules Attribute name Trigger Description Reserve- Rate THRESHOLD This attribute provides the Rate Id used for a reservation.
First- Reserve- Rate THRESHOLD This attribute provides the Rate ID which is associated with the entity that is first used in a reservation.
First- Reserve- Entity- Name THRESHOLD This attribute provides the Entity name ( Bucket Def Id, Account Id or Counter Def Id) from which first reservation was done.
First- Reserve- Entity- Type THRESHOLD This attribute provides the Entity type from which first reservation was done.
First- Charging- Service- Reserve THRESHOLD This attribute provides the Charging Service Name for which first reservation was done.
First- Charging- Service- Reserve- Type THRESHOLD This attribute provides the Device/ Group type of CS from which first reservation was done.
First- Bundle- Name- Reserve THRESHOLD This attribute provides the Bundle Name from which first reservation is done.
First- Bundle- Reserve- Type THRESHOLD This attribute provides the Device/ Group name which contains the bundle from which first reservation was done.
Threshold- Compute- Recurrence- Count THRESHOLD This attribute provides the recurrence value in the threshold- crossed action.
Threshold- Current- Absolute- Value THRESHOLD This attribute provides the value of the counter or bucket with the call' s processed value.
For example, a bucket currently has 100 units consumed.
A call comes in which it consumes an additional 50 units.
Hence, it returns 150 units.
Threshold- Current- Percentage- Value THRESHOLD This attribute will provide the percentage value of a bucket, or 100 for a counter.
Percentage is not valid for counters, as there is no maximum value, so always return 100.
Example 1.
A bucket currently has 100 units consumed of 500.
A call comes that consumes an additional 100 units.
This will return 200/ 500 = 40.
Threshold- Is-Crossed THRESHOLD This attribute returns true/ false depending on whether threshold is marked as crossed or not.
Threshold- Crossing- Value THRESHOLD This attribute provides a value at which the threshold is crossed.
Threshold- Name THRESHOLD This attribute provides the name of the threshold whose rules are currently being executed during the call/ session.Table 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1189Charging User Guide Charging rules Attribute name Trigger Description Threshold- Percentage THRESHOLD Buckets can have threshold percentage value.
For absolute threshold, the percentage of absolute limit is calculated.
This means, if the threshold level is set to 900 and the bucket initial value is 1000, then it is 90 percent in the notification.
Counters can only have threshold as absolute start type.
To calculate the percentage of the absolute limit, the maximum limit value of counter is the one which has threshold defined with action Notification- stop/ Notification- Reject, and Reject.
Example : Two thresholds of absolute start of 900 MB and 1000 MB are defined in a counter with action Notificationsend and Notificationstop/ Notification- Reject respectively.
In this case, the threshold percentage is calculated as 90% and 100% Threshold- Profile- Compute- Interval THRESHOLD This attribute provides the threshold interval value for the Threshold- Profile- Interval Count.
Threshold- Profile- Interval- Count THRESHOLD This attribute provides the current interval number before the call.
Threshold- Recurrence- Count THRESHOLD This attribute provides the number of times the threshold has been crossed.
For nonrecurring thresholds, this must always be 0.
Threshold- Value THRESHOLD This attribute provides the threshold value.
Threshold- Value- By-Percentage THRESHOLD This attribute provides the value as per percentage defined in the threshold interval.
Total- Overage- Usage THRESHOLD This attribute provides the total usage in overage blocks when the overage limit is specified.
The total overage usage is calculated as (Current Counter- Value - Counter Usage- Limit) .
For example, if Usage Limit is 5 GB, Overage Limit is 2 GB, and Current- Counter Value is 8.
5 GB, then this attribute calculates the total usage in overage block, which is 3.
5 GB.
If no overage limit is defined, then this attribute value remains zero.
Note : If multiple overage blocks are being consumed in a single call, then this attribute has total overage usage till that overage block ( current or previous) for which threshold is being executed.
For example, if Usage Limit is 5 GB and Overage Limit is 1 GB with thresholdTable 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1190Charging User Guide Charging rules Attribute name Trigger Description notification configured on 50% and 100% usage, and also Counter- Current Value jumps from 10 GB to 12.
5 GB in a call, then the threshold notification has three notifications: •On 100% consumption of first overage block ( previous) , which means on 11 GB usage, with Counter- Current Value as 11 GB, Total Overage- Usage as 1 GB, and Counter- Overage Count as 1.
•On 100% consumption of second overage block ( previous) , which means on 12 GB usage, with Counter- Current Value as 12 GB, Total Overage- Usage as 2 GB, and Counter- Overage Count as 2.
•On 50% consumption of third overage block ( current) , which means on 12.
5 GB usage, with Counter- Current- Value as 12.
5 GB, Total- Overage Usage as 2.
5 GB and Counter- Overage- Count as 3.
Total- Overage- Usage- Cost THRESHOLD This attribute provides total cost of overage blocks used in the billing cycle.
Unit- Of-Remaining- Allowance THRESHOLD This attribute provides the type of unit for a bucket or account.
Note : For an account, the unit is only MONEY type.
Loan- Usage- Flag THRESHOLD This attribute provides the flag value to identify whether the current threshold is on account loan value.
Note : Reserved for internal use by Nokia.
Operators should not configure/ use this parameter.
Loan- Crossing- Value THRESHOLD This attribute provides the loan value of an account to which a threshold is attached.
It is calculated during call execution.
When the account value becomes less than Loan- Crossing- value value, then the threshold is considered as crossed.
Note : Reserved for internal use by Nokia.
Operators should not configure/ use this parameter.
Subscription- Id THRESHOLD This attribute provides the value of Subscription Id Identifier.Table 78: THRESHOLD_PROFILE source context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1191Charging User Guide Charging rules Attribute name Trigger Description Subscription- Creation- Date THRESHOLD This attribute provides the subscription creation date.
Subscription- End- Date THRESHOLD This attribute provides the subscription end date.Table 78: THRESHOLD_PROFILE source context (continued) Usage of attributes in Notification variable For Notification variables (in THRESHOLD_PROFILE source context) that have one of the following attributes, add a data unit to include the unit.
The name of the unit variable must start with the data variable name with separator @ and suffix UNIT .
•Bucket-Current-Value •Bucket-Initial-Value •Carry-Over-Bucket-Current-Value •Bucket-Unused-Value •Bucket-Or-Counter-Current-Value •Counter-Current-Value •Counter-Overage-Limit •Counter-Usage-Limit •AV-Initial-Value •AV-Current-Value Example: NOTIFICATION.Send-Notification ( "N_Template_0_B", NotificationPolicy_ALWAYS_SEND ) and NOTIFICATION.Notification-Variable ( "data", THRESHOLD_PROFILE.Bucket-Current- Value, "N_Template_0_B" ) and NOTIFICATION.Notification-Variable ( "data@UNIT", THRESHOLD_PROFILE.Bucket- Unit, "N_Template_0_B" ) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1192Charging User Guide Charging rules 4.6.36 UC source context Attribute name Trigger Description UC-Result- Type UC_PROCESSING This attribute provides type of UC result, for example, UC_ BARRED, UC_ TRUSTED, GLOBAL_ BARRED, USAGE_ LIMIT_ REACHED, TOD_ BARRED.Table 79: UC source context 4.6.37 VARIABLES source context Attribute name Trigger Description Get- Variable All Triggers This attribute provides value of a variable.
Get- Variable- Size All Triggers This attribute provides the size of a variable with a collection type.Table 80: VARIABLES source context 4.6.38 ADJUST_BALANCE source context Attribute name Trigger Description Reason SUBSCRIBER_ PRE_ PROVISIONING SUBSCRIBER_ POST_ PROVISIONINGThis attribute contains operation typology.
It is used to define different reason code and is a generic field ( free text) .Table 81: ADJUST_BALANCE source context 4.7 Diameter information attributes in charging The GyCCR context contains MSCC and PS-Information attributes in the Gy CCR message.
The MSCC and PS-Information attributes described in the following sections are available in the following triggers for charging: •GY_CREDIT_REQUEST •APPLICABILITY Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1193Charging User Guide Charging rules •TARIFF •THRESHOLD •SLICING_PROFILE •GY_PRE_PROCESSING •GY_POST_PROCESSING •GY_MESSAGE •IMS_CALL_MODIFICATION •IMS_CALL_TERMINATION Attribute Type Multiple- Services- Credit- Control.
Rating- Group BIG INTEGER Multiple- Services- Credit- Control.
Rating- Group[ ] BIG INTEGER Simple AVP that supports multiplesTable 82: Attributes and value types available for charging using the MSCC attributes Attribute Type Service- Information GROUPED Service- Information.
PS-Information.
3GPP2- BSID STRING Service- Information.
PS-Information.
3GPP- Charging- CharacteristicsSTRING Service- Information.
PS-Information.
3GPP- Charging- Id STRING Service- Information.
PS-Information.
3GPP- GGSN- MCC- MNCSTRINGTable 83: Attributes and value types available for charging using the PS attributes Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1194Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
3GPP- GPRS- Negotiated- QoS- ProfileSTRING Service- Information.
PS-Information.
3GPP- IMSI- MCC- MNCSTRING Service- Information.
PS-Information.
3GPP- MS-Time Zone BIG INTEGER Service- Information.
PS-Information.
3GPP- NSAPI STRING Service- Information.
PS-Information.
3GPP- PDP- Type BIG INTEGER Service- Information.
PS-Information.
3GPP- RAT- Type STRING Service- Information.
PS-Information.
3GPP- Selection- ModeSTRING Service- Information.
PS-Information.
3GPP- Session- Stop- IndicatorSTRING Service- Information.
PS-Information.
3GPP- SGSN- MCC- MNCSTRING Service- Information.
PS-Information.
3GPP- User- Location- InfoBIG INTEGER Service- Information.
PS-Information.
Called- Station- Id STRING Service- Information.
PS-Information.
CG-Address STRING Service- Information.
PS-Information.
Change- Condition BIG INTEGER Service- Information.
PS-Information.
Charging- Characteristics- Selection- ModeBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1195Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Charging- Rule- Base- NameSTRING Service- Information.
PS-Information.
Diagnostics BIG INTEGER Service- Information.
PS-Information.
Dynamic- Address- FlagBIG INTEGER Service- Information.
PS-Information.
Dynamic- Address- Flag- ExtensionBIG INTEGER Service- Information.
PS-Information.
GGSN- Address STRING Service- Information.
PS-Information.
GGSN- Address.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
GGSN- Address[ ] STRING Simple AVP that supports multiples Service- Information.
PS-Information.
IMSI- Unauthenticated- FlagBIG INTEGER Service- Information.
PS-Information.
Low- Priority- IndicatorBIG INTEGER Service- Information.
PS-Information.
MME- Name STRING Service- Information.
PS-Information.
MME- Number- for- MT-SMSSTRING Service- Information.
PS-Information.
MME- Realm STRING Service- Information.
PS-Information.
Node- Id STRINGTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1196Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging GROUPED Service- Information.
PS-Information.
Offline- Charging.
Envelope- ReportingBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- ControlBASEGrouped Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- InformationGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
AF-Charging- IdentifierSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
AF-Charging- Identifier[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
FlowsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows.
Final- Unit- ActionBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows.
Final- Unit- Action[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows.
Flow- NumberBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1197Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows.
Flow- Number.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows.
Flow- Number[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows.
Media- Component- NumberBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows.
Media- Component- Number[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Flows[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
AF-Correlation- Information[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
EnvelopeGROUPEDTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1198Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
CC-Input- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
CC-Input- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
CC-Output- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
CC-Output- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
CC-Service- Specific- UnitsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
CC-Service- Specific- Units[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
CC-Total- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
CC-Total- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
Envelope- End- TimeBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1199Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
Envelope- End- Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
Envelope- Start- TimeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
Envelope- Start- Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope- ReportingBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Envelope- Reporting[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- IndicationGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Filter- IdSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Filter- Id.Total- Number- Of-ValuesBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1200Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Filter- Id[]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Final- Unit- ActionBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Final- Unit- Action[ ]BIG INTEGER AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Redirect- ServerGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Redirect- Server.
Redirect- Address- TypeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Redirect- Server.
Redirect- Address- Type[ ]BIG INTEGER AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Redirect- Server.
Redirect- Server- AddressBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Redirect- Server.
Redirect- Server- Address[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Redirect- Server[ ]GROUPED Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1201Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Restriction- Filter- RuleSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Restriction- Filter- Rule.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication.
Restriction- Filter- Rule[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Final- Unit- Indication[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- UnitGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Input- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Input- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-MoneyBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money.
Currency- CodeBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1202Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money.
Currency- Code[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money.
Unit- ValueGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money.
Unit- Value.
ExponentBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money.
Unit- Value.
Exponent[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money.
Unit- Value.
Value- Digits[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money.
Unit- Value.
Value- DigitslBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money.
Unit- Value[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Money[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Output- OctetsBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1203Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Output- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Service- Specific- UnitsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Service- Specific- Units[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-TimeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Total- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
CC-Total- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
Tariff- Time- ChangeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit.
Tariff- Time- Change[ ]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1204Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Granted- Service- Unit[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- ReferenceGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
CC-Unit- TypeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
CC-Unit- Type[ ]BIG INTEGER AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
G-S-U-Pool- IdentifierGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
G-S-U-Pool- Identifier[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
Unit- ValueBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
Unit- Value.
ExponentBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1205Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
Unit- Value.
Exponent[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
Unit- Value.
Value- DigitsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
Unit- Value.
Value- Digits[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference.
Unit- Value[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
G-S-U-Pool- Reference[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
PS-Furnish- Charging- InformationGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
PS-Furnish- Charging- Information.
3GPP- Charging- IdSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
PS-Furnish- Charging- Information.
3GPP- Charging- Id[]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
PS-Furnish- Charging- Information.
PS-Append- Free- Format- DataBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1206Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
PS-Furnish- Charging- Information.
PS-Append- Free- Format- Data[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
PS-Furnish- Charging- Information.
PS-Free- Format- DataSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
PS-Furnish- Charging- Information.
PS-Free- Format- Data[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
PS-Furnish- Charging- Information[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- InformationGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- ArbiterGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- NameSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Name[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- DLBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1207Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Arbiter[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- PolicerGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1208Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Policer- IdGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
ALC- Policer- Id[]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1209Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Policer[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- QueueGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- DLBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1210Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Queue- IdSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Queue- Id[]STRING Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1211Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- DLBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1212Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Queue[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Sub- Egress- Rate- LimitBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
ALC- Sub- Egress- Rate- Limit[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Allocation- Retention- PriorityGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- CapabilityBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1213Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- Capability[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- VulnerabilityBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- Vulnerability[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Allocation- Retention- Priority.
Priority- LevelBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Allocation- Retention- Priority.
Priority- Level[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Allocation- Retention- Priority[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
APN- Aggregate- Max- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
APN- Aggregate- Max- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
APN- Aggregate- Max- Bitrate- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1214Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
APN- Aggregate- Max- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Bearer- IdentifierSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Bearer- Identifier[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Guaranteed- Bitrate- UL[]BIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Max- Requested- Bandwidth- DL[]BIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1215Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
Max- Requested- Bandwidth- UL[]BIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
QoS- Class- IdentifierGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information.
QoS- Class- Identifier[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
QoS- Information[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Quota- Consumption- TimeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Quota- Consumption- Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Quota- Holding- TimeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Quota- Holding- Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Rating- GroupBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1216Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Rating- Group[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Refund- InformationSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Refund- Information[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Reporting- ReasonBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Reporting- Reason.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Reporting- Reason[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- UnitBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Input- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Input- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-MoneyBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1217Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money.
Currency- CodeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money.
Currency- Code[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money.
Unit- ValueBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money.
Unit- Value.
ExponentBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money.
Unit- Value.
Exponent[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money.
Unit- Value.
Value- DigitsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money.
Unit- Value.
Value- Digits[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money.
Unit- Value[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Money[ ]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1218Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Output- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Output- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Service- Specific- UnitsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Service- Specific- Units[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-TimeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Total- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit.
CC-Total- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Requested- Service- Unit[ ]GROUPED Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1219Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Result- CodeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Result- Code[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- IdentifierBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Identifier.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Identifier[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Specific- InfoGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Specific- Info.
Service- Specific- DataSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Specific- Info.
Service- Specific- Data[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Specific- Info.
Service- Specific- TypeSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Specific- Info.
Service- Specific- Type[ ]STRING Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1220Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Specific- Info.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Service- Specific- Info[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Time- Quota- MechanismGROUPED Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Time- Quota- Mechanism.
Base- Time- IntervalBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Time- Quota- Mechanism.
Base- Time- Interval[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Time- Quota- Mechanism.
Time- Quota- TypeSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Time- Quota- Mechanism.
Time- Quota- Type[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Time- Quota- Mechanism[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Time- Quota- ThresholdBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Time- Quota- Threshold[ ]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1221Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Total- Number- Of- ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
TriggerSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Trigger.
Trigger- TypeSTRING Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Trigger.
Trigger- Type.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Trigger.
Trigger- Type[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Trigger[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Unit- Quota- ThresholdBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Unit- Quota- Threshold[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- UnitBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Input- OctetsBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1222Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Input- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- MoneyBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money.
Currency- CodeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money.
Currency- Code[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money.
Unit- ValueBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money.
Unit- Value.
ExponentBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money.
Unit- Value.
Exponent[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money.
Unit- Value.
Value- DigitsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money.
Unit- Value.
Value- Digits[ ]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1223Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money.
Unit- Value[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Money[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Output- OctetsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Output- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Service- Specific- UnitsBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Service- Specific- Units[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- TimeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Total- OctetsBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1224Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
CC- Total- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
Tariff- Change- UsageBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
Tariff- Change- Usage[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Used- Service- Unit[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Validity- TimeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Validity- Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Volume- Quota- ThresholdBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control.
Volume- Quota- Threshold[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Offline- Charging.
Multiple- Services- Credit- Control[ ]BASEGrouped AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1225Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Offline- Charging.
Quota- Consumption- TimeBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Time- Quota- MechanismGROUPED Service- Information.
PS-Information.
Offline- Charging.
Time- Quota- Mechanism.
Base- Time- IntervalBIG INTEGER Service- Information.
PS-Information.
Offline- Charging.
Time- Quota- Mechanism.
Time- Quota- TypeBIG INTEGER Service- Information.
PS-Information.
PDN- Connection- Charging- IDBIG INTEGER Service- Information.
PS-Information.
PDP- Address STRING Service- Information.
PS-Information.
PDP- Address.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
PDP- Address[ ] STRING Simple AVP that supports multiples Service- Information.
PS-Information.
PDP- Address- Prefix- LengthBIG INTEGER Service- Information.
PS-Information.
PDP- Context- Type BIG INTEGER Service- Information.
PS-Information.
PS-Furnish- Charging- InformationGROUPED Service- Information.
PS-Information.
PS-Furnish- Charging- Information.
3GPP- Charging- IdSTRINGTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1226Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
PS-Furnish- Charging- Information.
PS-Append- Free- Format- DataBIG INTEGER Service- Information.
PS-Information.
PS-Furnish- Charging- Information.
PS-Free- Format- DataSTRING Service- Information.
PS-Information.
QoS- Information GROUPED Service- Information.
PS-Information.
QoS- Information.
ALC- ArbiterGROUPED Service- Information.
PS-Information.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- NameSTRING Service- Information.
PS-Information.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- PolicerGROUPED Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- DL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- UL[]BIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1227Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- DL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- UL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Policer- IdSTRING Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
ALC- Policer- Id[]STRING Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- DL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- UL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- DL[]BIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1228Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- UL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Policer[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
QoS- Information.
ALC- QueueGROUPED Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- DL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- UL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- DL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1229Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- UL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Queue- IdSTRING Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Queue- Id[]STRING Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- DL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- UL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- DL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- UL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- DLBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1230Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- DL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- UL[]BIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
ALC- Queue[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
QoS- Information.
ALC- Sub- Egress- Rate- LimitBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
Allocation- Retention- PriorityGROUPED Service- Information.
PS-Information.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- CapabilityBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- VulnerabilityBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
Allocation- Retention- Priority.
Priority- LevelBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
APN- Aggregate- Max- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
APN- Aggregate- Max- Bitrate- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1231Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
QoS- Information.
Bearer- IdentifierSTRING Service- Information.
PS-Information.
QoS- Information.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
QoS- Information.
QoS- Class- IdentifierBIG INTEGER Service- Information.
PS-Information.
Service- Data- ContainerGROUPED Service- Information.
PS-Information.
Service- Data- Container.
3GPP2- BSIDSTRING Service- Information.
PS-Information.
Service- Data- Container.
3GPP2- BSID[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
3GPP- User- Location- InfoSTRING Service- Information.
PS-Information.
Service- Data- Container.
3GPP- User- Location- Info[ ]STRING Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1232Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
Accounting- Input- OctetsBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Accounting- Input- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Accounting- Input- PacketsBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Accounting- Input- Packets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Accounting- Output- OctetsBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Accounting- Output- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Accounting- Output- PacketsBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Accounting- Output- Packets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- InformationGROUPED Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
AF-Charging- IdentifierSTRING Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
AF-Charging- Identifier[ ]STRING Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1233Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
FlowsGROUPED Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows.
Final- Unit- ActionBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows.
Final- Unit- Action[ ]BIG INTEGER AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows.
Flow- NumberBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows.
Flow- Number.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows.
Flow- Number[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows.
Media- Component- NumberBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows.
Media- Component- Number[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows.
Total- Number- Of-ValuesBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1234Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information.
Flows[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
AF-Correlation- Information[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Application- Service- Provider- IdentitySTRING Service- Information.
PS-Information.
Service- Data- Container.
Application- Service- Provider- Identity[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Change- ConditionBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Change- Condition.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Change- Condition[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Change- TimeBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Change- Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Charging- Rule- Base- NameSTRING Service- Information.
PS-Information.
Service- Data- Container.
Charging- Rule- Base- Name[ ]STRING Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1235Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
Local- Sequence- NumberBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Local- Sequence- Number[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- InformationGROUPED Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- ArbiterGROUPED Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- NameSTRING Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Name[ ]STRING Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- UL[]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1236Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Arbiter[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- PolicerGROUPED Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1237Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Policer- IdGROUPED Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
ALC- Policer- Id[]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- DL[]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1238Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Policer[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- QueueGROUPED Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1239Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Queue- IdSTRING Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Queue- Id[]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1240Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- UL[]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1241Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Queue[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Sub- Egress- Rate- LimitBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
ALC- Sub- Egress- Rate- Limit[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Allocation- Retention- PriorityGROUPED Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- CapabilityBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- Capability[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- VulnerabilityBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- Vulnerability[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Allocation- Retention- Priority.
Priority- LevelBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1242Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Allocation- Retention- Priority.
Priority- Level[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Allocation- Retention- Priority[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
APN- Aggregate- Max- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
APN- Aggregate- Max- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
APN- Aggregate- Max- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
APN- Aggregate- Max- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Bearer- IdentifierSTRING Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Bearer- Identifier[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1243Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Guaranteed- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Max- Requested- Bandwidth- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
Max- Requested- Bandwidth- UL[]BIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
QoS- Class- IdentifierBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information.
QoS- Class- Identifier[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
QoS- Information[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Rating- GroupBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1244Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
Rating- Group[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Service- IdentifierBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Service- Identifier[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Service- Specific- InfoGROUPED Service- Information.
PS-Information.
Service- Data- Container.
Service- Specific- Info.
Service- Specific- DataSTRING Service- Information.
PS-Information.
Service- Data- Container.
Service- Specific- Info.
Service- Specific- Data[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Service- Specific- Info.
Service- Specific- TypeBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Service- Specific- Info.
Service- Specific- Type[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Service- Specific- Info[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
SGSN- AddressSTRING Service- Information.
PS-Information.
Service- Data- Container.
SGSN- Address[ ]STRING that supprts multipleTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1245Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Service- Data- Container.
Sponsor- IdentitySTRING Service- Information.
PS-Information.
Service- Data- Container.
Sponsor- Identity[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Time- First- UsageBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Time- First- Usage[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Time- Last- UsageBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Time- Last- Usage[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Time- UsageBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container.
Time- Usage[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Service- Data- Container.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
Service- Data- Container[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Serving- Node- Type BIG INTEGER Service- Information.
PS-Information.
SGSN- Address STRINGTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1246Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
SGSN- Address.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
SGSN- Address[ ] STRING Simple AVP that supports multiples Service- Information.
PS-Information.
SGW- Address STRING Service- Information.
PS-Information.
SGW- Address.
Total- Number- Of-ValuesBIG INTEGER Service- Information.
PS-Information.
SGW- Address[ ] STRING Service- Information.
PS-Information.
SGW- Change BIG INTEGER Service- Information.
PS-Information.
Start- Time BIG INTEGER Service- Information.
PS-Information.
Stop- Time BIG INTEGER Service- Information.
PS-Information.
Terminal- InformationGROUPED Service- Information.
PS-Information.
Terminal- Information.
3GPP2- MEIDSTRING Service- Information.
PS-Information.
Terminal- Information.
IMEISTRING Service- Information.
PS-Information.
Terminal- Information.
Software- VersionSTRING Service- Information.
PS-Information.
Traffic- Data- VolumesGROUPEDTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1247Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
3GPP- User- Location- InfoSTRING Service- Information.
PS-Information.
Traffic- Data- Volumes.
3GPP- User- Location- Info[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
Accounting- Input- OctetsBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
Accounting- Input- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
Accounting- Input- PacketsBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
Accounting- Input- Packets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
Accounting- Output- OctetsBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
Accounting- Output- Octets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
Accounting- Output- PacketsBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
Accounting- Output- Packets[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
Change- ConditionBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1248Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
Change- Condition[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
Change- TimeBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
Change- Time[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- InformationGROUPED Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- ArbiterGROUPED Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- NameSTRING Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Name[ ]STRING Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1249Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Arbiter.
ALC- Arbiter- Rate- Limit- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Arbiter[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- PolicerGROUPED Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Committed- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1250Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Maximum- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Policer- IdGROUPED Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
ALC- Policer- Id[]GROUPED Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Guaranteed- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- DLBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1251Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Max- Requested- Bandwidth- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer.
Total- Number- Of- ValuesBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Policer[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- QueueGROUPED Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1252Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Committed- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Maximum- Burst- Size- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Queue- IdGROUPED Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Queue- Id[]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- DL[]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1253Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
ALC- Wrr- Weight- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Guaranteed- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- ULBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1254Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Max- Requested- Bandwidth- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue.
Total- Number- Of- ValuesBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Queue[ ]GROUPED Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Sub- Egress- Rate- LimitBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
ALC- Sub- Egress- Rate- Limit[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Allocation- Retention- PriorityGROUPED Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- CapabilityBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- Capability[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- VulnerabilityBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Allocation- Retention- Priority.
Pre- emption- Vulnerability[ ]BIG INTEGER Simple AVP that supports multiplesTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1255Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Allocation- Retention- Priority.
Priority- LevelBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Allocation- Retention- Priority.
Priority- Level[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Allocation- Retention- Priority[ ]GROUPED AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
APN- Aggregate- Max- Bitrate- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
APN- Aggregate- Max- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
APN- Aggregate- Max- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
APN- Aggregate- Max- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Bearer- IdentifierSTRING Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Bearer- Identifier[ ]STRING Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Guaranteed- Bitrate- DLBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1256Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Guaranteed- Bitrate- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Guaranteed- Bitrate- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Guaranteed- Bitrate- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Max- Requested- Bandwidth- DLBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Max- Requested- Bandwidth- DL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Max- Requested- Bandwidth- ULBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
Max- Requested- Bandwidth- UL[]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
QoS- Class- IdentifierBIG INTEGER Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information.
QoS- Class- Identifier[ ]BIG INTEGER Simple AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
QoS- Information[ ]GROUPED AVP that supports multiples Service- Information.
PS-Information.
Traffic- Data- Volumes.
Total- Number- Of-ValuesBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1257Charging User Guide Charging rules Attribute Type Service- Information.
PS-Information.
Traffic- Data- Volumes[ ]GROUPED AVP that supports multiples Service- Information.
PS-Information.
TWAN- User- Location- InfoGROUPED Service- Information.
PS-Information.
TWAN- User- Location- Info.
BSSIDSTRING Service- Information.
PS-Information.
TWAN- User- Location- Info.
SSIDSTRING Service- Information.
PS-Information.
User- CSG- InformationGROUPED Service- Information.
PS-Information.
User- CSG- Information.
CSG- Access- ModeBIG INTEGER Service- Information.
PS-Information.
User- CSG- Information.
CSG- IdBIG INTEGER Service- Information.
PS-Information.
User- CSG- Information.
CSG- Membership- IndicationBIG INTEGER Service- Information.
PS-Information.
User- Equipment- InfoGROUPED Service- Information.
PS-Information.
User- Equipment- Info.
User- Equipment- Info- TypeBIG INTEGER Service- Information.
PS-Information.
User- Equipment- Info.
User- Equipment- Info- ValueSTRING Service- Information.
PS-Information.
User- Location- Info- TimeBIG INTEGERTable 83: Attributes and value types available for charging using the PS attributes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1258Charging User Guide Charging rules 4.8 Result context A ResultContext is a collection of result attributes produced by running the RuleSet through the rules engine.
The rule engine places the results into the appropriate result context based on the description provided by the action attribute's description.
All the results are provided into an object, which has a set of ResultContexts.
See the ResultContextType.java for a list of possible ResultContexts.
The application code will look in the appropriate result context for the action attributes it needs to operate on.
You configure the Action Attribute for the rule by determining the Result Context Type and attribute name.
CAUTION : When a rule is created, modified, removed, or loaded, it takes a minimum of 30 seconds to load the RSV.
For any action that updates the rules (for example, a TPG value is updated from 10 to 20, an action is updated, or a Tariff Rule action is modified), the changes take effect after ~30 seconds.
Operators must wait for this time interval (30 seconds), to consider the change for feature implementation/execution.
Attention : Result context action System.Do-Nothing can be used in a charging service/ logic tariff pass.
If this action is configured in rule, then NCC logic skips the current pass doing nothing in usage, charging, etc., and moves to the next pass.
Diameter Answer result context for common usage The Diameter Answer context encapsulates the common AVPs that any Diameter response can contain.
In the case of an incoming Diameter Answer message, the rule engine is invoked twice.
It is invoked the first time to execute the generic Diameter Answer rule set, which allows rules to be written that apply to many or all answer types.
For example, if you wanted to change the value of the origin-host AVP for all answer message types, you would write the rule in the Diameter Answer rule set.
After the rule engine has been invoked for the answer rule set, it is invoked a second time for the specific message type rule set.
For example, when the rule engine processes a Gy CCA message type, the generic Diameter Answer rule set is executed the first time the rule engine is invoked.
The application message- specific Gy CCA rule set is executed during the second invocation.
Mapping of result contexts to triggers for charging The following table lists the mappings of result contexts, which contain the result information evaluated by rule engine for NCC.
Applicable result context Triggers Description CALL_ RESUL T APPLICABILITY GY_ CREDIT_ REQUEST GY_POST_ PROCESSING GY_ SESSION_ ESTABLISHMENT GY_ SESSION_ MODIFICATION GY_SESSION_ TERMINATION IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONThis result context holds the actions available to access and set zoning, roaming, call SubType, direct debit failure handling, and credit control failure handling.Table 84: Trigger - result context mapping Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1259Charging User Guide Charging rules Applicable result context Triggers Description IMS_ CALL_ ESTABLISHMENT SLICING_ PROFILE SMS_ CALL_ TERMINATION SNR_ RESUL T SY_ SESSION_ ESTABLISHMENT SY_ SESSION_ MODIFICATION TARIFF THRESHOLD NCHF_ CALL_ ESTABLISHMENT NCHF_ CALL_ MODIFICATION NCHF_ CALL_ TERMINATION RESOURCE_ PRE_ SORTING RATING APPLICABILITY GY_ CREDIT_ REQUEST IMS_ CALL_ ESTABLISHMENT SLICING_ PROFILEThis result context holds the actions available to access and set rating attributes.
SESSION_ PARAMETERS SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_ SESSION_ MODIFICATION TARIFF THRESHOLD NCHF_ CHARGING_ ESTABLISHMENT NCHF_ CHARGING_ MODIFICATION NCHF_ CHARGING_ TERMINATION SLICING_ PROFILE MMS_ CALL_ ESTABLISHMENT GY_ SESSION_ TERMINATION GY_SESSION_ MODIFICATION GY_ PRE_ PROCESSING GY_ POST_ PROCESSING GY_ CREDIT_ REQUEST APPLICABILITY RESOURCE_ PRE_ SORTINGThis result context provides the NCC rule engine with access to a session specific information.
BUNDLE BUNDLE This result context is used for BOU type of bundles.
RULE_ TABLE GY_MESSAGE This result context holds the actions available to access and set specific rule groups.
NOTIFICATION GY_POST_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONThis result context holds the actions available to access and set notification attributes.
SPR_ DEVICE GY_POST_ PROCESSING GY_ SESSION_ ESTABLISHMENT IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION MMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENT RESOURCE_ PRE_ SORTINGThis result context provides device specific details to the NCC rule engine.Table 84: Trigger - result context mapping (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1260Charging User Guide Charging rules Applicable result context Triggers Description SPR_ GROUP GY_POST_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION SLICING_ PROFILE SMS_ CALL_ ESTABLISHMENTThis result context contains the group information.
GY_POST_ PROCESSING GY_POST_ PROCESSING This result context is applied for any actions to be taken at Gy Post processing.
It is for processing trigger at call control and should be evolved per use case.
GY_PRE_ PROCESSING GY_PRE_ PROCESSING This result context is applied for any actions to be taken at Gy Pre processing.
It is for processing trigger at call control and should be evolved per use case.
RESOURCE_ POST_ PROCESSING IMS_ CALL_ MODIFICATION This result context is evaluated on COMMIT of every resource, such as bucket, counter, main account balance, and No Charge.
DYNAMIC_ SLICE IMS_ CALL_ TERMINATION This result context is used to define different attributes like slice size, validity- time etc.
SY MMS_ CALL_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENTThis result context provides SY session specific details to the NCC rule engine.
THRESHOLD SMS_ CALL_ ESTABLISHMENT This result context holds the actions available to access and set threshold attributes.
LOAN_ RESUL T LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGThis result context holds the action available to process the loan request.Table 84: Trigger - result context mapping (continued) 4.9 Result contexts and actions Result contexts The result context contains all the actions performed by the rating engine.
The subsequent blocks provide information on the attributes and triggers for the specific result context.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1261Charging User Guide Charging rules 4.9.
1 ANNOUNCEMENT result context Attribute name Trigger Description Announcement- Parameter THRESHOLD This action is used to set announcement frequency ( number of times to be played) and priority.
Usage: ANNOUNCEMENT.Announcement-Parameter ( Announcement Frequency_LONG, AnnouncementPriority_LONG ) Example: ANNOUNCEMENT.Announcement-Parameter ( 5, 999 ) If frequency is not configured, then there is no limit for the announcement frequency.
If priority is not configured, then the announcement has the lowest priority.
Add- Retry- Times IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONThis attribute indicates that re- prompt for PAC is invoked and retry times need to be increased.
Prompt- And- Collect- ParameterIMS_ CALL_ ESTABLISHMENT THRESHOLD RATING_ POST_ PROCESSINGThis attributes is used to set the detail PAC actions and max retry times for re- prompt.
PAC_ Action is a required parameter.
Retry Times is an optional parameter.
If not specified, no retry is allowed.
For example, PAC_ Action is Activation- Language- Selection.
Retry Times is 3.
RePrompt- Allowed IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONThis attribute provides the functionality to check if re- prompt is allowed and max retry times is not reached for current PAC action.
Validate- Collected- Digits IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONThis attribute provides the functionality to check if the length of collected digits match the range defined by minimum digits and maximum digits.
Is-Language- Selection IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONThis attribute is used to indicate that the current IMS session is in PAC state for language selection.Table 85: ANNOUNCEMENT result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1262Charging User Guide Charging rules 4.9.2 GLOBAL result context Attribute name Trigger Description Return- Cause GY_PRE_ PROCESSING This action returns the exact cause of failure for the call.
Return- Result- Code GY_PRE_ PROCESSING This action returns with specific result code and terminate the call.Table 86: GLOBAL result context 4.9.3 BUNDLE result context Attribute name Trigger Description Activation- Fee BUNDLE It is used to set the activation fee for a BOU bundle.
BUNDLE Add- Subscription THRESHOLDIt is used to attach a subscription.
BUNDLE Bundle- Name THRESHOLDIt is the new bundle name to subscribe.
Discount- Percentage BUNDLE It is used to set the discount for a BOU bundle.
Activation- Event BUNDLE It is used to set the activation event for the BOU bundle.
Set- Activation- Count BUNDLE It is used to count the number of times a BOU bundle is activated.
Tariff- Time- Change BUNDLE It is the tariff switch time.
Align- With- Account- BC BUNDLE It is used to configure the BOU bundle to refer to billing information of the linked account for end datetime calculation.
Tariff- Time- Change- Multiple BUNDLE It is the multiple tariff change time points configured as the Tariff- Time- Change- Multiple in bundle rules and considered for all subscriptions which may be used in the call.
Grace- Period- Bucket BUNDLE It defines the name of the grace bucket in the bundle rule.
The bucket is a normal bucket of type volume and it is defined in tariff rules in charging logic.
If configured as BUNDLE.
Grace- Period- Bucket = " <Bucket- Name> " in bundle rules, it triggers call logic to send grace bucket name to Charge FeeAction .
This action checks the status of bucket, that is, whether it is exhausted or not.Table 87: BUNDLE result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1263Charging User Guide Charging rules Attribute name Trigger Description Sample rule: BUNDLE.Activation-Fee = 8 and BUNDLE.Activation-Event = " activateBOU" and BUNDLE.Grace-Period-Bucket ="GB1" Location- Counter- Status BUNDLE It returns the Location Policy Counter Status that is configured in bundle rule.
Roaming- Status BUNDLE It returns the Roaming Status that is configured in bundle rule.Table 87: BUNDLE result context (continued) 4.9.4 CALL_RESUL T result context Attribute name Trigger Description IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION TARIFF THRESHOLD RATING_ POST_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION GY_POST_ PROCESSING DEVICE_ NOT_ FOUNDAdd- AVP- In-CCA RESOURCE_ PRE_ SORTINGIt is used to add any existing AVP in dictionary or the Vendor Specific AVP ( VSA) at root level or MSCC level.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONAdd- CDR THRESHOLDIt is used to add a new CDR tag with value, it is a command level.Table 88: CALL_RESULT result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1264Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION GY_POST_ PROCESSING GY_PRE_ PROCESSING DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTING GY_SESSION_ ESTABLISHMENT RESOURCE_ PRE_ SORTING NCHF_ CHARGING_ CALL_ ESTABLISHMENT RESOURCE_ PRE_ SORTINGADD- Initial- CDR IMS_ CALL_ ESTABLISHMENT RESOURCE_ PRE_ SORTINGIt is used to optionally allow the generation of CDR at the start of a voice ( 4G) or data ( 4G and 5G) session.
Use this attribute in the following triggers: •for 4G data: GY_ SESSION_ ESTABLISHMENT •for 5G data: NCHF_ CHARGING_ CALL_ ESTABLISHMENT •for 4G voice: IMS_ CALL_ ESTABLISHMENT The result varies for different scenarios as follows: 4G/5G data:Table 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1265Charging User Guide Charging rules Attribute name Trigger Description •If this action is NOT present or set to true , then CDR is generated at every CCR- I, CCR- U, and CCR- T. •If this action is present and set to false , then CDR is generated only for CCR- U and CCR- T. 4G voice: •If Enable- Single- CDR is NOT present and ( ADD- Initial- CDR is NOT present OR set to true ) then CDR is generated at CCR- I, CCR- U, and CCR- T. •If Enable- Single- CDR is NOT present and ADD- Initial- CDR is set to false then CDR is generated only at CCR- U and CCR- T. •If Enable- Single- CDR is present and ( ADD- Initial- CDR is NOT present or set to false ) then a single CDR for the complete call is generated.
•If Enable- Single- CDR is present and ADD- Initial- CDR is set to true then a CDR for CCR- I and a single CDR for the complete call is generated.
The type is: Boolean Enum_ TRUE Boolean Enum_ FALSE EDR_ PROCESSING THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGAdd- EDR RESOURCE_ PRE_ SORTINGIt is used to add a new EDR tag with value, it is a command level.
It is also used in loan balance threshold to generated loan usage EDRs.
Following are some example usage for this action to add custom tag to EDR: •Add the custom tags to the EDR CALL_ RESUL T. Add- EDR ( " default Tariff Plan" , SPR_ DEVICE.
ps Default Tariff Plan) in TPG rules.
•Add custom tag to write the threshold value on which threshold is crossed: CALL_ RESULT.
Add- EDR ( " Threshold_ Value" ,THRESHOLD_ PROFILE.
Threshold- Value ) •Add custom tag to write the post balance of Account: CALL_ RESULT.
Add- EDR ( " Post_ Account_ Balance" ,THRESHOLD_ PROFILE.
Account- Unused- Value) Add- EDR- Action THRESHOLD RESOURCE_ PRE_ SORTINGThis action generates an EDR by accepting the customized values of Record Type, invoked By, and invoked Method as its input parameters.
In this action, Record Type and invoked By are mandatory parameters, and invoked Method is optional.
It is a command level.Table 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1266Charging User Guide Charging rules Attribute name Trigger Description Example: CALL_ RESUL T. Add- EDR- Action( "value1_ customized_ Record Type" , "value_ customized_ invoked By", "value2_ customized_ invoked Method" ) It is also used in loan balance threshold to generated loan usage EDRs.
ADD- Update- CDR IMS_ CALL_ MODIFICATION RESOURCE_ PRE_ SORTINGThis action is used to generate CDRs for each update request when Enable- Single- CDR action is present.
If ADD- Update- CDR and ADD- Initial- CDR are set to true , and Enable- Single- CDR is present, then CDR is generated for CCR- I, CCR- U, CCR- T, and single CDR is generated for the session.
If ADD- Update- CDR and ADD- Initial- CDR are set to true , and Enable- Single- CDR is not present, then CDR is generated for CCR- I, CCR- U, and CCR- T. If ADD- Update- CDR is set to true , ADD- Initial- CDR is not present or set to false , and Enable- Single- CDR is not present, then CDR is generated for CCR- I, CCR- U, and CCR- T. If ADD- Update- CDR is set to true, ADD- Initial- CDR is not present, and Enable- Single- CDR is present, then CDR is generated for CCR- U and CCR- T. If ADD- Update- CDR is not present or set to false , ADD- Initial- CDR is present or set to true , and Enable- Single- CDR is present, then CDR is generated for CCR- I and CCR- T. The type is: Boolean Enum_ TRUE Boolean Enum_ FALSE Call- Type GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGDefined from service- context- id AVP and rating group to specify SMS or PS type calls.
An ENUM value as defined by a Credit Request Profile rule or an ENUM value determined using a rule variable.
Entered as an ENUM value.
GY_CREDIT_ REQUEST SLICING_ PROFILECall- Country RESOURCE_ PRE_ SORTINGA value which represents the country of call.
GY_CREDIT_ REQUEST Call- Roaming- Status SLICING_ PROFILEThe roaming status of the current device.
It can have the following values: •HomeTable 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1267Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING•Roaming Call- Zones GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGA value used to represent one or more zones.
Can be a STRING or a list of STRINGS that are type/ value pairs.
Call- Sub- Type GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGA STRING value as defined by a Credit Request Profile rule or STRING value determined using a rule variable.
Entered as a user- defined STRING value.
CDR- Type DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGUsed to get CDR type from complex map row.
Possible values are RATED and UNRATED.
Credit- Control- Failure- Handling GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThe value to set for the Credit- Control- Failure- Handling AVP in the CCA.
One of the following entered as an ENUM value: •TERMINATE ( 0) •CONTINUE ( 1) •RETRY AND TERMINATE ( 2) CC-Session- Failover GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThe value of this parameter gets picked for processing through the active RSV.
It can have the following values: •0 (FAILOVER_ NOT_ SUPPORTED) •1 (FAILOVER_ SUPPORTED) •2 (IGNORE) Direct- Debiting- Failure- Handling GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThe value to set for the Direct- Debiting- Failure- Handling AVP in the CCA.
Default- Roaming- Decision GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThis action is used when the value of the action Call- Roaming- Status cannot be determined from the other source.
It can have the following values: •Home •Roaming •Reject Default- Zoning- Decision GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThis action is used when the system cannot get the charging zones.
One of the following: •DROP_ CALL : When the system cannot get the charging zones, reject the request.
•DEFAULT_ ZONE : If the system cannot get the charging zones, then set the charging zone to the default zone.Table 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1268Charging User Guide Charging rules Attribute name Trigger Description Device- Profile DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGThis action is used to get Global Group from complex map row.
eCommerce- Reject RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTING ECOMMERCE_ CALL_ ESTABLISHMENTThis attribute rejects an e- commerce API instance.
Call- Request- Time GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThis action is used in a rule table or in default actions of the Credit Request Profile to provide a time value assigned to the Request Time.
If this action is not used in a rule table/ default action in the Credit Request Profile, then the default value ( Event- Time- Stamp AVP) is assigned to request time.
If the request time value is not set by an action or the Event- Time- Stamp AVP is not present in the CCR message, the local system time is used to provide the time of day functionality.
LONG Default value: Event- Time- Stamp The AVP carries the default request time info as Event- Time- Stamp in CCR.
The Diameter stack decodes it into the UTC epoc time in milliseconds.
Call controller uses the value in this AVP as Request Time and passes it to Rating.
The possible user- defined values are either Event- Time- Stamp or the value of Local- System- Time, as follows: •GY_MESSAGE.
Local- System- Time •GY_MESSAGE.
Event- Time- Stamp NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Message- Priority RESOURCE_ PRE_ SORTINGThis is used to specify the HTTP/ 2 message priority for 3GPP service based interfaces.
This header can be included in HTTP/ 2 messages when a priority for the message needs to be conveyed.
For example, HTTP/ 2 messages related to Multimedia Priority Sessions.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATIONHttp Header.
3gpp- Sbi-Callback NCHF_ CHARGING_ CALL_ TERMINATIONThis indicates if a HTTP/ 2 message is a callback, for example, notification.
This can be included in the HTTP POST messages for callbacks towards NF service consumer( s) in another PLMN through the SEPP ( see 3GPP TS 29.
573[ 27]).Table 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1269Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTINGThis can also be included in the HTTP POST messages for callbacks in indirect communication.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Target- apiRoot RESOURCE_ PRE_ SORTINGThis is used by an HTTP client to indicate the api Root of the target URI when communicating indirectly with the HTTP server through an SCP.
This can also be used by an HTTP client to indicate the api Root of the target URI towards HTTP server in another PLMN through the SEPP, when TLS is used between the SEPPs.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Routing- Binding RESOURCE_ PRE_ SORTINGThis is used in a service request to signal binding information to direct the service request an HTTP server which has the targeted NF Service Resource context.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Binding RESOURCE_ PRE_ SORTINGThis is used to signal binding information related to an NF Service Resource to a future consumer ( HTTP client) of that resource.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Producer- Id RESOURCE_ PRE_ SORTINGThis is used in a service response from the SCP to the NF Service Consumer, when using indirect communication with delegated discovery and the NF Service Producer does not return a binding indication in a service response creating a resource.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Oci RESOURCE_ PRE_ SORTINGThis can be used by an overloaded NF Service Producer in a service response, or in a notification request to signal Overload Control Information ( OCI) to the NF Service Consumer.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT Http Header.
3gpp- Sbi-Lci NCHF_ CHARGING_ CALL_ MODIFICATIONThis can be used by a NF Service Producer to send Load Control Information ( LCI) to the NF Service Consumer.Table 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1270Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Origination- Timestamp RESOURCE_ PRE_ SORTINGThis contains the date and time ( with a millisecond granularity) when the originating entity initiated the request.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Sender- Timestamp RESOURCE_ PRE_ SORTINGThis indicates the date and time ( with millisecond granularity) at which an HTTP request or response is originated.
This may be used, for example, for measuring signaling delays between different NF service instances.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Max- Rsp- Time RESOURCE_ PRE_ SORTINGThis may be used in a HTTP request to indicate the duration which the HTTP client waits for a response.
Http Header.
Via NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGThis header is inserted by HTTP proxies, an SCP or SEPP when relaying an HTTP error response, or when relaying other HTTP responses.
When inserted by an SCP or SEPP, the pattern of the header should be formatted as follows: •SCP- <SCP FQDN> for an SCP •SEPP- <SEPP FQDN> for a SEPP This is a mandatory standard header.
Http Header.
3gpp- Sbi-Client- CredentialsNCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGThis header may be used by an NF service consumer to send client credentials assertion to the NRF or to the NF Service Producer.
This is a mandatory HTTP custom header.
Http Header.
3gpp- Sbi-Discovery- target- nf-instance- idNCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHeaders beginning with the prefix 3gpp- Sbi- Discovery- are used in indirect communication mode for discovery and selection of a suitable producer by the SCP.
Such headers may be included in any SBITable 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1271Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING message and include information allowing an SCP to find a suitable producer as per the consumer' s included target- nf-instance- id.
This is a mandatory HTTP custom header.
Http Header.
3gpp- Sbi-Discovery- snssaisNCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGHeaders beginning with the prefix 3gpp- Sbi- Discovery- are used in indirect communication mode for discovery and selection of a suitable producer by the SCP.
Such headers may be included in any SBI message and include information allowing an SCP to find a suitable producer as per the consumer' s included snssais .
This is a mandatory HTTP custom header.
Http Header.
3gpp- Sbi-Discovery- target- nf-typeNCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGHeaders beginning with the prefix 3gpp- Sbi- Discovery- are used in indirect communication mode for discovery and selection of a suitable producer by the SCP.
Such headers may be included in any SBI message and include information allowing an SCP to find a suitable producer as per the consumer' s included target- nf-type .
This is a mandatory HTTP custom header.
Http Header.
3gpp- Sbi-Target- Nf-Id NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGThis header is used in a 307 Temporary Redirect or 308 Permanent Redirect response, to identify the target NF ( service) instance towards which the request is redirected.
This is a mandatory HTTP custom header.
Http Header.
3gpp- Sbi-Nrf- Uri NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGThis header may be used to indicate the NRF API URIs to be used for a given service request, e. g. in indirect communication with delegated discovery as a result of an NSSF query.
This is a mandatory HTTP custom header.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
3gpp- Sbi-Correlation- Info RESOURCE_ PRE_ SORTINGThis header is used to fetch the Site- Info for Site- Routing.
The value to be provided is the IMSI ( SUPI) , MSISDN( GPSI) , NAI, or External ID.
Note : Multiple values can be sent for 3gpp- Sbi-Correlation- Info.
The multiple values of 3gpp- Sbi-Correlation- Info are separated by a semi- colon delimiter.
NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONHttp Header.
User- Agent RESOURCE_ PRE_ SORTINGThe User- Agent header provides a mechanism for indicating the NF name to other servers where NCC is acting as the client in the message flow.
It also indicates the time of receiving the message, and the original client of the request.
If User- Agent is configured in RSV, then it is added as a http header in responses to Nchf_ Converged Charging , and Nchf_ Spending Limit Control .
Http Header.
3gpp- Sbi-Binding- Header NCHF_ CHARGING_ CALL_ ESTABLISHMENT This header is used to signal binding information related to an NF service resource to a futureTable 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1272Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGconsumer ( HTTP client) of that resource.
This is a mandatory HTTP custom headers.
GY_CREDIT_ REQUEST APPLICABILITY GY_POST_ PROCESSING RATING_ POST_ PROCESSING TARIFF THRESHOLD SLICING_ PROFILERSU- Unit- Type RESOURCE_ PRE_ SORTINGThis represents the type of RSU unit, which can be VOLUME, TIME, UNIT, or MONEY.
Kind- Of-Unit GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThis represents the type of unit for the call, which can be VOLUME, TIME, UNIT, or MONEY.
Reporting- Reason- In-Metrics RATING_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGThis attribute determines which reporting- reasons must be used to generate metrics.
If the request message does not include the specified reporting reason, the corresponding metric is not produced.
Report- Charged- Amount RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGThis attribute accepts amount, currency and tax percentage as input parameters, and reports them in the first free component of the rated Product Usage list in the API response.
Example: CALL_ RESULT.
Report- Charged- Amount ( "10.00000" , "EUR" , "22.00000" ) The action is called from RSV engine only in case the amount, currency and tax percentage to report in API response are determined internally through the mapping table.
By default the amount, currency and tax percentage to report in API response are taken directly from the rated Product Usage attributes.Table 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1273Charging User Guide Charging rules Attribute name Trigger Description In case the input attribute is an empty string, and the corresponding rated Product Usage is null, then it is not reported in the API response.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION THRESHOLD RATING_ POST_ PROCESSINGService- Parameter- Info RESOURCE_ PRE_ SORTINGThis can be used to pass the new destination number.
Trigger- Type RATING_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGThe Trigger- Type AVP indicates the events that can cause the credit control client to reauthorize the associated quota.
RATING_ POST_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATIONArm- Nchf- Trigger RESOURCE_ PRE_ SORTINGThis action is used to set the 5G trigger type, trigger category, and trigger level that can cause the credit control client to reauthorize the associated quota.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION THRESHOLD GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGAnnouncement- Information GY_PRE_ PROCESSINGThis action is used to set announcement AVP to the MSCC level.Table 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1274Charging User Guide Charging rules Attribute name Trigger Description UC_PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION GY_POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTING GY_PRE_ PROCESSINGAnnouncement- Variable- Part UC_PROCESSINGIt is used to set variable- part AVP in the announcement AVP.
IMS_ CALL_ ESTABLISHMENT SMS_ CALL_ ESTABLISHMENT MMS_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ ESTABLISHMENTEnable- Single- CDR RESOURCE_ PRE_ SORTINGIt is used to have a single CDR for the complete call.
It is not applicable for Gy session calls and SMS/ MMS ECUR ( I/U/T) calls.
It is only applicable for IMS calls ( I/ U/T).
NOTIFICATION.
SMPP- Source RATING_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGThis action accepts an MSISDN as input and replaces the value in SMS- Orig- Id attribute of the REST API Push Notification instance, which currently is hard- coded to the Mobile Source Number in SMPP server configuration.
Example: NOTIFICATION.
SMPP- Source ("<A-Number> ") where < A-Number> is the SMS sender.
NOTIFICATION.
SMPP- Destination RATING_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGThis action accepts an MSISDN as input and sets the value in new SMS- Dest- Id attribute of the REST API Push Notification instance.
Example:Table 88: CALL_RESULT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1275Charging User Guide Charging rules Attribute name Trigger Description NOTIFICATION.
SMPP- Destination ("<B-Number> ") where < B-Number> is the SMS recipient.
Policy- Counter Id-Mapping GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGProvides the name of complex map which is used to map the external policy counter ID with internal policy counter IDs.
It is preconfigured in the Rules and Variables with default value Policy Counter IdMap.
Resource- Trigger- Applicable RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGWhen RESOURCE_ POST_ PROCESSING is evaluated, this action would determine that resulted actions need to be executed during resource RESERVATION or during resource COMMIT.
Values of this action: •RESERVATION •COMMIT •RESERVE_ COMMIT SSI-In-CCA- Indicator IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION GY_POST_ PROCESSING THRESHOLD RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGThis attribute is used to set the language code in ISO- 639- 2 format to return in CCA message for announcement and which level of SSI AVPs to be present.
Options for SSI level is: •NONE, # Not Add SSI avp •MSCC_ LEVEL, # MSCC Level •IMS_ INFORMATION_ LEVEL, # IMS Information Level •BOTH, # both MSCC and IMS Information Level Trigger- Life- Cycle- Event IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION RESOURCE_ PRE_ SORTINGThis attribute is used to set the lifecyle event to be triggered after rule evaluation.Table 88: CALL_RESULT result context (continued) 4.9.5 DYNAMIC_SLICE result context Attribute name Trigger Description Slice- Size SLICING_ PROFILE Defines the slice size in bytes which is always greater than zero.
Input as a Long value.Table 89: DYNAMIC_SLICE result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1276Charging User Guide Charging rules Attribute name Trigger Description Quota- Holding- Time SLICING_ PROFILE Defines the quota holding time in seconds and controls the time the session remains in idle state in the network.
Input as a Long value.
Validity- Time SLICING_ PROFILE Defines the value of the validity time in seconds.
Input as a Long value.
Algo- Name SLICING_ PROFILE Defines the name of the algorithm that is configured such as BASIC_ ALGO, BUCKET_ ALGO, and DYNAMIC_ ALGO.
This can be entered as an ENUM value.
Select- Algo SLICING_ PROFILE Supports DYNAMIC_ ALGO_ 2 and contains the following parameters: •Algo- Name : Currently we support only DYNAMIC_ ALGO_ 2 which is case- insensitive.
•Min Slice : Min Slice is an optional parameter which indicates a minimum Slice size to be provided.
•Max Slice : Max Slice is an optional parameter which restricts the size of Slice from Algorithm if provided.
Supports a Max value up to 9223372036854775807 ( Max value of Long) for Max Slice Value.
Max- Number- Of-Devices- In-Group SLICING_ PROFILE Defines the maximum number of users for the group resource defined in the slicing profile rule.
Input as a Long value.
Slice- Allocation- Factor SLICING_ PROFILE Defines the value calculated on the delta between the current usage and threshold value.
Input as a Long value.
Min- Slice- Size SLICING_ PROFILE It is the minimum slice size defined for the quota management profile ( slicing profile) .
Input as a Long value.
Volume- Quota- Threshold SLICING_ PROFILE It is used when the Credit Control client seeks re-authorization from the server for the quota when the quota falls below the supplied threshold.
Threshold must be defined on quantity ( volume only) and it is reserved and granted in CCA.
Value of VQT can be configured in percentage ( %) or in fixed value.
Depending on the type of algorithm used, the Volume- Quota- Threshold parameter isTable 89: DYNAMIC_SLICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1277Charging User Guide Charging rules Attribute name Trigger Description calculated and sent back to the network in CCA message.
Input as a Long value.
Volume- Quota- Threshold- Algo SLICING_ PROFILE This action attribute is added to the quota management profile ( slicing profile) rule under Dynamic_ Slice and can have one of the following values: •FIXED_ ADD_ IN_GSU : When configured as FIXED_ ADD_ IN_GSU , then the Volume- Quota- Threshold parameter in quota management profile ( slicing profile) rule specifies the absolute value used to set AVP in CCA message sent back to the network.
It is added to the derived quota amount to determine the GSU value when GSU is not a final slice.
•PERCENTAGE : When configured as PERCENTAGE , the Volume- Quota- Threshold parameter value in quota management profile ( slicing profile) rule is configured in % and calculated on the granted volume quota sent in CCA message.
By default, the value of this action attribute is set as PERCENTAGE to achieve the existing slice reduction functionality.
This parameter is also defined per MSCC or rating group.
Depending on the type of algorithm used, the Volume- Quota- Threshold parameter is calculated and sent back to the network in CCA message.
MIN- TTC SLICING_ PROFILE Defines the minimum tariff time change value in seconds.
Input as a Long value.
Time- Quota- Threshold SLICING_ PROFILE This action returns percentage value of Time Quota Threshold AVP.
MIN- VT SLICING_ PROFILE Defines the minimum validity time in seconds.
Input as a Long value.Table 89: DYNAMIC_SLICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1278Charging User Guide Charging rules 4.9.6 GY_MESSAGE result context Attribute name Trigger Description GY_SESSION_ ESTABLISHMENTAdd- MSCC IMS_ CALL_ ESTABLISHMENTThis action is required to add the preemptive categories at Call Establishment, so that they can be used at charging Triggers.
GY_MESSAGE.
Add- MSCC (<MSCC- Type >, <List of strings> ) MSCC- Type : is an ENUM with the following values: Rating- Group_ ENUM or Service- Identifier_ ENUM (currently only Rating- Group is supported ) List of strings : is a list of strings, which will be used to add a new MSCC, with the Rating- Group information AVP filled with the given value.Table 90: GY_MESSAGE result context 4.9.7 GY_PRE_PROCESSING result context Attribute name Trigger Description Is-TTC- Enabled GY_PRE_ PROCESSING This action indicates whether the TTC is enabled or not.
Disable- Charging- CDR GY_PRE_ PROCESSING DEVICE_ NOT_ FOUNDThis action is used to disable dumping all the charging CDR.
Enable- Silent- TTC GY_PRE_ PROCESSING This action works only when the Is-TTC- Enabled is set to true .
When this action is used in RSV, and the TCC is enabled, NCC calculates the TCU.
If the Gateway sends the TCU, NCC does not calculate the TCU as the Gateway has higher priority.
APN- Charging- CDR GY_PRE_ PROCESSING Rule Attribute Name to set the APN in Gy Pre- Processing Rule for getting CDR Index Id from the CDR Mapping table.
Tariff- Time- Change GY_PRE_ PROCESSING This action indicates the TC value configured by user in rule that will be time of day.Table 91: GY_PRE_PROCESSING result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1279Charging User Guide Charging rules Attribute name Trigger Description Pre- Rating- Simulation- Enabled- For- CategoriesGY_PRE_ PROCESSING This action enables pre- rating simulation.
If this result context is configured and has some values, the pre- rating simulation is done before tariff processing.
After tariff processing is done, the result context can be used in applicability or tariff rules.
Single- CDR- For-TTC- Enabled GY_PRE_ PROCESSING This action indicates whether a single CDR for TTC- enabled feature is enabled or not for Gy calls.
Tariff- Time- Change- Multiple GY_PRE_ PROCESSING This result context can be used to configure the multiple tariff change time points.
Trigger- Life- Cycle- Event GY_PRE_ PROCESSING The value of this attribute can be set to a custom string based on the type of traffic ( service context) received.
Rate- Rounding Factor GY_PRE_ PROCESSING This action provides a rounding mechanism to charge the calls with a configurable rate rounding factor at Global ( RSV) or Tariff Rate level.
Cost rounding is applicable only for monetary resources ( that is, main balance and money buckets) .
This rounding mechanism is over and above the existing NCC rounding mechanisms for calculation precision and DB precision ( defined in the application preferences Calculation Precision and DB_PRECISION ).
Note : It is recommended to apply it only in one of the trigger points ( Tariff, Gy_ Pre_ Processing, or Gy_ Credit_ Request) .
Valid- Call- Correlation GY_PRE_ PROCESSING This action marks leg1 of a voice mail call as eligible for correlation.
Establish- Correlation GY_PRE_ PROCESSING This action establishes correlation between IMS sessions and triggers correlated charging.
Enable- Silent- TTC GY_PRE_ PROCESSING This action enables the silent TTC.
Override- Overage- Limit GY_PRE_ PROCESSING This attribute overrides the overage limit.Table 91: GY_PRE_PROCESSING result context (continued) Note : A service operator can also configure the Tariff-Time-Change , which is an optional parameter and the time is specified in hour:min:sec for the 24 hour format.
Rule example for Tariff-Time-Change-Multiple result context: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1280Charging User Guide Charging rules Figure 57: TTC rule Overriding overage limit The Override-Overage-Limit attribute in the GY_PRE_PROCESSING trigger is used to override the overage limit of the account.
The change is temporal (applicable only for a particular processed CCR), and it is not saved into the database.
For example: If the Override- Overage- Limit is..Then Result 0 The overage limit remains 0.
The existing overage limit is overridden.
-5 The new overage limit is -5.
The existing overage limit is overridden.
9999999999 The overage limit is overridden to unlimited overage limit.The existing overage limit is overridden.
null Overriding is not applicable.
The existing overage limit is considered.Table 92: Overriding overage limit Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1281Charging User Guide Charging rules 4.9.8 GY_POST_PROCESSING result context Attribute name Trigger Description Stop- Publish- CDR- To-UR GY_POST_ PROCESSING Stop- Publish- CDR- To-UR action is configured to stop publishing CDR to UR.
This action is applicable only in online ME when Rerate/ EOC ME configured.
Rule- Post- Value GY_POST_ PROCESSING This attribute is designed for internal debugging purpose.Table 93: GY_POST_PROCESSING result context 4.9.9 LOAN_RESUL T result context Attribute name Trigger Description Loan- Id LOAN_ PRE_ PROCESSING Indicates the ID of the loan.
LOAN_ PRE_ PROCESSING Reject- Loan LOAN_ POST_ PROCESSINGWhen this action is configured, the Opt- In request is rejected based on the Class OfService custom data of the device.
This action has two optional parameters which are as follows: •Error Code •Error- Description If the parameters are not configured, then the default error code ( 500) and default error description ( "Loan is rejected as per configuration by customer" ) are sent in the response.Table 94: LOAN result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1282Charging User Guide Charging rules 4.9.
10 NOTIFICATION result context Attribute name Trigger Description Cancel- Counter- Update- Attempt COUNTER This action cancels the update attempt on counter.
Disable- Lifecycle- Notification- EDR LIFECYCLE_ PROFILE This flag is used to disable the EDR generation for Send Notification Action in the lifecycle framework.
Disable- User- Configuration LIFECYCLE_ PROFILE If this flag is configured, then the rule configuration determining whether a user in Send- Notification action is by- passed and notifications are processed without user identification.
Ignore- Notification THRESHOLD This action ignores the notification.
IMS_ CALL_ ESTABLISHMENT GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SNA_ MANAGEMENT THRESHOLD LIFECYCLE_ PROFILE PRE_ VALIDATION PRE_ RECHARGE POST_ RECHARGE POST_ BONUS COUNTER POLICY_ COUNTER_ STATUS_ CHANGE LOAN_ POST_ PROCESSINGSend- Notification LOAN_ PRE_ PROCESSINGThis action is used to send a notification when you intend to notify subscribers about a specific event.Table 95: NOTIFICATION result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1283Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING UC_PROCESSING Notification- Continue THRESHOLD This action is used to send a notification and continue using the resource.
Selected- Device THRESHOLD This action is used to send notification to associated entities.
EXHAUSTION THRESHOLD This action can be used to change the state of subscription.
Notification- Stop THRESHOLD This action is used to send a notification and stop using the resource and then shift to next resource if any.
Notification- Reject THRESHOLD This action is used to send a notification and reject the call.
Trigger- Life- Cycle- Event THRESHOLD SUBSCRIBER_ POST_ PROVISIONINGThis action triggers the lifecycle event present in #Event Name# on the # Trigger LifeCycle Entity Type# , that is, ACCOUNT, DEVICE, SUBSCRIPTION, GROUP, and USER.
Reject THRESHOLD This action is used to reject the call.
SMPP- Source RATING_ POST_ PROCESSING This attribute provides the number of the SMS sender.
SMPP- Destination RATING_ POST_ PROCESSING This attribute provides the number of the SMS recipient.
IMS_ CALL_ ESTABLISHMENT Send- RAR THRESHOLDThis notification is used to send the RAR.
The value should be Send RAR, that is, NOTIFICATION.
Send- RAR = Send RAR.
IMS_ CALL_ ESTABLISHMENT THRESHOLD GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGNotification- Variable SNA_ MANAGEMENTThis attribute is disabled by default but can be enabled using a rule.
For any notification variable in a template, reports the notification content as variables and value pairs.
You can use the notification variables available and custom notification variables that you add, to return specific information in your message.
For example, you can use the Notification Variables: Subscriber- User- Id and 3GPP- User- Location- Info along with a custom Notification Variable that you have defined ( in this example, Customized- Date( 2)) to return the Subscriber- User- Id and location information with theTable 95: NOTIFICATION result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1284Charging User Guide Charging rules Attribute name Trigger Description COUNTER POLICY_ COUNTER_ STATUS_ CHANGE LOAN_ POST_ PROCESSING LOAN_ PRE_ PROCESSING GY_PRE_ PROCESSING UC_PROCESSINGcurrent system time in the format YYYY- MM- DD.
Custom Notification Variables must be added to the charging Rule Attribute Dictionary before you can use them.
The following lists default notification variables used: •3GPP- RAT- Type •3GPP- User- Location- Info •Current- Date- Time- String •Policy- Counter- Identifier •Policy- Counter- Status •Service- Parameter- Name •Service- Parameter- Value THRESHOLD Disable- Charging- Notification- CDR RATING_ POST_ PROCESSINGNo CDR is generated for notification.Table 95: NOTIFICATION result context (continued) 4.9.
11 RATING result context Attribute name Trigger Description Add- Cost- Information- to-CCA RATING_ POST_ PROCESSING This attribute is implemented in the following way: •If the cost- information is to be provided for a CCR- I (initial) , CCR- U (update) , or CCR- E (event) type of transaction, then the cost- info value is a function of Requested- Service- Init and associated rate, that is f(RSU, rate) irrespective of the result of the CCR.
•If the cost- information is to be provided for a CCR- T type of transaction, then cost- info value is a function of Used- Service- Init , that is f (USU) irresepctive of the result of CCR.
Adjust- Bucket SUBSCRIBER_ PRE_ PROVISIONING This attribute is used to allow the modification of bucket values.
the following inputs are required to modify the value: •Bucket Name - Data type and associated format for bucket value will be same as for Allowance Limit •Bucket Value - Data type and associated format for bucket value will be same as for Allowance LimitTable 96: RATING result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1285Charging User Guide Charging rules Attribute name Trigger Description •Adjust Mode - Need to provide type of operation on the values INCR, DECR, SET Apply- Selective- Wholesale RESOURCE_ POST_ PROCESSING This attribute will be used to apply the default rates if wholesale rates are not available.
Rates will be supplied as an argument to it.
Both of the arguments are optional for this function.
Definition: RATING.
Apply- Selective- Wholesale ( CALL_ COMMON.
Pre- Rating- Simulation- Rate, CALL_ COMMON.
Pre- Rating- Simulation- Next- Rate ) Example: RATING.
Apply- Selective- Wholesale ( CALL_ COMMON.
Pre- Rating- Simulation- Rate, CALL_ COMMON.
Pre- Rating- Simulation- Next- Rate) RATING.
Apply- Selective- Wholesale ( <rate ID>,<next Rate Id>) RATING.
Apply- Selective- Wholesale ( <rate ID>, ) RATING.
Apply- Selective- Wholesale ( , ) Logic for ' Apply- Selective- Wholesale' action: If configured in RSV RESOURCE_ POST_ PROCESSING then this action will do the following: - If wholesale rates are found in Wholesale rating simulation then this action will calculate wholesale cost and wholesale tax information using wholesale rates selected in wholesale simulation( stored in CALL_ COMMON source context variables) and will dump them into ' wholesale Cost' and ' wholesale Tax' tags into CDRs.
NCC needs to convert charged cost/ time/ volume/ item into cost in order to fill into " wholesale Cost" tag. "
wholesale Tax" should only be applied if taxation is configured.
If wholesale rates are not found in wholesale rating simulation then this action will calculate wholesale cost and wholesale tax using default rates supplied as part of argument and will dump them into ' wholesale Cost' and 'wholesale Tax' tags into CDRs.
NCC needs to convert charged cost/ time/ volume/ item into cost in order to fill into " wholesale Cost" tag. "
wholesale Tax" should only be applied if taxation is configured.
APPLICABILITY Bucket- Granularity- Selection TARIFFThis action applies only the step- size of the Rate ID defined in action with volume or time bucket.
APPLICABILITY Rate TARIFFRate is an action attribute info name defined within the RATING result context.
It signifies the output tariff rule as rate.
It is always applied to the monetary resource that is, bucket of monetary type or account balance) .
Input a Rate_ STRING or Target_ STRING.
The Target_ STRING is a text string to be parsed.
Rate- External- Cost TARIFF This action can be applied to an allowance plan with a monetary type of bucket.
Rate- Reject TARIFF This action provides details about Rate Reject.Table 96: RATING result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1286Charging User Guide Charging rules Attribute name Trigger Description APPLICABILITY APPLICABILITY Bucket- Selection TARIFFname defined within the RATING result context.
It signifies the output of tariff rule as bucket.
Bucket should be non- monetary only.
For monetary buckets, RATING.
Rate is used.
Input a bucket name as a data string.
Bucket- Step- Override TARIFF The Bucket- Step- Override rule contains the following attributes: •Step- Number : Indicates the current step to be overridden for step fee and step- size.
•Step- Fee: Indicates the step fee to be applied for charging the step override rule.
•Step- Size : Indicates the step size to be applied for charging the step override rule.
APPLICABILITY Counter- Selection TARIFFThis is an action attribute info name defined within the RATING result context.
It signifies the output of tariff rule as Counter.
It can have accumulation of usage/ cost.
Input a counter name as a data list string.
Call- Discount TARIFF Call- Discount action includes the discount applicable for the call.
It is available for TARIFF ruleset.
The discount can be applied for the following if the priority order of bundle is equal to or less than the bundle in which the discount is configured: •Discount on Rate configured with Main Balance, Money- Bucket and Cost- bucket.
•Discount on step- fee.
•Discount on Rate' s connection cost.
delete GSUAVP RATING_ POST_ PROCESSING This action deletes the gsu avp from Mscc in CCA.
TARIFF RESOURCE_ POST_ PROCESSINGGet- Tax- Id-from- Rate APPLICABILITYThis attribute is used to fetch the taxation defined in the applied rate is fetched.
If the taxation reference is provided in the charging logic tariff rule using Get- Tax- Id-from- Rate attribute, then the taxation defined in the applied rate is fetched.
THRESHOLD RATING_ POST_ PROCESSINGGSU- Value GY_CREDIT_ REQUESTThis is to set GSU Value from RSV.
Rate- Rounding Factor GY_CREDIT_ REQUEST TARIFFThis action provides a rounding mechanism to charge the calls with a configurable rate rounding factor at Global ( RSV) or Tariff Rate level.
Cost rounding is applicable only for monetary resources ( that is, main balance and money buckets) .
This rounding mechanism is over and aboveTable 96: RATING result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1287Charging User Guide Charging rules Attribute name Trigger Description the existing NCC rounding mechanisms for calculation precision and DB precision ( defined in the application preferences Calculation Precision and DB_PRECISION ).
Note : It is recommended to apply it only in one of the trigger points ( Tariff, Gy_ Pre_ Processing, or Gy_ Credit_ Request) .
return Result Code RATING_ POST_ PROCESSING This action sets the result code for an Mscc.
APPLICABILITY Tax- Selection TARIFFThe taxation can be attached or detached to a bundle or an account to implement the tax.
The taxation profile entity includes multiple percentage tax rates and applicability condition.
If the taxation reference is not provided in the charging service tariff rule, then the taxation does not apply.
Taxation- Applicable APPLICABILITY This parameter indicates a rule condition expression evaluated to determine whether the taxation is applicable.
The default applicability condition for taxation is true.
APPLICABILITY RATING_ POST_ PROCESSINGCharging- Service- Applicable TARIFFThis is an action attribute info name defined within the RATING result context.
It signifies whether the charging service configured for different conditions is evaluated and results in True or False accordingly.
No input required.
APPLICABILITY No-Charge TARIFFThis is an action attribute info name defined within the RATING result context.
It signifies the output of the tariff rule in case of free calling.
No input required.
Next- Rate TARIFF Contains the value of secondary rate.
THRESHOLD RATING_ POST_ PROCESSING IMS_ CALL_ ESTABLISHMENTFinal- Unit- Action- Redirect GY_CREDIT_ REQUESTOnce the rules are evaluated and FUI/ FUA is got in result, FUI/ FUA object is created and set to the corresponding MSCC.
It contains three parameters for redirect: ( Redirect Server Address_ STRING , Validity Time_ LONG , and Redirect Address Type_ ENUM ).
Redirect Address Type: IPV4 IPV6 URL SIP_ URI GY_CREDIT_ REQUEST RATING_ POST_ PROCESSING THRESHOLDFinal- Unit- Action- Restrict- Access UC_PROCESSINGThis is the final unit action avp with Restrict Access action.Table 96: RATING result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1288Charging User Guide Charging rules Attribute name Trigger Description Final- Unit- Indication- Filter- Id THRESHOLD RATING_ POST_ PROCESSING GY_CREDIT_ REQUEST UC_PROCESSINGThis is the final unit action avp with FUI- Filter- Id.
THRESHOLD RATING_ POST_ PROCESSINGFinal- Unit- Action- Terminate GY_CREDIT_ REQUESTOnce the rules are evaluated and FUI/ FUA is got in result, FUI/ FUA object is created and set to the corresponding MSCC with action as terminate.
It is without parameter for final unit action.
THRESHOLD RATING_ POST_ PROCESSING GY_CREDIT_ REQUESTFinal- Unit- Indication- Restriction- Filter- Rule UC_PROCESSINGThis is the final unit action avp with FUI- Restriction- Filter- Rule.
Note : For 5G requests, Final- Unit- Indication- Restriction- Filter- Rule AVP with post- deny as input, is not supported.
For final unit indication, use RATING.
Final- Unit- Indication- Filter- Id AVP ( for both 4G/ 5G) instead.
APPLICABILITY Counter- Applicable UC_PROCESSINGThis is an action attribute defined within the RATING result context, signifies whether the counter is applicable or not.
Is-Rsu- Zero- Allowed RATING_ POST_ PROCESSING This action indicates whether an RSU with zero value is allowed or not.
If an RSU is sent as zero in the request, then the rating logic does not remove the session from the database and allows the call to continue.
Next- Bucket- Selection TARIFF Name defined within the RATING result context.
It signifies the output of tariff rule as bucket.
Bucket should be non- monetary only.
This is used to select secondary tariff output only.
For monetary buckets, RATING.
Next- Rate is used.
Input a bucket name as a data string.
Next- Bucket- Granularity- SelectionTARIFF APPLICABILITYThis action applies only the step- size of the Rate ID defined in action with volume or time bucket.
This is used to select secondary tariff output only.
Select- Counter- Usage COUNTER This action provides the ability to configure, at usage type level, the usage type ( primary or secondary) to be counted in spending limit.
The following options are available for this action: •PRIMARY: ( that is, Counter Usage Type_ PRIMARY) •SECONDARY: ( that is, Counter Usage Type_ SECONDARY) If this action is not used, then both primary and secondary usage are counted for the counter by default.
Threshold- Rate TARIFF This action indicates the output tariff rule as threshold rate.
If the related counter threshold is crossed, the threshold rate can be applied to the monetary resource, that is, bucket of monetary type or account balance.Table 96: RATING result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1289Charging User Guide Charging rules Attribute name Trigger Description Input a Rate_ STRING, Counter Id_STRING, Crossed Threshold_ STRING and Target_ STRING.
The Target_ STRING is an optional text string to be parsed.
If it is not filled, then resource gets selected based on charging service' s available resource ( example, monetary bucket → main balance) .
Threshold- Next- Rate TARIFF This action indicates the output tariff rule as threshold next rate.
If the related counter threshold is crossed, the threshold next rate can be applied as secondary rate to the monetary resource, that is, bucket of monetary type or account balance.
Input a Rate_ STRING, Counter Id_STRING, Crossed Threshold_ STRING and Target_ STRING.
The Target_ STRING is an optional text string to be parsed.
If it is not filled, then resource gets selected based on charging service' s available resource ( example, monetary bucket → main balance) .
Trigger- BOU- Activation TARIFF This actions triggers the bundle activation rules for a specified BOU bundle.
It has two mandatory parameters which are as follows: •Bundle_ Name_ STRING : This argument can take the following values: –Bundle_ Name : Bundle name can be passed as a string argument.
It indicates the name of the BOU bundle for which BOU activation rules should be triggered.
–CALL_ COMMON.
Pre- Rating- Simulation- Bundle : If this argument is passed, then BOU activation rules are triggered for the bundle that is selected in the pre- rating simulation.
Note : Pre- Rating- Simulation- Bundle attribute indicates the bundle name for the highest priority applicable charging logic selected in the pre- rating- simulation.
•Charging Logic Selection_ ENUM : This argument can take the following values: –Stop : If BOU reservation fails, then NCC stops using the current charging logic and moves to the next applicable charging logic, if any.
–Reject : If BOU reservation fails, then call is rejected immediately –Continue : If BOU reservation fails, rest of the tariff rules are evaluated using the same charging logic.
For example: •RATING.
Trigger- BOU- Activation( "CALL_ COMMON.
Pre- Rating- Simulation- Bundle" , "Stop" ) •RATING.
Trigger- BOU- Activation( "VF_BOU_ 01", "Continue" ) Note : For more details on configuring Trigger- BOU- Activation action, see BOU activation enhancements on page 1815 UC-Service- Applicable APPLICABILITY This action indicates the applicability of UCService Instance.
Usage- Discount THRESHOLD This action allows to apply percentage discount on the rate used for the call.Table 96: RATING result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1290Charging User Guide Charging rules Attribute name Trigger Description UC-Limit- Applicable APPLICABILITY This action indicates the applicability of UCLimit object.
VQT- Value RATING_ POST_ PROCESSING This action is used to calculate the VQT value for volume based data call.
You can set or modify the value of VQT to be 100% of granted units only when the granted units are less than the minimum slice.
This enables consumption of all the available units till the configured threshold, hence reducing the number of requests with very low USU/ GSU.
APPLICABILITY Wholesale- Rate TARIFFThis attribute will be used to apply Wholesale Rate which is supplied as an argument to it.
Definition: RATING.
Wholesale- Rate= Rate_ STRING Example: RATING.
Wholesale- Rate = rate Id OR RATING.
Wholesale- Rate = CALL_ COMMON.
Wholesale- Rate APPLICABILITY Wholesale- Next- Rate TARIFFThis attribute will be used to apply Wholesale Next- Rate which is supplied as an argument to it.
Definition: RATING.
Wholesale- Next- Rate = Rate_ STRING Example: RATING.
Wholesale- Next- Rate = rate Id OR RATING.
Wholesale- Next- Rate = CALL_ COMMON.
Wholesale- Next- RateTable 96: RATING result context (continued) 4.9.
12 RESOURCE_POST_PROCESSING result context Attribute name Trigger Description Trigger- Life- Cycle- Event RESOURCE_ POST_ PROCESSING The value of attribute can be set to a custom string based on the type of traffic ( service context) received.Table 97: RESOURCE_POST_PROCESSING result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1291Charging User Guide Charging rules 4.9.
13 RULE_TABLE result context Attribute name Trigger Description Rule- Table ALL A reference to an existing child rule table.
You can have multiple instances of the DSC.
Rule-Table action in the same rule, which allows you to configure the rule table as the parent rule table from which, depending on the conditions met, the actions of existing child rule tables are executed.
When the parent runs and the criteria are met, all of the child rule tables are evaluated, and their results are merged using the following criteria: •If an action is only returned by one of the rule tables, use the value.
•If an action is returned by more than one rule table, and the action can have multiple values, combine all of the values into a single collection of values and use the result.
•If an action is returned by more than one rule table, and the action can only have one value, the first value returned for this action is used.
Note that since actions are not provisioned in a set order, this order may not be consistent.
After all of the actions have been collected using the above criteria, they are all applied as if those same actions were provisioned in the rule.
During this step, the previous merging strategy is used, so if an action already has a value the new value is ignored.
This may also produce inconsistent results since there is no way to guarantee the order in which actions in a rule are applied.Table 98: RULE_TABLE result context 4.9.
14 SESSION_PARAMETERS result context Attribute name Trigger Description Add- Custom Field- In-Session IMS_ CALL_ ESTABLISHMENT This action defines value for the following sets to be stored in DB.Table 99: SESSION_PARAMETERS result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1292Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION GY_PRE_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION TARIFF RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING RESOURCE_ PRE_ SORTING("Key_STRING", Value_BASE, Custom FieldLevel_ENUM, SaveValueOf Resource_ENUM) where: •Key_ STRING is the name of the parameter that is saved in the session.
•Value_ BASE is the value of the parameter that is saved in the session.
•Custom Field Level_ ENUM can have the values ROOT or RG.
•Save Value OfResource_ ENUM can have the values FIRST or LAST.
This variable indicates the resource for which data is stored in the session.
For example, if reservation is done from two logics (charging services) and the value is configured as FIRST, then the data of the first logic is stored in the Custom Field of the logic.
Note : Save Value OfResources_ ENUM is applicable only for RESOURCE_ POST_ PROCESSING trigger.
If it is added to other triggers, then it is not considered.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION APPLICABILITY TARIFFCall- Roaming- Status THRESHOLDThis action is used to set the value of roaming status based on the condition criteria.Table 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1293Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION GY_CREDIT_ REQUEST GY_PRE_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ MODIFICATION NCHF_ CHARGING_ CALL_ TERMINATION RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION APPLICABILITY TARIFF THRESHOLD SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION GY_PRE_ PROCESSING NCHF_ CHARGING_ CALL_ ESTABLISHMENTCall- Sub- Type NCHF_ CHARGING_ CALL_ MODIFICATIONType of call value to be set in action.Table 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1294Charging User Guide Charging rules Attribute name Trigger Description NCHF_ CHARGING_ CALL_ TERMINATION UC_PROCESSING RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION APPLICABILITY TARIFF THRESHOLD GY_PRE_ PROCESSING SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION UC_PROCESSINGCalled- Party RESOURCE_ PRE_ SORTINGIt is the first entry of Service- Information/ IMS- Information/ Called- Party- Address.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENTCalled- Party- Country MMS_ CALL_ TERMINATIONA string that contains information about called party country name.Table 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1295Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD UC_PROCESSING RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATIONCalled- Party- Type RESOURCE_ PRE_ SORTINGEnum to recognize the Called- Party Type.
email address MSISDN IPv4 Address IPv6 Address Numeric Shortcode Alphanumeric Shortcode Other IMSI IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION GY_PRE_ PROCESSINGCalling- Party APPLICABILITYIt is the first entry of Service- Information/ IMS- Information/ Calling- Party- Address.Table 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1296Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION UC_PROCESSING RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLD SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATIONCalling- Party- Type RESOURCE_ PRE_ SORTINGEnum to recognize the Calling- Party Type.
email address MSISDN IPv4 Address IPv6 Address Numeric Shortcode Alphanumeric Shortcode Other IMSI Ecom_ Partial_ Reject GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGThis action allows to reject the CCAI if sufficient credit is not available.
Inbound- Roaming- Agreement GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThis action determines whether the roaming agreement for the incoming inbound- roamer request is valid or not.
If true, then the incoming inbound- roamer request isTable 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1297Charging User Guide Charging rules Attribute name Trigger Description processed, and SUCCESS message is returned after generating CDRs for it.
If false or null, then the inbound subscriber request is barred.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION GY_PRE_ PROCESSING APPLICABILITY TARIFF THRESHOLDIs-OnNet RESOURCE_ PRE_ SORTINGChecks whether the called and calling party are on Net or Offnet and respectively returns a Boolean value.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION APPLICABILITY TARIFF THRESHOLD GY_CREDIT_ REQUESTMCC RESOURCE_ PRE_ SORTINGMobile Country Code used to identify user location.
IMS_ CALL_ ESTABLISHMENT MCCMNC IMS_ CALL_ MODIFICATIONConcatenated string of MCC and MNC.Table 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1298Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ TERMINATION APPLICABILITY TARIFF THRESHOLD SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION DEVICE_ NOT_ FOUND GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION APPLICABILITY TARIFF THRESHOLD GY_CREDIT_ REQUESTMNC RESOURCE_ PRE_ SORTINGMobile Network Code used to identify user location.
Persist- IMS- Session RATING_ POST_ PROCESSING RESOURCE_ PRE_ SORTINGFor IMS call ( CCR- I or CCR- U message) , when this action is set to true , even if the categories fail and need to be cleared, the IMS session still remains alive and root level result code is set to 2001.
The session is cleared either when CCR- T is received or by session audit logic.Table 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1299Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION APPLICABILITY TARIFF THRESHOLD SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATIONRAT- TYPE RESOURCE_ PRE_ SORTINGEnum used to identify the radio access technology that is serving the UE.
Valid values are: WLAN, UTRAN, GERAN, GAN, HSPA_ EVOLUTION, EUTRAN, CDMA2000_ 1X, HRPD, UMB, EHRPD, VIRTUAL, EUTRAN_ NB_IoT, NR, NG_ RAN SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION MMS_ CALL_ ESTABLISHMENT MMS_ CALL_ TERMINATION GY_CREDIT_ REQUEST GY_PRE_ PROCESSING GY_POST_ PROCESSINGRouting- Number RESOURCE_ PRE_ SORTINGThis action fetches the routing number.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONReject- Call IMS_ CALL_ TERMINATIONThis action is used to configure early rejection of the call.
Usage: SESSION_PARAMETERS.Reject-Call ( " ResultCode_LONG", "CommandResult Code_LONG" ) where, Result Code_ LONG is the diameter result code at rating group level and CommandTable 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1300Charging User Guide Charging rules Attribute name Trigger Description SMS_ CALL_ ESTABLISHMENT SMS_ CALL_ TERMINATION GY_CREDIT_ REQUEST DEVICE_ NOT_ FOUND RESOURCE_ PRE_ SORTINGResult Code_ LONG is the diameter result code at root level.
Note : The data type for Reject- Call parameters have been changed from ( "Result Code_ STRING" , "Command Result Code_ STRING" ) to ( Result Code_ LONG, Command Result Code_ LONG) in NCC release 21.
3.
GY_PRE_ PROCESSING Return- Result- Cause UC_PROCESSINGThis action is used to return with specific result cause and terminate the call.
IMS_ CALL_ ESTABLISHMENT SMS_ CALL_ ESTABLISHMENT MMS_ CALL_ ESTABLISHMENT UC_PROCESSING GY_POST_ PROCESSING DEVICE_ NOT_ FOUNDReturn- Result- Code RESOURCE_ PRE_ SORTINGUsed to set the result code at the root level.
GY_SESSION_ ESTABLISHMENT IMS_ CALL_ ESTABLISHMENT MMS_ CALL_ ESTABLISHMENT SMS_ CALL_ ESTABLISHMENT NCHF_ CHARGING_ CALL_ ESTABLISHMENT GY_PRE_ PROCESSINGSession- Virtual- Counters RESOURCE_ PRE_ SORTINGUsed to get counter names from Rule Sets when session is established.
Example: SESSION_PARAMETERS.Session-Virtual- Counters = [“C1”, “C2”] In this example, the IMS session has two session virtual counters.
GY_PRE_ PROCESSING Surcharge- Time- Cap- Rate IMS_ CALL_ ESTABLISHMENTUsed to configure surcharge rate of type time for split charging.
The input is of string type, which should be a rate name ( of rate entity) and should already be defined.Table 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1301Charging User Guide Charging rules Attribute name Trigger Description IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION RESOURCE_ PRE_ SORTING Surcharge- Volume- Cap- Rate GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGUsed to configure surcharge rate of type volume for split charging feature.
The input is of string type, which should be a rate name ( of rate entity) and should already be defined.
GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATIONSurcharge- Unit- Cap- Rate RESOURCE_ PRE_ SORTINGUsed to configure surcharge rate of type unit for split charging feature.
The input is of string type, which should be a rate name ( of rate entity) and should already be defined.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATION IMS_ CALL_ TERMINATION APPLICABILITY TARIFF THRESHOLDSDP- Media- Component.
SDP- Media- Name RESOURCE_ PRE_ SORTINGSDP- Media- Name AVP contains information about Media type.
UC-Applicable GY_PRE_ PROCESSING RESOURCE_ PRE_ SORTINGThis action indicates whether the UC checks are done or not.
If the action in SESSION_ PAREMETERS.
UC-Applicable= Boolean Enum_ FALSE, then the UC checks are skipped.
Otherwise, they are applied in non- emergency scenarios.
Offline- Rating- Group GY_CREDIT_ REQUEST RESOURCE_ PRE_ SORTINGThis action takes multiple comma separated values.Table 99: SESSION_PARAMETERS result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1302Charging User Guide Charging rules 4.9.
15 SPR_ACCOUNT result context Attribute Trigger Description Add- Threshold_ Profile- Group- Id SUBSCRIBER_ PRE_ PROVISIONING This attribute adds the TPG to Account Entity.
adjust- Amount SUBSCRIBER_ PRE_ PROVISIONING This action credits the account balance using the specified payment method.
Custom- Data- Add LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONINGThis action is used to attach the Custom data which is already defined in the system to device.
If this Custom Data already exists in the device, then service updates the value of Custom Data in the device.
Custom- Data- Add- Immediate LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONINGThis action is used to attach the custom Data which is already defined in the system to device.
If this Custom Data already exists in the device, then service updates the value of Custom Data in the device.
The result of this action is immediately available for subsequent rule processing.
Custom- Data- Update LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONINGThis action is used to update a custom data of a device.
Custom- Data- Remove LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSINGThis action is used to remove a custom data of a device.Table 100: SPR_ACCOUNT result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1303Charging User Guide Charging rules Attribute Trigger Description RATING_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONING Custom- Data- Remove- ImmediateLOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RATING_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONINGThis action is used to remove a custom data of a device.
Entity- LifeCycle_ Name SUBSCRIBER_ PRE_ PROVISIONING This attribute provides the entity life cycle name.
Definition : SPR_ACCOUNT.Entity- LifeCycle_Name= "Value_ STRING" Entity- LifeCycle_ State SUBSCRIBER_ PRE_ PROVISIONING This attribute provides the entity life cycle state of the account.
Definition : SPR_ACCOUNT.Entity- LifeCycle_State="Value_ STRING" Example: SPR_ACCOUNT.
Entity-LifeCycle_State= "VF_ACTIVE1" If used as defined it will set the Entity Lifecycle state of Account as VF_ACTIVE1 .
Remove- Threshold_ Profile- Group- IdSUBSCRIBER_ PRE_ PROVISIONING This attribute removes the TPG to Account Entity.
Definition :Table 100: SPR_ACCOUNT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1304Charging User Guide Charging rules Attribute Trigger Description SPR_ACCOUNT.Remove- Threshold_Profile-Group- Id = "Value_STRING" Example: SPR_ACCOUNT.
Remove-Threshold_ Profile-Group-Id = " Value_STRING" - it will remove the specific TPG.
SPR_ACCOUNT.Remove- Threshold_Profile-Group- Id = "ALL" - it will remove all the TPGs.
Periodic- LifeCycle_ Name SUBSCRIBER_ PRE_ PROVISIONING This attribute provides the period life cycle name.
Definition : SPR_ACCOUNT.
Periodic-LifeCycle_Name= "Value_STRING" Example: SPR_ACCOUNT.
Periodic-LifeCycle_Name= "Prepid_APLC_01" If used as defined it will set the Period Lifecycle of Account to Prepid_ APLC_ 01.
Periodic- LifeCycle_ State SUBSCRIBER_ PRE_ PROVISIONING This attribute provides the periodic life cycle state of the account.
Definition : SPR_ACCOUNT.
Periodic-LifeCycle_ State="Value_STRING" Example: SPR_ACCOUNT.
Periodic-LifeCycle_ State= "SUSPENDED" If used as defined it will set the Period Lifecycle state of Account as SUSPENDED .Table 100: SPR_ACCOUNT result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1305Charging User Guide Charging rules 4.9.
16 SPR_DEVICE result context Attribute name Trigger Description Add- Bundle SUBSCRIBER_ PRE_ PROVISIONING RESOURCE_ PRE_ SORTINGThis action provides the bundle name to be added.
The bundle name provided in the action is used to create a new subscription.
Definition : SPR_DEVICE.Add-Bundle = "Bundle Name_STRING" .
Auto- Manage- Sync RESOURCE_ PRE_ SORTING This action is used to synchronize the input bundle list with the device profile.
It takes the following input parameters: •Bundle List: It is a mandatory input.
It is a string in which bundle names are separated with a semi- colon.
•Account Id: It is an optional input.
Note the following important points about this parameter: •Auto- Manage bundle obtained in the input list which is not attached to the device is subscribed to the device.
•Auto- Manage bundle which is attached to the device but not present in the list is unsubscribed.
•If Account Id is provided, then it is used to deduct bundle fee for the subscription.
Else, the account linked to the first subscription of the device is used to deduct bundle fee.
Note : •If Account Id is not configured and there is no subscription attached to the device before this action is executed, then auto synchronization is not applicable.
•If a subscription fails, then the next auto- manage bundle in the list is processed.
•Account from the group subscriptions is not supported.Table 101: SPR_DEVICE result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1306Charging User Guide Charging rules Attribute name Trigger Description •If Account Id is configured in rule but does not exist, and a subscription is attached to the device, then Auto- Manage- Sync action becomes invalid as switching to another account is not supported.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGAllow- Overage SUBSCRIBER_ PRE_ PROVISIONINGFlag indicating if overage is enabled.
The type is Boolean.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDCategory- List RESOURCE_ PRE_ SORTINGList to specify Category Order traversal specified by Device.
The type is list of string.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTINGCounter- Ids SUBSCRIBER_ PRE_ PROVISIONINGThe Counter Ids directly associated to this device without subscription.
The type is list of string.
Creation- Time RATING_ POST_ PROCESSING The time ( epoch) when this device was created.
The type is Long.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1307Charging User Guide Charging rules Attribute name Trigger Description TARIFF RESOURCE_ POST_ PROCESSING LIFECYCLE_ PROFILE THRESHOLD RESOURCE_ PRE_ SORTING GY_POST_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING SNA_ MANAGEMENT SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION TARIFF LIFECYCLE_ PROFILE THRESHOLD LOAN_ POST_ PROCESSING LOAN_ PRE_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGCustom- Data- Add SUBSCRIBER_ PRE_ PROVISIONINGThis action is used to attach the Custom data which is already defined in the system to device.
If this Custom Data already existed in the device, the service updates the value of Custom Data in the device.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1308Charging User Guide Charging rules Attribute name Trigger Description RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LIFECYCLE_ PROFILE THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGCustom- Data- Add- Immediate SUBSCRIBER_ PRE_ PROVISIONINGThis action is used to attach the custom Data which is already defined in the system to device.
If this Custom Data already existed in the device, the service updates the value of Custom Data in the device.
The result of this action is immediately available for subsequent rule processing.
GY_POST_ PROCESSING GY_SESSION_ ESTABLISHMENT GY_SESSION_ MODIFICATION GY_SESSION_ TERMINATION RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF SNA_ MANAGEMENT SNR_ RESUL T SY_SESSION_ ESTABLISHMENT SY_SESSION_ MODIFICATION THRESHOLDCustom- Data- Remove LIFECYCLE_ PROFILEThis action is used to remove a custom data of a device.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1309Charging User Guide Charging rules Attribute name Trigger Description SNA_ MANAGEMENT LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LIFECYCLE_ PROFILE THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGCustom- Data- Remove- Immediate SUBSCRIBER_ PRE_ PROVISIONINGThis action is used to remove a custom data of a device.
LOAN_ POST_ PROCESSING LOAN_ PRE_ PROCESSING RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGCustom- Data- Update SUBSCRIBER_ PRE_ PROVISIONINGThis action is used to update a custom data of a device.
Device- Id RATING_ POST_ PROCESSING The Id of the device.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1310Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDDevice- Name RESOURCE_ PRE_ SORTINGThe name of the device.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTINGDevice- Type SUBSCRIBER_ PRE_ PROVISIONINGThe record type of the device.
Enum with following options: NORMAL UNKNOWN TEMPLATE RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDE164 RESOURCE_ PRE_ SORTINGThe E164 of the device.
Entity- LifeCycle_ Name SUBSCRIBER_ PRE_ PROVISIONING RESOURCE_ PRE_ SORTINGThis attribute provides the entity life cycle name.
Definition : SPR_DEVICE.Entity-LifeCycle_Name= " Value_STRING"Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1311Charging User Guide Charging rules Attribute name Trigger Description Example: SPR_DEVICE.Entity-LifeCycle_ Name= "Prepid_DELC_01" If used as defined it will set the Entity Lifecycle of Device to Prepid_ DELC_ 01.
Entity- LifeCycle_ State SUBSCRIBER_ PRE_ PROVISIONING RESOURCE_ PRE_ SORTINGThis attribute indicates the entity life cycle state.
Definition : SPR_DEVICE.Entity-LifeCycle_State=" Value_STRING" Example: SPR_ACCOUNT.Entity-Life Cycle_State= "VF_ACTIVE1" If used as defined it will set the Entity Lifecycle state of Account as VF_ACTIVE1 .
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDExternal- Id RESOURCE_ PRE_ SORTINGThe external ID of the device.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTINGIMSI SUBSCRIBER_ PRE_ PROVISIONINGThe IMSI of the device.
RATING_ POST_ PROCESSING TARIFF RESOURCE_ POST_ PROCESSING THRESHOLDIs-Barred RESOURCE_ PRE_ SORTINGFlag to indicate if the device is barred.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1312Charging User Guide Charging rules Attribute name Trigger Description SUBSCRIBER_ PRE_ PROVISIONING Is-Exist- Bundle THRESHOLD RESOURCE_ PRE_ SORTINGChecks the Bundle- Name passed in the argument in the parent group on entity for which this threshold is configured.
The type is Boolean.
Is-Exist- Bundle- In-Parent- Group THRESHOLD RESOURCE_ PRE_ SORTINGChecks the Bundle pass in argument in Entity itself for which threshold is configured.
The type is Boolean.
Is-Exist- Bundle- In-Top- Group THRESHOLD RESOURCE_ PRE_ SORTINGChecks the Bundle- Name passed in the argument on top group of hierarchy for which this threshold is configured.
The type is Boolean.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTINGIs-First- Call SUBSCRIBER_ PRE_ PROVISIONINGFlag to indicate that device is used first time in call.
The type is Boolean.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONINGIs-First- Call- Done SUBSCRIBER_ PRE_ PROVISIONINGFlag that indicate that device is used first time in call request or it is previously called.
The type is Boolean.
IMS_ CALL_ ESTABLISHMENT IMS_ CALL_ MODIFICATIONLanguage IMS_ CALL_ TERMINATIONThis attributes indicates the device language label to be updated into device entities after PAC for language selection.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1313Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING SUBSCRIBER_ POST_ PROVISIONING SUBSCRIBER_ PRE_ PROVISIONING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LIFECYCLE_ PROFILE THRESHOLDLast- Update- Time RESOURCE_ PRE_ SORTINGThe time ( epoch) when this device was updated.
The type is Long.
RATING_ POST_ PROCESSING TARIFF RESOURCE_ POST_ PROCESSING THRESHOLDLdap- Search- Device RESOURCE_ PRE_ SORTINGFlag to indicate whether the Device is searched from Ldap or not.
The type is Boolean.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDMSISDN RESOURCE_ PRE_ SORTINGThe MSISDN of the device.
The type is String.
RATING_ POST_ PROCESSING TARIFF RESOURCE_ POST_ PROCESSINGNAI THRESHOLDThe NAI of the device.
The type is String.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1314Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ PRE_ SORTING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD SUBSCRIBER_ PRE_ PROVISIONINGNotification- Profile RESOURCE_ PRE_ SORTINGThe Notification Profile associated to this Device.
The type is String.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDOcs- Host RESOURCE_ PRE_ SORTINGThe host name of the OCS.
The type is String.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDOcs- Realm RESOURCE_ PRE_ SORTINGThe realm of the OCS site.
The type is String.
RATING_ POST_ PROCESSING TARIFF RESOURCE_ POST_ PROCESSING THRESHOLDOffline- Timestamp RESOURCE_ PRE_ SORTINGDevice off line time ( last termination time) .
Password RATING_ POST_ PROCESSING Device password for Wireline subscriber device.
The type is String.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1315Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RESOURCE_ PRE_ SORTING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDPassword- Encrypted RESOURCE_ PRE_ SORTINGFlag to indicate whether the stored password encrypted or not.
The type is String.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDPrivate- Id RESOURCE_ PRE_ SORTINGThe Private- Id of the device.
The type is String.
Remove- Bundle SUBSCRIBER_ PRE_ PROVISIONING RESOURCE_ PRE_ SORTINGThis action provides the bundle name to be removed.
Definition : Here first parameter is bundle name and second parameter is optional.
SPR_DEVICE.Remove-Bundle ("Bundle_ Name_STRING", <ALL or nothing>) Example: •SPR_DEVICE.Remove-Bundle (" Bundle1", "ALL") .
This will remove all the bundle instances having bundle name as " Bundle1" •SPR_DEVICE.Remove-Bundle (" Bundle1", ) .
This will remove the bundle with name " Bundle1" .
Here first subscription will be picked for removal.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1316Charging User Guide Charging rules Attribute name Trigger Description GY_PRE_ PROCESSING IMS_ CALL_ ESTABLISHMENT MMS_ CALL_ ESTABLISHMENT SMS_ CALL_ ESTABLISHMENTSet- Emergency RESOURCE_ PRE_ SORTINGThis action sets the level of emergency call.
The priority of emergency level is defined based on the emergency level type in descending order as follows: •ALL •DATA_ VOICE_ VIDEO_ ECOM •DATA_ VOICE_ VIDEO •VOICE_ VIDEO •SMS_ MMS •NONE RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDSIP-URI RESOURCE_ PRE_ SORTINGThe SIP- URI of the device.
The type is string.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDSubscription- Index RESOURCE_ PRE_ SORTINGIndex used for sorting the device subscriptions for rating along with Group subscriptions.
The type is Integer.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDSy-Ocs- Enabled RESOURCE_ PRE_ SORTINGFlag indicating if integration with OCS through Sy is enabled.
The type is Boolean.
RATING_ POST_ PROCESSING Trigger- Source RESOURCE_ POST_ PROCESSINGIndicates which component triggers this attribute updates.
The type is String.Table 101: SPR_DEVICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1317Charging User Guide Charging rules Attribute name Trigger Description TARIFF THRESHOLD RESOURCE_ PRE_ SORTING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF THRESHOLDUsage- Control- Services RESOURCE_ PRE_ SORTINGThe applicable Usage Control Service for this device.
The type is a set of string.
GY_POST_ PROCESSING LIFECYCLE_ PROFILEUsage- Services RESOURCE_ PRE_ SORTINGIt has the name of the UCS subscribed by the device.Table 101: SPR_DEVICE result context (continued) Example: Device custom data action can be used in trigger threshold and GY_POST_PROCESSING Following are some notes related to the custom data operations of device and group: •Only the custom data defined in the system can be used in the rules.
•There are two formats to access the custom data, such as SPR_DEVICE.XXXX or SPR_DEVICE.
Subscriber-Custom-Attribute(“XXXX”) .
The Subscriber-Custom-Attribute format of SPR_DEVICE or SPR_GROUP is recommended.
•The custom data is either added or updated by the action Custom-Data-Add or Custom-Data- Add-Immediate of SPR_DEVICE or SPR_GROUP .
•The custom data can be removed by the action Custom-Data-Remove or Custom-Data-Remove- Immediate of SPR_DEVICE or SPR_GROUP .
Following is the configuration for threshold rule.
In this, for the device, the custom data cd812141 is removed using the custom-data-remove-immediate parameter.
The custom data is updated with value of 10000 , which is added to cd812142 and 100 for cd812143 .
Note that the cd812141 , cd812143 custom data for device already exist in NCC.
Ensure that the notification template (NotificationTemplate81214 ) is configured for email notifications to be used in the GY_POST_PROCESSING rule.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1318Charging User Guide Charging rules Following is the configuration for GY_POST_PROCESSING rule.
In this, the custom data value for cd812142 is updated to 20000 and cd812143 to 200.002.
Following is the configuration for RATING_POST_PROCESSING rule.
In this, a notification is sent and write the value of cd2 and cd3 where cd2 is custom data cd812142 and cd3 is cd812143 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1319Charging User Guide Charging rules Following is the device custom data before executing the call.
Here, you can see that cd812143 , cd812141 already exist in NCC.
The cd812142 is the new custom data that is to be added.
The device makes a data call and the device subscription is used for the call.
During the call, the device bucket threshold is crossed (for example, 20 bytes is used) and the device custom data is changed in the threshold rule.
For this, the GY_POST_PROCESSING rule is triggered.
The device custom data value gets changed based on the value defined in the rule.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1320Charging User Guide Charging rules The following email notifications are sent after the call by triggering the RATING_POST_PROCESSING rule.
The first email is for CCRu.
DeviceId:Device81214, USU:10, cd2:10000, cd3:100.001 The second email is after the CCRt.
The values are changed by triggering the GY_POST_PROCESSING rule.
DeviceId:Device81214, USU:20, cd2:20000, cd3:200.002 4.9.
17 SPR_GROUP result context Attribute name Trigger Description TARIFF THRESHOLDDevice- Counter- Ids RATING_ POST_ PROCESSINGIds of Device Counters associated to this group.
The type is a list of String.Table 102: SPR_GROUP result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1321Charging User Guide Charging rules Attribute name Trigger Description LIFECYCLE_ PROFILE RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGTraversal- Order LIFECYCLE_ PROFILEDefines Group Hierarchy Traversal Order.
Enum with following options: TOP_ DOWN BOTTOM_ UP TARIFF THRESHOLD RATING_ POST_ PROCESSING LIFECYCLE_ PROFILENotification- Profile RESOURCE_ POST_ PROCESSINGThe Notification Profile associated to this Group.
TARIFF THRESHOLD RATING_ POST_ PROCESSING LIFECYCLE_ PROFILECreation- Time RESOURCE_ POST_ PROCESSINGThe time ( epoch) when this group was created.
The type is Long.
TARIFF THRESHOLD RATING_ POST_ PROCESSING LIFECYCLE_ PROFILELast- Update- Time RESOURCE_ POST_ PROCESSINGThe time ( epoch) when this group was updated.
The type is Long.
Group- Id TARIFF The Id of the group.Table 102: SPR_GROUP result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1322Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD RATING_ POST_ PROCESSING LIFECYCLE_ PROFILE RESOURCE_ POST_ PROCESSING TARIFF THRESHOLD RATING_ POST_ PROCESSING LIFECYCLE_ PROFILEGroup- Name RESOURCE_ POST_ PROCESSINGThe name of the group.
GY_POST_ PROCESSING Usage- Services LIFECYCLE_ PROFILEIt has the name of the UCS subscribed by the group.
GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLDCustom- Data- Add SUBSCRIBER_ POST_ PROVISIONINGUsed to attach the Custom Data which is already defined in system to group.
If this Custom Data already existed in the group, the service updates the value of Custom Data in the group.
GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGCustom- Data- Add- Immediate TARIFFUsed to attach the Custom Data which is already defined in system to group.
If this Custom Data already existed in the group, the service updates the value of Custom Data in the group.Table 102: SPR_GROUP result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1323Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING SUBSCRIBER_ POST_ PROVISIONING GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLDCustom- Data- Remove SUBSCRIBER_ POST_ PROVISIONINGThis action is used to remove a custom data of a group.
GY_POST_ PROCESSING RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LOAN_ PRE_ PROCESSING LOAN_ POST_ PROCESSING THRESHOLDCustom- Data- Remove- Immediate SUBSCRIBER_ POST_ PROVISIONINGThis action is used to remove a custom data of a group.
LOAN_ PRE_ PROCESSING Custom- Data- Update LOAN_ POST_ PROCESSINGThis action is used to update a custom data of a device.
Child- Group- Ids RATING_ POST_ PROCESSING Set of Child Group Id attached with the group.Table 102: SPR_GROUP result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1324Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSING TARIFF LIFECYCLE_ PROFILE THRESHOLD RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LIFECYCLE_ PROFILEChild- Group- Names THRESHOLDSet of Child Group Names attached with the group.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LIFECYCLE_ PROFILEChild- Device- Ids THRESHOLDSet of Device Id attached with the group.
The type is set of string.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LIFECYCLE_ PROFILEChild- Device- Names THRESHOLDSet of Child Device Names attached with the group.
The type is set of string.
Is-Exist- Bundle- In-Top- Group THRESHOLD Checks the Bundle- Name passed in the argument on top group of hierarchy for which this threshold is configured.
The type is Boolean.
Is-Exist- Bundle- In-Parent- Group THRESHOLD Checks the Bundle- Name passed in the argument in Parent group on entity for which this threshold is configured.
The type is Boolean.Table 102: SPR_GROUP result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1325Charging User Guide Charging rules Attribute name Trigger Description Is-Exist- Bundle THRESHOLD Checks the Bundle- Name passed in the argument in Entity for which this threshold is configured.
The type is Boolean.
RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSING TARIFF LIFECYCLE_ PROFILEGroup- Counter- Ids THRESHOLDIds of Counters associated with group.
The type is list of string.Table 102: SPR_GROUP result context (continued) Following are some notes on the custom data of group and device: •The group custom data is available for the rules associated with group resources.
For example, if the rules are attached to the group counter, group bucket, group subscription, the custom data from group can be read in the rules.
•The group custom data is not available from the rules linked to the resource of device.
•The group and device custom data can also be updated using rules.
•The group and device custom data are available as notification variables.
4.9.
18 SUBSCRIPTION result context Attribute name Trigger Description BUNDLE TARIFF THRESHOLDCustom- Data- Add RATING_ POST_ PROCESSINGThis action is used to attach the custom data which is already defined in the system to a subscription or service.
If a custom data is already present in the subscription, then the service updates the value of custom data in the subscription.
Note : RATING_ POST_ PROCESSING triggerTable 103: SUBSCRIPTION result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1326Charging User Guide Charging rules Attribute name Trigger Description RESOURCE_ POST_ PROCESSINGis supported only when the Dynamic Notification Custom flag is enabled.
Note : THRESHOLD trigger does not support Aggregate View ( AV) functionality.
BUNDLE TARIFF THRESHOLD RATING_ POST_ PROCESSINGCustom- Data- Add- Immediate RESOURCE_ POST_ PROCESSINGThis action is used to attach the custom data which is already defined in the system to a subscription or service.
If a custom data is already present in the subscription, then the service updates the value of custom data in the subscription.
The result of this action is immediately available for subsequent rule processing.
Note : RATING_ POST_ PROCESSING trigger is supported only when the Dynamic Notification Custom flag is enabled.
Note : THRESHOLD trigger does not support Aggregate View ( AV) functionality.
BUNDLE Custom- Data- Remove TARIFFThis action is used to remove a custom data of the subscription.
Note : RATING_ POST_ PROCESSING triggerTable 103: SUBSCRIPTION result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1327Charging User Guide Charging rules Attribute name Trigger Description THRESHOLD RATING_ POST_ PROCESSING RESOURCE_ POST_ PROCESSINGis supported only when the Dynamic Notification Custom flag is enabled.
Note : THRESHOLD trigger does not support Aggregate View ( AV) functionality.
BUNDLE TARIFF THRESHOLD RATING_ POST_ PROCESSINGCustom- Data- Remove- Immediate RESOURCE_ POST_ PROCESSINGThis action is used to remove a custom data of the subscription.
Note : RATING_ POST_ PROCESSING trigger is supported only when the Dynamic Notification Custom flag is enabled.
Note : THRESHOLD trigger does not support Aggregate View ( AV) functionality.Table 103: SUBSCRIPTION result context (continued) 4.9.
19 SY result context Attribute name Trigger Description THRESHOLD Send- SNR GY_POST_ PROCESSINGThis action sends SNR message.
The type is STRING.
SY_SESSION_ ESTABLISHMENT Change- Policy- Counter- Id SY_SESSION_ MODIFICATIONThis action alters the policy counter Id in the SLR ( two parameters: old counter Id and new counter Id) .
LIST OF Generic Value Wrapper.Table 104: SY result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1328Charging User Guide Charging rules Attribute name Trigger Description SY_SESSION_ ESTABLISHMENT Remove- Policy- Counter- Id SY_SESSION_ MODIFICATIONThis action removes a matching policy counter Id from SLR or SNR ( one parameter: counter Id) .
The type is STRING.
Drop- SNR SNR_ RESUL T This action discards the entire SNR messageTable 104: SY result context (continued) 4.9.20 THRESHOLD result context Attribute name Trigger Description Block- Next- Rate THRESHOLD Block- Next- Rate action blocks the next rate, so that only the primary rate is applied.
Disable- User- Configuration THRESHOLD If this flag is configured, then the rule configuration determining whether a user in Send- Notification action is by- passed and notifications are processed without user identification.
Threshold- Crossed THRESHOLD Threshold- Crossed is an action attribute info name defined within the Threshold result context.
It signifies that the flag indicating threshold applied to bucket/ counter has been crossed or not.
Input as a Threshold Name_ STRING or Recurrence Count_ STRING.
Threshold- Profile- Interval- Count THRESHOLD Threshold Profile Interval Count is an action attribute info name defined within the Threshold result context.
It signifies the interval count of the threshold profile configured.
Input as a Long value.
Notification- Destination THRESHOLD Notification- Destination is an action attribute info name that indicates whether the notification must be sent to a group or device based on the value defined.
Entered as an ENUM value.
Threshold- Trigger- Type THRESHOLD Indicates whether the threshold is triggered by a call or provisioning task.
Schedule- Event THRESHOLD Schedule- Event is an action attribute to support the time management in counters.
The syntax for this action is: Schedule-Event("<TIME_VALUE>",< TIME_UNIT>,<Action>)Table 105: THRESHOLD result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1329Charging User Guide Charging rules Attribute name Trigger Description TIME_ VALUE is the length of the period, TIME_ UNIT is the period unit such as Day, Week, and Action is the action to perform such as Reset.
Example: Daily counter reset THRESHOLD.
Schedule- Event ( “1”,Time Unit_ DAY, Threshold Scheduled Event Type_ RESET) SECONDS MINUTES HOURS DAYS WEEKS MONTHS YEARSTable 105: THRESHOLD result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1330Charging User Guide Charging configuration (new GUI) 5Charging configuration (new GUI) This chapter describes all service model entities available under the Charging Configuration tab in the new Service Manager Graphical User Interface (SM GUI).
The charging configurator comprises of top-level service entities that represent and define the service assigned and delivered to the subscribers, and configuration assisting in the simplification and usability of service definitions.
The logics (charging service), usage control service, and Internet of Things (IoT) policy service types are defined for NCC.
These services define the interaction between the network and subscriber, and the way in which NCC delivers, collects, and rates the consumption of resources by subscribers.
Attention : The graphical interface is getting revamped in a phase-wise manner.
As a result, the documents may contain a mix of old and new screenshots.
Note : Operators can perform import and export operation for all service entities using the SM GUI.
For all entities except services (bundles), only a particular entity is exported or imported.
For services (bundle), the associated entities are also imported or exported.
See Exporting and importing a service (bundle) on page 1349 for reference.
Attention : Entity export/import is supported only for the same release version.
For example, a release 22.7 entity JSON must not be imported into release 22.9.
Note : When editing the charging entities in the SM GUI, if you exit the editor without saving the data, then a warning dialog box appears as show in the following image: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1331Charging User Guide Charging configuration (new GUI) 5.
1 Entity relationship between subscriber model and service model entities Overview Figure 58: Entity relationship between subscriber model and service model entities Note : For information about subscriber model entities, see Subscriber Manager Guide .
5.2 Displaying provisioning status NCC can display provisioning status information per ME.
This display is available for all the service model entities.
See the following example.
In this, when a user clicks on the number under Managed Element , a pop-up window opens that displays the list of MEs where it is published.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1332Charging User Guide Charging configuration (new GUI) Note : If multiple versions of an entity is configured and published, then the provisioning display shows the each version per ME.
See the following example: Provisioning status when ME is offline The provisioning operations for service data when the target ME is in OFFLINE state are considered successful, but displayed in the SM as Pending .
The pending provisioning operations are automatically completed (provisioned) when the ME moves to ONLINE state later.
The provisioning status of the MEs is displayed as shown in the following image: Note : •This functionality is not applicable to subscriber data.
An offline ME always has another ME to host the same subscriber partition that can accept subscriber data provisioning transactions.
•If multiple provisioning operations that affect the same configuration entity are attempted, and a subsequent operation is dependent on the outcome of the first operation, then the subsequent operation fails.
That is, two updates of the same entity can be successful (the last update is applied), but an attempt to withdraw (unprovision) an entity, and then delete Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1333Charging User Guide Charging configuration (new GUI) it can fail.
This is because when the delete operation is attempted, the withdraw is not yet completed.
5.3 Modifying provisioned data NCC allows you to edit the service entities after they are published or provisioned or released.
Note that to perform this operation, you must be an admin user and the versioning flag, that is, the Entity Versioning Enabled application preference must be turned off.
This is applicable for following entities only: •Charging logic (including derived charging service) •Services (bundle) •Threshold profile group •Counter (Custom counter and Metering limit) •Allowance limit (bucket) •Lifecycle See the following example.
In this, you can use the edit option circled in the following figure to edit the entity.
Once an admin user clicks the edit option and modifies the values and clicks SAVE or SAVE&CLOSE , the following confirmation window is displayed: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1334Charging User Guide Charging configuration (new GUI) 5.4 Catalog Management 5.4.
1 Services (Bundles) Attention : When a bundle is published to ME, it takes a few seconds until it's effective on the ME side.
The correct procedure is to publish the bundle immediately at a future date (for example, midnight 00:00:00 of the next day).
For testing, the bundle is published with effective date = current time (in this case, + 30 seconds until it is effective).
Services (bundles) are the packages that offer a collection of services for an attractive fee.
Subscribers select different services (bundles) offered by service operators and a subscription is an assignment of a service (bundle) to a subscriber.
Consider a postpaid service for data, voice, and text.
This service includes a charging service with a preset amount of consumption for data, voice, and text.
The services tariff also defines the rating for consumption beyond preset allocation of different services, which is done by referring to specific rate entities defining the amounts.
For example, 2 GB of data, 500 anytime text, and unlimited evening texts.
An individual account can be associated with zero or more services (bundles).
A device or a group can have services (bundles) associated to them in form of subscription.
If the subscription taken by a group, then all the members of the group can use that subscription.
Note : The non-admin users cannot see the withdraw option to withdraw a service.
5.4.
1.
1 Configuration Log into the new GUI, navigate to Charging → ☰ → Services .
To add a new service (bundle), click and add the basic details as described in the following table: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1335Charging User Guide Charging configuration (new GUI) 5.4.
1.2 Basic Details Parameter Description Options Mandatory/ Optional Basic details Name This parameter indicates a unique name for the service.
String Mandatory Description Describes the service.
String Optional Service Monetization Entity Lifecycle This parameter indicates the object status lifecycle associated with the service.Select the required lifecycle from the predefined lifecycle values in the drop- down list.Optional Activation Type This parameter indicates whether the service ( bundle) is a normal service ( bundle) or a Bundle On Use ( BOU) type of service ( bundle) .
Following are the supported values for this parameter: •Normal : Indicates that the service is a normal service.
Note : When the Activation Type is set to Normal , an optional field Queue ID is available.
•On use : Indicates that it is a BOU type of service.
Once you select this option, you must define at least a single rule with an activation event.
•Auto- install : Indicates the auto- install type of service.
Once you select this option, you must define at least a single rule with an activation event.
•Activation queue : Once you select this option, you can provide a Queue ID.
•Subscription merge : Indicates that it is a rollover type of service.
Once you select this option, you must provide a Merge ID .
Note : For more details on rollover services, see Rollover services ( bundles) on page 1826 .
See Auto- install service ( bundle) activation type on page 1351 for more details.Enum Optional Queue ID This parameter indicates an Identifier that is used to store subscriptions in a queue structure so that they can be used in the order of their creation date.
Note : Queue ID is available only when the Activation Type is set to Activation queue .String Optional Merge ID Merging of two rollover services ( bundles) is possible only if both services have same Merge ID .String OptionalTable 106: Parameters for Services Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1336Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Services with same Merge ID are considered as same type while merging them.
Auto- manage service This parameter indicates whether the service ( bundle) is an auto- manage bundle.
If this parameter is enabled, then the service ( bundle) is eligible for automatic synchronization.
By default, this parameter is disabled ( not eligible for automatic synchronization) .
For more details on automatic service ( bundle) synchronization, see Auto- synchronization of services ( bundles) on page 1366 .Toggle Optional Rule This parameter indicates the rule name.
String Optional Click NEW to add a new rule.
Align to bill cycle This parameter indicates whether a periodic lifecycle is selected or not.
When ON, the periodic lifecycle of the account is used.
When OFF, a periodic lifecycle must be selected for reference.
Default value is true.- Optional Periodical lifecycle This parameter indicates the billing cycle associated with the service.
If not specified, the periodic lifecycle of the account is used.Select the required lifecycle from the predefined lifecycle values in the drop- down list.Optional Maximum renewals This parameter indicates the maximum number of times a subscription can be renewed.
If there is no value specified, then it denotes unlimited renewals can take place.Positive integers including zeroOptional Renewal priority ( Optional)This parameter is used to define the renewal priority of the subscriptions associated with an account.
It can take the following values: •0: Bundles with Renewal Priority value as 0 are mandatory bundles.
If the account balance is sufficient to fund the renewal of all mandatory bundles, then all the mandatory bundles are renewed successfully.
•Non- zero values: Bundles with non- zero Renewal Priority are optional bundles.
Optional subscriptions are processed for renewal as per their renewal priority only if all mandatory subscriptions are successfully renewed.
Lower value of this parameter means higher priority.
Default: 0 Valid value range: 0 to 2147483647 Note : For details on defining the bundle renewal priority, see Defining renewal priority of subscriptions associated with an account on page 1677 .Integer OptionalTable 106: Parameters for Services (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1337Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Align subscription period end to a dateIf this parameter is true, then Day of Week, or Hour of Day, or Day of Month can either be Null or Exact.
Supported values are True, False.
Default value is False.
Once selected, the following parameters are enabled: •Reference date •Day of Week •Hour of Day- Optional Reference date It supports Day of Month , Day of Week , Subscription input date values.
Enum Mandatory if Align with Subscription period end to a date is selected Day of Month This parameter indicates the day of month to which the bundle is applicable.
Following are the supported values for this parameter: •1 to 31 •Exact: If selected, the day of month is aligned to subscription purchase date.
Once the service is created, this attribute cannot be added or deleted, but can be modified using the Update action.
Day of Week Following are the supported values for this parameter •Sunday to Saturday •Exact : If selected, the day of week is aligned to subscription purchase date.
Once the service is created, this attribute is set to default value when no input is provided in Update action.String Mandatory if Align with Subscription period end to a date is selected Hour of Day This parameter indicates the hour of day to which the service is applicable.
Following are the supported values for this parameter •0 to 23 •Exact : If selected, the end date and time has the same time as subscription start time.
•Next Day Start : If selected, the end date and time is aligned to 00: 00: 00 of next day as per the lifecycle periodicity.
For example, if a monthly subscription is purchased on 20th Jan 13: 45:00, then the end date and time of subscription is set to 21st Feb 00: 00:00.
Note : Once the service is created, this attribute cannot be added or deleted, but it can be modified using the Update action.Integer Mandatory if Align with Subscription period end to a date is selectedTable 106: Parameters for Services (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1338Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Proration profile When selected, the data for proration is taken from proration profile ( see Proration Profiles on page 1491 ).Enum Optional Content Click + button to add new content.
Logics This parameter allows you to add charging logic to the service.
Supported charging logics are: •Data •Messaging •VoiceEnum Optional Fee and Advanced Settings Service fee This parameter indicates the service purchase fee deducted only from the main account balance.Big decimal Mandatory Maximum instance per device/ groupThis parameter indicates the times that a bundle can be subscribed to a particular device or group.
The default value is Null.
If the value is 0 or null, it means there is no limit.
The integer value less than 0 is invalid.Digit Optional Service Updates Following are the update types: •IMMEDIATE: The subscriptions get updated to a newer version on the next CCR.
•ON NEXT PERIOD: The subscriptions get updated to newer versions in the next bill cycle.
•DO NOT UPDATE: The subscriptions do not get updated.
Note : The Service Updates option get enabled only when the Entity Versioning Enabled preference is enabled.Enum Optional Apply taxation When selected applies tax to the service fee.
Boolean Optional Tax ID ID of a taxation profile.
This drop- down is available only when Apply taxation is selected.Enum Optional Custom Data Click ADD to add new custom data.
Name This parameter describes the name of the custom data.
String Optional Default value This parameter indicates the default value of the custom data.
It is an optional parameter.- Optional Service reference This parameter indicates a reference of another service ( bundle) .
When a new service ( bundle) is subscribed, the reference service ( bundle) must beEnum OptionalTable 106: Parameters for Services (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1339Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional attached and must not be in barred state.
If a reference service ( bundle) is not present in Device or Group, or if present but in barred state, then the new service ( bundle) is not subscribed.
If a new subscription is created with future activation and if future activation time is greater than or equal to reference service ( bundle) expiry time, then the new service ( bundle) is not subscribed.
If a reference service ( bundle) is not in barred state, then the new service ( bundle) is aligned with reference service' s end date and time.
If a reference service ( bundle) has more than one subscriptions attached with Device/ Group and those are not barred, then the new service ( bundle) is aligned with reference service ( bundle) subscription with least expiry time.
Supported values are null, service name.
The default value is null.
If an empty string is provided in the provisioning request, it is internally treated as default value of null.
See Example 1: Service ( bundle) Reference parameter usage on page 1354 for more details.
Disable tariff time changeIf this flag is set to true , then TTC calculation is not done and VT is aligned to subscription' s expiry date and time.
If MIN_ VT is set in quota management profile ( slicing profile) entity, it acts as a limit that cannot be crossed for Validity Time.
When both aligned service ( bundle) and reference service ( bundle) are present and reservation is done from aligned service ( bundle) , then Disable TTC flag of aligned service ( bundle) is ignored and flag of reference service ( bundle) is always used.
Supported values are true, false.
The default value is false.
If null is provided in the provisioning request, it is internally treated as default value of false.
See Example 2: Disable tariff time change flag usage and SNR processing on page 1361 for more details.Boolean Optional Publish Version Publish To This provides a list.
Operators can publish to All subscribers and so on.
Enum Mandatory Activation Time The supported values are as follows: •Activate Now : If this is selected, then the service is activated immediately.
•Schedule Activation : Operators can schedule activation to a future time using this option.Enum Mandatory Publish Type The supported values are as follows: •Normal : If this is selected, then no action is taken and the processing happens as per the defined logic.
•Retroactive update : If this is selected, then the forced Versioning attribute is set in the API and the update is immediately applied.Enum MandatoryTable 106: Parameters for Services (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1340Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Service Summary Displays the lifecycle states of the lifecycle selected for Entity lifecycle field.
- Displays when a lifeycle is selected for Entity lifecycle fieldTable 106: Parameters for Services (continued) If the Activation Type is NORMAL , then fee deduction during the bundle subscription time has the following priorities: 1.Subscription fee override 2.Bundle rule 3.Bundle fee During bundle subscription, if the subscription does not have fee override, then the bundle rule is evaluated, if it exists.
If the bundle rule does not exist, then the default bundle fee is deducted.
Note : Currently, only SPR_DEVICE source context is considered for evaluation.
If any other source context is configured in the rules, then it is bypassed at provisioning and the rule evaluation fails.
In this case, the default bundle fee is deducted.
5.4.
1.3 Versioning Operators can enable versioning for services (bundles) using the SM application preference named Entity Versioning Enabled .
Once enabled, you cannot clear it since it has adverse effect on backward compatibility to changes made to data.
When you set the Entity Versioning Enabled preference and make a change, a new draft copy (minor) version is created (example 1.1), which can be published as a new major version (example 2.0).
A corresponding application preference ( Versioning Enabled ) must be set in the ME.
You can enable versioning on both SM and ME using the API: /services/ServiceManager/updateSMAndME/SystemParameter See the sample below.
In this, smAttribute and meAttribute values must be set.
{ "distList": [ "ncc-me" ], Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1341Charging User Guide Charging configuration (new GUI) "avps": [ { "smAttribute": "entityVersioningEnabled", "meAttribute": "Versioning Enabled", "value": true, "property": "WRITE", "category": "", "description": "", "info": null, "type": "Boolean", "values": null, "range": null } ] } The API users can continue using APIs without specifying the concrete version numbers (minor or major).
The service (bundle) create API is: /services/ServiceManager/create/Bundle and publish API is: / services/ServiceManager/provision/Bundle .
NCC uses the following approach to provision, unprovision, or delete a versioned entity: •Provision : When you provision a versioned entity without specifying the concrete version number in the request, the highest draft version is picked.
Note that the withdrawn versions are also considered as drafts.
This behavior is same for provisioning as active and test-active.
The affected APIs are as follows: –services/ServiceManager/provision/Bundle –services/ServiceManager/testProvision/Bundle –services/ServiceManager/publish/Bundle –services/ServiceManager/testPublish/Bundle •Unprovision : When you unprovision a versioned entity without specifying the concrete version number in the request, the highest version among the active and test-active versions is picked.
The affected API is services/ServiceManager/withdraw/Bundle .
•Delete : When you delete a versioned entity without specifying the concrete version number in the request, the highest draft version is deleted.
Note that when the highest version is Active, an exception is thrown.
The affected API is services/ServiceManager/delete/Bundle .
CAUTION : You must set ME application preference named Versioning Enabled for the versioning to work as expected.
If the ME application preference is not set, then the versioning is not enabled for services (bundles).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1342Charging User Guide Charging configuration (new GUI) Previously, the new version of the service (bundle) was effective on BCR by creating a new subscription and moving the current subscription to final state.
Currently, NCC allows to update the subscription with the latest service (bundle) version at BCR.
Pre-requisites applicable for following scenarios: •The versioning flags must be enabled.
•Versioning must be enabled for service: fee, max renewals and PLC under some restrictions and assumptions.
•A lifecycle has RenewSubscriptionAction followed by ResetPeriodAction.
•Service or Account must have a lifecycle.
•Fee and MaxRenewal Versioning changes are not relevant in the ResetSubscriptionAction (no use of fee and MaxRenewals).
•The only difference between PLC version 1 and PLC version 2 is the Timer value and Timer units fields (same events and actions).
•PLC Versioning changes will be applied only during RenewSubscriptionAction followed by ResetPeriodAction of Subscription (not supported in case of Account BCR).
•The versioning happens at BCR (regardless if version type= immediately / next BCR).
•Protect value is considered for the version change.
•Service Template API - consider PLC Override permanent.
No Scenario Previous behavior Current behavior Configuration 1 Create a new version of Service, then wait for next Lifecycle Event To Renew Subscription.A new subscription is created with the new values according to the new service version.
The current subscription is moved to final state.The current subscription contains the new values of new version of service.Create service version 1 → Fee = 10, Max Renewals = 30, PLC= LC_ 1MIN( 1 minute lifecycle renewal)Table 107: Scenarios Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1343Charging User Guide Charging configuration (new GUI) No Scenario Previous behavior Current behavior Configuration Use the API to create service version 2 → Fee= 50, Max Renewals= 40, PLC= LC_4DAYS( 4 days lifecycle renewal) Wait ( 1 minute) for next lifecycle event to renew subscription.
After BCR, the new values of subscription are the new values in the new version.
2 Create New version of Protected Service, then wait for next Lifecycle Event To Renew SubscriptionNo version protect feature.
Subscription has the values of the version that is used to create the subscription.
This means, the subscription will not be updated to the new version of service.Create a service with Protected version settings and repeat same steps as in case 1.
For creating service with protected version settings, add the following block in the request body: "version Settings": { "version ProtectType": " PURCHASE_DATE" }, After BCR, the subscription values remain unchanged.
3 New subscription using Template API, Create new version of Service, then wait for next Lifecycle Event To Renew SubscriptionA new Subscription is created with the new service values taken from the latest version.
The current subscription is be moved to final state.The subscription is updated according to service values taken from the Template API.
The non mentioned value will be taken from the service new version.Create a subscription using the Template API over a service.
Create a new service version, then wait for next lifecycle event to renew subscription.
After BCR, the values of subscription remain unchanged because they are taken from the Template API, whereas the values that are not provided to the Template API are taken from the latest version.Table 107: Scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1344Charging User Guide Charging configuration (new GUI) Previously, operators were not able to update the subscription with new service (bundle) or charging logic versions for a bundle with NEXT_BCR version type until the start of the next period.
However, this type of update is needed immediately for the cases when an operator has to perform emergent fixes on the subscription catalog.
Operators do not want to wait for the next period to deliver the fix for the subscribers.
Currently, NCC allows to immediately deliver new versions of the bundle or charging logic to the subscribed users when a subscription to a bundle has version type = NEXT_BCR.
The forceVersioning attribute can be used to force a new version of the bundle or charging logic to apply immediately on the subscription.
This change takes effect if the bundle version type = NEXT_BCR.
If forceVersioning is true, then versioning changes are applied immediately.
If forcedVersioning is false, then versioning changes are applied to the next period.
The forcedVersioning attribute is available in the following APIs: •/services/ServiceManager/create/Bundle •/services/ServiceManager/create/ChLogic •/services/ServiceManager/create/ChargingService •/services/ServiceManager/provision/Bundle •/services/ServiceManager/provision/ChLogic •/services/ServiceManager/provision/ChargingService Adding/removing charging logic (charging service) Note : The versionProtectType must be NOT_PROTECTED to make the new version of service with added or removed charging logic affect the existing subscription.
Adding a charging logic The creation of a new version of the service (bundle) with addition of a charging service affects the existing subscription immediately (at CCR) or at next bill cycle (at BCR).
The proration is considered when creating a charging service instance such as prorated bucket IV, currentValue, and unUsedValue, prorated counter ULI, OLI.
The new values of prorated bucket or counter depends on the proration factor calculated as follows: Remaining days = total days - CS add date + 1 Prorate factor = Remaining days/total days Removing a charging logic The creation of a new version of the service (bundle) with deletion of a charging service affects the existing subscription immediately (at CCR) or at next bill cycle (at BCR).
The proration is considered when creating a charging service instance such as prorated bucket IV, currentValue, and unUsedValue, prorated counter ULI, OLI.
The new values of prorated bucket or counter depends on the proration factor calculated as follows: Active days = CS remove date - CS activation date + 1 Prorate factor = Active days/total days Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1345Charging User Guide Charging configuration (new GUI) The addition or deletion of charging logic in the service's (bundle) new version do not get reflected in the existing subscriptions until an appropriate event triggers the versioning.
Following events can trigger versioning: •Credit control request (CCR) on the device that owns subscription.
On CCR, the versioning is done only if the subscription's version type is IMMEDIATE .
•Billing cycle reset (BCR).
On BCR, the versioning is done only if the version type is NEXT_BCR , or it is IMMEDIATE but no event triggered versioning until BCR.
•Reset resource action.
Buckets or counters can have an individual lifecycle with Reset Resource Action attached to them.
In case the subscription's version type is IMMEDIATE , this can also trigger versioning on the entire subscription that the bucket or counter instance belongs to.
An expired charging logic gets permanently deleted from the database at a later time.
Also, the expiry of charging logic makes the charging components in the charging logic to expire.
The History Period parameter decides the time at which the expired charging logic must be deleted.
This parameter indicates the minimum number of days for which the expired components are kept in database.
An expired charging logic is permanently deleted at BCR if BCR time - Deletion time > History Period .
The deletionTime component is used in the SM APIs that can return components instances data.
The following are the APIs that was supported to return the deletionTime : Method Description URL Get Read Group /subscriber /update /Group Get Read Subscription /subscriber /getData / Subscription Get Read Device /subscriber/ getData/ Device Get Read Account /subscriber/ getData/ Account Get Read User /subscriber/ getData/ User Get Read Entity Counter instance /subscriber/ getData/ Entity Counter Instance Get Read Bucket instance /subscriber/ getData/ Bucket InstanceTable 108: API changes Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1346Charging User Guide Charging configuration (new GUI) Note : The latest published active version of the Service (Bundle) can be fixed (updated or edited) and re-published.
For more details, see Updating latest published active version on page 1541 .
5.4.
1.3.
1 Versioning of bundle PLC Operators can change a service (bundle) without PLC to service (bundle) with PLC using versioning.
That is, operators can change the service version from account PLC to subscription PLC.
A service without PLC means that the subscription renewal occurs during the Account BCR.
The version change happens during the Account BCR ( RenewSubscriptionAction followed by ResetPeriodAction ) regardless of whether the version type is immediate or BCR.
The RenewSubscriptionAction validates the maximum renewal on the service, consuming fees and resets allowance limits and metering limits.
There are more cases related to bundle versioning, see Account/subscription periodic lifecycle event configuration on page 1347 .
PLC Version Change Event For the PLC version change, you must configure the account/subscription periodic lifecycle event.
It must consist of RenewSubscriptionAction followed by ResetPeriodAction with any additional actions.
The PLC can be configured on new service version and can be executed on next BCR.
Note : The PLC Version Change Event appears in the Lifecycles entity only when the versioning is enabled.
Following are the valid PLC configurations for new bundle version: •Subscription PLC (periodic lifecycle) with same state name as Account PLC (entity lifecycle) with PLCVersionChangeEvent .
•Subscription PLC with PLCVersionChangeEvent on initial state.
•Subscription PLC with same state name and same event name as Account PLC.
If a valid configuration is not found for subscription PLC, then versioning gets aborted and error gets included in the log.
Account/subscription periodic lifecycle event configuration The account/subscription periodic lifecycle event configuration consists of RenewSubscriptionAction followed by ResetPeriodAction and combined with any additional actions.
Following are the cases for PLC that can be configured on new service (bundle) and executed in next BCR: •Case 1 : No PLC on the bundle.
The Bundle PLC1 is NULL.
The Bundle PLC2 has RenewSubscriptionAction followed by ResetPeriodAction .
•Case 2 : PLC on the bundle to no PLC on the bundle.
The Bundle PLC1 has RenewSubscriptionAction followed by ResetPeriodAction .
The Bundle PLC2 is NULL.
•Case 3 : The bundle version change from PLC1 to PLC2.
PLC2 uses a special event PLCVersionChangeEvent (if exists).
PLC2 can have more actions than PLC1.
Otherwise, if the same state name PLC1 and PLC2 ( RenewSubscriptionAction ) use it.
If not in same state, then versioning is aborted.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1347Charging User Guide Charging configuration (new GUI) •Case 4 : For BOU activation event configured in bundle rules and an event is triggered to activate subscription during call.
The same event must be configured in the subscription PLC in pre-active (barred) state.
The subscription creation out of BOU is activated depending upon the value set in in the application preference BOU Activation Priority .
It has the values DEFAUL T , ON_RESERVATION , and ON_COMMIT .
The subscription created out of BOU are in pre-active (barred) state and can be activated during call: 1.DEFAUL T : Subscription is activated as soon as NCC receives the call for the device which has subscribed to BOU.
2.ON_RESERVATION : Subscription is activated if it is selected to grant reservation.
3.ON_COMMIT : Subscription is activated once the commit is received for granted units.
5.4.
1.4 Updating latest published active version (service) Backdating of service (bundle) The latest published active version of a service (bundle) can be fixed (updated or edited) and published.
The fixed version of the latest published active version is called a Patch Fix or Backdated Fix .
The effective date of the Patch Fix is same as that of the latest published version, regardless of when the Patch Fix is published.
Note : For more details on Patch Fix , see Updating latest published active version on page 1541 .
The following Services (Bundles) attributes can be updated to create a patch fix of the latest published active version of Services (Bundles) : •Service reference •Max renewals •Bundle fee Creating a patch fix A patch fix can be created only for a latest published active version.
The procedure to create a patch is as follows: 1.Go to the latest published active version, and click .
Select Edit active version .
Edit Active Version dialog box appears as show in the following image: 2.Click EDIT .
3.Edit the components or attributes of the latest published active version, and save the updates.
A patch fix is created.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1348Charging User Guide Charging configuration (new GUI) 4.To update the patch fix, click (Update published version) icon.
Update published version dialog box appears as show in the following image: 5.Click UPDATE .
The patch fix is published and it overrides (replaces) the previous version.
6.To create a new patch fix, click , and edit the latest published active version.
Note : This option is visible only after the first patch fix is updated.
Deleting a patch fix 1.To delete a patch fix, click against the patch fix as show in the following image: 2.Select Delete .
The patch fix is deleted.
Note : The patch fix can be deleted only when it is in DRAFT state.
When a patch fix is published, the option to delete it is disabled.
5.4.
1.5 Exporting and importing a service (bundle) You can export a service (bundle) from an existing NCC environment along with its associated entities and import it to the same or another NCC environment.
This is primarily used to export bundles from test to live NCC environments.
Following entities are imported or exported along with the service (bundle) during the service (bundle) import or export: •Logics (Charging services) •Usage control services •Threshold profiles •Lifecycles Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1349Charging User Guide Charging configuration (new GUI) •Taxation •Allowance limits (buckets), metering limit (counters), unit, and tariff rules within logics (charging services) •Any embedded rules in logics (charging service), usage control service, threshold profiles Note : Any entities referenced from within the embedded rules (for example, rate used in tariff rule) are not considered as child objects of the service (bundle).
These entities are not imported or exported with the service (bundle) when the Import or Export action is performed.
In the target NCC, you must create and provision any entity referenced from within any embedded rule.
5.4.
1.5.
1 Exporting a service (bundle) To export a service (bundle), select an existing service (bundle), and click the Export button for the service (bundle) from the available actions.
The service (bundle) is saved to a .json file.
The default name is <service_name>.json .
5.4.
1.5.2 Importing a service (bundle) To import a service (bundle), click the Import button at the top-right corner of the Services window.
A pop- up window appears (see Service (bundle) import pop-up window on page 1350 ) that allows you to browse to the existing service (bundle) file and rename the service (bundle), if required.
Click the Import button to import the service (bundle) along with its associations.
Figure 59: Service (bundle) import pop-up window When you import a service (bundle), associated entities are created in the destination NCC in case those entities are not already present.
However, if one or more entities are already present in the destination NCC, then following behaviour is considered under the given conditions: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1350Charging User Guide Charging configuration (new GUI) If... Then.
..
Override option is not selected, The specific entities from the destination NCC are used.
Override option is selected, The specific entities from the source NCC are overwritten on the destination NCC.
The service (bundle) name is unique in an NCC environment.
However, if the destination NCC already has a service (bundle) with the same name, then you must perform one of the following options: •Change the bundle name during import using the Rename Bundle field in the Import Bundle pop-up window.
•Use the Override option to overwrite the bundle in the destination NCC.
During service (bundle) import, if the service (bundle) already exists in NCC and is provisioned, then the .json service (bundle) file being imported must contain definitions of all the sub-entities.
Note : When versioning is enabled and a service (bundle) is imported together with its referenced charging-logics, those charging-logics are automatically published to MEs.
This is done to satisfy a restriction that a charging-logic cannot reference an unpublished charging-logic.
5.4.
1.6 Auto-install service (bundle) activation type Operators can define an auto-install travel pack at top-group level (company level), then on receiving a call for Devices that are directly or indirectly attached to the top-group, a new subscription allocated to the child group.
The new subscription can also be attached to the Device based on certain conditions.
There can be more than one auto-install travel pack defined at top-group level and more than one can be automatically installed (subscribed) to a user.
Services (bundles) are managed at top-group level, that is, any changes made to the top-group such as removal or addition of a new bundle gets reflected in a new call for all child groups based on applicability condition.
For example, when a subscriber is surfing in a zone in which a service (bundle) can be applied, then such service (bundle) is added automatically at child group level if it does not exist yet.
Following are the two types of travel packs: •Auto-install travel pack : When an allowance limit (bucket) is consumed but is still reporting usage and is applicable for the service (bundle), then the allowance limit (bucket) must be renewed with a new validity time of 1 month.
This date is used to compare the expiry time with other type of services (bundles) with same priority, the one that expires first must be used first.
If the service (bundle) expires (after 1 month), then the service/allowance limit (bundle/buckets) are renewed only if still in the region where the service (bundle) is applicable and reporting usage.
It must be valid for 1 month.
This date is used to compare the expiry time to select bundles.
•Unlimited auto-install travel pack : The allowance limit/service (bucket/bundle) is renewed on expiry date and not on allowance limit (bucket) exhaustion.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1351Charging User Guide Charging configuration (new GUI) Note : Multiple auto-install service (bundle) can be attached with entity.
More than one bundle can be attached through auto-install bundle provided the bundle name is different.
Rules can also provide multiple service (bundle) output and can be attached at same time to provided entity.
Future activation is not supported for new service (bundle) subscribed using auto-install option.
When an auto-install service (bundle) activation type is selected, you can define an Add-subscription event to apply a subscription to a Group/Device automatically by service (bundle) and threshold rules on meeting certain conditions.
The syntax for the Add-Subscription rule action is as follows: Bundle.Add-Subscription("Bundle Name","AccountId", "DestinationEntity") and Bundle.Add-Subscription("Bundle Name","AccountId", "DestinationEntity", "Units to compare") where •Bundle Name is the new service (bundle) name to subscribe.
•AccountId is the Account name used for charging the new subscription.
If it is NA, then the Account from already attached subscription, that is, first subscription attached to Group or Device is used.
•DestinationEntity is the location where new service (bundle) is attached.
Following are the options: –SELF : The same entity on which the auto-install bundle is configured.
–IMMEDIATE_NEXT_ENTITY : The subscription obtained from the auto-install bundle is attached to the next (child) entity (Group/Device) of the Group for which bundle rules are executed.
–DEVICE : The subscription obtained from the auto-install bundle is attached to the Device for which the call is received.
•Units to compare is used when a customer wants bundle on exhaustion.
This value and add subscription information are added in threshold.
This value must be inline with the value on which the threshold Add-Subscription action is applied.
Example if @Zone_ID="2" then Bundle.Add-Subscription("Bun1-0500782", "NA", DestinationEntityType_IMMEDIATE_NEXT_ENTITY) The syntax for the Bundle-Name rule action is as follows: Bundle.Bundle Name = "Bundle Name" where Bundle Name is the new bundle name to subscribe.
In this case, Account from already attached subscription, that is, the first subscription attached to Group/Device is used and Destination Entity is SELF.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1352Charging User Guide Charging configuration (new GUI) Auto-install bundle activation type (with threshold rule) The Add-Subscription and Bundle-Name rules for auto-install bundle can be defined in the Threshold entity.
Note : While configuring rule to add new subscription from Threshold, if the Bucket_Balance_Value is provided in the rule input, then it is ignored.
The syntax for the Add-Subscription rule action is as follows.
Note that, in the following Bundle.Add- Subscription action, the Bucket_Balance_Value field should not be provided.
If provided, then this value is ignored.
Bundle.Add-Subscription("Bundle_Name_STRING","Account_Id_STRING", "Destination_Entity_ENUM") where •Bundle_Name_STRING is the new service (bundle) name to subscribe.
•Account_Id_STRING is the Account name used for charging the new subscription.
If it is NA, then the Account from already attached subscription, that is, first subscription attached to Group or Device is used.
•Destination_Entity_ENUM is the location where new service (bundle) is attached.
Following are the options: –SELF : The same entity on which the threshold is configured, that is, if entity counter, then its on same entity.
If subscription counter, then it is on entity for which the subscription is configured.
–IMMEDIATE_NEXT_ENTITY : The child entity of the entity fetched in Bundle Name.
–DEVICE : The Device for which the call is received.
The syntax for the Bundle-Name rule action is as follows: Bundle.Bundle-Name = "Bundle-Name" where Bundle-Name is the new bundle name to subscribe.
In this case, Account from already attached subscription, that is, the first subscription attached to Group/Device is used and Destination Entity is SELF.
Example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1353Charging User Guide Charging configuration (new GUI) 5.4.
1.7 Examples 5.4.
1.7.
1 Example 1: Service (bundle) Reference parameter usage When a subscription with reference service (bundle) expires, the linked subscription with aligned service (bundle) also must expire.
To achieve this, the following lifecycle configurations are recommended.
Note that BOU type service (bundle) for subscription with reference service (bundle) is considered for configuration.
Reference service (bundle) lifecycle: Whenever the subscription with reference service (bundle) moves from Active to Preactive or any other barred or suspended state, then Trigger Event Action is configured with Expire Event to check the subscription with aligned service (bundle) and expire it and then expire itself (subscription with reference service).
Note that Expire Event must be configured in the aligned service (bundle).
Ensure that Allow Event Broadcast is selected.
Attention : Ensure that Trigger Event Action is configured in all the events that move the subscription with reference service (bundle) from Active to Preactive or suspended state.
Aligned (data boost) service lifecycle: In this, when the ExpireEvent gets triggered, the subscription with aligned service moves to Final state.
The Final state has the configuration to delete it.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1354Charging User Guide Charging configuration (new GUI) If the aligned service (DataboostBundle) is configured with the Activation type as NORMAL (that is, if aligned service is a normal bundle), then fee deduction during the bundle subscription time has the following priorities: 1.Subscription fee override 2.Bundle rule 3.Bundle fee During bundle subscription, if the subscription does not have fee override, then the bundle rule is evaluated, if it exists.
If the bundle rule does not exist, then the default bundle fee is deducted.
Some of the scenarios related to reference service are as follows: •Scenario 1 : Subscription of newly aligned bundle fails if the reference service is not attached to the Device.
•Scenario 2 : Subscription of newly aligned bundle fails if the reference service is attached to Device but is not active.
•Scenario 3 : Subscription of newly aligned bundle fails if the aligned service has future activation time greater than the reference subscription expiry time.
•Scenario 4 : Aligned bundle expires when the reference service expires.
•Scenario 5 : Subscription instance of newly aligned service aligns to one with earliest expiry when multiple instances of reference service are attached to Device.
•Scenario 6 : Multiple instances of aligned service aligned to reference service expire when reference service expires.
Scenario 1: Subscription of newly aligned service (bundle) fails if reference service (bundle) is not attached to the Device Pre-conditions : Configure the reference and aligned service (bundle).
Following is the configuration of reference service (bundle): Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1355Charging User Guide Charging configuration (new GUI) Following is the configuration of aligned (data boost) service (bundle): Device is not subscribed to reference service (bundle).
Flow of events : Device tries to subscribe to the aligned service (bundle) (DataboostBundle).
The subscription fails with the following error message.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1356Charging User Guide Charging configuration (new GUI) Post-conditions: Subscription to the aligned service (DataboostBundle) fails.
Scenario 2: Subscription of newly aligned bundle fails if the reference service (bundle) is attached to Device but is not active Pre-conditions: •Base bundle is in PreActive state.
•Device is updated to subscribe to newly aligned service (bundle).
Flow of events: Device tries to subscribe to the aligned service (DataboostBundle).
The subscription fails with the following error message.
Post-conditions: Subscription to the aligned service (DataboostBundle) fails.
Scenario 3: Subscription of newly aligned service (bundle) fails if the referenced service (bundle) has future activation time greater than the reference subscription expiry time Pre-conditions: Reference service (bundle) is attached to Device and Subscription is in Active state.
Expiry time of subscription is 01-07-2020 00:00:00.
Flow of events: Device tries to subscribe to the aligned service (bundle) having reference to reference service (bundle) with Activation time as 10-07-2020 00:00.
Post-conditions: The aligned service (bundle) is not attached to Device and the following error is displayed: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1357Charging User Guide Charging configuration (new GUI) Scenario 4: Aligned service (bundle) expires when the reference service (bundle) expires Pre-conditions: Reference service (bundle) is in Active state.
Flow of events: Device tries to subscribe to the aligned service (DataboostBundle).
The subscription to aligned service (bundle) is successful.
Post-conditions: •As expiration of reference subscription reaches, the subscription with aligned service (bundle) expires first and then reference subscription expires.
•The aligned service (bundle) subscription is moved to Final state as per lifecycle configuration.
Scenario 5: Subscription instance of newly aligned service (bundle) aligns to one with earliest expiry when multiple instances of reference service (bundle) are attached to Device Pre-conditions: Following is the configuration of reference service (BOUBaseBundle).
Note that the value of Service Reference is Null.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1358Charging User Guide Charging configuration (new GUI) Following is the configuration of aligned service (DataboostBundle).
Note that the value of Service Reference has the reference to reference service (BOUBaseBundle).
Device has two active instances of reference service (bundle) with different expiry time.
The first service (bundle) expiry time is 3:14 PM IST and the second one is 3:16 PM IST.
There is a difference of two seconds.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1359Charging User Guide Charging configuration (new GUI) Flow of events: Device subscribes to newly aligned service (bundle).
Post-conditions: Device makes a call and the reference service (bundle) instance with earlier expiry time expires and moves to PreActive state.
The aligned service (bundle) instance also expires.
Scenario 6: Multiple instances of aligned service (bundle) aligned to reference service (bundle) expire when reference service (bundle) expires Pre-conditions: DeBOU bundle is defined with a 24 hour interval, and data allowance of 500 MB.
Device subscribes to reference service (bundle) and makes a call to move it to Active state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1360Charging User Guide Charging configuration (new GUI) Device is updated to add new aligned service (bundle) twice to have multiple instances.
Flow of events: Reference service (bundle) instance expires and moves to PreActive state.
Post-conditions: Both the aligned service (bundle) instances also expire and move to Final state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1361Charging User Guide Charging configuration (new GUI) 5.4.
1.7.2 Example 2: Disable tariff time change flag usage and SNR processing SNR is processed in following cases: •On exhaustion: Either reference service (bundle) or aligned service (bundle) is exhausted.
•On expiration when there is no active session: Reference service (bundle) is expired through TEM module.
In case there is an active session, SNR can be processed based on configuration.
•On subscribing the reference service (bundle).
Scenario 1: SNR processing at different stages of subscription Lifecycle configuration for SNR processing: The following figure shows the configuration for SNR processing in the reference service (bundle) periodic lifecycle.
In this, when a subscription moves from Active to Pre-active , that is, barred state, the SNR action is configured to set the virtual policy counter status to LOW.
Figure 60: Reference service (bundle) periodic lifecycle Similarly, when a Not Enough Funds Event is generated and a reference service (bundle) is moved to suspended/barred state, the SNR action sets the virtual policy counter to LOW.
When a Max Renewals Reached Event is generated and a subscription moves to Final state, the SNR action sets the virtual policy counter status to Removed state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1362Charging User Guide Charging configuration (new GUI) Threshold configuration for counters for SNR processing: Reference service (Base bundle) The following threshold is configured in the reference service (bundle).
For the threshold value of 0, SNR for virtual policy counter is set to HIGH .
For the threshold value of 50 (which is exhaustion value in following case), SNR for virtual policy counter is set to LOW.
Aligned service (Data boost bundle) The following threshold is configured in the referenced service (bundle).
For the threshold value of 0, SNR for virtual policy counter is set to HIGH .
For the threshold value of 40 (which is exhaustion value in following case), SNR for virtual policy counter is set to LOW.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1363Charging User Guide Charging configuration (new GUI) Flow of events: When a device subscribes to the reference service (bundle) subscription, the SNR is processed and virtual policy counter status is set to HIGH .
After the usage, when the reference service (bundle) subscription gets exhausted, the SNR is processed and virtual policy counter status is set to LOW.
This is done through threshold configuration.
After the exhaustion of reference service (bundle) subscription, when a device subscribes to aligned bundle, the SNR is processed and virtual policy counter is set to HIGH .
After the usage is committed from aligned service (bundle) subscription and on exhaustion, SNR is processed and virtual policy counter is set to LOW.
After the reference service (bundle) expires and moves to Pre-active state through TEM auditing on expiry of bundle, SNR is not sent since virtual policy counter already in LOW state.
Scenario 2: TTC is not set and VT is aligned to expiry time when “Disable tariff time change” is configured in reference service (bundle) Pre-conditions: Following is the initial configuration: Quota management profile (Slicing profile) The validity time is set to 50 seconds in the quota management profile (slicing profile).
Reference service (bundle): Disable tariff time change flag is set to true Flow of events: When a Device subscribes to the reference service (bundle), virtual policy counter is set to HIGH .
When the Device uses up the reference service (bundle) completely, virtual policy counter is set to LOW.
Device subscribes to a aligned service (bundle) subscription, virtual policy counter set to HIGH again.
Scenario 3: Disable tariff time change flag is configured in aligned bundle but not reference bundle Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1364Charging User Guide Charging configuration (new GUI) Pre-conditions: In this case, the TTC/VT default logic is followed, that is, the aligned bundle configuration is ignored.
The configuration of Disable tariff time change is used.
In the reference service (bundle), Disable tariff time change flag is set to False .
In the aligned service (bundle), Disable tariff time change flag is set to True .
Flow of events: Device makes a call.
The reference service (bundle) expiry time is between the current time of the call and validity time.
Post-conditions: In this case, the VT is set to default behavior considering randomization factor.
TTC is also set that indicates that the configuration of referenced service (bundle) is ignored and aligned service (bundle) configuration is used.
5.4.
1.7.3 Example 3: Align subscription period end to a date parameter usage The following table has scenarios listed that show the BCR time when Align subscription period end to a date parameter is set to ON or OFF.
Activation TypeBundle level configurationBundle prorate configurationAlign subscription period end to a dateBundle fee/ activation feeInput date fieldSubscription creation timeSubscription activation timePeriodical lifecycleExpected end timeProrated bundle fee Normal HoD= Exact, DoW= Null, DoM= ExactON ON 30 12.04.2020 11:00:0015.04.
2020 13: 00:00NA Monthly 12.05.
2020 11:00: 0027 Normal HoD= Exact, DoW= Null, DoM= ExactON OFF 30 NULL 10.04.
2020 07: 05:00NA Monthly 10.05.
2020 07:00: 0030 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1365Charging User Guide Charging configuration (new GUI) Activation TypeBundle level configurationBundle prorate configurationAlign subscription period end to a dateBundle fee/ activation feeInput date fieldSubscription creation timeSubscription activation timePeriodical lifecycleExpected end timeProrated bundle fee On UseHoD= Exact, DoW= Exact, DoM= ExactON ON 20 12.04.2020 11:00:0015.04.
2020 07: 00:0018.04.
2020 07: 00:0010 days 22.04.
2020 11:00: 008 On UseHoD= NULL, DoW= NULL, DoM= NULLON OFF 20 NULL 15.04.
2020 07: 00:0018.04.
2020 07: 00:0010 days 28.04.
2020 07:00: 0020 5.4.
1.8 Actions associated with a service (bundle) Action Description Create Creates a service ( bundle) entity in database.
Read Displays a service ( bundle) entity as per the data retrieved from database.
Update Updates a particular service ( bundle) entity in database.
Delete Deletes a particular service ( bundle) entity from database.
Note : The preceding actions are valid only for internal purposes and cannot be accessed using the SM GUI.
5.4.
1.9 Auto-synchronization of services (bundles) This feature provides the functionality to automatically activate/subscribe or deactivate/remove bundles on a device during the call based on rule configuration.
The functionality to automatically synchronize the bundles is supported by the RESOURCE_PRE_SORTING trigger.
The services (bundles) to be automatically synchronized can be selected using Auto-manage service parameter in the Service (Bundle) entity.
If Auto-manage service parameter is enabled for a bundle, it indicates that the bundles is eligible for automatic synchronization.
For details on Auto-manage service parameter, see Basic Details on page 1335 .
If a service (bundle) is configured to be eligible for automatic synchronization, then note the following important points: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1366Charging User Guide Charging configuration (new GUI) •If the service (bundle) is already subscribed to the device in active state, then no action is taken.
•If the service (bundle) is not subscribed to the device, then a new instance of bundle is added to the device in active state.
•If the bundle is already subscribed to the device but not present in the list of input bundles for automatic synchronization, then that subscription instance is removed from the device.
The automatic synchronization functionality can be controlled using the application preference Enable Auto Manage .
For details on configuring Enable Auto Manage , see Managed Element application preferences section in Global configuration guide .
Configuration The application preference Enable Auto Manage is used to enable/disable automatic synchronization of bundles.
It can take the following values: •false : Automatic synchronization of bundles functionality is disabled.
•true : If configured at SM, then auto management (provision or de-provision of services (bundles) to devices) is enabled.
If configured at ME, then the synchronization process is executed.
Note : Auto synchronization of the services is triggered based on the rule configuration.
SPR_DEVICE.Auto-Manage-Sync can be used to configure the list of bundles to be automatically synchronized.
For more details on Auto-Manage-Sync action, see SPR_DEVICE source context on page 1111 .
Auto-manage service parameter in Service (Bundle) entity should be enabled to indicate that the bundle is eligible for automatic synchronization.
If Auto-manage service parameter is enabled for a bundle, then a message pop-up appears as shown in the following image: Note : Sample RSV is a sample for reference to understand rules configuration for this feature.
It is available in read-only mode.
Note the following important points about this feature: •Automatic service (bundle) synchronization is applicable only to device.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1367Charging User Guide Charging configuration (new GUI) •If the subscription is in final state, then a transition is defined in the lifecycle for subscription instance deletion.
•BOU bundles and queued bundles should not be selected for automatic synchronization.
•This RESOURCE_PRE_SORTING trigger is not applicable to IoT device event charging.
•Sy call is not applicable for auto-manage functionality.
•If a subscription to an auto-managed bundle is in barred state, then it is considered as a valid instance and not synchronized again.
•If an on-going call fails after the execution of auto-manage functionality through Auto-Manage-Sync action, then all the subscriptions processed are rolled back and their EDRs are generated.
•If a bundle is provisioned before entity versioning is enabled, then a new version of the bundle must be created.
Else, Auto-Manage-Sync functionality is not applicable for that bundle.
•New instance of updated version of an auto-managed bundle is not subscribed through auto-manage sync function.
•For an auto-managed bundle that is already subscribed by a device and is in valid state, if a new version is created or an existing version is updated, then that bundle is not re-subscribed during call.
Examples Use case 1: Configuration: •Application preference Enable Auto Manage is enabled on SM and ME node.
•The bundles B1, B2, B3, B4 are provisioned and are configured to be eligible for automatic synchronization.
•Device D1 is subscribed to Bundle B1 and Bundle B5, and B5 is eligible for automatic synchronization.
•A custom data is configured at device level for COSP.
•The subscription to B1 is in final state.
Execution: •Device D1 makes a call.
•Based on the COSP conditions, the bundles which are present in the valid list are B1,B2, B3, and B4.
Result: •Bundle B1 is already subscribed but in final state.
Hence, a new instance of B1 is added to the Device D1.
•Bundle B2, B3 and B4 are subscribed to Device D1.
•Bundle B5 is already subscribed but not in the valid list of bundles based on COSP conditions.
Hence the subscription is removed from the device.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1368Charging User Guide Charging configuration (new GUI) •All the bundles subscribed in the call are available for usage in the same call.
5.4.2 Loans Emergency top-up/loan is a type of service using which operators can offer additional monetary balance to the subscribers as a loan.
5.4.2.
1 Configuration Log into the new GUI, navigate to Charging → ☰ → Loans .
To add a new loan, click and add the basic details as described in the following table: Parameter Description Options Mandatory/ Optional Name This parameter indicates a unique name for the loan.
String Mandatory Type This parameter indicates the type of loan.
Following are the valid values: •Recurrent - At repayment of the debt, loan is provided again until opted out/ reset.
•One- time - At repayment of the debt, loan is not be provided again Default: One- timeEnum Mandatory Loan details Loan content Indicates whether the loan content is an amount ( of money) or a Service ( bundle) .
The following options are available: •Grant loan amount: Select this option to provide a specific amount ( of Money) as loan.
If this option is selected, provide the loan amount as follows.
Loan amount: Loan amount ( in Money) to be given.
( The type is Double and it is a mandatory parameter if Grant loan amount is selected. )
•Service subscriptions: This option is available only if Type is One- time .
Select this option to provide a bundleRadio buttonMandatoryTable 109: Parameters for Loan Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1369Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional as loan.
Click + SELECT in the Loan details bar to select a Service ( bundle) from the available bundles.
Only one Service can be added from the available services.
Refer to Loan as Bundle on page 2175 for details.
Fee Activation fee Amount to be deducted only when the loan is opted in Default: 0Double Optional Service fee Amount to deducted as service fee on repayment of loan.
Default: 0Double Optional Service fee paid only if loan usedThis option is available only if Loan content is set to Grant loan amount .
This parameter is used to deduct service fee.
If the check box is: •Selected: If loan is used as main balance, then service fee is deducted at repayment/ opt- out.
•Clear: Even if loan is not used as main balance, service fee is deducted at repayment/ opt- out.
This check box is selected by default.Check box -Table 109: Parameters for Loan (continued) 5.4.3 Recharge Offers The recharge offers entity allows operator to configure a recharge profile.
See the Recharge profile topic in the NCC Recharge User Guide for more details.
5.4.4 Discounts Discounts are the promotions offered to subscribers, which are valid at both device and group levels.
Discount has attributes that are used to create discount instances.
The discount is defined with a name that can be referenced by the discount instance.
Discount shall be able to: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1370Charging User Guide Charging configuration (new GUI) •Override the bundle fee / renewal fee / ChargeFee during the subscription renewal as per lifecycle renewal action or pending renewal due to insufficient balance and renew during recharge event.
•Define with validity and number of periods.
•Have different bundles with the same discount.
Discounts Toggle The SM application preference Discounts Toggle is used to switch between the Standalone (legacy) and the In-Bundle discount types.
This parameter can be set to any preference of using different types of discount definition from the SM GUI.
The operator can configure the following values for the Discounts Toggle SM application preference: •Discount_Standalone : If Discounts Toggle is set to Discount_Standalone , then Standalone (legacy) discount definition is accessible from SM GUI for configuration.
•Discount_In_Bundle : If Discounts Toggle is set to Discount_In_Bundle , then In-Bundle discount definition is accessible from SM GUI for configuration.
Note : For more details on configuring SM application preferences, see Global Configuration Guide .
Types of discounts Following are the three types of discounts that can be configured in NCC: •ABSOLUTE •PERCENTAGE •OVERRIDE Discounts are applied to subscription activation fee or subscription renewal fee.
Discount is attached to a device or group as a Discount Instance .
The service providers can configure multiple discounts for the same device or group.
Discount entity has non-mandatory attributes that are used as default values and Discount ID or Name is used as a reference while creating discount instances.
Discount Priority Discount priority is applicable to both Standalone (legacy) and In-Bundle discount types.
Based on different discount types and combinations of (PERCENTAGE, ABSOLUTE and OVERRIDE ), the following rules are defined for Priority: •If both PERCENTAGE and ABSOLUTE discounts are configured and active, then all PERCENTAGE type discounts are applied before the absolute discounts are applied.
•The PERCENTAGE discounts take place in a certain order, discounts are applied in order of their size,starting with the largest discount first.
If the result is negative, then the renewal fee should be set to zero.
•Sort discount based on priority (decreasing order) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1371Charging User Guide Charging configuration (new GUI) •Execute the highest priority discount first and then in sequence least priority will be executed last •If the priorities are equal between discounts (PERCENTAGE, ABSOLUTE and OVERRIDE) then the sequence of order will be first PERCENTAGE, next ABSOLUTE, and then OVERRIDE.
Note : Existing behavior remains the same.
PERCENTAGE discounts take place in a certain order, discounts are applied in order of their size, starting with the largest discount first.
If the result is negative, then the renewal fee should be set to zero .
•This option is Optional for Standalone (legacy) discount type, and Mandatory for the In-Bundle discounts.
•The discount logic takes place before applying proration and taxation on the bundle charge fees.
•Discounts are applied to devices or groups independent of when the group or device is subscribed to a bundle and must be maintained separately from bundles for a device or group.
•Multiple discounts for the same device or group and bundle can be configured.
Discount configuration Log into the SM GUI, navigate to Charging → ☰ Catalog Management → Discounts .
To add a new Standalone discount, click and configure the discount parameters described in the following table: Figure 61: Standalone (legacy) Discount Parameters for Standalone (legacy) discount Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1372Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Name This parameter indicates the unique name of the discount.String Mandatory Description This parameter describes the discount.
String Optional Priority This parameter indicates the priority of the discount.
Lower the number, higher the priority.Integer Optional Click ADD START DATE & TIME to add the following detail: Start Time This parameter indicates the date and time from which this discount is applicable.
Note : The Start Time can be null, which means that this discount is applicable from the moment it is created.Long Optional Click ADD END DATE & TIME to add the following detail: End Time This parameter indicates the date and time till which this discount is applicable.
Note : The End Time can be null, which means that this discount is applicable up to indefinite time.
If the End Time is not null, then it is greater than the current time and start time.Long Optional Discount details Fee type The available fee types are as follows: •Activation Fee •Renewal fee Note : At least one fee type should be selected.- Mandatory Activation Fee If this checkbox is selected, then activation fee discount parameters should be configured.Checkbox Optional Renewal fee If this checkbox is selected, then renewal fee discount parameters should be configured.Checkbox Optional Discount type The available discount types are as follows: •Percentage discount •Absolute discount- MandatoryTable 110: Parameters for standalone discount Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1373Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional •Override fee Percentage discount Indicates that the activation fee discount value is in percentage.Optional Absolute discount Indicates that the activation fee discount value is in Big decimal format.Optional Override fee Enables the operator to configure a discounted fee which overrides the activation fee for bundles attached to the discount.Optional Number of discounted periodsIndicates the maximum number of times a discount can be applied.
If a value is not specified, then it denotes unlimited renewals can take place.
This parameter is available only when Renewal fee check box is selected.Value range: 1 <Integer> and blank as UnlimitedOptional Discounted services Click +SELECT to select a service.Table 110: Parameters for standalone discount (continued) Actions associated with a standalone discount Action Description Create Creates a discount entity in database by providing values for mandatory and optional parameters.
Read Displays a discount entity as per the data retrieved from the database.
Update Updates a particular discount entity in the database.
Delete Deletes a particular discount entity from the database.
Note : The preceding actions are valid only for internal purposes and cannot be accessed using the SM GUI.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1374Charging User Guide Charging configuration (new GUI) Discount instance Discount instance is the instance of discount entity and is attached to subscribers.
It has the entityType and entityId to identify the subscriber to which it is applicable.
Discount instances are visible on SM GUI under the Device Overview or Group Overview depending whether the discount is attached to a device or group.
Eligible discount instances All discounts have a start date or end date, and the time defined when they are added to a device.
1.If a start date and time is defined, then the discount does not apply until the current time is on or after the start date and time.
Similarly, if an end date and time is defined, then the discount does not apply after the current time is after the end date and time.
2.If no start date and time are defined, then the discount is immediately available when it is applied to a device.
Similarly, if no end date and time is defined, then the discount remains available and never expires.
Discount of the discount instance is applied when the bundle name of the subscription matches with the bundleName of the discount instance.
Earlier, only a single bundle could be linked to an account, but now, multiple bundles can be associated.
Configuration Log into the SM GUI, navigate to Subscriber Manager and select either DEVICES tab or GROUPS .
Select the device or group to which you want to add the discount.
Click to add a discount instance to a device or group.
To add a new discount, click and add the basic details as described in the following table: Note : When we create a discount instance, select the discount name and it auto-populates the values from Discount Definition entity.
Parameter Description Options Mandatory/ Optional Discount Definition Name This parameter indicates that it is instance of the given discount definition name.String Select the required discount name from the predefined drop- down list of discount definition names.Conditional (mandatory while adding discount instance in subscriber else optional)Table 111: Parameters for discount instance Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1375Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Description This parameter provides an optional description of the Discount.String Optional Entity Type This parameter indicates the subscriber type to which discount instance is attached.
Supported values are as follows: •DEVICE •GROUP Note : This parameter is not visible on SM GUI.Enum Mandatory Entity Id This parameter indicates the subscriber id to which discount instance is attached.
Note : This parameter is not visible on SM GUI.String Mandatory Bundle Name This parameter indicates the name of the bundle to which the discount applies.String Auto populated ( read- only) Bundle Fee Discount Type This parameter indicates the discount type applicable to the bundle fee.
Supported values are as follows:Enum Conditional Either bundle FeeDiscount Type or renewal Discount Type must not be None,Table 111: Parameters for discount instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1376Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional •NONE : Indicates that the bundle fee discount' s value must be null and discount is not applicable.
•PERCENTAGE : Indicates that the bundle fee discount' s value must be in percentage.
•ABSOLUTE : Indicates that the bundle fee discount' s value is in Big decimal format.
Discount value is same as bundle Fee Discount.
•OVERRIDE : Enables the operator to configure a discounted fee which overrides the bundle fee or renewal fee for bundles attached to the discount.
Default value is NONE .both cannot be None, both can be non- None Bundle Fee Discount This parameter indicates the value of the discount applied to the bundle fee.Big Decimal Conditional Either bundle FeeDiscount or renewal Discount must be non- null, both cannot be null, both can be non- null Renewal Discount Type This parameter indicates the discount type applicable to renewal fee.Enum Conditional Either bundle FeeDiscount Type or renewal Discount Type must be not None ,Table 111: Parameters for discount instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1377Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Supported values are as follows: •NONE : Indicates that the renewal discount' s value must be null and discount is not applicable.
•PERCENTAGE : Indicates that the renewal discount' s value must be in percentage.
•ABSOLUTE : Indicates that the renewal discount' s value is in Big decimal format.
•OVERRIDE : Enables the operator to configure a discounted fee which overrides the bundle fee or renewal fee for bundles attached to the discount.
Default value is NONE .both cannot be None, both can be non- None Renewal Discount This parameter indicates the value of the discount applied to the renewal fee.Big Decimal Conditional Either bundle FeeDiscount or renewal Discount must be non- null, both cannot be null, both can be non- null Discounted Periods Indicates the maximum number of times a discount can be applied.
If a value is not specified, then itValue range: 1 <Integer> and blank as UnlimitedTable 111: Parameters for discount instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1378Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional denotes unlimited renewals can take place.
Discounted Periods RemainingIndicates the current value of remaining discounted periods.Value range: 1 <Integer> and blank as Unlimited Discount Priority This parameter indicates that the discounts shall be applied based on the sequence of order defined on the discounts as Priority.Valid range: 1 to 2147483647Conditional For In Bundle discounts = Mandatory For Legacy ( standalone) discounts with default priority set to 99999 = Optional Start Time This parameter indicates the date and time from which this discount is applicable.
Note : The Start Time can be null, which means that this discount is applicable from the moment it is created.Long Optional End Time This parameter indicates the date and time till which this discount is applicable.
Note : The End Time can be null, which means that this discount is applicable up toLong OptionalTable 111: Parameters for discount instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1379Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional indefinite time.
If the End Time is not null, then it is greater than the current time and start time.Table 111: Parameters for discount instance (continued) Actions associated with a discount instance Action Description addSubscriber Discount Creates a discount instance and adds it to a device or group.
During a discount instance creation, all the values get copied from discount definition present in DB unless they are passed in the request, then they get overridden.
update Subscriber Discount Updates a particular discount instance entity in the database.
•discounted Periods Remaining can be updated using this API and cannot exceed the discounted Periods .
•If in API the discounted Periods Remaining value is greater than discounted Periods , the API shall display the following error message- discounted Periods Remaining cannot exceed discounted Periods.
remove Subscriber Discount Deletes a particular discount instance from the database and removes its reference from a subscriber/ entity.
•When Standalone discount is removed from the GUI or API, the instance shall be removed from the device.
•In-Bundle discount instances are not allowed to be removed from the device as it may create data inconsistency.
•In-Bundle discount instance can be removed from Delete Subscription API.
remove AllSubscriber Discount Deletes all discount instances and its reference from the subscriber on the basis of given subscriber details and discount definition name.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1380Charging User Guide Charging configuration (new GUI) Action Description •When Standalone discount is removed from the GUI or API, the instance shall be removed from the device.
•In-Bundle discount instances are not allowed to be removed from the device as it may create data inconsistency.
•In-Bundle discount instance can be removed from Delete Subscription API.
Note : The preceding actions are applicable only as REST API and not supported using the SM GUI.
Discount logic during subscription creation and renewal Discounts are applied on a per group or per device level to a specific bundle subscription or bundle renewal fees, and applies the logic through the following actions: 1.Subscription Creation : For each subscription ID per device or group, a bundle fee discount is applied to the initial subscription fees when a new bundle is added to a device.
The discount is either defined as fixed amount or as a percentage of the standard subscription fee of the bundle.
2.ChargeFeeAction : For each subscription ID per device or group, a bundle fee discount is applied when an entity is a subscription instance and the current state is the initial state only.
3.RenewalSubscriptionActionPer : For each subscription ID per device or group, a renewal discount is applied to the bundle renewal fee applied whenever the bundle is renewed during BCR processing.
This discount is either defined as a fixed amount or as a percentage of the standard renewal fee of a bundle.
Discount audit When a discount instance expires, which means the end time of discount instance has surpassed the current date, an action (if configured) is invoked to check the expiry status of entity instances and delete those instances that expired after a given period of time.
The action is configurable through lifecycle REST API or SM GUI, and it takes the interval as a parameter: •Action name: DeleteExpiredEntityAction , attributes are: –allowEventBroadcast : Boolean –interval : Integer interval is not mandatory, its unit is in hours.
By default, the value is 0.
•Success Event name: DeleteExpiredEntitySuccessEvent , the attributes are: –acceptBroadcastMsg : Boolean Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1381Charging User Guide Charging configuration (new GUI) With this action and when the interval is set, the discountInstances are automatically deleted after meeting the following condition endTime + interval < current-time.
In-Bundle discounts Definition •In-Bundle discounts which are defined as those which are created like a bundle with no charging logic.
•These discounts are created with entity lifecycle and have their own lifecycle.
•Discounts have optional maximum instances to be created.
•These discounts can be defined with multiple eligible bundles which can receive the discount.
•These discounts can have start date and end date which is an optional parameter.
•The discount definition provides different types of discounts on renewal fee and activation fee on the eligible services.
–Absolute –Percentage –Override •These discounts have discounted periods which indicates maximum number of times a discount can be applied.
If a value is not specified, then it denotes unlimited renewals can take place.
•When the In-Bundle discounts are subscribed, discounted periods remaining counter will be available which indicates the count of remaining discounted renewals •If these discounts are set in the discount definition.
For example: If Discounted periods = 10 Number of successful discounted renewals = 10 After each successful renewal, the count will decrease and when the count is 1, no further discounts will be applied •For each successful renewal, remaining count will be decremented exception if the fee after discount applied is 0 or negative, then no further discount is processed.
•These discounts have mandatory parameter priority which enables the user to create discounts with priority.
Priority is considered only if one or more discount is active on the subscriber.
•Default behavior is followed in case of multiple discounts which are active on the same subscription.
Then NCC apply discounts till the fee goes either 0 or below 0 (negative balance).
–The remaining discounts are skipped for execution and are not applied.
If the discounts are skipped then that remaining discount period will not be deducted.
–If the fee is negative, fee is always considered as Zero , which is a fully discounted amount.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1382Charging User Guide Charging configuration (new GUI) Note : Multiple instances of the same discount is currently not supported.
Figure 62: In-Bundle Discount In-Bundle discount Configuration To configure In-Bundle discount, set the SM application preference Discount Toggle to Discount_In_Bundle .
Configure the following parameters in addition to the parameters described in Parameters for standalone discount table.
Parameters for In-Bundle discount Parameter Description Options Mandatory/ Optional Lifecycles Entity Lifecycle This parameter describes the discount.
Enum Optional Activation Type This parameter indicates the name of the bundle to which the discount applies.
Bundle can be linked to more than one discount.String Select the required bundle from the predefined drop- down list of bundlesMandatory Auto- manage This parameter indicates whether the service ( bundle) is an auto- manage bundle.
If this parameter is enabled, then the service ( bundle) is eligible for automatic synchronization.Toggle OptionalTable 112: Parameters for In-bundle discount Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1383Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional By default, this parameter is disabled ( not eligible for automatic synchronization) .
For more details on automatic service ( bundle) synchronization, see Auto- synchronization of services ( bundles) on page 1366 .Table 112: Parameters for In-bundle discount (continued) Actions associated with In-bundle discount definition Action Description Create Creates a discount entity in database by providing values for mandatory and optional parameters.
In this, discount is associated with the discount definition, when the bundle is created.
Read Discount information is read and fetched from discount definition.
When executed, this action displays the discount names associated with the bundle.
Update The In- Bundle discount is updated in the discount definition.
Delete The action processes the delete request for the discount.
Publish The action publishes the discount definition created.
Unpublish The action makes the created discount definition unpublished.
In-Bundle Discount Provisioning Action Description Create Creates discount instance.
/services/ServiceManager/subscriber/create/ Subscription_v1 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1384Charging User Guide Charging configuration (new GUI) Action Description Get Gets discount instance.
/services/ServiceManager/subscriber/getData/ Subscription Delete Deletes discount instance.
/services/ServiceManager/subscriber/delete/ Subscription 5.5 Charging Management 5.5.
1 Charging Logics (Charging Services) Attention : When a charging logic is published to ME, it takes a few seconds until it's effective on the ME side.
The correct procedure is to publish the charging logic immediately at a future date (for example, midnight 00:00:00 of the next day).
For testing, the charging logic is published with effective date = current time (in this case, + 30 seconds until it is effective).
The charging logics (charging service) is an encapsulation of resources, such as buckets and counters, and charges or rates.
It is the fundamental unit of service offered to subscribers.
It defines the method and amount used to charge for a service consumed by the subscribers.
For example, a charging logic (charging service) is defined for a subscriber to apply a rate plan based on the subscriber location and time of day.
The given relations are associated with the sub-components of the charging logic (charging service): •A charging logic (charging service) can contain multiple tariff definitions or references.
•A charging logic (charging service) can contain zero or more bucket definitions.
•A charging logic (charging service) can contain zero or more counter definitions.
Note : It is not recommended to change bucket name or counter name in the charging service when a subscription is attached with a device or group using the charging service.
The non-admin users cannot see the withdraw option to withdraw a charging logic or a service.
Charging logics versus Charging Services A Charging Service (CS) is maintained on SM and is provisioned to ME, to define a charging configuration.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1385Charging User Guide Charging configuration (new GUI) A Charging Logic (CL) is a super-set of a Charging Service, to support the design-mode of the GUI.
The Charging Logic is maintained on the SM only.
A Charging Service is derived from the Charging Logic for provisioning to ME.
A CS or CL can be created or updated using the REST API to SM.
The corresponding entity is automatically created or updated.
In case of CS, the CL generated uses code mode which re-packages the tariff rules.
Note that the design mode is available only for CLs created using GUI.
Sorting mechanism for charging services For charging a call, all charging logics (charging services) accessible to a device are sorted based on following criteria: 1.Logic categories (category consumption order) 2.Subscription index: This can be either set to Device_First or Group_First .
If a device is attached to multiple groups, for example, Group 1, Group 2, Group 3, then order of groups is considered based on their association with the device.
If the association order of groups is Group 2, Group 3, Group 1, then this order is followed while sorting charging logic (charging services).
3.Hierarchy order defined: This can be either set to Top-Down or Bottom-Up .
The hierarchy order of the top-most group in the hierarchy is considered.
4.Charging logic (charging service) priority: Lower the number, higher the priority.
If two charging logics (charging services) have same priority, then the next priority criterion is selected, such as creation date or expiry date.
5.Charging logic (charging service) instance creation or expiry date.
If the same service (bundle) is purchased twice, then the service (bundle) is selected based on the next priority criterion.
The charging logic (charging service) instance selection criteria can be one of the following criteria based on your requirement: •Charging logic (charging service) instance creation date: Implies that the service (bundle) created or purchased first is consumed first.
•Charging logic (charging service) instance expiry date: Implies that the service (bundle) with earliest expiry date is consumed first.
- If both end time (for periodic lifecycle) and validity time (for entity lifecycle) are available for the subscription, then the minimum of both values is considered.
- If the subscription has an end time but no validity time, then the subscription end time is considered.
- If the subscription has a validity time but no end time, then the subscription validity time is considered.
- If the subscription does not have an end time, then the account end time is considered.
- If the subscription does not have an end time and validity time, and also account does not have an end time, then the subscEndTime parameter in the subscription entity is set to Null.
While sorting, if the subscEndTime is set as Null, then that subscription is used at the end.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1386Charging User Guide Charging configuration (new GUI) Note : If the values of all the listed criteria are same, then the criteria that comes first is used for sorting the charging logics (charging services).
Configuration to sort CS based on creation or expiry date Configure the required value for the following ME application preference: Note : For details on configuring the ME application preferences, see Managed Elements section in Global Configuration Guide .)
Application preference Description CS Selection Order This parameter allows you to sort the charging service based on creation time of subscription or end time of a subscription or account when both charging services have same priority ( considering all charging service sorting mechanisms are same for both the charging services) .
Following are the supported values for this parameter: •ON_ CREATION_ TIME : If you select this value, then the charging service is sorted based on the creation time.
•ON_ END_ TIME : If you select this value, then the charging service is sorted based on end time or validity time of subscription or end time of account, whichever is applicable.
Default value is ON_ CREATION_ TIME .
Fair usage policy override NCC allows operators to override the Fair Usage Policy (FUP) properties while creating a charging logic.
To override the values in create/update/provision Charging Logic APIs, a field fairUsagePolicies can be used.
It is a list of fair usage policies.
For each FUP in the charging logic that the user wishes to provide overridden values, an item should be added to this list.
However, if the user is using the values from the FUP definition, then you should not add an item.
FUP is a counter with a threshold.
With every FUP definition, there is an internal threshold with the same name.
It is hidden in the GUI, as it is intended to be used exclusively with its FUP.
When we override the FUP in the charging logic, a new internal threshold is created and is used only in association with this charging logic.
The ID for this threshold is generated concatenating the following parts: FUP name, special delimiter "+F+", Charging logic ID.
For example, "Fup1+F+CL1".
These are hidden in the GUI too.
Configuration This section describes the parameters to define a rate charged against a call.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1387Charging User Guide Charging configuration (new GUI) Note : A charging service can have zero or more counter objects in it and the list is optional.
If a counter is included in the list, then all the other counter object parameters except the threshold and category consumption list, such as unit type, scope, type become mandatory.
Log into the new GUI, navigate to Charging → ☰ → Charging Logics .
To define a new charging logic (charging service), click and select whether you want to create a Data, Messaging, or Voice and configure the parameters given in the following table: Parameter Description Value type Mandatory/ Optional APPLICABILITY RULE : Limit service availability and applicability with conditions.
You can filter applicability with network, session, subscriber and date and time criteria.
Conditions Charging condition : This parameter indicates a rule condition expression evaluated to determine whether the charging logic is applicable.
The type of charging service can be identified by Kind OfUnit provisioned in the applicability condition.
Since the charging service entity does not have any attribute Unit- Type , the call common context attribute Kind OfUnit should be configured to identify the same.
For example: Kind OfUnit can either be TIME, VOLUME, MONEY, or UNIT.
Though applicability condition is not a mandatory parameter, however, to provide the charging service as a unit type, Kind OfUnit should be used.
CAUTION : Keep condition name same as the charging logic name.
This ensures appropriate ( and uninterrupted) functioning of charging logic creation and applicability.
Note : The given example is only for reference.String Optional CHARGING RULES : Use rules to define charging and conditional actions for the service.
Service rules are evaluated in priority order.
Note : You can select the Use Advanced Mode or Design mode to configure rules.
Rule This parameter indicates the rule name.
String Optional Secondary charging This checkbox splits the charging rule into primary and secondary paths.
All the components are allowed for the primary path but only Rate, zero- rate, custom counter, and Allowance Limit are allowed for the seconday path.
Metering Limit, and Fair Usage Policy are not supported in the secondary path.Toggle key OptionalTable 113: Parameters for charging logic Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1388Charging User Guide Charging configuration (new GUI) Parameter Description Value type Mandatory/ Optional Components added on the secondary path have a next prefix on the injection rule.
Conditions Charging condition : This parameter indicates a rule condition expression evaluated to determine whether the charging logic is applicable.String Optional Charging This parameter provides the following charging components: •Authorize Use : It has Allowance Limit, Discount, Fair Usage Policy, Rate, Tiered Allowance, Zero Rate.
You can drag and drop these components.
•Custom : It has Custom Counter that you can drag and drop to use.
•Use Metering : It has Metering Limit that you can drag and drop to use.String Actions This displays the actions that are available for use.
You can drag and drop to use it.String Optional FALLBACK RULES : Fallbacks are secondary charging rules applied after all charging rules from all subscriptions have been evaluated in priority order.
PASSES This parameter indicates the passes and each pass contains a single tariff.String Optional Rule This parameter indicates the rule name.
String Optional Secondary charging This checkbox splits the charging rule into primary and secondary paths.
All the components are allowed for the primary path but only Rate, zero- rate, custom counter, and Allowance Limit are allowed for the seconday path.
Metering Limit, and Fair Usage Policy are not supported in the secondary path.
Components added on the secondary path have a next prefix on the injection rule.Toggle key Optional Conditions Charging condition : This parameter indicates a rule condition expression evaluated to determine whether the charging logic is applicable.String Optional Charging •Authorize use •Custom •Use meteringTable 113: Parameters for charging logic (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1389Charging User Guide Charging configuration (new GUI) Parameter Description Value type Mandatory/ Optional Actions •test LOGIC DETAILS Name This parameter indicates the name of the charging logic.
String Mandatory Description This parameter indicates the description of the charging logic.
String Optional Category This parameter indicates the category associated with the charging logic.
The default value is Default Category .Select the required category from the predefined categories in the drop- down list.Mandatory Priority This parameter indicates the priority of the charging logic.
Higher the number, lower is the priority of the charging logic.
Multiple charging logics can have same priority.
Note : Ensure that the value of this parameter is greater than zero.Integer Valid range: 1 to 2147483647Mandatory clTranslation Flag This flag indicates whether to create a charging logic entity when creating a charging service.
Setting this to true has following impact: •You can only view/ edit charging logics in GUI, not charging services.
•If buckets/ counters are created as part of charging service, they are created as global ( allowed to be referenced by other charging services) .
Note : This parameter is not visible on GUI and can be set using API only.Boolean, input only, used in create APIOptional ( default is false - do not create Charging Logic) .
This is for full backward compatibility but it is recommended to set this flag to true.
Publish Version Publish To This provides a list.
Operators can publish to All subscribers and so on.Enum Mandatory Activation Time The supported values are as follows: •Activate Now : If this is selected, then the charging logic is activated immediately.
•Schedule Activation : Operators can schedule activation to a future time using this option.Enum MandatoryTable 113: Parameters for charging logic (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1390Charging User Guide Charging configuration (new GUI) Parameter Description Value type Mandatory/ Optional Publish Type The supported values are as follows: •Normal : If this is selected, then no action is taken and the processing happens as per the defined logic.
•Retroactive update : If this is selected, then the forced Versioning attribute is set in the API and the update is immediately applied.Enum MandatoryTable 113: Parameters for charging logic (continued) Configuring rates based on counter's threshold NCC provides design mode in the GUI for operators to configure the rates based on counter's threshold.
Operators can perform the following steps for configuration: 1.Create a custom counter.
2.Create a charging-logic as follows: a.Drag and drop a custom counter or metering limit component onto canvas.
b.Select the created counter definition.
c.Select the Rate selection from side panel.
d.Add the threshold values and associated Rate IDs.
On submitting the preceding configuration, the SM server manages the creation or update of Threshold Profile Group (TPG) with the given thresholds and association of TPG to the counter.
On publishing, the entities are published automatically that can be referenced by the provisioned charging-logic.
If an operator selects split charging, then the charging section of the canvas splits into primary and secondary columns, and components can be dropped into the secondary column.
The same set of thresholds apply to both primary and secondary columns, but the rates are selected separately.
The rate selection side panel provides input fields for primary and secondary rates.
The following actions can be performed for the components added into the canvas: Note : To perform these actions, click icon available in the components added into the canvas.
•Duplicate : It duplicates the selected component.
•Reset : It resets the component to its initial state.
•Remove : It removes the selected component from the canvas.
The components that are dropped into the canvas can be cleared by clicking clear canvas ( ) icon.
Note : Upon clicking clear canvas icon, a confirmation dialog box appears as shown in the following image: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1391Charging User Guide Charging configuration (new GUI) Actions associated with a charging logic (charging service) The Charging logic create API is: /services/ServiceManager/create/ChargingService and publish API is: /services/ServiceManager/provision/ChargingService .
Action Description Create Creates a logic ( charging service) entity in the database.
Read Displays a particular logic ( charging service) entity as per the data retrieved from database.
Update Updates a particular logic ( charging service) entity in database.
Delete Deletes a particular logic ( charging service) entity from database.
Note : These actions are valid for only for internal purposes and cannot be accessed using the SM GUI.
5.5.
1.
1 Versioning Operators can enable versioning for services (logics) using the SM application preference named Entity Versioning Enabled .
Once enabled, you cannot clear it since it has adverse effect on backward compatibility to changes made to data.
When you set the Entity Versioning Enabled preference and make a change, a new draft copy (minor) version is created (example 1.1), which can be published as new major version (example 2.0).
A corresponding application preference ( Versioning Enabled ) must be set in the ME.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1392Charging User Guide Charging configuration (new GUI) You can enable versioning on both SM and ME using the API: /services/ServiceManager/updateSMAndME/SystemParameter See the sample below.
In this, smAttribute and meAttribute values must be set.
{ "distList": [ "ncc-me" ], "avps": [ { "smAttribute": "entityVersioningEnabled", "meAttribute": "Versioning Enabled", "value": true, "property": "WRITE", "category": "", "description": "", "info": null, "type": "Boolean", "values": null, "range": null } ] } The API users can continue using APIs without specifying the concrete version numbers (minor or major).
NCC uses the following approach to provision, unprovision, or delete a versioned entity: •Provision : When you provision a versioned entity without specifying the concrete version number in the request, the highest draft version is picked.
Note that the withdrawn versions are also considered as drafts.
This behavior is same for provisioning as active and test-active.
The affected APIs are as follows: –services/ServiceManager/provision/ChLogic –services/ServiceManager/testProvision/ChLogic –services/ServiceManager/publish/ChLogic –services/ServiceManager/testPublish/ChLogic –services/ServiceManager/provision/ChargingService –services/ServiceManager/testProvision/ChargingService •Unprovision : When you unprovision a versioned entity without specifying the concrete version number in the request, the highest version among the active and test-active versions is picked.
The affected API is services/ServiceManager/withdraw/ChLogic .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1393Charging User Guide Charging configuration (new GUI) •Delete : When you delete a versioned entity without specifying the concrete version number in the request, the highest draft version is deleted.
Note that when the highest version is Active, an exception is thrown.
The affected APIs are: –services/ServiceManager/delete/ChLogic –services/ServiceManager/delete/ChargingService CAUTION : You must set ME application preference named Versioning Enabled for the versioning to work as expected.
If the ME application preference is not set, then the versioning is not enabled for logics (charging services).
Trigger lifecycle : A lifecycle must be triggered to update the subscription with latest version.
Following is the API to trigger lifecycle event: { "entityType": "com.nokia.tpapps.servicemodel.model.Subscription", "entityId": "{{subscriptionId}}", "meName": "sps-me", "lifeCycleType": "PERIOD", "triggerEvent": "RepeatCycleEvent" } Pre-requisites applicable for following scenarios: •The versioning flags must be enabled.
•A lifecycle that has RenewSubscriptionAction is called upon an event.
•Bundle or Account must have a lifecycle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1394Charging User Guide Charging configuration (new GUI) No Scenario Previous behavior Current behavior Configuration 1 Create a new version of the Ch Logic, then Trigger Lifecycle Event To Renew Subscription.A new Subscription is created having the new Charging Logic values.
The current subscription is moved to final state.The current subscription contains the new values of new version of the Ch Logic.Use the services/ Service Manager/ create/ ChLogic API to create a new version of Ch Logic and trigger LC Event to Renew Subscription.
Provision the Ch Logic.
After BCR, the new values of the subscription are the new values in the new version.
2 Create a new version of the Protected ChLogic, then Trigger a Lifecycle Event to renew subscription.No version protect feature.
The subscription has the values of the version that is used to create the subscription.
This means that the subscription is not updated to the new version of the Ch Logic.Create a service with Protected version settings using the create bundle API with following block in request body: "version Settings": { "version ProtectType": " PURCHASE_DATE" }, Repeat same steps as in case 1.
After BCR, the subscription values are not changed because the Ch Logic is related to a bundle which has a protected version setting.
3 Create a new version of Ch Logic while the Allowance Limit/ Counter is updated temporarily for two periods.A new subscription is created with new Charging Logic values.
The temporary values are not considered.
The current subscription is moved to final state.The subscription is updated with new Charging Logic values.
The allowance Limit/ Counter is updated according to the temporary update.
If it was set to INC/ DEC, then this will be on top of the version updated values.
If it was SET, then the API Allowance limit/ Counter value take effect instead of the versioning values.
After the two periods, the version Allowance limit value is taken as the new value from the latest version of Ch Logic.Update the bucket instance or counter instance values temporarily for two periods using the update subscription API: /services/ ServiceManager/ subscriber/ update/ Subscription .
Create a new version of Ch Logic and trigger lifecycle event to renew subscription.
After BCR, the updated values of subscription temporarily is notTable 114: Scenarios Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1395Charging User Guide Charging configuration (new GUI) No Scenario Previous behavior Current behavior Configuration changed, whereas the non- updated values are taken from the new version of Ch Logic.
When the subscription is renewed n times ( where n is the number of periods to keep the temporary change) the values of subscription is taken from the latest version of Ch Logic.
4 Create a new version of Ch Logic while the Allowance Limit or Counter is updated permanently.A new subscription is created with the new Charging Logic values.
The permanent values are not considered in the new subscription.
The current subscription is moved to final state.The subscription is updated with new Charging Logic values.
The allowance Limit/ Counter is updated according to the permanent value.
If it was set to INC/ DEC, then this will be on top of the version updated values.
If it was SET , then the API Allowance limit value take effect instead of the versioning values.Update bucket instance or counter instance values permanently using the update subscription API: /services/ ServiceManager/ subscriber/ update/ Subscription .
Create a new version of Ch Logic and trigger lifecycle event to renew subscription.
After BCR, the updated values of the subscription permanently will not be changed, whereas the non- updated values are taken from the new version of the Ch Logic.
5 Create a new subscription using the Template API, create a new version of Ch Logic, then trigger LC for Renewal.A new subscription is created with the new Charging Logic values taken from the latest version.
The current subscription is moved to final state.The subscription is updated with new Charging Logic values taken from the template API.
The non mentioned value will be taken from the charging Logic version.Create a subscription using the Template API over a service, Ch Logic.
Create a new Ch Logic version and trigger the lifecycle event to Renew subscription.
After BCR, the values of subscription is not changed because they are taken from the Template API, whereas the values that are not provided to the Template API is taken from the latest version.Table 114: Scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1396Charging User Guide Charging configuration (new GUI) Adding/removing components Previously, the new version of the charging logic allowed operators to update some values of the existing components inside a charging logic, but addition or deletion of new components was not allowed.
Currently, NCC allows operators to add/remove the components of the charging logic when creating a new version.
Following are the supported components for addition/deletion: •Allowance limit •Metering limit •Custom counters •Tiered allowance •Fair usage policy •Rate •Zero rate Note : Aggregate views can be attached to a device or group.
When versioning charging logic, the AV instances can be updated immediately or in next BCR.
See Example: Immediate versioning of charging logic with AV in Device on page 1408 .
Removing a component A component (bucket or counter) can be removed in the charging logic's new version.
When a version change is triggered for a subscription that uses the charging logic, the corresponding instances of the removed components are not immediately deleted.
They are marked as expired by setting the deletionTime field.
If the subscription's version type is IMMEDIATE , the deletion time is the version time of the new charging logic in which the component is removed.
If the version type is NEXT_BCR , the deletion time is the BCR time.
The expired components are not used for rating, nor can they be reset.
An expired component gets permanently deleted from the database at a later time.
The History Period parameter decides the time at which the expired component must be deleted.
This parameter indicates the minimum number of days for which the expired components are kept in database.
An expired component is permanently deleted at BCR if BCR time - Deletion time > History Period .
While setting a component as expired, a new item is added to the history list of the component.
The end time of this item is equal to the deletion time.
The relevant values (initial value, current value for bucket, current value, ULI, OLI for counter) are set to the last values before the component was expired and before proration was done.
In the middle of an ongoing charging session, a component can be set as expired while some reservation was already done from it.
In this case, the reservation can be committed as a result of the next CCRU or CCRT requests, but the component is not used for further reservations.
Versioning triggers The addition or deletion of components in the charging logic's new version do not get reflected in the existing subscriptions until an appropriate event triggers the versioning.
Following events can trigger versioning: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1397Charging User Guide Charging configuration (new GUI) •Credit control request (CCR) on the device that owns subscription.
On CCR, the versioning is done only if the subscription's version type is IMMEDIATE .
•Billing cycle reset (BCR).
On BCR, the versioning is done only if the version type is NEXT_BCR , or it is IMMEDIATE but no event triggered versioning until BCR.
•Reset resource action.
Buckets or counters can have an individual lifecycle with Reset Resource Action attached to them.
In case the subscription's version type is IMMEDIATE , this can also trigger versioning on the entire subscription that the bucket or counter instance belongs to.
Note : The latest published active version of the Charging Logic (Charging Service) can be fixed (updated or edited) and re-published.
For more details, see Updating latest published active version on page 1541 .
Proration The proration works for all counters as well as for Allowance limits and tiered-Allowance.
On component (allowance limit/counter) the values for removal can be prorated.
To see proration, you must comply with the following requirements.
•The proration profile must be attached to the subscription.
It should have a Bundle periodic life- cycle(LC), or in case if the subscription has no periodic LC, then by default, monthly LC will be considered from the account.
•The proration profile must have immediate versioning at the Bundle level.
If all these requirements are satisfied and you remove a component within the cycle, the component is prorated.
The following formula calculates the component proration on remove: (remove date - activation date) / period length * initial value remove date is the data-time when the component was removed.
activation date is the date when the component becomes active.
period length is the LC length which can be Monthly, Weekly, Daily.
The smallest supported unit is rounding to the current day.
initial value is the initial value of the component.
In case of counters, it is either overage limit or usage limit.
If there is any consumption or reservation from the component, then after the proration as a result the consumed or reserved amount is subtracted from the initial value.
If you have a case when more values were consumed than values in the initial value field, set them to 0.
Note : All the calculations made are for component instance.
Note that the subscription cancellation and component proration is implemented using the same logic.
Hence, there may be minor differences in calculations between component proration on add/remove/ update and existing subscription proration on activation.
When a user publishes new charging logic within the current lifecycle by adding or removing or updating the components, the initial value is deducted by some percent.
The deductions depend on the following factors: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1398Charging User Guide Charging configuration (new GUI) •Type of operation the user is performing •When an operation was performed •What is the proration profile granularity •Does component has it's lifecycle or not Following are the granularities in proration profiles for add/remove/update operations: •Current Time : Prorates the component by considering the least time unit in minutes.
•Current Hour : Prorates the component by considering the least time unit in hours.
•Current Day : Prorates the component by considering the least time unit in days.
Note that if a component has it's lifecycle (periodic lifecycle), then it is not prorated.
Hence, all the components are aligned to subscription lifecycle, particularly at the end date, all components in the subscription have same end date.
However, note that the component activation time is considered and the component can be activated later or with the subscription.
Consider the following configurations: Component name Configuration Default Subscription Billing Cycle starts on 2022- 03-01 T 00: 00:00 ends on 2022- 04-01 T 00: 00:00 Allowance limit Bckt1 1300- byte Allowance limit Bckt2 3000- byte Charging logic → Chlgc1 Allowance Limit → 1300- byte Account → Acc1 Account Type → PRE_ PAID Time zone → UTC Billing cycle information: •Hour of Day → 0 •Day of Month → 1 •Day of Week → SUNDAY ( by default) Bundle → Bundl1 •Periodical Lifecycle → Default Subscription Billing Cycle •Proration Profile → P1 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1399Charging User Guide Charging configuration (new GUI) Component name Configuration •Charging logic → C1 •Service Fee → 20$ •Update Type → Immediate Note that it does not matter if Bundle has Monthly/Daily/Weekly life-cycles.
NCC converts this life-cycle period length to Proration Profiles granularity.
For example, if a Bundle with monthly lifecycle (LC) has a Proration Profile with Current Hour granularity, then the Bundle LC is converted to hours.
For this example, the Bundle has monthly LC and current date is 2022-03-01 T 00:00:00 .
Assume that there is a device D0 with account Acc1 and subscribe to bundle Bndl1 on 2022-03-01 at 00:00:00.
Following is the device overview.
Device name Initial value D0 1300 bytes range [start date, end date] → means both start date and end date included range [start date, end date] → means only start date included in calculation Proration during addition of allowance limit Assume that you want to add an allowance limit Bckt2 in Chlgc1 on 2022-03-05 at 15:30:40.
The proration calculations depend on each prorate granularity in proration profiles.
The initial values after proration is rounded and in case of bytes its always rounded up to the nearest integer.
Current days : The time is truncated to 12:00 AM.
Subscription cycle lengthComponent cycle lengthProrate factor Initial value after proration range [ 2022- 03-01, 2022- 04-01)=31 daysrange [ 2022- 04-01)=27 days27/31=0.870967442 0.870967442* 2000= 1741.
935483871 rounded to 1742 Current hours : The event time is truncated from 15:30:40 to 15:00:00.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1400Charging User Guide Charging configuration (new GUI) Subscription cycle lengthComponent cycle lengthProrate factor Initial value after proration range [ 2022- 03-01, 2022- 04-01)=31 days 31*24=744 hours2022- 03-05 and left with only 24- 14=9 hours range [ 2022- 03-06, 2022- 04-01)=26 days 26*24=624 hours Total: 624+ 9=633 hours633/ 744= 0.850806452 0.850806452* 2000= 1701.
612903226 rounded to 1702 Current Time : The event time is truncated from 15:30:40 to 15:30:00.
Subscription cycle lengthComponent cycle lengthProrate factor Initial value after proration range [ 2022- 03-01, 2022- 04-01)=31 days 31*24=744 hours 744* 60=44640 minutes2022- 03-05 and left with only 24- 14=8 hours range [ 2022- 03-06, 2022- 04-01)=26 days 26*24=624 hours 624+ 8=632 hours 632* 60=37920 minutes Total: 37920+ 30= 37950 minutes37950/ 44640= 0.
8501344090.850134409* 2000= 1700.
268817204 rounded to 1701 Proration during removal of allowance limit Assume that you want to remove an allowance limit Bckt1 in Chlgc1 on 2022-03-05 at 15:30:40.
The proration calculations depend on each prorate granularity in proration profiles.
The initial values after proration is rounded and in case of bytes its always rounded up to the nearest integer.
Current days : The time is truncated to 12:00 AM.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1401Charging User Guide Charging configuration (new GUI) Subscription cycle lengthComponent is being active until remove dateProrate factor Initial value after proration range [ 2022- 03-01, 2022- 04-01)=31 daysrange [ 2022- 03-01, 2022- 03-05)=4 days4/31=0.129032258 0.129032258* 1300= 167.
7419354 rounded to 168 Current hours : In case of removal, the event date is not truncated and is rounded up from 15:30:40 to 16:00:00.
Subscription cycle lengthComponent is being active until remove dateProrate factor Initial value after proration range [ 2022- 03-01, 2022- 04-01)=31 days 31*24=744 hoursrange [ 2022- 03-01, 2022- 03-05)=4 days 4*24=96 hours Total: 96+ 16=112 hours112/ 744= 0.150537634 0.150537634* 1300= 195.
6989242 rounded to 196 Current Time : In case of removal, the event date is not truncated and is rounded up from 15:30:40 to 15:31:00.
Subscription cycle lengthComponent is being active until remove dateProrate factor Initial value after proration range [ 2022- 03-01, 2022- 04-01)=31 days 31*24=744 hours 744* 60=44640 minutesrange [ 2022- 03-01, 2022- 03-05)=4 days 4*24=96 hours 96+15=111 hours 111* 60=6660 minutes Total: 6660+ 31=6691 minutes6691/ 0.149887993= 0.
8501344090.149887993* 1300= 194.
8543909 rounded to 195 Proration during update of allowance limit Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1402Charging User Guide Charging configuration (new GUI) Assume that you want to update an allowance limit Bckt1 from 1300 to 3000 bytes in Chlgc1 on 2022-03-05 at 15:30:40.
The proration calculations depend on each prorate granularity in proration profiles.
The initial values after proration is rounded and in case of bytes its always rounded up to the nearest integer.
In case of update, the computation is different.
At first, the prorate factor is calculated for previous value and then prorate factor for new value.
After proration is done, both the values are summed up.
Note that the old value is not replaced with new one.
For old component proration, component instance activation time and end time was considered.
In the following example, the component period is same as subscription period to simplify calculation.
Note that for old component prorate factor, the period is taken from component instance and not from subscription.
Current days : The time is truncated to 12:00 AM.
Subscription cycle lengthComponent is being active until update dateOld value prorate factorNew value prorate factorInitial value after proration range [ 2022- 03- 01, 2022- 04-01)= 31 daysrange [ 2022- 03- 01,2022- 03-05]= 4 days4/31=0.
129032258(31-4)/31=0.
8709677420.129032258* 1300= 167.
7419354 0.870967742 * 3000 = 2612.
903226 Updated value : 167.
7419354 + 2612.
903226 = 2780.
6451614 rounded to 2781 Current hours : In case of update, the event date is truncated and is rounded down from 15:30:40 to 15:00:00.
Subscription cycle lengthComponent is being active until update dateOld value prorate factorNew value prorate factorInitial value after proration range [ 2022- 03- 01, 2022- 04-01)= 31 days 31*24=744 hoursrange [ 2022- 03- 01,2022- 03-05]= 4 days 4*24=96 hours 96+15=111 hours111/ 744= 0.
14919358(744- 111) /744= 0.
8508064520.14919358* 1300= 193.
9516124 0.850806452 * 3000 = 2552.
419356 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1403Charging User Guide Charging configuration (new GUI) Subscription cycle lengthComponent is being active until update dateOld value prorate factorNew value prorate factorInitial value after proration Updated value : 2552.
419356 + 193.
9516124 = 2746.
3709684 rounded to 2747 Current Time : In case of update, the event date is not truncated and is rounded down from 15:30:40 to 15:30:00.
Subscription cycle lengthComponent is being active until update dateOld value prorate factorNew value prorate factorInitial value after proration range [ 2022- 03- 01, 2022- 04-01)= 31 days 31*24=744 hours 744* 60=44640 minutesrange [ 2022- 03- 01,2022- 03-05)= 4 days 4*24=96 hours 96+15=111 hours 111* 60=6660 minutes Total 6660+ 30= 6690 minutes6690/ 44640= 0.
149865591(44640- 6690) /44640= 0.
8501344090.149865591* 1300= 194.
8252683 0.850134409 * 3000 = 2550.
403227 Updated value : 2550.
403227 + 194.
8252683 = 2745.
2284953rounded to 2746 Adding a new component Any supported component can be added to the charging logic's new version.
When the version change is triggered for a subscription that uses this charging logic, a new instance for the added component is created along with its threshold profile.
This new instance can be used in future rating events.
When adding a new component on the new version, if the component being added has an expired instance on the corresponding subscriptions, the old instance is re-activated with the new values and the old history.
It can be used for future rating events, and its old values still can be used for the late ratings.
After adding/removing components in the subscription, all the AV instances attached to the device/group are refreshed to reflect these changes.
The expired components are excluded from AV instances.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1404Charging User Guide Charging configuration (new GUI) The deletionTime component is used in the SM APIs that can return components instances data.
The following are the APIs that was supported to return the deletionTime : Method Description URL Get Read Group /subscriber /update /Group Get Read Subscription /subscriber /getData / Subscription Get Read Device /subscriber/ getData/ Device Get Read Account /subscriber/ getData/ Account Get Read User /subscriber/ getData/ User Get Read Entity Counter instance /subscriber/ getData/ Entity Counter Instance Get Read Bucket instance /subscriber/ getData/ Bucket InstanceTable 115: API changes Proration The values added to the component can be prorated.
To see proration, you must comply with the same requirements mentioned for removing a component case.
The following formula calculates the component proration on add: (component activation date - period start date) / period length * initial value component activation date is the date when the component became active.
period start date is the LC start date.
period length is the LC full length (in days).
initial value is the initial value of the component.
In case of counters, it is either overage limit or usage limit.
On addition of component, an instance is created per already prorated initial value.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1405Charging User Guide Charging configuration (new GUI) Bucket instance decrement scenario In case of immediate versioning feature, a new version of a charging logic can update the values of an existing bucket instance in the middle of a cycle.
This can happen in the following cases: •Override the bucket initial value in the charging logic new version.
•Remove the bucket from the charging logic or remove a charging logic from a bundle.
If a proration profile is configured, then the bucket values are prorated upon removal.
In both the cases mentioned, the intial value is updated, the unused and current values are adjusted accordingly.
In case of immediate versioning, the initial value is decremented, but the new initial value cannot cover (is less than) an active reservation.
For example: Initial value Unused value Current value Actual 100 80 10 Previous - - - The preceding table shows the state of the bucket instance.
There is a pending total reservation of 70 units.
With versioning, the new initial value is 50, but it cannot cover the 70 reservation.
This case is handled as follows: •The actual values are copied to previous values.
•The initial value is set to the new initial value.
•The unused value and current value is set to 0.
Initial value Unused value Current value Actual 50 0 0 Previous 100 80 10 The old reservations are committed or canceled from previous values.
For example, if a request is received to commit 10 out of 70, it is done from previous values.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1406Charging User Guide Charging configuration (new GUI) Initial value Unused value Current value Actual 50 0 0 Previous 100 70 70 However, the end user received only 30 units of 50.
Hence, the remaining 20 is passed back to actual values and can be used for future reservations.
The final state of bucket is as follows: Initial value Unused value Current value Actual 50 20 20 Previous 100 70 70 Limitation: The bucket instance previous values are used to commit reservations done before subscription reset.
To avoid conflicts between these two cases, the immediate versioning is skipped for the subscription altogether if any of following conditions is true: •[Current Time] - [Subscription's last reset time] < [Validity time of the active slicing profile] •[Subscription's upcoming reset time] - [Current Time] < [Validity time of the active slicing profile] In other words, the immediate versioning is skipped if the subscription's current period's start and end dates are too close to the versioning time.
Versioning of allowance limit carry-over properties The carry-over allowance limit has following properties: Currently, NCC allows versioning of these properties.
That is, in the new charging logic versions, any changes to these values are reflected on the existing bucket instances.
Irrespective of the version type Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1407Charging User Guide Charging configuration (new GUI) being IMMEDIATE or NEXT_BCR on subscription renewal the carry-over amount will be distributed according to the new values.
Example: Immediate versioning of charging logic with AV in Device Note that, for immediate versioning of charging logic with AV in device with version protect enabled, then after publishing the new version and consuming from each subscription, the AV instance keeps the previous versions intact.
Consider that a CHARGING_SERVICE AV and COUNTER AV instances in device have multiple subscriptions.
A new version of charging logic is created.
After publishing the new version and consuming each subscription, the AV instance gets updated according to the new versions.
Following is the configuration for this use case: 1.Create and distribute AV of type CHARGING_SERVICE and set the charging services for it to follow.
2.Create and distribute AV of type COUNTER set to subscription counters.
3.Create a new version of charging logic and update the allowance limit Initial Value for the charging logic.
4.Execute a charging call to activate the immediate versioning.
Expected result : AV shows the updated value of Allowance limit according to the new version, with deductions applicable for the charging call.
5.5.
1.2 Updating latest published active version (charging logic) Backdating of charging logic The latest published active version of a charging logic (charging service) can be fixed (updated or edited) and published.
The fixed version of the latest published active version is called a Patch Fix or Backdated Fix .
The effective date of the Patch Fix is same as that of the latest published version, regardless of when the Patch Fix is published.
Note : For more details on Patch Fix , see Updating latest published active version on page 1541 .
The following components in Charging Logic (Charging Service) can be updated to create a patch fix of the latest published active version of Charging Logic (Charging Service) : •FUP : For more details, see Fair Usage Policies on page 1449 .
•Rate : For more details, see Rates on page 1450 .
•Custom Counter and Metering Limit : For more details, see Custom Counters and Metering Limits (Counters) on page 1433 .
•Tiered Allowance : For more details, see Tiered Allowances (Charging Step) on page 1458 .
•Allowance limit : For more details, see Allowance Limits (Bucket) on page 1419 .
The Charging Logic (Charging Service) attributes can also updated while creating a patch fix.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1408Charging User Guide Charging configuration (new GUI) Creating a patch fix A patch fix can be created only for a latest published active version.
The procedure to create a patch is as follows: 1.Go to the latest published active version, and click .
Select Edit active version .
Edit Active Version dialog box appears as show in the following image: 2.Click EDIT .
3.Edit the components or attributes of the latest published active version, and save the updates.
A patch fix is created.
4.To update the patch fix, click (Update published version) icon.
Update published version dialog box appears as show in the following image: 5.Click UPDATE .
The patch fix is published and it overrides (replaces) the previous version.
6.To create a new patch fix, click , and edit the latest published active version.
Note : This option is visible only after the first patch fix is updated.
Deleting a patch fix 1.To delete a patch fix, click against the patch fix as show in the following image: 2.Select Delete .
The patch fix is deleted.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1409Charging User Guide Charging configuration (new GUI) Note : The patch fix can be deleted only when it is in DRAFT state.
When a patch fix is published, the option to delete it is disabled.
5.5.2 Balance Logics Configuration Log into new GUI, and navigate to Charging → ☰ → Balance Logics .
To define a new balance, click and provide the details as described in the following table.
Parameter Description Options Mandatory/ Optional APPLICABILITY RULE : Limit service availability and applicability with conditions.
You can filter applicability with network, session, subscriber and date and time criteria.
Note : You can select the Use Advanced Mode or Design mode to configure the balance.
BALANCE DETAILS Name This parameter indicates the unique name for the balance.
String Mandatory Description Description of the balance.
String Mandatory Balance consumption orderThis parameter indictes the order in which the balance is used up.
By default, it is set to Before main balance .String Mandatory Balance This parameter must have numeric value only.
The minimum value is 0.
Note : Balance supports a precision of 5 decimal digits.Digit Mandatory Unit This parameter specifies the balance unit.
It has the following values: •Cent •Euro •MoneyEnum Mandatory Priority This parameter indicates the priority of the balance.
Higher the number, lower is the priority of the balance.
Note : Ensure that the value of this parameter is greater than zero.Integer Valid range: 1 to 2147483647MandatoryTable 116: Parameters for a balance logic Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1410Charging User Guide Charging configuration (new GUI) 5.5.2.
1 Updating latest published active version (balance logics) Backdating of balance logic The latest published active version of a balance logic can be fixed (updated or edited) and published.
The fixed version of the latest published active version is called a Patch Fix or Backdated Fix .
The effective date of the Patch Fix is same as that of the latest published version, regardless of when the Patch Fix is published.
Note : For more details on Patch Fix , see Updating latest published active version on page 1541 .
The Balance Logic attributes or components can be updated to create a patch fix of the latest published active version of Balance Logic : Note : For more details on Balance Logics , see Balance Logics on page 1410 .
Creating a patch fix A patch fix can be created only for a latest published active version.
The procedure to create a patch is as follows: 1.Go to the latest published active version, and click .
Select Edit active version .
Edit Active Version dialog box appears as show in the following image: 2.Click EDIT .
3.Edit the components or attributes of the latest published active version, and save the updates.
A patch fix is created.
4.To update the patch fix, click (Update published version) icon.
Update published version dialog box appears as show in the following image: 5.Click UPDATE .
The patch fix is published and it overrides (replaces) the previous version.
6.To create a new patch fix, click , and edit the components or attributes of the latest published active version.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1411Charging User Guide Charging configuration (new GUI) Note : This option is visible only after the first patch fix is updated.
Deleting a patch fix 1.To delete a patch fix, click against the patch fix as show in the following image: 2.Select Delete .
The patch fix is deleted.
Note : The patch fix can be deleted only when it is in DRAFT state.
When a patch fix is published, the option to delete it is disabled.
5.5.3 Wholesale Logics Wholesale logic is used to link a special tariff plan (Sponsor/Professional tariff plan) with a special bucket (Sponsor/Professional bucket) to influence the rating applied on the bucket.
With this feature the subscribers can have part of their communications sponsored by other Enterprise Post-Paid accounts.
The Enterprise can sponsor some of the employee’s communications, according to the company’s tariff plan configuration, while the employees pay for their personal communications, according to this personal service tariff plan.
Configuration Log into the SM GUI and navigate to Charging → ☰ → Wholesale Logics .
To define a new balance, click and provide the details as described in the following table: Parameter Description Options Mandatory/ Optional APPLICABILITY RULE : Limit service availability and applicability with conditions.
You can filter applicability with network, session, subscriber and date and time criteria.
Note : You can select the Use Advanced Mode or Design mode to configure the logic.Table 117: Parameters for a Wholesale logic Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1412Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional LOGIC DETAILS Name This parameter indicates the unique name for the logic.
String Mandatory Description Description of the logic.
String Optional Category The category to which the logic belongs.
String Mandatory WHOLESALE This parameter indicates usage type of charging service.
It has the following values: •NORMAL •SECONDARY_ BALANCE •WHOLESALEEnum Mandatory Priority This parameter indicates the priority of the logic.
Higher the number, lower is the priority of the logic.
Note : Ensure that the value of this parameter is greater than zero.Integer Valid range: 1 to 2147483647MandatoryTable 117: Parameters for a Wholesale logic (continued) Note : Pre-Rating Simulation is not executed for usageType Wholesale .
It only runs for usage type Normal .
5.5.4 Category Order (Logic Categories) The category order entity is used by the service operators to define the categories and their order of consumption.
This entity is used to select the charging services.
A default category order is created at the time of NCC installation with the given values: •Name = DefaultCategoryOrder •CategoryList = DefaultCategory Configuration Log into the new GUI, navigate to Charging → ☰ → Category Order .
Click EDIT CATEGORY against the default category consumption order entity to modify the entity details as described in the following table: Note : The service operators can only edit the default category consumption order entity configuration.
You cannot create or delete a category consumption order entity.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1413Charging User Guide Charging configuration (new GUI) Basic Details Parameter Description Options Mandatory/ Optional Click EDIT CATEGORY to add a new category.
Name This parameter only displays the Default Category Order name for the category order.
You cannot modify the name of the default category consumption order entity.String Mandatory Description Description for category order.
String Optional Click + CATEGORY to add a name for a new category order.
You can adjust the category list to define a new consumption order of the charging services.Table 118: Parameters for Logic categories entity 5.6 Component Library 5.6.
1 Actions and Conditions An action or condition entity is a template for an ART rule.
The rule it contains is incomplete until it is included in the charging logic and the parameters are populated with values.
You can encapsulate snippets of rules, parameterise them and create a component that can be used in graphical mode when designing a charging logic.
You can parameterise a rule component by entering $_tag (where tag is name you select), in the parameters form below the rule, enter each name and specify the type.
If the element you want to parameterise is an enum type, then use <control><space> in the rule-input box to show a list of values.
This can be used to populate lists of values to appear when the component is configured.
When defining a condition or action, you can enter the rule text directly.
But, enter only condition statement in a condition-component (without the leading "if").
The compound conditions can be joined using "and" or "or" operators.
Two options are available while creating the rules, first one creates a static action and second one creates an action with variable (parameters).
For actions, enter the action rule statements separated.
Use "and" for multiple action statements.
Two options are available while creating the rules, first one creates a static action and second one creates a condition with variable (parameters).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1414Charging User Guide Charging configuration (new GUI) Configuration Log into the new GUI and navigate to Charging → ≡ → COMPONENT LIBRARY → Actions or Conditions .
To define a new action or condition, click and provide the details as described in the following table.
Parameter Description Options Mandatory/ Optional Name This parameter indicates the name of the action.
String Mandatory Applicable to This parameter indicates the service type to which the action is applicable.
Supported values are: Voice, Data, Messaging, or a combination of them.Enum Mandatory Description This parameter is the description of action.
String Optional Category This is the reference to the category entity.
Cross Ref Optional Action Statement It defines the action statement.
You can use parameters to modify values and enable settings in charging logic configuration.String Optional Click + PARAMETERS to add parameters.
ID This parameter is the action ID.
String Mandatory Parameter type Following are the supported values: •Single value input •Multi- value input •Single selection •Multiselection •Boolean •Time PeriodEnum Mandatory Display name This parameter indicates the action display name to be shown in drop- down menu.String Optional Description This parameter indicates the description for action.
String Optional Value type Following are the supported values: •String •Integer •IP Address •DecimalEnum OptionalTable 119: Parameters for actions and conditions Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1415Charging User Guide Charging configuration (new GUI) 5.6.
1.
1 Action configuration Action categories To create an action category, perform the following steps: 1.Log into the SM GUI, navigate to the COMPONENT LIBRARY , and select Actions .
2.Click (folder icon), create and save the category.
Action without parameters To create an action without parameters, perform the following steps: 1.Log into the SM GUI, navigate to the COMPONENT LIBRARY, select Actions , and click .
2.Define the action Name , pick the Category , Applicable to , add a Description and specify rule.
3.Navigate to the Actions overview, choose the action, and release.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1416Charging User Guide Charging configuration (new GUI) Action with parameters To create an action with parameters, perform the following steps: 1.Log into the SM GUI, navigate to the COMPONENT LIBRARY, select Actions , and click .
2.Define the rule, add the $_ and specify the parameter ID.
3.Click +PARAMETERS , define the parameter ID (same ID specified in the rule without $_), choose the parameter information (parameter type and value type if needed), add a display name for the action component and description.
4.Navigate to the Actions overview, choose the action, and release.
5.6.
1.2 Condition configuration Condition categories To create a condition category, perform the following steps: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1417Charging User Guide Charging configuration (new GUI) 1.Log into the SM GUI, navigate to the COMPONENT LIBRARY , and select Conditions .
2.Click (folder icon), create and save the category.
Condition without parameters To create a condition category without parameters, perform the following steps: 1.Log into the SM GUI, navigate to the COMPONENT LIBRARY , select Conditions , and click .
2.Define the condition Name , pick the Category , Applicable to , add a Description and specify rule.
3.Navigate to the Conditions overview, choose the condition, and release.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1418Charging User Guide Charging configuration (new GUI) Condition with parameters To create a condition category with parameters, perform the following steps: 1.Log into the SM GUI, navigate to the COMPONENT LIBRARY , select Conditions , and click .
2.Define the rule, $_ and specify the parameter ID.
3.Click +PARAMETERS , define the parameter ID ((same ID specified in the rule without $_), choose the parameter (parameter type and value if needed), add a display name for the condition component and description.
4.Navigate to the conditions overview, choose the condition, and release.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1419Charging User Guide Charging configuration (new GUI) 5.6.2 Allowance Limits (Bucket) Allowance limits (buckets) are entities defining an amount and unit of consumption.
The allowance limit (bucket) is defined with a name to be referenced by the tariff and charging service.
It is a reusable entity and same bucket definition can be used by multiple charging logic (charging service).
Configuration Log into the new GUI, navigate to Charging → ≡ → COMPONENT LIBRARY → Allowance Limits , and click to add a new allowance limit (bucket).
Allowance limit (bucket) definition To define a new allowance limit (bucket), click to or to add or modify the details as described in the following table: Parameter Description Data type Mandatory/ Optional Name This parameter indicates the name of the allowance limit.
String Mandatory Type This parameter indicates the type.
Supported values are: Time, Data, Money, Message.Enum Optional Unit This parameter indicates the name of the unit.
Supported values are: Minute, Hour, Day, Second.Enum Optional Description This parameter contains the description of allowance limit.
String Optional Allowance Limit Default allowance limitThis parameter indicates the default allowance limit.
The maximum supported value is 1125899906842624 ( in base units) with DB precision = 2.
Note : With increase in DB precision, this value decreases.
For example, in case DB precision is set to 5, the maximum supported value is 92233720368547.Integer Optional Carry over This parameter indicates whether the allowance limit ( bucket) balance is carried over to the next period or not.
By default, this check box is not selected.
If this check box is not selected, user was can override the value of the allowance limit, but cannot carry- over.
If selected, user can edit the carry- over fields.Select this check box to indicate whether carry- over is required.OptionalTable 120: Parameters for allowance limit Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1420Charging User Guide Charging configuration (new GUI) Parameter Description Data type Mandatory/ Optional Validity Note : This parameter is visible only when the Carry Over check box is selected.
This field allows to select whether carry- over is to be applied for one billing cycle or all billing cycles.
Supported values are: •ONE PERIOD •UNLIMITED Default value is ONE PERIOD .Enum Optional Maximum transfered amount per periodNote : This field is visible only when the Carry Over check box is selected.
This field value ranges from 1 to 100.
The carry- over percentage is calculated on the remaining balance of the main bucket at the time of renewal or reset ( next billing cycle) .BigDecimal Optional (If not specified, carry- over feature is disabled) Total carry over limit Note : This field is visible only when the Carry Over check box is selected.
This field indicates the maximum balance that carry- over bucket can hold at next billing cycle.BigDecimal Optional (If it is null, there is no maximum limit) Consumption Order Note : This field is visible only when the Carry Over check box is selected.
This field helps to decide which instance of the bucket, whether Regular or Carry Over First , to be used first for charging.
Supported values are: •Regular •Carry Over First Default value is Carry Over FirstENUM Optional Threshold profile This allows you to select the threshold profile that is already defined.
ENUM Optional Charging period Inherit service period By default, this check box is selected.
Select this check box to indicate whether service period should be inherited.Optional Period type Default: Custom Enum MandatoryTable 120: Parameters for allowance limit (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1421Charging User Guide Charging configuration (new GUI) Parameter Description Data type Mandatory/ Optional Periodical lifecycle This parameter indicates the billing cycle associated with the allowance limit.Enum Mandatory if Inherit service period is not selected.
Align Subscription Period End to a DateBy default, this check box is not selected.
Select this check box to indicate whether subscription period should be aligned to a date.Optional Reference Date It supports Day of Month , and Day of Week values.
Enum Mandatory if Align with Subscription period end to a date is selected.
Day of Month Following are the supported values for this parameter •1 to 31 •Exact : If selected, the day of week is aligned to subscription purchase date.Integer Mandatory if Align with Subscription period end to a date is selected.
Day of Week Following are the supported values for this parameter •Sunday to Saturday •Exact : If selected, the day of week is aligned to subscription purchase date.String Mandatory if Align with Subscription period end to a date is selected.
Hour of Day Following are the supported values for this parameter •0 to 23 •Exact : If selected, the end date and time has the same time as subscription start time.
•Next Day Start : If selected, the end date and time is aligned to 00: 00:00 of next day as per the lifecycle periodicity.
For example, if a monthly subscription is purchased on 20th Jan 13: 45:00, then the end date and time of subscription is set to 21st Feb 00: 00:00.Integer Mandatory if Align with Subscription period end to a date is selected.Table 120: Parameters for allowance limit (continued) Bucket entity - instance Note : The bucket entity - instance cannot be modified through the SM GUI.
Some of the parameters listed in the table are linked to the calculations performed by internal logic.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1422Charging User Guide Charging configuration (new GUI) Parameter Description Data type Mandatory/ Optional Bucket Instance Account Account reference added for clubbing.
Account Mandatory Activation Time This parameter is reserved for future use.
Long Optional adjust Amount Initial ValidityThis is the number of billing cycle reset after which the initial value is replaced by original initial value in the Bucket Instance.
Supported values are as follows: •0: Indicates that the current initial value remains for eternity, this is the default value •Any positive ( +ve) value: This is the number of billing cycles ( including the current bill cycle) for which the current initial value remains valid.
For example, a value of 1 means that the current initial value is valid only for the ongoing bill cycle and is replaced by original initial value at next BCR.
Example: adjust Amount Initial Validity = 3, initial Value = 1000 and orig Initial Value = 1200.
This initial value is valid for current bill cycle and 2 further bill cycles.
After that, initial Value is equal to 1200.
Default value is 0.Integer Optional Bucket DefId The value of this parameter is taken from the bucket definition at the time of bucket creation.
It is a read- only field.String Optional carry Over Value This parameter value ranges from 1 to 100.
The carry- over percentage is calculated on the remaining balance of the main bucket at the time of renewal or reset ( next billing cycle) .Big Decimal Optional Count CCR The CCRu or CCRt number that is received after receiving CCRI.Long -Table 121: Parameters for bucket entity - instance Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1423Charging User Guide Charging configuration (new GUI) Parameter Description Data type Mandatory/ Optional consumption Priority This parameter helps to decide which instance of the bucket, whether regular or carry- over, to be used first for charging.
Supported values are as follows: •REGULAR_ BUCKET •CARRY_ OVER_ BUCKETEnum Optional Creation Time The value of this parameter is taken from the Linux time stamp at the time of bucket creation.
It is a read- only field.Long Mandatory Current Value This parameter is set as the same initial value at the time of bucket creation and can be updated to any positive value.
It is set as zero when no value is given in update request.
Note : The maximum value allowed for bucket initial/ current is 922337203685477600.Big Decimal Optional current Charging Step The index/ position of current charging step.
It is reset during reset of the subscription.
Its value is null if Charging Step is not associated to bucket.Integer Optional current Charging Step UpTimeThe up/ start timestamp of current charging step.
During subscription reset, it contains the time when reset is done.
Its value is null when Charging Step is not associated to bucket.Long Optional Dormant Lines The parameter indicates the number of dormant lines.
Long Optional Expiration Time This parameter is reserved for future use.
Long Optional Id This parameter identifies the bucket instance.
String Mandatory Initial Value The value of this parameter is taken from the bucket definition at the time of bucket creation.
It is a read- only and non- modifiable parameter.Decimal OptionalTable 121: Parameters for bucket entity - instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1424Charging User Guide Charging configuration (new GUI) Parameter Description Data type Mandatory/ Optional Note : The maximum value allowed for bucket initial/ current is 922337203685477600. initial Value Adjust ModeThis value is used for internal purpose.
If a user edits the initial value temporarily, then it contains the current Adjust Mode of initial value.
Default Value is Adjust Mode.
NONE .Enum Optional isCarry Over This parameter is reserved for internal use only.
The value of this parameter is set true for carry- over bucket and false for regular bucket.Boolean Optional DorLinSlice Size This parameter indicates the sum of dormant line slice size.
This value is dynamic and is calculated by the dynamic slicing algorithm at runtime.Decimal Optional delta Value This value is used for internal purpose.
If a user edits the initial value temporarily, then it is the amount by which Initial value increased or decreased for adjust Amount Initial Validity.Big Decimal Optional max NoOfLines The maximum number of lines.
Long Optional max Carry Over Value OptionThe following options are available to calculate the maximum carry- over value: •Percentage of remaining value •AbsoluteEnum Optional max Carry Over Value This parameter indicates the maximum balance that carry- over bucket can hold at next billing cycle.Big Decimal Optional origInitial Value This value is used for internal purpose.
If required after the number of BCRs.
Default value is 0.Big Decimal OptionalTable 121: Parameters for bucket entity - instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1425Charging User Guide Charging configuration (new GUI) Parameter Description Data type Mandatory/ Optional renewal Period This parameter allows to select if the carry- over is to be applied for one billing cycle or all billing cycles.
Supported values are as follows: •ONE_ PERIOD •UNLIMITEDEnum Sum Sqrt ActLin This parameter indicates the sum of square root of active line per hour.Decimal Optional Sum Sqrt AllLinPerHr This parameter indicates the value of sum of square root of all lines per hour.Decimal Optional charging Service Id This parameter represents the charging service ID to which the bucket is attached.String Optional isSyPolicy Bucket This parameter decides whether this bucket works as a policy counter or not.
TRUE, makes this bucket qualified for policy when any threshold associated has ocs- policy set to true .Boolean Optional policy Counter Name Value is set if the user has configured a Send- SNR action on a threshold associated with this counter.
Then this attribute represents the Virtual Policy Counter mentioned in the Send- SNR action.
Example: SY.Send- SNR = “ VPC, HIGH” Here, VPC is virtual policy counter name.String Optional exhaustion Time This attribute represents the time at which this bucket instance is exhausted.Long Optional lastReporting State This attribute represents the state when the last SLA is sent for Sy interface.String OptionalTable 121: Parameters for bucket entity - instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1426Charging User Guide Charging configuration (new GUI) Parameter Description Data type Mandatory/ Optional lastReporting Time This attribute represents the time when the last SLA is sent for Sy interface.Long Optional default State This attribute represents the default state of Bucket InstanceString Optional lastSNRReporting StateThis attribute represents the state when the last SNR is sent.String Optional lastSNRReporting TimeThis parameter represents the timestamp when the last SNR is sent.Long Optional Unused Value This parameter contains the value of unused units that is initially committed value.Decimal Optional prev Current Value This parameter is used for internal purposes.
It stores the current value of the bucket during the reset or renewal time of the bucket.BigDecimal Optional prev Unused Value This parameter is used for internal purposes.
It stores the unused value of the bucket during the reset or renewal time of the bucket.BigDecimal Optional threshold Profile Grp InstListThe value of this parameter is taken from the bucket definition at the time of bucket creation.
If threshold is attached with bucket definition, its instance is created and attached to the corresponding bucket instance.
It is a read- only field.List< Threshold Profile Group Instance>OptionalTable 121: Parameters for bucket entity - instance (continued) Threshold Profile group instance list Note : The Threshold Profile group instance cannot be modified through the SM GUI.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1427Charging User Guide Charging configuration (new GUI) Some of the parameters listed in the table are linked to the calculations performed by internal logic.
Parameter Description Options Mandatory/ Optional Threshold Profile GrpInstList Dynamic Milestone Milestone is a percentage type threshold when the Dynamic Milestone flag is true with the empty rule container.
The supported values are as follows: •True: If the flag is true, then the threshold profile group is used as a milestone.
•False: If the flag is false, then the threshold profile group is not used as a milestone.Boolean Mandatory ThPrfGrpDfName This parameter is the key parameter of the threshold profile group entity.String Optional Thrs PrfInsList Interval This parameter is for internal use only.
It is required for rule engine.Integer Mandatory Thresh InstListTable 122: Parameters for Threshold Profile group instance list Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1428Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Action Result The result of the threshold rule action.
The supported values are as follows: •SEND_ NOTIFICATION •SEND_ RARthreshold Rule Action Optional Level This parameter is for internal use only.
It is required for rule engine.Integer Mandatory RarSend This parameter is a Flag to specify weather RAR is already send for this threshold or not.Boolean Mandatory Thresh DefName This parameter is the key parameter of the threshold.String Optional Threshold Crossed This parameter is for internal use only.
It is required for rule engine.Boolean Optional thrsPrfDefName This parameter is the key parameter of the threshold profile entity.String OptionalTable 122: Parameters for Threshold Profile group instance list (continued) Creation time and Last update time Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1429Charging User Guide Charging configuration (new GUI) Parameter Description Data type Mandatory/ Optional Creation Time The time when the bucket was created.
This parameter is read- only and is filled by system automatically.Long Optional Last Update Time The time when the last update occurred.
This parameter is read- only and is filled by system automatically.Long OptionalTable 123: Parameters for Creation time and Last update time Actions associated with an allowance limit Action Description Create Used to create the allowance list entity in database by providing the mandatory and optional parameters.
Read Used to display the allowance list entity per the data retrieved from database.
Update Used to update a particular allowance list entity in database.
Delete Used to delete a particular allowance list entity from database.
Note : These actions are valid for internal purposes only and cannot be accessed using the SM GUI.
Actions associated with a bucket instance Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1430Charging User Guide Charging configuration (new GUI) Action Description create Bucket Instance Used to create Bucket Instance.
Newly created Bucket Instance is returned by API and used in subscription creation logic.
create Bucket AndCarry Over Instance Used to create regular and carry- over bucket instances and return their objects in a list.
read Bucket Instance Used to read Bucket Instance through its Id.
Returned object provides Initial/ Current/ Unused value in specified REUnit Type.
For example, bucket values are shown in GB, if bucket definition is specified in GB.
read Bucket Instance InBase Units Used to Read Bucket Instance through its Id.
Returned object provides Initial/ Current/ Unused value in specified base REUnit Type.
For example, bucket values are shown in Byte, even if bucket definition is specified in GB.
update Bucket Instance InBase Units Used to Update Bucket Instance through its Id.
It can take values in the base units and update the DB object without any unit conversion.
update Bucket Threshold Used to update the bucket threshold.
update Bucket Instance ForDPUDeletion Used to update the Dynamic slice parameters in the specified Bucket Instance for the input Dynamic Past Usage object.
adjust Balance Used to add or subtract given units ( in bigdecimal) from bucket instances remaining units ( current Value and unused value) in base units.
If input units are + ve, then they get added and if - ve then subtracted.
cancel Reservation Used to cancel the reservation for the given session id.
The reservation gets deleted from reservation map and the reserved units are added back to the remaining units ( current Value) .
TTL is ignored.
cancel Reservation AndAdjust COBucket Used to cancel the reservation for the given session id.
The reservation gets deleted from reservation map and the reserved units are added back to the remaining units ( prev Current Value) .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1431Charging User Guide Charging configuration (new GUI) Action Description TTL is ignored.
If remaining units are valid for adjustment in carry Over Bucket, unit values get adjusted.
commit Reservation Used to partially commit the reserved units.
Remaining reserved units are added back to bucket instance.
It also clears that reservation from bucket instance for session id.
commit Reservation InPrev Values Used to partially commit the reserved units with previous current and unused values of bucket Instance.
Remaining reserved units are added back to bucket instance.
It also clears that reservation from bucket instance for session id.
getRemaining Units Used to return the remaining units in the bucket instance.
getTotal Units Used to add all the reserved units for the given bucket instance to remaining units ( current Value) and returns the sum.
TTL is ignored.
getReservation Details Used to expose the reservation details for the given bucket Instance.
isValid ( bucketinstance Id) Returns true if current time is between activation and expiration time.
isValid ( bucketinstance Id, Long- Reference Time) Returns true if the reference time is between activation and expiration time.
reserve Units Used to reserve the given number of units ( BigDecimal) from bucket instance.
It deducts them from remaining units ( current Value) and adds them to the reservation map.
This map is indexed with the calls session Id.
reset Bucket AndItsThresholds Responsible for fetching the bucket instance using the id.
Resets the current value of bucket instances to match the provided reset Value ( BigDecimal) .
If reset Value is null, then it is reset to the initial value.
Fetches all the threshold profile group ( including its threshold profile and threshold) instances associated with the bucket and resets them.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1432Charging User Guide Charging configuration (new GUI) Action Description update Bucket Instance You can update these parameters in Bucket Instance: initial Value, current Value ( unusedvalue) , carry Over Value, max Carry Over Value, renewal Period, Consumption Priority, Enable/ Disable Carryover bucket.
After updating initial/ current value/ adding carry- over bucket, corresponding aggregate view of the subscription is also updated.
Update Used to update a particular bucket instance in database.
Current value, activation, expiration time parameters can be updated only if they have positive value.
If they do not have any value, they are set to 0.
Bucket DefId, creation time, initial value, thresholdlist, unittype parameters cannot be updated.
Note : These actions are valid for internal purposes only and cannot be accessed using the SM GUI.
5.6.3 Custom Counters and Metering Limits (Counters) A counter accumulates the value of defined usage type used against the defined threshold value.
A specific action is taken on the basis of the accumulated usage type value, such as sending notification to subscribers.
Counters track the consumption of charging logic (charging services), main balance/no charge, and allowance limits (bucket) types associated with the specific charging logic (charging services).
Attention : NCC supports the counter functionality with counter of usage and cost type, that is, counter can accumulate the usage consumption or the cost deductions made.
However, the use cases of counters to accumulate the number of calls, that is, counter type as CALL is not supported currently and subjected for future enhancement of NCC product with required customer use cases.
Note the following points: •The counter scope can be All, Multi-service, Subscription, Hierarchy, Self.
•Applicability condition and rule can be configured.
•Usage limit and overage limit can be configured.
Following are the types of counters: •Device counter : A counter attached to a device.
•Device group counter : A device counter attached to a group.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1433Charging User Guide Charging configuration (new GUI) •Group counter : A counter attached to a group.
•Subscription counter : A counter attached to a subscription and limited to consumption by attached subscription only.
•Multi-bundle counter : A counter that is updated across all subscriptions attached to a device.
See Multi-bundle restrictions for restrictions applicable to multi-bundle counter.
Note : Multi-bundle counter follows the lifecycle of the associated subscription, and resets or accumulates as per the lifecycle of that subscription.
If the subscription is barred, then the multi-bundle counter of that subscription is not updated and the multi-bundle counter of that subscription is reset only when the subscription is reset as well.
Custom counter versus Metering Limit Metering limit is a subset of custom counter that has counterScope =SUBSCRIPTION and custom flag = false.
Use metering limit for subscription-scoped counters.
For custom counter, the custom flag is set to either null or true.
Custom counters can be used for complex scenarios where metering limit and fair usage policies are not supported.
Subscription creation or removal The following points are considered during a subscription creation or removing a subscription from a device or group: •During subscription creation, the information related to the charging service counters are stored in the entity counter instance.
In case of no-charge, the charging service counters are enabled and the subscription counters count the usage and the usage type counters are updated.
•If a subscription is removed from a device or group in between the reservation and commit, then it is recommended that the delete subscription action moves the device or group subscription to barred or final state before executing the Delete Entity action.
If the lifecycle timers are configured after the barred or final state, then the lifecycle timer value must be greater than the maximum VT.
This ensures that no reservation is available from the subscription removed from a device or group.
For information on state and timer parameters related to a subscription lifecycle, refer to Lifecycle parameters on page 1578 .
Note : It is highly recommended that removing a subscription from a device or group is performed when the subscription is in a barred or final state and configure the lifecycle timer value greater than the maximum VT.
Otherwise, the ongoing charging related to the removed subscription reports issues and results in call failure.
•In cases of no-charge and charging from a bucket or account associated with a device or group, if a subscription associated with a device or group is removed in between a reservation and commit, then the subscription counter instances get deleted.
However, device counter, group counter, or device group counter remain in the database without affecting the call charging.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1434Charging User Guide Charging configuration (new GUI) 5.6.3.
1 Custom counter configuration Log into the Service Manager Graphical User Interface (SM GUI), navigate to Charging Configurator and select Custom Counters from the hamburger menu (☰).
To define a new counter, click to add the basic details as described in the given table: Basic Details Parameter Description Options Mandatory/ Optional Name This parameter indicates a unique name of the counter.
String Mandatory Type This parameter indicates the type such as Time, Data, Money, Message associated with the counter.Enum Select the required type from the predefined set of values in the drop- down list.Mandatory Unit This parameter indicates the type of unit associated with the counter.
Supported values are: Minute, Hour, Day, Second.Enum Select the required unit type from the predefined counter types in the drop- down list.Mandatory Description This parameter contains the description of a counter.
String Optional Apply granularity This flag must be checked to apply granularity.
Boolean Optional Counter Scope This parameter indicates the scope of the counter.
The supported values are as follows: •All: Scope is to monitor all counters in hierarchy.
•Self: Scope is to monitor the usage or call of device or group to which the counter is attached.
•Hierarchy : Scope is to monitor the all counters in the hierarchy except the usage or call of the device or group attached to the counter.
That is, Hierarchy equals All - Self.
•Multi- service : This refers to those types of counters that are updated across all subscriptions attached to a device.
•Subscription : This refers to those counters attached to a subscription and limited to consumption by attached subscription only.Enum Select the required counter scope from the predefined counter scopes in the drop- down list.MandatoryTable 124: Parameters for custom counter Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1435Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Note : If Counter Scope is All, Group Counter is incremented if charging is done from Device Resource.
To prevent this increment, it must be of type Self or Hierarchy while creating Group Counter.
This parameter indicates the consumption type such as bucket.
Enum Mandatory The supported values are as follows: •All: The counter is incremented when the consumption is done through any of the entities.
For example, Bucket, Counter, Account or Charging Service.
•Allowance : The counter is incremented when the consumption is done only through the bucket.
•Metering : The counter is incremented when the consumption is done only through the counter.
•Account : The counter is incremented when the consumption is done only through an account.
•Charging Logic : The counter is incremented when the consumption is done only through the charging service.Select the required counter consumption type from the predefined counter consumption types in the drop- down list.Counter incrementation type Note : If the Counter incrementation type is All, then the Counter Consumption List must be empty.
OCS policy counter This parameter indicates the value for the Policy Counter flag is dependent on the given conditions: •True : If the current interface is the Sy interface.
If this check box is checked.
•False : If the current interface is Gy interface.
If this check box is unchecked.
Note that the Fair usage policy entity provides a simple way of configuring Sy interface interactions, but you can configure custom counter with this flag set, and associated thresholds as well.
The default value is False .String Select this checkbox to indicate whether the counter is a policy counter or not.Optional Resource Based CounterBy default, this checkbox is unchecked.
Select this checkbox to indicate whether the counter is a resource counter or not.Optional Limit This parameter defines the usage limit or overage limit applied per counter within a service.
If this parameter is defined, then percentage type thresholds are allowed in the Thresholds Profile Group IDs parameter with a symbolic end limit as usage limit.
Following are the important points to note: •A same counter definition ID in different bundles can have different usage limits.Big decimal OptionalTable 124: Parameters for custom counter (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1436Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional •If percentage thresholds are to be used or the overage limit is to be defined for the counter, then you must define the usage limit for the counter.
The maximum supported value is 1125899906842624 ( in base units) with DB precision = 2.
Note : With increase in DB precision, this value decreases.
For example, in case DB precision is set to 5, the maximum supported value is 92233720368547.
Once, usage limit of the counter is reached, the overage limit is considered and subsequently triggers all threshold actions for the overage block.
The overage is applied repetitively to the counter.
Note : The overage limit can be defined only when usage limit is defined.
Threshold profile This parameter indicates the threshold profile already defined in the system that you can attach to metering limit.Enum Optional Allow Overage By default, this checkbox is unchecked.
Select this check box to indicate whether overage should be allowed.Optional Applicability ConditionThis parameter indicates a rule condition expression evaluated to determine whether the charging logic is applicable.String Optional Rule Configurations This parameter indicates the rules associated with a counter being created.
Note : The rules are evaluated only for Muti- Bundle type counter.String Optional Click +ADD RULE to add a new rule.
Counting period Inherit service periodBy default, this checkbox is checked.
Select this check box to indicate whether service period should be inherited.Optional Period type Default: Custom Enum Mandatory Periodical lifecycle This parameter indicates the billing cycle associated with the custom counter.
Enum Mandatory if Inherit service period is not selected.
Align Subscription Period End to a DateBy default, this checkbox is not checked.
Select this check box to indicate whether subscriptionOptionalTable 124: Parameters for custom counter (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1437Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional period should be aligned to a date.
Reference Date It supports Day of Month , and Day of Week values.
Enum Mandatory if Align with Subscription period end to a date is selected.
Day of Month Following are the supported values for this parameter •1 to 31 •Exact : If selected, the day of week is aligned to subscription purchase date.Integer Mandatory if Align with Subscription period end to a date is selected.
Day of Week Following are the supported values for this parameter •Sunday to Saturday •Exact : If selected, the day of week is aligned to subscription purchase date.String Mandatory if Align with Subscription period end to a date is selected.
Hour of Day Following are the supported values for this parameter •0 to 23 •Exact : If selected, the end date and time has the same time as subscription start time.
•Next Day Start : If selected, the end date and time is aligned to 00: 00:00 of next day as per the lifecycle periodicity.
For example, if a monthly subscription is purchased on 20th Jan 13: 45:00, then the end date and time of subscription is set to 21st Feb 00: 00:00.Integer Mandatory if Align with Subscription period end to a date is selected.Table 124: Parameters for custom counter (continued) 5.6.3.2 Metering Limits configuration Log into the new GUI and navigate to Charging → ☰ → Metering Limits .
To define a new calendar, click and provide the details as described in the following table.
Parameter Description Options Mandatory/ Optional Name This parameter indicates the unique name for the metering limit.
String Mandatory Description Description of the metering limit.
String OptionalTable 125: Parameters for metering limits Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1438Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Type This parameter indicates the type such as Time, Data, Money, Message.Enum Mandatory Unit This parameter indicates the unit type such as Byte, GByte, KByte.
Enum Mandatory Metering limit Metering limit This parameter indicates the limit applied.
Digit string Optional Threshold profile This parameter indicates the threshold profile already defined in the system that you can attach to metering limit.Enum Optional Counting period Inherit service periodBy default, this checkbox is checked.
Select this check box to indicate whether service period should be inherited.Optional Period type Default: Custom Enum Mandatory Periodical lifecycleThis parameter indicates the billing cycle associated with the metering limit.Enum Mandatory if Inherit service period is not selected.
Align Subscription Period End to a DateBy default, this checkbox is not checked.
Select this check box to indicate whether subscription period should be aligned to a date.Optional Reference Date It supports Day of Month , and Day of Week values.
Enum Mandatory if Align with Subscription period end to a date is selected.
Day of Month Following are the supported values for this parameter •1 to 31 •Exact : If selected, the day of week is aligned to subscription purchase date.Integer Mandatory if Align with Subscription period end to a date is selected.
Day of Week Following are the supported values for this parameter •Sunday to Saturday •Exact : If selected, the day of week is aligned to subscription purchase date.String Mandatory if Align with Subscription period end to a date is selected.Table 125: Parameters for metering limits (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1439Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Hour of Day Following are the supported values for this parameter •0 to 23 •Exact : If selected, the end date and time has the same time as subscription start time.
•Next Day Start : If selected, the end date and time is aligned to 00: 00:00 of next day as per the lifecycle periodicity.
For example, if a monthly subscription is purchased on 20th Jan 13:45:00, then the end date and time of subscription is set to 21st Feb 00: 00:00.Integer Mandatory if Align with Subscription period end to a date is selected.Table 125: Parameters for metering limits (continued) 5.6.3.3 Actions associated with custom counter and metering limit Action Description Create Used to create a custom counter entity or metering limit in database by providing the mandatory and optional parameters.
Read Used to display the custom counter or metering limit entity per the data retrieved from database.
Update Used to update a particular custom counter or metering limit entity in database.
Delete Used to delete a particular custom counter or metering limit entity from database.
AddCounter ToDevice Used to add a custom counter to a device.
AddDevice Counter ToGroup Used to add a new attribute, such as List< string> device Ids as an input.
The counters are created only for those devices passed as input in device Ids and counter definition ID is not added in the counter list available at group level.
Note : Check that the device is a part of the required hierarchy.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1440Charging User Guide Charging configuration (new GUI) Action Description AddGroup Counter ToGroup Used to add a group counter to a group.
Create Counter While Adding Device ToGroup Used to create the Entity Counter Instances for a device when it is added to the existing group hierarchy having device group counters.
Delete Counter While Deleting Device Used to delete both the device counters and device group counters.
Delete Counter While Deleting Group Used to be executed before group delete.
It deletes both group counters and device group counters.
Delete Counter While Removing Device From GroupUsed to delete entity counter instances when device is removed from group.
Delete Counter While Removing Group From Group Used to delete entity counter instances when group is removed from group.
Remove Counter From Device Used to remove a counter from a device.
Remove Device Counter From Group Used to remove a device counter from a group.
Remove Group Counter From Group Used to remove a group counter from a group.
Note : These actions are valid for internal purposes only.
It is not accessible through the SM GUI for operators.
5.6.3.4 Examples The following examples help to understand the generic functionality of counters: Example 1: Counter reservation Preconditions: •A subscriber has an iPhone, which is associated with a data counter and the iPhone is subscribed to a device subscription.
•The device subscription is further associated with another data counter and a data bucket.
Post-conditions: •When the iPhone initiates a data call with Requested Service Unit (RSU) of 40 MB, then the amount required to complete the call is reserved from the data bucket associated with the device subscription.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1441Charging User Guide Charging configuration (new GUI) Note : If a subscription is removed from the device or group in between a reservation and commit, then it is recommended to move the device or group subscription to barred state.
Therefore, no reservation of units is available from that device or group subscription.
•Both the counters, individual data counter associated with the iPhone and data counter associated with the device subscription, are applicable for the call charges.
The current value of the counters remain unchanged while the total reserved value is updated with the value of 40 MB.
The counter mapping is updated with session id and reserved values.
•In the update request, the iPhone has an RSU of 40 MB and Used Service Unit (USU) of 40 MB.
In this request, only 40 MB is committed and 40 MB is reserved for the next request.
The current value of counters is updated with the committed value while the new attribute is incremented with a value of 40 MB.
The counter mapping is also updated with the session id and reserved values.
Example 2: Unsubscribing a device or group subscription in between a reservation and commit Preconditions: •A subscriber owns an iPhone subscribed with a device subscription.
•The device subscription is associated with a data bucket of 500 bytes.
Post-conditions: •When iPhone initiates a call with an RSU of 10 bytes, the units required to complete the call is reserved from the data bucket.
•The device subscription is removed from the iPhone.
During an update request, an error is received stating that no subscription is attached with the device.
An alarm is generated containing the device ID and bucket ID without club ID, and SUBSCRIPTION_UNSUBSCRIBE rating error code is received that maps to 5031- Diameter error code .
5.6.3.5 Resource-based counter 5.6.3.5.
1 Variables for resource-based counter The following context variables can be used for resource-based counter: •Reserve-Rate : This variable indicates the Rate ID with the entity for which the maximum reservation has taken place.
•First-Reserve-Rate : This variable indicates the Rate ID with the entity that is first used in reservation.
See Determining rate based on counter threshold on page 1483 to get the Rate ID.
5.6.3.5.2 SNR handling of resource-based counters in reservation during a call For a resource-based counter, the SNR is sent based on the resource used for maximum reservation.
Threshold rule is evaluated during reservation to provide Counter Signaling State .
Rule evaluation decides Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1442Charging User Guide Charging configuration (new GUI) the Counter Signaling State based on resource with maximum reservation and/or resource type (Device/ Group) to which it belongs.
Threshold is applied with configuration Absolute From Start and value 0 to process Counter Signaling State in every reservation.
For the threshold evaluation at reservation, the following source context are added into the THRESHOLD_PROFILE context: Name of context variable Description Charging- Service- Reserve Name of the charging service from which the maximum reservation has been done.
Charging- Service- Reserve- Type Name of the resource ( DEVICE/ GROUP) to which the charging service with maximum reservation belongs.
Bundle- Name- Reserve Name of the bundle from which the maximum reservation has been done.
Bundle- Reserve- Type Name of the resource ( DEVICE/ GROUP) to which the bundle with maximum reservation belongs.
Following are the ways to configure the threshold rule to decide the state based on various conditions, such as Charging-Service-Reserve , Bundle-Reserve , Charging-Service-Reserve-Type , or Bundle-Reserve-Type : •Configuring threshold rule using the Charging-Service or Bundle Names or Types (DEVICE/GROUP).
The following figure shows an example of using Charging-Service-Reserve in rule.
In the same way it can be used based on Bundle-Reserve : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1443Charging User Guide Charging configuration (new GUI) Similarly, to decide the state based on condition of CS Type ( Charge-Service-Reserve-Type ), configure threshold rule as shown in the following example.
In the same way, it can be used based on the Bundle-Reserve-Type : •Configuring threshold rule using complex map.
Example 1: Configuring the Charging-Service-Reserve with its corresponding state using complex map Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1444Charging User Guide Charging configuration (new GUI) Configure the complex map to have mapping between key ( Charging-Service-Reserve ) and value (state for particular charging service), to be used in threshold rule.
The following figure shows an example of a complex map using the Charging-Service-Reserve and corresponding state.
In the same way, a Bundle-Reserve can also be configured.
To evaluate the state corresponding to Charging-Service-Reserve through Complex Map, configure threshold rule using Complex Map as shown in the following figure.
In the same way, the Bundle- Reserve can be configured.
Example 2: Configuring the Charging-Service-Reserve and Charging-Service-Reserve-Type with its corresponding state using complex map.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1445Charging User Guide Charging configuration (new GUI) Configure the complex map to have a mapping between key (combination of Charging-Service- Reserve and Charging-Service-Reserve-Type ) and value (state for particular combination), to be used in the threshold rule.
The following figure shows an example of a complex map using a combination of Charging-Service- Reserve and Charging-Service-Reserve-Type to determine its state.
In the same way, the Bundle- Reserve and Bundle-Reserve-Type can be configured.
To evaluate state corresponding to combination of Charging-Service-Reserve and Charging-Service- Reserve-Type through complex map, configure threshold rule using Complex Map as shown in the following figure.
In the same way, Bundle-Reserve and Bundle-Reserve-Type can be configured.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1446Charging User Guide Charging configuration (new GUI) Note : For resource-based counter, the Pending Policy Counter Info AVP is not sent.
5.6.3.5.3 SY-SLR SLA handling for resource-based counter Policy-Counter-State for a resource-based counter is determined from the latest signaling state sent either in SLA or SNR.
If the counter is newly added and not in use earlier till the Sy SLR arrives, then Policy- Counter-State is -99.
5.6.3.5.4 SNR handling of resource-based counters in lifecycle action Resource counters are provided as input to the Send-SNR action.
In this case, signaling state given in Send-SNR action is compared with state available in the Sy session if counter is present in respective Sy session.
If state difference is found, then SNR is sent for counter.
If counter state is not provided in SNR action, the latest previous state sent is considered and further compared with respective Sy session.
5.6.3.6 Usage limit on custom counters The Usage Limit (ULI) is the limit of data usage applied on a counter.
Following two ULI scenarios generate notifications for a subscriber: •Notifications generated after the ULI on a counter is reached or exceeded The instance of reaching the ULI limit on a counter can be referred as the reaching of its usage limit, which is configured as a hard-stop scenario that stops to grant any further quota or it is configured as a soft-stop scenario to provide a notification but continues to grant the quota.
•Notifications generated preceding that usage limit, also referred as Near-ULI or Pre-ULI The Near-ULI are defined as the near-limit thresholds, which are configured as a percentage of the usage limit on a counter.
For example, a 50% percentage threshold can be applied on a counter whose ULI is 5 GB.
The usage limit is set as per the bundle or charging service with the ability to trigger notifications or other actions when these limits are reached.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1447Charging User Guide Charging configuration (new GUI) Note : A same counter definition ID in different bundles can have different ULIs.
However, if ULI is not set for a counter (with no threshold applied) or usage limit is set with no hard-stop, then it means that the counter has unlimited usage.
5.6.3.7 Overage limit on custom counters The Overage Limit (OLI) is the ability to define an overage usage limit per counter within a bundle and it is applicable only when the usage limit is set and reached.
Once, the ULI of a counter is reached, the OLI is considered and it is applied repeatedly.
The Near-OLI are defined as the near-limit thresholds, which are configured as a percentage of the overage limit on a counter.
The overage limit is set as per the bundle or charging service with the ability to trigger notifications or other actions when these limits are reached.
Note : The Send-SNR action is configured for overage thresholds, which sends an SNR notification only once when the overage limit is reached (as administered by the Sy interface).
For example, if the overage limit is defined as 2 GB for a counter and Send-SNR action is configured on 100% of 2 GB in the overage threshold, then an SNR is sent when the overage limit is reached for the first time.
After that, the Sy interface administers to not send the SNR for the same signaling state in case it is same as the last successfully sent SNR state.
5.6.3.8 Configuring usage type (Primary or Secondary) at Usage Type level to count into spending limit This feature enables operators to count the either primary or secondary usage type for cost-based spending limit counter in IMS call when two usage types are applied.
Primary and secondary usage types can be swapped.
The usage type to be counted in spending limit can be configured.
Available rule action The action attribute Select-Counter-Usage is available in RATING result context to configure whether primary or secondary should be configured in spending limit.
Refer to RATING result context on page 1285 for more information about this attribute.
Example Configuration 1.Rate1 has 100 MB/euro with a step of 1 MB.
2.Create a Charging Service with one Tariff that uses RATING.Rate (Rate1, Balance) .
3.Create an Account to be used with 1000 euros.
4.Create a Subscription with the Charging Service and attach it on Device.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1448Charging User Guide Charging configuration (new GUI) 5.Create a Cost Counter with multi-Bundle scope and place a Rule that has RATING.Select-Counter- Usage = Primary .
Configure Usage Limit as 300 euro, when traffic is blocked and notification is sent to User.
6.Attach the Counter to Device.
Verification 1.Perform some traffic and spend 300 euros.
2.The Counter reaches the Usage Limit of 300 euros, the traffic is blocked, and a notification is sent to User.
3.The Account ends with 700 euros.
5.6.4 Fair Usage Policies Fair Usage Policy (FUP) allows operators to define simple use cases for throttling policy configuration to send SNR action depending on initial QoS, throttled QoS, and usage limit.
It manages threshold and counter entities which are created once the FUP is created with the same name.
Important points •User can override the fields of a Fair Usage Policy.
•The SNR action can be sent with Policy Counter ID.
•FUP is limited to data unit type.
•The Policy Counter ID need not be a reference to NCC counter.
It can be a tag name that is sent in the SNR message.
•The non-policy Threshold Profile Groups can be attached if you want to apply some actions besides the SNR, for example, Send Notification.
•The attached threshold must be in RELEASED state.
•FUP is applicable for Subscription type only.
•FUP is a combination of counter and threshold.
Hence, in the CDR/EDR, counter and threshold will appear with FUP.
•The generated threshold may need to be referenced in rules, but this threshold is not visible in the normal threshold configuration screens.
The naming convention for the two thresholds in the ThresholdProfileGroup is: concatenation of the FairUsagePolicy name + " Initial " / "Throttled " tag + QOS value from the FairUsagePolicy profile Initial Qos threshold ---> Fair Usage Policy name concatenated with "."
and Initial_LOW/HIGH suffix Throttled Qos threshold ---> Fair Usage Policy name concatenated with "."
and Throttled _LOW/ HIGH suffix Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1449Charging User Guide Charging configuration (new GUI) Configuration Log into the new GUI and navigate to Charging → ☰ → Fair Usage Policies .
To define a new calendar, click and provide the details as described in the following table.
Parameter Description Options Mandatory/ Optional Name This parameter indicates the unique name for the fair usage policy.String Mandatory Description Description of the FUP.
String Optional Type This parameter indicates the Data type service.
Enum Mandatory Unit This parameter indicates the unit type such as Byte, GByte, KByte.
Enum Mandatory Default fair usage policy limitThis parameter indicates the FUP limit.
Integer Mandatory Policy counter ID This parameter indicates the ID of policy counter used for FUP.
String Optional Initial quality of serviceThis parameter indicates the quality of service.
Supported values are: High, Medium, Low.Enum Mandatory Throttled quality of serviceThis parameter indicates the value of SNR set for throttling.
If Medium, then the speed is throttled to medium rate.
Supported values are: High, Medium, Low.Enum Mandatory Threshold Profile This parameter indicates the profile of threshold used for FUP.
Enum OptionalTable 126: Parameters for fair usage policies 5.6.5 Rates Rate defines the amount of currency to be charged for each unit of consumption by a call.
For example, 0.05 United States dollars is charged for 1 SMS.
The rate entity defines the rating conversion parameters and the type of the resource allocated or reported.
Rate is applied to a single unit type or type of consumption resource such as time, volume, and unit.
It can define the type of resource or consumption for which it applies.
It is recommended not to change the rate/tax in between calls when the session is ongoing.
The rate entity allows service operators to define the following: •Define granularity of rating Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1450Charging User Guide Charging configuration (new GUI) For example, the rate is expressed as 5 KB for 0.25 United States dollars.
However, beyond this rate, it is important to identify the granularity of the charge.
The granularity may be of a different quantity than that expressed in the rate.
In this example, the granularity may be 512 bytes or 1/10 of 5 KB.
•Define a step rate.
For example, 0.05 United States dollars for the first 100 MB, and 0.03 United States dollars after that.
•Perform one of the following actions for step-rate entity: –Define the step-rate entry duration in the units being rated.
–Define unlimited number of steps in one rate.
Configuration This section describes the parameters to define a rate charged against a call.
Log into the new GUI, navigate to Charging → ≡ → COMPONENT LIBRARY → Rates .
To define a new rate, click to add the basic details as described in the given table: Basic Details Parameter Description Options Mandatory/ Optional Name This parameter indicates the name of the rate entity.
String Mandatory Description This parameter is the description of rate.
String Optional Rate Unit This parameter indicates the unit in which the quantity and duration is specified within the tiered allowance ( charging steps) .Select the required rate type from the predefined rate types in the drop- down list.Mandatory Apply taxation When selected applies tax to the service fee.
Boolean Optional Tax ID ID of a taxation profile.
This drop- down is available only when Apply taxation is selected.Enum Optional Rate Steps Define the amount of currency to be charged for each unit of consumption.
Activation Fee This parameter indicates the cost applied at the initial connection setup of the call.Big decimal Optional To define the rate entity for a tiered allowance ( charging service) , select one of the following values from the Step Type drop- down list: •Fixed feeTable 127: Parameters for rate Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1451Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional •Rate per unit Then, define the given parameters: Click +ADD STEP to add a new step.
Default Fixed Fee This parameter indicates the cost to be charged for the quantity specified in the step.
It is enabled when Fixed fee is selected for Step type .Big decimal Mandatory Default rate per unit This parameter indicates the cost to be charged for the quantity specified in the step.
It is enabled when Rate per unit is selected for Step type .Big decimal Mandatory Default Step Size This parameter indicates the minimum duration for which the call is charged.Big decimal Mandatory Charging Granularity This parameter indicates the unit in which the granularity is specified within the charging steps.Select the required granularity level from the predefined granularity levels in the drop- down list.MandatoryTable 127: Parameters for rate (continued) Examples Example 1: Normal cost Rate to define a normal step type to charge 1 Euro for every 10 MB usage 1.For first 100 MB consumption, 1 Euro is charged per 10 MB usage.
2.For the remaining part of the call, 0.5 Euro is charged per 10 MB usage.
Example 2: Fixed cost Rate to define a normal step type to charge 0.025 Euro for every 10 MB usage for first 100 MB and then deduct Fixed cost = 10 Euro for 50 MB; remaining call is charged with 0.50 Euro for every 10 MB usage 1.For first 100 MB consumption, 0.25 Euro is charged per 10 MB usage.
2.Fixed cost of 10 Euro is deducted for 50 MB.
3.For the remaining part of the call, 0.50 Euro is charged again per 10 MB usage.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1452Charging User Guide Charging configuration (new GUI) Actions associated with rate Action Description Create Creates a rate entity in the database by providing the Name , charging Steps , and Connection Cost parameters.
Read Displays the rate object.
For this operation, a Rate Name is required.
Update Updates the rate entity except Rate ID or Rate Name .
Delete Deletes a rate entity from database.
For this operation, a Rate Name is required.
Note : These actions are valid for internal purposes only and cannot be accessed using the SM GUI.
5.6.5.
1 Voice consumption charged from a Bucket of Unit type Voice consumption can be charged from a Bucket of Unit type.
Operators can use bucket of generic units (that is, Unit type) to be charged for Voice related usage.
Note : For NCC rating computation, the unit type of the resource should be same as per requested service unit type (RSU).
Only Bucket of Unit type can be charged for the seconds reported in Voice Call, where the requested service unit type is TIME.
Example Scenario Consider that a Device has two subscriptions.
The higher priority subscription has a charging from Bucket with 32 generic charging units, with Rate of 15 cost/min, and granularity of 60 sec and the lower priority Charging Service (CS) has a Charging from main balance with Rate 0.09 cost/min and granularity of 15 sec.
The Account Balance is set to 10.
Execution Execute an IMS call for a duration of 130 sec.
Expected behavior •For the 120 seconds the consumption should be done from the Bucket and 30 generic convertible units should be consumed from it (as the Rate is of 15 units/sec with granularity of 60 sec), leaving 2 generic units in the bucket.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1453Charging User Guide Charging configuration (new GUI) •For the remaining 10 seconds, it should be covered from the Account and as the granularity of the Rate is 15 sec.
Therefore (15*0.09€/60 = 0.025 €) 0.03 € is deducted.
Pre-conditions 1.Create the rates as follows: 2.Create a charging service with Charging from Bucket with previously created Rate of 15units/sec and granularity of 60 sec: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1454Charging User Guide Charging configuration (new GUI) 3.Attach the created CS to a Bundle: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1455Charging User Guide Charging configuration (new GUI) 4.Create another CS Charging from main balance with Rate of 0.09cost/min and granularity of 15 sec.
The Priority of this CS is less than the priority of the previously created CS: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1456Charging User Guide Charging configuration (new GUI) 5.Create another bundle with the lower priority CS created.
6.Create a Device and Attach the 2 Bundles created and the account as subscription to the device, and set the Account Balance as 10.
Post-conditions After execution of IMS call for the duration of 130 sec, the Bucket is left with two Generic Units and the Account Balance is 9.97.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1457Charging User Guide Charging configuration (new GUI) 5.6.6 Tiered Allowances (Charging Step) The tiered allowance (charging step) entity allows you to configure allowance limit (bucket) amount from services (bundles) in steps.
The reference of tiered allowance (charging step) must be present in the allowance limit (bucket) definition.
For example, consider that you define 5 steps: 1.Step 1 -> 1 GB 2.Step 2 -> 1 GB 3.Step 3 -> 1 GB 4.Step 4 -> 2 GB 5.Step 5 -> 15 GB Initially, only 1 GB is available to the user.
Once this 1 GB of service (bundle) is exhausted, the next available resource is checked, that is, other services (bundles).
If there is no amount available, then step-up is used and the step allowance limit (bucket) is moved to Step 2 and has 1 GB available for usage.
This process continues until all the data available is exhausted.
Note that the SM service (bundle) is moved to Step 2 only when the call does not consume any bytes in between from another allowance limit (bucket).
The steps are maintained in a list and used to change the initial value of the step charge allowance limit (bucket) instance.
The tiered allowance (charging step) must have at least one step.
The same tiered allowance (charging step) can be referenced from multiple allowance limits (buckets).
Addition, deletion, modification of steps is allowed, but you cannot reduce the step from 1 to 0.
The current step and step up time increments for every step up performed.
If the Unlimited flag is true, then the current step can be more than the number of steps defined in the tiered allowance (charging step) entity.
For example, consider that a step entity has three steps defined as follows: Step Size = 10, Step Fee = NULL Step Size = 20, Step Fee = 2 Step Size = 30, Step Fee = 3 Unlimited = True Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1458Charging User Guide Charging configuration (new GUI) After four step ups are performed (20, 30, 30, 30), the value of currentStep = 4 (which is greater than the number of steps defined) and currentStepUpTime contains the time of last (fourth) step-up performed.
Note : Users can add or remove steps of a tiered allowance.
Configuration Log into the new GUI, navigate to Charging → ≡ → COMPONENT LIBRARY → Tiered allowance .
To define a new tiered allowance (charging step), click to add the details as described in the following table: Parameter Description Options Mandatory/ Optional Name This parameter indicates the name of the tiered allowance.
String Mandatory Description This provides a description for the tiered allowance.
String Optional Unit This parameter indicates the unit type of charging step.
ENUM Mandatory Type This parameter indicates the type of charging step.
ENUM Mandatory Apply taxation When selected applies tax to the service fee.
Boolean Optional Tax ID ID of a taxation profile.
This drop- down is available only when Apply taxation is selected.Enum Optional Tiers Configure the tiered allowance ( charging steps) .
If an allowance limit ( bucket) has its initial value set, then it overrides the first step value.
Edit tier sizes and fees.
Size This parameter indicates the value of each step to be used as the initial value of bucket.
Note : This parameter cannot have a negative value.
The value of last step size defined cannot be zero when the Unlimited flag is true.
Any other step ( except last step) can be zero even if the Unlimited flag is true.
For example, the following configuration is allowed: Step size = 10, Step fee = NULL Step size = 0, Step fee = 0 Step size = 20, Step fee = 2, Unlimited = trueBig decimal MandatoryTable 128: Parameters for tiered allowances Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1459Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional But, if you configure the last step size = 0 with Unlimited flag = true, then such configuration is not allowed as shown in the following example: Step size = 10, Step fee = NULL Step size = 0, Step fee = 0 Step size = 0, Step fee = 2, Unlimited = true The maximum supported value is 1125899906842624 ( in base units) with DB precision = 2.
Note : With increase in DB precision, this value decreases.
For example, in case DB precision is set to 5, the maximum supported value is 92233720368547.
Fee This parameter indicates the fee for the step.
If a value is defined, then this value gets deducted from the account before step up.
You can configure fee for step 1 when there is only one step configured in charging step entity and the Unlimited flag is true.
Note that this parameter cannot have negative value.Big decimal Optional Recurring If this flag is selected, then the step keeps recurring.
Boolean Optional Threshold Profile This parameter indicates the threshold profile already defined in the system that you can attach to the tiered allowance.
.ENUM OptionalTable 128: Parameters for tiered allowances (continued) Actions associated with a tiered allowance (charging step) Action Description Create Creates a tiered allowance ( charging step) entity in database.
Read Displays a particular tiered allowance ( charging step) entity as per the data retrieved from database.
Update Updates a particular tiered allowance ( charging step) entity with provisioning to MEs.
Delete Deletes a particular tiered allowance ( charging step) entity from database.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1460Charging User Guide Charging configuration (new GUI) Action Description Provision Processes the update request for tiered allowance ( charging step) entity for provisioning.
retryprovision Retries provisioning of tiered allowance ( charging step) entity to an ME that was previously failed.
resetprovision Clears the provisioning status for failed provisioning attempt on ME.
Note : These actions are valid for only for internal purposes and cannot be accessed using the SM GUI.
5.6.6.
1 Versioning (Tiered Allowances) Tiered Allowance inside the Charging Logic supports adding, removing, and updating the charging steps.
When a Tiered Allowance (TA) inside the Charging Logic is updated, it affects the subscription either at CCR (immediately), or BCR based on the bundle versioning configuration.
Tiered Allowance (TA) with versioning To update the Tiered Allowance (TA) with versioning, the chargingServiceId is updated to the latest Charging Service version during the versioning update for BucketInstance .
The BucketInstance is moved to the next step at step-up invocation, and the new version changes are applied to get the next steps from the new Charging Logic version.
Note : The step-up for Tiered Allowance considers the new/updated steps from the new Charging Logic versions.
TA versioning is done in the following steps: •Skip the versioning update of the BucketInstance charging step, and wait until the current step is completed.
•Update the next charging step from the new Charging Logic version.
Note : Updating the Tiered Allowance with versioning depends on the application preference Step- Up On Commit , and Runtime Override Scenarios Pre-cofiguration for the scenarios Following are the pre-configurations for the scenarios listed further: •Versioning is enabled - Set the application preference Versioning Enabled to true .
•OverrideInstance - false Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1461Charging User Guide Charging configuration (new GUI) •Tiered Allowance - [10 20/5 30/10] •Recurring Tiered Allowance - [5 10/5 20/10] •Create a Charging Logic - V1.0 ChLogic •Create a BCR- every 1 month.
•Create an Account , Device , Service , and Subscription .
Pre-requisite for the following scenarios: •Step-Up On Commit is false .
No Scenario Configuration 1 Update allowance limit steps.
( Immediate versioning/ Immediate call)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with Tiered Allowance ( TA) of [10 20/ 5 30/ 10].
2.Consume 7GB.
Result: 7GB is consumed from V1.0 ch Logic .
Current Value = 3GB .
3.Create another Charging Logic ( V2.0 ch Logic ) with a TA of [35 45/ 5 55/ 10].
4.Consume 7GB.
Result: 3GB is consumed from the first step in V1.0 ch Logic .
4GB is consumed from V2.0 ch Logic .
Initial Value = 55, Current Value = 41.
2 Update allowance limit steps.
( Immediate versioning/ under commit)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with Tiered Allowance ( TA) of [10 20/ 5 30/ 10].
2.Http Create 11GB.
Result: 11GB is reserved.
Initial Value = 30, Current Value with reservation = 30, Current Value without reservation = 19.
Fee of the second step from V1.0 ch Logic is deducted from the account.
3.Create another Charging Logic ( V2.0 ch Logic ) with a TA of [35 45/ 5 55/ 10].Table 129: Tiered Allowance with version override scenarios Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1462Charging User Guide Charging configuration (new GUI) No Scenario Configuration 4.Http Update to consume 2GB, and reserve 2GB.
Result: Initial Value = 10, Current Value with reservation = 28, Current Value without reservation = 26.
5.Http Release 2GB.
Result: Current Value with reservation = 26, Current Value without reservation = 26.
6.Consume 30GB.
Result: Initial Value= 85, Current Value with reservation = 51, Current Value without reservation = 51.
3 Update allowance limit steps.
( BCR versioning)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with Tiered Allowance ( TA) of [10 20/ 5 30/ 10].
2.Consume 7GB.
Result: 7GB is consumed from the first step in V1.0 ch Logic .
3.Create another Charging Logic ( V2.0 ch Logic ) with a TA of [35 45/ 5 55/ 10].
4.Trigger BCR.
Result: Moves to the first step in V2.0 ch Logic .
Initial Value = 35, Current Value = 35.
4 Add a step to the allowance limit when the version changes.
( Immediate versioning)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with Tiered Allowance ( TA) of [10 20/ 5 30/ 10] .
2.Http Create 55GB.
Result: 55GB is reserved.
Current Value with reservation = 60, Current Value without reservation = 5.
Fee of the second step and third step is deducted from the account.
3.Create another Charging Logic ( V2.0 ch Logic ) with a TA of [35 45/ 5 55/ 10 65/ 15].Table 129: Tiered Allowance with version override scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1463Charging User Guide Charging configuration (new GUI) No Scenario Configuration 4.Http Update 50GB, and reserve 20GB.
Result: Initial Value= 125, Current Value with reservation = 75, Current Value without reservation = 55.
5.Http Release 20GB.
Result: Current Value with reservation = 55, Current Value without reservation = 55.
5 Remove a step from the allowance limit when the version changes.
( Immediate versioning)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with Tiered Allowance ( TA) of [10 20/ 5 30/ 10] .
2.Http Create 25GB.
Result: 25GB is reserved.
Current Value with reservation = 30, Current Value without reservation = 5.
Fee of the second step is deducted from the account.
3.Create another Charging Logic ( V2.0 ch Logic ) with a TA of [35 45/ 5].
4.Http Update 25GB, and reserve 2GB.
Result: Current Value with reservation = 5, Current Value without reservation = 3.
5.Http Release 2GB.
Result: Current Value with reservation = 3, Current Value without reservation = 3.
6.Try to consume 7GB.
Result: Quota Limit Reached.Table 129: Tiered Allowance with version override scenarios (continued) Pre-requisite for the following scenarios: •Step-Up On Commit is true .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1464Charging User Guide Charging configuration (new GUI) No Scenario Configuration 1 Update Tiered Allowance steps with recurring TA.
( Immediate versioning/ Immediate call)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with recurring Tiered Allowance ( TA) of [5 10/ 5 20/ 10].
2.Consume 60GB.
Result: Initial Value = 75, Current Value with reservation = 15, Current Value without reservation = 15.
3.Create another Charging Logic ( V2.0 ch Logic ) with recurring TA of [50 60/ 20 70/ 40].
Result: 60GB is consumed from V1.0 ch Logic .
4.Consume 20GB.
Result: Consumption is based on V2.0 ch Logic .
Initial Value = 145, Current Value with reservation = 65, Current Value without reservation = 65.
2 Update Tiered Allowance steps.
( Immediate versioning/ under commit)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with Tiered Allowance ( TA) of [10 20/ 5 30/10].
2.Reserve 11GB.
Result: 11GB is reserved.
Current Value with reservation = 30, Current Value without reservation = 19.
Fee of the second step from V1.0 ch Logic is reserved.
3.Create another Charging Logic ( V2.0 ch Logic ) with a TA of [35 45/ 7 55/ 13].
4.Consume 2GB, and reserve 2GB.
Result: 2GB is consumed, and 2GB is reserved from the first step in V1.0 ch Logic .
Current Value with reservation = 8, Current Value without reservation = 6.
Reserved fee is cancelled.
5.Consume 2GB.Table 130: Tiered Allowance with version override scenarios Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1465Charging User Guide Charging configuration (new GUI) No Scenario Configuration Result: Current Value with reservation = 6, Current Value without reservation = 6.
6.Consume 30GB.
Result: Current Value with reservation = 21, Current Value without reservation = 21.
3 Add a step to the Tiered Allowance when the version changes.
( Immediate versioning/ under commit)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with Tiered Allowance ( TA) of [10 20/ 5 30/10].
2.Reserve 50GB.
Result: 55GB is reserved.
Initial Value = 60, Current Value with reservation = 60, Current Value without reservation = 5.
Fee of the second and third steps from V1.0 ch Logic is reserved.
3.Create another Charging Logic ( V2.0 ch Logic ) with a TA of [35 45/ 7 55/ 13 65/ 20].
4.Consume 50GB, and reserve 20GB.
Result: 50GB is consumed, and 20GB is reserved from the first step in V1.0 ch Logic .
Initial Value = 125, Current Value with reservation = 75, Current Value without reservation = 55.
Reserved fee is deducted.
5.Consume 20GB.
Result: Current Value with reservation = 55, Current Value without reservation = 55.
4 Remove a step from the Tiered Allowance when the version changes.
( Immediate versioning)1.Create a subscription to Charging Logic ( V1.0 chLogic ) with Tiered Allowance ( TA) of [10 20/ 5 30/10].
2.Reserve 25GB.
Result: 25GB is reserved.
Initial Value = 30, Current Value with reservation = 30, Current Value without reservation = 5.
Fee of the second step from V1.0 ch Logic is reserved.Table 130: Tiered Allowance with version override scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1466Charging User Guide Charging configuration (new GUI) No Scenario Configuration 3.Create another Charging Logic ( V2.0 ch Logic ) with a TA of [35 45/ 7].
4.Consume 25GB, and reserve 2GB.
Result: 25GB is consumed, and 2GB is reserved from the second step in V1.0 ch Logic .
Initial Value = 30, Current Value with reservation = 5, Current Value without reservation = 3.
Reserved fee is deducted.
5.Consume 2GB.
Result: Initial Value = 30, Current Value with reservation = 3, Current Value without reservation = 3.
6.Try to consume 7GB.
Result: Quota Limit ReachedTable 130: Tiered Allowance with version override scenarios (continued) 5.7 Threshold profiles (Thresholds) Threshold is the usage definition or aggregate view boundary or limit applied to a counter, bucket, or main account balance with a set of associated actions executed upon crossing that boundary or limit.
A threshold profile must contain at least one-threshold profile in it.
A threshold profile must contain at least one threshold in it.
The threshold information is defined in a single Threshold Profile table.
Threshold is embedded within the threshold profile which in turn is embedded within the threshold profile.
Note : A bucket or counter or AV can refer to zero or more threshold profile of the same unit type.
If there is an over commit, the threshold gets executed twice.
This happens when the extra over commit amount is more than the gap to the next threshold value.
When a threshold is reached, NCC performs either one or a combination of the following actions: •Notification-Stop : This action notifies to stop using the resource and switch to the next resource.
•Notification-Continue : This action notifies to continue using the same resource.
•Notification-Reject : This action notifies and rejects the call.
•Reject : This action rejects the call.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1467Charging User Guide Charging configuration (new GUI) •Send-SNR : This action notifies to send SNR.
The value should be SendSNR.
•Send-Notification : This action notifies to send notification to the configured device.
Note : •NCC does not read or evaluate threshold actions for direct debit requests.
•SNR is not supported for Account threshold.
Figure 63: Example for threshold Note : Operators define the thresholds.
For the preceding example, the threshold profile is defined as follows: •Threshold profile group 1 : It contains Threshold profile 1, Threshold profile 2, and Threshold profile 3.
The unit type is volume.
•Threshold profile 1 : It is an absolute type profile that contains the Threshold 1 with a value of 400 MB from bucket.
The unit is in MB.
•Threshold profile 2 : It is an absolute type profile that contains Threshold 2 with a value of 1 GB from the bucket.
The unit is in GB.
•Threshold profile 3 : It is a percentage type profile that contains two thresholds - Threshold 3 and Threshold 4.
•Threshold 3 : It is defined with a value of 80%.
•Threshold 4 : It is defined with a value of 100%.
The bucket of 5 GB refers to the Threshold profile group 1.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1468Charging User Guide Charging configuration (new GUI) Configuration Log into SM GUI, navigate to Charging → ☰ → Threshold profiles .
To define a new threshold, click to add the basic details and profile configuration as described in the given table: Basic details Parameter Description Options Mandatory/ Optional Name The parameter indicates the name of the threshold profile.
String Mandatory Applicable to Indicates the allowance/ balance to which the threshold profile is applicable to.
Following are the valid values: •Allowances and metering •Account main balances •Account loan balancesEnum Optional Type This parameter indicates whether the type of threshold such as Data, Time, Money, Message.Select the required type from the drop- down list.Mandatory Description This parameter provides details related to the threshold profile entity.String Optional Applicability ConditionThis field is not in use.
- - Reservation ThresholdThis parameter indicates whether the threshold must be triggered in case of reservation.
The default value is False.
Note the following important points related to this parameter: •Threshold flags like Milestone, Policy based are set to false in case Reservation flag is set.
•Reservation Threshold is applicable only for Bucket entity currently.
This kind of threshold is not allowed to be attached with any other entity like Counter/ Account/ AV/UCS.
•Reservation Threshold flag set has similar implementation in reservation call, as of thresholds with reservation flag unset in commit call.
They are also reset during bucket reset/ renew.Select this check box if you want to trigger the threshold in case of reservation.Optional OCS Policy ThresholdThis parameter indicates whether the threshold is a policy threshold or not.
Select this check box to indicate a policy threshold.
Deselect the check box to indicate it is not a policy threshold.
However, if the flag is False and Threshold Rule Action is Send- SNR ,Select this check box to indicate a policy threshold.OptionalTable 131: Basic details for threshold profile Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1469Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional then the system forces the user to set the flag to true and then threshold is treated as a policy threshold.
If a Threshold Profile has two thresholds at same value, then the Send- SNR action for the second threshold at that value is considered to get the signaling state.
Dynamic Milestone FlagThis parameter indicates the milestone, which is a percentage type threshold when this parameter is true with the empty rule container.
The parameter value is dependent on either of the following conditions: •True : If the flag is True , then the threshold profile is used as a milestone.
Select this check box to indicate the threshold profile group is used as a milestone.
•False : If the flag is False , then the threshold profile group is not used as a milestone.
Deselect this check box to indicate the threshold profile is not used as a milestone.
Note : This flag is only used for dynamic milestone feature, which overrides the slicing reduction function if it is turned on.
If the Dynamic Milestone feature is not used, keep it as False to avoid impact to the slicing reduction function.Select this check box to indicate the threshold profile is used as a milestone.OptionalTable 131: Basic details for threshold profile (continued) Profile configuration - Percentage Multiple percentage thresholds can be configured in a percentage threshold profile.
Applicability condition can be provided at the percentage threshold profile level.
Rules (both applicability conditions and actions) can be defined at the threshold level.
If multiple percentage thresholds are defined, then you can change their priority order using the up ( ) and down ( ).
These symbols appear at the top-right corner of the threshold pane.
Figure 64: Percentage profile - summary and applicability condition Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1470Charging User Guide Charging configuration (new GUI) Figure 65: Percentage profile - threshold details Parameter Description Applicability Condition You can define applicability conditions for the percentage threshold profile.
This plays an important role in the threshold profile selection.
If the applicability conditions are not met, the threshold profile is not considered.
Select Type PERCENTAGE and click +THRESHOLD to add the first ( or more) percentage values associated with the threshold profile group.
(%)* This parameter indicates the percentage associated with the threshold profile.
Recurring This parameter indicates whether the threshold is recurring.
Rule ( conditions and actions) This parameter allows you to provide the rule ( both applicability condition and action) for the threshold.
Click ADD RULE to add another rule for the threshold.Table 132: Parameters for percentage profile Profile configuration - Absolute Multiple absolute thresholds can be configured in an absolute threshold profile.
Applicability condition can be provided at the absolute threshold profile level.
Rules (both applicability conditions and actions) can be defined at the threshold level.
If multiple absolute thresholds are defined, then you can change their priority order using the up ( ) and down ( ) symbols.
These symbols appear at the top-right corner of the threshold pane.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1471Charging User Guide Charging configuration (new GUI) Figure 66: Absolute profile - summary and applicability condition Figure 67: Absolute profile configuration - threshold details Parameter Description Applicability Condition You can define applicability conditions for the absolute threshold profile.
If the applicability conditions are not met, the threshold profile is not considered.
Note : The applicability condition is relevant only for Policy.
Click ABSOLUTE FROM START to add the first ( or more) absolute start threshold values associated with the threshold profile group.
Absolute Start Threshold Value* This parameter indicates the absolute value of to mark the beginning of threshold defined in the given type.Table 133: Parameters for absolute profile Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1472Charging User Guide Charging configuration (new GUI) Parameter Description Type* This parameter indicates the unit of the absolute threshold.
Valid values: KByte, GByte, MByte, Byte Recurring* This parameter indicates whether the threshold is recurring.
Rule ( conditions and actions)This parameter provides the rule ( both applicability condition and action) for the threshold.
Click ADD ROW to add another rule for the threshold.
Click ABSOLUTE FROM END to add the first ( or more absolute end threshold values associated with the threshold profile group) .
Value* This parameter indicates the absolute value of to mark the end of threshold defined in the given type.
Type* This parameter indicates the unit of the absolute threshold.
Valid values: KByte, GByte, MByte, Byte Recurring* This parameter indicates whether the threshold is recurring.Absolute End Threshold Rule ( conditions and actions)This parameter allows you to provide the rule ( both applicability condition and action) for the threshold.
Click ADD ROW to add another rule for the threshold.
Note : Absolute from End threshold type can be referenced in the custom counters, and metering limits.
Click ABSOLUTE FROM ZERO to add the first ( or more absolute end threshold values associated with the threshold profile group) .
Note : The ABSOLUTE FROM ZERO threshold is applicable for main account balance, and it cannot be a recurring threshold.
The threshold applied to main account balance supports both positive and negative values for the ABSOLUTE FROM ZERO threshold type, such as + 100 USD or - 100 USD.
Name Name of the threshold.
Balance type The available balance types are as follows: •Main balance •Overage limitAbsolute from Zero Value This parameter indicates the absolute value.
Money is the only unit type supported for this profile.
Threshold value can be defined for both main balance and overage limit.
The value defined for the overage limit is used to evaluate threshold rules and actions, if configured.Table 133: Parameters for absolute profile (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1473Charging User Guide Charging configuration (new GUI) Parameter Description Rule ( conditions and actions)This parameter provides the rule ( both applicability condition and action) for the threshold.
Click ADD ROW to add another rule for the threshold.Table 133: Parameters for absolute profile (continued) Profile configuration - both absolute and percentage The following figure displays a scenario where both percentage and absolute thresholds are defined.
The top tow panes display the thresholds defined along with applicability conditions for percentage and absolute threshold profiles.
The priority order for the absolute and percentage threshold profiles can be swapped using the ⇅ symbol.
Figure 68: Both absolute and percentage profile - summary and applicability condition Actions associated with a threshold profile Action Description Create Used to create the threshold profile entity in database by providing the mandatory and optional parameters.
Read Used to display the threshold profile entity data fetched from database.
Threshold Profile Group Exists Used to check if the Threshold Profile Group exists in database for the given Id.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1474Charging User Guide Charging configuration (new GUI) Action Description Update Used to update a particular threshold profile entity in database.
Delete Used to delete a particular threshold profile entity from database.
Note : These actions are valid for internal purposes only.
It is not accessible through the SM GUI for operators.
Evaluation of thresholds with reject action on step fee This feature provides the capability to evaluate single, or multiple thresholds having Reject/Notification- Reject action on the step fee.
Call is rejected, and a notification is sent to the subscriber in the following cases: •If there is a request for reservation from step bucket when a step cost counter's reject threshold is crossed, and the step bucket's current step is fully utilized (bucket's CurrentValue = 0), then reservation is not possible as counter's existing threshold is already crossed.
A notification is triggerred that informs the subscriber about the same.
•When a step cost counter's reject threshold is not crossed, and the step bucket's current step is fully utilized (bucket's CurrentValue = 0), then step up is not possible as the DeltaValue (Reject) < NextStepFee.
A notification is triggerred that informs the subscriber about the same.
In this case NCC rejects the consumption with the result code 4012.
The following application preferences must be set to true for this feature to work: •Granularity Skip for Low Balance •Step-Up at Commit •Use first all Steps EDR Generator , and Notification and EDR Logging Enabled flags are set to true .
NCC does not check the upcoming threshold action reject for over-commit scenarios.
Hence, the same base functionality of slice reduction on over commit is not applicable to upcoming Spending limit applied on Step Fee being accumulated in the counter.
Example: Cost Counter is crossed in case of over-commit scenario even when cost counter reaches Notification-Reject threshold on step fee that is charged for the step bucket.
Charging step configuration: •step size = 1000 •step size = 800 step fee = 24 •step size = 200 step fee = 16 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1475Charging User Guide Charging configuration (new GUI) Threshold Profile Group (TPG): Absolute From Start (ABS) at 35 with Notification-Reject action.
Multi-bundle cost counter, Usage Limit (ULI) 35 with Threshold Profile Group.
Execution: •CCR(I) RSU = 1000 Expected outcome: step = 1, cost counter = 0, GSU = 1000.
•CCR(U1) USU = 1000, RSU = 800.
Expected outcome: step = 1, cost counter = 0, GSU = 800.
•CCR(U2) USU = 900, RSU = 100.
Expected outcome: step = 3, cost counter = 40, GSU=100.
•CCR(T) USU=100.
Expected outcome: Bucket consumed = 2000, Cost Counter = 40 (Cost Counter value crossed Usage Limit of 35) Points to be noted •This is applicable for SCUR (Gy/NCHF /IMS) related calls.
•This feature works only when Step-up at commit is true .
•Threshold limit is applied to a multi-bundle counter, or subscription counter.
•Multi-bundle counters can accumulate the usage, or cost consumed from multiple bundles that are subscribed by the device.
However, if the bundle subscriptions are at group level or hierarchy level, then the multi-bundle counter does not accumulate any usage, and cost consumed from multiple bundles subscribed by the group.
•Absolute from End threshold does not apply any threshold limit or actions of hard-stop/soft-stop on the counter of cost-type consumption, which specifically accumulate the Step Fee of the Step Bucket.
Examples Example 1: When multiple thresholds are crossed at reservation and Notification–Reject has been reached for the step fee, then call is rejected with result code 4012 and a notification is sent.
Charging step configuration: •step size = 1000 •step size = 800 step fee = 24 •step size = 200 step fee = 16 Threshold Profile Group: Absolute From Start Multi-bundle counter, Usage Limit = 35 with Threshold Profile Group.
Data bucket of 100 bytes.
Bundle1: ChargingStep1 with tariff as step.
Bundle3: Multi-bundle cost counter Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1476Charging User Guide Charging configuration (new GUI) Bundle4: Data Bucket Device1: Bundle1, Bundle3, and Bundle4 are attached to the device Exceution: •CCR(I) RSU = 1000MB, Expecte outcome: step=1, cost counter=0, GSU=1000.
•CCR(U1) USU = 1000MB, RSU = 800MB, Expected outcome: step = 1, cost counter = 0, GSU = 800.
•CCR(U2) USU = 800MB, RSU=10Byte Expecte outcome: step=2, cost counter=24, result code=4012.
Notification is sent for reject •CCR(T) with no MSCC tag.
Expected outcome: Bucket consumed=1800, cost counter=24 Note : When the step bucket is fully consumed, and the reject threshold is reached for step fee on cost counters, even if the device has another data bucket available, the data bucket is not consumed, and the result code 4012 is sent.
Example 2: Call is rejected with result code 4012, and the cost counter reaches Notification-Reject threshold on step fee that is charged for the step bucket.
Verify that notification is sent both for continue and reject.
Charging step configuration: •step size = 1000 •step size = 800 step fee = 26 •step size = 200 step fee = 15 Threshold Profile Group (TPG): ABS at 26 with Notification-Continue action, and at 35 with Notification- Reject action.
Multi-bundle cost counter, Usage Limit (ULI) 35 with Threshold Profile Group.
Exceution: •CCR(I) RSU = 1000 Expected outcome: step = 1, cost counter = 0, GSU = 1000 •CCR(U1) USU = 1000, RSU = 800 Expected outcome: step = 1, cost counter = 0, GSU = 800 •CCR(U2) USU = 800, RSU = 10 Expected outcome: step = 2, cost counter = 26, result code=4012.
Notification is sent both for continue and reject.
•CCR(T) with no MSCC tag.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1477Charging User Guide Charging configuration (new GUI) Expected outcome: Bucket consumed = 1800, cost counter = 26 Note : The first notification (continue) is sent in commit, and the second notification (Reject) is sent in reservation.
Example 3: When the Notification-reject threshold on Step-fee has already been crossed, then for next reservation, call is rejected with result code 4012, and a notification is sent.
Complex map is configured with the multi-bundle counter's name.
The number of times a notification can be sent is 2.
Charging step configuration: •step size = 1000 •step size = 800 step fee = 24 •step size = 200 step fee = 16 Threshold Profile Group: Percentage Multi-Bundle Counter, Usage Limit = 40 with Threshol Profile Group.
Data bucket of 100 bytes.
Bundle1: ChargingStep1 with tariff as bucket.
Bundle3: Multi-bundle cost counter Bundle4: Data Bucket Device1: Bundle1, Bundle3, and Bundle4 are attached to the device Execution: •CCR(I) RSU = 1000 Expected outcome: step = 1, cost counter = 0, GSU = 1000 •CCR(U1) USU = 1000, RSU = 800 Expected outcome: step = 1, cost counter = 0, GSU = 800 •CCR(U2) USU = 800, RSU = 150 Expected outcome: Step = 2, cost counter = 24, GSU = 150.
Notification is sent for continue •CCR(U3) USU = 150, RSU = 50 Expected outcome: step = 3, cost counter = 40, GSU = 50.
Notification is sent for reject •CCR(U4) USU = 50, RSU = 10 Expected outcome: step = 3, cost counter = 40, result code = 4012 •CCR(T) with no MSCC tag.
Expected outcome: Bucket consumed = 2000, cost counter = 40.
Notification is not sent for reject as it is already sent.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1478Charging User Guide Charging configuration (new GUI) Note : In case the counter threshold is reached but the data is available in the bucket, when the bucket is exausted in the next update, if any further reservation is done, then only the result code 4012 is sent.
•CCR(I2) RSU=1000, result code= 4012.
Notification is sent for reject.
•CCR(T2) with no MSCC tag.
•CCR(I3) RSU=1000, result code = 4012.
Notification is not sentt as the number of times a notification has to be sent is configured as two.
•CCR(T3) with no MSCC tag.
Configuration to trigger Notification : 1.Complex Map: • • 2.Threshold Profile group: • • 3.Multi-Bundle counter: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1479Charging User Guide Charging configuration (new GUI) • 4.Tiered Allowance : • 5.Charging logic: • • Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1480Charging User Guide Charging configuration (new GUI) • 6.Allowance Limit: • • • 7.Bundle: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1481Charging User Guide Charging configuration (new GUI) • • • 8.Device: • • Additional information •Notification is triggerred only when the threshold is configured by THRESHOLD.Threshold-Trigger- Type = ThresholdTriggerType_RESERVATION .
With this configuration, the existing notification in the commit is also triggered on the threshold crossing .
However, in case of CCR-U, if the commit value crosses the threshold, and there is an RSU as well, then only one notification is triggered.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1482Charging User Guide Charging configuration (new GUI) •If the threshold is not configured by THRESHOLD.Threshold-Trigger-Type = ThresholdTriggerType_RESERVATION , then only the existing notification in commit is triggered on the threshold crossing.
•Notification is not triggered in cases where any reservation (partial or complete) is done from the step bucket.
•Min slice is not considered in case of step bucket when step size is less than Min-Slice and bulk step- up is not performed.
5.7.
1 Determining rate based on counter threshold Rate can also be determined based on the counter threshold, that is, using the action RATING.Threshold- Rate, the Rate ID can be determined.
See the following examples: •If a counter has a threshold from threshold 0 to threshold 1, then the rate is rate 1.
•If a counter has a threshold from threshold 1 to threshold 2, then the rate is rate 2.
•If a counter has a threshold from threshold 2, then the rate is rate 3.
If the threshold rate can be applied for a call, then it has higher priority than the normal rate (normal rate is determined from RATING.Rate action).
Following are the action attributes to support rate to be determined from threshold: Action Definition Options RATING.
Threshold- Rate This action attribute is the name defined within the RATING result context.
It indicates the output tariff rule as threshold rate.
If the related counter threshold is crossed, the threshold rate can be applied to the monetary resource, that is, bucket of monetary type or account balance.Input a Rate_ STRING, Counter Id_STRING, Crossed Threshold_ STRING and Target_ STRING.
TThe Target_ STRING is an optional text string to be parsed.
If it is not filled, then resource gets selected based on charging service' s available resource ( example, monetary bucket → main balance) .
RATING.
Threshold- Next- Rate This action attribute is the name defined within the RATING result context.
It indicates the output tariff rule as threshold next rate.
If the related counter threshold is crossed, the threshold next rate can be applied as secondary rate to the monetary resource, that is, bucket of monetary type or account balance.Input a Rate_ STRING, Counter Id_STRING, Crossed Threshold_ STRING and Target_ STRING.
The Target_ STRING is an optional text string to be parsed.
If it is not filled, then resource gets selected based on charging service' s available resource ( example, monetary bucket → main balance) .Table 134: Action attributes Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1483Charging User Guide Charging configuration (new GUI) Following are the assumptions on threshold rate: •The counter and threshold configuration in Tariff rule is consistent with the configuration in the counter entity.
•The recurring threshold is not supported.
•The threshold definition name is unique when multiple threshold group profiles are attached to the counter.
If a duplicate threshold definition name exists, the first threshold instance with that name in counter instance will be checked.
•The reserved amount for the counter is not considered when checking whether the threshold is crossed or not.
•The slice reduction feature must be turned on to make sure that the threshold is considered during quota allocation and for over-committed usage, it can apply the rate based on crossed threshold.
Example Following is the example that shows the provisioning of threshold rate that can be applied to a call.
In this example, when the ThresholdPercent1 threshold of testcounter is crossed, the rate testrate1 is applied to bucket TBYBucket .
If the ThresholdPercent2 threshold of testcounter is crossed, the rate testrate2 is applied to bucket TBYBucket .
If the testcounter's last crossed threshold is not ThresholdPercent1 or ThresholdPercent2 , then the base rate testrate is applied to TBYBucket .
5.7.2 ABE TPG for ULI The Absolute from End (ABE) Threshold Profile Group (TPG) configuration for Usage Limit (ULI) can be done as follows.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1484Charging User Guide Charging configuration (new GUI) In the Thresholds entity, configure the following ABE ULI thresholds for Absolute profile: Name: AbsoluteEndThreshold2 Value: 200 Byte Name: AbsoluteEndThreshold3 Value: 300 Byte Name: AbsoluteEndThreshold4 Value: 400 Byte Name: AbsoluteEndThreshold5 Value: 500 Byte Name: AbsoluteEndThreshold6 Value: 600 Byte Name: AbsoluteEndThreshold7 Value: 700 Byte Name: AbsoluteEndThreshold8 Value: 1000 Byte Name: AbsoluteEndThreshold1 Value: 0 Byte Following is the Charging Service configuration: In the preceding TPG configuration, 1000 is the highest threshold and 0 is the lowest threshold.
Therefore, 1000 threshold is crossed first and 0 threshold is crossed last.
For this, the values are populated in the Threshold Context: ThresholdValue and ThresholdCrossingValue as follows: •Threshold at 1000 : Threshold value is 1000, threshold crossing value is 0, 0 byte consumption.
•Threshold at 600 : Threshold value is 600, threshold crossing value is 400, 400 byte consumption.
•Threshold at 400 : Threshold value is 400, threshold crossing value is 600, 600 byte consumption.
•Threshold at 0 : Threshold value is 0, threshold crossing value is 1000, 1000 byte consumption.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1485Charging User Guide Charging configuration (new GUI) When the current value or usage limit in counter instance is updated through REST API, reset of ABE is also done.
5.7.3 ABE TPG for OLI The Absolute from End (ABE) Threshold Profile Group (TPG) configuration for Overage Limit (OLI) can be done as follows.
In the Thresholds entity, configure the following ABE OLI thresholds for Absolute profile: Following is the Charging Service configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1486Charging User Guide Charging configuration (new GUI) The counter has usage limit 1000 and overage limit 200 byte.
For this, the values are populated in the Threshold Context: ThresholdValue and ThresholdCrossingValue as follows: •Threshold at 200 : Threshold value is 200, threshold crossing value is 0, 1000 byte consumption.
•Threshold at 50 : Threshold value is 50, threshold crossing value is 150, 1150 byte consumption.
If the consumption continues even after crossing overage limit, then the ThresholdValue and ThresholdCrossingValue as follows: •Threshold at 200 : Threshold value is 200, threshold crossing value is 0, 1200 byte consumption.
•Threshold at 50 : Threshold value is 50, threshold crossing value is 150, 1350 byte consumption.
When the current value or overage limit in counter instance is updated through REST API, reset of Overage ABE is also done.
5.8 Lifecycles Log into new GUI, navigate to Charging → ☰ → Lifecycles .
See Lifecycle parameters on page 1578 for lifecycle related information.
See Events associated with lifecycles on page 1601 for lifecycle events related information.
See Actions associated with lifecycles on page 1609 for lifecycle actions related information.
5.8.
1 Exporting and importing lifecycles Lifecycle data can be exported using the SM GUI to a json text file.
This can be further used for importing to another NCC system running the same software version.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1487Charging User Guide Charging configuration (new GUI) From SM GUI on the Lifecycles listing page, select one or more lifecycle items and click the export icon.
Save the json file.
On the target system GUI, on the same Lifecycles page, click import and select the file.
If multiple lifecycles are exported at once, the downloaded file is in zip format, containing multiple json files.
To import these, you need to unzip and select the json files individually for import.
On import, you can overwrite or skip any lifecycle entities that may already exist on the target system.
Any lifecycles that exist and are overwritten, if they are published to MEs, will update the ME copies as well.
Any lifecycle that do not already exist, get created, but you have to publish them.
Note : Lifecycles may have implicit references to notification templates.
These can be exported and imported in the same manner as for lifecycles.
You need to determine which templates might be required by the lifecycles you are transferring, that are not already present on the target system.
5.9 Taxation (Taxation Profile) The Taxation entity includes multiple percentage tax rates and applicability conditions.
The tax is applicable only to a monetary type of allowance limit (bucket) and rate is mandatory for the taxation applied to a monetary resource.
If the taxation reference is not provided in the charging service tariff rule, then the taxation cannot be applied.
The taxation information cannot be retrieved from a bundle or account.
Nokia recommends not to change the tax or rate in between calls or for an ongoing session.
The taxation can be attached to a service (bundle), account, tiered allowance, rate or lifecycle to implement the tax.
However, taxation is not applicable for refund cases.
The CDR tags generated for taxation are applicable on committed and reserved values.
The taxation can also be defined for the following lifecycle actions when the fee is used: •Charge Fee Action : If the taxation reference is not given within the lifecycle, which means the taxation profile is not given within the Charge Fee Action , then no tax is applied.
•Add Subscription Action : If the taxation reference is not given within the lifecycle, which means the taxation profile is not given in the Add Subscription Action , then the tax related information is retrieved from bundle or account.
•Renew Subscription Action : If the taxation reference is not given within the lifecycle, which means the taxation profile is not given in the Renew Subscription Action , then the tax related information is retrieved from bundle or account.
Note : NCC charging uses the CEIL rounding method only for taxed amount.
Configuration Log into the SM GUI, navigate to Charging → ☰ → Taxation .
To add a new taxation profile, click CREATE PROFILE to add basic details as described in the given table: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1488Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional ID This parameter indicates the tax rate Id.String Mandatory At least one tax rate must be defined Rate ( %) This parameter indicates the tax percentage.
The range is 0 - 100% .Integer Mandatory At least one tax rate must be definedTable 135: Parameters for taxation Configuring rule expressions The rule expressions can be configured using roaming, zoning, call type so on to the special taxation Id to determine whether the taxation is applicable or not.
If the criteria check of the taxation matches, then while reserving the amount from account or monetary bucket for the call, NCC uses the tax rate percentage (if exists).
The Taxation fee = committed fee * tax rating percent .
If there are multiple tax rate percentages, then the summary of all the tax rates are taken as taxation fee, that is, Taxation fee = committed fee * per tax rating percent .
The committed fee plus the total taxation fee is charged to the account or monetary bucket.
CEIL rounding method is used for taxed amount.
CEIL takes the number and rounds it to the nearest integer value above its current value.
For example, the ceiling of 2.31 is 3.
Example: The following table provides details on the parameter values considered for the example.
Taxation ID Tax rate percentage Tax1 10% The account balance is 200 USD attached to an iPhone device.
Case 1: Lifecycle actions The account balance is 200 USD.
In the lifecycle Charge Fee Action , the taxation Id Tax1 is attached with fee 100 USD.
After execution of this action, the account balance is 90 and 110 is deducted.
Case 2: Tax applied to main balance Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1489Charging User Guide Charging configuration (new GUI) You can define the tariff in the charging service to apply tax to the main balance as follows.
In this example, Tax1 is the tax defined in the taxation profile and note that the Main Balance is hard-coded.
RATING.Rate ("Rate1", "Main Balance") and RATING.Tax-Selection = "Tax1" Case 3: Sample tariff with taxation The following figure shows a sample tariff rule with tax to be applied to the SMS call defined in a charging service.
Actions associated with taxation Action Description Create Used to create the taxation in database by providing the mandatory and optional parameters.
Read Used to display the taxation record per the data retrieved from database.
Update Used to update a taxation record in database.
Delete Used to delete a particular taxation record from database.Table 136: Actions associated with taxation Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1490Charging User Guide Charging configuration (new GUI) Note : These actions are valid for internal purposes only and cannot be accessed using the SM GUI.
5.
10 Proration Profiles A proration profile must be created and attached to the service (bundle) if proration is needed to be applied.
It holds the proration profile parameters.
Configuration Log into the new GUI and navigate to Charging → ☰ → Proration profiles .
To define a new proration profile, click and provide the details as described in the following table.
To update a proration profile, hover mouse over the row and click .
The proration profile can be edited irrespective of its status.
Parameter Description Options Mandatory/ Optional Name This parameter indicates the unique name for the proration profile.String Mandatory Description Description of the proration profile.
String Optional Service Proration Type This parameter indicates the type of proration such as Service Fee, Subscription lifecycle fee, Allowance limit, Metering limit.- Mandatory Activation This parameter indicates the subscription activation fee and time.
When selected, the Service fee and Current time options get chosen.Boolean Mandatory Cancellation This parameter indicates the subscription cancellation fee and time.
When selected, the Service fee and Current time options get chosen.Boolean Mandatory Bill cycle Change This parameter sets the prorate mode for the billing cycle.
Boolean Mandatory Service Fee This parameter indicates the fee charged for the service.
Integer Mandatory Subscription lifecycle feeThis parameter indicates the lifecycle fee.
Boolean MandatoryTable 137: Parameters for proration profiles Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1491Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Allowance limit This parameter indicates that the allowance limit is prorated.
Boolean Mandatory Metering limit This parameter indicates that the proration is applied to fair usage policy and counters.Boolean Mandatory Force Prorate Bill Cycle ChangeThis parameter indicates that prorating is done without considering the values of controlling parameters in the service ( bundle) definition.Boolean Mandatory Prorate Granularity provides flexibility to round- off the prorate fee and other values to days and hours.
Round to This parameter can have the following values: •Current Time •Current Hour •Current DayEnum Optional Current Time This parameter indicates the services ( bundle) applicable time.
Boolean Optional Current Hour This parameter indicates that the service is rounded to current hour of the day.
For example, if current time is 6 March 2020 17: 45:45:237 and prorate granularity is Hour, then the Services ( bundle) Applicable Time is 6 March 2020 17: 00:00:000.Boolean Optional Current Day This parameter indicates that the service is rounded to current day start time or if lifecycle is account and “ hour of the day” is present in billing information then the Services ( bundle) Applicable Time is rounded to that “ hour of the day” time of current or previous day.
For example, consider a subscription does not have its own periodic lifecycle and account has a periodic lifecycle with timer Units set as Month and timer Value set as 1.
Suppose the current time is 6 March 2020 17: 45:45:000 and billing information with hour OfDay set as 5: End time is 18 March 2020 5: 00:00:000 and Prorate Granularity is Days, then the Services ( bundle) Applicable Time is 6 March 2020 05:00:00:000.Boolean Optional Rounding of Bucket ValuesThis parameter is used to round off the prorated bucket values.
It can have the following values: •Default NCC rounding: If this value is selected, default rounding mechanism is used to round off the values.
•Rounding down: The value is rounded off to the nearest larger value.Enum OptionalTable 137: Parameters for proration profiles (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1492Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional •Rounding up: The value is rounded off to the nearest smaller value.
•Rounding to nearest value: The value is rounded off to the nearest value.
Default value: Default NCC roundingTable 137: Parameters for proration profiles (continued) 5.
11 Bill Cycle Calendars Bill cycle calendar provides flexibility to define a period length for lifecycle such that the period difference between two periodic events is not fixed.
It can be defined manually, and on basis of this value the next bill cycle occurs.
Configuration Log into the new GUI and navigate to Charging → ☰ → Bill Cycle Calendars .
To define a new calendar, click and provide the details as described in the following table.
Parameter Description Options Mandatory/ Optional Name This parameter indicates the unique name for the calendar.
String Mandatory Description Description of the bill cycle calendar.
String Optional Click +DATE to add a new billing date.
Billing dates This parameter includes all the defined period dates.
Initially, there is option to add one date.
Click ADD DATE to add more dates.
The dates are added using a calendar or MM/ DD/ YYYY format.
During update, only future dates are supported.
Dates in the past are accepted only if they are already present in the bill cycle calendar.
The dates must be in ascending order.
The list can contain a maximum of 50 dates.
After 50 dates are defined, if a new date is added, the earliest date is removed from the list.List ( size 50) OptionalTable 138: Parameters for bill cycle calendars Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1493Charging User Guide Charging configuration (new GUI) Example The following table demonstrates multiple bill cycle calendars with multiple dates defined.
All dates are defined in MM/DD/YYYY format.
If Calendar1 is configured for a billing cycle, and the current end date is 01/12/2019 then after next renew, the end date becomes 03/01/2019.
Calendar NameDate1 Date2 Date3 Date4 Date5 Date6 Date7 Calendar1 01/12/ 201903/01/ 201903/15/ 201904/01/ 201905/12/ 201906/2019/ 201908/21/ 2019 Calendar2 01/12/ 201903/01/ 201903/15/ 201904/01/ 201905/12/ 201906/2019/ 2019 Calendar3 01/12/ 201903/01/ 201903/15/ 201904/01/ 201905/12/ 201906/2019/ 201908/21/ 2019 Calendar4 01/12/ 201903/01/ 201903/15/ 201904/01/ 2019- - - Calendar5 01/12/ 201903/01/ 201903/15/ 2019- - - - Points to note •Bill cycle calendar is applicable only for Account PLC.
•Tolerance is supported for calendar bill cycle calendar.
•Bill cycle calendar is not supported in BOU.
•Prorating should not be done when end time is set through bill cycle calendar reference.
•Bill cycle calendar does not affect integration of future and past activations as subscriptions are account driven.
•No errors are returned while updating bill cycle calendar.
•Prorating is not done when there is no date in calendar reference and end date is calculated as per- account billing info.
•Prorating is not done when bill cycle calendar is deleted and end date is calculated as per account billing info.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1494Charging User Guide Charging configuration (new GUI) •In bill cycle calendar, the dates are stored in MM-DD-YYYY 00:00:00:000 GMT format.
When account end date is determined, it becomes Month DD, YYYY 12:00AM <Account Timezone> format.
•End date and time update API works similarly for with and without bill cycle calendar.
In the next cycle, the next end date is taken from bill cycle calendar.
Prorating of fee is not done.
5.
12 Mapping Tables The mapping tables enables to create read-only complex and simple mapping tables as ordered lists of keys mapped to ordered lists of values.
A mapping provides a lookup that can have multiple input fields (keys) and multiple output fields.
A user can have a single key and output field to produce a simple mapping using the same tools as mentioned in the Mapping Tables menu.
A mapping table defines the input key fields (what it is mapping from), and the output fields (what it is mapping to).
The number of input and output fields, and their respective types are assigned by the user.
The meaning of the keys and values are customer specific and the meaning of each field is defined using rules.
Each call on the mapping tables performs one or more lookups in various tables.
The values in one table, can be keys into another table, so tables can be interdependent (one-way).
NCC supports large list or group mappings used in rules to provide lookups in policy and charging.
The mappings are independent of the rules themselves.
When data is added to a map, all of the input and output fields must be provided so that when a lookup is done into a map, only an exact match of all input fields (keys) is found.
The keys and the combinations of keys in each row must be unique.
Multiple entries in complex mapping tables cannot have the same key value.
Multiple entries in the complex map do not have the same key value(s).
There can only be one row with the same key values.
The row successfully added at the end, with a specific set of keys, is the set of values returned.
If you try to add the same row again, it is either blocked or overwrites the previous row.
Note : Click the Summary Icon ( ) on the first page of the mapping tables and select Mapping Tables ) in the SM GUI, it displays the list of the complex maps provisioned on different MEs.
The following options are available while publishing mapping tables: •Publish To : This provides a list.
Operators can publish to All subscribers and so on.
•Activation Time : The supported values are as follows: –Activate Now : If this is selected, then the charging logic is activated immediately.
–Schedule Activation : Operators can schedule activation to a future time using this option.
Prefixes support in complex maps The prefix matching feature allows a user to provision a complex map having keys with different Regex or IP subnet pattern.
For example, abc * or 123.247.32*.
During a network call, AVPs are passed as keys are matched with keys provisioned with these patterns.
This feature allows to provision a complex map with less number of entries when different set of AVPs lead to the same set of values.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1495Charging User Guide Charging configuration (new GUI) NCC determines the zone for data calls based on MCC, MNC, and SGSN IP address received in the CCR message using rule and mapping table configuration.
To minimize the issues of handling huge data and complex configuration, the charging and policy supports the following prefixes or wildcard characters in the mapping tables: •* (0 to n occurrence) •?
(Single characters) •[-] (Range) •(|) OR •{n} where n is the number of occurrences •[^] Not operator For information on how to provision prefix matching in a complex map, see the Pattern Type definition in the Configuration on page 1514 section.
Example of complex map provisioned without prefix Key Value 40410 INDIA 40411 INDIA 40412 INDIA 30301 SINGAPORE 30302 SINGAPORE 30303 SINGAPORE Key Value 4041?
INDIA 3030* SINGAPORETable 139: Using Regex pattern Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1496Charging User Guide Charging configuration (new GUI) Key Value * ASIATable 139: Using Regex pattern (continued) Example of complex map provisioned without prefix Key Value 10.23.29.112 INDIA 10.23.29.255 INDIA 10.23.29.19 INDIA Key Value 10.23.29.0/24 INDIATable 140: Using IP subnet pattern Using mapping values in rules When you have defined the keys and values in the mapping tables, you can use them in various rule scenarios by providing functions to get the value required in the rule.
For example: QOS_MANAGEMENT.Max-Requested-Bandwidth-UL = ComplexMap.Get-Row-Long("abc", 1) In the above case, ComplexMap.Get-Row-Long("abc", 1) is the function for a specific value and type.
The following functions are available by type to get values from a complex mapping table: •Load-Row : If the row is successfully loaded, then this function returns an output as TRUE else FALSE .
This function takes a row from the specified complex map (specified my mapName ) that matches a list of keys and places it in the ComplexMap context under the rowLabel .
Going forward, the individual values in that entry are referenced by rowLabel and index value.
The usage is defined as follows: –ComplexMap.Load-Row-1Key(String mapName, String key1, String rowLabel) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1497Charging User Guide Charging configuration (new GUI) –ComplexMap.Load-Row-2Key(String mapName, String key1,String key2, String rowLabel) –... –ComplexMap.Load-Row-10Key(String mapName, String key1,..., String key10, String rowLabel) The source context is ComplexMap and the parameters are defined in the following way: –mapName : The name of the ComplexMap from which you want to load the row.
–keys : The list of key strings that make up the row.
–rowlLabel : A label used by other functions to reference the row.
Ensure you make this globally unique if, within the same rule invocation, you are manipulating multiple rows in the same or different complex maps.
You assign the rowLabel in the same manner as a variable: get (Key1, Key2, value...)(rowlabelName) •Get-Row-Integer : This returns the value from rowlLabel row at valueIndex index as an integer.
The row is loaded using the Load-Row function before executing this command.
Get-Row-Integer converts the underlying string representation into the integer.
The integer must be a integer parsed and within the specified range.
A row index of 0 refers to the first value in the table and the usage is defined in the following way: ComplexMap.Get-Row-Integer(String “rowLabel”, Integer “valueIndex”) The source context is ComplexMap and the following parameters are defined: –rowlLabel : The label assigned to the row when using the Load-Row function.
–valueIndex : The column in the row where the value is stored.
–For the supported value type, the value(s) must be analyzed in accordance with the following: https://docs.oracle.com/javase/7/docs/api/java/lang/long.html •Get-Row-String : This returns the value from a rowlLabel row at valueIndex index as a string.
The row is loaded using the Load-Row function before executing this command.
Get-Row-String converts the underlying string representation into the StringValueType.
A row index of 0 refers to the first value in the table and the usage is defined in the following way: ComplexMap.Get-Row-String(String “rowLabel”, Integer “valueIndex”) The source context is ComplexMap and the following parameters are defined: –rowlLabel : The label assigned to the row when using the Load-Row function.
–valueIndex : The column in the row where the value is stored.
•Get-Row-Boolean : This returns the value from a rowlLabel row at valueIndex index as True or False .
The row is loaded using the Load-Row function before executing this command.
Get-Row-Boolean converts the underlying string representation into the EnumValueType (BooleanEnum).
A row index of 0 refers to the first value in the table and the usage is defined in the following way: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1498Charging User Guide Charging configuration (new GUI) ComplexMap.Get-Row-Boolean(String “rowLabel”, Integer “valueIndex”) The source context is ComplexMap and the following parameters are defined: –rowlLabel : The label assigned to the row when using the Load-Row function.
–valueIndex : The column in the row where the value is stored.
•Get-Row-Decimal : This returns the value from a rowlLabel row at valueIndex index as a decimal.
The row is loaded using the Load-Row function before executing this command.
Get-Row-Decimal converts the underlying string representation into the DecimalValueType.
A row index of 0 refers to the first value in the table and the usage is defined in the following way: ComplexMap.Get-Row-Decimal(String “rowLabel”, Integer “valueIndex”) The source context is ComplexMap and the following parameters are defined: –rowlLabel : The label assigned to the row when using the Load-Row function.
–valueIndex : The column in the row where the value is stored.
–For the supported value type, the value(s) must be analyzed in accordance with the following: https://docs.oracle.com/javase/7/docs/api/java/lang/double.html •Get-Row-IPAddress : This returns the value from a rowlLabel row at valueIndex index as an IP address in the supported IPv4 or IPv6 format.
The row is loaded using the Load-Row function before executing this command.
Get-Row-IPAddress converts the underlying string representation into the IPAddressValueType.
A row index of 0 refers to the first value in the table and the usage is defined in the following way: ComplexMap.Get-Row-IP_AddressValueType(String “rowLabel”, Integer “valueIndex”) The source context is ComplexMap and the following parameters are defined: –rowlLabel : The label assigned to the row when using the Load-Row function.
–valueIndex : The column in the row where the value is stored.
•Get-Row-Input-Key : This returns the comma separated keys from the row label.
These keys are loaded during the Load-Row function for fetching the data from a mapping table.
These keys serve as input for the Load-Row function.
The usage is defined as follows: COMPLEX_MAP.Get-Row-Input-Key(String "rowLabel" ) •Get-Row-Input-Key-By-Index : This returns the only a specific key fetched with the help of keyIndex .
This key is loaded during the Load-Row function for fetching the data from a mapping table.
The usage is defined as follows: COMPLEX_MAP.Get-Row-Input-Key-By-Index (String "rowLabel", Integer keyIndex ) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1499Charging User Guide Charging configuration (new GUI) A key index of 0 refers to the first key.
•Get-Row-Key : For complex pattern type REGEX_PATTERN or IP_SUBNET_PATTERN , this returns the complex map row keys with which the provided input keys are matched (using regular expression algorithm or IP subnet matching).
This key is loaded during the Load-Row function for fetching the data from a mapping table.
The usage is defined as follows: COMPLEX_MAP.Get-Row-Key ( String "rowLabel" ) •Get-Row-Key-By-Index : For complex pattern type REGEX_PATTERN or IP_SUBNET_PATTERN , this returns only a specific key fetched by providing the keyIndex .
This key is loaded during the Load-Row function for fetching the data from a mapping table.
The usage is defined as follows: COMPLEX_MAP.Get-Row-Key-By-Index (String "rowLabel", Integer "keyIndex" ) A key index of 0 refers to the first key.
Mapping table examples Setting the upload and download bandwidth for a session example Based on a Device Type and Carrier , set the upload and download bandwidth for the session whether the SPR device information contains the following custom data: •Key1 = CUSTOM_ATTRIBUTE_NAME = Carrier , value = nameOfCarrier •Key2 = CUSTOM_ATTRIBUTE_NAME = Device , value = nameOfCarrier The CarrierDeviceMappingTable table is considered to define a complex map.
For reference, see the CarrierDeviceMappingTable example on page 1501 .
•The header row, indicates your meaning for each field.
•The first two columns in the example define the key for the row.
abc+xyz is the key for row 1.
•The last four columns in the example define the value for the row.
lteAPN,2000,2000,abc-xyz-LTE is the value for the row.
•In a given table, each row must consist of exactly n keys (where n can be between 1 and N).
•In a given table, each row must consist of exactly m values (where m can be between 1 and M).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1500Charging User Guide Charging configuration (new GUI) Carrier (Key_ 1)Device Type (Key_ 2)APN (Value 0)Upload Bandwidth (Value 1)Download Bandwidth (Value 2)CDR (Value 3) abc xyz lteAPN 2000 2000 abc- xyz- L TE MNO xyz lteAPN 3000 3000 MNO- xyz- L TE MNO BB 3G-APN 2000 2000 MNO- BB-3GTable 141: CarrierDeviceMappingTable example You can create the following rule to accomplish: •Loading the row into the ComplexMap context, under the label bandwidthSelectionRow .
•Set the Max-Requested-Bandwidth-UL value in the QOS_MANAGEMENT result context to have the value from the second values column.
•Set the Max-Requested-Bandwidth-DL value in the QOS_MANAGEMENT result context to have the value from the third values column.
In this example, the row is loaded into the ComplexMap context, under the bandwidthSelectionRow rowLabel.
Then in the second step, we set the Max-Requested-Bandwidth-UL value in the QOS_MANAGEMENT result context, to have the value from the second values column.
Then in the third step, we set the Max-Requested-Bandwidth-UL and DL values in the QOS_MANAGEMENT result context, to have the values from the values column.
If... Then.
.. ComplexMap.Load-Row("CarrierDeviceMapping Table", "abc", "xyz”)", "bandwidthSelection Row")QOS_MANAGEMENT.Max-Requested-Bandwidth-UL = ComplexMap.Get-Row-Long("bandwidthSelection Row", 1) QOS_MANAGEMENT.Max-Requested- Bandwidth-DL = ComplexMap.Get-Row-Long(" bandwidthSelectionRow", 2) Simple mapping example Based on a simple mapping, you can map a keyword to one or more fields (as a row) or list of rows.
For example, the keyword France could be associated with a single or a list of MCCs.
From the time that association is made, the rules engine recognizes this keyword in a way that the user can type location = France.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1501Charging User Guide Charging configuration (new GUI) Consider the following table named EuropeTable as one you might use to define a simple map.
In this example, if the AVP value in the Gx CCR message matches, the map lookup results in the following way: Called-Station-ID = lteAPN in the CCR which matches complex map lookup result.
GX.3GPP-User-Location-Info.User-Location-Identity-Type[SAI].MCC = 208 which also matches the map lookup result.
With this result, the example then assigns the following QoS value to the session via the CCA response: Max-Requested-Bandwidth-UL = 3000 Max-Requested-Bandwidth-DL = 3000 rowLabel: APN-MCCSelectionRow Country (Key 1)APN (Value 0)MCC (Value 1)CDR (Value 2) France lteAPN 208 France- L TE Germany lteAPN 262 Germany- L TE Italy lteAPN 222 Italy- L TETable 142: EuropeTable example If... Then.
.. ComplexMap.Load-Row(“EuropeTable”, “France” , “APN-MCCSelectionRow”) = true and Gx.
Called-Station-ID = ComplexMap.Get-Row- String("APN-MCCSelectionRow ", 0)and GX.
3GPP-User-Location-Info.User-Location- Identity-Type[SAI].MCC = ComplexMap.Get- Row-String("APN-MCCSelectionRow", 1)Max-Requested-Bandwidth-UL = 3000 QOS_ MANAGEMENT.Max-Requested-Bandwidth-DL = 3000 Mapping two keywords to one or more fields example Based on a mapping table, you can map two keywords to one or more fields (as a row) or list of rows.
For example, with Key1 equal to MCCMNC, and Key2 equal to callSubType, each row could be associated with values that map a specific rate to a specific country.
From the time that association is made, the rules engine recognizes this keyword in a way that allows the user to type in the MCCMNC + callSubType to retrieve the rate charged for a specific country.
The map is as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1502Charging User Guide Charging configuration (new GUI) MCCMNC Key1callSubType Key2Rate Value1Country Value2 322124 VOL TE rate1 Germany 456234 VOL TE rate1 USA 456122 VOL TE rate2 Canada 322124 PS-Data rate1 Germany 456234 PS-Data rate1 USATable 143: Rate by country Example for reference-based map Following is the example of reference-based map ( REFMAP , version = v1) with version v1: 1.Create a device.
2.Create string based device custom data CD_APN .
3.Create two complex maps APN_1 and QOS_1 (non-referenced based maps).
4.Create reference based complex map with name REFMAP with version v1.
Here the values QOS_1 and APN_1 are the map names or reference of existing maps created above.
APN_1 example Key1 Value1 APNNAME auto_ apn APNEPC apnEpc QOS_1 example Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1503Charging User Guide Charging configuration (new GUI) Key1 Value1 BR_DL 4500 REFMAP example Key1 Value1 QOS QOS_ 1 APN APN_ 1 5.Create an RSV and create two rule variables APNGROUP and QOSGOUP in the QOS_MANAGEMENT trigger.
APNGROUP If... Then.
.. COMPLEX_ MAP.
Load- Row- 1Key ( " REFMAP" , "APN" , " REFMAPROWS" ) = Boolean Enum_ TRUECOMPLEX_ MAP.
Get- Row- String ( " REFMAPROWS" , 0) QOSGOUP If... Then.
.. COMPLEX_ MAP.
Load- Row- 1Key ( " REFMAP" , "QOS" , "REFMAPROWS" ) = Boolean Enum_ TRUECOMPLEX_ MAP.
Get- Row- String ( " REFMAPROWS" , 0) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1504Charging User Guide Charging configuration (new GUI) Above rule variables fetch complex maps APN_1 and QOS_1 from reference map REFMAP .
6.Add two rule groups RT_APN and RT_QOS with the following condition using above rule variables.
RT_APN If... Then.
.. COMPLEX_ MAP.
Load- Row- 1Key ( @APNGROUP, " APNNAME" , "setapn" ) = Boolean Enum_ TRUE and GX_MSG_ SESSION.
Called- Station- ID = COMPLEX_ MAP.
Get- Row- String ( " setapn" , 0)SPR_ DEVICE.
Custom- Data- Add ( " CD_APN" , COMPLEX_ MAP.
Get- Row- String ( " setapn" , 0 ) ) RT_QOS If... Then.
.. COMPLEX_ MAP.
Load- Row- 1Key ( @ QOSGROUP, " BR_DL", "setqos" ) = Boolean Enum_ TRUEDSC.
APN- Aggregate- Max- Bitrate- DL = COMPLEX_ MAP.
Get- Row- Long ( " setqos" , 0 ) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1505Charging User Guide Charging configuration (new GUI) 7.Trigger GX call and see the custom data is attached to the device and QOS is updated as given in complex map.
If user has to make any modifications in the map REFMAP , then the user can clone new version of same map (REFMAP,version:v2) make the changes, provision it on selected ME without any change on RSV.
5.
12.
1 Versioning Operators can enable versioning for mapping tables using the SM application preference named Mapping Table Enhanced Versioning .
A separate ME configuration is not required.
Attention : Once you set the Mapping Table Enhanced Versioning , you cannot clear it since it has adverse effect on backward compatibility to changes made to data.
Note the following important points: •If the Mapping Table Enhanced Versioning is unchecked, then the mapping table versioning is unchanged from legacy versioning.
The mapping table records show under Common Configuration > Charging > Mapping tables (old GUI screens).
•If the Mapping Table Enhanced Versioning is checked, then the full versioning integrated with ME is supported.
The mapping tables are configured under Charging configuration > Mapping tables .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1506Charging User Guide Charging configuration (new GUI) Note : The latest published active version of the mapping table can be fixed (updated or edited) and re-published.
For more details, see Updating latest published active version on page 1541 .
5.
12.
1.
1 Legacy versioning Configuration The mapping makes use of generic bindings and caches entries into an in-memory map but are configured in the SM GUI.
Log into SM GUI, navigate to Common Configuration and select Mapping Tables .
To define a new mapping table, click to add the basic details and profile configuration as described in the given table: Parameter Description Options Mandatory/ Optional Map Name This parameter indicates a unique name of the map.String Mandatory Reference Based Map This parameter can be either set to True or False by selecting the check box on the SM GUI.
If this parameter is set as True , then the complex map is a reference- based map, which means that the map values inside this map are names of an existing complex map.
This parameter must be true for version based map.
Note : •If a map is being referenced by another map, which is a reference- based map, then that map cannot be deleted until that reference is removed.
•When a user tries to provision a reference- based map, all the complex maps referenced by that map must be provisionedBoolean Optional Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1507Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional on that selected ME.
Otherwise, provisioning is not allowed for that reference map.
•When trying to undistribute a non- reference complex map from a selected ME, the SM server checks whether that map is being referred by another reference- based maps, which are not provisioned on same ME.
Otherwise, the undistribution is prohibited.
•By default, this parameter value is set as False .
However, if a user updates this flag to True , then the SM server validates all values in that map exist as complex map in complex map table, but not as a reference- based map, and that map is not referenced inside another reference based map.
Otherwise, the SM server does not allow this flag to be updated to True .
Additional information: In case of reference- based map, the [value] is a drop- down list in the SM GUI that presents the record values of existing complex maps.
This list can be filtered as per the key name specified in Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1508Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional the [key] .
For example, if the [key] is set as CDC , then the [value] displays all the complex maps having CDC as a sub- string in its name.
Here the key name is not case- sensitive and the map key displays maps with names CDC_ 1 or CDC_ 2.
Note : If user selects the check box Show All Refs , then values as per key name are not filtered.
This parameter allows a user to create multiple complex maps with the same name and different versions.
The maximum number of characters allowed in this attribute is 50.
The ID field for versioned map includes a version- suffix consisting of a field separator character | | and version as an user input.
For example, map having id test| |v1, which indicates the map name is test and version is v1.
This parameter is allowed only when the Reference Based Map flag is set as True .
Note : Only one version of a given complex map can be distributed on a selected ME at a given time.
The Version attribute is only maintained in the SM server in the complex map table.
While configuring the rules in the RSV, a user does not mention the complex map version.
Complex map versioning allows a user to update a complex map data without updating the rule system.String and read- only Optional Version Example: Consider there is an existing distributed complex map REFMAP on a selected ME.
A user needs to update few fields of this map.
The rules in the RSV are referring to the REFMAP key.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1509Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional The user clones the REFMAP with version v2019 and updates the desired fields in the newly created complex map.
The user then distributes this map ( which means the REFMAP with version v2019 ) to the selected ME.
The SM server automatically computes the delta between the two version of REFMAP on the selected ME and distributes the contents, which were changed on the selected ME.
The distributed map in the ME has the same name REFMAP .
This parameter allows a user to select REGEX_ PATTERN or IP_ SUBNET_ PATTERN while defining a mapping table.Enum Optional Pattern Type A user can select either of the following values from the Pattern Type drop- down list: •REGEX_ PATTERN : For this Pattern Type , during network call processing, the input keys ( such as incoming through AVP) is matched in the complex map using regular expression pattern matching algorithm.
The sorting order of characters is defined as: ~, }, |, {, z, y, x, w, v, u, t, s, r, q, p, o, n, m, l, k, j, i, h, g, f, e, d, c, b, a, ` , _, ^, ], [, Z, Y, X, W, V, U, T, S, R, Q, P, O, N, M, L, K, J, I, H, G, F, E, D, C, B, A, @ , ?, >, =, <, ;, :, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0, / , ., -, ,, +, *, ), (, ', &, % , $, #, !
Note : The regex- based keys should be provisioned keeping in mind that during a Diameter call, input keys ( like MCC, MNC, or SGSN) are matched with mapping table entries and the very first match is returned.
For example, if the following keys are present in the complex map ( reverse natural sorted order) : For input as key1 = INDIA and key2 =Himachal , the value returned is Zone1 .
Although both the entries match but the first match is returned.
Note : If the mapping table has the row with key1 = INDIA and key2 =Himachal with Value1 = Zone3 , then Zone3 is returned.
•IP_SUBNET_ PATTERN : For this Pattern Type , during network call processing, the input keys ( such as incoming through AVP) is matched in the complex map using IP address prefix or subnet concept, which means the given IP address resides in the IP address range using the provided subnet.
The value of the first match of the row from complex map is returned.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1510Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional For a given input, key1 = 10.75.61.94 and key2 = 10.10.10.10, Zone1 value is returned.
Another example for IPv6 is: For given input, key1 = fe80: 0:0:0:0:0:c0a8: 11 and key2 = ffff:fff:abce: 1:1:1:c0a8: f, Zone1 value is returned.
NOTE: •The values for the first matched row from the complex map is returned.
the first matched row is returned after considering that complex map rows are sorted in the reverse natured order.
•For reference- based map, all the versions of that map should have same Pattern Type value.
Otherwise, it may lead to data inconsistency during a network call.
•If the Pattern Type is set as REGEX_ PATTERN , then only Regex- based matching is done.
Similarly, if the Pattern Type is set as IP_SUBNET_ PATTERN , then only IP subnet matching is performed.
Map Keys This parameter indicates the name of the first Key column.
This is the header row, which indicates meaning to each field.
The first column in the example table Complex Mapping Table example on page 1516 defines the key for the row.
You can have up to 10 keys.String Mandatory ADD KEY Map Values This parameter indicates the name of the first Value column.
This is the header row which indicates your meaning to each Value field in the row.
In the example table Complex Mapping Table example on page 1516 , each row must consist of exactly m values, where m can be between 1 and M, each value can contain up to 1024 characters, with a maximum of 1 MB for an entire row of values.String Mandatory ADD VALUE > Import Mapping Table from File Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1511Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Import File Click the BROWSE button to select the .
CSV file that you want to import.Optional Overwrite This parameter defines whether mapping table structure is derived from a .
CSV file.Select this check box to derive the mapping table structure from a .
CSV file.Optional Note : Consider the following points while configuring a complex map: •A user can specify the version while creating or cloning a given map.
Once a map is created, the version cannot be added or modified in the existing map.
However, if there are two versions of a complex map and one of the maps having the Version field empty while the other map having the Version field non-empty; both are treated two maps with different versions.
For example, a user creates a map with name test and empty version and one more map with same name test and version v1.
In this case, the SM server creates two maps; one with id test and other with id test||v1 .
Both maps with the same map name are treated as two versions of a map with the name test.
•Already existing map can be updated to reference based map only when all the entries in that map exist as complex map in complex map table.
Complex maps having non-empty version (say v2) cannot be changed to non-reference map.
•If user clones a new version of an existing non-reference map by setting the Reference Based Map flag as True , then the SM server first checks that all the entries from which map is being cloned exist as a complex map.
If all the values exist as a complex map in SM server, then the SM server clones the new map as a reference-based map.
•To support the version of any existing map, which was created as non-reference map before application upgrade (for example refMap ), user can clone or create next version of the existing map as reference-based map with same name and non-empty version attribute.
SM server validates the already existing map has entries exist as complex map in complex map table.
If validation is successful, then the SM server creates a new version of existing map and auto-updates the already existing non-reference map to reference based map ( refMap without version).
For example, consider there is an already existing map say refMap.
If user tries to create next version ( map Name = refMap and version = v1) of this map by selecting Reference Based Map flag as True , then the SM server validates the entries in old version (refMap ) of same map.
If all the entries (map values) are name of another existing complex map record, then the SM server allows the user to create next version of same map and automatically updates the old map ( refMap ) as reference-based map.
•It is recommended to define all versions of a given map with same nomenclature.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1512Charging User Guide Charging configuration (new GUI) •The Reference Based Map flag cannot be updated when a given map has more versions or the Version field of that map is non-empty.
Nested referencing is not allowed because using a reference based map inside other reference based may lead to unexpected behaviour.
•All the values inside the reference based maps should not be null.
However, if a user needs to create a complex map entry with a null value, then one of the keys must be defined with name as PLACEHOLDER (which is case-insensitive) as shown in the following screenshot: Additional information •A map in the provisioned state cannot be updated or deleted.
•Whenever a user provisions a complex map on an ME, the SM server sets its state on the SM GUI to IN_PROGRESS , which means the provisioning of all entries in that map is ongoing.
In that state, all operations like delete, update, retry, or provision are not allowed.
However, if for some reason, a record gets locked in the IN_PROGRESS , then the user can use the reset option (or REST API) present in distribution box of the SM GUI but the reset option should be only used when provisioning of that record is not ongoing.
Otherwise, it can lead to data inconsistency.
•If any ME goes offline permanently, then undistribution on that ME does not work and the record gets locked in the DELETE_ATTEMPTED state.
To remove such ME from distribution list of already provisioned record, the reset button is used, which removes the MEs whose state is DELETE_ATTEMPTED from the distribution list.
However, this option does not make any correction in data inconsistency between an ME and SM server.
The reset option should be used only when ME is not reachable and when provisioning operation for the same record is not ongoing.
5.
12.
1.2 Delta versioning The delta versioning scheme is applicable only on SM GUI.
It contains the delta from one user while work is in progress.
Operators can start modifying a mapping table using one version and apply to another (based on conflict management).
NCC automatically resolves the conflicts between different versions.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1513Charging User Guide Charging configuration (new GUI) Limitations •The enhanced versioning scheme allows versioning of regular maps.
Hence, there is no need for reference-based maps.
However, the reference-based maps are still supported so that operators can update the rules in a phased manner.
•You can provision new versions of the regular maps and switchover is not disruptive.
•To update a regular map, operators can clone the latest active version to a new draft version, update its entries and publish the draft version.
•If there is a mapping table that existed prior to upgrade and was not published, it will be renamed.
To publish it with new versioning scheme, it must be created again and then published.
Configuration Log into new GUI, navigate to Charging → ☰ → Mapping Tables .
To define a new mapping table, click to add the basic details and profile configuration as described in the given table: Parameter Description Options Mandatory/ Optional Map Name This parameter indicates a unique name of the map.String Mandatory Type This parameter can be set to select the reference type as follows: •Key- Value ( normal data map) •Key- Table ( reference based map) values are references to other mapping tables.
Note that this is for backward compatibility and should not be used in new configurations.
See Legacy versioning on page 1507 for more details.Enum Mandatory Version Name This parameter allows a user to create multiple draft version mapping tables with the same name and different versions.
The maximum number of characters allowed in this attribute is 50.
The ID field for versioned map includes a version- suffix consisting of a field separator character | | and version as an user input.
For example, map having id test| |v1, which indicates the map name is test and version is v1.String and read- only after create Mandatory Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1514Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional The draft versions are tracked by name.
When published to ME, the draft changes are merged into the latest active version, and a new major version is created.
Pattern Type This parameter allows a user to select the following options: •REGEX_ PATTERN : During network call processing, the input keys such as incoming through AVP is matched in the complex map using regular expression pattern matching algorithm.
•IP_SUBNET_ PATTERN : During network call processing, the input keys such as incoming through AVP is matched in the complex map using IP address prefix or subnet concept.
•EXACT : If this is selected, then exact match is done.
Create key columns This parameter indicates the name of the first Key column.
This is the header row, which indicates meaning to each field.
The first column in the example table Complex Mapping Table example on page 1516 defines the key for the row.
You can have up to 10 keys.String Mandatory Create value columns This parameter indicates the name of the first Value column.
This is the header row which indicates your meaning to each Value field in the row.
In the example table Complex Mapping Table example on page 1516 , each row must consist of exactly m values, where m can be between 1 and M, each value can contain up to 1024 characters, with a maximum of 1 MB for an entire row of values.String Mandatory Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1515Charging User Guide Charging configuration (new GUI) Note : Multiple versions of a given mapping table can be published to the ME at once.
The startTime field in the table is used to determine which table to use at a particular point.
The latest startTime less than the time of request processing is chosen.
The following example enables to create a map with the number of rows and columns: .
The ComplexMappingTable example is for demonstration purposes only (also applicable to legacy versioning): (Key_ 1) (Key_ 2) ...(Value 0) (Value 1) (Value 2) ... <KeyName> <KeyName> <value> <value> <value> <KeyName> <KeyName> <value> <value> <value>Table 144: ComplexMappingTable example Note : •Comma(,) is allowed in only keys of map.
To support comma character in the keys, the SM server uses backslash (\) as a special character.
Therefore, backslash character in key values should not be used as it can lead to inconsistent behavior.
If there is a coma based key value.
For example, "key1,key2", SM server stores it as key1\\,key2 and GUI displays it as key1,key2.
•For the supported string, long, and double value types, the value(s) must be able to parse the value and type as required in the following Oracle documentation: - https://docs.oracle.com/javase/7/docs/api/java/lang/long.html - https://docs.oracle.com/javase/7/docs/api/java/lang/double.html Additional information •A map in the provisioned state cannot be updated or deleted.
•Whenever a user provisions a complex map on an ME, the SM server sets its state on the SM GUI to IN_PROGRESS , which means the provisioning of all entries in that map is ongoing.
In that state, all operations like delete, update, retry, or provision are not allowed.
However, if for some reason, a record gets locked in the IN_PROGRESS , then the user can use the reset option (or REST API) present in distribution box of the SM GUI but the reset option should be only used when provisioning of that record is not ongoing.
Otherwise, it can lead to data inconsistency.
•If any ME goes offline permanently, then undistribution on that ME does not work and the record gets locked in the DELETE_ATTEMPTED state.
To remove such ME from distribution list of already provisioned record, the reset button is used, which removes the MEs whose state is DELETE_ATTEMPTED from the distribution list.
However, this option does not make any correction in data inconsistency between an ME and SM server.
The reset option should be used only when ME is not reachable and when provisioning operation for the same record is not ongoing.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1516Charging User Guide Charging configuration (new GUI) APIs and SM options API Description Equivalent option in SM GUI Create API Creates a mapping table definition.
Navigate to Charging → ☰ → Mapping tables and click .
Update API Updates a given mapping table definition.
It can be applied only to maps in DRAFT state.
Note : This can only be applied for DRAFT versions that have not been published yet.
The refBased Map parameter cannot be updated, that is, reference- based table cannot be updated to become a regular table or vice versa.Go to the record you want to edit, and click , make the necessary changes and save the record.
List versions API Lists all the versions of a given mapping table.
Read API Reads a version of a given mapping table.
Hover over the record that you want to read, and click the Details iconTable 145: APIs and SM GUI Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1517Charging User Guide Charging configuration (new GUI) API Description Equivalent option in SM GUI Delete API Deletes a given DRAFT version of a mapping table.
Note : Operators can delete only the WITHDRAWN and DRAFT versions that have not been published before.Hover over the record that you want to delete, and click Delete Versions APIDeletes all the DRAFT and WITHDRWAN versions of a mapping table.
Note that this operation fails even if there is atleast one published version.
Clone API Clones a mapping table to a new draft version.
The resulting mapping table is cloned with the same entities as in the selected record to clone with a name specified in the API.
Note : Operators can clone only the latest active version.
The active version is the version that is active or scheduled and has the highest activation time of all.
Provision API Distributes or undistributes the entries of a mapping table to or from MEs provided in the request.
The mapping table and its entries are merged into the latest ACTIVE version, and a new ACTIVE version is created.
If the start time is not provided in the request, then it is set to current time.
Note : The DRAFT version cannot be a base of a published version, that is, it cannot be published more than once.
The start time must be greater than start Table 145: APIs and SM GUI (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1518Charging User Guide Charging configuration (new GUI) API Description Equivalent option in SM GUI time of the latest active version.
Test- Provision APIDistributes the entries of mapping table in TEST_ ACTIVE state.
Publish API Publishes a mapping table to all the MEs connected to the SM.
It is similar to Provision API except that the user cannot choose the list of MEs.
Operators can also schedule a version to be published in future.
Withdraw API Withdraws a mapping table from all MEs that it was published to.Go to the record that you want to withdraw from MEs, click and then Unpublish API Withdraws all versions of a mapping table from all MEs they were published to.
Test- Publish API Publishes a mapping table to all MEs connected to the SM in TEST_ ACTIVE state.
Table 145: APIs and SM GUI (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1519Charging User Guide Charging configuration (new GUI) API Description Equivalent option in SM GUI Rollback API Rolls back the changes done by a given draft from the latest active version and creates a new active version.
If the latest active version has a future start time, then start time of the new version is set to <latest start time> +1 millisecond.
Otherwise, the start time is set to the current time.See Rollback operation ( reverse merge) on page 1522Table 145: APIs and SM GUI (continued) Merge operation When operators publish draft version using one of these APIs: Provision, Test-Provision, Publish, Test- Publish, the changes made in draft version are merged into the latest active version.
The result of merge is published as a new version.
The latest active version is the version that is in ACTIVE or SCHEDULED state and has the highest startTime.
If there are no active versions while publishing the changes, the draft gets published as it is, thus creating a new sequential version.
In this case, merge is not done.
When multiple users work on the same mapping table, it leads to conflicts when they make changes to same entries.
NCC resolves such conflicts automatically.
Following is the default behavior of conflict resolution for merge operation for the entries created, updated, or deleted by draft: •Created : If the same entry exists in the latest version, it means that it has been created by a subsequent version.
In this case, the new value gets updated and change information is added to the record history in the new version.
If the entry is different, then it leads to merge conflict.
See Conflict resolution on page 1520 for more details.
•Updated : If an entry exists in the draft version, but does not exist in new version, then it leads to merge conflict and user can decide which entry to keep.
•Deleted : If the draft history value is same as current value, then it gets deleted.
Otherwise, it leads to conflict and user can decide whether to keep the record with current value or confirm deletion.
The entries that were not created, updated, or deleted by the draft version are kept per the latest version.
Conflict resolution In case of conflicts, the front end requests backend to compare the saved draft version against the latest active version.
The backend sends a response indicating the differences (modified entries, additions, deletions), and user can resolve conflicts.
The user can request for a conflict check for the mapping table using GUI.
A list of conflicts display on the GUI and user can select a disposition on each of them to resolve.
The updates happen locally in the browser.
When publishing, the user has the following options: •Normal : The Normal mode uses conflict resolution, in which any detected conflicts get presented on the GUI, and the user must provide a disposition for each.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1520Charging User Guide Charging configuration (new GUI) •Ignore conflicts : For the Ignore conflicts mode, the SM chooses a disposition for any conflicts and does not prompt the user to resolve them.
Publish operation - interaction between versioning schemes active/test modes You can publish a mapping table in 'test mode', in which case it is only used for calls involving a device which has the 'testDevice' option set.
The startTime field in the mapping table is also considered.
You can set startTime = current time to make the table active immediately.
When you publish a draft in test-mode, it is merged into the latest active version, and published as the next minor version.
Multiple drafts can be published in test-mode simultaneously.
If you do this, however, you need to take an extra step to disambiguate which table to use for test devices.
This can be done by adding custom data to the device indicating which table to use.
The custom data tag is 'testMappingTables' and the value is a list, with items separated by | character.
Each item is formatted as <mapname>=<version>, for example, mymap=1.2 to indicate that, in test mode, mymap version 1.2 is to be used.
Consider the following example to understand how custom data can be used when multiple drafts are published simultaneously in test-mode.
Following are the sequence of events: 1.Two different users create their own draft versions: map1p1 and map1p2, based on clone of 1.0 active version.
2.The map1p1 publishes 1.1 test, then map1p2 publishes 1.2 test.
3.The map1p1 publishes to 2.0 active.
4.Another user creates a draft map1p3 based on 2.0.
5.The map1p2 publishes to 3.0 active which contains p1 and p2 changes, but not p3.
6.The map1p3 publishes to testing as 3.1.
It is merged into active version so that published version contains all three projects though it was created based on 2.0.
7.The map1p3 publishes to 4.0 active, which contains all three projects.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1521Charging User Guide Charging configuration (new GUI) Rollback operation (reverse merge) Operators can rollback a given draft from latest active version using the Rollback API.
The changes that were made by the draft are backed out from the latest version, creating a new sequential version.
Following is the default behavior of conflict resolution for rollback operation for the entries created, updated, or deleted by draft: •Created : If the value in entry for latest version is same as in the draft, the entry gets deleted.
If the value is different, it means that it has been updated by a subsequent version.
In this case, the entry is kept.
•Updated : If the value in entry for latest version is same as in the draft, revert the value back.
If the value is different, it means it was updated by a subsequent version.
In this case, the value is preserved per the latest version.
•Deleted : If an entry exists in the latest version, no action is taken.
If an entry does not exist, it is recreated with its original value.
The entries that were not created, updated, or deleted by the draft version are kept per the latest version.
5.
12.
1.2.
1 Cache management The issues with cache management for complex map versioning can be solved by deleting the ineffective versions from both ME DB and cache.
When a new version of the complex map is provisioned to ME, the distributed versions are checked and ineffective versions are withdrawn (unprovisioned).
For this purpose, the following enhancements are made: •An SM application preference History Period is used.
This parameter determines the number of days that the complex map old versions are kept in ME DB and Cache.
The default value for this field is 60 days and the minimum is 0.
•Withdraw ineffective versions: When a new version of the complex map is provisioned to ME, History Period application preference is obtained to check which versions are not effective and then withdraw them.
The complex map version is not effective when the Current Time - History Period > Version End Date.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1522Charging User Guide Charging configuration (new GUI) Following are the APIs impacted by this enhancement and the APIs internal logic is updated: •Provision Mapping Table API: This API is used to provision a mapping table.
/services/ServiceManager/provision/mappingTable See the following example: { "securityDomain": "string", "distList": [ "string" ], "deleteDistList": [ "string" ], "serviceProvider": "string", "entityVersionDetails": { "majorVersion": 0, "minorVersion": 0, "startTime": 0, "smEntityState": "DRAFT" }, "description": "string", "versionNote": "string", "publishStatus": "DRAFT", "mapName": "string", "draftVersion": "string", "keyLabels": [ "string" ], "valueLabels": [ "string" ], "mapType": "REGEX_PATTERN", "refBasedMap": true, "recordCount": 0, "id": "string", "versionedId": "string" } •Publish Mapping Table API: This API publishes a mapping table to all MEs.
/services/ServiceManager/publish/mappingTable Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1523Charging User Guide Charging configuration (new GUI) •Retry Provision Mapping Table API: This API is used to retry provisioning of a mapping table.
/services/ServiceManager/retryProvision/mappingTable 5.
12.2 Updating latest published active version (mapping table) Backdating of mapping table The latest published active version of a mapping table can be fixed (updated or edited) and published.
The fixed version of the latest published active version is called a Patch Fix or Backdated Fix .
The effective date of the Patch Fix is same as that of the latest published version, regardless of when the Patch Fix is published.
Note : For more details on Patch Fix , see Updating latest published active version on page 1541 .
The Mapping Table attributes can be updated to create a patch fix of the latest published active version of Mapping Table : Note : For more details on Mapping Table , see Mapping Tables on page 1495 .
Creating a patch fix A patch fix can be created only for a latest published active version.
The procedure to create a patch is as follows: 1.Go to the latest published active version, and click .
Select Edit active version .
Edit Active Version dialog box appears as show in the following image: 2.Click EDIT .
3.Edit the components or attributes of the latest published active version, and save the updates.
A patch fix is created.
4.To update the patch fix, click (Update published version) icon.
Update published version dialog box appears as show in the following image: 5.Click UPDATE .
The patch fix is published and it overrides (replaces) the previous version.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1524Charging User Guide Charging configuration (new GUI) 6.To create a new patch fix, click , and edit the components or attributes of the latest published active version.
Note : This option is visible only after the first patch fix is updated.
Deleting a patch fix 1.To delete a patch fix, click against the patch fix as show in the following image: 2.Select Delete .
The patch fix is deleted.
Note : The patch fix can be deleted only when it is in DRAFT state.
When a patch fix is published, the option to delete it is disabled.
5.
13 Global Rules 5.
13.
1 Rules and Variables Rule System Version (RSV) acts as a container that holds rule groups and rule variables in NCC.
Operators can customize NCC behavior using rules.
To view and manage the RSVs, in the new GUI go to Charging → ☰ → GLOBAL RULES → Rules & Variables .
Three types of RSVs can be configured using the following buttons: •CHARGING: See section Charging rules on page 255 for more information about the rules related to charging.
•RECHARGE: For rules related to Recharge microservice, see section Recharge rules in the Recharge User Guide .
•LIFECYCLE: See section Charging rules on page 255 for more information about the rules related to charging.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1525Charging User Guide Charging configuration (new GUI) A default RSV is available for each application.
Click +NEW to create a new RSV and provide the name and description.
The new RSV is created as Draft.
You can change the state to Release and Active.
The Active RSVs are displayed under the Active heading.
The Draft and Release RSVs are displayed under the Inactive heading.
There can be multiple RSVs in each state.
Refer to RSV states on page 1526 for more details.
RSVs in MNO/MVNO The MNO/MVNOs create, manage, and use their own exclusive set of RSVs (that is, they can view and manage only their own RSVs).
All of them have a default RSV.
When a new MVNO is created, it also gets a default RSV.
In addition to the default RSV, the MNO/MVNOs can create additional RSVs.
They can have multiple active RSVs, each with different start dates.
However, for each MVNO, at any point of time, only one RSV is effective.
If there is no other active RSV available for an MVNO, then the default RSV is used.
If the appropriate RSV cannot be identified for an MVNO due to any reason, then the active RSV of the MNO is used for the MVNO.
RSV states Each RSV, whether it is imported or created, can exist in one of the following states: •Draft: A version of the RSV that can be modified.
When a RSV is created, it remains in this state.
•Released: A version that is completely configured and saved.
The release version is usually one that has been demoted from active but is available to become the Active version again if needed.
Changes are not allowed; you clone it and make it a draft version.
•Active: A read-only RSV that is active and ready for use starting from the configured start date.
There can be multiple active RSVs.
However, there is only one running RSV at any given time.
The remaining Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1526Charging User Guide Charging configuration (new GUI) active RSVs remain dormant and become the running RSV on their respective start dates.
However, if an RSV has Start time = Since start , then it reverts to Released state once a new one starts running.
•Test active: The RSV is in this state if it is published for test devices.
RSV actions Icon Action Description Actions available at the top- right corner of the page.
New Create a new RSV.
Import Import an RSV JSON file.
You cannot change the name of the file you are importing in this release.
Note : RSV export/ import is supported only for the same NCC version.
That is, RSV JSON exported from a different NCC version cannot be imported.
Actions available in the RSV row on mouse hover.
Edit Available when the RSV is in a Draft state.
If the RSV is in a Release state, you can revert it to Draft if it has not been distributed to an ME.
Duplicate Duplicate is supported using the Duplicate button that appears in the RSV table when you hover the cursor over a line item in the table.
You cannot change the name of the file you are cloning in this release.
Export Export the RSV as a JSON file.
Note : If an RSV is more than 5MB in size, it is not possible to perform an export of the RSV using a Chrome browser.
This is a limitation of the browser.
Nokia suggests that you use a Mozilla Firefox for an operation of this magnitude.
To do so, you must change the default setting in Mozilla Firefox, as follows: 1.Navigate to “ about: config” in the Firefox address bar.
2.Search for “ dom.
storage.
default_ quota” , which is set to 5120 by default.Table 146: Actions for RSV Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1527Charging User Guide Charging configuration (new GUI) Icon Action Description 3.Set the value to 7000 ( to export an RSV of 7MB) or an appropriate size that is higher to be able to export the RSV.
Release This action releases a Draft RSV to the selected MEs.
After this action is complete, the state of the RSV changes to Released .
Refer to Releasing an RSV on page 1528 for details.
Activate After you have released the RSV, you can activate it for use.
Refer to Activating an RSV and defining a start time on page 1529 for details.
Delete Available when the RSV is in a Draft state.
If the RSV is in a Release state, you can revert it to Draft if it has not been distributed to an ME.
Details View details of the RSV.
More Explore more options.Table 146: Actions for RSV (continued) Releasing an RSV 1.To release an RSV that is in Draft state, click → .
The following screen appears.
2.Select the Managed Elements to which the RSV should be released.
3.Click PROVISION .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1528Charging User Guide Charging configuration (new GUI) 4.Click CONTINUE to further Activate the RSV.
Activating an RSV and defining a start time 1.To Activate a RSV that is in Released state, click .
The following screen appears.
2.Select the Managed Elements in which this RSV should be activated.
3.In the Activate to drop-down list, select from the following options: •All subscribers: The RSV is activated for all subscribers.
•Test devices: The RSV is activated only for test devices.
4.In the Activation time drop-down list, select from the following options: •Activate now: The RSV becomes activated immediately.
•Since start: When the RSV is released and activated, its start date becomes same as the start date of the first default RSV of the MNO/MVNO.
In such case the default RSV moves to released state.
An RSV created with this option reverts to released state when another RSV becomes the primary.
•Schedule activation: If this option is selected, a Validity start field appears.
Provide a start date and time at which the RSV should become active.
5.Select the I understand that activating is a service affecting operation.
check box to acknowledge the content.
6.Click ACTIVATE .
The status ACTIVE is displayed in the screen.
In the main screen, the RSV moves to the Active area.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1529Charging User Guide Charging configuration (new GUI) 5.
13.2 Quota Management (Slicing Profile) Quota management profile is the primary object used in the dynamic slicing and it works in centralized mode of rating and charging.
When the reservation unit is not provided by PGW, the slice to be reserved is computed either statically or dynamically according to the quota management profile configured.
By default, the name of the quota management profile is default_profile , provisioned by the user as per the dynamic slicing feature.
For information on slice reduction, see the Slice reduction on page 2031 section.
Configuration Log into the SM GUI, navigate to Common Configuration > CHARGING tab and select Quota Management from the hamburger menu (☰).
To define a new quota management profile, click to add the basic details as described in the given table.
Parameter Description Options Mandatory/ Optional Profile Name This parameter indicates a unique name to identify the quota management profile.
String Mandatory Slice Size ( Bytes) This parameter indicates the static size of slice in bytes.
The value of this parameter is always greater than zero.Long Mandatory Quota Holding Time ( s) This parameter indicates the value of the quota holding time in seconds and controls the time the session remains in the idle state in the network.
The value of this parameter is always greater than zero.Long Optional Validity Time ( s) This parameter indicates the value of the validity time in seconds, controls the time the quota remains active in the network, and controls the effective allocation of resources.
The value of this parameter is always greater than zero.Long Mandatory Ignore Reserved Quota This parameter determines whether reservation quota needs to be considered in slice reduction logic or not.
It can have one of the following values: •No: Reserved quota is not ignored during slice allocation or reduction mechanism.
•Counter : For No-Charge , the reserved quota is ignored and during slice allocation or reduction, the current value is considered.
Default value of this parameter is No.
Note : Counter value is only applicable for No-Charge .
This logic is not applicable when quota is allocated from bucket or main balance charging as they are not generally allowed to go negative.Drop- down list Optional Security Domain This parameter indicates the security domain associated with the quota management profile.
Select the required security domain from the predefined security domains in the drop- down list.Drop- down list Optional Slicing Configuration Default Actions Contains the pre- configured and pre- provisioned values:Table 147: Parameters for quota management profile Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1530Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Click NEW RULE to define one or more rules.
To add details for DYNAMIC_ SLICE , press CTRL+ spacebar , select DYNAMIC_ SLICE to get the parameters as described in Attributes available for DYNAMIC_ SLICE result context on page 1531 .
Rule Name This parameter indicates the name of the condition based customized rule.
String OptionalTable 147: Parameters for quota management profile (continued) Setting a default quota management profile: To set a quota management profile as default, click icon and select a profile from the Default profile drop-down list.
Points to be noted: •It is not possible to set a quota management profile that is not provisioned to any ME as a default profile on SM.
•When a quota management profile is provisioned to an ME, its name is checked against the default profile on SM.
If both are the same, then the ME`s default quota management profile is also updated.
•A quota management profile that is chosen to be the default profile and is provisioned on at least one ME, cannot be deleted or withdrawn unless another profile is selected to be default on that ME.
Note : Only one profile can be used as a default profile at a time.
Attribute Description Type Mandatory/ Optional Algo- Name This parameter indicates the name of the algorithm you want to configure based on configurable conditions, such as BASIC_ ALGO , BUCKET_ ALGO , and DYNAMIC_ ALGO .
It is applicable to customized rule.String OptionalTable 148: Attributes available for DYNAMIC_SLICE result context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1531Charging User Guide Charging configuration (new GUI) Attribute Description Type Mandatory/ Optional Select- Algo This parameter allows you to select the DYNAMIC_ ALGO_ 2 for calculating the slice size.
It uses the parameters of DYNAMIC_ ALGO along with two additional optional parameters named Min Slice Size and Max Slice Size .
It is applicable to customized rule and parameterized algorithm with Min and Max slice.
Format is: DYNAMIC_SLICE.Select-Algo(AlgoName, Min slice size, Max slice size) Example: DYNAMIC_SLICE.Select-Algo(“DYNAMIC_ALGO_2”, 500, 5000) Note : •Both Min Slice Size and Max Slice Size parameters are optional.
If both Min Slice Size and Max Slice Size parameters are not provided, then algorithm behaves like DYNAMIC_ ALGO .
•If both Select- Algo and Algo- Name are configured in the rule, then preference is given to Select- Algo .
•If Max Slice Size is not configured and Min Slice Size is configured, then the Max Slice Size is the initial bucket value.String Optional Max- Number- Of-Devices- In-GroupThis parameter determines the maximum number of devices with rating group.
For any device, the maximum number of lines with respect to rating group is 10.
It is applicable to customized rule/ default actions.
Consider the following points while configuring this parameter: •The number of rating group that a device can support should be considered.
For example, if there are 4 devices in a group and each device creates a session from two different rating groups, then number of lines is 4 * 2 = 8.
•The maximum number of device a group can have and the number of session a device can create related to different MSCC.
Otherwise, the algorithm computes slice with errors.Long Mandatory Min- Slice- Size This parameter indicates the minimum slice size defined for the quota management profile.
The value is defined in bytes and applicable for Granted Service Units ( GSU) of volume type.
The value must not be negative and not in decimal.
It is applicable to customized rule.
Note : The minimum value is 0 and the maximum value is 9223372036854775807.Long Optional Max- Slice- Size This parameter indicates the maximum slice size defined for the quota management profile.
The value is defined in bytes and applicable for GSU of volume type.
This value must not be negative and in decimal.
Note : The minimum value is 0 and the maximum value is 9223372036854775807.
0 value is considered as not configured.Long OptionalTable 148: Attributes available for DYNAMIC_SLICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1532Charging User Guide Charging configuration (new GUI) Attribute Description Type Mandatory/ Optional Quota- Holding- Time This parameter indicates the value of the quota holding time in seconds and controls the time the session remains in the idle state in the network.
It is applicable to customized rule or default actions.
When the value of this parameter is 0, QHT is sent to the network.Long Optional Slice- Allocation- Factor This parameter indicates the value calculated on the delta between the current usage and threshold value.Long Optional Slice- size This parameter indicates a static size of slice in bytes.
It is applicable to customized rule/ default actions.
The value of this parameter must always be greater than zero.
This parameter must be included in the rules when configured without algorithms Dynamic_ Algo or Dynamic_ Algo_ 2.Long Optional Validity- Time This parameter indicates the value of the validity time in seconds, controls the time the quota remains active in the network, and controls the effective allocation of resources ( dynamic slice allocation) .
It is applicable to customized rule.
The value of this parameter is always greater than zero.
If defined as zero, then fallback is to default action or values in quota management profile.Long Mandatory Volume- Quota- Threshold This parameter is applicable to data ( volume) call, supported for both centralized and decentralized calls.
It can be used when certain quantity ( volume only) is reserved and granted in CCA.
It is applicable to customized rule.
The value of VQT can be configured in percentage and calculated on the granted volume quota sent in CCA, such as 90% .
If the VQT value is 0 or after calculation the VQT value is 0, then it is not sent in CCA.
The value of VQT can also be configured as fixed value.
If the Volume- Quota- Threshold- Algo is configured as FIXED_ ADD_ IN_GSU , then the Volume- Quota- Threshold parameter in quota management profile rule specifies the absolute value used to set the AVP in CCA message sent back to the network.
Note : It is recommended to keep the VQT percentage value as higher as possible so that it does not increase TPS.
If VQT value after calculation is greater than 4, 294, 967, 295, then 4, 294, 967, 295 is set as VQT value.
This is according to the specification of Volume- Quota- Threshold AVP which is of type unsigned32 and maximum value allowed is 4, 294, 967, 295.
The value of this parameter is in the range of 0 to 100.Long Optional Table 148: Attributes available for DYNAMIC_SLICE result context (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1533Charging User Guide Charging configuration (new GUI) Attribute Description Type Mandatory/ Optional The VQT parameter can be configured in both default action and rule.
Volume- Quota- Threshold- AlgoThis parameter is added in the quota management profile rule under Dynamic_ Slice and can have one of the following values: •FIXED_ ADD_ IN_GSU : When configured as FIXED_ ADD_ IN_GSU , then the Volume- Quota- Threshold parameter in quota management profile rule specifies the absolute value used to set AVP in CCA message sent back to the network.
It is added to the derived quota amount to determine the GSU value when GSU is not a final slice.
•PERCENTAGE : When configured as PERCENTAGE , the Volume- Quota- Threshold parameter value in quota management profile rule is configured in % and calculated on the granted volume quota sent in CCA message.
By default, the value of this action attribute is set as PERCENTAGE to achieve the existing slice reduction functionality.
This parameter is also defined per MSCC or rating group.
Depending on the type of algorithm used, the Volume- Quota- Threshold parameter is calculated and sent back to the network in CCA message.Long Optional MIN- TTC This parameter indicates the minimum tariff time change value in seconds.
If this parameter is not configured, then it is treated as 0.
If MIN- TTC is greater than MIN- TTC, then MIN- TTC value is ignored and treated as 0.
It is applicable to customized rule.Long Optional MIN- VT This parameter indicates the minimum validity time in seconds.
If this parameter is not configured, then it is treated as 0.
It is applicable to customized rule.Long OptionalTable 148: Attributes available for DYNAMIC_SLICE result context (continued) Consumption speed configuration The condition attribute CALL_COMMON.Consumption-Speed is available to calculate consumption speed for a call.
When NCC receives a charging signal, it calculates the consumption speed using the timestamp of the previous charging signal as follows: Consumption speed = Reported quota usage in last slice/Total duration for last slice The following table demonstrates sample rule for configuration based on consumption speed.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1534Charging User Guide Charging configuration (new GUI) Default actions/ New rule nameRule Information Default Actions Add the following action to existing actions: DYNAMIC_ SLICE.
Validity- Time = 36000VT1 = 36000 Rule1 if CALL_ COMMON.
Consumption- Speed > = 291 and CALL_ COMMON.
Consumption- Speed < 1456 then DYNAMIC_ SLICE.
Validity- Time = 28800Speed1 = 1456 VT2 = 28800 Rule2 if CALL_ COMMON.
Consumption- Speed > = 1456 and CALL_ COMMON.
Consumption- Speed < 2912 then DYNAMIC_ SLICE.
Validity- Time = 21600- Rule3 if CALL_ COMMON.
Consumption- Speed > = 2912 and CALL_ COMMON.
Consumption- Speed < 11650 then DYNAMIC_ SLICE.
Validity- Time = 18000Speed2= 11650 VT3 = 18000 Rule4 if CALL_ COMMON.
Consumption- Speed > = 11650 and CALL_ COMMON.
Consumption- Speed < 6553600 then DYNAMIC_ SLICE.
Validity- Time = 10800- Rule5 if CALL_ COMMON.
Consumption- Speed > = 6553600 then DYNAMIC_ SLICE.
Validity- Time = 3600- Rule6 GY_PRE_ PROCESSING.
Is-TTC- Enabled = True and GY_ PRE_ PROCESSING.
Tariff- Time- Change = 00: 00:00Use this when the quota management profile returns a different VT based on the calculated consumption speed.Table 149: Sample rule for configuring consumption speed Additional information Following are noteworthy points: •DYNAMIC_SLICE.Select-Algo has higher priority than DYNAMIC_SLICE.Algo-Name .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1535Charging User Guide Charging configuration (new GUI) •Rules are evaluated one-by-one, first one to be evaluated to true is picked up and algorithm defined in the actions are used for slicing.
•If none of the dynamic quota management profile rules are matched, then the slicing logic processes the DefaultAction .
•The DefaultAction is picked only when any of the rule defined is not true and if the DefaultAction is also not valid, then static values defined at entity level are picked for processing.
Therefore, static values have least priority.
•If DYNAMIC_ALGO_2 is defined without the optional parameters of Min Slice Size and Max Slice Size , then it works same as DYNAMIC_ALGO .
•The Select-Algo configuration is not case-sensitive.
•In case of decentralized charging, if the Algo-Name is DYNAMIC_ALGO or DYNAMIC_ALGO_2 in the quota management profile object rule, then the DefaultAction is executed as per the configuration.
•In case of centralized charging, it is recommended not to configure the DefaultAction with Algo-Name .
If configured, then the Algo-Name is ignored.
•In case of centralized charging, do not configure VT as 0 in the quota management profile rule.
If VT is 0, then it is not considered as NOK scenario and the final value is read from the quota management profile, bypassing the processing of DefaultAction .
•In case of centralized charging, for non-IMS and non-volume buckets, if a rule is configured in the quota management profile, then that rule is executed.
If the Dynamic Algo is configured in the rule or if a rule is not configured, then default profile action is considered.
The following table provides information about the valid and invalid configurations for the Select-Algo parameter.
Algo configuration Algo- Name Min Max Valid/ Invalid DYNAMIC_ SLICE.
Select- Algo ( " DYNAMIC_ ALGO_ 2", 1, 1024)DYNAMIC_ ALGO_ 2 1 1024 Valid DYNAMIC_ SLICE.
Select- Algo ( " Dynamic_ algo_ 2", , 1024 ) Dynamic_ algo_ 2 NA 1024 Valid DYNAMIC_ SLICE.
Select- Algo ( " DYNAMIC_ ALGO_ 2", 1 , ) DYNAMIC_ ALGO_ 2 1 NA Valid DYNAMIC_ SLICE.
Select- Algo ( " Dynamic_ Algo_ 2", 1, 1024 ) Dynamic_ algo_ 2 1 1024 Valid DYNAMIC_ SLICE.
Select- Algo ( " DYNAMIC_ ALGO_ 2" ) DYNAMIC_ ALGO_ 2 NA NA ValidTable 150: Select-Algo configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1536Charging User Guide Charging configuration (new GUI) Algo configuration Algo- Name Min Max Valid/ Invalid DYNAMIC_ SLICE.
Select- Algo ( " Dynamic_ Algo_ 2" ) Dynamic_ algo_ 2 NA NA Valid DYNAMIC_ SLICE.
Select- Algo ( " DYNAMIC_ ALGO_ 2" , 1500 , 24 )DYNAMIC_ ALGO_ 2_ 1500 24 Invalid DYNAMIC_ SLICE.
Select- Algo ( " DYNAMIC_ ALGO_ 2" , 500 , 500)DYNAMIC_ ALGO_ 2_ 500 500 Invalid For the preceding two invalid scenarios, algorithm is not executed but the algorithm rule slice size is returned.
If a rule slice size is not configured, then it gets picked from the entity slice size.Table 150: Select-Algo configuration (continued) Note : If Min Slice Size or Max Slice Size is configured as zero, then it is considered as no minimum or maximum slice configured.
Actions associated with a quota management profile Action Description Create Creates a quota management profile entity in the database by providing the mandatory and optional parameters.
Read Displays the quota management profile entity data fetched from database.
Update Updates a particular quota management profile entity in database.
Delete Deletes a particular quota management profile entity from database.
This operation is not recommended.
Note : These actions are valid for internal purposes only and cannot be accessed using the SM GUI.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1537Charging User Guide Charging configuration (new GUI) 5.
14 Cap Attention : Cap is supported only through API and this support will be deprecated in the future.
It is recommended to use Threshold for Cap-related function and migrate the existing Cap configuration to Threshold.
Cap is the limit applied by the top-level group to the device on its hierarchy resources either directly (directly applied to the device) or indirectly (applied to the low-level group to the devices associated with that low-level group).
Note : In a multi-level hierarchy group, cap is not applicable to the middle-level(s) because intermediate levels ideally do not have resources.
Following are few important points for cap entity: •Cap can only be applied to shared resources, such as bucket or main balance.
For example, cap is applied as a unit for data buckets or as money for main balance.
•Cap is not applicable to the subscription fees.
•Cap defined for a group is applicable only if the group counters are defined as rule engine output and inside the group definition.
•Cap is expressed in absolute value for unlimited shared resources and multi-level group hierarchy resources.
•Cap on overage determines the limit on the overage value allowed on the main balance of the account.
Note : The call is not allowed below the limit of cap value defined for the main balance.
Comparison between cap and threshold The following list shows a comparison of cap and threshold: •Cap and threshold are not same.
•Cap actions and threshold actions are not same.
There are different actions supported at threshold and different at cap.
•For a cap associated with a counter, the Threshold Profile Group Instance, Threshold Profile Instance and Threshold Instance are created and embedded in the counter instance while creation of a subscription.
•Cap is similar to a Threshold Profile Group having a single Threshold Profile and Threshold.
•The cap name is referenced in the counter threshold list, similar to Threshold Profile Group Name .
•Cap is associated with counter only while a threshold is associated with both bucket and counter.
Cap actions When a cap is reached, NCC performs either one or a combination of the following actions: •Notification-Stop : This action notifies to stop using the resource and switch to the next resource.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1538Charging User Guide Charging configuration (new GUI) •Notification-Continue : This action notifies to continue using the same resource.
•Notification-Reject : This action notifies and rejects the call.
•Reject : This action rejects the call.
•Send-RAR : This action notifies to reauthorize the call.
Configuration details Cap is supported only through API.
The following table describes the parameters: Note : •For provisioning purpose, the cap entity is included in threshold.
Cap reuses the threshold functionality for database parameters, such as Rule Id , RuleScannerPlugin , and RuleSet .
•No separate cap table is created in database.
Instead, Threshold Profile Group table is used to store the cap limit in the database.
Basic Details Parameter Description Options Mandatory/ Optional Cap Name This parameter indicates a unique name of the cap.
The cap name is appended with .CAP at the end of the string and stored in the database.String Mandatory Unit Type This parameter indicates the unit type associated with the cap entity.
Note : The cap unit type must match with the unit type of the counter defined or referenced with in the Group Definition.Select the required unit type from the given unit types in the drop- down list.MandatoryTable 151: Parameters for cap Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1539Charging User Guide Charging configuration (new GUI) Parameter Description Options Mandatory/ Optional Value This parameter indicates the value of the cap limit.
Ensure that the cap value is a positive value.Long Mandatory Cap Policy This parameter indicates the cap policy.
The field value can be set to either of the given values: •true: The cap is a Policy CAP.
•false: Threshold Rule Action is Send- SNR , the flag forcibly needs to be set to true and the threshold is then Policy Threshold.Select this check box to indicate whether the cap is a Policy CAP.Optional Security Domain This parameter indicates the security domain associated with the cap.Select the required security domain from the predefined security domains in the drop- down list.Optional Configuration This parameter indicates the cap entity configuration.String Optional Add rule configuration to cap.Table 151: Parameters for cap (continued) Actions associated with cap A wrapper entity over threshold is used as a cap, where the cap value defined over the counter is used either as a group counter or a device counter.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1540Charging User Guide Charging configuration (new GUI) Action Description Create Used to provision a cap entity in database after defining the cap value and providing the other mandatory parameters.
Create Cap Used to provision a cap entity in database for the cap fields entered.
Delete Used to remove a cap definition object from database.
Delete Cap Used to delete a cap entity for the cap ID entered.
GetDevice Group Cap Used to fetch all the Device Group Counters from database and get the list of cap.
It also gives the difference between the counter current value and cap value.
If the cap value is greater than the counter current value then the difference value is positive else difference value is negative.
Read Used to read the Threshold Profile Group for the given Id.
Read Cap Used to read the cap for the given Id.
Threshold Profile Group Exists Used to check if the Threshold Profile Group exist for the given Id.
Update Used to modify the cap definition or the possible action required for this cap in database.
Update Cap Used to update the cap object.
Note : These actions are valid for internal purposes only.
It is not accessible through the SM GUI for operators 5.
15 Updating latest published active version NCC allows you to create versions of the charging entities such as Charging Logic , Service , and Mapping Table .
When a version is created, the effective date of the newly published version and the previous version are different.
Operators can now update the latest published active version without any change in the effective date.
This feature provides the functionality to fix (update or edit) the latest published active version of the following charging entities: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1541Charging User Guide Charging configuration (new GUI) •Charging Logic •Balance Logics •Service (Bundle) •Mapping Table The latest published active version of the supported charging entities can be fixed (updated or edited) and published.
The fixed version of the latest published active version is called a Patch Fix or Backdated Fix .
The effective date of the Patch Fix is same as that of the latest published version, regardless of when the Patch Fix is published.
For example: If V2.0 is published on Jan 15, then V2.0 patch 1 (patch fix) can be published on Jan 30 with the effective date of Jan 15.
Note the following important points about this feature: •Only the latest published active version can be fixed (edited or updated).
•If the latest published version is not active yet, then a fix is applicable through withdraw and edit.
In this case, updating the latest published version (creating a patch fix) is not possible as it is not the current active version.
Note : The current active version can be fixed (edited or updated) even if there is a future version.
•Patch fix includes changes such as adding, removing, and updating the latest published active version of the supported charging entities.
•Published patch fixes take effect immediately, regardless of the version type.
•In case of a patch fix with bundle version type as BCR, the subscriptions associated with that bundle are fixed according to their BCR.
The fix is applicable only for the subscriptions in which BCR has been completed.
If the BCR is not done, then the fix is applicable only at the BCR.
For example: Consider a subscription with bundle V1.0 which has monthly BCR.
If V2.0 is published on Jan 15, and the next BCR is on Feb 1, then this version is not applicable till the BCR.
If a patch fix (V2.0 patch 1 ) is published on Jan 20 with the same effective date as that of V2.0 , then the patch fix is applicable only on Feb 1 (BCR).
Patch fix Multiple patch fixes for the same published version are allowed.
That is, the patch fix can be further updated and published.
Patch fix replaces (overrides) the previous version.
If the latest published version is major (for example, 1.0, 2.0, 3.0..), then creating and publishing a patch fix overrides the latest published version.
If the latest version is minor (for example, 1.1, 1.2, 1.3...), then it is manually updated without publishing.
For example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1542Charging User Guide Charging configuration (new GUI) •The latest version V3.0 is updated and published as V3.0 patch 1 .
V3.0 patch 1 is now the latest published version.
The earlier version ( V3.0 ) cannot be fixed (edited or updated) as it is overridden by the latest published version ( V3.0 patch 1 ).
•V3.0 patch 1 is updated and published as V3.0 patch 2 .
Now, V3.0 patch 2 is the latest published version which can be updated and published.
The earlier version ( V3.0 patch 1 ) cannot be fixed (edited or updated) as it is overridden by the latest published version ( V3.0 patch 2 ).
Note : •For a major version, up to 1000000 patch fixes of the latest published active version are allowed.
•For a minor version, unlimited updates can be done.
NCC allows you to create up to 1000000 minor versions.
Use cases Use case 1: Latest published active version can be updated.
•Create a charging entity (Service, Charging Logics, Balance Logics, or Mapping Table).
•Create a version V1.0 of the charging entity.
•Fix (update or edit) the version V1.0 .
Result : V1.0 patch 1 is created.
•Publish V1.0 patch 1 .
Use case 2: Only the latest published active version can be updated.
•Create a charging entity (Service, Charging Logics, Balance Logics, or Mapping Table).
•Create a version V1.0 of the charging entity.
•Create a version V2.0 of the charging entity.
•If V1.0 needs an update, it cannot be fixed (update or edit) because it is not the latest published version.
•Fix (update or edit) the version V2.0 .
Result : V2.0 patch 1 is created.
•Publish V2.0 patch 1 .
Use case 3: Patch can be created only for major versions.
Minor versions are updated manually and without publishing.
•Create a charging entity (Service, Charging Logics, Balance Logics, or Mapping Table).
•Create a major version V1.0 of the charging entity.
•Create another major version V2.0 of the charging entity.
•Create a minor version V2.1 of the charging entity.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1543Charging User Guide Charging configuration (new GUI) •If V1.0 needs an update, it cannot be fixed (update or edit) because it is not the latest published version.
•Fix (update or edit) the version V2.0 .
Result : V2.0 patch 1 is created.
•Publish V2.0 patch 1 .
•V2.1 is manually updated without publishing.
Use case 4: Patch fix replaces (overrides) the previous version.
•Create a charging entity (Service, Charging Logics, Balance Logics, or Mapping Table).
•Create a version V1.0 of the charging entity.
•Create a version V2.0 of the charging entity.
•If V1.0 needs an update, it cannot be fixed (update or edit) because it is not the latest published version.
•Fix (update or edit) the version V2.0 .
Result: V2.0 patch 1 is created.
•Publish V2.0 patch 1 .
•If V2.0 needs an update, it cannot be fixed (update or edit) because it is overridden by the patch fix (V2.0 patch 1 ).
Use case 5: Latest published version can be updated only when it is active.
•Create a charging entity (Service, Charging Logics, Balance Logics, or Mapping Table).
•Create a version V1.0 of the charging entity.
V1.0 is the current active version.
•Create a version V2.0 of the charging entity.
•If V2.0 needs an update, it cannot be fixed (update or edit) because it is not the current active version.
Note : If the latest published version is not active yet, then a fix is applicable through withdraw and edit.
•Fix (update or edit) the version V1.0 .
Result : V1.0 patch 1 is created.
•Publish V1.0 patch 1 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1544Charging User Guide Common configuration (legacy GUI) 6Common configuration (legacy GUI) This chapter describes the configuration of platform and common components.
6.
1 Global Configuration Whenever a voice, video, SMS, or MMS call is received, the GY_PRE_PROCESSING rule set is triggered.
In this trigger, there is an option to apply the conditions on the called/calling party number, which is present in a globally allowed list or barred list.
NCC checks whether the emergency is set on device.
If emergency is set with a valid emergency level, which includes the call type of the received call, then call is always allowed even though global parameter rules or UC configuration states that call should be blocked.
Otherwise, depending on the sequence of rules configured where, it is checked whether the called party number is barred or not.
If the number is barred and emergency is not yet set on the device, then, the call is rejected at this point for initial requests with GSU as zero.
For update case, the call is rejected but after incrementing counter for any received USU and threshold is executed and a GSU with zero value is returned.
But if this is an emergency call and even though the rule states that number is barred, then it has no meaning as emergency overrides and the call continues without any usage control checks.
Usage checks will be skipped in all emergency scenarios.
Similarly, if the number is not blocked then a check must be done to find whether the number is in allowed list or not.
This is again governed by rule if configured.
If the globally allowed list is empty, then it has no impact and the call continues further with applicable usage control checks.
In case, the number is globally allowed, then it means all usage control checks must be skipped.
Otherwise, if the number is not in the list, then it means it is not always allowed case and further usage control checks must be done for rating group or APN.
Therefore, for any sequence/combination of rules if the action is SESSION_PARAMETERS.UC- Applicable = BooleanEnum_FALSE , then the UC checks are skipped.
Otherwise, they are applied in non-emergency scenarios.
The Global Configuration tab allows a user to define the weekday and weekend for a Usage control time of day feature.
Following lists are available at global level for charging services: •Allowed Numbers •Barred Numbers •Always Allowed APN •Always Allowed RGs •Weekday •Weekend Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1545Charging User Guide Common configuration (legacy GUI) Configuration Log into the SM GUI, navigate to Common Configuration > CHARGING tab and select Global Configuration from the hamburger menu (☰) and define the required parameters as described in the given table: Basic Details Parameter Description Options Mandatory/ Optional Allowed Numbers This parameter defines the list of globally allowed numbers.Integer Optional Allowed RGs This parameter defines the list of globally allowed RG numbers.Long Optional Barred Numbers This parameter defines the list of global barred numbers.String Optional Allowed APNs This parameter defines the list of globally allowed APN numbers.Long Optional Weekday This parameter defines the list of days of week.
String Mandatory Weekend This parameter defines the days of week.
String Mandatory TOD Policy Counter ID This is the policy counter ID used to send status of the TOD Policy counterString Optional TOD Inside Policy Counter Status This is the status communicated to PCF when the last Gy/N40 call is received inside the Time Of Day window.String Optional TOD Outside Policy Counter Status This is the status communicated to PCF when the last Gy/N40 call is received outside the Time Of Day window.String Optional TOD Not Applicable Policy Counter StatusThis is the status communicated to PCF when the Gy/N40 call lands and there is no UC Time OfDay configured in the subscription.
Also, during a Gy/ N40 call, if a Sy Session exists for the device which contains the configured TOD Policy Counter ID with Inside or Outside , but the feature flag ( Allow Rating Group flow during Time OfDay) is disabled, an SNR/ N28_ Notify is generated which sends the status configured in the TOD Not Applicable Policy Counter Status.
It effectively cancels the status of TOD PCID at PCF, as the feature is now disabled.String Optional TOD Allowed RGs This parameter contains the rating groups for which there will be a successful grant even inside the TODInteger OptionalTable 152: Parameters for global configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1546Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional time- frame.
Thus, TOD restrictions are not applied to these RGs during 4G or 5G calls but other UC restrictions will still be applied.Table 152: Parameters for global configuration (continued) 6.2 Usage Control Usage Control (UC) is a network operator service that allows the user to subscribe on per device basis.
It is controlled by a parent account and the subscription applies to the child device.
The usage control subscription allows the following functionalities: •Number of restrictions (for calls and messages only) through global and individual barred and allowed lists.
Note : Allowed list overrides the allowed time of day and usage limit restrictions.
•Time of day restrictions on the usage of data, voice, messages, and eCommerce during periods, day types (weekday or weekend) or within a day.
•Maximum usage (per traffic type and per billing period).
The usage limit is based on traffic units (not based on related monetary amount), except for eCommerce traffic where traffic units are actual monetary amounts.
The globally defined allowed and barred lists allow the service operator to bar the traffic (in case of barred lists) or skip UC controls (in case of allowed lists).
Some globally defined traffic types, such as rating groups and APN combinations are excluded from the UC even when usage counting may still be applied.
During an emergency period, all UC controls are bypassed for specific traffic types configured by the service operator or user.
Note : In case of call forwarding, an allowed list or barred list check is performed during the call.
Configuration Log into the SM GUI, navigate to Common Configuration > CHARGING tab and select Usage Control from the hamburger menu (☰).
To define a new usage control, click to add the basic details as described in the given table: Basic Details Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1547Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional Name This parameter indicates a unique name of the UC service.String Mandatory Priority This parameter indicates the priority of the usage control service.
Higher the number, lower is the priority of the usage control service.
Note : Ensure that the value of this parameter is greater than zero.Integer Valid range: 1 to 2147483647Optional Allowed List This parameter indicates the list of numbers to be added in the UC service allowed list.
It is typically left empty, as usually set at subscription level.String Optional Barred List This parameter indicates the list of numbers to be added in the UC service barred list.
It is typically left empty, as usually set at subscription level.String Optional Applicability Condition This parameter indicates a rule condition expression evaluated to determine whether the usage control service is applicable.- Optional Click ADD LIMIT to define usage limit using the following parameters: Limits Kind Of Unit This parameter indicates the type of traffic, that service operators wants to be controlled by subscriber, for usage limit or time or day features.
Select from a predefined set of values in the drop- down list.Select one of the following values from the drop- down list: •Voice/ Video •Data •Sms/ Mms •E- CommerceMandatoryTable 153: Parameters for usage control Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1548Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional Select Counter This parameter is used for usage limit feature, in case service operator wishes that subscriber can change the limit of an existing charging service counter ( reference counter) .
If left empty, then a UC dedicated counter is self- created for usage limit feature.Select the required counter from the drop- down list.Optional Applicability Condition This parameter indicates a rule condition expression evaluated to determine whether the usage limit is applicable.- Optional Usage Control Set Limit This parameter defines the usage limit for usage control limit.
It is typically set after subscription.Select the value from the drop- down arrows.Mandatory Limit Unit Type Note : This parameter is read- only and set to not applicable.- Optional Thresholds This parameter indicates the list of thresholds to be applied during a usage limit execution.
It includes notification thresholds and hard- stop thresholds.
Note : Generally, the thresholds included in this list consist of percentage type and absolute- from- end thresholds.String Optional Overage Limit The overage limit is used to track usage once the usage limit is consumed.
It is applicable only if usage limit is defined.BigDecimal Optional Overage Threshold Profile Group IDsThis parameter indicates the names of threshold profile groups applicable for overage usages.List< String> Optional Time Of Day Click ADD DAY OF WEEK to add a specific day in the week to which the time of day feature is applied: Day of Week This parameter defines the day of week and allows to specify the range of days ( weekdays and weekend days) .String Optional Start Time This parameter defines the start time of the week.
It is typically set after subscription.Integer OptionalTable 153: Parameters for usage control (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1549Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional End Time This parameter defines the end time of the week.
It is typically set after subscription.Integer Optional Click ADD TIME to add a specific time for the time of day feature and add another Start Time and End Time .Table 153: Parameters for usage control (continued) Examples Example 1 For reference counter: 1.Counter (reference) from base bundle of charging service is consumed.
2.Usage limit overrides the base usage limit of the reference counter.
3.Threshold associated with the reference counter triggers the actions based on the soft-stop or the hard-stop (as configured).
Example 2 For self-counter: 1.Counter created by usage control is consumed.
2.Usage limit is the limit of the self-counter.
3.Threshold associated with the self-counter triggers the action based on the soft-stop or the hard- stop (as configured).
Actions associated with usage control Action Description Create Creates a usage control entity in the database by providing details for parameters, such as Name , Priority , and Allowed List .
Read Displays the usage control entity in the database.
Update Updates the usage control entity in the database.
Delete Deletes a usage control entity from database.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1550Charging User Guide Common configuration (legacy GUI) Note : These actions are valid for internal purposes only and cannot be accessed using the SM GUI.
Announcement and notification for Call Message Block (CMB) and Usage Control (UC) This feature allows you to configure announcements or notifications to be sent to the subscriber for both Usage Control (UC) and Call Message Block (CMB) in the following cases: Call Message Block (CMB) MT voice calls: Operators can configure this feature to not receive announcements and notifications on MT voice call from the barred numbers.
MT SMS: Operators can configure this feature to not receive notifications on MT SMS call from the barred numbers.
Usage Control (UC) Operators can configure to deny the call in the following cases: •Barred by block list.
•Hard-stop limit reached.
•Barred due to Time of Day (TOD).
Operators can configure the call to be disconnected in the following cases: •Hard-stop limit reached.
•Barred due to Time of Day (TOD).
The ThresholdTriggerType_RESERVATION action should be configured in threshold if the operator wants to send the notification in the following cases: •RSU is greater than the threshold delta.
•Threshold is already crossed and a direct debit call is initiated again.
However, if the operator does not want to receive notification or announcement when threshold is crossed during call, then it is not recommended to configure the ThresholdTriggerType_RESERVATION action in threshold.
Note : •Announcement for SMS/MMS calls should not be configured in GY_PRE_PROCESSING and UC_PROCESSING triggers.
•Announcement is also supported for VSA AVPs.
Use cases Use case 1: Verify that SMS_MO call is rejected when Hard-stop limit is reached on usage limit when Notification-Reject action is configured.
Configuration : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1551Charging User Guide Common configuration (legacy GUI) 1.Create a Threshold of ABS type (value of 100 units) with Notification-Reject action.
2.Create a subscription counter of UNIT type.
3.Create a multi-bundle counter of UNIT type.
4.Create a Charging Logic with the subscription counter and multi-bundle counter.
The Charging Logic has no charge.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1552Charging User Guide Common configuration (legacy GUI) 5.Create Usage Control of UNIT Type with usage limit of 300.The Usage Control has a reference multi- bundle counter.
Attach the created TPG to the Usage Control .
6.Create bundle with the created Usage Control and Charging Logic .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1553Charging User Guide Common configuration (legacy GUI) 7.Configure the notification template.
Execution : •Execute the SMS-IEC RSU = 100.
Result: Threshold is reached and notification is sent.
•Execute another SMS-IEC RSU = 100.
Result: Call is rejected with an error code 4012 for Hard-stop on usage limit and a notification is sent.
Device overview before SMS IEC: Device overview after SMS IEC, RSU = 100 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1554Charging User Guide Common configuration (legacy GUI) Use case 2: Verify that IMS_MO call is rejected when called number is present in the barred list, and announcement and notification are sent.
Configuration : •Configure the rule for barring in IMS_CALL_ESTABLISHMENT .
•Create a custom data named BARREDLIST .
•Create a subscription counter of TIME type.
•Create a Charging Logic having no charge and the created subscription counter.
•Create a bundle with the Charging Logic .
•Create a device and subscribe to the bundle.
Add the BARREDLIST custom data to it.
•Configure the notification template.
Execution : •Execute the IMS-I with barred number present in called party address.
Result: Call is rejected as the called number is present in the barred list.
Notification and announcement are sent.
Use case 3: Verify that SMS call is rejected when the called number is present in the barred list in Usage Control, and a notification is sent.
Configuration : •Configure the rule for Usage Control barring in UC_PROCESSING trigger.
•Create a multi-bundle counter of UNIT type.
•Create a Charging Logic having no charge and the created multi-bundle counter.
•Create a Usage Control of UNIT type with the barred number configured.
•Create a bundle with the created Usage Control and Charging Logic .
•Configure the notification template.
Execution : •Execute the SMS-IEC MO with barred number.
Result: Call is rejected as the called number is present in the barred list of Usage Control .
A notification is sent.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1555Charging User Guide Common configuration (legacy GUI) 6.3 Aggregate View An aggregate view aggregates all resource information from all entities of the same type (like buckets, counters).
For information on support of Send-SNR action and QoS handling when AV is exhausted or updated, see the SNR action and QoS handling when charging resources are exhausted or updated on page 2079 section.
Configuration Log into the SM GUI and navigate to Common Configuration > CHARGING tab and select Aggregate View from the hamburger menu (☰).
To define a new aggregate view, click to add the basic details as described in the following table.
Parameter Description Options Mandatory/ Optional Name Identifier for uniquely identification of aggregate view.String Mandatory Unit Type Unit type for the aggregate view.
Enum Select the required unit type.Mandatory Application Type Application type of aggregate view.
Enum Only Charging is supported currently.Mandatory Description Description of the aggregate view.
String Optional Security Domain Indicates the security domain associated with the aggregate view.Select the required security domain from the predefined security domains in the drop- down list.Optional Aggregate Type Aggregate type of aggregate view.
The supported values are as follows: •Charging Service : Aggregate bucket defined in AV.
•Charging Service and CAP : Aggregate bucket and cap of device- group counter for shared bucket on group defined in AV.Enum MandatoryTable 154: Parameters for aggregate view Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1556Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional •Counter : Counter defined in AV.
Charging Services Contains the list of Charging Service entity IDs corresponding to the aggregate type.
Only the created CS can be provisioned in the AV.
If not selected, then it means that all the charging services with same unit type can be aggregated.List < String> Optional Device Group Counters This parameter is enabled when the aggregate type Charging Service and CAP is selected.
Indicates a device counter attached to a group.
If not selected, then it means that all the device group counters with same unit type can be aggregated.List < String> Optional Counter Types This parameter is enabled and applicable only when counter is selected for Aggregate Type.
If not selected, it means ALL, that is, all the counters with same unit type can be aggregated.
The supported values are as follows: •SUBSCRIPTION : Counter defined in charging service.
•DEVICE : Aggregate the device counter.
•DEVICE_ GROUP : Aggregate the device- group counter.
•GROUP : Aggregate the group counter.Enum Optional Threshold Profile Groups List of threshold profile group Id list used in Rating logic to send notifications, SNR.
Only the created TPG can be provisioned in the AV.List < String> OptionalTable 154: Parameters for aggregate view (continued) Aggregate view - instance Parameter Description Options Mandatory/ Optional Instance Id Unique ID.
String Mandatory defName Name of the aggregate view instance.
String Mandatory for Aggregate View instance.
Aggregate view definition taken at the time of creation.Table 155: Parameters for aggregate view - instance Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1557Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional Read- only and non- modifiable.
device GrpCounters List of names of device group counters.
List< String> Optional counter Types Counter types aggregated when aggregate Type is selected as COUNTER.String Optional Unit Type Identifies the type of unit.
String Mandatory for Aggregate View instance.
Aggregate view definition taken at the time of creation.
Read- only and non- modifiable.
Creation Time The time stamp of when this aggregate view was created.
The value is automatically generated.Long Mandatory for Aggregate View instance.
Linux timestamp taken at the time of creation.
Read- only and non- modifiable.
application Type Indicates the type of application such as Charging.
Application Type Mandatory for Aggregate View instance.
Aggregate view definition taken at the time of creation.
Read- only and non- modifiable.
aggregate Type Indicates the aggregate type such as Charging Service.
Aggregate Type Mandatory for Aggregate View instance.
Aggregate view definition taken at the time of creation.
Read- only and non- modifiable.
aggregate List Contains the charging service IDs.
List< String> Optional for Aggregate View instance.
Aggregate view definition taken at the time of creation.
Read- only and non- modifiable.
Initial Value The initial value of the bucket/ bucket- cap/ counter.
BigDecimal Mandatory for Aggregate View instance.
Set aggregate initial value of same kind of bucket/ bucket- cap/ counter at time of creation.
Read- only and non- modifiable.Table 155: Parameters for aggregate view - instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1558Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional Current Value The current value of the bucket/ bucket- cap/ counter.
BigDecimal Mandatory Saved as long in DB.
It is set same as initial value at the time of creation and can be updated to any positive value.
Set as " 0" when no value is given in update request.
Unused Value The unused value of the bucket/ bucket- cap/ counter.
BigDecimal Mandatory Saved as long in DB.
It is set same as initial value at the time of creation and can be updated to any positive value.
Set as " 0" when no value is given in update request.
Initial COBVal The initial value of carry- over bucket.
BigDecimal Saved as long in DB.
Mandatory for Aggregate View instance.
Set aggregate initial value from same kind of carry- over bucket instances at time of creation.
Read- only and non- modifiable.
Curr COBVal The current value of carry- over bucket.
BigDecimal Mandatory Saved as long in DB.
It is set same as initial carry- over bucket value at the time of creation and can be updated to any positive value.
Set as " 0" when no value is given in update request.
Unused COBVal The unused value of carry- over bucket.
BigDecimal Mandatory Saved as long in DB.
It is set same as initial carry- over bucket value at the time of creation and can be updated to any positive value.
Set as " 0" when no value is given in update request.
threshold Profile Group IdList The list of TPG Id.
List< String> Optional Aggregate view definition taken at the time of creation.
Read- only and non- modifiable.Table 155: Parameters for aggregate view - instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1559Charging User Guide Common configuration (legacy GUI) Note : The Aggregate view entity - instance cannot be modified through SM GUI.
Some of the parameters listed in the table are linked to the calculations performed by the internal service logic.
Actions associated with an aggregate view Action Description Create Used to create an aggregate view entity in database by providing the mandatory and optional parameters.
Read Used to display the aggregate view entity per the data retrieved from database.
Update Used to update a particular aggregate view entity in database.
Delete Used to delete a particular aggregate view entity from database.
addAVsToDevice Used to attach a list of AVs as well as a single AV to a device.
addAVsToGroup Used to attach a list of AVs as well as a single AV to a group.
remove AVsFrom Device Used to remove a list of AVs as well as a single AV from a device.
remove AVsFrom Group Used to remove a list of AVs as well as a single AV from a group.
delete AVInst While Deleting Device Used to delete all the AV instances corresponding to that device when a device is removed.
delete AVInst While Deleting Group Used to delete all the AV instances corresponding to that group when a group is removed.
Following are the actions associated with the AV instance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1560Charging User Guide Common configuration (legacy GUI) Action Description Read Used to read an aggregate view instance from database by providing the mandatory and optional parameters.
Aggregate View Instance ID is the mandatory parameter.
getAvInstances ByDevice Id Used to get AV instance list attached to a device.
getAvInstances ByGroup Id Used to get AV instance list attached to a group.Table 156: Aggregate View - instance Note : These actions are valid for internal purposes only.
It is not accessible through the SM GUI for operators.
AV threshold variables The AV threshold variables are AV-Def-Name , AV-Unused-Value , AV-Current-Value as shown in the following figure.
Examples Example 1: AV configuration for device Perform the following steps to configure an AV for a device using the SM GUI: 1.Create a charging service (CS1) with data buckets - Bucket101 of 100 byte and Bucket102 of 200 bytes.
Use the ADDBUCKET option to add multiple buckets in the Charging Services entity.
2.Create a bundle (NokiaBundle) and link the charging service to it.
3.Create an Aggregate View (AV101) and attach the charging service to it, to aggregate the buckets.
4.Create an account (Acc1) to associate with a device.
5.Create a device (iPhone) and attach the aggregate view and subscription (NokiaBundle) to it.
The following figure shows the device overview which displays the bundles linked to the device: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1561Charging User Guide Common configuration (legacy GUI) The following figure shows the device overview which displays the aggregate view of the device: Here, the data buckets are consolidated in the aggregate view, that is, 100 + 200 = 300 bytes.
Example 2: Account overview of a device linked with AV The following figure shows the account overview of an iPhone device subscribed to a bundle and linked to an aggregate view.
Example 3: Group overview of a group linked with AV The following figure shows the group overview of a group subscribed to a bundle and linked to an aggregate view.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1562Charging User Guide Common configuration (legacy GUI) 6.4 Units Mapping The unit type defines the type of unit such as time, volume, money, and unit.
All the entities with units use the unit type entity to define the type of that unit.
For example, monetary bucket has a unit type as 'Money'.
The units and conversions entity allows you to define and convert units from one type to another.
You can define how a given type can be converted to any other type using this entity.
Configuration Log into the SM GUI, navigate to Common Configuration → CHARGING tab and select Units Mapping from the hamburger menu (☰).
To add a new unit, click to add basic details as described in the given table: Parameter Description Options Mandatory/ Optional Name This parameter indicates a unit name to measure charging factors, such as volume, time, unit, or money.String Mandatory Short Name This parameter indicates the short name of the unit used in the display of this unit type.
For example, MB, sec.String Mandatory Unit Type This parameter indicates the type of unit that the service operator selects from the predefined set of values.Select one from the predefined set of unit types: •TIME •VOLUME •MONEY •UNITMandatory Default This parameter indicates whether it is a base unit or not.
Select either of the values from the drop- down list: •true: indicates this is a base unit type •false: indicates this is not a base unit type.Mandatory Security Domain This parameter indicates the security domain associated with the unit type.Select the required security domain from the predefined security domains in the drop- down list.OptionalTable 157: Parameters for units mapping Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1563Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional Convert from This parameter indicates the value for conversion.
For example, 1 MB.BigDecimal Optional to This parameter indicates the converted value.
For example, 1048576 bytes.BigDecimal OptionalTable 157: Parameters for units mapping (continued) Actions associated with units mapping Action Description Create Used to create the units and conversions in database by providing the mandatory and optional parameters.
Read Used to display the units and conversions record per the data retrieved from database.
Update Used to update a particular units and conversions record in database.
Delete Used to delete a particular units and conversions record from database.Table 158: Actions associated with units mapping Note : These actions are valid for internal purposes only and cannot be accessed using the SM GUI.
6.5 LDAP External Server Configuration The LDAP external server configuration entity allows you to configure the external LDAP servers.
Configuration Log into the SM GUI, navigate to Common Configuration > CHARGING tab and select LDAP External Server configuration from the hamburger menu (☰).
To add a new LDAP external server, click to add basic details as described in the given table: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1564Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional Name Unique name to identify the LDAP server.
String Mandatory Type Type of LDAP server.
Following types are available: •SPR- LDAP •LDAP- INDEX- SERVEREnum Optional Administrative State The state of the LDAP server.
The LDAP server can be either in Enabled or Disabled state.Enum Optional Operation Type Indicates the type of operation done on LDAP server.
Following options are available: •Search and Modify : Retrieve and alter the content of entities.
•Search : Retrieve entries that match a given set of criteria.
•Modify : Alter the content of an entry in the directory.Enum Optional Primary IP Address Pool The list of primary IP addresses.
Digit Mandatory Secondary IP Address Pool The list of secondary IP addresses.
Digit Optional Port The port number of LDAP server.
Digit Mandatory Connection Timeout ( ms) Indicates the LDAP connection timeout period in the network in milliseconds.Digit Mandatory Keep Alive Time ( ms) Indicates the active time period in the network in milliseconds.Digit Optional Lookup Timeout ( ms) Indicates the timeout value for LDAP server lookup operation.Digit Mandatory Number of Connections Indicates the number of connections of LDAP server.
Digit Optional LDAP Version The version of LDAP server.
Digit Optional Search Scope Indicates the set of entries at or below the base DN that may match the search request.Digit OptionalTable 159: Parameters for LDAP external server Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1565Charging User Guide Common configuration (legacy GUI) Parameter Description Options Mandatory/ Optional Search DN Indicates the Distinguished Name of an LDAP entry.
Digit string Optional if type is LDAP- Index- Server, otherwise it is Mandatory Service Routing Label Indicates the hostnames routed to the service.
String Optional if type is LDAP- Index- Server, otherwise it is Mandatory Security Level Indicates the username and password details for the LDAP server.String Optional Security Domain This parameter indicates the security domain associated with the LDAP server.Select the required security domain from the predefined security domains in the drop- down list.Optional User DN Indicates the user Distinguished Name or Directory Name.String Optional Password Password of the LDAP server.
String Optional Description Description of the LDAP server.
String OptionalTable 159: Parameters for LDAP external server (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1566Charging User Guide Lifecycle manager 7Lifecycle manager This chapter describes lifecycle model, lifecycle objects, lifecycle management, and provides information on how to configure lifecycles in Nokia Converged Charging (NCC).
The lifecycle model is a fundamental component for provisioning and operational functions in NCC.
It provides a way to define and manage the behavior of entities within the Service and Subscriber models.
The lifecycle model allows to control the behavior of entities in a coherent and entity specific way, and track any changes or updates occurring in the system as well as how these changes are reflected in the experience of an end user.
Lifecycle management takes the complete succession of changes undergone by particular accounts, devices, users, groups or subscriptions and processes the behaviors for these entities to allow correct rating, charging, and processing of all types of usage.
7.
1Lifecycle definition Overview In general, a lifecycle is a state machine driven by required behaviors.
NCC supports the following two types of lifecycles: •ENTITY : The ENTITY lifecycle is driven by events that occur on entities.
•PERIOD : The PERIOD lifecycle is driven by the passage of time.
NCC allows a lifecycle to be associated with the following entities known also as lifecycle entities: •Accounts •Users •Groups •Devices •Subscriptions •Bucket •Counter All lifecycle entities, except bucket, and counter, must have an ENTITY lifecycle associated with them whereas the PERIOD lifecycle is available for accounts, subscriptions, buckets, and counters only.
The PERIOD lifecycle is mandatory for accounts, and optional for subscriptions.
Note : Bucket, and counter lifecycle entities have only PERIOD lifecycle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1567Charging User Guide Lifecycle manager A lifecycle entity cannot be associated to more than one lifecycle of each type.
Accounts and subscriptions can have one ENTITY and one PERIOD lifecycle associated with them.
Devices, groups and users can have only one ENTITY lifecycle associated with them.
The system allows you to configure custom ENTITY and PERIOD lifecycles for lifecycle entities.
The purpose of custom lifecycles is to allow you to specify states, events, transitions and actions in a configuration most suitable for your business needs.
You can create various ENTITY and various PERIOD lifecycles.
NCC can configure the bill cycle, and lifecycle at bundle components level (Buckets and Counters).
This requirement is to cover the ability to provision the lifecycle, and periodicity related configuration in the bucket and counter through REST /SOAP.
The lifecycle is defined by the following: •Name •Lifecycle type •Entity type •Set of states •Set of transitions •Period length (for PERIOD LIFECYCLES) Transitions and states are configured by on the basis of events and (or) timers that contain actions.
See section Lifecycle parameters on page 1578 for details.
The lifecycle model provides a way for an entity to transition between states, depending upon events occurring, and execute actions as needed.
There is no limit on the number of states, events or actions in a lifecycle.
However, it is expected that a lifecycle is configured with 3-10 states and 10-20 transitions between these states.
7.2 Subscription resources with different periodicity than subscription period NCC provides the capability for the bundle components (bucket and counter) to have a separate reset periodic cycle.
The lifecycle can be configured at the bundle components level.
Hence, the buckets and counters do not follow the periodic life cycle of the bundle and account.
•The lifecycle from the bucket and counter definition is copied to bucket and counter instances.
Lifecycle can be associated to a bucket or counter definition before a bucket or counter instance is created.
•Lifecycle support is provided on all types of buckets except the carry over bucket.
•Lifecycle support is provided on all the counters (Device, Group, Device_Group, Multi_bundle and Subscription).
•The billing information, which is available in both account and bundle, is also added on the counter and bucket definition, and can be configured through REST API.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1568Charging User Guide Lifecycle manager •The periodicity of the bucket and counter can be set as daily, weekly, monthly, or minutes.
Reset Resource Action is introduced to reset the bucket and counter resources as per their defined bill cycle.
The Send Notification action sends a notification upon successful reset of bucket and counter.
•ResetResourceSuccessEvent is triggered upon the successful execution of the Reset Resource Action .
•ResetResourceFailedEvent is triggered in the following cases: –When the Reset Resource Action is not executed successfully.
–When the ResetResourceSuccessEvent fails to reset a resource.
•The Reset Resource Action and ResetResourceSuccessEvent can fail due to the following reasons: –Subscription was barred.
–Device or group is in a barred or final state, and the ignoreBarredDeviceOrGroup is set to false •The following actions do not impact the bucket and counter resources which have a separate reset periodic cycle.
–ResetSubscription Action : This action resets only those subscription resources which do not have a lifecycle.
–RenewSubscriptionAction : This action resets only those subscription resources which do not have a lifecycle, or when triggered on account, they do not reset any device, group, device_group, or counters with a lifecycle.
–EmptySubscriptionAction : This action does not impact the buckets or counters with a lifecycle.
•Bucket and Counter entities are supported only on the PERIOD lifecycle.
Note : The ENTITY lifecycle is not allowed to be configured for bucket and counter.
•In case the bucket and counter are in a barred state as per their periodic lifecycle, the call request consumption is not possible from the respective bucket and counter, even if the subscription is in active state.
•In case the device or group is in a barred or final state, and you want to bar the bucket and counter reset as per their periodic lifecycle , then set the ignoreBarredDeviceOrGroup to false .
Note : The lifecycle, and periodicity related configuration is provisioned in the bucket and counter through REST APIs.
Additional information •The BundleOnUse (BOU) type of bundles can have the buckets and counters with a separate periodic lifecycle feature, provided the BOU bundles also have a periodic lifecycle.
•The future activation bundles can have resources (buckets and counters) with the separate periodic lifecycle feature, provided they have a bundle periodic lifecycle in a pre-active state (future activation).
•Step-Up buckets are reset as per the configured bucket periodic lifecycle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1569Charging User Guide Lifecycle manager •If subscription that is used for call processing has a lifecycle which is not in barred state, but the bucket or counter selected in that subscription has a lifecycle which is in barred stated, then that bucket or counter is not used from that subscription for call processing.
If this subscription has any other bucket or counter, it is used if valid.
If the bucket or counter is not valid, then an other subscription is picked, if applicable.
•The impending TEM entries on bucket or counter are triggered if they are pending when a call is executed on a device which has subscription containing these resources.
This currently works for subscription, device, group and account.
•The impending TEM entries on bucket or counter are triggered if they are pending when the provisioning call is executed on device, group or account.
Note : This feature does not addresses the requirement of modifying the start time for subscription, bucket or counter.
1.Use case 1: Non-Bill Cycle subscribers having a Daily BOU Bundle •The device is subscribed to a BundleOnUse (BOU) Bundle having the bill cycle as Daily.
The bundle periodic lifecyle (PLC) is applied as Daily.
The bundle has a subscription counter PLC of 15 minutes.
–Account and Subscription are created together on 12/06/2021 08:50 PM .
–BOU bundle activation date is 12/06/2021 at 09:08:00 PM .
–The bundle periodically renews every day, that is 13/06/2021 08:50 PM .
•Counter is created with bundle creation on 12/06/2021 09:08:00 PM .
–The Counter PLC is 15 minutes.
Hence, it is reset every 15 minutes, that is 12/06/2021 09:23:00 (considering that the BOU bundle is activated on 12/06/2021 09:08:00 PM ) •Notification is sent upon the bucket reset (Daily or Weekly).
•Lifecycle Reset EDR and notification EDR are also generated with the bucket reset details.
Configuration details: •BOU Bundle PLC: a. Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1570Charging User Guide Lifecycle manager b. c. d. e. Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1571Charging User Guide Lifecycle manager f. When the CallActivationEvent occurs, and the ChargeFeeAction is successfully executed to commit the BOU activation fee from the account, the Trigger Event Action is added.
When the Trigger Event Action is executed, it triggers the Resource Activate event on which the counter is listening to get activated.
g. h. Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1572Charging User Guide Lifecycle manager i. j. k. l. Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1573Charging User Guide Lifecycle manager m. n. •Counter Periodic Lifecycle: –During the Start state of the lifecycle, the StartCycleEvent is triggered.
–Reset Period Action is triggered upon the occurrence of StartCycleEvent .
The Reset Period Action calculates the Start Time and End Time for a period.
–The lifecycle transits again to the Start state upon successful execution of the Reset Period Action .
–When the lifecycle reaches the End Time, the RepeatCycleEvent is triggered.
–During the execution of RepeatCycleEvent , the Reset Resource Action is triggered.
The Reset Resource Action resets the counter to initial values.
–The lifecycle transits to the Start state.
–The successful execution of the Reset Resource Action triggers the ResetResourceSuccessEvent .
The Reset Period Action is triggered, and the Send Notification action sends a notification upon successful reset of the counter.
It is followed by the lifecycle transiting to the Start state.
–If the Reset Resource Action fails, then the ResetResourceFailedEvent is triggered on the lifecycle of the resource.
It is followed by the execution of Send Notification action.
–The lifecycle again transits to the Start state.
•BOU Activation Priority : ON_COMMIT Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1574Charging User Guide Lifecycle manager •Bundle Billing Info: •Charging Services : •Tariff: •Account billing info: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1575Charging User Guide Lifecycle manager •Device subscription details: •Account overview before calls execution: •Account Overview after call execution: •Account overview after counter reset: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1576Charging User Guide Lifecycle manager 2.Use case 2: Bill cycle subscribers •The device is subscribed to a bundle with a reset periodic lifecycle (PLC) as Monthly.
The bundle has two buckets with reset periodic lifecyle as Daily and Weekly.
•Bundle has a monthly bill cycle, and the subscription is purchased or activated along with the account.
–Account and Subscription are created on 16/06/2021 08:54:00 .
–The bundle periodically renews every month on 16/07/2021 00:00:00 .
•Buckets are created with bundle creation on 16/06/2021 08:54:00 .
–The Bucket 1 PLC is Daily, Hence it resets daily, that is on 17/06/2021 00:00:00 –The Bucket 2 PLC is Weekly.
Hence it is reset weekly, that is on 23/06/2021 00:00:00 .
•Notification is sent upon the bucket reset (Daily or Weekly).
•Lifecycle Reset EDR and notification EDR are also generated with the bucket reset details.
Configuration details: a.Bucket Periodic Lifecycle •During the Start state of the lifecycle, the StartCycleEvent is triggered.
•Reset Period Action is triggered upon the occurrence of StartCycleEvent .
The Reset Period Action calculates the Start Time and End Time for a period.
•The lifecycle transits again to the Start state upon successful execution of the Reset Period Action .
•When the lifecycle reaches the End Time, the RepeatCycleEvent is triggered.
•During the execution of RepeatCycleEvent , the Reset Resource Action is triggered.
The Reset Resource Action resets the bucket to initial values.
•The lifecycle transits to the Start state.
•The successful execution of the Reset Resource Action triggers the ResetResourceSuccessEvent .
The Reset Period Action is triggered, and the Send Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1577Charging User Guide Lifecycle manager Notification action sends a notification upon successful reset of the bucket.
It is followed by the lifecycle transiting to the Start state.
•If the Reset Resource Action fails, then the ResetResourceFailedEvent is triggered on the lifecycle of the resource.
It is followed by the execution of Send Notification action.
•The lifecycle again transits to the Start state.
3.Use case 3: Non-bill cycle subscribers •The device is subscribed to a bundle with a reset periodic lifecycle (PLC) as Monthly, bucket PCL as 24 hours, and counter reset PLC as Weekly.
•Bundle has the monthly bill cycle as exact.
That is, the subscription is purchased or activated along with the account.
–Account and Subscription are created together on 16/06/2021 12:22:30 .
–The bundle periodically renews on 16/07/2021 00:00:00 .
•Bucket is created with bundle creation on 16/06/2021 12:22:30 .
–The bucket PLC is 24 Hours.
Hence it is reset on 17/06/2021 12:22:30 .
–Notification is sent upon the bucket reset.
•Counter is created with bundle creation on 16/06/2021 12:22:30 .
–The counter PLC is weekly.
Hence the counter is reset every Week, that is on 23/06/2021 12:22:30 .
–Notification is sent upon the counter reset.
•Lifecycle Reset EDR and notification EDR are also generated with the bucket reset details.
4.Use case 4: Non-Bill Cycle subscribers Future Activation Bundle •The device is subscribed to a bundle which is going to be activated in the future.
It has a Weekly periodic lifecycle (PLC).
The bundle has a bucket with a 2 hour PLC.
•The bundle has weekly bill cycle.
–Account and Subscription are created on 15/06/2021 10:15:02 .
–Bundle is activated in future, that is on 27/06/2021 12:22:17 .
–The bundle periodically renews weekly, that is on 22/06/2021 00:00:00 .
•Bucket is created with bundle creation on 15/06/2021 10:15:02 .
–The bucket PLC is 2 Hours.
Hence it resets every 2 hours, that is 16/06/2021 12:24:35 (considering that the bundle is activated on 15/06/2021 10:24:35 ) •Notification is sent upon the bucket reset (Daily or Weekly).
•Lifecycle Reset EDR and notification EDR are also generated with the bucket reset details.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1578Charging User Guide Lifecycle manager 7.3 Lifecycle parameters Overview This section describes the following lifecycle parameters and provides information on how to use and configure these parameters: •ENTITY lifecycle parameters •PERIOD lifecycle parameters •State parameters •Barring flag •Transition parameters •Action parameters •Timer parameters Note : Once a lifecycle is created and distributed to ME, it cannot be deleted.
ENTITY lifecycle parameters Note : Any update to a lifecycle requires up to 30 seconds to take effect.
Parameter Description Options Mandatory / Optional Name This parameter indicates the name of a lifecycle.User- defined string up to 64 charactersMandatory Type This parameter indicates the identifier for a lifecycle type.Must be set to ENTITY, that is, Object Status LifecycleMandatory Applicable to This parameter indicates the type of the entity to which a lifecycle belongs.One of the following: •Account •Device •Group •User •SubscriptionMandatory States This parameter indicates a set of states.State parameters are described in Parameter details on page 1581 .MandatoryTable 160: Parameter details Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1579Charging User Guide Lifecycle manager Parameter Description Options Mandatory / Optional States must contain at least one state.
States must contain exactly one state marked as initial.
transitions This parameter indicates a set of transitions.
Transitions are configured by you based on your business requirements.Transition parameters are described in Parameter details on page 1583 .OptionalTable 160: Parameter details (continued) PERIOD lifecycle parameters Note : Any update to a lifecycle requires up to 30 seconds to take effect.
Parameter Description Options Mandatory / Optional Name This parameter indicates the name of a lifecycle.User- defined string up to 64 charactersMandatory Type This parameter indicates the identifier for a lifecycle type.Must be set to PERIOD, that is, Bill CycleMandatory Applicable to This parameter indicates the type of entity to which a lifecycle belongs.One of the following: •Account •SubscriptionMandatory period Length This parameter indicates the length of a PERIOD lifecycle.Consists of: •time Unit •units time Unit This parameter indicates the unit of time.Specifies the following time units: •SECONDS •MINUTES •HOURS •DAYS •WEEKS •MONTHSMandatoryTable 161: Parameter details Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1580Charging User Guide Lifecycle manager Parameter Description Options Mandatory / Optional •YEARS units This parameter indicates the value for time units.Integer states This parameter indicates a set of states.
States must contain at least one state.
States must contain exactly one state marked as initial.State parameters are described in Parameter details on page 1581 .Mandatory transitions This parameter indicates a set of transitions.
Transitions are configured by you based on your business requirements.Transition parameters are described in Parameter details on page 1583 .OptionalTable 161: Parameter details (continued) State parameters The given table lists and describes the parameters for a state instance.
Parameter Description Option Mandatory / Optional name This parameter indicates the state name that must be unique within a lifecycle of a given type.
For example, the account XYZ has a state called Reserved in its ENTITY lifecycle and PERIOD lifecycles, but in each of these lifecycles there must be only one reserved state.String up to of 64 characters Mandatory initial This parameter indicates a lifecycle must have a state marked initial.
There must be exactly one initial state in a lifecycle.Boolean, defaults to false Mandatory barring This parameter indicates an entity is barred.
Behavior depends on the entity.Boolean, defaults to false MandatoryTable 162: Parameter details Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1581Charging User Guide Lifecycle manager Parameter Description Option Mandatory / Optional For more information, see the Barring flag on page 1582 section.
final This parameter indicates the flag used for ‘ retiring’ entities with the intention of deleting these entities in the future.
Once a state is created and the final flag is set, the final flag cannot be changed.
if a state is marked as non- final, it stays non- final.
If a state is marked as final, it stays final.
A lifecycle can have only one state marked final.
A state marked as final must also be marked as barring.
Having the final state in a lifecycle is optional.
The final state cannot be Start State.
An entity cannot transition out of the final state.Boolean, defaults to false MandatoryTable 162: Parameter details (continued) A state is configured in accordance with the following: •An entity can be present in one state of a given lifecycle at a time.
For example, an account XYZ can be in Active state in its ENTITY lifecycle and in Start state in its PERIOD lifecycle.
•A state is allowed to have at most two timed transitions if and only if one of them is an entry transition.
This implies that only one entry transition is allowed for a state.
An entry transition is a looping transition that starts and ends in the same state with a timer less or equal to zero.
•There is no limit on a number of non-timed transitions for a state.
•Once created and distributed to ME, a state cannot be deleted.
Barring flag Barring behavior depends on the entity.
Each individual domain knows how to behave in case the barring flag is set to true.
See Lifecycle state examination on page 1646 for more details.
Transition parameters The given table lists and describes the parameters for a transition instance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1582Charging User Guide Lifecycle manager Parameter Description Option Mandatory / Optional name This parameter indicates the name of a transition.
Must be unique within a lifecycle.
Allows you to define a transition based on a particular event.
If you choose to configure a transition triggered by a built- in event, the name of this transition must match the name of that built- in event.String up to 64 characters Mandatory start State This parameter indicates the state that a transition starts from.Mandatory endState This parameter indicates the state that a transition ends at.Mandatory actions This parameter indicates the sequence of actions executed when entity transitions from start State to end State.
Actions are invariably built- in elements.Actions can be repetitive.
Action parameters are described in Parameter details on page 1585 .Optional timer This parameter indicates the time that an entity persists in start State before transitioning to the next state.
Allows you to schedule time before a transition is executed.
Allows to calculate timers for time- based scenarios such as notifications or expirations.Timer parameters are described in Parameter details on page 1585 .Optional conditions This parameter represents the sequence of applicability conditions for a transition to complete.
If any of the conditions evaluate to false, the execution of the action is bypassed.This parameter consists of attribute- value pair with an operator, defining the condition.
For details, see Events associated with lifecycles on page 1601 .OptionalTable 163: Parameter details A transition is configured in accordance with the following: •Once created, a transition cannot be deleted.
•The final state cannot be Start State.
A transition cannot be configured from the state marked final.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1583Charging User Guide Lifecycle manager •To delete a subscription, move the subscription state to Final state and ensure that the timer value must be set to a minimum of 1 second.
0 second is not a valid input in this scenario.
Use the action DeleteEntity to delete the entity once the duration specified by the timer passes.
•Parameters Start State and End State must belong to the same lifecycle.
•Two transitions leaving from the same state must have different events.
•A transition is called looping if its Start State is the same as its End State.
A looping transition with a timer greater than zero should be executed for each interval defined in the timer.
This feature is useful in a billing cycle where for example, you might want to send a notification every month that it is time to pay the bill.
•A looping transition with a timer less or equal to zero is called an entry transition.
An entry transition has higher priority than other timed transitions.
An entry transition executes immediately and only once.
•A transition may have at most one timer greater than zero.
•Two timed transitions are allowed in one state if and only if one of them is an entry transition.
This implies that only one entry transition is allowed for a state.
•When calculating a relative timer for a transition, note that this timer can refer to End Time and Start Time only if this transition is configured for a PERIOD lifecycle.
The use of End Time and Start Time is limited to PERIOD lifecycles only.
You should not use End Time and Start Time to calculate timers used in ENTITY lifecycles.
•When adding more than one action to a transition, Nokia recommends adding at most one action that generates a success or failure event.
For example, if you have Add Subscription Action configured in a transition, you can add Send Notification Action to the same transition since the latter does not generate any success or failure events but the former does.
Nokia does not recommend to have in the same transition two or more actions that generate a success or failure event for example, two Add Subscription Actions configured in the same transition.
Transitions in SM GUI Transitions are represented in the SM GUI through states.
To configure a transition, you select a state.
Under this state, the transition parameters are presented as follows: •The selected state is Start State.
•Event is for a transition name.
•Upon is for an event that triggers a transition.
•Go to is for End State.
Action parameters The given table lists and describes the parameters for an action instance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1584Charging User Guide Lifecycle manager Parameter Description Option Mandatory / Optional action Name This parameter indicates the name of an action.
Predefined by the system.
default Values This parameter indicates the attribute- value pair that consists of: •parameter Name: This parameter indicates the name of the parameter on which the action is executed.
This is a string value.
•value: This parameter indicates the value assigned to parameter Name.
This is a string value.An action can have more than one default Values.Optional Rule This parameter provides the rule for the lifecycle entity and contains the rules and conditions in a defined format.
Note : The Rules box becomes visible only when the user selects the action as Send Notification .
For any other action, this box is not available.OptionalTable 164: Parameter details Timer parameters The following table lists and describes parameters for a timer instance.
Parameter Description Option Mandatory / Optional time Unit This parameter indicates the unit of time.Must be specified if units are specified Specifies the following: •SECONDS •MINUTES •HOURSMandatory if base Date Field is not provided Optional if base Date Field is providedTable 165: Parameter details Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1585Charging User Guide Lifecycle manager Parameter Description Option Mandatory / Optional •DAYS •WEEKS •MONTHS •YEARS units This parameter indicates the value of time units.Integer Must be specified if time Unit is specified base Date Field This parameter allows you to calculate timers for scheduled tasks in the future relative to a specific date parameter of an entity.
If you choose not to specify base Date Field, then time Unit and units parameters are used to calculate a timer relative to now.
This parameter must be based on a date- related parameter of an entity whose lifecycle the timer belongs to.
The referred parameter must also be of type long.
If the value of the specified date- related parameter is null ( not initialized) , when attempting to arm the timer, the timer is not armed.
If you specify base Date Field, then the timer is calculated according to the following formula: •S{base Date Field} + offset( units, time Unit) If you do not specify base Date Field, then the timer is calculated according to the following formula: •NOW( ) + offset( units, time Unit) If the timer happens to be in the past, it executes immediately.
For example, you would like to create a timer for sending notifications one day prior to the end of a billing cycle.
Since anString Mandatory if time Unit and units are not provided Optional if time Units and units are providedTable 165: Parameter details (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1586Charging User Guide Lifecycle manager Parameter Description Option Mandatory / Optional account is a periodic entity, its endTime parameter is the most appropriate for base Date Field in this case.
Then the timer is calculated as follows: •endTime - 1 DAY where base Date Field= end Time, units= -1, time Units= DAYS If you choose to send a notification one day after the start of a billing cycle, then the timer is calculated as follows: •start Time + 1 DAY where base Date Field= start Time, units= 1, time Units= DAYS Note that end Time and start Time are intended for use in PERIOD lifecycles only.
You should not use endTime and start Time in ENTITY lifecycles.
tolerance This parameter indicates a tolerant delay of a scheduled transition in seconds.
This feature allows you to process transitions in the scheduler with a random delay.
This feature allows you to avoid peaks in processing transitions that occur at the same moment.
For example, a number of subscriptions expire at the end of a month or any other period ( week, day, hour) simultaneously.
This feature is used as follows: •If you specify tolerance to be 5 seconds, the delay interval is set from 0 to 4 seconds.
This implies that the actual delay can be 0, 1,2,3 or 4 seconds, depending on the random selection by the system.Long positive Defaults to zeroOptionalTable 165: Parameter details (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1587Charging User Guide Lifecycle manager Parameter Description Option Mandatory / Optional If you specify tolerance for a transition with actions, then all these actions are going to be delayed for the same time.
This feature cannot be used in timers whose base Date Field is null and units are not greater than zero.Table 165: Parameter details (continued) A timer is configured in accordance with the following: •The timer is based on the time zone of the server.
The time zone of an entity (for example, account) is not respected.
•For the spring forward transition, there is a gap of missing time when the occurrence might not exist.
For example, in US Eastern Time, a daily timer expected to be executed at 2:30 A.M. does not exist on March 12th, 2017.
In this case, the timer should be advanced by the saving amount (in this case, 1 hour), so the timer should be executed at 3:30 A.M. on that day.
For the fall back transition, there is an overlap of duplicated time when the occurrence might exist twice.
For example, in US Eastern Time, a timer expected to be executed at 1:30 A.M. has two possible times it could run at on November 5, 2017.
In this case, the timer should be executed at the first occurrence of 1:30 A.M. and skip the next occurrence of 1:30 A.M. of the same date.
•A timer with a value of one day does not necessarily mean 24 hours.
It means tomorrow, at the same time, even when there is a time change on that same day for example, Daylight Savings Time.
The same logic applies to weeks, months, and years.
•If a timer is supposed to go off on a day that does not exist in a month, it is scheduled for the last day of the month.
For example, a one month timer set on January 31 goes off on February 28 if the year is not a leap year and on February 29 if the year is a leap year.
The same rule applies to years.
For example, if on February 29 you set a one year timer, it goes off on February 28 the following year.
•A timer of 1.5 days should be configured as 36 hours or 2160 minutes or 129600 seconds.
•A timer is called armed when the actions associated with a transition are scheduled for execution.
A timer is armed when an entity transitions to a state containing a timer.
This can occur when a transition is triggered or when an entity is created in a specific state.
A timer is called armed when actions are scheduled for execution.
•A timer that evaluates to the past executes immediately.
•When calculating a relative timer for a transition, note that this timer can refer to End Time and Start Time only if this transition is configured for a PERIOD lifecycle.
The use of End Time and Start Time is limited to PERIOD lifecycles only.
You should not use End Time and Start Time to calculate timers used in ENTITY lifecycles.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1588Charging User Guide Lifecycle manager •A timer can also consider the account billing related information or bundle billing related information (dayOfMonth, dayOfWeek, hourOfDay) for Entity and Period lifecycle for the configurations mentioned in the Timer on page 1645 table.
Timer is recalculated based on the account billing related information or bundle billing related information and the previously calculated timer.
•A timer can be cancelled when an entity leaves the current state.
The entity can leave the current state when a transition is triggered or when this entity is updated and because of this update the entity leaves the current state.
A timer should not be cancelled if the entity is updated but the state of the entity stays the same.
The following example describes two scenarios of how a timer can be cancelled.
In both scenarios, the entity resides in the current state CS with three transitions coming out of that state.
In the first scenario, the transitions A, B and C are defined as follows: •A starts and ends in CS, and has no timer.
•B starts in CS and ends in S1, and has no timer.
•C starts in CS and ends in S2, and has a timer greater than zero that behaves as follows: –If B is triggered, the timer is cancelled since the entity changes its state from CS to S1 (as defined by transition B).
–If A is triggered, the timer is cancelled and rearmed since the entity stays in its current state CS (as defined by transition A).
Figure 69: Timer cancelled (scenario 1) In the second scenario, the transitions A, B, and C are defined as follows: •B starts and ends in CS, and has no timer.
•C starts in CS and ends in S1, and has no timer.
•A starts and ends in CS, and has a timer greater than zero that behaves as follows: –If C is triggered, the timer is cancelled since the entity changes its state from CS to S1 (as defined by transition C).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1589Charging User Guide Lifecycle manager –If B is triggered, the timer is cancelled and rearmed since the entity does not change its state (as defined by transition B).
–If A is triggered, the timer is rearmed since the entity does not change its state (as defined by transition A).
Figure 70: Timer cancelled (scenario 2) 7.4 Default lifecycles Overview The system provides default ENTITY and PERIOD lifecycles.
The default ENTITY lifecycle is provided for all lifecycle entities - devices, users, accounts, groups, and subscriptions.
The given list shows the default ENTITY lifecycles provided by the NCC system: •DefaultSubscriptionLifeCycle •DefaultGroupLifeCycle •DefaultUserLifeCycle •DefaultDeviceLifeCycle •DefaultAccountLifeCycle It is mandatory for a lifecycle entity to have an ENTITY lifecycle associated with it.
If a lifecycle entity is configured without a reference to an ENTITY lifecycle, the default ENTITY lifecycle is associated with that entity.
The system provides only two default PERIOD lifecycles as follows: •DefaultAccountBillingCycle Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1590Charging User Guide Lifecycle manager •DefaultSubscriptionBillingCycle If you do not assign a PERIOD lifecycle to an account or subscription, the system assigns the default PERIOD lifecycle.
Note that the system assigns the default PERIOD lifecycle to a subscription only if the bundle, the subscription refers to, defines the billing cycle information.
The default lifecycles provide basic working functionality and can be used as a basis for custom lifecycles.
You can expand the set of states and the set of transitions in the default lifecycles.
You can add new states to the set of states and configure new transitions and add them to the set of transitions.
However, once a state or a transition is added, it cannot be removed.
The default lifecycles cannot be deleted or renamed.
Configuration of the default lifecycles This section provides information on the configuration of the default lifecycles.
Parameter Configuration Name Default Account LifeCycle Type Object Status Lifecycle Applicable to Account States The set contains the following: •Active •Inactive •Removed For more information, see States configured for default lifecycles on page 1601 .
Transitions The set contains the following: •Deactivate •Activate •Entity Removed Event •Delete •Start CycleTable 166: DefaultAccountLifeCycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1591Charging User Guide Lifecycle manager Parameter Configuration For more information, see Transitions configured for default lifecycles on page 1598 .Table 166: DefaultAccountLifeCycle configuration (continued) Figure 71: DefaultAccountLifeCycle Parameter Configuration name Default Account Billing Cycle Type Bill Cycle Applicable to Account States The set contains the following: •Start For more information, see States configured for default lifecycles on page 1601 .
Transitions The set contains the following: •Start Cycle EventTable 167: DefaultAccountBillingCycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1592Charging User Guide Lifecycle manager Parameter Configuration •Repeat Cycle For more information, see Transitions configured for default lifecycles on page 1598 .Table 167: DefaultAccountBillingCycle configuration (continued) Figure 72: DefaultAccountBillingCycle Parameter Configuration Name Default Subscription LifeCycle Type Object Status Lifecycle Applicable to Subscription States The set contains the following: •Active •Inactive •Removed For more information, see States configured for default lifecycles on page 1601 .Table 168: DefaultSubscriptionLifeCycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1593Charging User Guide Lifecycle manager Parameter Configuration Transitions The set contains the following: •Deactivate •Activate •Entity Removed Event •Delete For more information, see Transitions configured for default lifecycles on page 1598 .Table 168: DefaultSubscriptionLifeCycle configuration (continued) Parameter Configuration Name Default Subscription Billing Cycle Type Bill cycle Applicable To Subscription States The set contains state - Start.
For more information, see States configured for default lifecycles on page 1601 Transitions The set contains the following events: •Start Cycle Event •Repeat Cycle For more information, see Transitions configured for default lifecycles on page 1598Table 169: DefaultSubscriptionBillingCycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1594Charging User Guide Lifecycle manager Figure 73: DefaultSubscriptionBillingCycle Parameter Configuration Name Default Group LifeCycle Type Object Status Lifecycle Applicable to Group States The set contains the following: •Active •Inactive •Removed For more information, see States configured for default lifecycles on page 1601 .
Transitions The set contains the following: •Deactivate •Activate •Entity Removed Event •DeleteTable 170: DefaultGroupLifeCycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1595Charging User Guide Lifecycle manager Parameter Configuration For more information, see Transitions configured for default lifecycles on page 1598 .Table 170: DefaultGroupLifeCycle configuration (continued) Parameter Configuration Name Default User LifeCycle Type Object Status Lifecycle Applicable To User States The set contains the following: •Active •Inactive •Removed For more information, see States configured for default lifecycles on page 1601 .
Transitions The set contains the following: •Deactivate •Activate •Entity Removed Event •Delete For more information, see Transitions configured for default lifecycles on page 1598 .Table 171: DefaultUserLifeCycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1596Charging User Guide Lifecycle manager Figure 74: DefaultUserLifeCycle, DefaultSubscriptionLifeCycle and DefaultGroupLifeCycle Parameter Configuration Name Default Device LifeCycle Type Object Status Lifecycle Applicable to Device States The set contains the following: •Active •Inactive For more information, see States configured for default lifecycles on page 1601 .
Transitions The set contains the following: •Deactivate •Activate For more information, see Transitions configured for default lifecycles on page 1598 .Table 172: DefaultDeviceLifeCycle configuration The following figure shows the default ENTITY lifecycle for devices.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1597Charging User Guide Lifecycle manager Figure 75: DefaultDeviceLifeCycle Configuration of states and transitions in default lifecycles The default lifecycles have a set of configured transitions.
The configuration of these transitions is described in the following table.
name ( Event) Description start State endState actions timer Activate This transition is triggered by the event named Activate.
The purpose of this transition is to move a lifecycle entity from Inactive state to Active state.Inactive Active Deactivate This transition is triggered by the event named Deactivate.
The purpose of this transition is to move a lifecycle entity from Active state to Inactive state.Active InactiveNo action No timerTable 173: Transitions configured for default lifecycles Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1598Charging User Guide Lifecycle manager name ( Event) Description start State endState actions timer Entity Removed EventThis transition is triggered by the event named Entity Removed Event.
The purpose of this transition is to move a lifecycle entity from Inactive state to Removed state.Inactive Removed Delete This transition is triggered by a timer.
Delete transition can also be triggered manually, by the event named Delete.
The purpose of this transition is to delete a lifecycle entity.Removed Removed Delete Entity timer = 24 HOURS Start Cycle This transition is triggered by the event named Start Cycle.
The purpose of this transition is to trigger Start Cycle Event in the ENTITY lifecycle of an entity to initiate the PERIODActive Active Trigger Event Actiontimer = 0 SECONDSTable 173: Transitions configured for default lifecycles (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1599Charging User Guide Lifecycle manager name ( Event) Description start State endState actions timer lifecycle of the same entity.
Start Cycle can be applied only to accounts and subscriptions.
Start Cycle transition is used in Default Account Life Cycle to initiate Default Account Billing Cycle.
Start Cycle transition is used in Default Subscription LifeCycle to initiate Default Subscription Billing Cycle.
Start Cycle is an entry transition.
It executes immediately and only once.
Start Cycle has higher priority over the transitions with a timer greater than zero.
Start Cycle Event This transition is triggered by the event named Start Cycle Event.
The purpose of this transition is to initiate theStart Start Reset Period ActionNo timerTable 173: Transitions configured for default lifecycles (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1600Charging User Guide Lifecycle manager name ( Event) Description start State endState actions timer first cycle in a PERIOD lifecycle.
Repeat Cycle This transition is triggered by the event named Repeat Cycle.
The purpose of this transition is to initiate a subsequent cycle in a PERIOD lifecycle.Start Start Reset Period Actionbase Date Field of the timer is set to end Time of the account base Date Field = endTimeTable 173: Transitions configured for default lifecycles (continued) The default lifecycles have a set of configured states.
The configuration of these states is described in the following table.
name initial barring final Active true false false Inactive false true false Removed false true true Start true false falseTable 174: States configured for default lifecycles Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1601Charging User Guide Lifecycle manager 7.5 Events associated with lifecycles Event definition An event signifies that something happens on an entity.
An event may signify a success or a failure.
As a result of an event, an entity may or may not transition from one state to another.
Events provide an option for you to configure transitions and all the actions that you choose to associate with these transitions.
For example, when a call comes in, the system analyzes the call and launches a Device Attachment Event for the calling device.
If Device Attachment Event is configured in the device lifecycle as a transition, the event is handled and the transition is executed as defined by you.
The lifecycle framework has built-in and user-defined.
The user-defined events are also known as custom events.
The built-in events are defined in the system and related to the following common scenarios: •Attaching a device •Charging a fee •Adding a subscription •Renewing a subscription •Resetting a subscription •Deleting a subscription •Starting a PERIOD lifecycle •Cancelling a PERIOD lifecycle •Deleting a lifecycle entity The built-in events allow you to configure transitions for the above common scenarios.
If you choose to configure a transition based on a built-in event, the name of that transition must match the name of the corresponding built-in event.
For example, if you choose to configure a transition based on Device Attachment Event, the name of that transition must be Device Attachment Event.
In such cases, event names serve as transition names.
The transition based on built-in events are controlled by certain conditions.
If these conditions are configured and evaluate to true, only then the transition is executed, else it is bypassed.
A custom event is created when you specify an event for a transition and give this event a name that does not match any of the built-in events.
For the transitions based on custom events, conditions parameter configuration is irrelevant.
The events associated with a lifecycle can be triggered by and using the following: •predefined trigger point in the system (built-in) •lifecycle web service ‘trigger’ operation (built-in and custom) •lifecycle action with predefined success and failure events (built-in) •Trigger Event Action (built-in and custom) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1602Charging User Guide Lifecycle manager •timers (built-in and custom) Most of built-in events are triggered by lifecycle actions.
For example, Charge Fee Action triggers Charge Fee Action Success Event or Charge Fee Action Failure Event, depending on the result of its execution.
Some built-in events are triggered when something occurs in the system.
For example, Device Attachment Event is triggered by the call control module when a device attaches successfully.
Custom events are commonly used in transitions with timers.
When a timer executes, the transition is triggered.
An example of a timed transition is the looping transition with event Delete and a timer set to 24 hours defined in the majority of ENTITY default lifecycles.
Lifecycle built-in events Certain built-in events consist of Accept Broadcast Message as one of the input parameters.
This input parameter defines the condition for execution of the transition.
If sender and destination entities are different and flag is configured, only then the transition is executed.
However, if the sender and destination entities are same, then this condition check is bypassed and the transition is always executed.
The following table lists and describes the built-in events associated with lifecycles.
Note that the parameters in the bold font are visible on SM GUI and others are internal to the logic.
Operators cannot configure these internal parameters for corresponding events.
When these events are generated internally by linked actions, the lifecycle logic sets and passes these parameters to the events.
Event name Description Parameters Account Commit Success EventThis event is generated when the BOU activation fee reserved from Account is successfully committed.Accept Broadcast Message (Default: false) Account Recharged Event This event is generated when an account is credited.
Account credit can occur in the following ways: •Adjusting account balance with a positive value.
•Setting the account balance to a value greater than current account balance •If the account balance is reset to a value greater than the current value Note : This event is applicable for Account and Subscription lifecycles only.Accept Broadcast Message (Default: false) Balance Adjustment Event This event is generated when an account is credited.
Account credit can occur in the following ways: •Adjusting account balance with a positive value.Accept Broadcast Message (Default: false)Table 175: Lifecycle built-in events Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1603Charging User Guide Lifecycle manager Event name Description Parameters •Setting the account balance to a value greater than current account balance.
•If the account balance is reset to a value greater than the current value.
This event is similar to Account Recharged Event .
The only difference is that Balance Adjustment Event does not trigger any lifecycle date changes.
For a balance update, operator can define different actions for account recharge and different actions for balance adjustments ( for example, through CRM) .
Do not trigger lifecycle so that dates are not changed as part of lifecycle configuration.
If user has configured the lifecycle to reset the period, the period and dates are reset.
If the new balance is less than the old balance, then dates are not reset for Set Account Balance and Adjust Account Balance.
For this scenario, no event is triggered even if configured.
In adjustbalance REST API, the parameter source can be configured to indicate if adjustment from CRM requests is needed: •0 (default) - recharge •1 - adjustment is made via CRM Lifecycle can be configured to handle the values; that is, when 0 ( default) is received lifecycle date is modified accordingly and when 1 is received lifecycle date is not modified.
Account Reservation Failure EventThis event is generated when reservation of BOU activation fee from Account fails mainly due to insufficient balance in Account to pay for BOU activation fee.Accept Broadcast Message (Default: false) Account Reservation Success EventThis event is generated when the BOU activation fee is successfully reserved from Account.Accept Broadcast Message (Default: false)Table 175: Lifecycle built-in events (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1604Charging User Guide Lifecycle manager Event name Description Parameters Activate Queued Subs EventThis event must be configured in the subscription lifecycle and it moves the subscription to Active state.- Add Subscription Action Failure EventThis event is generated by Add Subscription Action to signal failure.
This event is only sent to the lifecycle that executed Add Subscription Action .Contains parameters: •Bundle ID •Fee Override ( if any) •Reason for rejection (for example, not enough funds or account barred or Device or Group Barred/ Final) Add Subscription Action Success EventThis event is generated by Add Subscription Action to signal success.
This event is only sent to the lifecycle that executed Add Subscription Action .Contains parameters: •Subscription ID •Bundle ID •Fee Override ( if any) Add Subscription Limit Reached EventThis event occurs when a subscription creation fails due to the maximum limit of the same bundle defined at bundle level or global level is reached.
This lifecycle event is triggered to the device or group to which the subscription should be associated.Contains parameters: •Max Bundle Instances Limit •Bundle ID Cancel Period Event The event to cancel a PERIOD lifecycle.
No parameters Charge Fee Action Failure EventThis event occurs when an account does not have enough funds to deduct the fee specified for Charge Fee Action .
This event might trigger shifting back to the previous state or sending a notification.Accept Broadcast Message (Default: false) Charge Fee Action Success EventThis event occurs when Charge Fee Action successfully deducts the specified fee from an account.Accept Broadcast Message (Default: false)Table 175: Lifecycle built-in events (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1605Charging User Guide Lifecycle manager Event name Description Parameters Delete Expired Entity Success EventThis event occurs when action Delete Expired Entity Action successfully deletes the expired entities.Accept Broadcast Message (Default: false) Device Attachment Event This event occurs when NCC receives a CCR- I, CCR- E, or SLR- Initial request for a device.No parameters Device Frozen Event This event is generated by the Freeze Device Action from device lifecycle.
It can be received only by the subscription lifecycles ( Entity and Period) .No parameters Device Unfrozen Event This event is generated by the Unfreeze Device Action from device lifecycle.
It can be received only by the subscription lifecycles ( Entity and Period) .No parameters Entity Removed Event The event to indicate that an entity has moved to the final state.No parameters Max Renewals Reached EventThis event is generated by the Renew Subscription Action to indicate that a subscription has reached its maximum number of renewals.
This event contains the ID of that subscription.Contains parameters: •Bundle ID •Accept Broadcast Message (Default: false) Mandatory Subscription Suspended EventThis event is generated at the time of subscription creation when there is another mandatory subscription present in barred state, provided the account balance is sufficient for bundle fee deduction.
This is available only in subscription lifecycle.Accept Broadcast Message (Default: false) Not Enough Funds With Mandatory Active EventThis event is generated at the time of subscription creation when the account balance is insufficient for fee deduction, and at least one mandatory subscription is present in unbarred state.
This is available only in subscription lifecycle.Accept Broadcast Message (Default: false)Table 175: Lifecycle built-in events (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1606Charging User Guide Lifecycle manager Event name Description Parameters Not Enough Funds Event This event is generated by the Renew Subscription Action when subscription renewal fails because of insufficient funds in a prepaid account.Contains parameters: •List of Bundle IDs •Accept Broadcast Message (Default: false) PLC Version Change Event This periodic lifecycle event consists of Renew Subscription Action followed by Reset Period Action combined with any additional actions.
The PLC can be configured on new bundle version and executed on next BCR.Timer (Default: false) Goto State (Default: false) Reset Account Action Failure EventThis event is generated when an account reset fails due to overage limit greater than reset value.Accept Broadcast Message (Default: false) Reset Account Action Success EventThis event occurs when an account is successfully reset.
Accept Broadcast Message (Default: false) Reset Resource Success EventThis event occurs when the Reset Resource action is successfully executed.No parameters Reset Resource Failed Event This event occurs in the following cases: •When the Reset Resource action is not executed successfully.
•When the Reset Resource Success Event fails to reset a resource.
The Reset Resource Success Event and Reset Resource action can fail due to the following reasons: •Subscription was barred.
•Device or group is in a barred or final state, and the ignoreBarredDeviceOrGroup is set to falseNo parameters Start Cycle Event The event to start a PERIOD lifecycle.
No parametersTable 175: Lifecycle built-in events (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1607Charging User Guide Lifecycle manager Event name Description Parameters Subscription Added Event This event occurs as a result of the following: •A new subscription is added using service manager.
•Add Subscription Action executes in a subscription lifecycle.
•Add Subscription Action executes in an account lifecycle.
Depending on the origin of Subscription Added Event , this event occurs as follows: •When a new subscription is added through Service Manager, this event is sent to the account entity lifecycle, devices and groups linked to the new subscription.
This is also triggered in subscription entity and periodic lifecycles when application preference Controlled Renewal Sequence is set to VIA_ ACCOUNT.
•When Add Subscription Action executes in a subscription lifecycle, this event is sent to the account Entity Lifecycle, devices and groups linked to the new subscription.
•When Add Subscription Action executes in an account lifecycle, this event is sent to the devices and groups linked to the new subscription.Contains parameters: •Subscription ID •Bundle ID •Fee Override Subscription Deleted Event This event is generated by the Delete Entity Action in case of Subscription Entity only to the linked account.
It indicates that this particular subscription has been deleted successfully.Contains parameters: •Bundle ID •Subscription Instance Subscription Empty Event This event is generated by the Empty Subscription Action to indicate that the subscription has been successfully emptied.Contains parameters: •Bundle ID •Accept Broadcast Message (Default: false)Table 175: Lifecycle built-in events (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1608Charging User Guide Lifecycle manager Event name Description Parameters Subscription Frozen Event This event is generated by the Freeze Subscriptions Action from the subscription lifecycle.
It can be received only by the account lifecycle ( Entity and Period) .No parameters Subscription Unfrozen EventThis event is generated by the Unfreeze Subscriptions Action from the subscription lifecycle.
It can be received only by the account lifecycle ( Entity and Period) .No parameters Subscription Renewed EventThis event is generated by the Renew Subscription Action to signal successful renewal.
This event contains a list of subscription IDs that have been renewed.Contains parameters: •List of Subscription IDs that have been renewed •List of Bundle IDs •Accept Broadcast Message (Default: false) Subscription Reset Event This event is generated by the Reset Subscription Action to signal that a subscription has been successfully reset.Contains parameters: •Bundle ID •Accept Broadcast Message (Default: false)Table 175: Lifecycle built-in events (continued) 7.6 Actions associated with lifecycles Action definition An action is an attribute of a transition and can be invoked during a transition.
Actions are executed in the order that they are provisioned.
Some actions may trigger events and also broadcast those events to related entities.
However, broadcasting of events is based on the action input parameter.
The following table lists the source and destination entities involved in broadcasting events: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1609Charging User Guide Lifecycle manager Lifecycle Type Source Entity Destination Entity Periodic/ Entity Subscription Device/ Group ( depending on type of Subscription) linked to invoking subscription Account ( to both periodic and entity lifecycle type) Periodic/ Entity Account Subscription ( to both periodic and entity lifecycle type) Entity Device Subscription ( to both periodic and entity lifecycle type) Entity Group Subscription ( to both periodic and entity lifecycle type) Note : When adding an action to a transition, Nokia recommends adding at most one action that generates a success or failure event.
For example, if you have Add Subscription Action configured in a transition, you can add Send Notification Action to the same transition since the latter does not generate any success or failure events.
Nokia does not recommend to have in the same transition two or more actions that generate a success or failure event for example, two Add Subscription Actions configured in the same transition.
Lifecycle actions The following table lists and describes lifecycle actions.
Parameters Action Description Mandatory Optional Activate Queued Subs ActionThis action is applicable for Device and Subscription entity and is applicable for both entity and periodic lifecycle.
When Activate Queued Subs Action is attached to a subscription entity, it checks whether it is a queued subscription or not.
If it is not a queued subscription, then no action is taken.
If it is a queued subscription, then the next subscription from the queued list is activated.
However, if the device is inactive, then the next subscription in the queue is not activated.
When the Activate Queued Subs Action is attached to a Device entity, the mapping of queue Id (from Device) to queued subscription ( queue ToSubs) is determined.
From the mapping information, NCC determines the first subscription from each queue and triggers Activate Queued Subs Event on determined subscription.
The Activate Queued Subs Event must be configured in the subscription lifecycle and it moves the subscription to Active state.Table 176: Lifecycle actions Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1610Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional When the Activate Queued Subs Action is configured on Device and when triggered moves the first subscription from each queue to Active state.
AddEDRAction This action is applicable for all lifecycle entites and is applicable for both entity and periodic lifecycle.
During Add EDRAction configuration, if additional tags are configured in rule, then they are logged in the generated EDR along with certain generic tags.
Examples : You can define tag name and tag value while configuring the CALL_ RESUL T. Add- EDR rule attribute in the Add EDRAction lifecycle: CALL_RESULT.Add-EDR("Tag1","Val1") You can also define multiple tags: CALL_RESULT.Add-EDR("Tag1","Val1") and CALL_RESULT.Add-EDR(" Tag2","Val2") Add Subscription ActionThis action allows you to add a new subscription to a specified bundle as a result of a trigger from an account or subscription lifecycle transition.
When Add Subscription Action executes in a subscription lifecycle ( for example, subscription ABC) the following takes place: •The newly created subscription ( for example, subscription XYZ) is added to all the devices and groups currently linked to the subscription ABC.
•The subscription XYZ is owned by the same account that owns the subscription ABC.
When Add Subscription Action executes in an account lifecycle, the newly created subscription is added to all the devices and groups currently linked to the account by means of a subscription.
The account whose lifecycle is being triggered owns the new subscription.
If a device is currently linked to the account by means of a subscription ( directly, not using groups) , then the device is linked to the new subscription.
If a group is currently linked to the account by means of a subscription ( directly, not using parent groups) , then the group is linked to the new subscription.
This action provides an option to override Bundle Fee.
This fee is used as an input to calculate total amount to be deducted from account, based on the number of devices and groups linked to the account by a subscription.
Add Subscription Action generates Add Subscription Action Success Event or Add Subscription Action Failure Event to the lifecycle of the account or the subscription that invoked Add Subscription Action.
It also generates Subscription Added Event to other related entities.
The following examples illustrate how you can use this action: •A subscription expires and a new one is automatically added to take its place.Bundle Id •Fee Override (decimal number greater than zero, defaults to null) •Ignore Barred Account ( defaults to false) •Ignore Barred Device or Group ( defaults to true) •Taxation profile Note that the Taxation profile field is applicable only if some fee amount is given for the action inside the lifecycle.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1611Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional •A device is active for 90 days and a new subscription is added for a special 90- day bonus.
•A group is active for 30 days and a new subscription is added to the group.
•An account pays 100 dollars for an additional subscription.
•Device is barred and the new subscription addition is successful when the Ignore Barred Device or Group flag is checked.
•Device is in Final state and subscription addition through GUI/ REST is unsuccessful.
See Add Subscription Action ( ASA) on page 1628 for an illustration.
If the tax is not found in the lifecycle, then it is fetched from bundle or account.
Tax ID is ID of the taxation profile.
A taxation profile can be selected from the Tax ID drop- down list.
Cancel Period ActionThis action allows you to cancel a period.
This action is used in a PERIOD lifecycle of an account or subscription.
When this action is executed on account, or subscription, it moves the lifecycle to initial state.
This action does the following: •Generates Cancel Period Event •Sets to null Start Time and End Time of the entity whose lifecycle is being cancelled If Cancel Period Event transition does not exist in the lifecycle being cancelled, the state parameter of the entity referencing this lifecycle is updated to the initial state ( initial= true) of this lifecycle.No mandatory parameters Cancel And Reset Period ActionThis action executes the actions Cancel Period Action and Reset Period Action in a single step.
It has the following periodicity parameters ( optional) : •Length - It accepts values of integer type ( greater than or equal to 1) .
•Unit - The possible values are as follows: –Second –Minute –Hour –Day –Week –Month –YearNo mandatory parametersTable 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1612Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional When the periodicity parameters are configured, they take priority over the periodicity configured at the lifecycle level.
When they are not configured, then the periodicity configured at the lifecycle level is used.
Note : •The Cancel And Reset Period Action does not generate the Cancel Period Event .
•During Freeze if any of these entities - Account, Device or Subscription are frozen, then this action is restricted to reset the lifecycle period triggered from lifecycle, when configured on the Account Recharge Event or a Custom Event.
Charge Fee Action This action allows an operator to charge a fee on a subscription or an account.
In case this is used in a subscription lifecycle, the account referenced by the subscription is the one picked up for charging.
If this is used in an account lifecycle, the account entity is used directly.
This action generates Charge Fee Action Success Event or Charge Fee Action Failure Event to the related entities, depending on the result of its execution.
When Charge Fee action is triggered inside any other state apart from initial state of periodic lifecycle of a subscription, NCC checks for Charge Fee action in the Fee reference for Prorate and a valid future activation date for charge fee prorate as applicable.
If a valid discount ( 0 to 100) is provided, the calculated discount fee is applied on the prorated fee ( if applicable) .
If this lifecycle of the subscription and current state is initial state, then the bundle fee discounts are applied here as per subscriptions.
If it is a group subscription, then all eligible discounts instances attached to the group are only applied here.
The similar scenario is followed for a device.
For more information on eligible discount instances, see the Eligible discount instances on page 1375 section.
Note : The discount as input is different from bundle fee discount, which comes from the discount entity configuration.
If there is any tax applicable, then it is calculated on the discounted fee.
Apply Tax checkbox is selected to apply the tax.
Tax ID is ID of the taxation profile.
It is available only when Apply Tax is selected.
A taxation profile can be selected from the Tax ID drop- down list.
If the taxation reference is not given inside the lifecycle, that is, Taxation profile is not given in the Charge Fee Action , then the tax is not applied.
There is no fallback on the bundle or account if the taxation reference is not given inside the lifecycle.No mandatory parameters•Allow Event Broadcast ( defaults to false) •Taxation profile Note that the Taxation profile field is applicable only if some fee amount is given for the action inside the lifecycle.
•discount Discount percentage provided as an input parameter through rules or lifecycle configuration.
Delete Entity This action deletes an ENTITY along with its associated entities like subscription.
To delete an entity immediately, configure a looping transition with Delete Entity action and a timer less or equal to zero.
To delete an entity at some time in the future, use a timer greater than zero.No mandatory parametersTable 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1613Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional Note the following important points: 1.It is recommended to delete the entity in the following order: a.Device → All devices b.Group → Devices are already deleted, then Child groups, followed by the Parent Group.
c.Account → Devices and Group are already deleted with their associated entities, now account can be deleted.
2. a.Delete Entity is recommended to be configured in the FINAL state of Entity Life Cycle.
3.Delete Entity behaviour is same as the REST API of respective subscriber entity, such as: a.Parent Group cannot be deleted if the Child Group it is linked to is not deleted.
b.Account cannot be deleted if it is linked to a Device/ Group.
c.User can be deleted irrespective of its linkage to any other entity ( Account/ Device/ Group) .
Delete Expired Entity ActionThis action deletes expired entities and currently, it is supported only for discount instances.
If end Time + interval < current time, then this action deletes entity.
endTime = end Time of Entity interval = value given in the interval parameter in this action.
Its unit is hours.
Default value is 0.
Note : The interval parameter provides time after which entity is expired.
The unit is measured in hours.No mandatory parametersAllow Event Broadcast ( defaults to false) Interval ( defaults to 0) unit in hours Delete Subscription ActionThis action allows you to delete a subscription.
Delete Subscription Action is supported in account, device and subscription lifecycles only.
When Delete Subscription Action executes in a subscription lifecycle, the following applies: •If Bundle ID is provided and it matches the id of the bundle that the subscription is linked to, Delete Subscription Action applies to this subscription.
If Bundle ID does not match, Delete Subscription Action does not execute.
•If Bundle ID is not provided, Delete Subscription Action applies to the subscription regardless of which bundle this subscription is linked to.
When Delete Subscription Action executes in an account or device lifecycle, the following applies to the subscriptions linked to this account:No mandatory parametersBundle IDTable 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1614Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional •If Bundle ID is provided, Delete Subscription Action applies to the subscriptions linked to the specified Bundle ID.
•If Bundle ID is not provided, Delete Subscription Action applies to all subscriptions linked to this account or device ( in case of device lifecycle) regardless of which bundles these subscriptions are linked to.
When Delete Subscription Action executes in a device, subscription or account lifecycle, this action does the following for all applicable subscriptions: •If the final state is configured in the lifecycle of an applicable subscription, the following applies: –If Entity Removed Event is configured from the subscription’ s current to the final state, Delete Subscription Action triggers Entity Removed Event transition with all actions, if any, associated with this transition.
–If Entity Removed Event is not configured from the subscription’ s current state to the final state, Delete Subscription Action explicitly sets the subscription’ s state to the final state.
•If there is no final state in the lifecycle of an applicable subscription, this subscription is deleted immediately and removed from the groups and devices linked to this subscription.
To fully delete a subscription, you must configure in the lifecycle of this subscription a looping transition with Delete Entity action in the final state.
See Delete Subscription Action ( DSA) on page 1629 for an illustration.
Empty Subscription ActionThis action is applicable to the periodic lifecycle and entity lifecycle attached to a subscription.
This action sets the current value of all buckets including carry- over bucket to zero.
In case of carry- over bucket, the initial value is also set to zero.
The current value of all counters is set to zero.
This action does not impact the buckets or counters which have a separate reset periodic lifecycle.
The buckets and counters have a periodic lifecycle, and are reset by their periodicity.
In general, this action is configured on the Repeat Cycle Event with transition of Lifecycle to a state having the barred flag checked.
It ensures that the subscription resources are emptied and subscription is not recurrent.
For Subscription having Step bucket, when the Empty Subscription Action is triggered on it, then current Charging Step and current Charging Step UpTime are not altered.No mandatory parametersAllow Event Broadcast (defaults to false) Freeze Account ActionThis action is available in the account lifecycles ( Entity and Period) .
It is optional.
If the account belongs to more than one group, or device, the Freeze Account Action is ignored.
This action removes TEM from the account lifecycles.
Hence, the configured validity time ( Entity and Period) does not run.
The periodic lifecycle is paused.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1615Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional If the current state has the validity time, then the spent validity time ( msecs) is saved as validity Time AtFreezing parameter in the account data.
If the periodic lifecycle executes this action, then the current status of the period is saved as timer AtFreezing parameter in the account data.
Note : It is mandatory to configure a transaction to new state ( for example, from Active to Freeze) , so that while Life Cycle transits from current state to new state it can listen to unfreezing events.
Freeze Device ActionThis action is available in the device lifecycle.
It is optional.
This action removes TEM from the device lifecycles.
Hence, the configured validity time ( Entity and Period) does not run.
This action saves the actual freezing time ( ms) as freezing Time parameter in the device data.
If the current state has the validity time, then the spent validity time ( msecs) is saved as validity Time AtFreezing parameter in the device data.
Note : It is mandatory to configure a transaction to new state ( for example, from Active to Freeze) , so that while Life Cycle transits from current state to new state it can listen to unfreezing events.
Freeze Subscriptions ActionThis action is available in the device lifecycle.
It is optional.
This action broadcasts the Device Frozen Event towards the subscription lifecycles ( Entity and Period) for the subscriptions belonging to the device.
Note : It is mandatory to configure a transaction to new state ( for example, from Active to Freeze) , so that while Life Cycle transits from current state to new state it can listen to unfreezing events.
Freeze Subscription ActionThis action is available in the subscription lifecycles ( Entity and Period) .
It is optional.
The Freeze Subscription Action action does the following: •It removes TEM from the subscription lifecycles.
Hence, any configured validity time ( Entity and Period) does not run.
The periodic lifecycle is paused.
•If the subscription uses the Buckets and Counters which have a period, the period of the Buckets and Counters is also paused.
•If the current state has the validity time, then the spent validity time ( msecs) is saved as validity Time AtFreezing parameter in the subscription data.
•If the periodic lifecycle executes this action, then the current status of the period is saved as timer AtFreezing parameter in the subscription data.
•If the Allow Event Broadcast is checked, then the Subscription Frozen event is broadcast to account lifecycles ( Entity and Period) of the current subscription.Allow Event Broadcast : This check box is unchecked by default.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1616Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional Note : It is mandatory to configure a transaction to new state ( for example, from Active to Freeze) , so that while Life Cycle transits from current state to new state it can listen to unfreezing events.
Renew Subscription ActionThis action allows you to renew a subscription and charge fees associated with renewal.
This action can only be used in a PERIOD lifecycle of an account or subscription.
If this action executes in an account lifecycle, scenario 1 applies.
If this action executes in a subscription lifecycle, scenario 2 applies.
Account is barred and renew subscription is unsuccessful when the Ignore Barred Account flag is unchecked.
Account is barred and renew subscription is successful when the Ignore Barred Account flag is checked.
If the Device or Group is barred with the Ignore Barred Device or Group flag as false, then the renewal of that particular subscription is unsuccessful.
To calculate the amount of applicable fees, the following applies: If Renewal Fee is provided, then Renewal Fee overrides both Fee Override that might be specified for a subscription and Bundle Fee specified for the bundle of this subscription.
The following formula is used to calculate the amount of applicable fees for renewing one subscription: amount of fees = ( Renewal Fee ( if provided) OR Fee Override ( if specified) OR Bundle Fee) The renewal discounts are applied here as per subscriptions.
If it is a group subscription, then only all eligible discount instances are attached to the group are applied here.
The similar scenario is applicable for the device.
For information on eligibility of discount instances, refer to the Eligible discount instances on page 1375 section.
If there is an update in the billing cycle information, the prorating is done based on the prorating flags configured in the bundle.
Tax ID is ID of the taxation profile.
A taxation profile can be selected from the Tax ID drop- down list.
If the taxation reference is not given inside the lifecycle, that is, Taxation profile is not given in the Renew Subscription Action , then the tax related information is fetched from bundle or account.
Scenario 1 ( account lifecycle) This part describes scenario 1, when Renew Subscription Action executes in an account PERIOD lifecycle.
For scenario 2, when Renew Subscription Action executes in a subscription PERIOD lifecycle, go to the next part.
This action can be used in the PERIOD lifecycle of the account that owns a subscription( s).
This action can be applied only to those subscriptions of this accountNo mandatory parameters•Renewal Fee •Bundle ID •Allow Event Broadcast (If the action is configured in account lifecycle, then default value is true else in case of subscription lifecycle, default value is false) •Ignore Barred Account (defaults to false) •Ignore Barred Device or Group (defaults to true) •Taxation profile Note that the Taxation profile field is applicable only if some fee amount is given for the action inside the lifecycle.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1617Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional whose Subscription Renewal Mode is set to RESET_ ONL Y or NONE, which is true under the following conditions: •Subscription Renewal Mode is set to RESET_ ONL Y if Reset Subscription Action is configured in the PERIOD lifecycle of a subscription but Renew Subscription Action is not configured in this lifecycle.
•Subscription Renewal Mode is set to NONE if neither Reset Subscription Action nor Renew Subscription Action is configured in the PERIOD lifecycle of a subscription.
This includes the case when a subscription does not have a PERIOD lifecycle associated with it.
When Renew Subscription Action executes in an account lifecycle, the following applies: •If no Bundle Id is provided, then this action applies to all subscriptions linked to this account.
•If Bundle Id is provided, then this action applies to the subscriptions linked to this account that match Bundle Id.
•If both parameters, Bundle Id and Renewal Fee, are provided, Renewal Fee is applied to each applicable subscription that matches Bundle Id.
When executed in an account lifecycle, this action does the following in the order listed: •This action defines which subscriptions linked to this account can be renewed based on their remaining Renewals parameter.
If remaining Renewals is not specified, the action omits this step.
–If a subscription has reached its maximum number of renewals: its remaining Renewals is less or equal to zero, then Max Renewals Reached Event is generated in the ENTITY and PERIOD lifecycle of this subscription.
•For postpaid account with Deduct Postpaid Fee Flag as true in the charging application preferences or prepaid account, the Renew Subscription Action calculates the amount of all applicable fees for renewing all applicable subscriptions.
–If the account does not have enough funds to renew all applicable subscriptions, then Not Enough Funds Event is generated in the ENTITY and PERIOD lifecycles of this account and the ENTITY and PERIOD lifecycles of all subscriptions that failed to renew.
–If the account has enough funds to renew all applicable subscriptions, then the calculated amount is deducted from this account and the action proceeds.
•For all applicable subscriptions, this action decrements remaining Renewals.
•For each applicable subscription, this action checks if its Subscription Renewal Mode is NONE.
–The buckets and counters which have a separate reset periodic lifecycle are reset by their periodicity.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1618Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional –If the reset is successful, Subscription Renewed Event is generated in the ENTITY and PERIOD lifecycles of the subscription.
•This action resets only the subscription resources which do not have a periodic lifecyle.
•If all the above steps complete successfully, Subscription Renewed Event is generated in the ENTITY and PERIOD lifecycles of the account whose lifecycle is being triggered.
Note : The device policy counters and other counters, including group and Sy counters, linked to this account are reset by the periodicity of the counter.
Scenario 2 ( subscription lifecycle) This part describes scenario 2, when Renew Subscription Action executes in a subscription PERIOD lifecycle.
For Scenario 1, when Renew Subscription Action executes in an account PERIOD lifecycle, go to the previous part.
Scenario 2 of Renew Subscription Action can only be used in a subscription PERIOD lifecycle.
This scenario works only on those subscriptions whose Subscription Renewal Mode is set to BILLING_ ONL Y or ALL, which is true under the following conditions: •Subscription Renewal Mode is set to BILLING_ ONL Y if the bundle, the subscription refers to, defines billing- related information ( dayOfMonth, hour Of Day, day OfWeek) .
This is irrespective of presence of Renew Subscription Action or Reset Subscription Action.
•Subscription Renewal Mode is set to ALL if bundle does not define billing- related information and Renew Subscription Action is configured in the PERIOD lifecycle of a subscription.
This is irrespective of presence of Reset Subscription Action.
In scenario 2, Bundle ID parameter is irrelevant.
When executed in a subscription lifecycle, Renew Subscription Action does the following in the order listed: •Checks if the maximum number of remaining renewals has been reached for this subscription: remaining Renewals is less or equal to zero.
–If this is true, then Max Renewals Reached Event is generated in the ENTITY and PERIOD lifecycles of the subscription.
–If this is not true, the action proceeds.
•Checks if this subscription is linked to a postpaid account with Deduct Postpaid Fee Flag as true in the charging application preferences or prepaid account, and if this account has enough funds to pay all applicable fees: –If the account does not have enough funds, then Not Enough Funds Event is generated in the ENTITY and PERIOD lifecycles of the subscription.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1619Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional –If the account has enough funds, then the amount of applicable fees is deducted from the account and the action proceeds.
•Decrements remaining Renewals of this subscription •The buckets and counters have a separate reset periodic lifecycle, and are reset by their periodicity.
•Resets thresholds of this subscription to initial values •If all the above steps complete successfully, Subscription Renew Event is generated in the ENTITY and PERIOD lifecycles of this subscription.
Reset Account ActionThis action is applicable for both periodic and entity lifecycles attached to an account.
The following list provides details on the actions that NCC takes upon execution of the Reset Account Action: •It resets the account balance to given reset value or to zero if the reset value is not provided.
•It preserve the values of balance and available balance attributes of account balance before account reset.
Also, it saves the timestamp of reset.
•It resets the thresholds linked to the given account based on account balance, that is, reset thresholds below the reset value.
•It generates events for success and failure scenarios ( that is, when overage limit is greater than reset value) .
•It resets account balance to the sum of loan amount ( if loan is availed) , shadow balance, and any reset value ( if configured) .
The Account Reset Action may not be successful in the following cases: •When an account is in the final state.
•When an account is in barred state and Ignore Barred Account flag is unchecked.
However, the account reset can be successful in barred state if the Ignore Barred Account flag is checked.
•When the reset value is less than the overage limit of an account.No mandatory parameters•Reset Value ( defaults to 0) •Allow Event Broadcast ( defaults to False) •Ignore Barred Account ( defaults to False) Reset Period ActionThis action can be used in PERIOD lifecycles only.
This action calculates Start Time and End Time for a period, for example, a billing cycle.
Note : End Time and Start Time are intended for use in PERIOD lifecycles only.
You should not use End Time and Start Time in ENTITY lifecycles.
The calculation handles 28- 31 days in month.
If End Time is outside of the valid range, the last day of the last month is used.
The calculation differs whether the period is the first cycle or it is a subsequent cycle.
If the period is the first cycle, then the following applies:No mandatory parametersTable 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1620Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional •Start Time is set to the current time •End Time is based on the account billing- related information or bundle billing related information ( dayOfMonth, day OfWeek, hour OfDay) and does not exceed period Length of the period.
The billing info to generate new end time is taken from the bucket or counter if specified, else from the bundle.
If the billing info is not defined in the bundle, then it is taken from the account.
The day OfMonth support 1 to 31 and Exact values, where Exact when selected aligns the day OfMonth to subscription purchase date.
The day OfWeek supports Sunday to Saturday and Exact values, where Exact when selected aligns the day OfWeek to subscription purchase date.
The hour OfDay supports 0 to 23, Exact, Start of new day values.
When Exact is selected, the end time in end date has same value as subscription start time.
When Start of new day is selected, the end date and time is aligned to 00: 00:00 of next day.
For example, if a monthly subscription is purchased on 20th March 13: 45:00, then if this option is selected, then the end date and time of the subscription is set to 21st April 00: 00:00.
See Scenarios for Day of Month, Hour of Day, Day of Week parameters on page 1643 for examples.
Operators can change the billing cycle reset date for the account and subscriptions based on the logic mentioned at Handling BCR time when account renewal fails on page 1631 .
For examples related to BCR time reset, see Scenarios for BCR time handling on page 1637 .
If the period is a subsequent cycle, then the following applies: •Start Time is set to the current End Time •EndTime is recalculated according to the new Start Time, account billing- related information or bundle billing related information and period Length.
However, if the current time is less than the current End Time, Start Time and End Time is not reset.
Depending on period Length and without exceeding it, the following applies to calculate End Time for various cycles: •DAY cycles, hour OfDay is used to calculate End Time •WEEK cycles, day OfWeek is used to calculate End Time, counting from 12 a. m. •MONTH and YEAR cycles, day OfMonth is used to calculate End Time, counting from 12 a. m. •HOUR and MINUTE cycles fractional cycles are handled as full cycles •SECOND cycles, End Time is based on period Length only In addition, a set of conditions applies to the following special cases: •MONTH cycles: If Start Time day is less than day OfMonth or equal to it, then Start Time month is calculated as the first month of the cycle.
Otherwise, the first month of the cycle is the following month.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1621Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional The following examples illustrate the above statement: –Start Time is 2016/ 12/02 12: 30:00, day OfMonth= 31, period Length is 3 MONTHS End Time is 2017/ 02/28 00: 00:00 –Start Time is 2016/ 12/02 12: 30:00, day OfMonth= 1, period Length is 3 MONTHS End Time is 2017/ 03/01 00: 00:00 •WEEK cycles: If Start Time weekday is less than day OfWeek or equal to it, then Start Time week is calculated as the first week of the cycle.
Otherwise, the first week of the cycle is the following week.
The following examples illustrate the above statement: –Start Time is Tuesday 2017/ 05/02 12: 30:00, day OfWeek= 5 (Friday) , period Length is 3 WEEKS End Time is 2017/ 05/19 00: 00:00 –Start Time is Tuesday 2017/ 05/02 12: 30:00, day OfWeek= 1 (Monday) , period Length is 3 WEEKS End Time is 2017/ 05/22 00: 00:00 •DAY cycles: If Start Time hour is less than hour OfDay, then the day of Start Time is the first day of the cycle.
Otherwise, the first day of the cycle is the following day.
The following examples illustrate the above statement: –Start Time is 2017/ 05/20 12: 30:00, hour OfDay= 0, period Length is 5 DAYS End Time is 2017/ 05/25 00: 00:00 –Start Time is 2017/ 05/20 00: 30:00, hour OfDay= 12, period Length is 5 DAYS End Time is 2017/ 05/24 12: 00:00 See Scenarios for Day of Month, Hour of Day, Day of Week parameters on page 1643 for examples.
See Reset Period Action on page 1631 for an illustration.
The following examples illustrate how HOUR, MINUTE, and SECOND cycles are calculated.
•2 HOUR period Length and 17: 45:23 current time –first cycle Start Time is 17: 45:23, End Time is 19: 00:00 –subsequent cycle Start Time is 19: 00:00, End Time is 21: 00:00 •5 MINUTE period Length and 17: 45:23 current time –first cycle Start Time is 17: 45:23, End Time is 17: 50:00 –subsequent cycle Start Time is 17: 50:00, End Time is 17: 55:00Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1622Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional •40 SECOND period Length and 17: 45:23 current time –first cycle Start Time is 17: 45:23, End Time is 17: 46:03 –subsequent cycle Start Time is 17: 46:03, End Time is 17: 46:43 The diagram below this table illustrates the execution of Reset Period Action in the account PERIOD lifecycle.
Note : •When multiple actions are configured within the same transition, it is recommended to configure Reset Period Action as the last action.
•During Freeze if any of these entities - Account, Device or Subscription are frozen, then this action is restricted to reset the lifecycle period triggered from lifecycle, when configured on the Account Recharge Event or a Custom Event.
Reset Resource ActionThis action resets the bucket or counter to its initial values.
This action resets only the resource bucket and counter instance on which the lifecycle is triggered.
It works only for the bucket instance and counter instance type of entity.
Reset Subscription ActionThis action resets a subscription.
This works only on the subscriptions whose Subscription Renewal Mode is set to RESET_ ONL Y or BILLING_ ONL Y.
This action is used in the PERIOD lifecycle of subscriptions only.
If the Device or Group is barred with Ignore Barred Device or Group flag as false, then reset subscription is unsuccessful.
This action executes as follows: •The subscription resources which do not have a reset periodic lifecycle are reset.
•If the above step succeeds, the Subscription Reset Event is generated in the ENTITY and PERIOD lifecycles of this subscription.
This action resets only the subscription resources which do not have a periodic lifecyle.
If there is an update in the billing cycle information, the prorating is done based on the prorating flags configured in the bundle.
Note : The buckets and counters, which have a periodic lifecycle, are reset by their periodicity.
Hence this action does not reset bucket, and counters of a subscription to initial values.No mandatory parameters•Allow Event Broadcast ( defaults to false) •Ignore Barred Device or Group ( defaults to true) Send Notification ActionThis action sends a request to the notification server.
Send Notification Action can be used in device, account and subscription lifecycles.
•When this action executes in a lifecycle of a device, this device is used to invoke the notification client.Notification Template IdRules : This parameter provides the rule for the lifecycle entity and contains the rulesTable 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1623Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional •When this action executes in a lifecycle of an account, this actions attempts to find the device that belongs to the administrator of the account.
–If such a device does not exist, the action ends without sending a notification.
–If the device is found, this device is used to invoke the notification client.
•When this action executes in a lifecycle of a subscription, this action finds the account that this subscription is linked to and then proceeds in the same way as when this action executes in a lifecycle of an account.
•This action is applicable for bucket and counter lifecycles.
The context exposed in rules for generating notification variables is the device, group and subscription along with fixed notification variables BUCKET_DEF_ID and COUNTER_DEF_ID .
•The lifecycle rule applies a condition based on the custom data of a device or group and Notification Template Id .
It then selects a new Notification Template Id to send the notification to the Notification Server.and conditions in a defined format.
Note : The Rules box becomes visible only when the user selects the action as Send Notification .
For any other action, this box is not available.
Send RAR Action This action allows you to send RAR in an ongoing IMS or Gy session to reauthorize the ongoing call.
If Send RAR Action is configured in Subscription or Account lifecycle, then it is executed only if there is an ongoing IMS/ Gy session.
Following is the behavior of Send RAR Action when attached with different entities: •Subscription : If the subscription is of type Device, and the device has an active session, then RAR is sent only to the that device.
If the subscription is of type Group, then RAR is sent to all the devices of that group which have active sessions.
•Account : RAR is sent to the device ( if it has an active session) associated to the account through subscription.
In case of Group subscription, RAR is sent to all the devices ( having active sessions) in that group associated to the account through subscription.
Send SNR Action This action allows you to send SNR to indicate the change in state of configured policy counter to policy module.
This action can be used in both PERIOD and ENTITY lifecycles for the following entities only: •Device •Subscription •AccountOnce this is selected, you must enter Policy Counter Name and Policy Counter State•Policy Counter Name •Policy Counter StatusTable 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1624Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional This action is not applicable for Group and User entity.
Under this action, one pair of policy counter and corresponding counter state is mandatory.
However, such multiple pairs can be added with this action.
The Send S N R Action can be attached along with another action also in the same transition, but only one such entry is allowed.
Following is the behavior of Send SNR Action when attached with different entities: •Device : In this case, all the policy counters attached with both device and device subscription are processed for SNR.
•Subscription : In this case, all the policy counters attached directly to the subscription are processed for SNR.
If the subscription is of type Device Subscription, then the SNR is sent to the concerned device only, but if the subscription is of type Group subscription, then the SNR is sent to all the devices of that group.
•Account : In this case, the policy counters attached to device or through device subscription or group subscription are processed for SNR.
All the input policy counters are processed and corresponding SNR request is prepared, even if they are not present in Sy session of the device, as the state is provided as input.
For all policy counters, the following logic is used to examine the applicability for SNR request: •Input Counters : These counters are provided as input of Send S N R Action.
SNR is sent mandatorily for policy counters which are not present in Sy session of the device.
If counter is present in the session, SNR is sent only if the given state and state in the session is mismatched.
•Usage Counters : If this counter is provided as input to the action, then input state is compared with state in session, if the counter is present in session.
In case of mismatch of state or counter not present in session, it becomes applicable for the SNR.
But if this counter is not provided as input, then its state is read from attached threshold profile and compared with the state in session.
If there is any difference, then it is considered for SNR request.
•Resource Counters : See the SNR handling of resource- based counters in reservation during a call on page 1442 for details on how the SNR processing is done for resource based counters.
If the configured policy counter is not attached to the device, then no SNR is sent.
If counters are not configured in the Send SNR action, but attached to entity on which action is invoked, it is re- evaluated to check the applicability and if applicable, SNR is sent.
The following example illustrate the logic of the Send S N R Action: Consider an i Phone having Policy Counters C1 to C5 and these are also present in the iPhone' s (device’ s) Sy session.
With time, few more policy counters are attached to i Phone, such as C6 to C10.
The Send S N R Action is configured in the entity lifecycle of a device with input: C1, S1; C4, S4;C7,S7.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1625Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional On triggering action, for counters C1 and C4 state is not calculated since state is already provided as input.
If new state of counter is different from state present in Sy session, SNR is sent.
C7 is also sent in SNR as it is given as input, although it is not present in the Sy session.
In addition to this, other counters are also evaluated and sent in SNR, if they are applicable to their states.
Trigger Event ActionThis actions allows you to trigger an event in the lifecycle of the type specified by Event Type , for the same entity.
This action is used in the Default Account LifeCycle, when an account is created, to trigger Start Cycle Event in the PERIOD lifecycle of the Default Account Billing Cycle.
Also, this action is used in Default Subscription LifeCycle, when a subscription is created, to trigger Start Cycle Event in the PERIOD lifecycle of the Default Subscription Billing Cycle, if it is associated to the subscription.
When this action is used on bucket and counter, it sends an event to its instance with the associated periodic lifecycle.
It also sends the event to the associated subscription on both periodic and entity lifecycle.
When this action is used on subscription, it triggers the event on life cycle of the bucket or counter instance that is available.Event Name Event Type (supported values are Entity, Period)Allow Event Broadcast (defaults to false) Unfreeze Account ActionThis action is available in the account life cycles ( Entity and Period) .
It is optional.
This action sets the validity time at freeze Timestamp to the configured VT, that is the Validity Time AtFreeze found in the account data.
It also resets the Validity Time At Freeze from the account data.
It uses the freezing Time parameter saved in the device data to extend and continue the periodicity of the periodic life cycle.
The input Date , and endTime are extended by the current time stamp found in the device data.
Note : •If the Account is unfrozen first, freezing Time on the account is removed and created during the freeze action.
However freezing Time on device/ subscription is not removed.
•You must configure the life cycle to return to the previous state before freezing.
For example: If the life cycle was in active state before freezing, it must return to active state at unfreezing.
This is mandatory if the initial state ( Active) had the validity time.
•It is mandatory to configure a transaction to original state ( for example, from Freeze to Active) so that Life Cycle can transit from current frozen state to the original state before freezing.
Unfreeze Device ActionThis action is available in the device life cycle.
It is optional.
This action sets the validity time at freeze Timestamp to the configured VT, that is the Validity Time AtFreeze found in the device data.
It also resets the Validity Time At Freeze from the device data.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1626Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional If the Device is unfrozen first, freezing Time on the device is removed and created during the freeze action.
However freezing Time on subscription/ account is not removed.
If the Subscription life cycle is configured to accept broadcast message from Device to unfreeze subscription, then Subscription freezing Time is removed.
If the Account life cycle is configured to accept broadcast message from subscription to unfreeze Account, then Account freezing Time is removed.
Note : It is mandatory to configure a transaction to original state ( for example, from Freeze to Active) so that Life Cycle can transit from current frozen state to the original state before freezing.
Unfreeze Subscription ActionThis action is available in the subscription life cycles ( Entity and Period) .
It is optional.
The Unfreeze Subscription Action does the following: •This action sets the validity time at Freeze Timestamp to the configured VT, that is the Validity Time AtFreeze found in the subscription data.
It also resets the Validity Time AtFreeze from the subscription data.
•It uses the freezing Time parameter saved in the device data to extend and continue the periodicity of the periodic life cycle.
The input Date , and endTime are extended by the current time stamp found in the device data.
•The timer AtFreezing parameter found in the subscription data is used to extend and continue any individual components, such as a bucket in the Charging Service, that have a timer.
•If Allow Event Broadcast is checked, the Unfreeze Subscription Action action is broadcast to its account.
•If the Subscription is unfrozen first, freezing Time on the subscription is removed and created during the freeze action.
However freezing Time on device/ account is not removed.
If the Account life cycle is configured to accept broadcast message from subscription to unfreeze Account, then Account freezing Time is removed.
Note : It is mandatory to configure a transaction to original state ( for example, from Freeze to Active) so that Life Cycle can transit from current frozen state to the original state before freezing.Allow Event Broadcast : This check box is unchecked by default.
Unfreeze Subscriptions ActionThis action is available in the subscription life cycles ( Entity and Period) .
It is optional.
When this action is used, it broadcasts the Device Unfrozen Event .
Note : It is mandatory to configure a transaction to original state ( for example, from Freeze to Active) so that Life Cycle can transit from current frozen state to the original state before freezing.
Update Counter ActionThis action is available in the subscription life cycles ( Entity and Period) for all the events.
It is optional.
When this action is used, it provisions a counter on the device with a specific value.Table 176: Lifecycle actions (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1627Charging User Guide Lifecycle manager Parameters Action Description Mandatory Optional This action has the following parameters: •Counter Name : Name of the counter to be provisioned.
•Counter Value : Value of the counter to be provisioned.
Note : •This action is applicable only to multi- bundle counters.
•This action is applicable only to Set operation.
Reset Loan Action This action is used for resetting/ clearing the loan instance parameters in case of account expiry.
It is only applicable to Account.
It does not modify the account main balance.
Reset Account Action can be used to reset the main balance if needed.Table 176: Lifecycle actions (continued) Figure 76: Add Subscription Action (ASA) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1628Charging User Guide Lifecycle manager Figure 77: Delete Subscription Action (DSA) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1629Charging User Guide Lifecycle manager Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1630Charging User Guide Lifecycle manager Figure 78: Reset Period Action Handling BCR time when account renewal fails The following figure shows the BCR time handling logic: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1631Charging User Guide Lifecycle manager When an Account renewal fails, all the subscriptions linked to the Account gets barred depending on the life cycle configuration.
If the Account balance is topped up midway before the BCR, the subscriptions become active but they are valid only until next BCR date.
Operators can change this behavior and set the billing cycle reset time to align to the recharge date, depending on the life cycle periodicity.
If the recharge amount is insufficient for renewal, billing cycle reset time is not modified.
If a bundle has its own periodicity, the subscription's BCR date is updated irrespective of the Account billing information.
Note : If the account remains suspended for more than one periodic cycle, when the account is recharged, the renewal fee is deducted only for the current cycle.
The renewal fee is not deducted for the previous suspended cycles during which the services are not used.
Recommended configurations Billing information configuration in Bundle and Account The following parameters define the inputs for BCR alignment to a particular date and time depending on the life cycle periodicity.
For example, if the periodicity is monthly, set the Day of Month parameter to Exact value.
•Day of Week •Hour of Day •Day of Month Lifecycle configuration Account can be recharged using Adjust Balance API, Set Balance API, or Reset Account Action.
When there is a positive top-up of Account, the Account Recharged Event is triggered.
There are two possible configurations of life cycle as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1632Charging User Guide Lifecycle manager •Configuration 1 : If subscriptions are renewed through Account life cycle, then configure Account periodic life cycle and Subscription entity life cycle.
•Configuration 2 : If subscriptions are renewed through their own life cycle outside the Account BCR, then configure Subscription periodic life cycle.
Following is the Account monthly life cycle configuration for Configuration 1 where the subscriptions are renewed through Account life cycle: Configure three transition states namely Active , Disconnected , Suspended .
Active state has the following events: 1.Start Cycle Event has Reset Period Action .
2.Repeat Cycle Event has Renew Subscription Action .
If the Renew Subscription Action is not successful, that is, Account balance is not sufficient to renew subscription, then Not Enough Funds Event is triggered and the Account moves to Suspended state.
3.Subscription Renewed Event has Reset Period Action .
Account remains in the Active state.
4.Not Enough Funds Event : This event is triggered when the Renew Subscription Action fails and it moves the Account to suspended state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1633Charging User Guide Lifecycle manager Suspended state has the following events: •Account Recharged Event : This event is triggered when an Account is topped up.
Renew Subscription Action is configured for this event to renew the subscription after the recharge.
If the renewal is successful, then the Subscription Renewed Event which is the success case is triggered.
In this case, the next BCR date gets aligned to the recharge date.
•Subscription Renewed Event : This event is triggered when the subscription is renewed successfully.
In this event, the Reset Period Action is configured which calculates and aligns the BCR date to recharge date.
Subscription Entity Lifecycle Configure three transition states namely Inactive , Removed , Active .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1634Charging User Guide Lifecycle manager Inactive state has the following events: •Activate : This event activates the subscription.
•Entity Removed Event : This event removes the subscription.
•Subscription Renewed Event : This event is triggered if the subscription is renewed successfully and the subscription moves to Active state.
Since this event is triggered from Account life cycle, the Accept Broadcast Message flag must be selected.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1635Charging User Guide Lifecycle manager Active state has the following events: •Deactivate : This event moves the subscription to Inactive state.
•Start Cycle Event •Not Enough Funds Event : This event is triggered if the subscription is not renewed successfully and the subscription moves to Inactive state.
Since this event is triggered from Account life cycle, the Accept Broadcast Message flag must be selected.
Following is the Subscription monthly periodic life cycle configuration for Configuration 2 where the subscriptions are renewed through their own life cycle and not aligned with Account for renewal: Active state has the following events: •Start Cycle Event •Repeat Cycle : Renew Subscription Action is configured in this event.
•Subscription Renewed Event : This event is triggered when the subscription is renewed successfully, and the next BCR date is calculated.
The subscription remains in Active state.
•Not Enough Funds Event : This event is triggered when the subscription renewal fails and subscription moves to Suspended state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1636Charging User Guide Lifecycle manager Suspended state has the following events: •Account Recharged Event : This event is triggered whenever the Account is recharged.
Since this event is triggered from Account life cycle, the Accept Broadcast Message flag must be selected to receive and process the actions.
•Subscription Renewed Event : If the renewal is successful, then the next BCR date is calculated and the subscription is moved to Active state.
At this stage, the subscription date is aligned to recharge date.
Scenarios for BCR time handling Consider the following scenarios: •Scenario 1 : Subscription renewal fails when renewed through Account due to insufficient balance.
•Scenario 2 : Subscription renewal with its own renewal life cycle fails due to insufficient balance.
•Scenario 3 : Renewal of both type of subscriptions that are mentioned in the preceding list (scenario 1 and 2) fail due to insufficient balance.
Common configuration for preceding scenarios: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1637Charging User Guide Lifecycle manager •Account Account1 has Subscription S1 which does not have its own periodic life cycle and directly linked and renewed through Account.
•Same account Account1 has Subscription S2 which has its own periodic life cycle, getting renewed at a different date (outside Account BCR) and linked to the Account only for renewal fund.
•Account's BCR = 1st of every month •Subscription S2's BCR = 15th of every month Note : Ensure that you have configured charging service before configuring bundles.
Following is the configuration for bundles: Parameter Value Name B1 Charging Service List CS1 Fee 10 Bundle Activation Type NORMAL Entity Subsc_ ELC Note : For the scenarios, the previously configured life cycle is used.
Period N/A Hour of Day N/A Day of Month N/A Day of Week N/A Max Renewals N/ATable 177: Bundle B1 configuration (without periodic life cycle) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1638Charging User Guide Lifecycle manager Parameter Value Name B2 Charging Service List CS2 Fee 20 Bundle Activation Type NORMAL Entity Default Subscription Lifecycle Period Subs Periodic LC_RENEWMONTHL Y Hour of Day 02 Day of Month Exact Day of Week MONDAY Max Renewals N/ATable 178: Bundle B2 configuration (with periodic life cycle) Following is the Account configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1639Charging User Guide Lifecycle manager Device subscribes to Subscription S1 with bundle B1 and subscription's end date gets aligned to the Account's end date: Device subscribes to Subscription S2 with bundle B2 on 15th of the month: Scenario 1: Subscription renewal through Account fails Pre-condition: The renewal of Subscription S1 fails due to insufficient balance in Account on 1st of month and subscription moves to the Suspended state.
Recharge is done on 5th of month which is sufficient for renewal of Subscription S1.
Flow of events: On 1st of the month, Account BCR happens, subscription renewal fails due to insufficient balance.
Account and Subscription S1 moves to the Suspended state.
Note : Subscription S2 with is in Active state since it has its own periodic life cycle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1640Charging User Guide Lifecycle manager On 5th of the month, Account is recharged.
Subscription S1 becomes active and the end date is aligned to 5th.
On 15th of the month, Subscription S2 is renewed successfully.
Post-condition: •Account's BCR gets aligned to 5th.
•No change in Subscription S2 BCR as balance is sufficient to renew Subscription S2 on 15th.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1641Charging User Guide Lifecycle manager Scenario 2: Subscription renewal with bundle having its own life cycle fails due to insufficient balance Pre-condition: The renewal of Subscription S1 fails due to insufficient balance in Account on 5th of month and subscription moves to the Suspended state.
Recharge is done on 10th of month which is sufficient for renewal of Subscription S1 but not sufficient to renew Subscription S2.
On 15th of month, renewal of Subscription S2 fails and the subscription moves to Suspended state.
Recharge is done on 20th of the month.
Consider that the Account Start Time is Jun 5, 2020 10:00 AM IST and End Time is Jul 5, 2020 12:00 AM IST.
Flow of events: On 5th of the month, Account BCR happens and the renewal fails due to insufficient balance to renew Subscription S1.
Account and Subscription S1 are suspended.
On 10th of the month, Account is recharged.
The end date gets aligned to recharge date.
That is, Account Start Time is Jul 10, 2020 1:00 PM IST and End Time is changed to Aug 10, 2020 12:00 AM IST.
On 15th of the month, Subscription S2 renewal fails due to insufficient balance and Subscription S2 moves to suspended state.
On 20th of the month, Account is recharged, Subscription S2 is renewed, moves to Active state, and End date is set to recharge date.
That is, Period End Date: Aug 20, 2020 2:00 AM and Period Start Date: Jul 20, 2020 5:00 PM IST.
Post-condition: •Account's BCR gets aligned to 10th of the month.
•Subscription's BCR gets aligned to 20th of the month.
Scenario 3: Renewal of both subscriptions in scenario 1 and scenario 2 fail due to insufficient balance Pre-condition : The renewal of Subscription S1 fails due to insufficient balance in Account on 10th of month and subscription moves to suspended state.
The renewal of Subscription S2 fails due to insufficient balance in Account on 20th of month and the subscription moves to the Suspended state.
Recharge is done on 25th of the month which is sufficient to renew both subscriptions S1 and S2.
Consider that the Account Start Time is Jul 10, 2020 1:00 PM IST and End Time is Aug 10, 2020 12:00 AM IST and End Time of Subscription S2 is Aug 20, 2020 2:00 AM IST.
The Account balance is 0, which means there is no fund to renew subscriptions S1 and S2.
Flow of events: On 10th of the month, Account renewal fails due to insufficient balance to renew Subscription S1.
Account and Subscription S1 are suspended.
On 20th of the month, Subscription S2 renewal fails due to insufficient balance and Subscription S2 moves to the Suspended state.
On 25th of the month, Account is recharged with sufficient balance needed to renew subscriptions, the subscriptions S1 and S2 are renewed and moved to Active state.
The End date of Account is set to recharge date, that is, Sep 25, 2020 12:00 AM IST, and Subscription S2 is set to Sep 25, 2020 2:00 AM IST.
Post-condition: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1642Charging User Guide Lifecycle manager •Account's BCR gets aligned to 25th of the month.
•Subscription's BCR gets aligned to 25th of the month.
Scenarios for Day of Month, Hour of Day, Day of Week parameters Following table shows the End time result for different values used for Day of month and Hour of day parameters: Case Day of month Hour of day End time Case 1 1 to 31 0 to 23 For implementation details of this case, see Lifecycle actions on page 1610 , Reset Period Action.
Case 2 1 to 31 Exact Hour for Monthly Lifecycle is ignored Hour for Daily Lifecycle is considered Case 3 1 to 31 Start of new dayHour for Monthly Lifecycle is ignored Hour for Daily Lifecycle with 00: 00 is considered Case 4 Exact 0 to 23 Hour for both Monthly and Daily Lifecycle is considered Case 5 Exact Start of new dayHour for both Monthly and Daily Lifecycle with 00: 00 is considered Case 6 Exact Exact Hour for both Monthly and Daily Lifecycle is considered The following table shows the End time for Day of month = Exact and Hour of day = Start of new day.
Example Start Time End Time Example 1 17th December 2019 at 00: 00:00 HRS (with a periodicity of 1 month)17th January 2020 at 00: 00:00 HRS Example 2 17th December 2019 at 00: 00:00 HRS (with a periodicity of 1 month)18th January 2020 at 00: 00:00 HRS Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1643Charging User Guide Lifecycle manager Example Start Time End Time Example 3 17th December 2019 at 01: 00:00 HRS (with a periodicity of 1 month)18th January 2020 at 00: 00:00 HRS Example 4 17th December 2019 at 16: 34:20 HRS (with a periodicity of 1 month)18th January 2020 at 00: 00:00 HRS Following table shows the End time result for different values used for Day of week and Hour of day parameters: Case Day of week Hour of day End time Case 1 Sunday to Saturday 0 to 23 For implementation details of this case, see Lifecycle actions on page 1610 , Reset Period Action.
Case 2 Sunday to Saturday Exact Hour for Weekly Lifecycle is ignored Hour for Daily Lifecycle is considered Case 3 Sunday to Saturday Start of new dayHour for Weekly Lifecycle is ignored Hour for Daily Lifecycle with 00: 00 is considered Case 4 Exact 0 to 23 Hour for both Weekly and Daily Lifecycle is considered Case 5 Exact Start of new dayHour for both Weekly and Daily Lifecycle with 00: 00 is considered Case 6 Exact Exact Hour for both Weekly and Daily Lifecycle is considered If the timed transition in an Account or Subscription Entity Lifecycle or Period Lifecycle has Billing Information and has any of the following combinations, the following table shows the State time (timer of life cycle state) result: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1644Charging User Guide Lifecycle manager Case Day of month Hour of day State time Case 1 1-31 0 to 23 No change in the existing implementation.
See Timer parameters on page 1585 for more details.
Case 2 1-31 Exact No change in the existing implementation.
See Timer parameters on page 1585 for more details.
Case 3 1-31 Start of new dayNo change in the existing implementation.
See Timer parameters on page 1585 for more details.
Case 4 Exact 0 to 23 Hour of Day is considered.
Now( )+offset( units, time Unit) with Hour OfDay and 00: 00.
Case 5 Exact Start of new dayBoth conditions with 00: 00 is considered.
Now( )+offset( units, time Unit) + Next Day with 00: 00.
Case 6 Exact Exact No change in the existing implementation.
See Timer parameters on page 1585 for more details.Table 179: Timer The following table shows the State time for Day of month = Exact and Hour of day = Start of new day.
Example System Time State Time Example 1 17th December 2019 at 00: 00:00 HRS 17th January 2020 at 00: 00:00 HRS Example 2 17th December 2019 at 00: 01:00 HRS 18th January 2020 at 00: 00:00 HRS Example 3 17th December 2019 at 01: 00:00 HRS 18th January 2020 at 00: 00:00 HRS Following table shows the State time (time of life cycle state) result for different values used for Day of week and Hour of day parameters: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1645Charging User Guide Lifecycle manager Case Day of week Hour of day State time Case 1 Sunday to Saturday 0 to 23 No change in the existing implementation.
See Timer parameters on page 1585 for more details.
Case 2 Sunday to Saturday Exact No change in the existing implementation.
See Timer parameters on page 1585 for more details.
Case 3 Sunday to Saturday Start of new dayNo change in the existing implementation.
See Timer parameters on page 1585 for more details.
Case 4 Exact 0 to 23 Hour of Day is considered.
Now( )+offset( units, time Unit) with Hour OfDay and 00: 00.
Case 5 Exact Start of new dayBoth conditions with 00: 00 is considered.
Now( )+offset( units, time Unit) + Next Day with 00: 00.
Case 6 Exact Exact No change in the existing implementation.
See Timer parameters on page 1585 for more details.
7.7 Lifecycle state examination Overview The lifecycle check is done at the start of a data session to identify the state of the device, group, subscription, and account used for charging the session.
Barring handled by call control There are three types of barring handled by call control: •Device barring •Subscription barring •Group barring Device barring Device barring occurs when a device is in a state with the barring flag set to true.
In processing a credit control request (CCR) message, device barring is handled in various scenarios.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1646Charging User Guide Lifecycle manager If a device is barred in a CCR-I call, call control does not allow the request to be handled and does not forward it to the rating engine.
However, in the case of a barred device with an active session, call control forwards the request to the rating engine for further processing.
If a device is barred mid-session, the rating engine allows the commit of Used Service Units (USU) but does not allow any new reservation requests (RSU) received as part of the CCR-U call.
Instead, the result code NEW_RES_NOT_ALLOWED_DEVICE_BARRED is sent or in the case of an over commit, the result code CALL_OK_LOST_CREDIT_DEVICE_BARRED is sent, and the session is cleared by the rating engine.
In the same manner, a CCR-T with an over commit has the session cleared by the rating engine after the result code CALL_OK_LOST_CREDIT_DEVICE_BARRED is sent.
For a CCR-I / CCR-E, the barring flag check occurs when the device is identified.
If the device is in the state with the barring flag set to true, call control rejects the request and returns 5003 - DIAMETER_AUTHORIZATION_REJECTED with the error message ‘The device is in barring state.’ For a CCR-U / CCR-T, the barring flag check occurs in the middle of a Multiple-Services-Credit-Control (MSCC) validation.
When a CCR-U is processed and no MSCC or no USU is present and the device is barred, call control rejects the request and returns 5003 - DIAMETER_AUTHORIZATION_REJECTED with the error message ‘The device is in barring state’.
If there is a USU in the MSCC and the device is barred, the request is passed to Rating to commit the outstanding reservation.
For a CCR-T, the processing is normal.
The rating engine commits any USU and call control returns the result code CALL_OK .
Subscription barring Subscription barring occurs when a subscription is in a state with the barring flag set to true.
If a subscription linked to a device or a group is in a state with the barring flag set to true, it is not included in further execution.
If all subscriptions linked to a device or a group are in the state with the barring flag set to true, the result code ALL_SUBSCRIPTIONS_BARRED is sent to call control in a rating engine answer.
Note : The entity and period lifecycles for account and subscription are checked for barred state.
For a CCR-U, if all the subscriptions linked to a device are in the state with the barring flag set to true, the units to be reserved are rejected.
However, for a normal commit (commit that is already reserved or a partial commit), the rating engine returns the result code NEW_RES_ALLOWED_ALL_SUBSCRIPTIONS_BARRED and the session is cleared at the rating engine.
For an over commit quantity in the update request, the quantity is lost and the result code NOT_ENOUGH_LOST_CREDIT_SUB_BARRED is sent.
The session is cleared at the rating engine.
For a CCR-T, if all the subscriptions linked to a device are in a state with the barring flag set to true, the rating engine commits USU for outstanding reserved units and returns the result code CALL_OK .
The session is then cleared at the rating engine.
However, if all the subscriptions linked to a device are in a state with the barring flag set to true and there is an over commit quantity in the terminate request, the quantity is lost and the result code CALL_OK_LOST_CREDIT_SUB_BARRED is sent.
The session is cleared at the rating engine.
The following table lists the Diameter error messages sent when device barring or subscription barring occurs.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1647Charging User Guide Lifecycle manager Error message Description NEW_ RES_ NOT_ ALLOWED_ DEVICE_ BARRED Commit is complete for previous RSU but new reservation is not allowed as the device is barred.
CALL_ OK_ LOST_ CREDIT_ DEVICE_ BARRED Call is OK but over commit credit is lost because of a barred device.
NEW_ RES_ NOT_ ALLOWED_ ALL_ SUB_ BARRED Commit is complete for previous RSU but new reservation is not allowed as all attached subscriptions are barred.
CALL_ OK_ LOST_ CREDIT_ SUB_ BARRED Call is OK but over commit credit is lost because the subscription is barred.
CALL_ OK_ PARTIAL_ RESERVE_ SUB_ BARRED Call is OK but reservation is reduced because the subscription is barred.
NOT_ ENOUGH_ CREDIT_ SUB_ BARRED Call is rejected for not enough credit because the subscription is barred.
NOT_ ENOUGH_ LOST_ CREDIT_ SUB_ BARRED Call is rejected for not enough credit and over commit credit lost because the subscription is barred.
All_SUBSCRIPTIONS_ BARRED All subscriptions linked to the device are barred in case of Initial Request or Event Request with Direct Debit Action.
NO_ SUBSCRIPTION_ ATTACHED_ WITH_ DEVICE No subscription is linked to the device in case of Initial Request or Event Request with Direct Debit Action.
DB_SUBSCRIPTION_ LIST_ NOT_ FOUND No subscriptions are found in database.Table 180: Diameter error messages sent when barring occurs Group barring Group barring occurs when a group is in a state with the barring flag set to true.
In such scenario, the barred Group is not included in further execution.
Note : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1648Charging User Guide Lifecycle manager The entity lifecycle for group is checked for barred state.
For a CCR-I or Event Request with Direct Debit, the result code ALL_GROUPS_BARRED is sent to call control in rating engine answer for the following cases: •If the device has no subscriptions •At least one group has subscription(s) and all the groups having subscriptions are barred The groups with no subscriptions attached are ignored in barring check, that is, this (ALL_GROUPS_BARRED) result code is sent irrespective of whether groups with no subscriptions are active / barred.
In case of group hierarchy, the traversal order of top most group is respected.
This (ALL_GROUPS_BARRED) result code is sent when device has no subscriptions, and at least one group has subscriptions, and all the groups occurring first in the traversal order are barred.
Active groups with no subscriptions attached are ignored while traversing the groups in traversal order.
For a CCR-U, if the device has no subscriptions, and at least one group has subscription(s), and all the groups having subscriptions are barred, the units to be reserved are rejected.
However, for a normal commit (commit that is already reserved or a partial commit), the rating engine returns the result code NEW_RES_NOT_ALLOWED_GROUP_BARRED.
For an over commit quantity in the update request, the quantity is lost and the result code NOT_ENOUGH_LOST_CREDIT_GROUP_BARRED is sent.
In all such scenarios, the session is cleared at the rating engine.
For a CCR-T, the rating engine commits USU for outstanding reserved units and returns the result code CALL_OK for the following cases: •If the device has no subscriptions •At least one group has subscription(s) and all the groups having subscriptions are barred For an over commit quantity in the terminate request, the quantity is lost and the result code CALL_OK_LOST_CREDIT_GROUP_BARRED is sent.
In all such scenarios, the session is cleared at the rating engine.
Example 1: Scenarios when ALL_GROUPS_BARRED is sent Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1649Charging User Guide Lifecycle manager In the preceding diagram, ALL_GROUPS_BARRED is sent in CCR-I for the following configuration of Group hierarchy with barred Group: 1.Group 2 is barred and it may or may not have subscriptions.
Group 1 may or may not be barred and may or may not have subscriptions.
2.Group 3 is barred and it may or may not have subscriptions.
Group 1 may or may not be barred and may or may not have subscriptions.
3.Group 5 is barred and it may or may not have subscriptions.
4.At least one of the groups Group 1, Group 2, Group 3, Group 4 and Group 5 must have subscriptions attached.
Following is another set of configuration of Group hierarchy with barred Group for which ALL_GROUPS_BARRED is sent: 1.Group 2 is not barred and it does not have any subscriptions.
Group 1 is barred and it may or may not have subscriptions.
2.Group 3 is not barred and it does not have any subscriptions.
Group 4 is barred and it may or may not have subscriptions.
3.Group 5 is barred and it may or may not have subscriptions.
4.At least one of the groups Group 1, Group 4 and Group 5 must have subscriptions attached.
Example 2: Group barring scenario Consider that a Group (G1) has two devices D1 and D2.
The devices do not have any subscriptions but Group has two subscriptions S1 and S2 and each subscribed to 100 GB bundle.
Group subscription 1 (G1S1) is barred whereas Group subscription 2 (G1S2) is not barred.
Execute an IEC call with RSU 150 GB.
IEC call fails with result code 4012 (NOT_ENOUGH_CREDIT) The following table lists the Diameter error messages sent when group barring occurs.
Error Message Description ALL_ GROUPS_ BARREDSubscriptions are not attached to device and at least one group has subscriptions.
All the groups having subscriptions are barred in case of Initial Request or Event Request with Direct Debit Action.
NEW_ RES_ NOT_ ALLOWED_ GROUP_ BARRED Commit is complete for previous RSU, but new reservation is not allowed as no subscriptions areTable 181: Diameter error messages sent when group barring occurs Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1650Charging User Guide Lifecycle manager Error Message Description attached to device.
At least one group has subscriptions and all the groups having subscriptions are barred.
NOT_ ENOUGH_ LOST_ CREDIT_ GROUP_ BARREDCall is rejected for not enough credit and over commit credit lost as no subscriptions are attached to device.
At least one group has subscriptions and all the groups having subscriptions are barred.
CALL_ OK_ LOST_ CREDIT_ GROUP_ BARREDCall is OK but over commit credit is lost as no subscriptions are attached to device.
At least one group has subscriptions and all the groups having subscriptions are barred.Table 181: Diameter error messages sent when group barring occurs (continued) Barring handled by rating engine Rating engine handles the account barring.
If NCC identifies that an account is used for charging the data session, then the lifecycle state is checked to identify whether the account is in barred state.
If it is in barred state, then that account is not used for charging.
If there is no further resource available for charging, the call is dropped.
Note : The entity and period lifecycles for account and subscription are checked for barred state.
If a device has multiple subscriptions associated to multiple accounts, then the lifecycle state is checked for the account selected for charging the data session.
Example 1: Consider a case where the iPhone device has two subscriptions and the account of one bundle is in barred state.
In this case, partial reservation is done from the account that is in the active state.
In this example, let us consider that the Acc2 is in barred state, then the charging is done from the Acc1 account.
The following figure shows the iPhone device entity with subscriptions included: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1651Charging User Guide Lifecycle manager Example 2: Consider a case where the iPhone device has two subscriptions and the configuration is done in such a way that the charging is done from account first followed by next subscription bucket.
This can be done by setting priority in the charging services entity.
In this case, during a data session, the lifecycle state of account changes to barred state, then the charging is done from the subscription bucket.
Provision the following entities: Entity Task Create two charging services.
CS1 has high priority with no bucket and CS2 has low priority than CS1 but with a bucket.
Name: CS1, priority = 1 Charging services Name: CS2, priority = 10, Bucket69799, Initial value = 1000, Unit Type name = MByte Bundles Create two bundles and associate the charging services.
Account Create an account to associate with the bundles linked to the device.
Device Create a device and associate the bundles.
See the figures after the table for sample values.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1652Charging User Guide Lifecycle manager Result codes Different result codes are generated in case where the account is barred.
The account barring result code is considered when one or more account is barred during reservation.
The following table has the list of result codes for the account barred scenario: Request Type Scenario Rating result codeDiameter result codeRecord Event Result Tag ACCOUNT BARREDFULL RESERVATIONCALL_ OK RESUL T_ DIAMETER_ SUCCESS ( 2001)00 EVENT ACCOUNT BARREDNO RESERVATION NOT_ ENOUGH_ CREDIT_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ END_ USER_ SERVICE_ DENIED ( 4010)25 ACCOUNT BARREDPARTIAL RESERVATIONCALL_ OK_ PARTIAL_ RESERVE_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ LIMITED_ SUCCESS ( 2002)09 INITIAL ACCOUNT BARREDNO RESERVATION NOT_ ENOUGH_ CREDIT_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ END_ USER_ SERVICE_ DENIED ( 4010)25 UPDATE ACCOUNT BARREDFULL COMMIT/ NO RESERVATIONNEW_ RES_ NOT_ ALLOWED_RESUL T_ DIAMETER_ END_108Table 182: Result codes - Account barring Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1653Charging User Guide Lifecycle manager Request Type Scenario Rating result codeDiameter result codeRecord Event Result Tag ACCOUNT_ BARREDUSER_ SERVICE_ DENIED ( 4010) ACCOUNT BARREDFULL COMMIT/ PARTIAL RESERVATIONCALL_ OK_ PARTIAL_ RESERVE_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ LIMITED_ SUCCESS ( 2002)09 ACCOUNT BARREDFULL COMMIT/ FULL RESERVATIONCALL_ OK RESUL T_ DIAMETER_ SUCCESS ( 2001)00 ACCOUNT BARREDUNDER COMMIT/ NO RESERVATIONNEW_ RES_ NOT_ ALLOWED_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ END_ USER_ SERVICE_ DENIED ( 4010)108 ACCOUNT BARREDUNDER COMMIT/ FULL RESERVATIONCALL_ OK RESUL T_ DIAMETER_ SUCCESS ( 2001)00 ACCOUNT BARREDUNDER COMMIT/ PARTIAL RESERVATIONCALL_ OK_ PARTIAL_ RESERVE_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ LIMITED_ SUCCESS ( 2002)09 ACCOUNT BARREDOVER COMMIT/ NO RESERVATION/ CREDIT LOSSNEW_ RES_ NOT_ ALLOWED_ LOST_ CREDIT_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ END_ USER_ SERVICE_ DENIED ( 4010)26 ACCOUNT BARREDOVER COMMIT/ FULLCALL_ OK RESUL T_ DIAMETER_ SUCCESS ( 2001)00Table 182: Result codes - Account barring (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1654Charging User Guide Lifecycle manager Request Type Scenario Rating result codeDiameter result codeRecord Event Result Tag RESERVATION/ NO CREDIT LOSS ACCOUNT BARREDOVER COMMIT/ NO RESERVATION/ NO CREDIT LOSSNEW_ RES_ NOT_ ALLOWED_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ END_ USER_ SERVICE_ DENIED ( 4010)108 ACCOUNT BARREDOVER COMMIT/ PARTIAL RESERVATION/ NO CREDIT LOSSCALL_ OK_ PARTIAL_ RESERVE_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ LIMITED_ SUCCESS ( 2002)09 ACCOUNT BARREDFULL COMMIT CALL_ OK RESUL T_ DIAMETER_ SUCCESS ( 2001)00 ACCOUNT BARREDUNDER COMMIT CALL_ OK RESUL T_ DIAMETER_ SUCCESS ( 2001)00 ACCOUNT BARREDOVER COMMIT/ CREDIT LOSSCALL_ OK_ LOST_ CREDIT_ ACCOUNT_ BARREDRESUL T_ DIAMETER_ LIMITED_ SUCCESS ( 2002)10TERMINATE ACCOUNT BARREDOVER COMMIT/ NO CREDIT LOSSCALL_ OK RESUL T_ DIAMETER_ SUCCESS ( 2001)00Table 182: Result codes - Account barring (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1655Charging User Guide Lifecycle manager 7.8 Lifecycle timer extension Overview This feature is used to reschedule the current scheduled transitions in the lifecycle entities.
These scheduled transitions can be in both Entity and Period lifecycle of the entities.
The Validity Time parameter is added to all the lifecycle related entities.
It denotes the current transition’s validity time in the entity lifecycle of these entities.
This is a read only parameter and is not set/updated in the create/update requests of lifecycle entities.
It is only set internally by lifecycle state transitions.
At top-up (or at provisioning request), the validity of a subscription may need extension by a certain number of days.
When a user phone is unavailable (gone for repair), the validity of units is extended by the number of days the user phone is not available, instead of being reset.
Example : Bob subscribes to a subscription on 1st July and its valid for 30 days (30th of July).
After 10 days, a provisioning request is made to extend the validity for 15 days (valid till 14th August).
This is done using the REST API.
Note : Prorating is not considered for this feature.
REST API details Operators can use the UpdateTime REST API to adjust the end time and validity time of lifecycle of a given entity.
It is recommended to use this API for shared onetime non-periodic type of subscription.
The UpdateTime API is enhanced to consider the timezone ID of an account while updating the end date of a subscription.
The API has the following inputs: •Entity Type (Account/Subscription/Device/Group/User) •Entity Id (AccountID/BundleID/DeviceID/GroupID/UserID) •LifeCycleEntityType (Entity/Periodic) •Subscription Entity Type (Device/Group) → Mandatory when Entity Type is SUBSCRIPTION_TYPE .
•Subscription Entity ID (DeviceID/GroupID) → Mandatory when Entity Type is SUBSCRIPTION_TYPE .
•Entity Instance Id (Subscription Instance ID) → It is the subscription instance ID which is needed if multiple instance of same bundle exists within a given device/group.
This parameter is optional.
•Adjust Mode (INCR/DECR/SET) •Adjust Period Unit Type (Hour/Day/Week/Month/Year) → All types supported by Lifecycle are supported.
Note that it does not support Second and Minute Unit Type.
•Adjust Period Value (absolute value of a given type) •New Date (Applicable only for SET option) -> For this field, seconds, for example, Mar 26, 2019 05:28:50 cannot be given in this format.
The value of this parameter can be in this format - Mar 26, 2019 05:28 PM .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1656Charging User Guide Lifecycle manager If the Adjust Mode is equal to SET, then endtime/validity time = current Time + Adjust period Value.
With SET option, if Adjust Period Value and New Date both the parameters are provided, then New Date parameter is considered.
If this API is used with Periodic subscription, then Endtime for current bill cycle is adjusted, but next renewal cycle again synchronizes the subscription with bill cycle as defined in account.
For example, the bill cycle is on 5th of each month.
Current date of subscription is 30th July with Endtime as 04/08/2018 23:59:59.
Using this API, Endtime of this is updated to 10/08/2018 23:59:59.
On next renewal (which is on updated Endtime), the new Endtime is set as 04/09/2018 23:59:59.
Endtime of the subscription in PLC cannot be updated via updateTime/Lifecycle API if there is no end-time based scheduling.
Without the scheduling event, the API throws the following error: SMAPI_00001 (End time based transition is not scheduled currently.)
The given period is checked with respect to the current time.
For the Entity lifecycle, Validity time is only modified if the current state of a lifecycle has any current validity time available.
The modification to Endtime and Validity Time updates the corresponding update in the TEM module.
Note : The DECR or SET operation can make the new scheduled time less than or very close to the current system time.
Therefore, considering the TEM scanner interval time for scheduling tasks and other system processing time under load and other conditions, it is recommended to add a buffer/delta time to the current system time.
The New time = Current time + Delta.
The default value of delta is 60 seconds.
You can configure the delta using the System parameter - Scheduled transition time update buffer interval (in seconds) .
For more details regarding the API, see the Service Manager API Reference document.
7.9 Lifecycle EDR Overview NCC generates lifecycle EDRs to track changes that occur in lifecycle entities.
The lifecycle entities are accounts, subscriptions, devices, groups, and users.
Every lifecycle EDR contains attributes that identify the triggering event that caused the change and all the information related to the change that took place, including the transitions and states used.
Each lifecycle EDR corresponds to one triggering event but might contain records related to more than one entity.
Most commonly the lifecycle EDRs are triggered by lifecycle actions.
For more information on CDRs, see the CDR/EDR Reference .
7.
10 Lifecycle configuration Overview The lifecycle configuration enables you to define the flow and behavior of a lifecycle entity.
The suggested flow for configuring a lifecycle is as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1657Charging User Guide Lifecycle manager •Devise the list of required behaviors for a lifecycle entity based on the characteristics required for this entity.
•Decide what lifecycle type is needed.
•Begin by creating the list of states that can define the behavior for this entity in the lifecycle of a particular type.
•Choose events that invoke transitions between the above states.
•Add actions that have to be executed during the transitions.
•Give a lifecycle a meaningful name.
•Associate this lifecycle to the lifecycle entity it is configured for.
Note : Once a lifecycle is created, it cannot be deleted.
Lifecycles in SM GUI In the SM GUI, transitions are represented through states.
To configure a transition, you select a state where this transition starts from.
The selected state becomes Start State of this transition.
When Start State is selected, complete the configuration and enter the remaining parameters of this transition.
Use the following fields for the transition parameters: •Event for the transition name.
•Upon for the event that triggers this transition.
•Go to for End State.
7.
11 Account lifecycle configuration Overview The system supports ENTITY and PERIOD lifecycles for accounts.
You can configure various ENTITY and various PERIOD lifecycles for accounts.
You can associate an account with any ENTITY and PERIOD lifecycle of your choice.
However, you can associate an account only with one lifecycle of each type: one ENTITY lifecycle and one PERIOD lifecycle.
If you do not assign an ENTITY lifecycle and a PERIOD lifecycle to an account, the system assigns DefaultAccountLifeCycle and DefaultAccountBillingCycle to that account.
Note : Once a lifecycle is created, it cannot be deleted.
The time zone ID defined in an account considers the following points: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1658Charging User Guide Lifecycle manager •For period lifecycle, when an account is reset or the status is changed, the related time (that is the creation time, start time, or end time) of the account considers the timezone of the account.
•For entity lifecycle of an account, the related time (that is the creation time and validity time) considers the timezone of the account.
Account ENTITY lifecycle configuration The following table describes the configuration of ENTITY lifecycles for accounts.
Parameter Description Mandatory / Optional Name Defined by you, should not exceed 64 characters.Mandatory Type Must be set to ENTITY, that is, Object Status lifecycle.Mandatory Applicable to Must be set to Account.
Mandatory States Must contain at least one state.
Must contain exactly one state marked as initial.
Defined and configured by you.
For information on state configuration, see the State parameters on page 1581 section.Mandatory Transitions Defined and configured by you.
For information on transition configuration, see the Transition parameters on page 1582 section.
For information on timer configuration, see the Timer parameters on page 1585 section.
For information on actions, see the Actions associated with lifecycles on page 1609 section.OptionalTable 183: Account ENTITY lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1659Charging User Guide Lifecycle manager Parameter Description Mandatory / Optional For information on events, see the Events associated with lifecycles on page 1601 section.Table 183: Account ENTITY lifecycle configuration (continued) Account PERIOD lifecycle configuration The following table describes the configuration of PERIOD lifecycles for accounts.
Parameter Configuration Mandatory / Optional Name Defined by you, should not exceed 64 characters.Mandatory Type Must be set to PERIOD, that is Bill Cycle.Mandatory Applicable to Must be set to Account.
Mandatory Timer Value Value of the timer.
Mandatory Timer Units Unit used for the timer.
Supported values are - Seconds, Minutes, Hours, Days, Weeks, Months, Years.Mandatory States Must contain at least one state.
Must contain exactly one state marked as initial.
Defined and configured by you.
For information on state configuration, see the State parameters on page 1581 section.Mandatory Transitions Defined and configured by you.
OptionalTable 184: Account PERIOD lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1660Charging User Guide Lifecycle manager Parameter Configuration Mandatory / Optional For information on transition configuration, see the Transition parameters on page 1582 section.
For information on timer configuration, see the Timer parameters on page 1585 section.
For information on actions, see the Actions associated with lifecycles on page 1609 section.
For information on events, see the Events associated with lifecycles on page 1601 section.Table 184: Account PERIOD lifecycle configuration (continued) 7.
12 Subscription lifecycle configuration Overview The system supports ENTITY and PERIOD lifecycles for subscriptions.
The subscription lifecycles are defined under the bundle that a subscription refers to.
Subscriptions cannot be directly associated with a lifecycle, but they can reference the lifecycles of their bundles.
As a lifecycle entity, a subscription must be related to an ENTITY lifecycle.
If you do not provide an ENTITY lifecycle for a subscription, the system associates this subscription with DefaultSubscriptionLifeCycle.
The PERIOD lifecycle is optional for subscriptions.
However, if the bundle, that a subscription refers to, defines the billing cycle information and no input is provided for PERIOD lifecycle, then the system assigns DefaultSubscriptionBillingCycle to that bundle.
If you do not provide a PERIOD lifecycle for a subscription and the bundle does not define any billing information, this subscription is associated with its ENTITY lifecycle only.
You can configure various ENTITY and various PERIOD lifecycles for subscriptions.
You can provide a subscription with any ENTITY and PERIOD lifecycle of your choice.
However, you can associate a subscription only with one lifecycle of each type: one ENTITY lifecycle and one PERIOD lifecycle.
Note : Once a lifecycle is created, it cannot be deleted.
The time zone ID defined in an account considers the following points: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1661Charging User Guide Lifecycle manager •For period lifecycle, when a subscription is purchased, renewed, or its status is changed, the related time (that is the creation time, start time, or end time) of the subscription considers the timezone of the account.
•For entity lifecycle of a subscription, the related time (that is the creation time and validity time) considers the timezone of the account.
Subscription ENTITY lifecycle configuration The following table describes the configuration of ENTITY lifecycles for subscriptions.
Parameter Configuration Mandatory / Optional Name Defined by you, should not exceed 64 charactersMandatory Type Must be set to ENTITY, that is, Object Status Lifecycle.Mandatory Applicable to Must be set to Subscription.
Mandatory States Must contain at least one state.
Must contain exactly one state marked as initial.
Defined and configured by you.
For information on state configuration, see the State parameters on page 1581 section.Mandatory Transitions Defined and configured by you.
For information on transition configuration, see the Transition parameters on page 1582 section.
For information on timer configuration, see the Timer parameters on page 1585 section.
For information on actions, see the Actions associated with lifecycles on page 1609 section.OptionalTable 185: Subscription ENTITY lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1662Charging User Guide Lifecycle manager Parameter Configuration Mandatory / Optional For information on events, see the Events associated with lifecycles on page 1601 section.Table 185: Subscription ENTITY lifecycle configuration (continued) Attention : The “Start Cycle” event is not available in the DefaultSubscriptionLifeCycle when you upgrade NCC.
But, this “Start Cycle” event is available in the DefaultSubscriptionLifeCycle for fresh installation of NCC.
For example, the “Start Cycle” event is not available in the DefaultSubscriptionLifeCycle when you upgrade charging application from 18.9 to 19.0 release.
But, the “Start Cycle” is available in the DefaultSubscriptionLifeCycle for fresh installation of charging application from 19.0 release.
Subscription PERIOD lifecycle configuration The following table describes the configuration of PERIOD lifecycles for subscriptions.
Parameter Configuration Mandatory / Optional Name Defined by you, should not exceed 64 charactersMandatory Type Must be set to PERIOD, that is, Bill Cycle.Mandatory Applicable to Must be set to Subscription.
Mandatory Timer Value Value of the timer Mandatory Timer Units Unit used for the timer.
Supported values are - Seconds, Minutes, Hours, Days, Weeks, Months, Years.Mandatory States Must contain at least one state.
MandatoryTable 186: Subscription PERIOD lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1663Charging User Guide Lifecycle manager Parameter Configuration Mandatory / Optional Must contain exactly one state marked as initial.
Defined and configured by you.
For information on state configuration, see the State parameters on page 1581 section.
Transitions Defined and configured by you.
For information on transition configuration, see the Transition parameters on page 1582 section.
For information on timer configuration, see the Timer parameters on page 1585 section.
For information on actions, see the Actions associated with lifecycles on page 1609 section.
For information on events, see the Events associated with lifecycles on page 1601 section.OptionalTable 186: Subscription PERIOD lifecycle configuration (continued) Examples Example 1: Addition of promotional bundle using subscription lifecycle Bob purchases a special bundle.
A promotional bundle is added automatically to his device.
For this case, the account, device, subscription entities are configured and associated with their relative lifecycle entities.
Trigger the account lifecycle to attach a special bundle to the device.
A promotional bundle gets automatically attached to the device.
For this case, configure the following entities.
Ensure that Bundle1 is linked to the account before triggering the account lifecycle event.
Entity Task Charging Services Create the charging services ( CSPromo, CSSpecial, CS1) .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1664Charging User Guide Lifecycle manager Entity Task Name : CSPromo, Priority : 3, Category : Default Category, Bucket : Promo Bucket, Initial Value : 100, Unit Type Name : Byte and tariff: Name : CSSpecial, Priority : 2, Category : Default Category, Bucket : Special Bucket, Initial Value : 2000, Unit Type Name : Byte and tariff: Name : CS1, Priority : 1, Category : Default Category, Bucket : Bucket1, Initial Value : 3000, Unit Type Name : Byte and tariff: Bundles Create bundles ( Bundle1, Promo Bundle, Special Bundle) .
Associate the Bundle1 to the device.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1665Charging User Guide Lifecycle manager Entity Task Name : Bundle1, Fee: 100, Charging Service List : CS1, Object Status Lifecycle : Default Subscription LifeCycle Name : Promo Bundle, Fee: 0, Charging Service List : CSPromo, Object Status Lifecycle : Default Subscription LifeCycle Name : Special Bundle, Fee: 100, Charging Service List : CSSpecial, Object Status Lifecycle : Default Subscription LifeCycle Lifecycles Create an account lifecycle with Name : Account Entity LC_Special Bundle Purchase, Type : Object Status Lifecycle, Applicable to : Account.
See the figures after the table for more details on states.
Account Create an account and link the Account Entity LC_Special Bundle Purchase lifecycle.
Device Create a device and associate the Default Device LifeCycle and Bundle1.
Lifecycles (AccountEntityLC_SpecialBundlePurchase): Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1666Charging User Guide Lifecycle manager Device before triggering account lifecycle The following figure shows the bundle attached to the device before triggering the account lifecycle (AccountEntityLC_SpecialBundlePurchase).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1667Charging User Guide Lifecycle manager Device after triggering account lifecycle The following figure shows the bundles attached to the device after triggering the account lifecycle (AccountEntityLC_SpecialBundlePurchase).
You can see that when Bob purchases special bundle, promotional bundle get attached to the device along with the already attached bundle.
7.
13 Device lifecycle configuration Overview The system supports only the ENTITY lifecycle for devices.
As a lifecycle entity, a device must be associated with an ENTITY lifecycle.
If you do not associate an ENTITY lifecycle with a device, then the system associates this device with DefaultDeviceLifeCycle.
You can configure various ENTITY lifecycles for devices and choose any of them to associate with a device.
You can associate a device only with one ENTITY lifecycle.
Note : Once a lifecycle is created, it cannot be deleted.
Device ENTITY lifecycle configuration The following table describes the configuration of the ENTITY lifecycle for devices.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1668Charging User Guide Lifecycle manager Parameter Configuration Mandatory / Optional Name Defined by you, should not exceed 64 charactersMandatory Type Must be set to ENTITY, that is, Object Status Lifecycle.Mandatory Applicable to Must be set to Device.
Mandatory States Must contain at least one state.
Must contain exactly one state marked as initial.
Defined and configured by you.
For information on state configuration, see the State parameters on page 1581 section.Mandatory Transitions Defined and configured by you.
For information on transition configuration, see the Transition parameters on page 1582 section.
For information on timer configuration, see the Timer parameters on page 1585 section.
For information on actions, see the Actions associated with lifecycles on page 1609 section.
For information on events, see the Events associated with lifecycles on page 1601 section.OptionalTable 187: Device ENTITY lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1669Charging User Guide Lifecycle manager 7.
14 Group lifecycle configuration Overview The system supports only the ENTITY lifecycle for groups.
As a lifecycle entity, a group must be associated with an ENTITY lifecycle.
If you do not associate an ENTITY lifecycle with a group, the system associates this group with DefaultGroupLifeCycle.
You can configure various ENTITY lifecycles for groups and choose any of them to associate with a group.
You can associate a group only with one ENTITY lifecycle.
Note : Once a lifecycle is created, it cannot be deleted.
Group ENTITY lifecycle configuration The following table describes the configuration of the ENTITY lifecycle for groups.
Parameter Configuration Mandatory / Optional Name Defined by you, should not exceed 64 charactersMandatory Type Must be set to ENTITY, that is, Object Status Lifecycle.Mandatory Applicable to Must be set to Group.
Mandatory States Must contain at least one state.
Must contain exactly one state marked as initial.
Defined and configured by you.
For information on state configuration, see the State parameters on page 1581 section.Mandatory Transitions Defined and configured by you.
OptionalTable 188: Group ENTITY lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1670Charging User Guide Lifecycle manager Parameter Configuration Mandatory / Optional For information on transition configuration, see the Transition parameters on page 1582 section.
For information on timer configuration, see the Timer parameters on page 1585 section.
For information on actions, see the Actions associated with lifecycles on page 1609 section.
For information on events, see the Events associated with lifecycles on page 1601 section.Table 188: Group ENTITY lifecycle configuration (continued) 7.
15 User lifecycle configuration Overview The system supports only the ENTITY lifecycle for users.
As a lifecycle entity, a user must be associated with an ENTITY lifecycle.
If you do not associate an ENTITY lifecycle with a user, the system associates this user with DefaultUserLifeCycle.
You can configure various ENTITY lifecycles for users and choose any of them to associate with a user.
You can associate a user only with one ENTITY lifecycle.
Note : Once a lifecycle is created, it cannot be deleted.
User ENTITY lifecycle configuration Parameter Configuration Mandatory / Optional Name Defined by you, should not exceed 64 charactersMandatoryTable 189: User ENTITY lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1671Charging User Guide Lifecycle manager Parameter Configuration Mandatory / Optional Type Must be set to ENTITY, that is, Object Status Lifecycle.Mandatory Applicable to Must be set to User.
Mandatory States Must contain at least one state.
Must contain exactly one state marked as initial.
Defined and configured by you.
For information on state configuration, see the State parameters on page 1581 section.Mandatory Transitions Defined and configured by you.
For information on transition configuration, see the Transition parameters on page 1582 section.
For information on timer configuration, see the Timer parameters on page 1585 section.
For information on actions, see the Actions associated with lifecycles on page 1609 section.
For information on events, see the Events associated with lifecycles on page 1601 section.OptionalTable 189: User ENTITY lifecycle configuration (continued) 7.
16 Bucket lifecycle configuration Bucket lifecycle entity has a PERIOD lifecycle associated with it.
By default, the lifecyle type of Bucket is PERIOD.
Note : The lifecycle type of bucket cannot be changed.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1672Charging User Guide Lifecycle manager Bucket PERIOD lifecycle configuration Parameter Configuration Mandatory / Optional Name Defined by you, should not exceed 64 charactersMandatory Description This parameter provides the description for the bucket lifecycle.
Lifecycle Type By default, it is set to PERIOD.
Note : The lifecycle type of bucket cannot be changed.Mandatory Default length This parameter indicates the value of the unit.
The minimum value should be 0.Mandatory Unit This parameter provides the unit of the default length.
It has the following values: •Second •Hour •Day •Week •Month •YearMandatory States Must contain at least one state.
Must contain exactly one state marked as initial.
Defined and configured by you.MandatoryTable 190: Bucket PERIOD lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1673Charging User Guide Lifecycle manager Parameter Configuration Mandatory / Optional For information on state configuration, see the State parameters on page 1581 section.Table 190: Bucket PERIOD lifecycle configuration (continued) 7.
17 Counter lifecycle configuration Counter lifecycle entity has a PERIOD lifecycle associated with it.
By default, the lifecyle type of counter is PERIOD.
Note : The lifecycle type of counter cannot be changed.
For global counters (that is, Device, Group, Device Group, multi-bundle counters), only one counter in a category can have its own lifecycle.
For example, if multiple device counters are associated, then only one device counter can have its own lifecycle and the others cannot have their own lifecycle.
In a subscription, only one counter can have its lifecycle and all other counters in that subscription cannot have their own lifecycle.
Associate any other subscription counters having their own lifecycle via different subscriptions, so that one subscription has only one counter with its lifecycle.
Counter PERIOD lifecycle configuration Parameter Configuration Mandatory/ Optional Name Define a name for the counter lifecycle.
It should not exceed 64 characters.
Mandatory Description This parameter provides the description for the counter lifecycle.
Optional Lifecycle Type By default, it is set to PERIOD.
Note : The lifecycle type of counter cannot be changed.Mandatory Default length This parameter indicates the value of the unit.
The minimum value should be 0.MandatoryTable 191: Counter PERIOD lifecycle configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1674Charging User Guide Lifecycle manager Parameter Configuration Mandatory/ Optional Unit This parameter provides the unit of the default length.
It has the following values: •Second •Hour •Day •Week •Month •YearMandatory States It must contain exactly one state marked as initial.
For more information on state configuration, see the State parameters on page 1581 section.MandatoryTable 191: Counter PERIOD lifecycle configuration (continued) 7.
18 Account, subscription, and device lifecycle support for sending notification without a user object for device Overview This feature provides the flexibility to send notification through a lifecycle event using the SendNotification action without a USER configuration.
The processing of sending notification through a lifecycle event is performed by SendNotification action in NCC and this action is applicable in account, subscription, device and group entities.
When configured in account and subscription entities, the USER entity defines the association between the funded account and devices.
Therefore, using the USER entity, devices are identified to send notification and thus, user configuration is considered mandatory to send notification.
However, if a service operator requests not to define any user entity with device or does not want to define any association in an account entity, then this feature would provide the required flexibility to send notification without a user configuration.
Note : The "No user configuration" is invalid in case the notification server is configured for SMS or emails.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1675Charging User Guide Lifecycle manager Configuration A new flag Disable_User_Configuration has been added in the notification rule set in a lifecycle rule configuration to disable the user configuration as shown in the following figure: If this flag is configured, then irrespective of whether user is provisioned, it is not used while notification processing.
If the application preference No User Notification is enabled, then Disable-User-Configuration flag is irrelevant at action level.
The Disable-User-Configuration flag is taken into account only when the No User Notification application preference is disabled.
7.
19 Applying device attachment event for the specific traffic scenarios By default, device attachment is triggered by all types of traffic.
This feature enables the operator to trigger device attachment lifecycle event based on specific traffic scenarios described as follows: •For PS charging: 32251@3gpp.org (GY) •For IMS charging: 32260@3gpp.org.
The following sub-types are also supported: –IMS-MOC: Role of Node = 0 –IMS-MTC: Role of Node = 1 –IMS-FWD: Role of Node = 2 or 0 and MMTel Service Type = 6 •For MMS charging: 32270@3gpp.org •For SMS charging: 32274@3gpp.org Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1676Charging User Guide Lifecycle manager Rule configuration Source context The Device life cycle state can be configured in the condition attribute Entity-LifeCycle_State in the GY_PRE_PROCESSING trigger and SPR_DEVICE result context.
The lifecycle event is triggered only if the Device is in pre-active state.
Result context The action attribute Trigger-Life-Cycle-Event is available for the triggers GY_PRE_PROCESSING and RESOURCE_POST_PROCESSING , in the result contexts GY_PRE_PROCESSING and RESOURCE_POST_PROCESSING , respectively.
The value of this attribute can be set to a custom string based on the configured condition.
It is available only for Device life cycle.
The following table provides some example usages of the attribute: Trigger Result context Example GY_PRE_ PROCESSING GY_PRE_ PROCESSING GY_PRE_ PROCESSING.
Trigger- Life- Cycle- Event ( "activate Device" , Trigger LifeCycle Entity Type AsDevice_ DEVICE) RESOURCE_ POST_ PROCESSINGRESOURCE_ POST_ PROCESSINGRESOURCE_ POST_ PROCESSING.
Trigger- Life- Cycle- Event ( "activate Account" , Trigger LifeCycle Entity Type AsAccount_ ACCOUNT) 7.20 Defining renewal priority of subscriptions associated with an account A subscription can either align to the funding account for its periodic renewal or have its own periodic renewal.
When the account is renewed, the subscriptions linked with the account are renewed randomly.
There is no order in which the subscriptions are processed.
If the renewal fee is configured, then the cumulative fee is calculated for all the linked subscriptions, and the subscriptions are renewed successfully only if the account balance is sufficient for their renewal.
Currently, this feature provides the functionality to configure a bundle as mandatory or optional bundle.
The optional bundles are not renewed if a mandatory bundle funded by the same account is suspended, or the account balance is insufficient to fund their renewal.
If multiple mandatory bundles are subscribed by the same account, and if any of them are suspended, then none of the mandatory or optional bundles are renewed until the account balance is sufficient to fund all the mandatory bundles.
This feature allows the renewal of the subscriptions to be processed in a controlled manner by defining the renewal priority.
The renewal priority of the bundles can be configured using Renewal Priority parameter in the Service (Bundle) entity.
It defines the order in which a subscription is renewed through account lifecycle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1677Charging User Guide Lifecycle manager Note : For details on configuring Renewal Priority parameter, see Basic Details on page 1335 .
This feature can be controlled using the application preference Controlled Renewal Sequence (refer to section Managed Element application preferences in the Global Configuration Guide ).
Optional bundles can be subscribed or renewed for additional services based on their renewal priority.
They cannot be subscribed or renewed if a mandatory bundle funded by the same account is suspended.
If there are no suspended mandatory bundles, and there are multiple optional bundles in suspended state, then the optional bundles are renewed in the following order: 1.Subscriptions without their own period lifecycle (that is, which renew at the account BCR) are renewed based on the bundle renewal priority.
2.If there are multiple optional bundles with the same bundle renewal priority, then they are renewed based on the subscription creation time.
Subscriptions with an earlier creation time have higher priority and are renewed first.
Subscriptions having same renewal priority and creation time are renewed randomly.
Note : It is not mandatory to categorize bundles as mandatory bundles.
All the bundles associated with an account can be categorized as optional bundles and they are renewed according to their renewal priority.
This feature only supports mandatory bundles which do not have their own period lifecycle.
That is, mandatory bundles are renewed at the account BCR.
Warning : If this feature is enabled and subscriptions are created for mandatory bundles which have their own period lifecycles, then the system behavior is unpredictable.
Versioning: •When versioning is enabled, updating the Renewal Priority for a bundle is applicable for the new version creation as well as the backdated update (That is, updating the latest published version).
In this case, the existing subscriptions are updated with new renewal priority as per the versioning configuration.
That is, if configured as IMMEDIATE , then the applicable subscriptions are updated with the new renewal priority upon first network event.
If configured to update at next BCR, then the applicable subscriptions are updated with new renewal priority at the upcoming BCR •When entity versioning is not enabled, updates to the Renewal Priority are not applied to the existing subscriptions.
Updates are applied to subscriptions that are created after the bundle has been updated.
Configuration The application preference Controlled Renewal Sequence is used to provide the functionality to control the renewal sequence of the subscriptions.
This application preference can take the following values: •VIA_ACCOUNT : If this value is configured, then the subscriptions are renewed as per their renewal priority governed by account renewal.
Bundles can be categorized as mandatory or optional bundles.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1678Charging User Guide Lifecycle manager •DISABLED : If this value is configured, then the existing behavior of subscription renewal is applicable (that is, either all subscriptions are renewed or no subscription is renewed).
For details on configuring the application preference Controlled Renewal Sequence , see ME application preferences section in Global Configuration Guide .
Examples Use case 1: Configuration: •Application preference Controlled Renewal Sequence is set to VIA_ACCOUNT .
•Application preference Allow bundle addition to accounts with insufficient balance is enabled.
•Account A1 is linked with following subscriptions for a single device: –Subscription S1 to a mandatory bundle B1 (that is, bundle renewal priority order = 0) with bundle fee of $40.
B1 does not have any periodic lifecycle.
The entity lifecycle is configured in such a way that when it moves to the suspended state, the device is also barred, blocking all usage.
–Subscription S2 to a mandatory bundle B2 (that is, bundle renewal priority order = 0) with bundle fee of $10.
It does not have any periodic lifecycle.
–Subscription S3 to an optional bundle B3 with a bundle renewal priority of 1 and bundle fee of $10.
This bundle has its own period lifecycle and renews every 30 days.
–Subscription S4 to an optional bundle B4 with a bundle renewal priority of 2 and bundle fee of $5.
This bundle has its own period lifecycle and renews every 30 days.
Current State: •All 4 subscriptions are in Active state.
•Next renewal date of S3 is occurring before the next BCR date of the account.
•Next renewal date of S4 is occurring after the next BCR date of the account.
•The current balance of the account is $50.
Execution: •On renewal event of subscription S3, it is renewed successfully.
Its renewal fee (that is, $10) is deducted from the account balance.
Therefore, the available balance is $40.
•When the account BCR occurs, both the mandatory subscriptions (S1 and S2) move to suspended state because the current account balance is insufficient to fund their renewal.
Due to its failure to renew, S1's transition of its entity lifecycle to the suspended state triggers an action barring usage for the device.
•The final renewal EDR includes information of both the subscriptions, S1 and S2.
•On renewal event of S4, its renewal fails as both the mandatory subscriptions are suspended and account balance is insufficient to renew all the mandatory subscriptions.
A Subscription Renewal Failed EDR is generated for the S4 with the code mandatory bundle suspended .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1679Charging User Guide Lifecycle manager •On next renewal event of S3, its renewal fails as both the mandatory subscriptions are suspended.
A Subscription Renewal Failed EDR is generated for S3 with a reason code mandatory bundle suspended .
•Bundle B1 is subscribed again creating Subscription S5.
Account Balance (40) is sufficient for the bundle purchase, but since mandatory subscriptions S1 and S2 are suspended, subscription S5 is created in suspended state.
Account balance remains the same ($40).
•Account is recharged with an additional $55, resulting in a total balance as $95.
This recharge triggers the following logic: –Mandatory subscriptions (S1 and S2) are successfully renewed, and mandatory subscription (S5) is successfully activated.
Account balance is reduced to $5.
1.On successful renewal/activation of mandatory subscriptions, the account BCR start date is aligned to the recharge date so that the next renewal occurs after the period defined in account PLC, from the recharge date.
2.As a result of mandatory subscription moving to the active state, its entity lifecycle triggers unbarring access to the device so that usage is again allowed.
3.Since subscription S5 is activated for the first time after creation, there is no impact on remainingRenewals parameter for this subscription.
4.After successful renewal, success EDR is generated.
The final renewal EDR includes information on all three subscriptions which were renewed succesfuly.
The information of subscriptions S1 and S2 is dumped under subscriptionsRenewedByAccountRenewal , while subscription S5 information is dumped under subscriptionsActivatedByAccountRenewal as this subscription becomes active for first time through account renewal.
–S3 is not renewed as account current balance (that is, $5) is insufficient to fund its renewal fee of $10.
–S4 is renewed successfully and the account available balance is reduced to zero.
Also, S4 is updated so that its next renewal occurs 30 days from the recharge date.
•After 1 day, A1 is recharged again with an additional $10, resulting in successful renewal of S3.
S3 is updated so that its next renewal occurs 30 days from the recharge date.
Note : For details on EDR, see CDR/EDR Reference Guide .
Use case 2: Configuration: •NCC is on an older release.
•Account A1 is linked with following subscriptions for a single device: –Subscription S1 to bundle B1 with bundle fee as $40.
B1 does not have any periodic lifecycle.
Entity lifecycle is configured in such a way that when it moves to the suspended state, the device is also barred, blocking all usage.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1680Charging User Guide Lifecycle manager –Subscription S2 to bundle B2 with bundle fee of $5.
B2 does not have any periodic lifecycle and it renews upon funding monthly BCR of the account.
–Subscription S3 to bundle B3 with bundle fee of $10.
This bundle has its own period lifecycle and renews every 30 days.
Current State: •All 3 subscriptions are in Active state.
•The current balance of the account is $45.
•NCC is upgraded to release which contains this feature deployment.
•Application preference Controlled Renewal Sequence is set to DISABLED .
•Entity Versioning is enabled.
•The entity lifecycle of mandatory subscriptions is updated.
Note : For details on recommended lifecyle configuration for this feature, see Lifecycle configuration on page 1683 .
Execution: •Upon NCC release upgrade, the bundles (B1, B2 and B3) become mandatory bundles and their bundle renewal priority order is set to 0.
•Assuming that the mandatory bundle should not have its own PLC, bundle b3 is updated by the external system to have a non-zero bundle renewal priority to make it optional.
•Application preference Controlled Renewal Sequence is set to VIA_ACCOUNT .
•After the upgrade and update, there are two mandatory bundles (B1 and B2) and one optional bundle B3.
•From this point of execution, the behavior described in Use Case 1 is followed.
Important points Note the following important points about this feature: •At the time of renewal, the fee is deducted immediately only when the account is pre-paid.
In case of post-paid accounts, the application preference Deduct Postpaid Fee Flag should be configured to have similar functionality.
•With this feature deployment, all bundles become mandatory by default.
hence, if this feature is enabled, then all bundles configured with their own renewal should be modified to optional bundles.
•The functionality to define the subscription renewal priority is not supported in Template.
•This feature is applicable only for device.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1681Charging User Guide Lifecycle manager •If multiple subscriptions are funded through the same account, then the renewal priority is considered only for the subscriptions whose renewal is governed through account lifecycle.
Other subscriptions which are renewed through their own lifecycle are not considered.
•If the device has multiple subscriptions out of which only one is mandatory, and currently in suspended state, then it should not be deleted.
If it is deleted, then the device (which is also in barred state) cannot transition to active state again.
The device can only be activated by external provisioning API.
Note : This is valid only if lifecycle is configured to bar the device on mandatory subscription suspension.
•Account renewal upon subscription deletion happens only when the subscription is deleted from the database, and not through deletion API execution (which moves the subscription to final state).
•If the subscription is suspended because of insufficient balance at the time of its creation, then it is activated through account renewal by default.
Note : This is valid if Allow bundle addition to accounts with insufficient balance feature is enabled.
For more details on Allow bundle addition to accounts with insufficient balance , see Allow bundle addition to accounts with insufficient balance on page 1740 .
•If an optional bundle with a periodic lifecycle has the parameter Formatted Input Date set, and the optional bundle moves from suspended state to active upon account recharge, then consider the following scenarios: –If the Formatted Input Date has a non-zero minute value, then the Formatted Input Date value is updated to the current recharge time (including the current hour and current minute).
–If the Formatted Input Date has a zero minute value and a non-zero hour value, then the Formatted Input Date value is updated to the current recharge date with hours (with minutes value set to zero).
–If the Formatted Input Date has both zero hour and zero minutes value, then the Formatted Input Date value is updated to the current recharge date (with hours and minutes values set to zero).
•If the mandatory bundles are renewed successfully but renewal of optional bundles fails because of insufficient balance, then account renewal is considered to be successful.
•The AccountRechargeEvent should be configured in account and bundle lifecycles, so that when the account is recharged successfully, the suspended bundles are renewed based on the available account balance, and account BCR date is updated based on the current renewal date and time.. •Renewal fee of the subscription should be same as bundle fee that is defined at the time of creating the subscription.
The RenewSubscriptionAction configured in account and subscription lifecycles does not define any other renewal fee.
•EDR enhancements done under the scope of this feature are applicable only for generic schema.
There is no change/adoption at DR. Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1682Charging User Guide Lifecycle manager •If an inactive mandatory bundle is changed to optional bundle using change plan, then the device remains in the inactive state, and account remains in the suspended state.
•Updating anything through provisioning on bundle (for example, fee or renewal priority) does not trigger lifecycle transition defining the account renewal or the device barring/unbarring changes.
7.20.
1 Lifecycle configuration The following lifecycle transitions should be configured in addition to the existing transitions for this feature to work Account period lifecycle configuration Following is the account periodic lifecycle configuration required for this feature: Transition Start state Event name Action and configurationGo-to stateRemarks Start Cycle Event Reset Period Action Start Repeat Cycle Event Timer = End TimeRenew Subscription Action Allow Event Broadcast = true Ignore Barred Device or Group = trueStart Subscription Renewed EventReset Period Action Start NotEnough Funds Event - SuspendedStart ( Initial state) Account Recharge Event Renew Subscription Action Allow Event Broadcast = true Ignore Barred Device or Group = trueStart Configure if renewal and BCR alignment with respect to recharge date and time is required Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1683Charging User Guide Lifecycle manager Transition Start state Event name Action and configurationGo-to stateRemarks on balance adjustment.
Subscription Delete Event Renew Subscription Action Allow Event Broadcast = true Ignore Barred Device or Group = trueStart Configure if renewal and BCR alignment with respect to deletion date and time is required on mandatory subscription deletion.
Account Recharge Event Renew Subscription Action Allow Event Broadcast = true Ignore Barred Device or Group = trueSuspended Configure if renewal and BCR alignment with respect to recharge date and time is required on balance adjustment.
Subscription Renewed EventReset Period Action StartSuspended ( Unbarred/ Barred state based on customer use case) Subscription Delete Event Renew Subscription Action Allow Event Broadcast = true Ignore Barred Device or Group = trueSuspended Configure if renewal and BCR alignment with respect to deletion date and time is required on mandatory subscription deletion.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1684Charging User Guide Lifecycle manager Transition Start state Event name Action and configurationGo-to stateRemarks Subscription Success Creation Event (Custom Event)Reset Period Action Start Mandatory subscription entity lifecycle configuration Following is the recommended configuration for mandatory subscription entity lifecycle governed by account BCR: Transition Start state Event name Action and configurationGo-to stateRemarks Start Cycle Event Timer = 0 secondsTrigger Event Action ["Start Cycle Event" , Type = PERIOD]Start NotEnough Funds Event Accept Broadcast Message = trueTrigger Event Action ["Device Barring Event] ( Custom Event) ] Allow Event Broadcast = trueInactive This action is configured for device barring.Start ( Initial state) Mandatory Subscription Suspended EventTrigger Event Action ["Device Barring Event] ( Custom Event) ]Inactive This action is configured for device barring.
For details on Mandatory Subscription Suspended Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1685Charging User Guide Lifecycle manager Transition Start state Event name Action and configurationGo-to stateRemarks Allow Event Broadcast = trueEvent , see Events associated with lifecycles on page 1601 .
NotEnough Funds With Mandatory Active Event- Inactive Subscription Added EventTrigger Event Action ["Subscription Success Creation Event] ( Custom Event) ] Allow Event Broadcast = trueStart This is to indicate successful creation of mandatory subscription.
It makes the device active, and aligns it to account BCR.
Subscription Renewed Event Accept Broadcast Message = trueTrigger Event Action ["Unbarred Device Event] ( Custom Event) ] Allow Event Broadcast = trueStart Inactive ( Barred state) NotEnough Funds Event Accept Broadcast Message = trueTrigger Event Action ["Device Barring Event] ( Custom Event) ] Allow Event Broadcast = trueSuspended Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1686Charging User Guide Lifecycle manager Optional subscription (Governed by account BCR) - Entity lifecycle configuration Following is the recommended configuration for entity lifecycle of optional subscription governed by account BCR: Transition Start state Event name Action and configurationGo-to stateRemarks Start Cycle Event Timer = 0 secondsTrigger Event Action ["Start Cycle Event" , Type = PERIOD]Start NotEnough Funds Event Accept Broadcast Message = true- InactiveStart ( Initial state) Mandatory Subscription Suspended Event Accept Broadcast Message = true- Inactive Inactive ( Barred state)Subscription Renewed Event Accept Broadcast Message = true- Start Optional subscription (Governed by own periodic BCR) - Entity lifecycle configuration Following is the recommended configuration for periodic lifecycle of optional subscription governed by account BCR: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1687Charging User Guide Lifecycle manager Transition Start state Event name Action and configurationGo-to stateRemarks Start Cycle Event Reset Period Action Start Repeat Cycle Event Timer = End TimeRenew Subscription Action Ignore Barred Device or Group = trueStart Subscription Renewed Event Accept Broadcast Message = trueReset Period Action Start NotEnough Funds Event Accept Broadcast Message = true-- InactiveStart ( Initial state) Mandatory Subscription Suspended Event Accept Broadcast Message = true-- Inactive For details on Mandatory Subscription Suspended Event , see Events associated with lifecycles on page 1601 .
Inactive ( Barred state)Account Recharge Event Accept Broadcast Message = trueRenew Subscription Action Ignore Barred Device or Group = trueInactive Configure if renewal and BCR alignment with respect to recharge date and time is required on balance adjustment.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1688Charging User Guide Lifecycle manager Transition Start state Event name Action and configurationGo-to stateRemarks Subscription Renewed Event Accept Broadcast Message = trueReset Period Action Start Subscription Delete EventRenew Subscription Action Ignore Barred Device or Group = trueInactive Configure if renewal and BCR alignment with respect to deletion date and time is required on mandatory subscription deletion.
Device lifecycle configuration Following is the configuration required in device entity lifecycle for barring/unbarring of device: Transition Start state Event name Action and configurationGo-to stateRemarks Start ( Initial state) Device Barring Event (Custom event)-- Inactive When this event is triggered, the device moves to barred state.
Inactive ( Barred state)Unbarred Device Event (Custom event)- Start When this event is triggered, the device moves to start state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1689Charging User Guide Lifecycle manager Transition Start state Event name Action and configurationGo-to stateRemarks Subscription Success Creation Event (Custom event)-- Start When this event is triggered, the device moves to start state.
7.21 Pending lifecycle renewal The two types of lifecycle, Entity and Periodic , supported by NCC can have timer transitions configured with them, which are managed and triggered using audit.
If multiple timer transitions are planned to be executed at the same time (for example, multiple subscription renewals planned for midnight or non- business hours), then there is a probability of delay in these timer transitions due to processing delay or audit overload.
These delayed timer transitions are referred to as pending lifecycles that can impact the subscriber, which directly depends on the amount of delay.
To resolve the issue faced by a subscriber due to pending lifecycles, as soon as NCC receives an API request or Diameter call for an entity that has a lifecycle pending for renewal, NCC first executes the renewal of these pending lifecycles before processing the Diameter or API request.
For example, if NCC receives a Diameter request for a device and that device has multiple device subscriptions pending for renewal, then these renewals are immediately executed before processing the Diameter request.
Attention : It is recommended to avoid any of the complex configuration as the ones mentioned in the following scenarios: •A single device is a part of multiple groups.
•A device or group has subscriptions, which are linked to multiple accounts.
•A single account is used to sponsor the subscriptions for multiple devices and all pending device subscriptions are renewed using the account lifecycle.
Note : Nokia recommends to have one-to-one relationship between device or group and account or vice-versa.
The impact on performance is cumulative in case of one device or group having a relation with more than one account.
The pending lifecycle events are executed in the following sequence: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1690Charging User Guide Lifecycle manager •Pending Entity Lifecycle (ELC) execution of a device, group, account, and subscription.
•Pending Periodic Lifecycle (PLC) execution of an account, which is linked to device and group subscriptions.
•Pending PLC execution of group subscription.
•Pending PLC execution of device subscription.
Additional information Following are some important points related to the pending lifecycle renewal feature: •While identifying the pending lifecycle events, the timezone of an account is considered for the time comparison.
•Multi-timezone is implemented only for ELC and PLC of an account, which is linked to device and group subscriptions.
•The multi-timezone is applicable for both Diameter and provisioning interface.
•The SendSNR action inside the lifecycle also impacts the performance and its impact depends on the number of devices targeted for the SendSNR action.
•In case of southbound call, if any trigger is executed and no action is taken but the lifecycle state changes, then there is no EDR or CDR generated.
•While configuring a device ELC, if you use the Device Attachment Event as timed transition, then it also gets generated during the call and therefore, gets triggered twice.
•This feature is only supported through Gy interface and not through PCRF Gx interface.
•With entity modification approach in all lifecycle entities, the pending lifecycle trigger feature comes into picture only after one successful transition execution through Audit.
•In case of few exception, all triggered entities may be rolled back.
•Currently, Audit database is not in same lock as in entity database.
Hence, in case of rollback, there may be inconsistency issues between the two.
•When executing the pending lifecycle renewal logic triggered by the diameter request, if there is an aggregate view attached to the related device or group, then after the AV value is reset to an initial value, the threshold rules attached to this AV will also be evaluated.
The thresholds include both the notification threshold and policy threshold.
By this enhancement, for the AV entity, the behavior of on- call renewal is the same as lifecycle renewal triggered by TEM.
Note : If the Delete Entity/Delete Subscription actions are configured along with time delay and the lifecycle state is not changed, it results in a dangling TEM entry in the database.
Pending counter reset logic If there are counters pending to be reset in the TEM queue, then these can be added to the execution queue by setting the application preference Pending Lifecycle Renewal to 1.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1691Charging User Guide Lifecycle manager If this application preference is set to 1, then NCC checks for whether a counter is pending or not.
If it is pending, the counter is reset, threshold is evaluated, and a new entry is made in TEM.
For details about counter reset, see Data bundles with international roaming access on page 1986 .
On-call The following types of counters are considered for on-call pending counter reset: 1.Device Counter 2.Device Subscription Counter 3.Group Counter 4.Group Subscription Counter 5.Device Group Counter Note : The list of Group and Device is same for both pending lifecycle and counter.
API For Device-centric APIs mentioned in APIs affected by pending lifecycle renewal on page 1694 , the reset of following pending counters are executed: 1.Device Counter 2.Device Subscription Counter 3.Device Group Counter For Group-centric APIs mentioned in APIs affected by pending lifecycle renewal on page 1694 , the reset of following pending counters are executed: 1.Group Counter 2.Group Subscription Counter Example Consider a device D1 associated with an account A1 and a group.
The device D1 has a pending device subscription S1.
Also, the group is associated with the account A1 and pending group subscription Sg.
The group is further associated with 9 more devices ( D2, D3,.....D10 ) and account A1) and pending device subscription ( S2, S3,....... S10) respectively.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1692Charging User Guide Lifecycle manager Pending lifecycle renewal on receiving a Diameter call for a DEVICE When NCC receives a Diameter call for the device D1, it first triggers pending ELC of D1, group associated with D1, A1, S1 and Sg followed by the triggering of pending PLC of A1, Sg, and then S1 before processing the Diameter request.
Note : The pending device subscription ( S2, S3,....... S10) of other devices are triggered only when NCC receives a Diameter call for that specific device.
Pending lifecycle renewal for a GROUP centric API When NCC receives an API request for the group, then it first triggers the pending ELC of that group, Sg, and A1 followed by the triggering of pending PLC of A1 and Sg.
Pending lifecycle renewal for an ACCOUNT centric API When NCC receives an API request for the account A1, then it first triggers the pending ELC of A1, subscription attached to account ( S2, S3, ....... S10, Sg), then D1, D2, ..., D10 and group attached to Sg.
Next, it executes the renewal of pending PLCs of account followed by the subscriptions ( S1, S2 ... S10, Sg) attached to that account.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1693Charging User Guide Lifecycle manager Pending lifecycle renewal when counters are pending 1.Create a counter and attach it with a device whose periodic cycle is for 2 hours.
For example, if it is created at 10:00 am and it needs to be reset after 2 hours, then it is reset at 12:00 pm.
2.However, due to heavy load at 12:00 pm, the counter was not reset.
3.If a call comes that time from that device then the counter is reset with the call execution and change the next cycle in TEM to 2 pm (12:00 pm + 2 hours).
APIs affected by pending lifecycle renewal Following APIs trigger the pending lifecycle renewal feature: SM API Device centric/ Group centric/ Account centric PUT/ services/ Service Manager/ addDevice Counter/ CounterDevice centric PUT/ services/ Service Manager/ addDevice Group Counter/ CounterGroup centric PUT/ services/ Service Manager/ addGroup Counter/ CounterGroup centric PUT/ services/ Service Manager/ remove Device Counter/ CounterDevice centric PUT/ services/ Service Manager/ remove Device Group Counter/ CounterDevice centric Group centric PUT/ services/ Service Manager/ remove Group Counter/ CounterGroup centric POST/ services/ Service Manager/ transfer Units/ Gifting ServiceDevice centric POST/ services/ Service Manager/ update Time/ LifeCycle Device centric Group centric Account centric Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1694Charging User Guide Lifecycle manager SM API Device centric/ Group centric/ Account centric PUT/ services/ Service Manager/ send SNR/ SySession Device centric POST/ services/ Service Manager/ create/ SySession Device centric PUT/ services/ Service Manager/ update/ SySession Device centric GET/ services/ Service Manager/ getData/ SySession Device centric DELETE/ services/ Service Manager/ delete/ SySession Device centric GET/ services/ Service Manager/ subscriber/ getData/ AVInstanceDevice centric Group centric PUT/ services/ Service Manager/ subscriber/ update/ Bucket InstanceDevice centric Group centric GET/ services/ Service Manager/ subscriber/ getData/ Bucket InstanceDevice centric Group centric GET/ services/ Service Manager/ subscriber/ getData/ Entity Counter InstanceDevice centric Group centric DELETE/ services/ Service Manager/ subscriber/ delete/ DeviceDevice centric DELETE/ services/ Service Manager/ subscriber/ delete/ AccountAccount centric DELETE/ services/ Service Manager/ subscriber/ delete/ GroupGroup centric PUT/ services/ Service Manager/ subscriber/ update Custom Data/ DeviceDevice centric GET/ services/ Service Manager/ subscriber/ getData/ Group Group centric Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1695Charging User Guide Lifecycle manager SM API Device centric/ Group centric/ Account centric PUT/ services/ Service Manager/ subscriber/ update/ setaccountbalance/ AccountAccount centric GET/ services/ Service Manager/ subscriber/ getData/ DeviceDevice centric GET/ services/ Service Manager/ subscriber/ getData/ AccountAccount centric POST/ services/ Service Manager/ subscriber/ create/ DeviceDevice centric PUT/ services/ Service Manager/ subscriber/ silent Modify/ AccountAccount centric PUT/ services/ Service Manager/ subscriber/ update Custom Data/ AccountAccount centric PUT/ services/ Service Manager/ subscriber/ update Custom Data/ GroupGroup centric PUT/ services/ Service Manager/ subscriber/ silent Modify/ GroupGroup centric PUT/ services/ Service Manager/ subscriber/ update/ rename/ DeviceDevice centric PUT/ services/ Service Manager/ subscriber/ update/ rename/ AccountAccount centric PUT/ services/ Service Manager/ subscriber/ update/ rename/ GroupGroup centric PUT/ services/ Service Manager/ subscriber/ update/ Group Group centric POST/ services/ Service Manager/ subscriber/ create/ AccountAccount centric Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1696Charging User Guide Lifecycle manager SM API Device centric/ Group centric/ Account centric PUT/ services/ Service Manager/ subscriber/ update/ adjustbalance/ AccountAccount centric PUT/ services/ Service Manager/ subscriber/ update/ AccountAccount centric PUT/ services/ Service Manager/ subscriber/ configure/ DeviceDevice centric PUT/ services/ Service Manager/ subscriber/ configure/ GroupGroup centric PUT/ services/ Service Manager/ subscriber/ update/ addadministrator/ AccountAccount centric PUT/ services/ Service Manager/ subscriber/ update/ removeadministrator/ AccountAccount centric PUT/ services/ Service Manager/ subscriber/ silent Modify/ DeviceDevice centric POST/ services/ Service Manager/ subscriber/ create/ Group Group centric PUT/ services/ Service Manager/ subscriber/ update/ Device Device centric GET/ services/ Service Manager/ subscriber/ getbyidentity/ DeviceDevice centric GET/ services/ Service Manager/ subscriber/ getExtended Device/ DeviceDevice centric POST/ services/ Service Manager/ subscriber/ silent Create/ DeviceDevice centric DELETE/ services/ Service Manager/ subscriber/ forcedelete/ DeviceDevice centric Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1697Charging User Guide Lifecycle manager Following are the use cases for the northbound (provisioning APIs) for this feature: 1.CREATE •A CREATE request of group, account, or device is triggered from the REST API or GUI.
•The reload operation is triggered after creating a group, account, or device.
•If the pending lifecycle renewal feature is disabled, then the creation is done successfully.
•If the pending lifecycle renewal feature is enabled, then the creation is done successfully.
If there are any other group, account, or device attached to the newly created entity and there are any pending subscriptions to be renewed for them, then the subscription renewal is triggered.
2.READ •A GET request of group, account, or device is triggered from the REST API or GUI.
•If the pending lifecycle renewal feature is disabled, then the get request is executed successfully.
•If the pending lifecycle renewal feature is enabled, and: - The detailedQuery parameter in the get request is false, then the get request is successfully executed.
- The detailedQuery parameter in the get request is true, then the get request is successfully executed.
If there are any pending subscriptions to be renewed for the triggering entity, then these pending subscriptions are executed and the get request is replied with fresh data.
3.UPDATE •An UPDATE request of group, account, or device is triggered from the REST API or GUI.
•If the pending lifecycle renewal feature is disabled, then the update request is executed successfully.
•If the pending lifecycle renewal feature is enabled and there are any pending subscriptions to be renewed for the triggering entity, then the pending subscriptions are executed but the update request fails with an error message SUBSCRIBER_RELOAD_REQUEST_FAILED:Request can't be performed as data is being refreshed.
Request needs to be sent again considering updated data .
This is done because whenever the pending subscriptions are executed, the data is updated in the database.
Therefore, executing the update request received brings the data into inconsistent state and thus, it fails.
•If the pending lifecycle renewal feature is enabled and there are no pending subscriptions to be renewed, then the UPDATE request is executed successfully.
4.DELETE •An DELETE request of group, account, or device is triggered from the REST API or GUI.
•The reload operation is triggered before deleting a group, account, or device.
•If the pending lifecycle renewal feature is disabled, then the deletion is done successfully.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1698Charging User Guide Lifecycle manager •If the pending lifecycle renewal feature is enabled, then the deletion is done successfully.
If there are any other group, account, or device attached to the newly created entity and there are any pending subscriptions to be renewed for them, then its subscription renewal is triggered.
5.GIFTING API •A Gifting API is triggered from the REST API or GUI.
•If the pending lifecycle renewal featured is enabled and there are any pending subscriptions to be renewed for the triggering entity and all are executed successfully, then the Gifting API request is executed successfully.
•If the pending lifecycle renewal featured is enabled and there are no pending subscriptions to be renewed, then the Gifting API is executed successfully.
•If feature is enabled and there are any pending subscriptions to be renewed for the triggering entity but only few are executed successfully, then the Gifting API request is failed.
If feature is enabled and there are any pending subscriptions to be renewed for the triggering entity but none are executed successfully, then the Gifting API is failed.
7.22 Group final state handling When final state is configured in group entity lifecycle, group can be put to the final state either by lifecycle transition or by delete/Group API and delete/Profile API with groupGoToFinal parameter as true .
This also schedules a TEM for detach group and its child devices with no call in progress regularly.
The application preference Group Device Detach TEM Duration (seconds) defines the TEM duration, and Number of Devices to Detach defines the number of child devices that are to be detached during one TEM duration.
For child devices with call in progress on-call detach of Group in final state (see On-call detachment of group in final state on page 252) detaches the child devices.
After the configurable duration is reached, the group in final state is removed.
In this scenario, if application preference Maximum Repeat Number for Group in Final State is non-zero and there are still child devices under the group, the group stays in final state for another duration.
The process repeats until the value defined in Maximum Repeat Number for Group in Final State is reached; after that the group is removed anyway.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1699Charging User Guide Rating and charging 8Rating and charging The Rating and Charging engine is the core component of the charging and rating solution.
The Rating and Charging engine provides flexible features that empower service providers to launch attractive marketing plans to their subscribers, apply differential charging methods, and varied charges are levied for services in different contexts.
Therefore, the Rating and Charging engine is considered as a key contributor to the generation of revenue, and support technologies ranging from Interactive Voice Response (IVR) to Internet of Things (IOT) to keep pace with the challenges of new technologies.
This chapter describes the rating and charging features.
8.
1 Aggregate View functionality The Aggregate View (AV) functionality provides a consolidated view of the following charging entities: •All available buckets of the same kind included or excluded from the charging service list and the device-group counter with cap for a shared bucket defined in a group.
•All available counter of the same kind included or excluded from the charging service list when the defined threshold for AV is reached.
If the resource is in a barred state, then it must not be reflecting in the AV.
For all the buckets or counters that have a periodic lifecycle, and are associated to an AV, the execution of Reset Resource Action , which resets bucket or counter to its initial value, also reflects in the AV.
The AV functionality is applicable to the following charging entities: •Buckets and/or counters of the same kind •Group counters •Device counters •Device-group counters Note : Thresholds can be defined on the aggregate value of bucket and/or counters based on which the actions are performed.
Note that a consolidated view is provided even when no threshold is attached to an aggregate value.
8.
1.
1 Configuration This functionality is configured based on the Aggregate Type field value in the SM GUI as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1700Charging User Guide Rating and charging Figure 79: Aggregate Type For information to define a new AV, see the Aggregate View on page 1555 .
The following tables provides information on the different values selected for the Aggregate Type field while configuring the AV functionality: Aggregate Type Description Charging Service This option aggregates the buckets defined in an AV.
Charging Service and CAP If an AV is attached to a device, then this option aggregates the buckets within the charging service based on charging service list or all charging services and the cap of device- group counter defined for shared group bucket defined in AV with same unit type.
In this case, device- group counter is mandatory else group resources are not counted in AV.
This AV type is not applicable for group and cannot be attached to group.
Counter If an AV is attached to a device, then this option aggregates the subscription, device, device- group counter, or all counters defined in AV.
For group, the device- group counters or counters within charging service based on list are supported.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1701Charging User Guide Rating and charging Modification of AV configuration The AV configuration can be modified under the following scenarios: •For Aggregate Type set as Charging Service : When a charging service is added or removed from AV definition.
•For Aggregate Type set as Charging Service and CAP : when a charging service is added or removed, or the counter is updated in the AV definition, or both scenarios take place.
•For Aggregate Type set as Counter : The counter type is added or removed.
•When a threshold profile group is added or removed from an AV definition.
Note : When modifications are done for charging service or any other parameter in AV definition, the threshold profile group values attached with the AV definition needs to be modified accordingly (if needed).
For better understanding on modification of AV configuration, refer to Example 5: Modification of AV configuration on page 1708 .
8.
1.2 AV behavior The AV can be attached to a device or group.
For example, if an AV is attached to a device, then the AV instance gets attached to the device and this instance accumulates the value of an applicable bucket in the device subscription or subscription, device, device-group counters: •If a subscription is added to a device or group, then the AV instance accumulates values considering the new subscription with carry over buckets (if exists) for that subscription.
•If a subscription is deleted from a device or group, then the AV instance of that subscription gets updated including the carry over bucket instance (if exists) and counters for that subscription.
•If a subscription is barred, then the buckets and counters linked to that subscription are not considered for aggregation by AV.
•If a subscription is reset, then the CS bucket instances also get reset and if an account is in a new cycle, then the associated device, group, or device-group counters are reset.
The charging and rating engine performs the following tasks to update the AVs accumulating the subscription: –Retrieves the AVs attached to a device or group to which the subscription belongs to.
–Retrieves the AV instance which accumulates the charging service before resetting each bucket instance of that charging service.
Also, fetches all the AV instances that accumulates the counters before resetting the counter instance of that subscription.
–Updates the AVs initial, current, unused values before resetting each bucket and counter instance.
–Resets the bucket instance and its carry over bucket instance and counters and same applicable AV instances of that charging service are updated with new values.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1702Charging User Guide Rating and charging Important : Note that the same aggregate view cannot be attached twice to a device or group.
But, more than one AV can be attached to a device or a group.
8.
1.3 Additional information Following are some important points to note for this feature: •Only the charging application type and not the policy application type is currently supported.
•The usage control service is currently not supported.
•If the Aggregate Type is set as Charging Service and CAP and no device-group is selected, then all the device-group counters are considered.
•If the Aggregate Type is set as Counter and AV accumulates multiple counters that count the same consumption, then AV shows multiple consumption when usage is updated.
•The counter current value update over REST is currently not supported.
•For a counter type AV in device or group or account, only the current value (with reservation) is displayed.
•For a device counter type AV, only the subscription counter, device counter, and device group counter can be aggregated.
•For a group counter type AV, only the subscription counter and group counter can be aggregated.
•A cap associated to a device-group counter with Notification-Reject , Notification-Stop , or Reject action is used while calculating the Charging Service and CAP value of the Aggregate Type .
•If more than one threshold is exceeded in a transaction, then only the actions defined in the latest threshold is considered.
•When AV is attached to a device or group, thresholds attached to it are evaluated as per the provisioning flow.
•The AV does not suppress the individual action, such as notification and runs independently.
•The Empty Subscription action also refreshes the current balance of AV.
8.
1.4 Examples Consider the following examples for a better understanding of this feature: Example 1: When an AV is created Provisioning: 1.Configure an SMS server and define the notification text to be sent to the user.
2.Create a notification profile.
3.Create the lifecycles for device, account, bundle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1703Charging User Guide Rating and charging 4.Create two charging services CS1 and CS2 with 300 and 500 MB data buckets respectively.
5.Create an absolute threshold for 400 MB data usage.
6.Create a bundle and associate it with the charging service.
7.Create an AV and attach it to the charging service and the above threshold indicating the current value of the bucket.
8.Link an iPhone device with the AV.
The following figure shows the Aggregate View in the SM GUI: Result: When the threshold is reached, a notification is sent to the user informing about the subscription usage.
Example 2: When a device subscription associated with an AV is reset or renewed Provisioning: 1.Attach the device subscription of an iPhone with two charging service instances CS1 and CS2 wherein; CS1 has the following bucket instances: •B1 of unit type volume with initial value = 100 MB, current value = 50 MB, and unused value = 50 MB.
•Carry-over bucket B1CO of unit type volume with initial value = 20 MB, current value = 10 MB, and unused value = 10 MB.
CS2 has the following bucket instances: •B2 of unit type volume with initial value = 100 MB, current value = 60 MB, and unused value = 60 MB.
•Carry-over bucket B2CO of unit type volume with initial value = 40 MB, current value = 20 MB, and unused value = 20 MB.
2.Create an AV instance AV1 and attach it to the iPhone.
Result: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1704Charging User Guide Rating and charging •Before resetting the B1 and B1CO bucket instances, their values are deducted from AV.
The following figure shows the AV values for B1 and B1CO buckets before and after subscription reset: •Before resetting the B2 and B2CO bucket instances, their values are deducted from AV.
The following figure shows the AV values for B2 and B2CO buckets before and after subscription reset: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1705Charging User Guide Rating and charging Example 3: When AV is created for a counter associated with a group Provisioning: Configure a group, counter, and cap data as per the following table: Group and associationsCounter Cap Current value Left Nokia Group Counter Share 20 GB 8 GB 12 GB Share Counter ( S1) 5 GB 3 GB 2 GB Counter for Home ( H1)10 GB 2 GB 8 GBFather (belongs to Nokia Group) Counter for Roaming (R1)2 GB 1 GB 1 GB Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1706Charging User Guide Rating and charging The AV for father includes S1, H1, and R1 with thresholds defined at 10 GB, 12 GB, 15 GB with Send- notification action.
Result: When the total current value (cost value) reaches 10 GB, 12 GB, or 15 GB, a notification is sent to the user.
Example 4: When an AV is created for a bucket and cap Provisioning: Configure the following data: Family group Group bucket main ( GB)25 GB Group Bucket CO ( GB)10 GB Cap ( C1) 10 GB Remaining eligibility to use from Group5 GB Individual bucket main ( B1)7 GB Current value ( Initial - used - reserve)3 GBFather Individual bucket CO (B1)3 GB Current value ( Initial - used - reserve)2 GB Cap ( C2) 10 GB Remaining eligibility to use from Group6 GB Individual bucket main ( B2)4 GB Current value ( Initial - used - reserve)3 GBMother Individual bucket CO (B2)3 GB Current value ( Initial - used - reserve)2 GB Cap ( C3) 5 GB Remaining eligibility to use from Group2 GB Individual bucket main ( B3)3 GB Current value ( Initial - used - reserve)1 GBSon Individual bucket CO (B3)2 GB Current value ( Initial - used - reserve)0 GB Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1707Charging User Guide Rating and charging Note : In the above scenario, if usage limit is defined for a counter, then while calculating the AV, the minimum value (cap or usage limit) is considered.
Result: •Given that the AV for father includes B1 and C1, if threshold is defined at 80%, 50%, and 30%, then a notification is sent when the total current value reaches 16 GB, 10 GB, and 6 GB.
•Given that the AV for mother includes B2 and C2, if threshold is defined at 5 GB, 2 GB, and 1 GB, then a notification is sent when the total current value reaches 5 GB, 2 GB, and 1 GB.
•Given that the AV for son includes B3 and C3, if threshold is defined at 80%, 50%, and 30%, then a notification is sent when the total current value reaches 8 GB, 5 GB, and 3 GB.
Example 5: Modification of AV configuration This example shows that AV configuration (adding or removing CS) can be done and the changes are reflected without having to re-attach the AV to the subscriber.
Note : If the ME application preference Refresh instance on definition modification is set to AV (for details on configuring ME application preferences, see Managed Elements section in Global Configuration Guide ), then the functionality works without re-attaching the AV to the subscriber.
AV adjusts the value when AV is of Charging Service type and two CS and two TPG attached to it.
After the initial request, if one CS and one TPG is removed from AV definition, then AvInstance refreshes on next commit or provisioning request and threshold are crossed accordingly.
Provisioning: 1.Create an AV definition with two CS ( CS1 and CS2) and two TPG ( TPG1 and TPG2 ).
TPG1 has a value of 100 bytes and TPG2 has 200 bytes.
Both TPGs are of Absolute from End type.
2.The CS1 has a bucket of 300 bytes with TPG1 ; whereas, CS2 has a bucket of 1000 bytes with TPG1 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1708Charging User Guide Rating and charging The TPG1 has a value of 100 bytes and is of Absolute from End type.
3.Create a device object with AV and subscription.
Initially, AV value is 1300.
4.Create the following AV: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1709Charging User Guide Rating and charging 5.Create the following bundle: 6.Currently, the device overview looks like: Result: 1.After executing the initial request, total reservation of 100 bytes is performed and the device overview looks like: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1710Charging User Guide Rating and charging 2.After updating the AV definition by removing CS1 and TPG2 from it: 3.After removal of CS2 and TPG2 from AV definition, 200 bytes from the AV (of 300 bytes) are consumed when the following update and terminate requests are executed: For CCR-U with USU = 100 and RSU = 100 For CCR-T with USU = 100 Therefore, following is the device overview showing that AV is left with only 100 bytes: 8.2 Subscription activation date This feature allows you to send the start date of the bundle subscription in the provisioning request so that the subscription can be activated at a future date.
Operators can create a subscription for device or group with subscription activation date in future.
Subscription is available for use once the activation date is reached.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1711Charging User Guide Rating and charging For example, a user purchases an offer on November 20, 2018 but it is not activated for charging purpose until December 1, 2018 at 0:00.
8.2.
1 Configuration Configuring a subscription activation date An optional parameter activationTime in subscription is available in the SM GUI, REST API, or SOAP API of the subscription request.
The activationTime parameter includes both date and time information.
•If the activationTime parameter is in past, then a subscription or bundle having a periodic lifecycle attached to a device or group is added depending on the value of the system parameter flag named as Max Past LifeCycle Trigger Count .
For more information on this flag, refer to section Managed Element application preferences in the Global Configuration Guide .
•If the activationTime parameter is configured, then the activation of subscription is considered accordingly.
Note : Consider the following assumptions: •The subscription end time is calculated based on the timezone configured in an account.
•The creation time is set to the current time, that is Now even when the bundle activation date or bundle activation time is in past.
•No validity time is considered while provisioning.
•The entity lifecycle (ELC) changes as per the past activation date is not yet supported.
As defined, the entity lifecycle is always driven by events and periodic lifecycle is always driven by passage of time, which means for periodic lifecycle, we have a fixed periodic length which does not change for many lifecycles.
There is no fixed length for entity lifecycle.
Therefore, the ELC validity time is always calculated from current time, that is Now .
•Prorate is not supported for past activation time Steps Following are the steps to configure the subscription activation date: 1.Configure a lifecycle transition with a timer event with base field as activationTime that makes a transition from barred state to active state.
If you have entered this date in the subscription request, a timer based event is created in TEM with the time as mentioned in activationTime .
When the future date arrives, the subscription is moved to Active state, that is, unbarred state.
2.In addition to the preceding configuration, the bundle lifecycle must also have a transition.
That is, after subscription creation, the subscription entity moves to a barred state so that it is not used before its Active state is reached.
Prorate of subscription is considered when it is activated on the date provided in activationTime .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1712Charging User Guide Rating and charging Configuring a subscription periodic lifecycle Configure the following data: 1.Configure a subscription periodic lifecycle with state --> Begin (Initial Flag checked) with a Start Cycle Event or timer of zero seconds.
2.The moment the Start Cycle Event comes from entity lifecycle of subscription or zero seconds expires, periodic lifecycle of subscription moves to a new state PreActive with Barring state checked.
This makes sure that the subscription is not used when created.
3.The PreActive state has a timer configured whose Base Date Field is set to Activation Time .
Since this is a reference to the activationTime , once this date is reached, the periodic lifecycle of subscription moves to a new state Active with the Barring flag unchecked.
The subscription can be used and further configuration such as Repeat Cycle Event can be done as needed.
8.3 Subscription selection functionality The subscription selection functionality allows operators to set the order in which the subscriptions must be used for the call.
For example, a user has a personal subscription to spotify traffic (that allows to listen to music on a mobile or tablet), a personal data bundle, and a group bundle that allows 2 GB of data from the shared group resources.
In this case, the user wants to consume spotify bundle for spotify traffic, followed by group bundle and personal bundle.
Operators can define this sequence to consume the resources in the category order entity.
Also, the group hierarchy can be parsed top to bottom or vice versa.
The category order is defined per device or per group and is manageable using GUI or API.
The individual devices or the devices belonging to several groups are categorized and a priority order is assigned to them.
Note : For parameters related to the category order, see Charging configuration (new GUI) on page 1331 .
8.3.
1 Additional information Following are the important points related to the subscription selection feature: •Operators can define the categories and their order of consumption in the category order entity.
The category order is not a dynamic and frequently changing entity.
We do not recommend the addition of categories.
•In case, the category order changes: –The new category order is applicable only to new devices.
–No changes are made to the category list of an existing device.
The existing devices provide the order of all available categories in the category order entity during the device update.
–Once a device has defined its category order, all the device calls are charged based on that order.
A device needs to update the category order to change the order of charging the calls.
•If a device has not specified its own category list, then it has a complete set of category order.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1713Charging User Guide Rating and charging •If a device is subscribed to a category not listed in the device category list, then by default, that category is moved at the end of the category list.
•A device can be subscribed either directly or through a group.
•If a device wants to use an ad-hoc group subscription first or if the device becomes part of a new group and prefers to use that group subscription first, then the device category list and the group order at device level must be updated.
8.3.2 Examples Following steps provide the configuration details to implement the subscription selection feature: 1.To provision multiple categories, update the category order entity to specify the sequence of category usage.
For example, Cat2 , Cat3 , Cat1 , Cat4 , and DefaultCategoryOrder .
2.Create a charging service based on the following conditions: •If no other category is associated with the charging service, then the DefaultCategoryOrder, created at the time of NCC installation, is the only category associated with it.
•If a charging service is created with other categories as well, then it can select from one of the available categories configured in the category order entity.
3.Create devices based on the following criteria: •If devices are created without category order, then the entire category list, for example, Cat2 , Cat3 , Cat1 , Cat4 , and DefaultCategoryOrder is copied to the device category list.
•If devices are created with category order, then you must define the order of all available categories, for example, Cat2 , Cat3 , Cat1 , Cat4 , and DefaultCategoryOrder .
Example 1: When a device belongs to several groups without group hierarchy Provisioning: 1.Associate an iPhone to two groups Finance and HR, which are further associated to several categories.
2.Associate each charging service with a creation date and priority as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1714Charging User Guide Rating and charging 3.Set the Subscription Selection Order = DEVICE_FIRST in Device entity and application preference CS Selection Order = ON_CREATION_TIME.
4.When a device executes a data call, then the subscriptions are selected depending on the given factors: •Category order priority •Subscription selection order •Charging service priority Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1715Charging User Guide Rating and charging •Charging Service Instance Creation Time (based on application preference CS Selection Order = ON_CREATION_TIME) Note : If all the subscription selection criteria are same, then whichever charging service instance comes first, is picked first.
Result: When the iPhone executes a data call, then the subscriptions are selected in the given sequence: 1.As Category1 has the highest priority, it is the first category to be fetched when a call is executed.
CS1 is the only charging service that belongs to Category1 .
Therefore, CS1 comes first in ordered charging service list.
2.Category2 has the second highest priority associated with only one charging service CS2.
Therefore, CS2 comes next after CS1 in the ordered charging service list.
3.Category3 has the third highest priority.
As both Finance and HR groups, and iPhone have charging service corresponding to Category3 , the subscription selected order is considered.
Therefore, first Device is considered, followed by Finance Group and then HR group since the Subscription Selection Order = DEVICE_FIRST and Finance Group is associated with Device before HR group.
a.For iPhone, Category3 is associated with two charging services; CS7 and CS8.
As both CS7 and CS8 have same charging service priority, the order of charging service is decided by the charging service instance creation date.
Since CS7 charging service instance was created before CS8, CS7 charging service is considered first.
b.For the Finance group, Category3 is associated with two charging services; CS3 and CS4.
The order of charging service is decided by the charging service priority.
Therefore, CS3 with higher priority is considered first followed by CS4.
c.For HR group, Category3 is associated with two charging services; CS5 and CS6.
Since both CS5 and CS6 have same charging service priority and same charging service instance creation date, whichever charging service comes first is picked first.
4.The same process, which has been defined for Category3 , is followed for Category4 .
5.Pass 0 of all the charging services are executed first followed by Pass 1 of all charging services.
For example: •Pass 0 : CS1 -> CS2 -> CS7 -> CS8 -> CS3 -> CS4 -> CS5 -> CS6 -> CS9 -> CS11 -> CS10 •Pass 1 : CS1 -> CS2 -> CS7 -> CS8 -> CS3 -> CS4 -> CS5 -> CS6 -> CS9 -> CS11 -> CS10 Example 2: When a device belongs to several groups with group hierarchy Provisioning: 1.Associate an iPhone device to two groups Finance , which is a member of the Management group and Testing group, which is a member of the Development group.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1716Charging User Guide Rating and charging 2.Associate all four groups with several categories.
3.Associate each charging service with a creation date and priority as shown in the following figure: 4.Set the Subscription Selection Order = GROUP_FIRST in Device entity and application preference CS Selection Order = ON_CREATION_TIME .
Result: When the iPhone executes a data call, then the subscriptions are selected in the given sequence: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1717Charging User Guide Rating and charging 1.As Category1 has the highest priority, it is the first category to be fetched when a call is executed.
CS1 is the only charging service that belongs to Category1 .
Therefore, CS1 comes first in ordered charging service list.
2.Category2 has the second highest priority.
As both Finance and Testing groups, and iPhone have charging service corresponding to Category2 , the subscription selected order is considered.
Therefore, first Finance group is considered, followed by the Testing group, and then Device since Subscription Selection Order = GROUP_FIRST and Finance Group is associated with Device before HR group.
a.Finance group is part of a hierarchy with Management group as the top node.
Therefore, Management group defines the traversal order for this hierarchy which in this case is top- down.
This implies that the subscriptions of Management group comes first followed by the subscriptions of Finance group.
b.Management group is associated with two charging services; CS6 and CS7 from Category2 .
The order of charging service is decided by the charging service priority.
Therefore, CS6 with higher priority is considered first followed by CS7.
c.Finance group is associated with only one charging service CS8 from Category2 comes next.
d.Testing group is part of a hierarchy with Development group as the top node.
Therefore, Development group defines the traversal order for this hierarchy which in this case is bottom-up.
This implies that the subscriptions of Testing group comes first followed by the subscriptions of Development group.
e.Testing group is associated with two charging services; CS4 and CS5 from Category2 .
As both CS4 and CS5 have same charging service priority, the order of charging service is decided by the charging service instance creation date.
Since CS4 charging service instance was created before CS5, CS4 charging service is considered first.
f.Development group is associated with two charging services; CS2 and CS3 from Category2 .
Both CS2 and CS3 charging services have same charging service priority and creation date.
So, whichever comes first is picked first.
g.The iPhone has one CS (CS13).
Hence, CS13 is picked next.
3.Category4 has the third highest priority and only Development group associated with one charging service CS9 which gets selected next.
4.Category3 has the next priority and both iPhone and Management group have charging services from this category.
The subscription selection order is considered.
Here, Finance group comes first followed by iPhone.
a.Management group belongs to the hierarchy from which Finance group comes.
So, Management group charging service, that is, CS10 is picked next.
b.iPhone is associated with two charging services; CS11 and CS12 from Category3 .
The next criterion for order is considered, that is, charging service priority.
Since CS12 has higher priority than CS11 , CS12 is considered first followed by CS11 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1718Charging User Guide Rating and charging 5.Pass 0 of all the charging services are executed first followed by Pass 1 of all charging services.
For example: Pass 0 : CS1 -> CS6 -> CS7 -> CS8 -> CS4 -> CS5 -> CS2 -> CS3 -> CS13 -> CS9 -> CS10 -> CS12 -> CS11 Pass 1 : CS1 -> CS6 -> CS7 -> CS8 -> CS4 -> CS5 -> CS2 -> CS3 -> CS13 -> CS9 -> CS10 -> CS12 -> CS11 Example 3: When a device belongs to several groups and expiry date is used for sorting Provisioning: 1.Associate an iPhone to two groups Group1 and Group2 .
Given that Group1 is attached to device before Group2 .
Therefore, sorting of Group 1 is done first followed by Group2 .
2.Set the Subscription Selection Order = GROUP_FIRST in the Device entity and application preference CS Selection Order = ON_END_TIME for the charging service as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1719Charging User Guide Rating and charging 3.When the iPhone executes a data call, then the subscriptions are selected depending on the given factors: •Category order priority •Subscription selection order •Charging service priority •Charging service instance expiry date (based on application preference CS Selection Order = ON_END_TIME ) Note : If all the subscription selection criteria are same, then whichever charging service instance comes first, is picked first.
Result: When the iPhone executes a data call, then the subscriptions are selected in the given sequence: 1.As Category1 has the highest priority, it is the first category to be fetched when a call is executed.
CS1 is the only charging service that belongs to Category1 .
Therefore, CS1 comes first in the charging service list.
2.Category2 has the second highest priority associated with only one charging service CS2.
Therefore, CS2 comes next after CS1 in the charging service list.
3.Category3 has the third highest priority.
CS3 and CS4 are sorted first as per priority because Group1 was attached to device before Group2 .
Since CS5 has higher priority than CS6, CS5 is picked first.
CS7 and CS8 are from device, therefore, sorted at the end of Category3 .
As priority is same, they are sorted based on the expiry date.
Since CS8 expiry is before CS7, CS8 is picked first.
4.Category4 has the fourth highest priority.
CS11 is sorted first.
CS10 is sorted next as per priority in Group2 followed by device CS9.
This is because, Group_First is selected in device and Group1 was attached to device before Group2 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1720Charging User Guide Rating and charging 8.4 Subscription customization The subscription customization (template) feature provides the following functionalities: •While attaching a subscription to a device or group, the operators can customize the subscription by overriding the parameters from the existing subscription.
This can be done by setting the subscriptionCustomise flag to True in the create/Device or create/Group API.
The values not sent in the request are picked from the bundle definition.
•After creating a subscription, if an operator wants to update the bucket instances in that subscription, then the update/BucketInstance API is used.
Note : The non-customized values are picked from the bundle definition.
Template APIs Template APIs allow bundle customization during a new subscription creation.
They can create subscriptions overriding the values from catalog definitions.
The following enhancements apply to the existing Template APIs: •Override bucket and counter values by specifying buckets and counters directly under bundle.
•Override bucket initial value with incremental and decremental mode.
•Override the values temporarily for a specified amount of billing cycles.
•Override bucket carry-over parameters, such as carry over percentage, carry over validity, maximum carry over amount, consumption order, and so on.
•Override service (bundle) custom data.
Following are the template APIs for which the enhancements apply: •Create Group API : This API allows creation of a Group with a subscription.
/services/ServiceManager/subscriber/create/Group •Update Group API : This API allows you to update a Group with a subscription.
/services/ServiceManager/subscriber/update/Group •Delta Update Group API : This API allows you to update of a Group with a subscription.
/services/ServiceManager/subscriber/deltaUpdate/Group •Create Device API : This API allows creation of a Device with a subscription.
/services/ServiceManager/subscriber/create/Device Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1721Charging User Guide Rating and charging •Update Device API : This API allows you to update a Device with a subscription.
/services/ServiceManager/subscriber/update/Device •Delta Update Device API : This API allows you to update a Device with a subscription.
/services/ServiceManager/subscriber/deltaUpdate/Device •Create Subscription API : This API allows creation and addition a new subscription and also allows bundle customization.
It allows creation of subscription with overridden values.
/services/ServiceManager/subscriber/create/Subscription_v1 •Create Profile API : This API allows creation of the Subscriber Profile.
This API can be used to create an Account, a User, a list of Devices, a list of subscriptions with overridden values associated with each other.
All the subscriptions are charged on the same account that is also created with this API request.
/services/ServiceManager/subscriber/create/Profile •Add Profile API : This API adds devices and subscriptions to a Subscriber Profile for a given Account.
It also allows creation of a device and subscription with overridden values and associate it with existing account.
/services/ServiceManager/subscriber/add/Profile •Update/Change Plan API : This API changes the plan (add new subscription) to a device or group.
It also allows you to replace an existing subscription with a new subscription created with overridden values.
/services/ServiceManager/subscriber/update/ChangePlan Previously, when creating a subscription using one of the template APIs, NCC did not allow to override maxRenewals .
Currently, NCC allows overriding maxRenewals using the template APIs.
Following example shows how the maxRenewals attribute is specified in the template APIs: .
.
.
"bundle": { "name": "Bundle1", "maxRenewals": 2, .
.
.
If the maxRenewals attribute is not specified in the template APIs, then the value of maxRenewals is taken from the bundle catalog.
If the maxRenewals is set to -1, then it is considered as unlimited value.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1722Charging User Guide Rating and charging Previously, to customize or override a bundle value in a subscription, use one of the template APIs.
The common attribute in all the template APIs for customization is subscriptions parameter (except change/ update plan API wherein it is customizedBundleData ).
After the subscription is created or updated, it is not possible to know if this subscription comes from a customized bundle or not.
Currently, NCC provides an option to override bucket and counter values.
The buckets and counters can be specified directly under bundle without specifying the charging service.
See the following example: { ... ... "subscriptions": [ { "subscriptionCustomise": true, "bundle": { "name": "BundleTest", "buckets": [ { "name": "Bucket1", "initialValue": 800, "currentValue": 800, "thresholdProfileGroupIdList": [ "T2" ] } ], "counters": [ { "name": "Counter1", "thresholdProfileGroupIdList": [ "TPG2" ], "overageThresholdProfileGroupIdList": [ "OTPG2" ], "usageLimit": 25, "overageLimit": 30 } ] } } ] ... ... } Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1723Charging User Guide Rating and charging The field initialValueAdjMode allows you to override bucket initial value with incremental/decremental modes.
You can use this field to increment, decrement, or set the bucket initial value.
Note that the initialValueAdjMode is applicable only to buckets and not counters.
This field can have the following values: •SET: Sets an absolute value •INCR : Increase the values by delta •DECR : Decrease the values by delta •NONE : No mode See the following example: { ... ... "subscriptions": [ { "bundle": { "name": "BundleTest", "buckets": [ { "name": "Bucket1", "initialValue": 100, "currentValue": 100, "initialValueAdjMode": "INCR" } ] } } ] ... ... } The following GUI snapshots show the counter values that are overridden.
Navigate to Devices or Groups and add a new subscription under Associations .
From the bundles, select the bundle that contains a multi-bundle counter.
In the following snapshot, ServiceWMultiServiceCounter1 is the selected bundle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1724Charging User Guide Rating and charging Click SELECT COUNTER and from the list select the counter.
Here, MultiServiceCounter1 is selected.
This counter is a multi-bundle counter found in a charging logic attached to the selected bundle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1725Charging User Guide Rating and charging You can override the values of selected counter.
Here, Overage Limit Override (Second) value is changed.
You can display the counter and its overridden value from the preview page as follows.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1726Charging User Guide Rating and charging create/Device or create/Group REST API The service operators can customize a bundle using the create/Device or create/Group API while attaching a subscription to a device or group.
If the subscriptionCustomise flag is set as True , then the service operators customize only the lifecycle and charging service in a bundle.
Note : •You cannot add a new charging service but only use the existing charging services from the original bundle definition.
•With customization, the bucket/counters values can be modified.
As a result, if a threshold is defined on absolute value, then it may not generate the expected result.
Therefore, it is recommended to define threshold levels in percentage.
The create/Device or create/Group API can modify the following data: •Lifecycle (entity or periodic) attached with a bundle definition.
•Counter threshold profile group, overage threshold profile group, usage limit, and overage limit present in the charging logic (charging service) list.
•InitialValue, CurrentValue, currentChargingStep, threshold for buckets, and carry-over parameters present in the charging logic (charging service) list.
•All or certain charging service can be selected in the bundle definition.
For the complete list of parameters and their descriptions, see the NOKIA Converged Charging Service Manager API Reference Guide .
Setting InitialValue, CurrentValue, and currentChargingStep for a bucket with or without a Charging Step Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1727Charging User Guide Rating and charging •If currentChargingStep is provided in the request, but bucket does not have a Charging Step, then the request is rejected with an error.
•If currentChargingStep is not provided in the request and bucket has a Charging Step, then CurrentValue and InitialValue are set to the size in step 1 of the Charging Step.
•If currentChargingStep is provided in the request and bucket has a Charging Step, then if the currentChargingStep is greater than the number of steps in the Charging Step (with the last step as not unlimited ), the request is rejected with an error.
If currentChargingStep is less, then the following logic is used: 1.If InitialValue is available in the request, then the request is rejected with an error.
The InitialValue is calculated internally as follows: –For a Charging Step that has last step as not unlimited : Sum of steps starting from step 1 till currentCharging Step.
–For a Charging Step that has last step as unlimited: Sum of steps starting from 1 until step before unlimited step, plus the number of times unlimited step has been used.
2.If CurrentValue is available in the request, then this value is set only when it is less than current charging step size.
3.If current value is not available in the request, then it is set as follows: –For a Charging Step that has last step as not unlimited: current step size.
–For a Charging Step that has last step as unlimited , it is set as follows: •If current charging step < number of steps: current charging step size.
•If current charging step >= number of steps: last step size.
Example: Creating a device and attaching a subscription The following figure shows an example where an iPhone device is created with two buckets.
The create/ Device API is used to change the initial value of the existing bucket ( Bucket1 ) to 300 bytes.
Note that the subscriptionCustomise flag is set as True .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1728Charging User Guide Rating and charging update/BucketInstance REST API The service operators can update the following bucket instance parameters using the update/ BucketInstance API: •Bucket initial value •Bucket current value •Carry-over parameters •Current charging step Previously, for temporary updates, the adjust mode and delta value existed in the database until the number of temporary cycles were reached.
For permanent updates, the adjust mode exists as None and the delta value as 0 and the adjusted amount is stored in the original value field.
Note : •Bucket value cannot be higher than the initial bucket value.
During a call, if the charging step decreases, then this condition is disregarded, and the bucket value gets adjusted.
•The charging step cannot move out of configured steps.
•The charging step = 0 or negative value is not allowed.
•The new initial value can be greater or lesser than the original value.
•The new bucket initial value can be permanent (set adjustAmountInitialValidity parameter to zero) or temporary (set adjustAmountInitialValidity to any positive value greater than zero).
–Zero indicates that the given initial value remains forever, this is also the default value.
–Any positive value indicates the number of bill cycles (including the current bill cycle) for which the given initial value remains valid.
A value of 1 means that the given initial value is valid only for the ongoing bill cycle and is replaced by the original initial value at next BCR.
For example, adjustAmountInitialValidity = 3, initialValue = 1000 , and origInitialValue = 1200 .
The initial value is valid for current bill cycle and two further bill cycles.
After which, the initialValue falls back to 1200 .
For the complete list of parameters and their descriptions, see the NOKIA Converged Charging Service Manager API Reference Guide.
Attention : The maximum value allowed for initial bucket value or bucket current value is 922337203685477600 .
For the complete list of parameters and their descriptions, see the NOKIA Converged Charging Service Manager API Reference Guide .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1729Charging User Guide Rating and charging update/Subscription and update/EntityCounterInstance REST API To update a counter instance in a given subscription, operators can use either of the following APIs: /services/ServiceManager/subscriber/update/Subscription /services/ServiceManager/subscriber/update/EntityCounterInstance To retrieve the counter instance information, operators can use the following API: /services/ServiceManager/subscriber/getData/EntityCounterInstance Previously, for update subscription API, the remainingRenewals value was not considered with versioning nor the impact to max renewal value.
Currently, NCC considers the remainingRenewals value with versioning and impact of it's value to the max renewal.
Following example shows the remainingRenewals value: { "entityId": "group1", "entityType": "GROUP", "subscriptionId": "459e89bc-beb0-46bb-9559-090a1c4259b3", "remainingRenewals": 4 } Previously, for update subscription API, the remainingRenewals value could not be modified from a limited value to unlimited.
Currently, the update subscription API is enhanced to update the remainingRenewals for an existing subscription to be UNLIMITED .
That is, if the subscription is created with a defined number of renewal cycles, then NCC allows the remainingRenewals to be set to UNLIMITED .
Shortening the update subscription API cycle Previously, if the Input date parameter in the update subscription API is updated, then the new update takes effect only after the next renewal.
That is, the existing end time of the cycle is not impacted by the updated input date until the next renew point.
Currently, if the Input date is updated, then the update takes effect immediately.
If the updated input date causes shortening of the current cycle, then the existing end time is updated to align with the updated input date.
Note : •In case of shortening of current cycle, RAR is processed to allow the new renewal/expiration date to be considered while resetting the VT values for any active data sessions.
•If the updated input date is not in the past, then the update subscription API fails with an appropriate error message.
The update/create subscription API has been enhanced with an optional parameter to accept date in YYYYMMDDhhmm format.
In this parameter, hours and minutes are optional.
The default value is 0000 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1730Charging User Guide Rating and charging Previously, NCC allowed operators to make temporary changes to some attributes of a counter instance such as ULI, TPG using the usgLmtTempChg and thrhdTempChg boolean attributes in the update request.
In this case, the change is temporary and the values of ULI and TPG revert back to catalog definition values during subscription renewal.
To make the change permanent for a few billing cycles, operators can use the validityTime attribute.
This attribute indicates the number of billing cycles (including the current) for which the changes to the following attributes remain valid: •Usage limit (ULI) •Overage limit (OLI) •Threshold Profile Group (TPG) •Overage Threshold Profile Group (OTPG) For permanent change, pass the value 0, which is also the default value of validityTime attribute.
{ ... "usageLimit": 100, "overageLimit": 50, "thresholdProfileGroupIdList": [ { "thPrfGrpDfName": "...", "operation": "ADD/REMOVE" } ], "overageThresholdProfileGroupIdList": [ { "thPrfGrpDfName": "...", "operation": "ADD/REMOVE" } ], "validityTime": 2 } For temporary overrides, a positive integer value must be provided for validityTime in each of the template APIs.
0 means default and indicates permanent change.
If a value is not provided, the override will be permanent by default.
Negative values are not allowed for validityTime .
See the following example: { ... ... "subscriptions": [ { "bundle": { "name": "BundleTest", "validityTime": 2, Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1731Charging User Guide Rating and charging "buckets": [ ... ... ], "counters": [ ... ... ], } } ] ... ... } The validityTime is separated for all four attributes and stored in the DB separately: •usgLimitValidityTime •ovgLimitValidityTime •usgTpgValidityTime •ovgTpgValidityTime If OLI is being updated, then usgLimitValidityTime is set to the value of validityTime , and similarly for the other attributes.
For example, if OLI is not being updated, then ovgLimitValidityTime does not get updated.
For backward compatibility, usgLmtTempChg and thrhdTempChg boolean attributes are allowed in the request.
They are not saved in the DB, instead, they are mapped to the corresponding validity time attribute.
If usgLmtTempChg is true, then usgLimitValidityTime is set to 1, if false, then 0.
Similarly, if thrhdTempChg is true, then usgTpgValidityTime is set to 1, if false, then 0.
Both the validityTime and temporary change flags cannot be set in the same request.
If both are present, then the request gets rejected.
Following is the API response: { "responseStatus": { "message": "Success", "data": [ { ... "thresholdProfileGroupInstList": [...], "overageThresholdProfileGroupIdList": [...], "usageLimit": 500, "overageLimit": 100, "usgLmtTempChg": true, "thrhdTempChg": false, Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1732Charging User Guide Rating and charging "usgLimitValidityTime": 3, "ovgLimitValidityTime": 3, "usgTpgValidityTime": 0, "ovgTpgValidityTime": -1 } ] } } The usgLmtTempChg and thrhdTempChg do not represent the DB values.
They are a reflection of the corresponding validity time attribute.
If the usgLimitValidityTime is greater than 0, then usgLmtTempChg is set as true in the response.
If it is 0 or -1, then it is set as false.
The same logic applies to thrhdTempChg .
Note that the validity time in the response can be -1.
It is the default value when a new subscription is created.
When a permanent change is made to one of the four attributes (ULI, OLI, TPG, OTPG), the permanent value is saved in a separate field.
The following DB fields store the permanent changes: •permUsgLimit •permOvgLimit •permUsgTpg •permOvgTpg These fields are not displayed in REST APIs.
When the validity time of one of the four attributes expires, its value is reverted back.
If there was a prior permanent change, then the corresponding permanent change value is used to revert the value.
If no prior permanent changes were made, then the catalog definition value is used to revert the value.
Examples for currentChargingStep parameter Pre-requisite: Consider that a bucket has 3 steps (200, 100, 100 bytes).
Example 1: Consider that a subscriber has bucket at step 1 with 50 bytes.
When the REST API update/ BucketInstance is executed with currentChargingStep = 2, then the bucket is at step 2 and bucket value is 150, and initial bucket value is 300.
Example 2: Consider that a subscriber has bucket at step 2 with 70 bytes.
When the REST API update/ BucketInstance is executed with currentChargingStep = 2, then the bucket is at step 2 and bucket value is 70, and initial bucket value is 300.
Note : The same behavior is applicable to update/Subscription REST API.
8.4.
1 Additional information Following are some important points related to this feature performed by the operators: •Modify a bundle while attaching a subscription to a device or group.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1733Charging User Guide Rating and charging •Modify the objects in a bundle entity.
•Do not modify the bucket name and unit type.
•Do not attach extra charging service other than those present in the selected bundle.
•Do not attach extra buckets or counters other than those present in the selected bundle.
•If the bucket initial value, bucket current value, and bucket unused value are updated using the update/BucketInstance API and updateSubscription API, then the following points are considered: –initialValueAdjustAmount updates only the first step size.
–The new size of the first step cannot be less than zero.
However, if this value gets less than zero, then the update/BucketInstance API returns an error.
For example: CHARGING_STEP_00018: While decreasing the first step value, the value cannot be less than zero.
–If some reservations are done from step bucket, then those reservations or the anticipated step index must be considered.
–If any changes are done in the initial value, current value, or unused value of the step bucket, then the current step is not changed irrespective of the modification.
–The logic of reading step-bucket and determining its initial value as well as current value during call requests are enhanced to consider any updation done using the REST APIs.
–If the values of initial value, current value, or unused value are changed, then the modified values are preserved while updating with the Charging Step data or while performing the step-ups.
–The updated initial value, current value, or unused value are considered while resetting the step bucket and initializing the initial value and current value of the bucket during reset or renewed are enhanced to consider any updation using the REST APIs.
8.4.2 Examples Consider the following examples for better understanding of this feature: Example 1: Changing bucket values (permanent update) using update/BucketInstance API Provisioning: At the start of a billing cycle (11/2018), create a group with two devices has a bucket initial value = 600 Bytes and current value = 400 Bytes.
Result: If a new device is attached to the group with bucket initial value = 300 Bytes, then current value = 100 Bytes.
The bucket values are adjusted using the update/BucketInstance API.
The InitialvalueAdjustAmount is used to set the value.
The new device is added to the group with initial value = 600 + 300 = 900 Bytes Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1734Charging User Guide Rating and charging and current value = 400 + 100 = 500 Bytes.
After reset or renewal of bundle (12/2018), the group has three devices with initial value = 900 Bytes and current value = 900 Bytes.
The following figure provides details on permanent update scenario.
Note that the adjustAmountInitialValidity is set to 0, where 0 indicates that the update is permanent.
Figure 80: Subscription customization - permanent update The following figure from SM GUI shows the bucket values before using the update/BucketInstance API: The following figure from SM GUI shows the bucket values after executing the update/BucketInstance API: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1735Charging User Guide Rating and charging The following figure from SM GUI shows the bucket values after the billing cycle is reset: Example 2: Changing bucket values (temporary update) using REST API The following figure provides details on the temporary update scenario.
Note that the adjustAmountInitialValidity is set to 1, where 1 indicates that the update is temporary.
In the current example, the value 1 is used, but you can add any positive value greater than 1 to indicate that the update is temporary.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1736Charging User Guide Rating and charging Figure 81: Subscription customization - temporary update The following figure from SM GUI shows the bucket values before using the update/BucketInstance API: The following figure from SM GUI shows the bucket values after executing the update/BucketInstance API: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1737Charging User Guide Rating and charging The following figure from SM GUI shows the bucket values after the billing cycle is reset.
Example 3 Carry over update - variant 1: The following figure provides details on the carry over update scenario where the carry over flag is set to false.
Since the carry over flag is disabled, the carry over logic is not executed from the next renewal cycle.
The current balance of carry over value is available for use in the current bill cycle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1738Charging User Guide Rating and charging The following figure from SM GUI shows the bucket values before using the update/BucketInstance API: The following figure from SM GUI shows the bucket values after the billing cycle is reset.
In the current scenario, since the carry over flag is set to false, the carry over values are removed.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1739Charging User Guide Rating and charging Carry over update - variant 2: The following figure provides details on the carry over update scenario where the carry over flag is set to true.
Since the carry over flag is enabled, the carry over logic is executed from the next renewal cycle.
When the update/BucketInstance API is executed in the current bill cycle, an empty carry over bucket instance gets created but the values are filled in the next bill cycle reset.
In this case, the carry over value is 50.
Therefore, 50% of the bucket initial and current value is carried over, that is 50% of 5000 = 2500.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1740Charging User Guide Rating and charging 8.5 Allow bundle addition to accounts with insufficient balance Now the OCS subscribers can subscribe to bundles or subscriptions without having enough balance in their accounts to pay for them.
The bundles or subscriptions are added to the subscribers account but are not active, instead they are placed in the suspended lifecycle state.
This feature can be controlled by the application preference Subscription Creation On Insufficient Balance .
When additional funds are added to the subscriber’s account and if there is enough balance, then the added bundle or bundles are moved to the Active lifecycle state and the requisite funds are deducted from the balance of the subscriber.
This feature allows a OCS subscriber to subscribe or purchase a new bundle or subscription when they have insufficient funds in their account.
Purchased bundles are put in the configured lifecycle state for insufficient funds (this can be in the Suspended lifecycle state) and when there is enough balance to fund all bundles in the configured state then the bundles are moved into the Active lifecycle state.
When bundles or subscriptions are added, any discount available for the bundle or the subscription must be considered before deducting the funds for the subscription.
Subscription creation •As per the existing implementation during subscription creation and after primarily validations, the account balance is checked to see if it is enough to deduct bundle fee or to do a fee override after considering all the applicable discounts.
If not, then the request is rejected.
In the current feature, before rejection the new system flag is checked and if it is set, then the logic proceeds further and the subscription is created.
•A new attribute ( barredDueToInsufficientFund ) needs to be added in the subscription instance to indicate that this subscription is suspended due to insufficient balance.
•As per the last steps of subscription creation, an event is triggered so that it transfers the subscription Active state to Suspended/Inactive state as per the lifecycle configuration.
The NotEnoughFunds event must be configured in the lifecycle to transfer from Active state to Suspended/Inactive state.
This lifecycle configuration is mandatory for the feature to work.
This configuration is done in any lifecycle Entity (ELC) or Periodic (PLC).
Note : Activation Time specifies the time when the subscription was first activated.
If activation time is not provided, the subscription remains activated and this field uses the current time.
In this scenario, subscription activation is governed either by lifecycle configuration and account or present status of device entities.
As in this case, the subscription remains activated and it fails due to insufficient balance.
•For example, following is the suggested configuration of Lifecycle (ELC) for this event: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1741Charging User Guide Rating and charging Figure 82: Example: Existing NotEnoughFunds event Note : If a new flag is enabled but lifecycle is not configured as suggested, then it is possible that subscription gets created in the Active state without any fee deduction.
Account recharge or subscription activation •When the account is credited with positive balance, then an event AccountRechargeEvent is triggered which is broadcasted to all the linked subscriptions.
•If a new discount is added to the Device, thereby making the account balance sufficient for subscription fee deduction, then the Trigger API in the Lifecycle module can be used to trigger AccountRechargeEvent , configured in lifecycle of that account or specific subscription.
For more details on using the API, refer to the Swagger API documentation.
•Following transition needs to be defined in Life-cycle: Figure 83: Event:AccountRechargedEvent Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1742Charging User Guide Rating and charging Figure 84: Event:ChargeFeeActionSuccessEvent 8.5.
1 Additional information Following are some important points to note for this functionality: •Currently the profile APIs and the discount feature is not supported to Group.
So for this feature is limited to the device only with respect to discount.
•The insufficient balance feature is applicable only if the bundle fee or fee override is configured.
It is not applicable if ChargefeeAction is configured in the initial state of Lifecycle attached with the bundle to deduct subscription purchase fee.
•At the time of recharge of suspended subscription, ChargefeeAction prorate configuration is not applied on the bundle purchase fee.
Prorate configuration is applicable at the time of subscription creation.
Also tax, if configured, is considered from bundle or account, not from the Charge fee action.
•Currently if a subscription is in a suspended state because of the insufficient state, and if a discount of 100% is added, then the subscription is not moved to the Active state as discount addition does not trigger any event.
•Reset Subscription Action and Renew Subscription Action is not allowed for subscription barred due to insufficient funds.
•If BOU Subscription is barred due to insufficient funds, then this subscription must not be activated on a session call.
•If feature flag is on while creating the subscription and the Account Recharge Event feature flag is set to off, then the subscription fee is deducted from account irrespective of feature flag.
On successful deduction, subscription state is moved to Active from Suspended.
•The suspended subscription can only be activated during the recharge event for this feature configuration.
•If multiple subscriptions are in a suspended state, and the recharge account has only enough funds for one subscription activation, then a random subscription is picked for activation, and at present no priority is considered or implemented.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1743Charging User Guide Rating and charging 8.6 eCommerce charging APIs This feature enables NCC to handle eCommerce rating and charging transactions through HTTP or HTTP2 APIs as shown in the following figure: The HTTP or HTTP2 requests allow conditional charging to be applied based on different parameters, such as Merchant ID or Call Type .
An EDR is generated for an eCommerce API request.
Following parameters are used as conditions in tariff rules or in applicability conditions of counters or charging services to perform conditional charging: •Merchant ID : This indicates the identifier for a merchant or service provider.
•Traffic Type : This indicates the type of traffic used for identifying and allowing throttling scenarios.
•Call Type : This indicates the E-Commerce call type for eCommerce APIs.
The same value is used in applicability conditions or tariff formula as required to differentiate eCommerce calls from other Diameter calls.
Note : 1.If eCommerce bundles are subscribed, then they may have a cost, which is debited from the account main balance.
2.While running the Direct Debit API, the amount is deleted either from the account main balance or from a money bucket depending on the tariff formula configuration.
The selection of money bucket or counter depends on the applicability condition, which is configured using the Merchant ID , Trafic Type , or Call Type .
This feature uses the HTTP and HTTP2 REST APIs to perform chargeable balance debit and balance query operations: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1744Charging User Guide Rating and charging 8.6.
1 UCRemainingBalance API This API returns account balance and distanceToUsage values for a given device identified by supplied GPSI.
The distanceToUsage value is computed as the difference between the Usage limit (ULI) and the current counter value for the selected cost counter or UC Limit (as applicable).
Note : The UC limit (if self-counter) always takes precedence over any other cost counter for distanceToUsageLimit calculation.
https://<IP>:<PORT>/services/ServiceManager/e-commerce/UCRemainingBalance For more information, refer to the API documentation.
If this API fails to identify the usage control limit or an applicable cost counter in charging service, then it returns only the balance amount without any distanceToUsageLimit .
If multiple counters are applicable, then it returns the account balance along with the response code, such as Multiple Counters Applicable .
If no counters are applicable, then it returns only the balance amount and no distanceToUsageAmount .
Note : This API always returns other input parameters as result for all OK scenarios.
8.6.2 Debit Amount API This API debits the requested amount from the main balance or monetary bucket depending on the tariff formula defined in the charging service.
It also returns the remaining amount of account main balance or monetary bucket after deducting the requested amount.
Following is the URI: https://<IP>:<PORT>/services/ServiceManager/e-commerce/DebitAmount For more information, refer to the API documentation.
If there is a No Charge tariff formula set in a charging service, then it returns the account main balance in response.
If device has multiple subscription from multiple account, then this API debits the amount in the following order: First, from the first account, followed by the second account, and then the third account or further.
It returns the remaining balance of last account used for debit.
8.6.3 Additional information Following are some important points to note for the eCommerce APIs: •These APIs are for direct debit, and not related to ECUR or SCUR calls.
•These APIs require a different set of attributes to be supported in rules or applicability conditions.
•These APIs are limited only to debit operations.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1745Charging User Guide Rating and charging •The functionality for distanceToAmount in UCQueryBalanceAPI is applicable only to subscription counters.
The distanceToAmount is applicable to the usage limit defined on a counter.
Note : This is not applicable to any Near-ULI or OLI cases.
•Fee related deduction from monetary balance are not accumulated in cost counter.
•The usage limit within the usage control is configured with a Time Of Day setting.
If any eCommerce API request arrives during the configured Time Of Day barred setting, then they are rejected with an appropriate error code in response.
•In eCommerce APIs, the NOTIFICATION-STOP or STOP action is not recommended for UC limit thresholds.
However, if these actions are configured for eCommerce APIs, then they behave in generic manner.
•The eCommerce API support is limited to as data models and adoptions defined for UC.
•The GPSI parameter in both ( UCRemainingBalanceQuery and DebitAmount ) APIs can be any type, such as Ext-ID/MSISDN or MDN.
Only GPSI parameter support is required NOT SUPI.
In case of msisdn- , the input GPSI value is based on the GPSI MSISDN Prefix Configuration under the SM Application Preferences .
This feature considers the following assumptions: •For eCommerce debit amount calls and limits: When the threshold applied on UC limit is configured for hard-stop actions, such as REJECT or NOTIFICATION-REJECT , the following actions are taken depending on the given conditions: –If the debit amount in request is more than the difference between the threshold limit and the current value of resource, then the request is rejected with an error code as NOT_ENOUGH_CREDIT .
–If the debit amount in request is less than the difference between the threshold limit and the current value of resource, then the call is successful.
When the threshold applied on UC limit is configured for soft-stop actions, such as CONTINUE or NOTIFICATION-STOP , the following action is taken depending on the given condition: –If the debit amount in request is more than the difference between the threshold limit and the current value of resource, then the call is successful and spend notification is sent.
Note : This condition is applicable only to DebitAmount API and not applicable to UCRemainingBalance query.
•A bundle with usage control and no charging service returns the response of UCRemainingBalance from main account balance and distanceToUsageAmount from the ULI in a usage control counter.
However, the DebitAmount API is not executed successfully ( CHARGING_SERVICE_LIST_EMPTY ) as there is no charging service and rating fails to determine from where to charge the amount.
This Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1746Charging User Guide Rating and charging means that the charging service is not mandatory for UCRemainingBalance but is mandatory for DebitAmount API.
•The applicability condition on reference counter is only respected for TOD.
The distanceToUsageAmount is always shown with reference to the ULI of the reference counter in UC during a subscription creation and irrespective of whether during the actual eCommerce call, the UC meets the applicability criteria or not.
If it is found that there are multiple applicable subscriptions associated with the requesting BundleID in an eCommerce call, then the subscription selected is according to the current rating logic.
Both UCRemainingBalance and DebitAmount APIs work according to that subscription.
8.6.4 Examples Consider the following examples for a better understanding of the eCommerce API functionality: Example 1: Usage limit override for reference counter attached in UC Prerequisites: 1.Create a subscription-type counter PTY00515 with Usage Limit set as 720 and Overage Limit set as 10 money with cost-type counter.
2.Create a charging service E-ComCS00515 with selecting the above created counter and having tariff configured in such a way that charging is done from account main balance when Merchant ID condition matches and counter is incremented based on the deduction.
3.Create the Usage Control (UC) with reference counter as the counter created in step 1 with Usage Limit set as 720.
4.Create a bundle PlayUnlimited00515 having the above charging service and usage control.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1747Charging User Guide Rating and charging 5.Create an account and device through Account Profile API.
6.Set the account balance as 1000 .
Figure 85: Account overview before running Direct Debit API Figure 86: Device overview before running Direct Debit API Execution: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1748Charging User Guide Rating and charging 1.Run the getUCRemaining balance API with GPSI as device e164 and bundle_id as above created bundle in step 4 .
2.Run the direct debit for the GPSI for amount 70.
This example verifies: •The getUCRemaining API returns the value of distancetoUsageAmount as 750 because usage limit is being overridden from counter usage limit given in charging service.
•Counter is incremented by 70 given in direct debit request and account balance is deducted with the same amount ( 70) as given in input request.
Figure 87: Account overview after running Direct Debit API Figure 88: UC overview after running Direct Debit API Example 2: Usage limit override for self-counter attached in UC Prerequisites: 1.Create a subscription-type counter PTY00516 with Usage Limit set as 720 and Overage Limit set as 10 money with cost-type counter.
2.Create a charging service with selecting the above created counter and having tariff configured in such a way that charging is done from account main balance when Merchant ID condition matches and counter is incremented based on the deduction.
3.Create the UC with self-counter and Usage Limit set as 720 having applicability condition is set as: ECOMMERCE.Merchant-Id = "merchantid1" 4.Create a bundle PLAYUNLIMITED00516 having the above charging service and UC.
5.Create an account and device through Account Profile API.
6.Set the account balance as 1000 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1749Charging User Guide Rating and charging Figure 89: Account overview before running Direct Debit API Figure 90: Device overview before running Direct Debit API Execution: 1.Run the getUCRemaining balance API with GPSI as device e164 and bundle_id as above created bundle in step 4 .
2.Run the direct debit for the GPSI for amount 76.
This example verifies: •The getUCRemaining API returns the value of distancetoUsageAmount as 750 because usage limit is being overridden from counter usage limit given in charging service.
•Counter is incremented by 76 given in direct debit request and account balance is deducted with the same amount ( 76) as given in input request.
Figure 91: Account overview after running Direct Debit API Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1750Charging User Guide Rating and charging Figure 92: UC overview after running Direct Debit API Example 3: eCommerce API behavior based on TOD defined in UC The Usage Limit object in a UC is configured with the Time of Day (TOD).
Any eCommerce API request that is received during the configured TOD, are rejected with an appropriate error code in response.
Note : The Time of Server (ME) is considered while determining whether TOD is to be barred or not.
Prerequisites: 1.Create a subscription-type counter having Usage Limit set as 720 and Overage Limit set as 10 Money with cost-type counter.
2.Create a charging service with applicability condition as: ECOMMERCE.Merchant-Id = "merchantid1" 3.Select the above created counter in this and tariff is configured in such a way that balance is deducted from the account main balance and counter is incremented based on the deduction.
4.Create the UC with self-counter with Usage Limit set as 750 and TOD given as day as TUESDAY and provide some start time and end time.
5.Create a bundle having the above charging service and UC.
6.Create an account and device through Account Profile API.
7.Set the account balance as 1000 .
Execution: 1.Run the getUCRemaining balance API with GPSI as device e164 and bundle_id as above created bundle in step 4 at the time between start time and end time being configured in TOD under UC.
2.Run the direct debit for the GPSI at the time between start time and end time being configured in TOD under UC.
This example verifies: •The getUCRemaining API returns an error code as CALL_REJECTED_DUE_TO_TOD_BARRED in response.
•The Direct Debit API returns an error code as CALL_REJECTED_DUE_TO_TOD_BARRED in response.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1751Charging User Guide Rating and charging 8.6.5 eCommerce API error codes This section describes the error codes available for eCommerce API.
The API does not send an HTTP error.
Rather the error code is present in the API response.
Error code Description RULE_ NOT_ APPLICABLE This error occurs when the charging service applicability condition fails and no other charging service is defined.
DEVICE_ GPSI_ MISSING This error occurs when the device ID ( GPSI) given in the request is not present in the database.
NO_ SUBSCRIPTION_ ATTACHED_ WITH_ DEVICE This error occurs when there is no subscription attached to the given device.
SM_ REQUEST_ VALIDATION_ ERRCODE This error occurs when the request validation fails.
INVALID_ CURRENCY_ CODE This error occurs when the Currency parameter in request is not a valid Currency code.
CURRENCY_ CODE_ MISMATCH This error occurs when the Currency parameter in request does not match with the Global currency set in NCC.
MUL TIPLE_ COUNTERS_ APPLICABLE This error occurs when there are multiple cost counters applicable to a charging service even after tariff execution.
Example 1: Two cost subscription counters attached to charging service and both counters added in tariff rule.
Example 2: One cost counter ( C1) and one multi- bundle counter ( C2) attached to charging service and cost counter ( C1) is added in tariff rule.
The API returns the amount but not distance to usage.
The status is Success .
CALL_ REJECTED_ DUE_ TO_TOD_ BARRED This error occurs when an e Commerce call lands during the Time of Day ( TOD) , which was configured to be barred in UCLimit.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1752Charging User Guide Rating and charging Error code Description Example: TOD is configured in UC Limit object as Monday 10: 00 AM to 10: 00 PM.
If any ecommerce API is triggered for this UCLimit between this time on any MONDAY, the call is rejected.
8.6.6 eCommerce ECUR transactions CCAi rejection due to insufficient balance/bucket In case of eCommerce ECUR transactions (Service-Context-Id="32270@3gpp.org" AND "Service- Identifier=ANY ("4408644","4408643") ), if there is insufficient credit (Balance+Cost Bucket) to cover the entire CCRi Requested-Service-Units, the request is rejected with Result Code 4012 "Diameter Credit Limit Reached".
Example: Call rejection due to insufficient credit NCC receives a eCommerce ECUR CCAi request.
The CCAi RSU is higher than the available balance + cost bucket.
The request is rejected with result code 4012 Diameter Credit Limit Reached .
Modification to NCC logic to reject all types of Diameter calls For scenarios where a CCRt is received without a previous CCRi, then they are only allowed for eCommerce ECUR transactions.
When the application preference New Call Start in Update or Terminate is enabled, uncorrelated CCRu/CCRt are allowed for all types of Diameter calls.
Operators can limit this behavior to allow eCommerce ECUR transactions only.
See the following example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1753Charging User Guide Rating and charging 8.7 Flexible slicing and quota allocation The flexible slicing feature, applicable to the real-time charging, addresses the quota optimization at the reservation time.
Since each application takes a slice of a session, balance availability must be assured when parallel multiple session are ongoing.
Flexible slicing primarily addresses the quota size.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1754Charging User Guide Rating and charging Figure 93: NCC slicing The validity time of a quota needs to be properly managed and can have an influence on the quota size.
The quota size and quota validity time drive the frequency at which the network element requests a new slice.
As each request representing the signaling traffic and load on the system affects performance, the number of slices should be limited to a bare minimum.
To decrease the amount of interactions between the network and OCS, large quotas valid for a long time should be used.
However, this has a direct impact on the credit that needs to be reserved .
A reserved credit is not available to parallel sessions or events and may not be necessary for the amount of data actually transferred.
To favor the amount of parallel traffic and foster expenses, it is better to limit the quota size and validity time.
The quota limitation is directly dependent on the service offer and the remaining credit of the user.
There can be various elements driving the quota limitation for a given call, such as roaming versus local call, priority session versus normal session, or free versus charged call.
This function handles the flexible allocation of quota (of any unit) for an active session/event and applies charging for that quota to the applicable balance in real time.
Quota is flexibly determined by rules according to the following variables, after which the requests are sent to the Rating Engine that manages the master balance/bucket across multiple sessions of the subscriber: •Category ID received from GGSN Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1755Charging User Guide Rating and charging •Tariff •Date/Time •Zone or location of user •Home or roaming status •SGSN address •Access-Technology , such as GPRS, UMTS, or WLAN •Device Type •Group size In addition to the above list, quota size is influenced by a rule that checks the value of any AVP in the received message, including flexible or configurable AVPs.
The allocated quota size is also influenced by: •Proximity to milestone •Activated features, for example Tariff Time Change (TTC) •Single balance/bucket is supported at individual or group level •Groups and group size •Configurable maximum or minimum values to not allow the quota to be either too large or too small 8.8 Overage functionality The overage is a limit applied on the main account balance and it is the negative limit on the same.
For example, after consuming 500 MB of volume bucket or 500 SMS, a user has 100 United States dollars as the main balance and an overage of 200 United States dollars.
This means that after 500 MB of volume consumption, a user can use the main balance at the rate of 5 United States dollars per MB.
Since the overage limit is 200 United States dollars, the user can use up to 300 United States dollars (100 United States dollars + 200 United States dollars).
If the user is a prepaid subscriber, then the user needs to recharge after using 300 United States dollars.
The overage amount of 200 United States dollars is recovered from the next recharge.
Operators can set a limit on the overage value allowed on the main balance of the account by configuring the overageLimit while creating the account entity.
This field is set to a value that allows the desired overage limit on the main balance of the account.
This functionality is applicable for all call types, such as Immediate Event Charging (IEC), Event Charging with Unit Reservation (ECUR), and Session Charging with Unit Reservation (SCUR).
The default overage limit value is -9999999999 .
Example Consider the following example, Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1756Charging User Guide Rating and charging Bob is associated with a mobile device and makes a data call.
His account is not restricted to zero and can go into negative balance.
Figure 94: Scenario for limit on overage 8.9 Prorate bundle functionality The prorate bundle functionality allows service operators to prorate the value of a service (bundle) or subscription under the following scenarios: •When a new service (bundle) or subscription is added to a device or group using the Change Bundle option, Subscribe Bundle API, or Add Subscription action in the lifecycle.
The subscription can be added in the midway of the billing cycle.
For example, 15th day of the billing cycle.
•When a new device or group is added with a subscription.
•When a billing cycle is updated.
•When a subscription is modified using the Template API.
–For daily subscriptions, the prorating is done based on the number of hours.
–For weekly and monthly subscriptions, the prorating is done based on the number of days.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1757Charging User Guide Rating and charging During calculation, rounding off is not done but calculation precision is considered, and time is measured in milliseconds.
The buckets and counters, which have a periodic lifecycle, are reset by their periodicity.
The allowance limit (buckets) and counters without any periodic cycle are driven by the periodicity of subscription.
The prorating for buckets and counters with periodic cycle and without any periodic lifecycle must be done in the same way.
The prorating preference is picked from the bundle, but the period for prorating is determined from the periodicity of the resources.
The thresholds are reset based on the prorated function instead of the initial values.
Also, the percentage- based notification for that month is based on the percentage of prorated value instead of the actual value.
At the end of the prorated month, when the Billing Cycle Reset (BCR) happens, the subscription returns to its normal value and notifications use this value for further action.
After applying the prorated values to a service (bundle with a counter) before the next billing cycle, NCC sends notification based on the following conditions: •If usage limit is applied, then prorated usage limit (instead of usage limit) is applied to the counter.
After the billing cycle, the usage limit of the counter is used.
Note : The overage limit in a counter is not prorated.
Configuring prorating functionality To configure the prorating functionality, define the values for the following fields in the bundle entity: •Bundle fee / Overidden bundle fee •Fee Reference for Prorate •Bucket Prorate Mode •Counter Prorate Mode •Bundle fee on billing cycle date update For information on the values of the above fields, login to the SM GUI, navigate to Charging & Policy Configuration > Charging and select Bundles .
See the Services (Bundles) on page 1335 for bundle prorating related parameters.
Additional information Following are the points to note for the prorating functionality: •At the time of bundle renewal, refund of fee is done based on the remaining period of bill cycle.
It is not done based on the remaining balance of bucket or counter.
•The prorating functionality is not applicable to carry over bucket.
•If the buckets are prorated, then the threshold based on percentage is executed on the prorated values.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1758Charging User Guide Rating and charging •If the buckets are prorated, then the threshold based on Absolute From Start is executed when configured absolute value is reached.
Prorated bucket values have no impact on the threshold based on Absolute From Start and Absolute From End .
•The prorating function is supported for Charge fee action defined in initial state of periodic lifecycle of a subscription when immediate prorating of charge fees on activation is applicable.
For future activation of subscription, the Charge fee action can be defined in any other state of periodic lifecycle.
•Prorating for counter of the bundle signifies only subscription counter.
Note : A device counter or group counter and device group counters are excluded from this.
•If the Charge fee action is applied multiple times in the initial state, then the fee is prorated each time.
It is recommended to have a configuration of Charge fee action at zero timer at initial state.
•Defining the overage value in a counter is not supported.
•It is recommended not to apply prorate feature to hours/minutes/seconds type of subscription.
•Prorating is done for threshold with Notification-Stop action.
If threshold is applied on counter, then to stop prorate of counter, the counter prorate value in bundle definition must be set to None .
•The periodic lifecycle for a subscription must contain the Reset Period action and either of Renew Subscription action or Reset Subscription action.
The Reset Period action is configured after the Renew Subscription action or Reset Subscription action.
If not configured, then fees deducted or resources reset is not in sync with the end time.
•If you need the current value of counter in threshold notification parameters, then use Counter- Current-Value instead of Threshold-Current-Absolute-Value .
•For a valid lifecycle for an account, the Reset Period action must be in actions to create start time and end time of account or subscription.
•For a valid lifecycle for a subscription, the Reset Period action must be in actions to create start time and end time of subscription.
•Either the Bundle fee/ Overidden fee or Charge fee action is prorated based on the value of the Fee Reference for Prorate value inside the bundle definition.
Note that the fee deducted through the Add Subscription action is also prorated when the respective flags are set as true.
•NCC considers the timezone ID of the account for subscription when the prorating fee is charged, the subscription purchase fee is refunded, the prorated bucket or counter value is calculated, or the billing cycle date is modified.
•When the DayOfMonth is greater than the end of month (number of days in a month), the prorate feature may not work as expected.
For example, consider that DayOfMonth is 31, subscription subscribed on 1st of Feb, end of month is 28.
In monthly subscription, the end date is 28th Feb. Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1759Charging User Guide Rating and charging Prorating bucket/counter values using Override APIs Previously, proration of new bucket/counter values was not supported from Override APIs.
Currently, NCC supports proration of both bucket and counter.
The values to prorate are Allowance limit, Metering limit, Custom counter.
The prorateNeeded in Override API indicates if the values should be prorated or not.
If the prorateNeeded =true, then the values are prorated if the proration flag for activation is enabled on the bundle.
If the prorateNeeded =false, then the values are not prorated regardless of whether the proration flag for activation is enabled or not on the bundle.
The prorateNeeded is available in the following Override APIs: •/subscriber/update/BucketInstance •/subscriber/update/Subscription •/subscriber/update/EntityCounterInstance Preventing prorating of Tiered allowance Previously, the tiered allowance was supported for the following prorating scenarios: •Subscription activation/cancellation •Versioning update •Override APIs Currently, the tiered allowance is excluded for prorating in the preceding scenarios.
Prorating component on subscription cancellation When a subscription is canceled, that is, entity lifecycle is moved to final state, all of its bucket and counter instances of subscription scope are prorated if configured in the proration profile.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1760Charging User Guide Rating and charging The calculation for prorating works the same way as removing a component.
In this case, the event date is the cancellation date.
See Prorate calculation for more details.
If the subscription has previously expired components, they are not prorated.
If a bucket instance has an incremental or decremental override value, then the delta amount is not prorated.
For example, the initial value from the definition is 10 GB and it has an incremental delta value of 5 GB.
In this case, only 10 GB is prorated.
Prorating when a subscription is added in an account or subscription lifecycle A subscription can be added using the Add Subscription action of an account or subscription lifecycle using SM GUI or REST API.
If a device takes a subscription in the midway of a billing cycle, then the values of the following fields are prorated based on the configurations in the bundle definition: •Bundle Fee •Bucket Initial Value •Bucket Current Value The prorating values for bundle is calculated based on the following formula: Prorating Bundle Fee = Bundle Fee * ((Next Renewal Day - Bundle Applicable Day) / Current Bill Cycle Days) Prorating Bucket Initial Value = Bucket Initial Value * ((Next Renewal Day - Bundle Applicable Day) / Current Bill Cycle Days) Prorating Bucket Current Value = Bucket Current Value * ((Next Renewal Day - Bundle Applicable Day) / Current Bill Cycle Days) where: •Next Renewal Time : This can either be the subscription end time or in case, the subscription does not have its own periodic lifecycle, then it refers to the account end time.
•Bundle Applicable Time : This value depends upon the bundle Prorate Granularity value as, which may be Default , Hours , or Days .
Note : The preceding behavior is also applicable to the case when a new device or group is added.
The following list provides information on the formula used to calculate the billing cycle days.
•The following formula is used to calculate the current billing days irrespective of whether a bundle has its own billing cycle or not.
Current billing days = End time - Periodicity •When a bundle has its own billing cycle, then the Current billing cycle days = Subscription End time - Periodicity •When a bundle does not have its own billing cycle date, then the Current billing cycle days = Account End time - Periodicity The following table shows the total duration when the bundle does not have its own billing cycle and is prorated based on account billing cycle.
The periodicity is 1 month.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1761Charging User Guide Rating and charging Account Start Date Account End Date Day of Month in Account Billing InfoSubscription Purchased DateCurrent billing cycle days (Account end date - Periodicity) 29th May 29th June 29 20th June 31 days 29th May 10th June 10 5th June 31 days 29th May 30th May 30 29th May 30 days 15th June 15th July 15 20th June 30 days 15th July 15th August 15 17th July 31 days 24th February 24th March 24 26th February 28/29 days 24th February 24th March 24 12th March 28/29 days The following table shows the total duration when the bundle has its own lifecycle and is prorated based on its own billing cycle.
The periodicity is 1 month.
Subscription Start DateSubscription End DateDay of Month in Bundle Billing InfoSubscription Purchased DateCurrent billing cycle days (Subscription End time - Periodicity) 29th May 29th June 29 27th May 31 days 29th May 10th June 10 5th June 31 days 29th May 30th May 30 29th May 30 days 15th June 15th July 15 15th June 30 days 15th June 15th July 15 12th July 30 days Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1762Charging User Guide Rating and charging Subscription Start DateSubscription End DateDay of Month in Bundle Billing InfoSubscription Purchased DateCurrent billing cycle days (Subscription End time - Periodicity) 24th February 24th March 24 24th February 28/29 days 24th February 24th March 24 12th March 28/29 days Prorating when a subscription is renewed in an account lifecycle A subscription can be renewed using either of the following actions through SM GUI or REST API: •Renew Subscription action for an account •Reset Subscription action or Reset Period action for a subscription lifecycle The prorating behavior is explained using the following examples: Example 1 Provisioning: Consider that an account has an entity lifecycle DefaultAccountLifecycle and a periodic lifecycle with periodic length of 30 days using the Renew Subscription action.
A subscription has a subscription lifecycle SubscriptionEntityLifeCycle and a periodic lifecycle with periodic length of 30 days using the Renew Subscription action, Reset Period action, and Subscription Billing Info set as null or Not Present .
The time related information for account and subscription is as follows: Account Start Time October 5, 2018 10:35 AM End Time November 4, 2018 4:00 AM Subscription Creation Time October 15, 2018 10:33:51.020 AM Start Time Monday, October 15, 2018 10:33:51.490 AM End Time Wednesday, November 14, 2018 4:00:00 AM Result: The end time of subscription crosses the end time of account.
In this case, the bundle fees is deducted without prorating.
It gets deducted again on November 4, 2018.
Therefore, the bundle fees is charged twice for the period of November 4, 2018 to November 14, 2018.
To prevent the fees getting deducted from account for Renew Subscription action, specify the billing information for subscription.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1763Charging User Guide Rating and charging Example 2 Consider that an account has an entity lifecycle named DefaultAccountLifecycle and a periodic lifecycle with period length of 1 month and the day of month set as 23.
A subscription has a SubscriptionEntityLifeCycle and a periodic lifecycle with periodic length of 1 month with Renew Subscription action and Reset Period action.
The time related information for account and subscription is as follows: Account Start Time October 24, 2018 1:30 PM End Time November 23, 2018 12:00 AM Subscription Creation Time October 24, 2018 02:30:00 PM Start Time October 24, 2018 02:30:00 PM End Time November 23, 2018 02:00:00 PM Actual End Time: As per 1 month calculation: November 23, 2018 02:30:00 PM The end time is 30 minutes less than the calculated actual end time.
Following calculation shows the actual billable hours: Start Time: 24th October 02:30:00 PM (in milliseconds: 1540391400000) End Time: 23rd November 02:00:00 PM (in milliseconds: 1542981600000) Duration in milliseconds = 1542981600000 - 1540391400000 = 2590200000.
Converting the value in hours: 2590200000 / 60*60*1000 = 719.5 hours.
Note : The value (time) is used as it is without rounding off but with calculation precision as per configuration.
Prorate factor = 719.5/744 Example 3 Consider that an account has an entity lifecycle named DefaultAccountLifecycle and a periodic lifecycle with period length of 1 month and day of month set as 24.
A subscription has a SubscriptionEntityLifeCycle and does not have its own periodic lifecycle.
The time related information for account and subscription is as follows: Account Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1764Charging User Guide Rating and charging Start Time November 23, 2018 1:30 PM End Time December 24, 2018 12:00 AM Subscription Creation Time December 5, 2018 02:30:00 PM Start Time December 5, 2018 02:30:00 PM End Time December 23, 2018 02:00:00 PM Actual End Time: As per 30 days calculation: December 23, 2018 02:30:00 PM The end time is 30 minutes less than the calculated actual end time.
Following calculation shows the actual billable hours: Start Time: 24th November 02:30:00 PM (in milliseconds: 1540391400000) End Time: 23rd December 02:00:00 PM (in milliseconds: 1542981600000) Duration in milliseconds = 1542981600000 - 1540391400000 = 2590200000 Converting the value in hours: 2590200000 / 60*60*1000 = 719.5 hours.
Note : The value (time) is used as it is without rounding off but with calculation precision as per configuration.
In this case, since the bundle does not have its own lifecycle, the total duration is 30 days.
It is account end time - periodicity = 30 days = 720 Prorate factor = 719.5/720 Prorating for a Subscribe Bundle or Remove Bundle API In case of the Subscriber Bundle or Remove Bundle API, if the bundle fee is greater than zero, then the Bundle fee / Overidden bundle fee and Fee Reference for Prorate defined in the bundle are checked to confirm whether prorating fee must be applied to a bundle.
If there are buckets and counters in the bundle, then NCC checks their prorating modes and takes actions accordingly.
The following figure shows the prorating fields in the SM GUI.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1765Charging User Guide Rating and charging Figure 95: Prorating The following table provides information on different actions taken based on the value set for the Bundle fee / Overidden bundle fee parameter.
Bundle fee / Overridden bundle fee Action None No prorating fee for the bundle.
Subscription Start NCC prorates the bundle fee according to the exact available day of the current bill cycle using the given formula:Table 192: Bundle fee / Overridden bundle fee Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1766Charging User Guide Rating and charging Bundle fee / Overridden bundle fee Action Prorating Bundle Fee = Bundle Fee * (( Next Renewal Day - Bundle Applicable Day) / Current Bill Cycle Days) Subscription End NCC refunds the bundle fee according to the days left in the bill cycle using the given formula: Refund Bundle Fee = Bundle Fee * ((Next Renewal Day - Bundle Applicable Day -1) / Current Bill Cycle Days) Note : (-1) in the formula is to exclude the current day from the remaining days.
Both When the subscription is taken or removed, NCC prorates the bundle fee accordingly using the given formula: Prorating Bundle Fee = Bundle Fee * (( Next Renewal Day - Bundle Applicable Day) / Current Bill Cycle Days)Table 192: Bundle fee / Overridden bundle fee (continued) The following table provides information on different actions taken based on the value set for the Bucket Prorate Mode parameter.
Bucket Prorate Mode Action None No prorating for the bucket value.
Subscription Start NCC prorates the bucket value according to the exact available day of the current bill cycle using the given formula: Prorating Bucket Value = Bucket Initial Value * ((Next Renewal Day - Bundle Applicable Day) / Current Bill Cycle Days)Table 193: Bucket Prorate Mode Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1767Charging User Guide Rating and charging Bucket Prorate Mode Action Note that the prorating bucket value is used as bucket initial value temporarily in the current bill cycle.
In the next bill cycle, the defined bucket initial value is used.Table 193: Bucket Prorate Mode (continued) The following table provides information on different actions taken based on the value set for the Counter Prorate Mode parameter.
Counter Prorate Mode Action None No prorating for the counter value.
Subscription Start NCC checks the counter prorating limit value according to the exact available day of current bill cycle of counter limit value using the following formula: Prorating Bucket Value = Bucket Initial Value * ((Next Renewal Day - Bundle Applicable Day) / Current Bill Cycle Days) If a limit is defined for the counter or usage limit, then the following formula is used for prorating limit value calculation using the following formula: Prorating Limit Value = usage limit * (( Next Reset Day - Bundle Applicable Day) / Current Bill Cycle Days) The prorating limit value is used as counter limit value temporarily in the current bill cycle.
Note : If overage value is defined for a counter, then it is not prorated.Table 194: Counter Prorate Mode Prorating bundle fee based on the prorated fee selection The following figure shows the Fee Reference for Prorate option available in the SM GUI and based on its selection, NCC performs the prorating function.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1768Charging User Guide Rating and charging If the Bundle fee / Overidden bundle fee is not set as None and the Fee Reference for Prorate is set as Bundle fee / Overridden fee , then the prorating is applied as follows: •Prorating is taken care when a new device or group is added with subscription.
•Prorating is taken care when a new subscription is attached to a device or group.
•Prorating is taken care when a new subscription is added to a device or group using the Add Subscription action in lifecycle.
•Prorating is taken care when a subscription has its own bill cycle.
If the Charge fee action is triggered inside any other state apart from initial state of periodic lifecycle of a subscription, then NCC checks for Charge fee action in the Fee Reference for Prorate and a valid future activation date for charge fee prorate as applicable.
Prorating bundle fee based on billing cycle modification When the Renew Subscription action is triggered, NCC checks prorating since there may be an update in the billing cycle date.
If the billing cycle information ( Day of Month or Day of Week ) is changed for an account or subscription, then NCC checks the following: •Whether subscriptions are attached to an account whose billing cycle information is changed.
•Whether subscription under the device is directly attached to an account.
•Whether devices in the group are attached to an account.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1769Charging User Guide Rating and charging If the Bundle fee on billing cycle date update prorating mode is not set as None, then NCC prorates the bundle fee and bucket or counter values as follows: Prorate mode Action Prorate NCC prorates based on controlling parameters in the bundle definition.
For Bundle fee / Overridden bundle fee, prorate is done as long as it is not None .
The Fee Reference for Prorate parameter is not considered in this case.
Force Prorate NCC prorates without considering the values of controlling parameters in the bundle definition.
When the BCR happens in the old billing cycle end date, if prorating is needed, then the Prorated Value = original full value * (new bill cycle end date - old bill cycle end date) / current bill cycle days .
For the bundle fee, the prorated bundle fee is charged to the account.
For bucket value, the prorated value is added to the current value of bucket.
The counter limit is also prorated.
If the new bill cycle end date equals the old bill cycle end date, then there is no prorating.
Note : The bill cycle end date is the latest end date based on day of month and current date.
Example Provisioning: 1.Create a subscription on the first of the month and billing cycle is set as first of every month.
The subscription has a monthly lifecycle and the billing cycle associated with the subscription is updated.
2.A bundle has a prorating configuration of Bundle fee / Overidden bundle fee , Bucket Prorate Mode set as Subscription Start , and Bundle fee on billing cycle date update set as Prorate .
Result: In the next billing cycle, prorating of renewal fee, bundle fee, or bundle fee and bucket initial value or bucket current value is done.
Prorating when end time of a subscription is modified If the end time of a subscription is updated, then NCC prorates the associated bundle parameters.
If the end time is changed using the REST API, then no prorating is done.
Note : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1770Charging User Guide Rating and charging •If the end time of the subscription is increase by x number of days, then prorating does not charge extra for those x number of days.
Subscriber gets those x number of days without any cost.
•If the end time of the subscription is decreased by x number of days, then prorating does not refund for those x number of days.
Subscriber gets charged twice for those x number of days in case of renewal of periodic cycle.
Example 1: Manually updating the subscription end time Provisioning: 1.Set the Subscription Start Time as 01/11/2018 .
2.Set the Subscription End Time as 01/12/2018 .
Result: On 15/11/2018, the billing information is changed as Day of Month set as 15.
During BCR on 01/12/2018, next billing cycle starts from 01/12/2018 and lasts till 15/12/2018.
During the next billing cycle, prorating happens depending on the flags.
The current billing cycle days is 30 in this case, that is, 01/12/2018 - Monthly periodicity.
Example 2: Updating subscription end time using REST API Provisioning: 1.Set the Subscription Start Time as 01/11/2018 .
2.Set the Subscription End Time as 01/12/2018 .
Result: If you change the end time from 01/12/2018 to 04/12/2018 using the updateTime REST API, then subscriber is not charged for days between 04/12/2018 to 01/12/2018.
Prorating when a bundle is modified using Change Bundle option When a bundle is modified using the REST API or SM GUI, NCC prorates associated bundle parameters.
For example, a bundle has a periodic lifecycle of one month and the Change Bundle option is used to modify it using the Immediately with prorating mode.
The API has a prorating configuration for Bundle fee / Overidden bundle fee and Bucket Prorate Mode .
The end time is calculated less than the expected renewal time, which means the subscription is available for 15 days of the current billing cycle.
In this case, the Bundle fee / Overidden bundle fee and associated bucket initial and current values are prorated.
Prorating when a bundle is customized using the Template API If the bucket initial and current values are updated using the Template API ( update/BucketInstance ), then NCC prorates the associated bundle parameters.
For example, a subscription is created on first of month and billing cycle is first of every month.
Subscription has a monthly lifecycle, the bucket initial value is updated in permanent mode, and Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1771Charging User Guide Rating and charging subscription billing cycle is updated.
Bundle has prorating configuration of Bundle fee / Overidden bundle fee, Bucket Prorate Mode and Bundle fee on billing cycle date update .
In the next billing cycle, bucket initial and current value are prorated with updated initial values.
If change in initial value is temporary, then the bucket initial and current value are prorated with values retrieved from the bundle definition.
Prorating when a subscription is scheduled for a future date using the activation date A subscription can be scheduled for a future date by setting the activation date.
For example, subscription is taken on 5th day of the billing cycle and activated on 10th day of the billing cycle.
If... Then.
..
The Bundle fee / Overidden bundle fee is not set as None , and The Charge fee action is triggered from any state and subscription has a future activate date,NCC checks whether the Fee Reference for Prorate is set to Charge fee action .
If yes, then NCC prorates the charge fee when the current date or activated date is not equal to the billing cycle date.
Example Provisioning: A device purchases a subscription and fee reference is set to Charge fee action and subscription has a future activation.
Result: A device subscribes a subscription with future activation, which is prorated based on the end date of an account.
The account balance is 3000.
For this case, let us consider that the prorating is done based on the selections made as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1772Charging User Guide Rating and charging In the lifecycle, a bundle subscription lifecycle is defined with Charge fee action set to 1000 as shown in the following figure: Configuring subscription with a future activation date as shown in the following figure: The following figure shows the prorated charge fee deduction and the value of buckets after prorating is applied: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1773Charging User Guide Rating and charging Examples Assume the following conditions for the examples listed in this section: •Lifecycle of subscription or account is properly configured.
•If the periodicity of a lifecycle is defined in days, weeks, or months, then NCC affects the end time of subscription at the time of subscription.
•If subscription is deleted before the expected end time, then NCC gives the refund based on duration difference.
Case 1: When a bundle attached to a device does not have a billing lifecycle Provisioning: The following table has details about the bundle with prorate field values: Bundle nameFee Charge FeeBucket/ CounterInitial valueBundle fee / Overridden bundle feeFee reference for prorateBucket Prorate ModeCounter Prorate ModeBundle fee on billing cycle date update BD1 10 USD20 USDBucket1 Counter12 GB 5 GBBoth Bundle fee/ Overridden feeSubscription StartSubscription StartNone BD2 20 USD30 USDBucket2 4 GB Subscription StartCharge Fee actionNone None Prorate BD3 10 USD30 USDBucket1 2 GB Subscription EndBundle fee/ Overridden feeSubscription StartNone Force Prorate Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1774Charging User Guide Rating and charging Bundle nameFee Charge FeeBucket/ CounterInitial valueBundle fee / Overridden bundle feeFee reference for prorateBucket Prorate ModeCounter Prorate ModeBundle fee on billing cycle date update BD4 10 USD30 USDBucket2 4 GB Subscription StartCharge Fee actionSubscription StartNone Prorate Result: This example shows the case where the account has a billing lifecycle of one month and bundle does not have billing lifecycle.
The account start date is 15th April and account end date is 15th May.
A subscription is purchased on 29th April.
The following table shows the prorated values.
Action Fee (Bundle fee)Charge Fee Bucket current value Counter prorating limit Device is attached to BD15 USD Fee = 10* (15/30)20 USD Bucket 1 = 1 GB Value = 2GB* (15/30)2.5 GB Device is attached to BD220 USD 15 USD Fee = 30* (15/30)Bucket 2 = 4 GB - Device is attached to BD310 USD 30 USD Bucket 1 = 1 GB Value = 2GB* (15/30)- Device is attached to BD410 USD 15 USD Fee = 30* (15/30)Bucket 2 = 2 GB = 4 GB*(15/30)- Case 2: When a bundle attached to a device has a billing lifecycle Provisioning: The following table has details about the bundle with prorate field values: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1775Charging User Guide Rating and charging Bundle nameFee Charge FeeBucket/ CounterInitial valueBundle fee / Overridden bundle feeFee reference for prorateBucket Prorate ModeCounter Prorate ModeBundle fee on billing cycle date update BD1 10 USD 20 USD Bucket1 Counter12 GB 5 GBBoth Bundle fee/ Overridden feeSubscription StartSubscription StartNone BD2 20 USD 30 USD Bucket2 4 GB Subscription StartCharge Fee actionNone None Prorate BD3 10 USD 30 USD Bucket1 2 GB Subscription EndBundle fee/ Overridden feeSubscription StartNone Force Prorate BD4 10 USD 30 USD Bucket2 4 GB Subscription StartCharge Fee actionSubscription StartNone Prorate Result: This example shows the case where the bundle has a monthly billing cycle.
A subscription is purchased on 15th May and subscription end date is 15th June.
The following table shows the prorated values.
Action Fee (Bundle fee)Charge Fee Bucket current value Counter prorating limit Device is attached to BD15 USD Fee = 10* (15/31)20 USD Bucket 1 = 1 GB Value = 2GB* (15/31)2.5 GB Device is attached to BD220 USD 15 USD Fee = 30* (15/31)Bucket 2 = 4 GB - Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1776Charging User Guide Rating and charging Action Fee (Bundle fee)Charge Fee Bucket current value Counter prorating limit Device is attached to BD310 USD 30 USD Bucket 1 = 1 GB Value = 2GB* (15/31)- Device is attached to BD410 USD 15 USD Fee = 30* (15/31)Bucket 2 = 2 GB = 4 GB*(15/31)- Case 3: When a device purchases a subscription and fee reference is set to Bundle fee or overridden fee Provisioning: 1.Subscribe an iPhone device to a subscription, which is prorated based on the end date of an account.
2.Configure the account balance is 2000 United States dollars.
3.For this case, let us consider that the prorating is done based on the selections made as shown in the following figure: 4.In the Charging Service , two buckets with 100 GB and 100 Money type are defined as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1777Charging User Guide Rating and charging Result: The following figure shows the value of buckets after prorating is applied.
Case 4: When a device purchases a subscription and fee reference is set to Charge fee action Provisioning: 1.Subscribe an iPhone device to a subscription, which is prorated based on the end date of an account.
2.Configure the account balance is 3000 United States dollars.
3.For this case, let us consider that the prorating is done based on the selections made as shown in the following figure: 4.In the Charging Service , two buckets with 100 GB and 100 Money type are defined as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1778Charging User Guide Rating and charging 5.In the lifecycle, a bundle subscription lifecycle is defined with Charge fee action set to 2000 as shown in the following figure: Result: The following figure shows the value of buckets after prorating is applied.
Case 5: Prorating threshold for notifications Provisioning: 1.Configure a monthly data plan with a bundle of 1 GB and threshold notifications set at 50%, 75%, and 100% usage of the data bundle.
2.Add a device in the midway of a billing cycle (15th day of bill cycle) of a 30 day month.
Result: For the first month, device is allotted a subscription of 500 MB and notifications are sent on consumption of 250 MB, 375 MB and 500 MB of data bundle.
After the BCR, the subscription values are reset to the value of 1 GB bundle, and notifications are sent at 500 MB, 750 MB, and 1 GB of data usage.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1779Charging User Guide Rating and charging Providing granularity to prorating In addition to the existing prorating behavior wherein we consider the difference of exact current time and end time to calculate prorating values for service (bundle), allowance limit (bucket), and thresholds.
The Prorate Granularity parameter provides flexibility to round-off the prorate fees and other values to Days and Hours .
Note : It is recommended to not select granularity less than a lifecycle timer unit.
For example, if granularity is DAYS , then the lifecycle unit must be set as Days and not Hours .
The prorating values for bundle is calculated based on the following formula: Prorating Bundle Fee = Bundle Fee * ((Next Renewal Time - Bundle Applicable Time) / Current Bill Cycle Days) Prorating Bucket Initial Value = Bucket Initial Value * ((Next Renewal Time - Bundle Applicable Time) / Current Bill Cycle Days) Prorating Bucket Current Value = Bucket Current Value * ((Next Renewal Time - Bundle Applicable Time) / Current Bill Cycle Days) where: •Next Renewal Time: This can be either subscription end time or in case, subscription does not have its own periodic life cycle, then account end time is considered.
•Bundle Applicable Time: This value depends on bundle prorate granularity value as: –DEFAULT : Current time is considered as Bundle Applicable Time .
–HOURS : Rounded to current hour of the day.
For example, if current time is 06 March 2020 17:45:45:237 and prorate granularity is HOUR , then Bundle Applicable Time becomes 06 March 2020 17:00:00:000 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1780Charging User Guide Rating and charging –DAYS : Rounded to current day start time or if life cycle is account and “hour of the day” is present in billing information, then Bundle Applicable Time is rounded to that “hour of the day” time of current or previous day.
For example, if subscription does not have its own periodic life cycle and account has periodic lifecycle with below details: Periodic lifecycle with timer Units set as Month and timer value set as 1.
Assume that current time is 06 March 2020 17:45:45:000 .
1.Case 1: Billing information is set as: hourOfDay set as 5 DayOfMonth set as 18 If end time is 18 March 2020 5:00:00:000 and prorate granularity is DAYS , then Bundle Applicable Time becomes 18 March 2020 05:00:00:000 .
2.Case 2: Billing information is set as: hourOfDay set as 19 DayOfMonth set as 18 If end time is 18 March 2020 19:00:00:000 and prorate granularity is DAYS , then Bundle Applicable Time becomes 05 March 2020 19:00:00:000 .
3.Case 3: Billing information is set as: DayOfMonth set as 18 If end time is 18 March 2020 00:00:00:000 and prorate granularity is DAYS , then Bundle Applicable Time becomes 06 March 2020 00:00:00:000 .
•Current Bill Cycle Days = End time – Periodicity wherein periodicity is lifecycle period length (timer value * timer units).
For example, if end time is set as 06 March 2020 00:00:00 , timer value is 1, and timer units is Month , then time becomes 06 Feb 2020 00:00:00 .
Therefore, current billing cycle is 28 days as it lies in February month.
Similarly, if counter prorate mode is available with subscription start, then the formula is: Prorating Limit Value = Cap Value/Max Limit * ((Next Reset Time - Bundle Applicable Time) / Current Bill Cycle Time) If billing cycle information gets modified, then the formula is: Prorated Value = original full value * (new bill cycle end time - old bill cycle end time) / current bill cycle time The following table shows the total duration when the bundle has bucket of type VOLUME and initial value as 10000 and does not have its own billing cycle and is prorated based on account billing cycle.
The periodicity is 1 month, current time is 05:30 PM and rounding mode is CEILING.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1781Charging User Guide Rating and charging Account Start TimeHour of the day in Account Billing InfoDay of the Month in Account Billing InfoAccount End TimeSubscription Purchased Date or Current DateCurrent billing cycle days ( Account end time - Periodicity)Bundle Applicable Time when Prorate Granularity (In DAYS)Bundle Applicable Time when Prorate Granularity (In HOURS)Prorated Bucket initial value when prorate bucket multiplier factor is 0.
Granularity in HOUR/ DAYSProrated Bucket initial value when prorate bucket multiplier factor is 2048.
Granularity in HOUR/ DAYS 29th Dec NA 29 29th Jan, 00:0020th Jan 31 days 20th Jan, 00:0020th Jan, 17:002674/ 29034096/ 4096 15th Dec 20 15 15th Jan, 20:007th Jan 31 days 6th Jan, 20:007th Jan, 17:002620/ 29034096/ 4096 24th Feb 15 24 24th Mar, 15: 0012th Mar 29 days 12th Mar, 15: 0012th Mar, 17: 004109/ 41374096/ 4096 The following table shows the total duration when the bundle has bucket of type VOLUME and initial value as 10000 and is prorated based on its own billing cycle.
The periodicity is 1 month, current time is 05:30 PM and rounding mode is CEILING.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1782Charging User Guide Rating and charging Subscription Start TimeHour of the day in Subscription Billing InfoDay of the Month in Subscription Billing InfoSubscription End TimeCurrent DateCurrent billing cycle days ( Subscription end time - Periodicity)Bundle Applicable Time when Prorate Granularity (In DAYS)Bundle Applicable Time when Prorate Granularity (In HOURS)Prorated Bucket initial value when prorate bucket multiplier factor is 0.
Granularity in HOUR/ DAYSProrated Bucket initial value when prorate bucket multiplier factor is 1024.
Granularity in HOUR/ DAYS 29th Dec NA 29 29th Jan, 00:0020th Jan 31 days 20th Jan, 00:0020th Jan, 17:002674/ 29033072/ 3072 15th Dec 20 15 15th Jan, 00:007th Jan 31 days 7th Jan, 00:007th Jan, 17:002352/ 25803072/ 3072 24th Feb 15 24 24th Mar, 00: 0012th Mar 29 days 12th Mar, 00: 0012th Mar, 17: 003894/ 41384096/ 4096 Note : •If bucket initial or current value is less than the bucket prorate factor, then the bucket is assigned to initial or current value.
•Prorated counter cap value is greater than what we have expected.
This is due to existing implementation where it round-off the prorate factor.
For example, consider a scenario where account has monthly life cycle with hour of the day as 8:00 PM and day of the month is 12. let us assume that today is 12th March and time is 6:40 PM and we subscribe bundle with prorate granularity as DAYS , bucket volume as 1000 bytes and counter with cap value as 500 bytes .
The prorate factor obtained is 0.03449 .
Therefore, bucket initial or current value is approximately 35 bytes .
For counter cap value, prorate factor 0.03449 is rounded-off further to 0.04 .
Therefore, counter cap value obtained is 20 bytes .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1783Charging User Guide Rating and charging Rounding off the prorated values NCC provides the provision to round off the prorated bucket values.
Rounding of Bucket Values parameter in the proration profile allows you to configure the rounding mechanism to be applicable for rounding off the prorated bucket values.
Rounding of Bucket Values parameter can take the following values: •Rounding down: The value is rounded off to the nearest larger value.
For example: If the value after proration is 22.7 MB, then after rounding down, the value is 22 MB.
The value after decimal point is rounded down.
•Rounding up: The value is rounded off to the nearest smaller value.
For example: If the value after proration is 22.4 MB, then after rounding up, the value is 23 MB.
The value after decimal point is rounded up.
•Rounding to nearest value: The value is rounded off to the nearest value.
For example: If the value after proration is 22.4 MB, then after rounding to the nearest value, the value is 22 MB.
Similarly, if the value is 22.7 MB, then it is rounded off to 23 MB.
•Default NCC rounding: If this value is selected, then default rounding mechanism is used to round off the prorated values.
8.
10 Bundle On Use (BOU) functionality The Bundle On Use (BOU) is defined as a bundle that is activated using a configurable event, such as voice call, data session, SMS, or any other similar events.
The service providers use two application preferences BOU Usage Priority and BOU Activation Priority to determine whether BOU activation is required based on the default behaviour, reservation, or on-commit, and their priority order based on the Charging Service (CS) priority order or activation only when no other resource is available.
The BOU bundle has an activation fee, which is charged from the subscription lifecycle, and a monthly renewal fee, which is charged from the account lifecycle.
The discount is provided based on any criteria or condition defined in a rule.
For example, discount can be provided based on the number of times the BOU feature is activated.
The operators define a validity period for a BOU bundle.
The BundleOnUse (BOU) type of bundles can have the buckets and counters with a separate periodic lifecycle, provided the BOU bundles also have a periodic lifecycle.
A BOU bundle is subscribed by a device or group, and a notification is sent under the following scenarios: •BOU activation •BOU deactivation •BOU suspension •Renewal from subscription lifecycle Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1784Charging User Guide Rating and charging Note : The activation of a BOU bundle depends on the device location for VoL TE, Gy, or 5G calls.
For information on CDR/EDRs, see the Nokia Converged Charging CDR/EDR Reference Guide .
8.
10.
1 Available rules Source context attribute SUBSCRIPTION.Type-Of-Count is available in APPLICABILITY trigger to configure type of count.
SUBSCRIPTION.Type-Of-Count (< ENUM >) Following are the supported values for the ENUM parameter: •ENUM_BOU-Activation-Fee: Indicates BOU activation fee is charged for BOU bundle during activation.
If the applicability condition of counter for Type-Of-Count is BOU Activation fee then only BOU activation fee is counted.
See usage: SUBSCRIPTION.Bundle-Id = "BOU1" and CALL_COMMON.Call-Roaming-Status = RoamingDecision.Roaming and SUBSCRIPTION.Type-Of-Count = ENUM_BOU-Activation-Fee •ENUM_Usage: It is the default value.
It indicates usage cost is deducted from main balance or bucket.
If the applicability condition of counter for Type-Of-Count is Usage then only usage is counted.
See usage: SUBSCRIPTION.Bundle-Id = "BOU1" and CALL_COMMON.Call-Roaming-Status = RoamingDecision.Roaming and SUBSCRIPTION.Type-Of-Count = ENUM_Usage If applicability condition of counter does not contain Type-Of-Count , then both usage and BOU activation fee are counted.
See usage SUBSCRIPTION.Bundle-Id = "BOU1" and CALL_COMMON.Call-Roaming-Status = RoamingDecision.Roaming 8.
10.2 Configuration Configuring BOU to use billing information of a linked account If the BOU bundle has billing information, which means the BOU bundle is prorated as per the billing information, then the BOU part is also prorated as per the proration configuration within a bundle.
If the BOU bundle has no billing information, then it has an exact period as per the periodic length defined in a lifecycle.
However, BOU can be configured to refer billing information of the linked account for end Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1785Charging User Guide Rating and charging datetime calculation.
The Align-With-Account-BC attribute in the BUNDLE result context is used for this configuration as follows: BUNDLE.Align-With-Account-BC = BooleanEnum_TRUE Figure 96: Rule example in Bundle to align with account balance Configuring a BOU bundle Follow the given steps: 1.Configure the BOU bundle by setting the Bundle Activation Type field value as On Session at the time of bundle creation.
2.Activate the BOU bundle by defining a rule that specifies the criteria for BOU activation and actions, such as Activation-Fee .
Activation fee is applied to account balance, multi-bundle cost counters, and global counters.
It is not supported for Counter Incrementation Type = Account ; set this only to All.
Note : The rules are mandatory for BOU-type bundle and atleast one rule must be present, and in the rule, atleast a single action must be present with the Activation-Event name.
This event is configured in the periodic lifecycle, which further activates the BOU bundle.
3.The service providers use two application preferences BOU Usage Priority and BOU Activation Priority to determine when the BOU bundle must be activated.
Following are the supported values for the BOU Usage Priority : •DEFAULT_SORTING_ORDER , which implies that CS priority order is followed.
•LEAST_PRIORITY_ORDER , which implies that the BOU bundle is consumed only when no other resource is available.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1786Charging User Guide Rating and charging Following are the supported values for the BOU Activation Priority : •DEFAULT •ON_COMMIT , which implies that the BOU bundle is activated on-commit.
•ON_RESERVATION , which implies that the BOU bundle is activated on-reservation.
For information on application preferences, refer to section Managed Element application preferences in the Global Configuration Guide .
4.Follow the steps listed in the Charging application preferences section in the Global Configuration Guide .
Note : If a BOU bundle rule is applicable for a call and Account is able to pay BOU activation fee, then its activation is based on the following conditions: •If BOU Activation Priority = DEFAUL T or ON_RESERVATION, then if a BOU bundle rule is applicable for a call, then the BOU activation fee is charged from the account, irrespective of whether the actual reservation is done from its resources.
For example, if a BOU bundle rule is applicable for a call whereas CS applicability is not, then the precedence is given to BOU bundle rule and BOU subscription is activated.
•If BOU Activation Priority = ON_COMMIT, then the following logic is applied: 1.If nothing can be reserved from BOU subscription either due to Charging Service rule not applicable/rule engine bypass applied in pass0 tariff, in such case, BOU subscription is not activated.
2.If BOU bundle has a step bucket applied in its pass0 tariff and nothing can be reserved from BOU subscription, BOU subscription is not activated.
3.If BOU bundle does not have step resource applied in pass0 tariff and nothing can be reserved from BOU subscription, then following logic is applied: a.
If initial value of non-step bucket = 0 : BOU subscription is activated b. Bucket type is mismatch (RSU type is different from Bucket type) : BOU subscription is activated c. If Device is unable to reserve any quantity from BOU bundle and any other resource, rating session is not created, hence there will be no commit.
In such case, BOU fee will be charged and BOU will be activated in the current call.
Attention : Currently, there is difference in behavior of BOU activation wrt to resource applied in Pass 0 (step or non-step), as mentioned in point (2) and (3) above.
In future, point (3) (non step resource) will be streamlined as per behavior mentioned in point (2) (step resource).
NCC behavior and BOU activation based on values of application preferences The following table shows NCC behavior when different values are used for the application preferences.
It is recommended to select an appropriate value for the application preferences based on your requirement.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1787Charging User Guide Rating and charging BOU Usage Priority BOU Activation Priority NCC behavior and BOU activation Not Applicable DEFAULT The existing behavior is followed and all applicable BOU bundles are activated during reservation, irrespective of whether they are used in call or not.
Note : The value of the BOU Usage Priority is not considered when the BOU Activation Priority value is set as DEFAULT .
DEFAULT_ SORTING_ ORDER ON_ RESERVATION BOU bundles are activated during reservation, as per their Sorting Order only when required.
LEAST_ PRIORITY_ ORDER ON_ RESERVATION All active resources are used, which is further followed by BOU bundles that get activated during reservation only when required.
DEFAULT_ SORTING_ ORDER ON_ COMMIT BOU bundles are activated during commit as per their Sorting Order only when required.
LEAST_ PRIORITY_ ORDER ON_ COMMIT All active resources are used followed by BOU bundles that get activated during commit only when required.
Recommended lifecycle configuration for a BOU bundle Follow the example listed in the given sub-sections in the similar order to configure the lifecycle for a BOU bundle: Account bill cycle Create an account bill cycle AccCycle1 , which is further linked to the account to be used for the BOU subscription and has the following configuration: 1.The renewal period for this account bill cycle is set as 1 month and this bill cycle has two sample states Start and Suspended as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1788Charging User Guide Rating and charging 2.In the Start state, the transition is based on the following events: a.First, we want to reset the account period and to do so, the start date and end date must be reset immediately after an account is created, when the subscription fee is already charged while subscribing the bundle on this account.
This is shown in the following figure: b.Next, a Repeat Cycle Event is triggered when the end time of the account is reached.
All subscriptions for normal or BOU bundles associated with this account are renewed.
Also, the start time and end time gets reset to be triggered again in future.
The renewal of subscription is managed through the account bill cycle for BOU type bundles.
This is shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1789Charging User Guide Rating and charging c.This renewed subscription charges the renewal fee and does not reset this subscription for BOU.
If the renewal fee is successfully charged, then the Subscription Renewed Event is triggered, which resets the start time and end time so that it can be triggered again.
However, if there is any failure to charge renewal fee, then the Not Enough Funds Event is triggered on both account bill cycle and the subscription bill cycle.
When the Not Enough Funds Event is triggered on the account bill cycle in the Start state, it transits to the Suspended state as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1790Charging User Guide Rating and charging 3.Configure the Suspended state to be normal and not barring.
a.The reason to configure this kind of state is that when Account Recharged Event is triggered while being in the Suspended state, the subscription renewal must be retried.
If the Renew Subscription Action is successful, then it transits back to the Start state again.
This configuration is shown in the following figure: The Account Recharged Event is triggered when an account balance is credited in one of the following scenarios: •Adjust the account balance with a positive value.
•Set the account balance to a value greater than the current account balance.
•Reset the account balance to a value greater than the current account balance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1791Charging User Guide Rating and charging b.Configure that when the Subscription Renewed Event is triggered, the account period is reset.
If the Reset Period Action is successful, then the Suspended state transits back to the Start state again.
This configuration is shown in the following figure: Subscription bill cycle After completing the account bill cycle configuration, create a subscription bill cycle SubscBillCycle , which is further linked to the BOU-type bundle and has the following configuration: 1.The subscription bill cycle period is set as 1 day , which means that whenever a bundle (to which this lifecycle is attached) is activated, it remains active only for a day and deactivated soon after that.
Note : The renewal cycle is controlled by the account period lifecycle and the activation cycle is further controlled by the subscription periodic lifecycle.
Create the following sample states for the subscription bill cycle: •Start •Pre-Active •Active •Suspended •Final This configuration is shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1792Charging User Guide Rating and charging 2.The Start state has only one transition that initialized the lifecycle to its initial state as shown in the following figure: 3.The Pre-Active state has the following transitions: Note : The event name must be same as action defined in the bundle rule.
a.In the first transition, we have configured for Activate By Voice event.
Similarly, you can define the activation by data, SMS, or MMS events.
When the Activate By Voice event is triggered, an activation fee is charged from the account as per the Charge Fee Action associated with the event.
This activation fee can either be specified here or it can be passed from the rules configured in the bundle.
Note that the activation fee received from bundle rules has precedence over the activation fee defined here.
This configuration is shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1793Charging User Guide Rating and charging The event to be triggered next is identified by the rules configured in the bundle definition and the event gets executed when the BOU bundle is in the Pre-Active state.
The Charge Fee Action generates the following events depending on given configurations: BOU Activation Priority Events generated DEFAULT or ON_ RESERVATION •If the fee is successfully deducted then the Charge Fee Action Success Event is triggered.
•If the fee deduction fails, then the Charge Fee Action Failure Event is triggered.
ON_ COMMIT •If the activation fee is successfully reserved from the account during a reservation call, then the Account Reservation Success Event is triggered.
•If the reservation of activation fee fails during a reservation call, then the Account Reservation Failure Event is triggered.
•If the reserved fee is successfully committed from account during a commit call, then the Account Commit Success Event is triggered.
-> If the BOU Activation Priority is set as DEFAULT or ON_RESERVATION , then the Charge Fee Action deducts fee from the account as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1794Charging User Guide Rating and charging When the activation fee is charged successfully, the start time (current time) and end time (calculated as per the configured billing period in the lifecycle) is reset.
The end time determines the time to deactivate the BOU bundle.
If the bundle does not have the billing information, then the activation period is exactly as per the periodic length specified in the subscription lifecycle.
It also increments number of activations that have occurred on that subscription in the current renewal cycle.
Next, the subscription is reset, followed by resetting the buckets and counters in this subscription using the Reset Subscription Action for BOU bundles.
A successful notification is sent using the notification variables configured in the rules of the notification template for the Send Notification action.
In addition to existing notification variables, the notification configuration can also use the Bundle-Id , Bundle-Activation-Type , and Remaining-Renewals variables.
A transition from the Pre-Active state to the Active state takes place.
-> If the BOU Activation Priority is set as DEFAULT or ON_RESERVATION , but the deduction of activation fee fails, then the Charge Fee Action Failure Event is triggered and a notification is sent indicating a failure in payment using the notification template (as configured) and the subscription continues to remain in the Pre-Active state.
This is shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1795Charging User Guide Rating and charging -> If the BOU Activation Priority is set as ON_COMMIT during a reservation call, then the BOU activation fee is successfully reserved from the account as shown in the following figure: During this transition, the following actions are performed: (i) If the Action is set as Reset Subscription Action : The activation fee is successfully reserved, subscription is reset, followed by resetting the buckets and counters in this subscription as per the Reset Subscription Action for BOU-type bundles.
This is performed to ensure that the bucket with full quantities (initial value) is available for reservation and any previous thresholds are also reset.
(ii) If the Action is set as Reset Period Action : The activation fee is successfully renewed, start time (current time) and end time (calculated based on the configured billing period in the lifecycle) is reset as per the Reset Period Action .
The end time determines the time to deactivate the BOU bundle.
If the bundle does not have a billing information, then the activation period is similar to the periodic length in the subscription lifecycle.
The start time and end time are calculated depending on the Reservation Time .
However, in case of under-commit scenarios, if the BOU bundle is not activated, then the start time and end time is set as null.
(iii) The number of activations that have occurred on that subscription in the current renewal cycle is not incremented whereas, the activation count is incremented when BOU is activated on actual usage.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1796Charging User Guide Rating and charging (iv) There is no change of state in this scenario.
-> If the BOU Activation Priority is set as ON_COMMIT during a reservation call but the activation fee cannot be reserved successfully, then the following transition happens as shown in the figure below: If you wish to be notified with a failure notification during an attempt of account reservation, then the Send Notification action is applied in the preceding transition.
-> If the BOU Activation Priority is set as ON_COMMIT during a reservation call and the activation fee is successfully reserved from the account, then the following transition happens as shown in the figure below: During this transition, the following actions are performed: (i) The Pre-Active (or barred) state transits to Active (unbarred) state.
(ii) The number of activations that have occurred on that subscription in the current renewal cycle is incremented.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1797Charging User Guide Rating and charging (iii) A successful notification is sent using the notification variables configured in the rules for the Send Notification action.
In addition to the existing variables, the notification template may also use Bundle-Id , Bundle-Activation-Type , and Remaining-Renewals .
b.Another transition in the Pre-Active state is as follows: You can also configure to send notification in case the x of subscription fails due to unavailability of funds.
In this case, there is a transition from the Pre-Active to the Suspended state.
c.Another transition in the Pre-Active state is as follows: When the Max Renewals Reached Event is triggered for the BOU bundle, the subscription moves from the Pre-Active to the Final state.
4.The Active state has the following transitions: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1798Charging User Guide Rating and charging a.If the activation was successful before, then lifecycle is in the Active state and deactivation is handled in the following way: When the end time is reached, the Deactivate event is triggered.
You can also configure to send notification using the notification action.
However, the mandatory transition happens to the Pre- Active state.
b.Another transition in Active state is as follows: Note : The transition can happen from both Pre-Active and Active state to Suspended state due to failure in renew subscription.
c.Another transition in Active state is as follows.
When the Max Renewals Reached Event is triggered for BOU, the subscription moves to Final state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1799Charging User Guide Rating and charging 5.The Suspended state has the following transitions: a.In the first transition, if the renewal fee is successfully deducted, then the Subscription Renewed Event is triggered for which there is a transition to the Pre-Active state as shown in the following figure: b.In the last transition, if the account credit is insufficient to charge the renewal fee, then the subscription remains in the Suspended state and you may configure the notification template to notify the user.
Only the periodic lifecycle is used in subscription to periodically deactivate and activate a subscription and maintain subscription states.
This configuration is shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1800Charging User Guide Rating and charging 6.The Final state has no transitions.
When the Max Renewals Reached Event is triggered for a BOU bundle, the state of the subscription moves to the Final state as shown in the following figure: 8.
10.3 CDR for BOU activation fee and taxation NCC populates BOU activation fee and taxation information in Gy CDR only if the application preference BOU Activation fee enabled in CDR is set true .
When the BOU activation fee and applicable tax amount are charged from the account, the BOU bundle is activated in a Gy call.
After usage, the Gy initial, update, and terminate CDRs are generated with charged amount information.
In this case, the following tags are added into the CDR: bouActivationFee , bouFeeTaxAmount , taxationID , accountBalanceBefore , accountBalanceAfter , bouResult .
Refer to CDR/EDR Reference for more information about the tags.
NCC also considers counter update while deducting the BOU activation fee from account if the application preference Increase Counter for Bundle Fee is set to 1.
All the applicable multi-bundle and/or global counters can be updated with activation fee.
This is applicable only for cost-based counters.
According to the design of an SMS/MMS call , for a BOU activation, usage is deducted first, and BOU activation fee is applied later.
Hence, the CDR tags shall be dumped accordingly in the same sequence.
For details about the application preferences, refer to Charging application preferences on page 44.
Example Consider that a BOU bundle is configured with the applicability condition of BOU bundle and activation fee is 10 Euro and 22% Taxation Id.
A charging service is configured with a bucket having initial value and tariff formula for bucket selection.
A BOU bundle is associated with the charging service.
A Device is subscribed to BOU Bundle and Account.
A BOU AMA Code is updated into RSV and Complex Map for BOU Bundle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1801Charging User Guide Rating and charging When a user executes the data call using the Device and ends it, then the activation fee with tax amount 12.2 Euro is deducted from account when BOU bundle is activated on session.
The Gy CDR is generated with BOU Activation Fee, Taxed Amount information, BOU AMA Code for BOU activation.
8.
10.4 Lifecycle actions on BOU bundle This section explains the impact of different lifecycle actions on a BOU bundle.
Assume the sample states (Pre-Active , Suspended , and others as mentioned in the Actions associated with lifecycles on page 1609 section) to understand the concept in this section.
Note : The BOU bundle is activated only when it is in the Pre-Active state.
Impact of renew subscription action on BOU bundle Note : The BOU bundle can either have the BILLING_ONLY or RESET_ONLY renewal modes.
If the account renewal fails, then the state of the account and subscription always moves to the Suspended state.
However, if the subscription renewal fails, then it depends on the configuration whether the account state moves to Suspended state or not.
When a positive top-up is done on an account using the REST API, the Account Recharged Event is triggered, which is broadcasted to the subscription and account lifecycle.
The failed renewal or the Charge Fee Action is executed again.
The account state moves to the Active state whereas the BOU subscription state moves to the Pre-Active (or barred) state.
For a BOU bundle with BILLING_ONLY renewal mode, the subscription renewal is not skipped unlike other normal bundles.
In case of the BOU bundle, the bouActivationCount is always reset to zero irrespective of whether there is sufficient balance in account to renew all of its associated subscriptions or not.
Note : The bouActivationCount for a BOU bundle is set to zero even the account is a Postpaid account and the deductPostpaidFeeFlag is set as False .
Impact of charge fee action on BOU bundle The Charge Fee Action is configured in the BOU periodic lifecycle to support the BOU bundle activation on a configurable event.
Following events impact the bouActivationCount : •Triggering of the Charge Fee Action Success Event , which results in the BOU bundle activation and increment of the bouActivationCount for the subscription.
•Triggering of the Charge Fee Action Failure Event , which does not activate the BOU bundle and the bouActivationCount remains same for the subscription.
•Triggering of the Account Commit Success Event with the BOU Activation Priority set as ON_COMMIT results in incrementing the bouActivationCount .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1802Charging User Guide Rating and charging To enable BOU functionality, the Charge Fee Action is configured only once in the bundle periodic lifecycle and must not be configured in the bundle entity lifecycle.
The discount is configured in rules and applied on prorated fee (if applicable).
The tax (if applicable) is calculated on the discounted fee.
For the BOU Activation Priority set as ON_COMMIT , the Charge Fee Action generates the following events: •Account Reservation Success Event : When the BOU activation fee is successfully reserved from account in reservation call.
•Account Reservation Failure Event : When the BOU Activation fee reservation from account fails during reservation mainly due to insufficient funds in account to pay for BOU activation fee.
•Account Commit Success Event : When the BOU activation fee reserved is successfully committed from account in commit call.
The Charge Fee Action Success Event and Charge Fee Action Failure Event are not generated for the BOU Activation Priority set as ON_COMMIT .
For the BOU Activation Priority set as DEFAULT or ON_RESERVATION , the Charge Fee Action triggers the Charge Fee Action Success Event and Charge Fee Action Failure Event .
8.
10.5 BUNDLE rule sets Following are the result context and attributes in BUNDLE rule set: Result context Attributes Description Activation- Fee Defines the activation fee in the BUNDLE rule.
Discount- Percentage Provides the discount percentage.
Activation- Event Triggers an event, such as voice, data, or SMS for activating a BOU bundle.BUNDLE Set- Activation- Count Provides flexibility to set the activation count value through rule.
SPR_ DEVICE Custom- Data- Add Custom- Data- Add- ImmediateAttaches the custom data, which is already defined in the system to a device.
If this custom data already exists in the device, then the service Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1803Charging User Guide Rating and charging Result context Attributes Description updates the value of custom data in the device.
Custom- Data- Remove Custom- Data- Remove- ImmediateRemoves the custom data of a device.
Custom- Data- Add Custom- Data- Add- ImmediateAttaches the custom data, which is already defined in the system to a group.
If this custom data already exists in the group, then the service updates the value of custom data in the group.SPR_ GROUP Custom- Data- Remove Custom- Data- Remove- ImmediateRemoves the custom data of a group.
8.
10.6 Future activation time for BOU bundle Recommended configuration With this feature, you can configure the activation time of a BOU bundle in future using the recommended lifecycle configuration mentioned in this section: 1.Create a BOU bundle Bundle_BOU with the following configuration: Here the BOU Activation Event is a user-defined activation event name.
2.The subscription periodic lifecycle is configured as: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1804Charging User Guide Rating and charging a.Create the following lifecycle states: -> Start (as the initial state of the lifecycle).
-> PreActive1 (as the lifecycle state when the ActivationTime is defined).
-> PreActive (as the lifecycle state where we define the activation event in the BOU bundle rule.
-> Active b.When a subscription is attached to a device or group, the subscription lifecycle state transits from the Start state to the PreActive1 state.
A Start Cycle Event is configured with the Start state as shown in the following figure: c.At the PreActive1 state, an ActivationTime is defined while attaching the subscription to transition from the PreActive1 state to the PreActive state once the configured ActivationTime is reached as shown in the following figure: d.At the PreActive state, a BOU activation event is configured to be triggered from the BOU bundle rule.
Therefore, once the bundle transits to the PreActive state and the BOU activation event triggers, the BOU bundle is activated for use.
This is shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1805Charging User Guide Rating and charging Note : If the subscription does not transits to the PreActive state because of the ActivationTime configured for future, then the subscription rule is triggered on call and the subscription is not activated for use.
Consider the following examples to understand configuring the future activation time of a BOU bundle in different ways: Example 1: BOU subscription with future activation time This example explains that when a BOU bundle is configured to be activated on making a voice call but the bundle activation takes place in future.
Note : The future activation bundles can have resources (buckets and counters) with the separate periodic lifecycle, provided they have a bundle periodic lifecycle.
Preconditions: •Create a subscription lifecycle on 8 Apr 2020 16:02:10 and define the subscription activation time on or after 13 Apr 2020 16:02:07 .
•Define the activation event for the bundle in the PreActive state of the subscription lifecycle.
Post-conditions: •Once the subscription is created, it is moved to the PreActive1 state and once the activation time reaches, it moves to the next state, that is the PreActive state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1806Charging User Guide Rating and charging •Therefore, if a bundle is in the PreActive1 state and Bundle Activation event is triggered, then the bundle is not activated.
However, once the activation time is reached and the bundle transits to the PreActive state, and the Bundle Activation event is triggered, the bundle is activated.
Example 2: BOU subscription with no defined activation time This example explains that while attaching a subscription to a device or group, if no activation time is provided, then it picks the current time as the activation time and subscription moves immediately to the PreActive state.
Preconditions: Create a subscription for the BOU bundle and attach it to an account Account0500395 with no activation time defined.
Post-conditions: •As no activation time is provided, it picks the current time as the Activation Time as shown in the following figure: •Following is the screenshot of the account overview after subscribing the BOU bundle: •Now, once the bundle rule is triggered from a call, it activates the subscription for use.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1807Charging User Guide Rating and charging 8.
10.7 End time calculation for BOU and non-BOU bundles When a 24-hour lifecycle is being used for a BOU or a non-BOU bundle, the endTime calculation differs for both these types of bundle.
The endTime is calculated as per the billing information of the bundle and periodic length of lifecycle.
Note : •If a BOU bundle has no billing information, then it has an exact period as per the periodic length defined in a lifecycle; and also, if the Day of Month and Hour of Day are not mentioned in bundle object, then period length defined in a bundle periodic lifecycle is followed.
•If the bundle periodic lifecycle is having a periodic length of 24-hours, then the periodic length is considered as exact 24-hours.
Examples Refer to the following table for all the examples listed in this section: With billing information Without billing information BOU bundle "activationTime": 161307652348, Friday, 12 February 2021 10:57:32.348 AM "endTime":1613192400000, Saturday, 13 February 2021 10: 30:00 AM"activationTime": 161308262910, Friday, 12 February 2021 11:07:42.910 AM "endTime":1613194662922, Saturday, 13 February 2021 11:07:42.922 AM Non- BOU bundle "activationTime": 1613107686485, Friday, 12 February 2021 10:58:06.485 AM "endTime":1613192400000, Saturday, 13 February 2021 10: 30:00 AM"activationTime": 1613107756601, Friday, 12 February 2021 10:59:16.601 AM "endTime":1613192400000, Saturday, 13 February 2021 10:30:00 AM Example 1: If the Day of Month and Hour of Day values are not mentioned in a bundle object, the periodic length in the bundle is 24 hours , and the periodic lifecycle StartTime is 3 Feb 2021 3:39:23 HRS , then the endTime is 4 Feb 2021 3:39:23 HRS .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1808Charging User Guide Rating and charging Note : In case of a normal bundle, the endTime is rounded to hour, and therefore, the endTime is calculated as 4 Feb 2021 3:00:00 HRS .
Example 2: If the Day of Month and Hour of Day values are not mentioned in a bundle object, the periodic length in the bundle is 70 minutes , and the periodic lifecycle StartTime is 3 Feb 2021 3:39:23 HRS , then the endTime is 3 Feb 2021 4:49:23 HRS .
Note : In case of a normal bundle, the endTime is rounded to minutes, and therefore, the endTime is calculated as 4 Feb 2021 3:39:00 HRS .
Example 3: If the Day of Month and Hour of Day values are not mentioned in a bundle object, the periodic length in the bundle is 86400 seconds , and the periodic lifecycle StartTime is 3 Feb 2021 3:39:23 HRS , then the endTime is 4 Feb 2021 3:39:23 HRS .
Note : In case of a normal bundle, the endTime is rounded to seconds, and therefore, the endTime is calculated as 4 Feb 2021 3:39:23 HRS .
8.
10.8 Grace period for BoU bundles Operators can provide a grace amount/grace volume (for example, 50KB or 25MB, configurable) before charging the BoU activation fee and activating the BoU.
The BoU activation fee is not charged until the grace amount is exhausted.
The grace amount can be accumulated for several days before actually charging the fee.
If subscriber does not have enough money to pay BoU fee because spending limit has reached or there is insufficient balance, then BoU activation is not done (BoU remains in Barred state), grace period is not applied, and subscriber can then be charged with the roaming rate (or barred to make the call) as per operator configuration.
This is applicable to data calls only.
Grace period is applicable for BoUs if BOU Activation Priority=ON_COMMIT and BOU Usage Priority=DEFAULT_SORTING_ORDER .
To activate grace amount, grace bucket must be activated from Bundle rules defined in BoU activation bundle rules, as follows: BUNDLE.Grace-Period-Bucket ="GB1" The bucket GB1 in the example is a grace period bucket, which is a normal volume bucket defined in the tariff rules of charging logic for BoU bundle.
If this attribute is defined in Bundle rules of BoU bundle, then before charging the BoU fee and activating the BoU, NCC ensures that the bucket GB1 is exhausted.
Once BoU fee is reserved successfully, then call is charged from grace bucket until it is exhausted.
At the time of committing the slice, NCC checks if grace bucket is exhausted or not.
On the basis of the result, it either commits the BoU fee or free the BoU fee, hence canceling the reservation.
If BoU reservation fee is canceled because grace bucket is not exhausted, then new reservation for BoU fee is done again for next slice/session.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1809Charging User Guide Rating and charging 8.
10.9 Additional information Following are some additional notes regarding the BOU bundle: •For a BOU bundle or future activation bundle, when you set the start time or end time of the bundle, the timezone ID of an account for the bundle is considered.
•At BOU bundle subscribe/renewal, fee is prorated as per the prorate configuration using the corresponding billing information and periodic length of account periodic lifecycle.
The resources are not prorated.
•BOU bundle activation fee and resources are prorated at activation, if applicable, as per the configuration and as per the subscription lifecycle.
•When the prorate configuration has Bundle Fee/Override Fee selected and if BOU subscription is removed, then the renewal fee/subscription fee is prorated as per the account lifecycle.
•When the prorate configuration has Charge fee action selected and if BOU subscription is removed, then the activation fee is prorated as per the subscription lifecycle.
•It is recommended to use Reset Period Action at the success of Renew Subscription Action or Charge fee action .
8.
10.
10 Examples Example 1: BOU bundle is activated on making a voice call Configuration: Bob has a BOU bundle, which has been configured to be activated on making a voice call.
The BOU bundle is valid for one day.
The configurations made are as follows: 1.Create a charging service.
To do this, navigate to Charging → ☰ → Logics (Charging Services) on the new GUI.
2.Create a BOU bundle as shown in the following figure.
To do this, navigate to Charging → ☰ → Services on the SM GUI.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1810Charging User Guide Rating and charging 3.Create a subscription periodic lifecycle.
To do this, navigate to Charging → ☰ → Lifecycles on the SM GUI.
See Subscription lifecycle configuration on page 1661 for subscription periodic lifecycle configuration.
4.Create a notification profile and template using the options available in the Notification Management .
In the current example, the notification template ID ( TCPIP_Notification_Template_Subsc_Renew ) is linked to the lifecycle event.
Note : The activation counter bouActivationCount gets incremented when the bundle is activated.
AV before BOU is activated: AV after BOU is activated: 60 GByte of BOU bundle is added.
The following screens show the AV before and after the BOU bundle is activated.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1811Charging User Guide Rating and charging Once the subscription is deactivated, it gets excluded from the AV refresh as shown in the following figure: Example 2: BOU activation provides 100% discount for first N successful activations Bob has a BOU bundle which has been configured to be activated on making a voice call.
Once the BOU bundle is activated, if the activation count is less than 2, then there is no charge for the activation.
The activation fee is charged for first call, free for second call, and then again charged for subsequent calls.
The configurations made are as follows: 1.Create a logic (charging service).
To do this, navigate to Charging → ☰ → Logics on the new GUI.
2.Create a BOU bundle as shown in the following figure.
To do this, navigate to Charging → ☰ → Services on the SM GUI.
Select On Session for Bundle Activation Type and configure the following rule.
3.Create a complex map whose values get used in the rule defined in the BOU bundle.
To do this, navigate to Charging configurator and select Mapping tables on the SM GUI.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1812Charging User Guide Rating and charging Example 3: BOU activation at commit In the following example, the BOU Activation Priority is set to ON_COMMIT and BOU Usage Priority is set to LEAST_PRIORITY_ORDER.
This means, the BOU bundle is activated on commit when there are no other resources available for the call.
Consider that a Group has the following bundles.
Bundle Name Bundle Type Priority Activation Fee Activation status Normal bundle 1 Non- BOU 1 NA Always active BOU monthly bundle BOU 2 15 Inactive (Gets activated at commit when no other resources are available for the call. )
Normal bundle 2 Non- BOU 3 NA Always active BOU daily bundle BOU 4 2 Inactive (Gets activated at commit when no other resources are available for the call. )
Consider that a centralized call is executed with empty RSU.
The BOU bundle gets activated at commit and NCC deducts the data from non-BOU bundles followed by BOU bundles.
The main account balance is 1000 units.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1813Charging User Guide Rating and charging Normal bundle 1 BOU monthly bundle Normal bundle 2 BOU daily bundle Non- BOU BOU Non- BOU BOU Balance 5 MB 10 MB 5 MB 10 MB CCR- I RSU= empty, GSU= 8 MB0 MB 10 MB 2 MB 10 MB CCR- U1 USU= 8 MB, GSU= 5 MB0 MB 7 MB 0 MB 10 MB Account balance = 985 since the activation fee of 15 units is deducted for BOU monthly bundle.
CCR- U2 USU= 5 MB, GSU= 5 MB0 MB 2 MB 0 MB 10 MB CCR- T USU= 10 MB (overcommit case)0 MB 0 MB 0 MB 7 MB Account balance = 983 since the activation fee of 2 units is deducted for BOU daily bundle.
Example 4: BOU bundle activation scenarios Consider that a group has two subscriptions as follows: •Bundle 1 is a non-BOU bundle with 10 as resource value and has high priority.
•Bundle 2 is a BOU bundle with 10 as resource value and 5 is the activation fee and is currently inactive.
Device 1 makes a call for which a GSU of 10 is allocated.
Bundle 1 resources are reserved.
Device 2 makes a call for which a GSU of 5 is allocated.
Bundle 2 resources are reserved.
Bundle 2 is not active since the usage is not committed yet.
Case 1 : Device 2 usage of 5 is committed.
Bundle 2 is activated and consumed.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1814Charging User Guide Rating and charging Case 2 : Device 1 usage of 2 is committed.
This is less than the granted units and is a under commit case.
Bundle 1 resources are committed as per USU and remaining reservation is canceled.
Device 2 usage of 5 is committed.
Bundle 2 is activated and consumed.
8.
10.
11 BOU activation enhancements This feature provides the functionality to trigger bundle activation rules for a specified BOU bundle.
This feature is applicable only when BOU Activation Priority is set to ON_COMMIT , and BOU Usage Priority is set to DEFAULT_SORTING_ORDER .
BOU is activated when an eligible call event is triggered.
The call is charged from a resource which is not a part of the BOU bundle.
Trigger-BOU-Activation action in the RATING result context can be configured in tariff rules to trigger the bundle activation rules for a specified BOU bundle.
The name of the BOU bundle for which bundle activation rules should be triggered can be passed as an argument to Trigger-BOU-Activation action.
If this feature is configured, and the specified BOU bundle is not active, then the BOU activation rules are triggered for the specified BOU bundle.
Note : If the BOU bundle is already active, then BOU activation success is returned for that BOU bundle.
Triggering BOU activation To trigger BOU activation rules for a BOU bundle, configure RATING.Trigger-BOU-Activation action in TARIFF rules.
Trigger-BOU-Activation actions triggers the bundle activation rules for a specified BOU bundle.
It has two mandatory parameters which are as follows: •Bundle_Name_STRING : This argument can take the following values: –Bundle_Name : Bundle name can be passed as a string argument.
It indicates the name of the BOU bundle for which BOU activation rules should be triggered.
–CALL_COMMON.Pre-Rating-Simulation-Bundle : If this argument is passed, then BOU activation rules are triggered for the bundle that is selected in the pre-rating simulation.
Note : Pre-Rating-Simulation-Bundle attribute indicates the bundle name for the highest priority applicable charging logic selected in the pre-rating-simulation.
•ChargingLogicSelection_ENUM : This argument can take the following values: –Stop : If BOU reservation fails, then NCC stops using the current charging logic and moves to the next applicable charging logic, if any.
–Reject : If BOU reservation fails, then call is rejected immediately –Continue : If BOU reservation fails, rest of the tariff rules are evaluated using the same charging logic.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1815Charging User Guide Rating and charging Note the following important points about this feature: •BOU activation can fail due to the following reasons: –Insufficient balance to support BOU activation fee.
–Insufficient spending limit to pay the BOU reservation fee.
–If BOU bundle is not found.
–If BOU bundle is barred and cannot be activated.
–If BOU bundle is not selected in the pre-rating simulation.
–If the bundle selected in the pre-rating simulation is not a BOU bundle.
–If maximum renewal for BOU bundle is reached.
•BOU activation is not applicable for offline charging, MMS, and ECUR interface.
•BOU bundle is not activated for MT Voice/MT SMS premium.
Examples •RATING.Trigger-BOU-Activation("CALL_COMMON.Pre-Rating-Simulation-Bundle", "Stop") BOU activation rule is triggered for BOU bundle specified in CALL_COMMON.Pre-Rating-Simulation- Bundle attribute, provided the BOU bundle is not active.
If BOU fee reservation is successful, then rest of the tariff rules are evaluated in the same charging logic, and BOU fee is committed at the time of committing the slice (that is, Used Service Units ).
If BOU fee reservation fails, then logic stops using the current charging logic, and moves to the next applicable charging logic.
•RATING.Trigger-BOU-Activation("VF_BOU_01", "Stop") BOU activation rule is triggered for BOU bundle VF_BOU_01 , provided it is not active.
If BOU fee reservation is successful, then rest of the tariff rules are evaluated in the same charging logic, and BOU fee is committed at the time of committing the slice (that is, Used Service Units ).
If BOU fee reservation fails, then logic stops using the current charging logic, and moves to the next applicable charging logic.
•RATING.Trigger-BOU-Activation("CALL_COMMON.Pre-Rating-Simulation-Bundle", "Reject") BOU activation rule is triggered for BOU bundle specified in CALL_COMMON.Pre-Rating-Simulation- Bundle attribute, provided the BOU bundle is not active.
If BOU fee reservation is successful, then rest of the tariff rules are evaluated in the same charging logic, and BOU fee is committed at the time of committing the slice (that is, Used Service Units ).
If BOU fee reservation is fails, then the call is rejected immediately.
Hence, the call fails.
•RATING.Trigger-BOU-Activation("VF_BOU_01", "Reject") BOU activation rule is triggered for BOU bundle VF_BOU_01 , provided it is not active.
If BOU fee reservation is successful, then rest of the tariff rules are evaluated in the same charging logic, and BOU fee is committed at the time of committing the slice (that is, Used Service Units ).
If BOU fee reservation fails, then the call is rejected immediately.
Hence, the call fails.
•RATING.Trigger-BOU-Activation("VF_BOU_01", "Continue") Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1816Charging User Guide Rating and charging BOU activation rule is triggered for BOU bundle VF_BOU_01 , provided it is not active.
If BOU fee reservation is successful, then rest of the tariff rules are evaluated in the same charging logic, and BOU fee is committed at the time of committing the slice (that is, Used Service Units ).
Even if the BOU fee reservation fails, the rest of the tariff rules are evaluated in the same charging logic.
Use cases Use case 1: For roaming subscriber, MO call is charged from applicable home tariff when BOU is activated.
•Device has a 24H renewable BOU bundle BOU1 attached to it with the following rules: BUNDLE.Activation-Fee = 8 and BUNDLE.Activation-Event = "activateBOU" •A default tariff DTP01 is attached to the device.
It has the lowest priority.
•A time based home bundle TIME1 is attached to the device.
Its time bucket is T01.
•BOU bundle and default tariff are a part of PTP/DTP category for which pre-rating-simulation is enabled in the GY_PREPROCESSING trigger.
•Home bundle is a part of the default category.
Default category has higher priority than PTP/DTP category.
•Device has an unlimited spending limit SPL1 .
•The application preference BOU Activation fee enabled in CDR is set to true •Charging Service of bundle TIME1 has the following tariff rules defined: RATING.Trigger-BOU-Activation("BOU1", "Reject") and RATING.Bucket-Selection = "T01" Result : When MO voice call is triggered from the roaming country, BOU1 is activated.
The activation fee is charged from account and counted towards spending limit SPL1 .
MO Voice call is charged from bucket T01.
Use case 2: For a roaming subscriber, MO call fails due to insufficient spending limit to pay the BOU activation fee.
•Device has a 24H renewable BOU bundle BOU1 attached to it with the following rules: BUNDLE.Activation-Fee = 8 and BUNDLE.Activation-Event = "activateBOU" •A default tariff DTP01 is attached to the device.
It has the lowest priority.
•A time based home bundle TIME1 is attached to the device.
Its time bucket is T01.
•BOU bundle and default tariff are a part of PTP/DTP category for which pre-rating-simulation is enabled in the GY_PREPROCESSING trigger.
•Home bundle is a part of the default category.
Default category has higher priority than PTP/DTP category.
•Device has a spending limit SPL1 .
It has already reached the hard stop threshold.
•The application preference BOU Activation fee enabled in CDR is set to true •Charging Service of bundle TIME1 has the following tariff rules defined: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1817Charging User Guide Rating and charging RATING.Trigger-BOU-Activation("BOU1", "Reject") and RATING.Bucket-Selection = "T01" Result : When MO voice call is triggered from the roaming country, BOU1 is not activated.
MO voice call fails due to insufficient spending limit.
8.
11 Call rejection based on account balance During a session, if BOU fee or step fee is not deducted due to insufficient balance in the main account, then the NCC charging logic moves to the next available service and allows the session to continue.
This functionality is supported by Notification-stop action.
If Notification-stop is configured in the Threshold rules, and the main account balance is less than BOU fee or step fee, then the session moves to the next available service.
The functionality to reject the session when the main account balance is less than the BOU fee or step fee, instead of moving to the next available service, can also be configured.
This functionality is supported by Notification-Reject action in Threshold rules.
If this functionality is configured, and BOU fee or step fee cannot be deducted due to insufficient balance in the main account, then regardless of the availability of other services, the session is rejected with the error code 4012.
Note : If BOU fee or step fee is not deducted during the ongoing session, or start of the session, then the session is rejected with error code 4012 under the MSCC that is applicable for the session.
Configuration Notification-Reject action should be configured in Threshold rules to reject the session with an error code 4012 when the main account balance is less than BOU fee or step fee.
Use Cases Use case 1: BOU is in initial state and applicable for the session.
Account balance is insufficient to fund the BOU Activation Fee.
1.BOU fee is defined, and BOU is in initial state.
2.The default tariff plan DefaultTariffPlan_CS is attached to the subscriber.
3.Activation is defined as ON_USE , and ON_SESSION BOU is activated.
4.Notification-Reject action is configured in Threshold rules.
5.BOU activation fee is 1 Euro, and the main account balance is 0.5 Euro.
6.A session is executed to deduct BOU activation fee for BOU reservation.
7.BOU has higher priority, and main balance is less than BOU activation fee.
Hence, the call is rejected with the error code 4012 under the applicable MSCC.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1818Charging User Guide Rating and charging UC02: Service with step fee is applicable for the session.
Account balance is insufficient to deduct the step fee.
1.Step fee is defined in Tiered Allowance.
2.The default tariff plan DefaultTariffPlan_CS is attached to the subscriber.
3.Step fee is 10 Euro, and the main account balance is 9 Euro.
4.Notification-Reject action is configured in Threshold rules.
5.A session is executed to deduct the step fee.
6.The main account balance is less than step fee.
Hence, the call is rejected with the error code 4012 under the applicable MSCC.
8.
12 Queuing bundles As per the current NCC logic, a bundle attached to a Device can have multiple number of instances.
When a bundle is attached to a Device, its instance (subscription) is created in Active state by default.
This may be different if a bundle's lifecycle is modified to have a different behavior such as Future Activation Date.
The bundle instances are used based on their priority defined at charging service level.
Hence, the resources with higher priority are used first.
With the queuing bundles feature, operators can define a queue structure for bundle instances.
The instances in a queue follow the queue property, that is, the first bundle instance in the queue will be used first.
Once this instance is used up, then the next instance in the queue is used with validity starting from its first usage.
When the queued bundle is attached to a Device, the first subscription will be active and rest will be in inactive state per queue.
This depends on the configuration of lifecycle attached to the bundle.
The bundle instances queue has the following properties: •The instances can belong to different bundles.
•The instances can have different priorities.
•The instances can only be non-renewable.
That is, do not add a bundle instance having BCR into the queue.
•The instances are queued in the order of their creation time.
•The number of instances in the queue can be controlled by configuration.
•Only the active instance has a validity period.
•Only the same type of bundle instances are allowed in the queue.
For each instance, the bundle structure and definition are same other than the allowance (bucket size and validity period).
Note the following important points: •Operators must define the same queue id for same bundle types.
•Queuing bundle is supported for Device only.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1819Charging User Guide Rating and charging •Queuing bundle must be non-periodic/non-renewable.
•Do not change the queuing definition of a bundle.
If queue id is changed, then it may have adverse effect.
•Composite bundles are not considered for queuing bundle feature.
Here, composite indicates bundle having resources of different type such as bundle with voice and data resources.
•Bundle On Use (BOU) bundles are not considered for queuing bundle feature.
•Change Plan is not applicable for queuing bundle feature.
•The bundle in the queue cannot have a step bucket.
•One queued bundle will have one bucket.
If more than one bucket is needed, then the exhaustion criteria can be configured through threshold rules.
8.
12.
1 Configuring queuing bundles To enable the queuing bundle feature, configure the queueId in Bundle entity using the REST API.
If the queueId is Null, then the feature is OFF.
To manage the queue size, operators can use the Subscription Queue Size application preference.
Note : For this release, the queueId parameter in Bundle is not available on SM GUI.
8.
12.2 Configuring lifecycles - Device, Subscription Configure the Device, Subscription entity and period lifecycles.
Note that the values indicated in the following tables are sample values and you can modify them as per your requirement.
From State Event Actions Timer ToState PreActive( Initial) Start Event 0 seconds Inactive( Barred) Device Attachment Event Activate Queued Subs ActionActive Inactive( Barred) Activate Active Active Deactivate Inactive( Barred)Table 195: Device lifecycle Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1820Charging User Guide Rating and charging From State Event Actions Timer ToState Active Start Cycle Trigger Event Action( Start Cycle Event of PERIOD)0 seconds Active Active Deactivate Inactive( Barred) Active Entity Removed Event Trigger Event Action( Subscription Expired Event of PERIOD)Removed( Final) Inactive( Barred) Deactivate Active Inactive( Barred) Entity Removed Event Trigger Event Action( Subscription Expired Event of PERIOD)Removed( Final) Removed( Final) Delete Delete Entity 24hrs Removed( Final)Table 196: Subscription entity lifecycle From State Event Actions Timer ToState Start( Initial) Start Cycle Event PreActive( Barred) PreActive( Barred) Activate Queued Sub EventReset Period Action, Send Notification ActionActive Active Subscription Expired EventSend Notification Action, Activate Queued Sub ActionEndTime Removed( Final) Exhaustion Event On ReserverationActivate Queued Sub ActionActive Exhaustion Event On CommitActivate Queued Sub ActionRemoved( Final) Removed( Final) Delete Delete Entity 24hrs Removed( Final)Table 197: Subscription period lifecycle 8.
12.3 Configuring thresholds - activate next bundle and delete exhausted bundle Operators can perform the following tasks using threshold configuration: •Activate next bundle in the queue when the current bundle being used is consumed completely.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1821Charging User Guide Rating and charging •Remove the exhausted instance from the queue and send notification on exhaustion of last bundle in the queue.
Here, remove indicates that the bundle is moved to final state using the defined lifecycle configuration.
Threshold configuration to activate next bundle Field Value Group name TPG_ activate Application Type CHARGING Kind of Unit VOLUME Reservation Threshold true OCS Policy Threshold false Dynamic milestone Flag falseTable 198: Threshold configuration - activate next bundle Threshold configuration - remove exhausted bundle and send notification Field Value Group name TPG_ notificationTable 199: Threshold configuration - exhausted bundle removal and notification Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1822Charging User Guide Rating and charging Field Value Application Type CHARGING Kind of Unit VOLUME Reservation Threshold false OCS Policy Threshold false Dynamic milestone Flag falseTable 199: Threshold configuration - exhausted bundle removal and notification (continued) The following rule checks whether it is a queued subscription and is the last subscription in queue and sends notification when 70% of the instance is consumed.
The following rule checks whether it is a queued subscription and is the last subscription in queue and sends notification when 100% of the instance is consumed.
It moves that instance to final state and also moves the other exhausted instances in the queue to final state.
All the instances in final state gets removed per configuration.
See Removing queued subscription on page 1825 for details on the order in which the exhausted queue bundles are removed.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1823Charging User Guide Rating and charging 8.
12.4 Configuring Send-Notification action for expiry and pre-expiry notification Operators can configure the Send-Notification action for sending notifications only for last instance of queue at two different points of time: •at Pre-Expiry •at Expiry On the basis of the value provided in condition attributes Subscription.is-Queued-Instance and Subscription.is-Last-in-Queue , expiry and pre-expiry notifications are sent only for the last subscription in the queue.
Note : If the condition (in rule) fails, System.Do-Nothing must be configured so that notification is not sent.
The following rule checks whether it is a queued subscription and is the last subscription in queue.
Then it sends Pre-Expiry notification.
Else it does not send any notification.
For Pre-Expiry, end time has been configured.
The rule configured in the following example checks whether the subscription is a queued subscription and is the last subscription in queue, then it sends Expiry-notification.
Else it does not send any notification.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1824Charging User Guide Rating and charging 8.
12.5 Removing queued subscription Whenever a delete subscription is executed, NCC checks if the subscription is a queued subscription.
If it is not a queued subscription, then there is no change in the existing behavior.
If it is a queued subscription, NCC performs the following logic.
•Queued subscription removal application preference : Deletion of queue can happen either from start of the queue or from end of queue.
This can be configured using the Queued Subscription Removal application preference that has two possible values - FROM_END (default value), FROM_START .
–FROM_END : If the Queued Subscription Removal is FROM_END and index of subscription (that you want to delete) is equal to the size of list, it means this is last element in list, then its allowed to be deleted.
Otherwise, NCC checks if subscription (index+1) is in final state, then subscription is alllowed to be deleted, else NCC throws an exception named OperationFailedException .
–FROM_START : If the Queued Subscription Removal is FROM_START and index of subscription (that you want to delete) is equal to 0, it means this is the first element in list, then its allowed to be deleted.
Otherwise, if index is greater than 1, then NCC checks if subscription (at index 1) is in final state, then subscription is allowed to be deleted, else NCC throws an exception named OperationFailedException .
•Removal order : If multiple subscriptions are removed by Bundle ID, Delete profile API and DeleteSubscription Action, then create an order based on Queued Subscription Removal Identifier.
–If the Queued Subscription Removal identifier is FROM_START .
It loops from 0th index to n-1 index.
–If the Queued Subscription Removal identifier is FROM_END .
It loops from n-1 index to 0th index.
The removal logic impacts the following APIs.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1825Charging User Guide Rating and charging API Description HTTP Method path for REST Delete Subscription Used to remove/ delete subscription from DeviceDELETE /services/ Service Manager/ subscriber/ delete/ Subscription Delta Update Used to update Device details that subscription added or removed using thisPUT /services/ Service Manager/ subscriber/ delta Update/ Device Update Device Used to update Device details that subscription added or removed using thisPUT /services/ Service Manager/ subscriber/ update/ Device Patch API for update devicePatch API for updating device details: with op: replace/ removePATCH /services/ Service Manager/ subscriber/ patch Delete Profile Delete profile for Entity Type: Account/ Device operation= DELETE/ DELETE_ ALL/ UNLINKDELETE /services/ Service Manager/ subscriber/ delete/ Profile Following is the impact on Delete Subscription Action : •Account : There is no change in Account entity for Delete Subscription Action as this is not applicable to queuing bundle.
•The condition for barred subscription is replaced by initial barred for all types of subscription removal logic using either API or Delete Subscription Action .
8.
13 Rollover services (bundles) This feature provides the functionality to merge same type of services (bundles).
For example, if a non- recurring service (bundle) with a certain validity period is subscribed, and another service of same type is subscribed again before the expiry of the existing service subscription, then the remaining balance of the existing service is combined with the balance of the new service at the bucket level.
If the validity of the new service is greater than the remaining validity of the existing service subscription, then validity is extended based on the validity of the new service.
A service (bundle) which has a Merge ID , and Avtivation type as Subscription merge is called rollover service.
Merging two services is applicable only if both services have the following: •Avtivation type as Subscription merge •Same Merge ID .
Consider the following important points for services (bundles) with same Merge ID : •The total number of buckets/allowance limits in all services (bundles) should be same.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1826Charging User Guide Rating and charging •The number of buckets of each type (Time, Volume, Money, Unit, and so on.)
in all services (bundles) should be same.
•If there are multiple buckets of same type, then the bucket name should be same in all the services.
This allows one-to-one mapping of buckets to merge the services.
•If there is a single bucket of any type, then the bucket name can be different for different services.
In this case, one-to-one mapping of buckets to merge the services is performed by matching the bucket type.
•After creating a rollover bundle, the Activation type and Merge Id cannot be changed.
That is, rollover service (bundle) cannot be changed to a normal bundle, and an existing normal bundle cannot be changed to a rollover bundle.
•Merging is not applicable to services with step bucket or carry-over bucket, and future activation subscription.
Configuration To enable this feature, set the service (bundle) parameter Activation Type to Subscription merge , and provide a Merge ID (queueId for REST API) while creating the service (bundle).
Additional information •After successful merging of existing bundle with the new bundle, the existing bundle is moved to the barred state, and removed from the system after the configured time in its lifecycle.
The number of subscriptions allowed in the barred state can be controlled or limited using the application preference Maximum Number of Subscriptions in Final State Allowed After Bundle Rollover (A value of 0 indicates that there is no limit).
•This feature is applicable to non-recurring services (bundles).
It works for recurring services as well.
However, in case of a recurring service, the upcoming renewal time of the subscription is considered as the expiry of the service.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1827Charging User Guide Rating and charging Note : For a recurring service, the remaining balance does not combine with the balance of the new subscription at the time of renewal.
•If Change Plan is performed from an existing service (B1) with Activation type as Subscription merge to a new service (B2) with the same Merge ID , then these two services cannot be merged.
If the Change Plan is performed from an existing service (B1) to a new rollover service (B2), and a third subscription (B3) with the same Merge ID as B2 exists, then the remaining balance of this subscription (B3) is merged into the new subscription (B2) that is created after the Change Plan .
•If a rollover service (bundle) is created with a validity time, another rollover service is created with a different validity time, and the application preference Align Subscription Period End to a Date is enabled, then the new bundle validity time is compared with the existing bundle validity time, and the maximum value is considered as the validity of the new subscription.
•If a rollover service (bundle) does not expire on its configured validity time due to any reason, and a new rollover subscription is added, then the existing subscription remains active and it is applicable for merging.
However, if Pending Lifecycle Renewal is enabled, then while adding a subscription, the pending lifecycles are executed and the existing subscription is moved to the final state.
The existing subscription is not applicable for merging.
Examples Example 1 Configuration: Consider the following configuration for services (bundles): Buckets detail Service ( Bundle) nameActivation typeMerge ID Name Validity Units B1 Subscription mergeONNET Voice1 7 Days 120 minutes B2 Subscription mergeONNET Voice2 7 Days 360 minutesTable 200: Bundle configuration Execution: Subscriber purchases Bundle B1 on 1st Dec with a Bucket Voice1 (Units = 120mins, End of Validity [EOV] = 8th Dec) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1828Charging User Guide Rating and charging Subscriber purchased Bundle B2 on 5th Dec with a Bucket Voice2 (Units = 360mins, End of Validity [EOV] = 12th Dec).
Both bundles have same Merge ID .
Hence, rollover is done for the following bundle components: •Remaining balance on 5th Dec: Voice1 (50mins, EOV 8th Dec) •Bucket balance of the new bundle: Voice2 (300mins, EOV 12th Dec) Result: After rollover, the bucket details in the new subscription are as follows: •Bundle name = B2, Bucket name = Voice2 •Bucket units = 350mins (50mins + 300mins) •EOV = 12th Dec (maximum value between 8th Dec and 12th Dec ) Counters and thresholds associated with bundle B1 become invalid.
Counters and thresholds defined for bundle B2 are currently applicable.
Bundle B1 is moved to the barred state, and removed from the system after the configured time in its lifecycle.
8.
14 Apply granularity to bucket and counter This feature enables NCC to apply granularity to a non-monetary bucket or counter accumulating from bucket or main balance resources.
Following are the behavior with respect to this feature: •The non-monetary type of bucket is decremented with granularity through a Gy request.
In this case, granularity is defined on the rate applicable to the bucket as per the tariff configuration.
•Rounding as per granularity on any resource through a Gy request is performed at the end of the call, that is, CCR-T, and the usage delta is transferred from one CCR-U request to the next CCR-U request.
Even if BCR/TTC has happened during the call, that is, between two CCR-U requests, delta is still transferred and adjusted.
•When a Subscription or Multi-Bundle counter of usage type is incremented, it should be as per the granularity of the rate applied to the resource, which is, monetary or non-monetary type of bucket, or main balance.
•Handling of counter rounding with granularity of resources is configurable in counter definition.
•Counter follows the granularity applied on the resources, which is, monetary or non-monetary type of bucket, or main balance by the rate applicable on them.
Following sections help to understand this feature in detail: 8.
14.
1 Configuring non-monetary bucket with granularity The granularity of a non-monetary bucket is based on the rate applicable to that bucket.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1829Charging User Guide Rating and charging Follow the given configuration to enable a non-monetary bucket to be deducted with the granularity defined in its rate: 1.Define a rate with granularity to be applied on the non-monetary bucket.
2.While selecting the non-monetary bucket during tariff configuration, specify that rate as: Rating.Rate(RateID,Non-Monetary-BucketID) 3.Set the ME application preference GRANULARITY SKIP FOR LOW BALANCE as True .
Note : Consider the following points when applying rate to a non-monetary bucket: •The initial balance, which is provisioned should not be in decimal.
•The quantity and cost should be multiple of each other.
For example, allowed rate configuration can be 25/50, 30/60, or 50/5; however, 50/80 is not allowed.
•The Granularity should be divisible by Quantity .
For example, if Quantity is set as 60, then Granularity can be 60, 120, or 180, but certainly not 50 or 90.
•Keep the finite step bucket in multiples of Quantity or multiples of Granularity .
For example, if Quantity is set as 60, then the finite step bucket can be 2400 but not 2500 .
•Configure a non-decimal value for Fixed fee for a non-monetary bucket.
•Tax is not applicable for non-monetary bucket.
Example Preconditions: 1.Create the following rate object: 2.Create a charging service object CS_2 having a bucket bucket4 of second type and rate ( rate_second ) applied to the bucket.
The bucket value is 204 seconds .
The charging service has the following tariff configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1830Charging User Guide Rating and charging 3.Create the following bundle: •Name : bundle_second •Fee: 0 •Charging Service List : CS_2 4.Create an accout and a device object with the following subscription: 5.Set the ME application preference GRANULARITY SKIP FOR LOW BALANCE to True .
Note : For details on configuring ME application preferences, see Managed Elements section in Global Configuration Guide .
Execution: Execute a single MSCC decentralized IMS call with RG=3300 as follows: 1.CCR(I): RG=3300 : RSU= 30 sec , GSU=60 sec 2.CCR(U1): RG=3300 : RSU= 30 sec , GSU=60 sec 3.CCR(U2): RG=3300 : USU=70 sec, RSU= 80 sec, GSU=110 sec 4.CCR(U3): RG=3300 : USU= 40 sec, RSU= 40 sec, GSU=70 sec 5.CCR(U4): RG=3300:USU= 25 RSU = 20 GSU = 45 6.CCR(T'): RG=3300 : USU=50 sec Verification: After executing the preceding calls, following points are verified: •After executing the CCR(U2) call, the unused bucket value becomes 84 and GSU is calculated as 110.
•After executing the CCR(U3) call, the unused bucket value remains 84 and GSU is calculated as 70.
•After executing the CCR(U4) call, the unused bucket value becomes 24 and GSU calculated as 45.
•After executing the CCR(T') call, the unused bucket value becomes 0.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1831Charging User Guide Rating and charging 8.
14.2 Applying bucket granularity with only step-size without considering cost/quantity The bucket granularity is based on assigned rate, which can be a standard rate used elsewhere (for example, EUR/MB with step-size is greater than 1 byte).
The non-monetary bucket can be only decreased by step-size and not with any defined cost/quantity (that is, 1 EUR/MB or even 0.5 EUR/MB ) in that rate.
The same rate can be configured to be used for a monetary or non-monetary resource, but only its step-size (and NOT cost/quantity) is applied on non-monetary buckets.
The new rating action Bucket-Granularity-Selection is required.
Signature: Rating.Bucket-Granularity-Selection(RateID,BucketID) Rating action when specified as Bucket-Granularity-Selection : •Applies only the step-size of the RateID defined in the action with volume or time bucket.
•Does not apply the cost/quantity even when it has any value defined.
Following tarriff rules are applied: •Tariff: Rating.Rate(RateX,VolumeBucket) with step-size + cost/quantity of RateX is applied to VolumeBucket .
•Tariff: Rating.
Bucket-Selection(VolumeBucket) with no rate or granularity applied to VolumeBucket •Tariff: Rating.
Bucket-Granularity-Selection (RateX,VolumeBucket) with step-size of rate or granularity applied to VolumeBucket and not cost/quantity.
•Tariff: Rating.
Bucket-Granularity-Selection (CALL_COMMON.Pre-Rating- Simulation-Rate,VolumeBucket) with step-size of rate or granularity of CALL_COMMON.PTP_RATE applied to VolumeBucket and not its cost/quantity.
•Tariff: Rating.
Bucket-Granularity-Selection (CALL_COMMON.Selected- Rate,VolumeBucket) with step-size of rate or granularity of CALL_COMMON.Selected-Rate applied to VolumeBucket and not its cost/quantity.
Note : •The applied rate should be Normal type of rate.
The Fixed or Reflection type of rate is not a part of this feature.
•If a user configures Bucket-Granularity-Selection rating action with a monetary bucket or main balance, then this feature is disabled, that means cost/quantity is applied with the step-size.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1832Charging User Guide Rating and charging •Any other type of cost, like connection cost; and if defined in the rate, then it is not applicable to non-monetary buckets (only its step-size), which means connection cost to be ignored.
Example Objective: Check that in case of a non-monetary bucket, cost/quantity as specified in rate is ignored and granularity specified as 10 bytes is taken into consideration.
Prerequisites: 1.Create a rate object with following information: Name : rate_byte RateType : Byte Granularity Level : Byte Cost/Quantity = 5/1 B and Step Size = 10 B 2.Create the following charging service object with bucket having 1000 bytes and rate applied on bucket: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1833Charging User Guide Rating and charging 3.Create a bundle, account and device objects.
Execution: Execute single MSCC decentralized SCUR call with RG=3300 as specified: CCR(I): RG=3300 : RSU= 25 bytes , GSU=30 bytes CCR(U1): RG=3300 : USU=25 bytes, RSU= 25 bytes, GSU=25 bytes CCR(U2): RG=3300 : USU= 50 bytes, RSU= 30 bytes, GSU=35 bytes CCR(T'): RG=3300 : USU=25 bytes Verification: 1.Verify that after CCRU1 , the unused bucket value becomes 970.
2.Verify that after CCRU2 , the unused bucket value becomes 920 .
Here, charging takes place in 2 steps; first reserved quantity gets charged which is 20 bytes and then, overcommit quantity, which is 25 bytes gets charged.
3.Verify that after CCRT , the unused bucket value becomes 900.
Diameter call RSU USU GSU Bucket Current ValueBucket Unused Value START NA NA NA 1000 1000Table 201: Call flow Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1834Charging User Guide Rating and charging Diameter call RSU USU GSU Bucket Current ValueBucket Unused Value CCR- I 25 NA 30 970 1000 CCR- U1 25 25 25 950 970 CCR- U2 30 50 35 890 920 CCR- T NA 25 900 900Table 201: Call flow (continued) 8.
14.3 Updating counter with usage consumption without granularity applied to main balance or bucket Follow the given configuration to update a counter with usage consumption from main balance or bucket without granularity (rate) applied on the main balance or bucket: 1.Define a rate with the granularity to be applied on main balance or bucket.
2.Define a counter with Align Granularity parameter set as False .
3.While selecting the counter during tariff configuration, specify that rate as: Rating.Rate(RateID,BucketID) Rating.Counter-Selection(CounterID) Or Rating.Rate(RateID,Main-Balance) Rating.Counter-Selection(CounterID) 4.Set the ME application preference GRANULARITY SKIP FOR LOW BALANCE as True .
Example with granularity applied to main balance Preconditions: 1.Create the following rate object: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1835Charging User Guide Rating and charging 2.Create a subscription counter subscription_counter1 with Counter Type set as Usage , Unit Type set as Byte , and Align Granularity as False .
3.Create a charging service object CS_2 having the counter subscription_counter1 and rate applied to account main balance.
The charging service has the following tariff configuration: 4.Create an accout and a device object, and the main balance in account is 104448 .
5.Set the ME application preferences GRANULARITY SKIP FOR LOW BALANCE to True .
Note : For details on configuring ME application preferences, see Managed Elements section in Global Configuration Guide .
Execution: Execute a single MSCC decentralized SCUR call with RG=3300 as follows: 1.CCR(I): RG=3300 : RSU= 25600 bytes , GSU=30720 bytes 2.CCR(U1): RG=3300 : USU=25600 bytes, RSU= 25600 bytes, GSU=25600 bytes 3.CCR(U2): RG=3300 : USU= 51200 bytes, RSU= 30720 bytes, GSU=35480 bytes 4.CCR(T'): RG=3300 : USU=51200 bytes Verification: After executing the preceding calls, following points are verified: •After executing the CCR(U1) call, the counter value becomes 25600 and account main balance becomes 73728 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1836Charging User Guide Rating and charging •After executing the CCR(U2) call, the counter value becomes 76800 and account main balance becomes 22528 .
•After executing the CCR(T) call, the counter value becomes 128000 and account main balance becomes -28672 .
8.
14.4 Updating counter with usage consumption with granularity applied to main balance or bucket Follow the given configuration to update a counter with usage consumption from main balance or bucket with granularity (rate) applied on the main balance or bucket: 1.Define a rate with the granularity to be applied on main balance or bucket.
2.Define a counter with Align Granularity parameter set as True .
3.While selecting the counter during tariff configuration, specify that rate as: Rating.Rate(RateID,BucketID) Rating.Counter-Selection(CounterID) Or Rating.Rate(RateID,Main-Balance) Rating.Counter-Selection(CounterID) 4.Set the ME application preference GRANULARITY SKIP FOR LOW BALANCE as True .
Example with granularity applied to bucket Preconditions: 1.Create the following rate object: 2.Create a subscription counter subscription_counter2 with Counter Type set as Usage , Unit Type set as Byte , and Align Granularity as True .
3.Create a charging service object CS_3 having a monetary bucket bucket5 with value of 104448 , and the counter subscription_counter2 with rate applied to account main balance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1837Charging User Guide Rating and charging The charging service has the following tariff configuration: 4.Create a bundle, account and a device object.
5.Set the ME application preference GRANULARITY SKIP FOR LOW BALANCE to True .
Note : For details on configuring ME application preferences, see Managed Elements section in Global Configuration Guide .
Execution: Execute a single MSCC decentralized SCUR call with RG=3300 as follows: 1.CCR(I): RG=3300 : RSU= 25600 bytes , GSU=30720 bytes 2.CCR(U1): RG=3300 : USU=25600 bytes, RSU= 25600 bytes, GSU=25600 bytes 3.CCR(U2): RG=3300 : USU= 51200 bytes, RSU= 30720 bytes, GSU = 27648 bytes 4.CCR(T'): RG=3300 : USU=30720 bytes Verification: After executing the preceding calls, following points are verified: •After executing the CCR(U1) call, the bucket value becomes 73728 and counter value becomes 30720 as Align Granularity is set as True .
•After executing the CCR(U2) call, the bucket value becomes 22528 and counter value becomes 81920 .
•After executing the CCR(T) call, the bucket value becomes 0 and counter value becomes 104448 .
8.
14.5 Additional information Consider the following points with respect to this feature: •This feature is only applicable to Gy, IMS, or VoL TE calls, wherein tariff is calculated.
•In non-monetary scenarios, the Rate and Kind Of Unit for the resource must be of the same type, which means if the bucket is of VOLUME type, then the rate has to be VOLUME only.
•The rate applied to monetary or non-monetary bucket applies both Step Size and Cost/Quantity .
•This feature is not applicable to No-Charge with Counters or directly rate to Counter Selection .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1838Charging User Guide Rating and charging •It is assumed that the counter accumulation is as per the usage or cost from the resource, which can be main balance or a bucket of monetary or non-monetary type.
•A counter is updated with usage consumption from main balance or bucket with granularity (rate) applied on main balance or bucket.
•A counter is updated with usage consumption, that is No-Charge without granularity, which means counter gets updated with the value as in USU request.
However, updating a counter with usage consumption, that is No-Charge with respect to granularity is not supported.
•A Cost type counter is ALWAYS updated with granularity of the resource, that can be main balance or bucket.
•In order to skip the cost/quantity defined in a rate for non-monetary resources, use the following configuration: Rate Type as byte/seconds (base unit) and Cost = 1 and Quantity = 1 8.
15 Apply percentage discount on rate This feature provides the capability to configure percentage discount on the rate, which is being used in the usage call.
This discount configuration is further made available in threshold.
Note : Currently, the discount configuration is supported for monetary and usage counters and buckets.
However, the discount is only applicable to monetary buckets and main balance.
8.
15.
1 Configuration Follow the given steps to configure this functionality: 1. a.Create a threshold profile group (TPG).
For example: b.Add a Usage-Discount configuration in threshold.
For example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1839Charging User Guide Rating and charging 2.Create a charging service.
For example: 3. a.Attach TPG in a bucket.
For example: b.Attach TPG in a counter.
For example: 8.
15.2 Additional information Following are some important points to note for this functionality: •To have a discount configuration in the threshold, a new rule variable (Usage-Discount) is added to the threshold rule set.
This attribute of BigDecimal type is added in the "Rating" Result Context to have the discount value, which represents the percentage value.
Discount is applied to rate, BOU activation fee, and charging step-up fee.
The rule evaluation logic is enhanced to consider a new discount variable as an output in the result.
The existing logic of calculating call usage based on the applicable rate is enhanced to consider discount value as well.
Note : Thresholds on accounts are out of scope.
•The discount is fetched by processing the threshold rule engine, which is executed for each MSCC (USU) commit.
Then, the discount value is stored in CounterInstanceClass and BucketInstance as Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1840Charging User Guide Rating and charging thresholds can be applied on counters and buckets.
Therefore, after adding discount on commit, this discount is applied for next reservation, direct-debit, and under commit.
•There can be only one discount stored in database for a particular TPG profile.
If particular threshold is crossed and there is no discount configured in rules, then there is no discount saved for particular TPG profile.
If there is any existing discount stored in database for that particular TPG profile, then it is removed.
The discount percentage at one level is stored until the next level is reached during CCR calls.
1.The discount percentage is updated when there is a new discount value configured at the next level.
2.The discount percentage is deleted when there is no discount value configured at the next level.
If the discount is configured at the Threshold level- 0 (Zero Level) , then the discount percentage is saved at the time of subscription creation.
•In case, charging step entity is associated with the bucket, then the step-fee is treated as usage and is tracked by associate cost counters.
In such scenarios, the discount percentage saved in EntityCounterInstance and BucketInstance are applicable to the step up-fee as well.
If the associated counter has a threshold with discount configuration, then the discounted step-fee is deducted from the main balance.
If the volume (or any non-monetary) type threshold is applied on bucket and has a discount configured, then it is also applicable on step-up fee.
•As the discount functionality is available in the threshold, then two counters or counters and monetary bucket can have a threshold with a discount configuration.
In such cases, it may happen that both threshold discounts become applicable to be applied on the same rate for the usage, then they are applied in order of their size, starting with the largest percentage discount first.
This is to avoid different results due to rounding errors during calculations.
•As the discount values are stored in the bucket instances or counter instances, so at the time of subscription reset or renew, the discount data also gets reset along with thresholds.
•The applicable discount percentage is saved in the CDR.
For more information, see Nokia Converged Charging CDR/EDR Reference Guide .
8.
15.3 Examples Consider the following examples for better understanding of this functionality: Example 1: Grant usage on discount with different Rating Groups Preconfiguration: 1.Configure a threshold TPGDATA_ABS with following configuration: Group Name* = TPGDATA_ABS Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1841Charging User Guide Rating and charging OCS Policy Threshold = false Application Type * = CHARGING Kind of Unit * = VOLUME Dynamic Milestone Flag = false Reservation Threshold = false Discount-10 = RATING.USAGE-Discount =100 Discount-0 = RATING.USAGE-Discount =0 Discount-30 = RATING.USAGE-Discount =30 2.Configure a rate Rate_Vol_416 with following configuration: Name* = Rate_Vol_416 Connection Cost = 0 Rate Type* = MByte Granularity Level* = MByte Security Domain = N/A 3.Configure a charging service CS_1 with following configuration: Name* = CS_1 Priority* = 200 Category* = DefaultCategory Description = N/A Security Domain = N/A Thresholds = TPGDATA_ABS 4.Configure a bundle Bundle-2 with following configuration: Name* = Bundle-2 Security Domain = N/A Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1842Charging User Guide Rating and charging Fee* = 0 Taxation Profile* = N/A Charging Service list* = [CS_1*] Usage Control* = [] Bundle Activation Type = NORMAL Usage Control Service List{Policy}* = [] Call flow scenario: Result: •Account BEFORE call execution: •Account AFTER Update1 execution: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1843Charging User Guide Rating and charging •Account AFTER Update1 execution: •Account AFTER call execution: 8.
16 Apply percentage discount on call This feature allows operators to apply discount for a call.
This can be configured in tariff.
The RATING.Call- Discount action can be configured in tariff that contains the discount applicable for the call.
The discount is applied on the following configurations of the bundle if the priority order of the bundle is equal to or less than the bundle in which the discount is configured.
The discount value represents the percentage value to be applied on call cost.
1.Rate configured with the main balance, money-bucket and cost-bucket.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1844Charging User Guide Rating and charging 2.Step-fee.
3.Rate's connection cost.
Example : The following example shows the configuration of Call-Discount.
In this, the TARIFF:RATING.Call-Discount =30 is configured which indicates that 30% of discount is applicable for all monetary resources which comes in priority after the current bundle.
Constraints on discount Following are the constraints on discount: •The discount can be a decimal or integer value.
•The discount value can be in the range 0-100 (excluding 0).
Decimal values are supported.
If a wrong value is configured, then the following error message appears: CHARGING_SERVICE_CALL_DISCOUNT_VALUE_NOT_IN_RANGE_ERROR: Invalid Configuration for Call-Discount: Tariff must have Call-Discount action value in range 0-100" .
•This discount is not applicable for non-monetary buckets.
•This discount is not applied on secondary as well as external rate.
•This discount is not applicable for BOU bundles including activation fee.
Example A Device D1 is subscribed with four bundles having the following configuration: •Bundle B1 has CS1 with step bucket SBkt1.
The priority of CS1 is highest among all.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1845Charging User Guide Rating and charging •Bundle B2 has CS2 with tariff having only call discount as 50.
This is promotional bundle having priority lower than CS1.
•Bundle B3 has CS3 with step bucket SBkt2.
The priority of CS3 is lower than CS2.
•Bundle B4 has CS4 with main balance.
The priority of CS4 is least among all.
When a call is executed, CS1 is picked and since discount has not been evaluated yet, discount is not applied and the cost is deducted as per step fee.
Once CS1 is exhausted and CS2 having discount configuration is evaluated.
From now onwards, whenever charging happens either from step bucket SBkt2 or main balance, 50% discount is applied.
The discount can be configured in any tariff pass.
Hence, once a discount is encountered, all the bundles in all passes become eligible for discount.
8.
17 Apply percentage discount on BOU Activation Fee •This feature provides the capability to configure and apply percentage discount, that comes from the threshold, on BOU Activation Fee .
•If the percentage discount on BOU Activation Fee is configured at both bundle rule, and threshold, then the discount is computed first from the bundle, and then the applicable counter threshold.
•This feature is applicable for both device, and group subscriptions.
•When a BOU bundle is subscribed, the activation fee is deducted from the main balance.
•The discounted activation fee is accumulated only in the cost counter.
•The amount accumulated in the cost counter is debited from the main balance.
•The multi-bundle, or device counter (Global Counters) should be of type cost.
•Bundle Activation Fee is not applicable on the subscription counters.
Note : This feature works only when the value of BOU Activation Priority is ON_COMMIT.
The rule exposed on the BOU bundle is shown in the following image: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1846Charging User Guide Rating and charging 8.
17.
1 Configuration Percentage discount on BOU Activation Fee can be configured at the bundle rule, and threshold.
1.Creating a threshold profile: • • 2.Application preference configuration: • • Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1847Charging User Guide Rating and charging 8.
18 Allow configured rating group flow during TOD This feature allows usage and counting of data during TOD restriction using a new rating group.
When a Gy/ N40 transaction subscriber first comes inside TOD restriction, OCS sends an SNR or N28_Notify to the PCF using the new TOD PCID and Inside PC Status.
The PCF installs a new charging rule and a new RG to track usage during TOD.
CHF allocates the usage for new RG during TOD restriction until there is any other UC restriction than TOD, is applied.
When a Gy/N40 transaction for a subscriber first comes after TOD restriction period is over, CHF sends another SNR or N28_Notify to the PCF with the TOD PCID and Outside PC status, triggering the PCF to modify the rule.
This feature is not applicable for re-rating/non real-time charging interface.
It is applicable to 4G/5G data calls.
The status of the TOD Policy counter changes to Inside or Outside only when a Gy/N40 request enters or exits Time of Day window.
For example, if a SLR/N28_Subscribe request comes inside the TOD time-frame, but Gy/N40 request is not yet received inside the TOD frame, the status for Policy Counter ID is still sent as Outside in the SLA/N28_Subscribe response.
Note : For the feature to work, you must configure all the configurations noted below along with the feature flag Allow Rating Group flow during TimeOfDay set to 1.
Configuration for TOD allowed RGs, TOD PCID and status values The TOD Allowed RGs are the rating groups for which there will be a successful grant even inside the TOD time-frame.
Thus, TOD restrictions are not applied to these RGs during 4G or 5G calls but other UC restrictions will still be applied.
The TOD Policy Counter ID is the policy counter ID used to send status of the TOD Policy counter.
It can have the following status: •TOD Inside Policy Counter Status : This is the status communicated to PCF when the last Gy/N40 call is received inside the TimeOf Day window.
•TOD Outside Policy Counter Status : This is the status communicated to PCF when the last Gy/N40 call is received outside the TimeOf Day window.
•TOD Not Applicable Policy Counter Status : This is the status communicated to PCF when the Gy/N40 call lands and there is no UC TimeOfDay configured in the subscription.
Also, during a Gy/N40 call, if a Sy Session exists for the device which contains the configured TOD Policy Counter ID with Inside or Outside , but the feature flag is disabled, an SNR/N28_Notify is generated which sends the status configured in the TOD Not Applicable Policy Counter Status.
It effectively cancels the status of TOD PCID at PCF, as the feature is now disabled.
If all the values are correctly configured, the current applicable TOD Policy Counter ID and its status is communicated to PCF over the Sy/N28 Interface.
To configure, log into the SM GUI, go to Charging Configuration > Global Configuration .
See the sample values added in the following screen: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1848Charging User Guide Rating and charging Rule to check if UC is subscribed An isUCSubs rule is added to the SPR_DEVICE to validate if the UC subscription is present.
It takes either True or False value.
Different actions get triggered based on the rule.
SPR_DEVICE.isUCSubs=BooleanEnum_TRUE/BooleanEnum_FALSE Following is the rule applied to BOU bundle to validate if UC is present: 8.
19 Rating group or category control This feature provides the flexibility to define a number of schema on a per category basis.
This is to determine whether to include or exclude the usage counting for specific rating groups.
Operators can also enable offline feature to allow specific rating groups without counting usage for access barred devices.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1849Charging User Guide Rating and charging See Allow specific rating groups without counting usage for access barred devices on page 106 for more details.
You can attach these schema to a subscription or a charging service to provide flexibility to define whether the data in a specific MSCC or flow level category to consider the following categories: •Always deny this category •Always allow this category For always allow and always deny categories, add the applicability condition based on rating group.
And attach it to a charging service to define whether the data in a particular MSCC or category is allowed or not.
•Allow and check time or applicability but do not count the usage : Add time as a condition inside the applicability condition to check if a charging service can be selected or not.
•Treat as normal and count and apply usage thresholds : This is the default handling on a category or rating group.
The category logic and rules are enabled as rules based configuration attached to the subscription or charging service definition.
They are processed early in the subscription flow to enable optimization of processing.
8.
19.
1 Always allow this category For always allow this category, the tariff rule is added in the charging service.
Example: if GY_MESSAGE.Multiple-Services-Credit-Control.Rating-Group = 'example' then RATING.No-Charge Tariff rule in charging service is RATING.No-Charge Since the call is free for always allowed rating group, therefore, all the charging services must configure no charge for this rating group.
Otherwise, account balance or bucket is used to cover the call charge.
The result code 2001 is returned.
Note : Since this is always allow this category, the applicability condition in all the charging service must be configured as shown in example.
Example: Allow allowed category The result code can be determined by the rule in GY_PRE_PROCESSING and GY_POST_PROCESSING for always allowed rating group.
In this case, if the CCR has rating group 8, then the call is free of charge and the result code 4011 is returned in CCA message.
If a return result code is configured in the GY_PRE_PROCESSING rule, then the usage is not counted for that rating group.
If a return result code is configured in the GY_POST_PROCESSING rule, then the usage for that rating group can be counted.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1850Charging User Guide Rating and charging GY_POST_PROCESSING 8.
19.2 Always deny this category For always deny this category, the applicability condition is added in the charging service.
Example: GY_MESSAGE.Multiple-Services-Credit-Control.Rating-Group != 'example' The result code 5031 is returned.
Note : As this is always deny category, the applicability condition in all the charging services must be configured with the same rule.
Example: Always denied rating group with result code 4010 The result code can be determined by the rule in GY_PRE_PROCESSING and GY_POST_PROCESSING .
If a valid result code returned in GY_PRE_PROCESSING rule, then it indicates that the rating group is not monitored and counted and the returned result code in rule is used to set the MSCC level result code.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1851Charging User Guide Rating and charging For example, configuration in GY_PRE_PROCESSING and GY_POST_PROCESSING rule.
In this case, during a call, when NCC receives CCR containing rating group 8, then in CCA message for rating group 8, the result code 4010 is returned.
GY_POST_PROCESSING 8.
19.3 Allow and check time or applicability but not count usage The counter is not created inside charging service or as counter, therefore, no counting is done.
If a counter is created, and if there is a need that the counters must not be updated, then the applicability condition must be defined in such a way which disallow counter update.
The time of day period must be checked and application condition must be added.
Examples GY_MESSAGE.Multiple-Services-Credit-Control.Rating-Group = 'example' and CALL_COMMON.Time-Of-Day > 21600000 and CALL_COMMON.Time-Of-Day < 43200000 Tariff rule in charging service is RATING.No-Charge Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1852Charging User Guide Rating and charging Example: Allow and check time but not count usage The following figure shows the configuration of tariff rule for charging service and Applicability Condition rule for counter since this type of category is not countable.
Category is allowed at several time intervals.
The following figure shows the counter configuration.
8.
19.4 Treat as normal, count and apply usage thresholds For counting, the counter can be configured with the consumption type as charging service to count or not.
For usage threshold, the threshold can be configured on counter.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1853Charging User Guide Rating and charging 8.20 Multi-pass functionality A charging service can contain multiple passes and each pass contains a single tariff.
A tariff is a rule in which you can define the actions to be taken based on different conditions.
The passes allow the consumption of all the resources of subscriptions of a device or group.
The multiple passes allow operators to define the resources to be used in phases.
This provides flexibility to operators to define a rule that uses all the non-monetary buckets for the call and then rates from the monetary buckets or main balance.
Let us consider an example where a family and device account have the passes defined.
In this, the tariff defined in the first passes are traversed first followed by the tariff defined in the second passes.
Figure 97: Multiple passes - family and device 8.21 Notification over TCP/IP network Notifications can be sent to the operator back-office systems over the TCP/IP interface for further processing.
To send such notifications, thresholds can be defined.
A threshold is a limit applied on a bucket or counter consumption, and an associated set of actions taken upon crossing that limit.
A limit applied by the top- level group to device on its hierarchy resources.
It restricts the usage beyond a particular value.
A threshold along with the threshold rules can be defined based on which the Notification Server executes the associated actions.
Notification Server can send notifications for the conditions shown in this figure.
These conditions are applicable to threshold.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1854Charging User Guide Rating and charging Figure 98: TCP/IP notification For information on configuring the Notification Server to send notification over the TCP/IP network, see the Notification template variables section in the Notification Service (NS) User Guide .
8.21.
1 Configuration Recommendations for feature configuration Following points are considered while configuring the TCP/IP notification feature: •Define a single notification action, such as a notification sent to a subscriber over SMS, MMS, email, or TCP/IP notification to a network node.
•If multiple thresholds are configured within the same tariff plan, then only one threshold action sends the notification to the subscriber; whereas, the other action sends notification to a network node.
•The TCP/IP notifications are not applicable for IEC calls.
•The bucket notification is sent only when a resource consumption is done from bucket.
For counters, a notification is sent irrespective of whether the counter is incremented through resource consumption of main balance, No-Charge , or bucket.
•The Dynamic Notification Custom flag enables or disables the TCP/IP notification with dynamic variables for bundle or subscription renewal or reset, and resource usage.
•The recursive thresholds must not be applied for end of limit cases of threshold for counter or bucket.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1855Charging User Guide Rating and charging •Dynamic milestones are not considered to compute the counter end time and ULI.
•If ULI is defined in the counter, then the Percentage , Absolute from Start , Absolute from End can also be attached to the counter.
However, if ULI is not defined, then thresholds for Absolute from Start is attached to counter.
•Usage limit is mandatory for Absolute from End threshold type in counter.
In usage limit Absolute from End threshold, the highest threshold is crossed first followed by the second highest and lowest threshold value at last.
On crossing the threshold, the corresponding actions are executed.
See ABE TPG for ULI on page 1484 for more details.
•Overage limit is mandatory for Absolute from End threshold type in counter.
In overage Absolute from End threshold, the highest threshold is crossed first followed by the second highest and lowest threshold value at last.
On crossing the threshold, the corresponding actions are executed.
After the overage limit is crossed, the crossing of thresholds start again from end and this continues without any limit.
ABE TPG for OLI on page 1486 for more details.
•In Usage Control, the overage limit and overage thresholds are supported using two parameters namely Overage Limit and Overage Threshold Profile Group IDs .
•The Absolute from Start threshold type has a preference over the Percentage and Absolute from End threshold types while calculating the value of the Spending Limit Threshold Value .
Also, the Percentage type threshold has preference over the Absolute from End threshold type while calculating the value of the Spending Limit Threshold Value .
•There is only a single stop or reject in a cap on counter at the end, which means it is recommended not to configure Notification-Stop or Reject on a counter in between other caps on counter.
•Cap is not applicable for Absolute from End threshold type.
•Class of service and Billing Account Id can be defined either in custom data dictionary or its value is picked from the device context.
The priority of value in custom data is higher than the value from the device context.
•If charging is done from bucket, then two bucket notifications are sent with subsequent sequence number as commit is done twice in database.
It is in sync with the existing functionality of bucket.
•For resource usage on CCR-U/T feature, UNI is hard-coded in rules based on the kind of unit received from network.
Therefore, for a counter or bucket of money type, UNI value is still BYTE.
Configuring notification variables - SM GUI and custom dictionary The notification variable names are defined using one of the following ways: •Define notification variable names in rules within the absolute or percentage threshold profiles in the SM GUI.
For more information, see the Configuring notification variables using SM GUI on page 1857 .
•Define notification variable names in rules for post processing of CCR-U/T through SM GUI.
•Define notification variable names in ChargingCustomRuleAttributeDictionary.xml custom dictionary file located at /opt/tpa/conf/sac .
The defined notification variable names are then Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1856Charging User Guide Rating and charging loaded in the absolute or percentage threshold profiles of SM GUI.
For more information, see the Configuring notification variables using custom dictionary on page 1857 .
Configuring notification variables using SM GUI Perform the following steps to configure the notification variables using SM GUI: 1.Log into the new GUI and select Charging → ☰ → Threshold profiles .
2.Create a new threshold or edit an existing threshold.
3.The notification variables can be defined in rules within the following threshold profiles: •Percentage threshold •Absolute from start threshold •Absolute from end threshold •Absolute from zero threshold Note : The Absolute from zero threshold profile is visible only when the KindOfUnit is set as Money .
Configuring notification variables using custom dictionary The notification variables can be defined in the ChargingCustomRuleAttributeDictionary.xml custom dictionary file located at /opt/tpa/conf/sac .
Once the notification variables are defined in the custom dictionary, the associated threshold profile in the SM GUI is populated with that notification variable configuration.
Following is an example of defining notification variables using custom dictionary: <attributeDictionary xmlns="ruleAttributeDictionary"> <attribute name="Billing-Account-Id" valueType="StringValueType"> <sourceContext type="RATING_POSTPROCESSING" objectAccessExpr="getBillingAccId()"> <ruleSet>RATING_POST_PROCESSING</ruleSet> </sourceContext> <domain name="CHARGING"/> </attribute> <attribute name="Bucket-Or-Counter-Def-Name" valueType="StringValueType"> <sourceContext type="THRESHOLD_PROFILE" objectAccessExpr="getBucketOrCounterName()"> <ruleSet>THRESHOLD</ruleSet> </sourceContext> <domain name="CHARGING"/> </attribute> Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1857Charging User Guide Rating and charging <attribute name="Notification-Event" valueType="StringValueType"> <sourceContext type="CALL_COMMON" objectAccessExpr="getNotifEventType()"> <ruleSet>THRESHOLD</ruleSet> <ruleSet>GY_POST_PROCESSING</ruleSet> <ruleSet>RATING_POST_PROCESSING</ruleSet> </sourceContext> <domain name="CHARGING"/> </attribute> </attributeDictionary> 8.21.2 Bucket or counter is about to end Notification over TCP/IP network can be sent when a bucket or counter is about to end.
Multiple levels of threshold can be defined for a bucket or counter using the notification variables over the TCP/IP interface.
The header fields are included in every TCP/IP notification.
The dynamic notification variables with notification action can be configured in the threshold rule on the SM GUI.
The TCP/IP notification sent to a network node to indicate that a bucket or counter is about to end consists of the mandatory header fields mentioned in Header fields for sending TCP/IP notification on page 1897 and the following notification variables defined in rules.
Note : The variable names in the notification are configurable.
The same variable name must be used in the Notification template in Notification Server as defined in threshold in Charging.
For further details on NS configuration, see the Notification Service (NS) User Guide .
Parameter Description Example Type Mandatory/ Optional APNRTRACT This variable indicates the account ID of the subscription used in the call.
It can also be mapped to a custom data with name such as Billing Account ID defined in the device.APNRTRACT = SPR_ DEVICE.
Billing Account ID Or APNRTRACT = SUBSCRIPTION.
Account- IdString Optional COS This variable indicates the name of the charging service.
It can also be mapped to a custom data with name such as Segment defined in the device.COS = SPR_ DEVICE.
Segment Or COS = THRESHOLD_ PROFILE.
Charging- ServiceString OptionalTable 202: TCP/IP notification variables for bucket about to end case Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1858Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional CID This variable indicates the bucket ID for which the threshold value is defined that triggers a notification.CID = THRESHOLD_ PROFILE.
Bucket- Def- Name String Optional PCT This variable indicates the threshold percentage value.
You can define multiple threshold percentages in a single threshold profile group and the parameters TH0, TH1 and so on to store the percentage values.
For example, you can create 50% and 20% thresholds, then NCC considers it as TH0= 50% and TH1= 20% and this can be passed in the notification variable as follows: NOTIFICATION.
Notification- Variable (“PCT” , THRESHOLD_ PROFILE.
Threshold- Percentage ( “TH0” ), “ TCPIP_ Notification_ Template AL TNEA” ) NOTIFICATION.
Notification- Variable (“PCT” , THRESHOLD_ PROFILE.
Threshold- Percentage ( “TH1” ), “ TCPIP_ Notification_ Template AL TNEA” )PCT = THRESHOLD_ PROFILE.
Threshold- Percentage Big Decimal Optional MDN This variable indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.MDN = SPR_ DEVICE.
E164 String Optional EVT This variable indicates the notification event ID.
It can be any of these values - ALTNEA , ALTNEA1 , or ALTNEA2 used for notification.EVT = “ALTNEA” String Optional UNI This variable indicates the unit of remaining allowance and configured as a string value.
The service operator ensures that the value of this variable matches the unit type of the bucket.
The supported values are - TIM for time, BYT for volume, MON for money, UNI for unit.UNI = “Money” String OptionalTable 202: TCP/IP notification variables for bucket about to end case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1859Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional TIM This variable indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.TIM = THRESHOLD_ PROFILE.
Notification- Generation- TimestampLong Optional T This variable indicates the time when the notification is generated for a bucket.
It refers to the last three digits or milliseconds of the Unix timestamp.T = THRESHOLD_ PROFILE.
Notification- Generation- Timestamp- MillisLong Optional BAL This variable is the remaining value of the bucket after committing the used quantities reported in USU.
During the configuration of notification variable for a threshold profile, the BAL parameter is mapped to the current value of the bucket.BAL = THRESHOLD_ PROFILE.
Bucket- Balance- Value Double Optional USE This variable indicates the amount used towards the threshold in bucket and is the current consumption towards bucket.USE = THRESHOLD_ PROFILE.
Current- Used- Value Double Optional LNG This variable indicates the language of notification.LNG = "ENGLISH" String OptionalTable 202: TCP/IP notification variables for bucket about to end case (continued) Parameter Description Example Type Mandatory/ Optional APNRTRACT This variable indicates the account ID of the subscription used in the call or device.
It can also be mapped to a custom data with name such as Billing Account ID defined in the device.APNRTRACT = SPR_ DEVICE.
Billing Account ID Or APNRTRACT = SUBSCRIPTION.
Account IDString Optional COS This variable indicates the name of the charging service used in the call or device.COS = SPR_ DEVICE.
Segment COS = THRESHOLD_ PROFILE.
Charging- ServiceString OptionalTable 203: TCP/IP notification variables for counter about to end case Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1860Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional It can also be mapped to a custom data with name such as Segment defined in the device.
CID This variable indicates the Counter name for which the threshold value is defined that triggers a notification.CID = THRESHOLD_ PROFILE.
Counter- Def- NameString Optional CRT/ IT This variable gives the last reset time of the counter instance.CRT = THRESHOLD_ PROFILE.
Counter- Reset- TimestampLong Optional CUT/ JT This variable gives the value when a counter instance was updated by create, read, update, or delete operation, or BCR, that is, Last Admin Update or Billing Cycle Timestamp .CUT = THRESHOLD_ PROFILE.
Counter- Update- TimestampLong Optional PCT This variable indicates the threshold percentage value and follows one of the given criteria: •If usage limit and overage limit are not used, then counters can have threshold types, such as Absolute from start .
To calculate the percentage of the absolute limit, the maximum limit value of counter is the one, which has a threshold defined with Notification- Stop or Reject action.
For example, there are two Absolute from start type thresholds of 900 MB and 1000•If usage limit and overage limit are not used: PCT = THRESHOLD_ PROFILE.
Threshold- Percentage •If usage limit or overage limit is provided in a counter and Percentage type threshold is being executed: PCT = THRESHOLD_ PROFILE.
Counter- Threshold- Percentage ( “< Threshold Name” >)Big Decimal OptionalTable 203: TCP/IP notification variables for counter about to end case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1861Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional MB defined with Notification- Send and Notification- Stop or Reject action respectively.
In this case, the threshold percentage is calculated as 90% and 100% .
If the Notification- Stop or Reject action are not configured, then PCT is set to 0.
If the Notification- Stop or Reject action are configured at multiple thresholds on same counter, then first one is considered for maximum value of counter.
•If usage limit or overage limit is provided in a counter and Percentage type threshold is being executed, then this variable is mapped to the percentage threshold value.
For example, if a threshold is applied at 90% , then this variable is set to 90.
For absolute type thresholds, this variable value remains 0.
MDN This variable indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.MDN = SPR_ DEVICE.
E164 String OptionalTable 203: TCP/IP notification variables for counter about to end case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1862Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional EVT This variable indicates the notification event ID.
It can be any of these values - ALTNEA , ALTNEA1 , or ALTNEA2 used for notification.EVT = “ALTNEA” String Optional UNI This variable indicates the unit of remaining allowance and configured as a string value.
It can be in TIM or BYT.
The service operator ensures that the value of this variable matches the unit type of the counter.
A dedicated UNI string value can be used for money and unit also.
It can be configured as per need such as MON can be used for Money.
The supported values are - TIM for time, BYT for volume, MON for money, UNI for unit.UNI = “Money” String Optional TIM This variable indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.TIM = THRESHOLD_ PROFILE.
Notification- Generation- TimestampLong Optional T This variable indicates the time when the notification is generated for a counter.
It refers to the last three digits or milliseconds of the Unix timestamp.T = THRESHOLD_ PROFILE.
Notification- Generation- Timestamp- MillisLong Optional TST This variable is defined as hard- coded string value, such as hard- stop or soft- stop.
OR This variable can also be mapped to the Action- Type parameter to giveTST = "Hard Stop" OR TST = THRESHOLD_ PROFILE.
Action- Type( "< Threshold Name> ")String OptionalTable 203: TCP/IP notification variables for counter about to end case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1863Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional actions configured in threshold.
BAL This variable is the remaining allowance to next threshold in decimal.
Example: A counter has two thresholds defined at 50% (250 bytes) and 80% ( 400 bytes) .
Consider that 50% of threshold is crossed and the used value stored in counter is 300 bytes.
A CCR- U request arrives with USU = 50 bytes.
In this case, BAL = 50 bytes and USE = 350 bytes.BAL = THRESHOLD_ PROFILE.
Counter- Current- ValueDouble Optional USE This variable indicates the amount used towards the threshold in counter.USE = THRESHOLD_ PROFILE.
Current- Used- ValueDouble Optional LNG This variable indicates the language of notification.LNG = "ENGLISH" String OptionalTable 203: TCP/IP notification variables for counter about to end case (continued) Example 1: Bucket is about to end Bob has an iPhone associated with a data bucket of 500 MB.
A threshold is defined at 200 MB.
When the bucket value reaches the defined threshold of 200 MB, a notification is sent to Bob.
The Send-Notification action variable is defined for 200 MB.
For this example, configure the following entities: Entity Task Notification server Configure the TCP/ IP server.
Multiple TCP/ IP servers can be defined.
Notification template Define the text to be sent to Bob.
Notification preferences Create a notification profile.
Thresholds Create a threshold and define the notification variables along with the threshold rules.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1864Charging User Guide Rating and charging Entity Task Charging services Create a charging service with 500 MB data bucket.
Device Create a device and associate it with device lifecycle, set the notification profile, and add the bundle subscription.
Account Create an account and associate it with the account lifecycle.
Bundles Create a bundle and associate it with the charging service.
Lifecycles Create the lifecycles for device, account, bundle.
The following figure shows the threshold rule defined in the SM GUI ( Charging → ☰ → Threshold profiles ): Example 2: Counter is about to end Bob has an iPhone associated with a subscription counter and data bucket of 1 GB and subscribed with a device subscription.
The counter accumulates the bucket resources consumed.
Threshold is defined at 200 MB, 500 MB, 700 MB on counter along with notification variables in the threshold rule.
Notification is sent when the counter value reaches the thresholds defined, that is, notification is sent at 200 MB, 500 MB, 700 MB.
Send-Notification action variable is defined for 200 MB, 500 MB, 700 MB.
For this example, configure the following entities: Entity Task Notification server Configure the TCP/ IP server.
Multiple TCP/ IP servers can be defined.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1865Charging User Guide Rating and charging Entity Task Notification template Define the text to be sent to Bob.
Notification preferences Create a notification profile.
Thresholds Create a threshold and define the notification variables along with the threshold rules.
Charging services Create a charging service with 1 GB data bucket, and usage counter.
Device Create a device and associate it with device lifecycle, set the notification profile, and add the bundle subscription.
Account Create an account and associate it with the account lifecycle.
Bundles Create a bundle and associate it with the charging service.
Lifecycles Create the lifecycles for device, account, bundle.
The following figure shows the threshold rules for multiple levels of thresholds defined in the SM GUI (Charging → ☰ → Threshold profiles ): Notification at 200 MB: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1866Charging User Guide Rating and charging Notification at 500 MB: Notification at 700 MB: Example 3: Cap at multiple levels The following figure shows the notification variables for multi-level cap: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1867Charging User Guide Rating and charging 8.21.3 Bucket or counter limit is reached Notification can be sent for a bucket or counter when the limit defined is reached or at the end of CCR-U/T request.
Whenever a consumption is done from bucket, a notification is sent to the NS with the notification variables (listed in the following table).
A counter can accumulate the consumption of bucket resources.
A counter limit can be set and on reaching this limit, a notification can be sent.
The dynamic notification variables with notification action can be configured in the threshold rule on the SM GUI.
Multiple notifications can be sent if multiple buckets or counters are used in a call.
If two buckets and two counters are used while processing single MSCC, then four notifications are sent for that MSCC.
The TCP/IP notification sent to a network node to indicate that a bucket or counter limit is reached consists of the mandatory header fields mentioned in Header fields for sending TCP/IP notification on page 1897 and the following notification variables defined in rules.
Note : The variable names in the notification are configurable.
The same variable name must be used in the Notification template in Notification Server as defined in threshold in Charging.
For further details on NS configuration, see the NOKIA Converged Charging Notification Service (NS) User Guide .
Parameter Description Example Type Mandatory/ Optional APNRTRACT This variable indicates the account ID of the subscription used in the call.
It can also be mapped to a custom data with name such as Billing Account ID defined in the device.APNRTRACT = SPR_ DEVICE.
Billing Account ID Or APNRTRACT = SUBSCRIPTION.
Account IDString OptionalTable 204: TCP/IP notification variables for bucket limit reached case Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1868Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional COS This variable indicates the name of the charging service.
For example, Charging Service1 .
It can also be mapped to a custom data with name such as Segment defined in the device.COS = SPR_ DEVICE.
Segment COS = THRESHOLD_ PROFILE.
Charging- ServiceString Optional CID This variable indicates the bucket ID for which the threshold value is defined that triggers a notification.CID = THRESHOLD_ PROFILE.
Bucket- Def- Name String Optional PCT This variable indicates the threshold percentage value.
For absolute threshold, the Percentage of absolute limit is calculated and mentioned in the PCT variable.
This means if the threshold level is set to 900 and the bucket initial value is 1000, then it is 90 percent in the notification , then PCT is set to 100 percent.PCT = THRESHOLD_ PROFILE.
Threshold- PercentageBig Decimal Optional MDN This variable indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.MDN = SPR_ DEVICE.
E164 String Optional EVT This variable indicates the notification event ID and ALTLMT is set as the variable value.EVT = “ALTLMT" String Optional UNI This variable indicates the unit of remainingUNI = “Money” String OptionalTable 204: TCP/IP notification variables for bucket limit reached case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1869Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional allowance and configured as a string value.
The service operator ensures that the value of this variable matches the unit type of the bucket.
TIM This variable indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.TIM = THRESHOLD_ PROFILE.
Notification- Generation- TimestampLong Optional T This variable indicates the time when the notification is generated for a bucket.
It refers to the last three digits or milliseconds of the Unix timestamp.T = THRESHOLD_ PROFILE.
Notification- Generation- Timestamp- MillisLong Optional ULI This variable indicates the value of maximum limit consumed from a bucket balance.
It is the value of the threshold reached in a CCR- U/T.
If a threshold is not reached, then its value is zero.
If multiple thresholds are crossed in a single request, the value of the maximum threshold being crossed is included in ULI.
In case of percentage threshold, the % value is translated into absolute value and included in ULI.ULI = THRESHOLD_ PROFILE.
Bucket- End- Value Long Optional Currently, NCC does not support overage on bucket.
Therefore, this parameter always has Bucket Initial Value.Table 204: TCP/IP notification variables for bucket limit reached case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1870Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional Do not configure CAP and threshold together.
If configured, then the latest one is considered.
Note : This variable value is automatically generated by NCC and not specified by the service operator.
OLI This variable indicates the overage allowance limit.
Since overage is not supported by NCC, the OLI parameter is always set to zero .OLI = THRESHOLD_ PROFILE.
Overage- Allowance Double Optional BAL This variables is the remaining value of the bucket after committing the used quantities reported in USU.
During the configuration of notification variable for a threshold profile, the BAL parameter is mapped to the current value of the bucket.BAL = THRESHOLD_ PROFILE.
Bucket- Balance- ValueDouble Optional USE This variable indicates the amount used towards the threshold in bucket and has the bucket initial value.USE = THRESHOLD_ PROFILE.
Current- Used- ValueDouble Optional LNG This variable indicates the language of notification.LNG = "ENGLISH" String OptionalTable 204: TCP/IP notification variables for bucket limit reached case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1871Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional APNRTRACT This variable indicates the account ID of the subscription used in the call.
It can also be mapped to a custom data with name, such as Billing Account ID defined in the device.APNRTRACT = SPR_ DEVICE.
Billing Account ID Or APNRTRACT = SUBSCRIPTION.
Account IDString Optional COC This variable provides a count of the ongoing overage block as overage limit keep on repeating multiple times.COC = THRESHOLD_ PROFILE.
Counter- Overage- CountInteger Optional COS This variable indicates the name of the charging service.
It can also be mapped to a custom data with name, such as Segment defined in the device.COS = SPR_ DEVICE.
Segment COS = THRESHOLD_ PROFILE.
Charging- ServiceString Optional COU This variable gives the overage usage in currently ongoing overage block.COU = THRESHOLD_ PROFILE.
Current- Overage- UsageBig decimal Optional CID This variable indicates the counter name for which the threshold value is defined that triggers a notification.CID = THRESHOLD_ PROFILE.
Counter- Def- NameString Optional CRT/ IT This variable gives the last reset time of the counter instance.CRT = THRESHOLD_ PROFILE.
Counter- Reset- TimestampLong Optional CUT/ JT This variable gives the value when a counter instance was updated by create, read, update, or delete operation, or BCR, that is, Last Admin Update or Billing Cycle Timestamp .CUT = THRESHOLD_ PROFILE.
Counter- Update- TimestampLong Optional PCT This variable indicates the threshold percentage value and follows one of the given criteria:•If usage limit and overage limit are not used:Big Decimal OptionalTable 205: TCP/IP notification variables for counter limit reached case Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1872Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional •If usage limit and overage limit are not used, then counters can only have threshold types, such as Absolute from start .
To calculate the percentage of the absolute limit, the maximum limit value of counter is the one, which has a threshold defined with Notification- Stop or Reject action.
For example, there are two Absolute from start type thresholds of 900 MB and 1000 MB defined with Notification- Send and Notification- Stop or Reject action respectively.
In this case, the threshold percentage is calculated as 90% and 100% .
If the Notification- Stop or Reject action are not configured, then PCT is set to 0.
If the Notification- Stop or Reject action are configured at multiple thresholds on same counter, then first one is considered for maximum value of counter.
•If usage limit or overage limit isPCT = THRESHOLD_ PROFILE.
Threshold- Percentage •If usage limit or overage limit is provided in a counter and Percentage type threshold is being executed: PCT = THRESHOLD_ PROFILE.
Counter- Threshold- Percentage ( “< Threshold Name” >)Table 205: TCP/IP notification variables for counter limit reached case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1873Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional provided in a counter and Percentage type threshold is being executed, then this variable is mapped to the percentage threshold value.
For example, if a threshold is applied at 90% , then this variable is set to 90.
For absolute type thresholds, this variable value remains 0.
MDN This variable indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.MDN = SPR_ DEVICE.
E164 String Optional EVT This variable indicates the notification event ID.
In this case, it is AL TLMT.EVT = “ALTLMT” String Optional UNI This variable indicates the unit of remaining allowance and configured as a string value.
The service operator ensures that the value of this variable matches the unit type of the counter.
A dedicated UNI string value can be used for money and unit also.
It can be configured as per need such as MON can be used for Money.
The supported values are - TIM for time, BYT for volume, MON for money, UNI for unit.UNI = “Money” String OptionalTable 205: TCP/IP notification variables for counter limit reached case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1874Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional TIM This variable indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.TIM = THRESHOLD_ PROFILE.
Notification- Generation- TimestampLong Optional T This variable indicates the time when the notification is generated for a counter.
It refers to the last three digits or milliseconds of the Unix timestamp.T = THRESHOLD_ PROFILE.
Notification- Generation- Timestamp- MillisLong Optional TOU This variable gives the total usage in overage blocks.TOU = THRESHOLD_ PROFILE.
Total- Overage- UsageBig decimal Optional TST This variable is defined as hard- coded string value, such as hard- stop or soft- stop.
OR This variable is mapped to Action- Type parameter to configure actions in threshold.TST = "Hard Stop" OR TST = THRESHOLD_ PROFILE.
Action- Type( "< Threshold Name> ")String Optional ULI If usage limit on a counter is not defined, then this variable indicates the maximum limit value, which can be stored in a counter.
This is an absolute value of counter threshold corresponding to the Notification-Stop or Reject action.
However, if usage limit on a counter is defined, then this variable is also mapped to the prorated usage limit in the counter instance.•If usage limit on a counter is not defined: ULI = THRESHOLD_ PROFILE.
Counter- End- Value •If usage limit on a counter is defined: ULI = THRESHOLD_ PROFILE.
Counter- Usage- LimitBig decimal Optional OLI This variable indicates the overage limit in the counter instances.OLI = THRESHOLD_ PROFILE.
Counter- Overage- LimitBig decimal OptionalTable 205: TCP/IP notification variables for counter limit reached case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1875Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional BAL This variable is the remaining allowance to next threshold in decimal.
In this notification, this parameter is set to 0 value.BAL = THRESHOLD_ PROFILE.
Counter- Current- ValueDouble Optional USE This variable indicates the amount used towards the threshold in counter.USE = THRESHOLD_ PROFILE.
Current- Used- ValueDouble Optional LNG This variable indicates the language of notification.LNG = "ENGLISH" String OptionalTable 205: TCP/IP notification variables for counter limit reached case (continued) If multiple overage block are being consumed in a single call, then notification parameter has the current value, count, and overage usage as per the overage block (current or previous) for which threshold is being executed.
For example: If Usage Limit = 10 GB and Overage Limit = 1 GB with threshold notification on 50% and 100% usage; and counter current value changes from 10 GB to 12.5 GB .
In this case, the threshold notification has three notifications: 1.On 100% consumption of first overage block (previous), such as on 11 GB usage, with Counter- Current-Value = 11 GB , Current-Overage-Usage = 1 GB , Total-Overage-Usage = 1 GB , and Counter- Overage-Count = 1.
2.On 100% consumption of second overage block (previous), which is 12 GB usage, with Counter- Current-Value = 12 GB , Current-Overage-Usage = 1 GB , Total-Overage-Usage = 2 GB , and Counter- Overage-Count = 2 3.On 50% consumption of third overage block (current), which means on 12.5 GB usage, with Counter- Current-Value = 12.5 GB , Current-Overage-Usage = 0.5 GB , Total-Overage-Usage = 2.5 GB , and Counter-Overage-Count = 3 Note : If a threshold is created from the SM GUI interface, then the threshold name for different profile types follow a predefined nomenclature, as described below: •For Percentage type threshold: ThresholdPercent1 , ThresholdPercent2 ,.... •For Absolute from start type threshold: ThresholdAbsStart1 , ThresholdAbsStart2 ,... •For Absolute from end type threshold: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1876Charging User Guide Rating and charging ThresholdAbsEndCount1 , ThresholdAbsEndCount1 ,... •For Absolute from zero type threshold: ThresholdAbsZeroCount1 , ThresholdAbsZeroCount2 ,... For example, if two Percentage type thresholds are defined, then first Percentage threshold has threshold name = ThresholdPercent1 and second threshold name = ThresholdPercent2 .
This same name is given in source context with argument as <ThresholdName>, such as Action-Type and Counter-Threshold-Percentage .
Example: Bucket limit is reached Bob has an iPhone associated with a data bucket of 10 GB.
An absolute threshold is defined to send notification when the bucket limit is reached, that is, the bucket content is exhausted.
A data call is made and the data bucket is completely used up.
In this case, a notification is sent to Bob with details on the data bucket consumption.
For this example, configure the following entities: Entity Task Notification server Configure the TCP/ IP server.
Multiple TCP/ IP servers can be defined.
Notification template Define the text to be sent to Bob.
Notification preferences Create a notification profile.
Thresholds Create a threshold and define the notification variables along with the threshold rules.
Charging services Create a charging service with 10 GB data bucket.
Device Create a device and associate it with device lifecycle, set the notification profile, and add the bundle subscription.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1877Charging User Guide Rating and charging Entity Task Account Create an account and associate it with the account lifecycle.
Bundles Create a bundle and associate it with the charging service.
Lifecycles Create the lifecycles for device, account, bundle.
The following figure shows the threshold rule defined in the SM GUI ( Charging → ☰ → Threshold profiles ): The following figure shows the threshold rule defined in the SM GUI for the notification sent on counter limit reached scenario: The following figure shows the threshold rule defined in the SM GUI for the notification sent on cap limit reached scenario: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1878Charging User Guide Rating and charging 8.21.4 Resource usage on each CCR-Update/Terminate Notification can be sent to the NS server for a bucket or counter as follows: •Whenever a consumption is done from the bucket, at the end of update and terminate request, a notification is sent with dynamic variables.
•Whenever a counter value is updated, at the end of update and terminate request, a notification is sent with dynamic variables.
An additional logic is supported to check the Report Reason in the Usage messages for update request and terminate request.
The value of the AVP is used to determine if the Update notification is sent.
This is applicable to both 4G and 5G calls.
Following is the rule example for 4G and 5G calls: 4G call: 5G call: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1879Charging User Guide Rating and charging Note : Configure the following condition in the rule to avoid CCR-Initial notification: if RATING_POSTPROCESSING.Discount-Id present The TCP/IP notification sent to a network node to indicate that a bucket is consumed consists of the mandatory header fields mentioned in Header fields for sending TCP/IP notification on page 1897 and the following notification variables: Note : For further details on NS configuration, see the NOKIA Converged Charging Notification Service (NS) User Guide .
Parameter Description Example Type Mandatory/ Optional ACT This variable indicates the account ID of the subscription used in the call.
Create a custom data dictionary with Id as Billing Account ID and content type as DEVICE .
Attach custom data in device with key as Billing Account ID.
Priority of custom data is higher.APNRTRACT = RATING_ POSTPROCESSING.
Billing- Account- Id Or APNRTRACT = SUBSCRIPTION.
Account IDString OptionalTable 206: TCP/IP notification variables for bucket consumption at each CCR-U/T Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1880Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional APNTRCOS This variable indicates the name of the charging service.
Create a custom data dictionary with Id as Segment and content type as DEVICE .
Attach custom data in device with key as Segment .
Priority of custom data is higher.COS = RATING_ POSTPROCESSING.
Class- Of-Service COS = THRESHOLD_ PROFILE.
Charging- ServiceString Optional BUNDLE This variable indicates the name of the bundle.BUNDLE = RATING_ POSTPROCESSING.
Bundle- NameString Optional CID This variable indicates the discount ID.
It is the ID of the bucket for which notification is sent.CID = RATING_ POSTPROCESSING.
Discount- IdString Optional CIDABYUSE This variable indicates the bucket value.
If there is a carry- over bucket used in the call, the value of CV is the sum of main bucket value and carry- over bucket value.CIDABYUSE = RATING_ POSTPROCESSING.
Current- ValueBigDecimal Optional CRT This variable indicates the bucket reset timestamp.CRT = RATING_ POSTPROCESSING.
Reset- TimestampLong Optional CUT This variable indicates the timestamp of either last Billing Cycle Reset ( BCR) or any HLAPI/ Admin change to buckets.
It has the value when bucket was updated by any method such as CRUD operation or BCR.CUT = RATING_ POSTPROCESSING.
Last- Billing- Cycle- TimestampLong Optional MDN This variable indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.MDN = SPR_ DEVICE.
E164 String OptionalTable 206: TCP/IP notification variables for bucket consumption at each CCR-U/T (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1881Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional EVT This variable indicates the notification event.EVT = CALL_ COMMON.
Notification- EventString Optional T This variable indicates the time when the notification is generated for a bucket.
It refers to the last three digits or milliseconds of the Unix timestamp.T = RATING_ POSTPROCESSING.
Unix- Timestamp- MsLong Optional TIM This variable indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.TIM = RATING_ POSTPROCESSING.
Unix- TimestampLong Optional TOS This variable indicates the type of service.
It can have values like DIAM, SMSC.TOS = DIAM String Optional Following is the list of different values for TOS: •VOIC: Voice call •SMSC: Short message •MMSC: Multimedia message •PACK: Data transport •BREW: Brew service •ADMN: Audit •IMOM: IMOM call •DIAM: Diameter •USSD: Unstructured Supplementary Service Data •VDEO: Vo L TE video call TYPE This variable indicates the resource type for which notification is being triggered.
For bucket consumption, this is set as BUCKET .TYPE = RATING_ POSTPROCESSING.
Resource- TypeString OptionalTable 206: TCP/IP notification variables for bucket consumption at each CCR-U/T (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1882Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional ULI This variable indicates the spending limit threshold.
This is the absolute value of Threshold/ CAP ( even if they are defined in percentage) , which is reached during the processing of CCR- U/T.
If no threshold/ CAP is reached, this parameter is sent as 0.ULI = RATING_ POSTPROCESSING.
Last- Crossed- Threshold- ValueBigDecimal Optional UNI This variable indicates the unit of remaining allowance and configured as a string value.
The service operator ensures that the value of this variable matches the unit type of the bucket.
Specify values such as MON, TIM, BYT.UNI = MON String Optional USU This variable indicates the reported units in CCR from CCR- U/T.USU = CALL_ COMMON.
Used- Service- UnitsLong OptionalTable 206: TCP/IP notification variables for bucket consumption at each CCR-U/T (continued) Parameter Description Example Type Mandatory/ Optional ACT This variable indicates the account ID of the subscription used in the call.
Create a custom data dictionary with Id as Billing Account ID and content type as DEVICE .
Attach custom data in device with key as Billing Account ID.
Priority of custom data is higher.APNRTRACT = RATING_ POSTPROCESSING.
Billing Account ID Or APNRTRACT = SUBSCRIPTION.
Account IDString OptionalTable 207: TCP/IP notification variables for counter consumption at each CCR-U/T Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1883Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional APNTRCOS This variable indicates the name of the charging service.
Create a custom data dictionary with Id as Segment and content type as DEVICE .
Attach custom data in device with key as Segment .
Priority of custom data is higher.COS = RATING_ POSTPROCESSING.
Class- Of- Service COS = THRESHOLD_ PROFILE.
Charging- ServiceString Optional BUNDLE This variable indicates the name of the bundle.BUNDLE = RATING_ POSTPROCESSING.
Bundle- NameString Optional CID This variable indicates the discount ID.
It is the ID of the counter for which notification is sent.CID = RATING_ POSTPROCESSING.
Discount- Id CIDABYUSE This variable indicates the counter value.CIDABYUSE = RATING_ POSTPROCESSING.
Current- ValueString Optional COC This variable provides a count of the ongoing overage block as the overage limit blocks keep on repeating multiple times.COC = RATING_ POSTPROCESSING.
Counter- Overage- CountInteger Optional CRT This variable indicates the counter reset timestamp.CRT = RATING_ POSTPROCESSING.
Reset- TimestampLong Optional CUT This variable indicates the timestamp of either last Billing Cycle Reset ( BCR) or any HLAPI/ Admin change to buckets.
It has the value when counter was updated by any method such as CRUD operation or BCR.CUT = RATING_ POSTPROCESSING.
Last- Billing- Cycle- TimestampLong OptionalTable 207: TCP/IP notification variables for counter consumption at each CCR-U/T (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1884Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional EVT This variable indicates the notification event.EVT = CALL_ COMMON.
Notification- Event String Optional MDN This variable indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.MDN = SPR_ DEVICE.
E164 String Optional OLI This variable indicates the overage limit in the counter instances.OLI = RATING_ POSTPROCESSING.
Counter- Overage- LimitBig decimal Optional T This variable indicates the time when the notification is generated.
It refers to the last three digits or milliseconds of the Unix timestamp.T = RATING_ POSTPROCESSING.
Unix- Timestamp- MsLong Optional TIM This variable indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.TIM = RATING_ POSTPROCESSING.
Unix- TimestampLong Optional TOS This variable indicates the type of service.
It can have values like DIAM, SMSC.TOS = DIAM String Optional Following is the list of different values for TOS: •VOIC: Voice call •SMSC: Short message •MMSC: Multimedia message •PACK: Data transportTable 207: TCP/IP notification variables for counter consumption at each CCR-U/T (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1885Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional •BREW: Brew service •ADMN: Audit •IMOM: IMOM call •DIAM: Diameter •USSD: Unstructured Supplementary Service Data •VDEO: Vo L TE video call TYPE This variable indicates the resource type for which notification is being triggered.
For counter consumption, this is set as COUNTER .TYPE = RATING_ POSTPROCESSING.
Resource- TypeString Optional ULI This variable indicates the spending limit threshold.
It is absolute value of threshold or cap.
If no threshold or cap is reached, then this variable is sent as 0.
OR If usage limit is defined, then this variable can also be mapped to the prorated usage limit in the counter instance.•If usage limit is not defined: ULI = RATING_ POSTPROCESSING.
Last- Crossed- Threshold- Value •If usage limit is defined: ULI = RATING_ POSTPROCESSING.
Counter- Usage- LimitBigDecimal Optional UNI This variable indicates the unit of remaining allowance and configured as a string value.
The service operator ensures that the value of this variable matches the unit type of the counter.UNI = MON String OptionalTable 207: TCP/IP notification variables for counter consumption at each CCR-U/T (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1886Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional Specify values such as MON, TIM, BYT.
USU This variable indicates the reported units in CCR from CCR- U/T.USU = CALL_ COMMON.
Used- Service- Units Long OptionalTable 207: TCP/IP notification variables for counter consumption at each CCR-U/T (continued) Example: Notification at end of CCR-U/T for bucket and counter A notification is sent on counter usage at the end of each CCR-U/T request.
Consider that a subscription is attached to a device and the device has two custom data as - BillingAccountID = Account1, Segment = CS1.
The subscription is of bundle with only one charging service (CS1).
The charging service has one data bucket with initial value 1000000000.
A counter (C1) is attached to a device and the counter is of volume type with Counter Type = USAGE, CounterScope = ALL, CounterConsumptionType = ALL.
The counter has threshold profile group with thresholds - Threshold1 = 10 from absolute start, Threshold2 = 20 from absolute start.
Note : For counters, absolute from end and percentage thresholds are allowed.
For configuration of absolute from end threshold, refer to section ABE TPG for ULI on page 1484 ).
Initial call with RSU = 15 A data call is initiated with RSU = 15.
Reservation is done from bucket and current value = 999999985 and Unused value = 1000000000.
The call is updated with USU = 15 and RSU = 10.
The bucket is committed and the current value = 999999975 and unused value = 999999985.
The counter (C1) is applicable and is incremented to 15.
Threshold is processed and Threshold1 is crossed.
Two notifications are sent in update.
One for bucket and another for counter.
Following is the content of notification sent after update call: MSGID=TNWCRTAT5:1:18:18010:48446:@1458318061:1#RETRY1;APNRTRCOSCS1MDN1234568789 ACTAccount1TOSPACKEVTCCRU CIDB1USE00000000015.000000ULI000000000000000000UNIBYTTIM1458318061T752USU15.
000000CRT0CUT14581158 MSGID=TNWCRTAT5:1:18:18010:48446:@1458318061:1#RETRY2;APNRTRCOSCS1MDN1234568789 ACTAccount1TOSPACKEVTCCRU CIDC1USE00000000015.000000ULI000000000000000010UNIBYTTIM1458318061T752USU15.
000000CRT0CUT14581158 Terminate with USU = 10 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1887Charging User Guide Rating and charging A terminate request with USU = 10 is sent.
The bucket is committed and current value = 999999975 and unused value = 999999975.
The counter (C1) is applicable and is incremented to 25.
The threshold (Threshold2) is crossed and notification is sent after update call with the following notification content: MSGID=TNWCRTAT5:1:18:18010:48446:@1458318061:1#RETRY1;APNRTRCOSCS1MDN1234568789 ACTAccount1TOSPACKEVTCCRT CIDB1USE00000000010.000000ULI000000000000000000UNIBYTTIM1458318061T752USU10.
000000CRT0CUT14581158 MSGID=TNWCRTAT5:1:18:18010:48446:@1458318061:1#RETRY2;APNRTRCOSCS1MDN1234568789 ACTAccount1TOSPACKEVTCCRT CIDC1USE00000000010.000000ULI000000000000000020UNIBYTTIM1458318061T752USU10.
000000CRT0CUT14581158 Note : Notifications only have the attributes defined in the rule of rating post processing.
The following figure shows the rule group created for the RATING_POST_PROCESSING trigger: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1888Charging User Guide Rating and charging The following figure shows the variables configured for the rule group created for the RATING_POST_PROCESSING trigger: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1889Charging User Guide Rating and charging 8.21.5 Bundle or subscription renewal Notification can be sent when a bundle or subscription is renewed or reset using the subscription or account entity.
When a subscription is renewed or reset, the Send-Notification action at Subscription Renewed Event and Subscription Reset Event events in lifecycle are triggered internally.
The subscription is scanned and the attached bucket and counter information is retrieved, which is further sent to the notification server.
Note that a subscription is an instance of a bundle owned and paid by the account.
For each bucket or counter, a new notification is sent to the external notification client for further processing.
To enable this notification, set the Dynamic Notification Custom flag to true.
The TCP/IP notification sent to a network node to indicate that a bundle or subscription is renewed or reset consists of the mandatory header fields mentioned in Header fields for sending TCP/IP notification on page 1897 and the following notification variables: Note : For further details on NS configuration, see the NOKIA Converged Charging Notification Service (NS) User Guide .
Parameter Description Example Type Mandatory/ Optional ACT This variable must be mapped to a custom data with name such as Billing Account ID defined in the device.
Otherwise, this parameter value is null.APNRTRACT = SPR_ DEVICE.
Billing Account IDString Optional APNRTRCOS This variable must be mapped to a custom data with name such as Segment defined in the device.
Else this parameter value is null.NCC String Optional Bundle ID This variable indicates the bundle ID of the subscription for which the notification is sent.Bundle123 String Optional CID This variable indicates the bucket ID or counter ID for which the notification is sent.Bucket1/ Counter1 String Optional Device ID This variable indicates the device identifier that triggers the notification.Device124 String OptionalTable 208: TCP/IP notification variables for bundle or subscription renewal case Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1890Charging User Guide Rating and charging Parameter Description Example Type Mandatory/ Optional Device Identifier ( IMSI) This variable indicates the IMSI value or device that triggers the notification.100000001 String Optional EVT This variable indicates the notification event ID.NOTRST String Optional TOS This variable indicates the service type.ADMN ( constant for current notification)String Optional MDN This variable indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.100000001 String Optional UNI This variable indicates the unit of remaining allowance and configured as a string value.
The service operator ensures that the value of this variable matches the unit type of the bucket or counter.
This can be in TIM for time, BYT for volume, UNI for unit, MON for money.BYT String Optional TIM This variable indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.1525169028 Long Optional T This variable indicates the time when the notification is generated.
It refers to the last three digits or milliseconds of the Unix timestamp.306 Long Optional USE This variable indicates the used bytes in subscription.0 Double OptionalTable 208: TCP/IP notification variables for bundle or subscription renewal case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1891Charging User Guide Rating and charging Example: Bundle renewal and reset Bob has an iPhone associated with a subscription of 10 GB data bucket that gets renewed monthly.
Once the subscription or bundle is renewed, a notification is sent to Bob.
For this example, the ME application preference Dynamic Notification Custom Flag must be set to true and the following entities must be configured: Entity Task Notification server Configure the TCP/ IP server.
Multiple TCP/ IP servers can be defined.
Notification template Define the text to be sent to Bob.
Notification preferences Create a notification profile.
Lifecycles Create a monthly renewal subscription lifecycle with type set to Bill Cycle and applicable to Subscription, and define the Subscription Renewed Event.
Charging services Create a 10 GB data bucket.
Bundles Create the following data: •Create a bundle and link it to monthly renewal subscription lifecycle •Associate the charging service with 10 GB data bucket to it.
Device Create a device and associate it with device lifecycle, set the notification profile, and add the bundle subscription.
Account Create an account and associate it with account lifecycle.
Note : For details on configuring the ME application preferences, see Managed Elements section in Global Configuration Guide .)
The following figure shows the lifecycle entity configured with the Subscription Renewed Event.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1892Charging User Guide Rating and charging Figure 99: Subscription Renewed Event Similarly, the following figure shows the lifecycle entity configured with the Subscription Reset Event.
Figure 100: Subscription Reset Event 8.21.6 Overage limit is reached for account A notification is sent for an account when the threshold attached to the account is crossed or overage limit is reached at the end of CCR-U/T request.
Whenever a consumption is done from account, a notification is sent to the Notification Server with the notification variables (listed in the Header fields for sending TCP/IP notification on page 1897 table).
The dynamic notification variables with notification action can be configured in the threshold rule on the SM GUI.
Note : A user can configure the TCP/IP notification for threshold values other than overage.
To support notification for an account, the notification variable corresponding to an account is evaluated and passed to the notification client for processing.
When the notification action is triggered on account, the notification action attempts to find the device that belongs to the administrator of the account: •If a device is not found, then the action ends without sending a notification.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1893Charging User Guide Rating and charging •If the device is found, then the notification client is invoked for the first device attached.
Following notification variables are used for sending notification to an account: •AccountId •Account balance •Account End date •Account Entity end date (from entity lifecycle) •Overage Amount •Threshold value The values for account balance, threshold, and overage are displayed as: •If values are decimals, then values with precision limit (up to 2 digits) are received in the email.
For example, if the ThresholdValue = 30.5676 , then value received in the email notification is 30.57 .
•If the values are whole numbers, for example AccountBalance = 20, then the value received in the email notification is 20.0 .
Note : In an email notification, the overage value gets populated for the threshold where overage flag is true when the threshold value received in the email notification is equal to the overage value.
For example: AccountName:AccD175931, AccountCurrentValue:10.0,AccountOverageValue:0.0,AccountEndDate:2019-02-23,ThresholdValue:0.0,AccountEntityEndDate:2019-03-18 For information on thresholdName , thresholdValue , recurring , and overageFlag EDR tags, see the NOKIA Converged Charging CDR/EDR Reference guide .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1894Charging User Guide Rating and charging Figure 101: Example for TCP/IP threshold configuration when overage limit is reached for an account Variable name Description Example Type Mandatory/ Optional APNRTRACT This variable must be mapped to a custom data with name such as Billing Account ID defined in the device.
Else this parameter value is null.APNRTRACT = SPR_ DEVICE.
Billing Account IDString Optional COS This variable must be mapped to a custom data with name such as Segment defined in the device.
Else this parameter value is null.NCC String Optional CID This variable indicates the account ID for which the notification is sent.
It canBucket1/ Counter1 String OptionalTable 209: TCP/IP notification variables for overage limit reached case Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1895Charging User Guide Rating and charging Variable name Description Example Type Mandatory/ Optional also be filled with a static value.
PCT The threshold cannot be defined for account.
Therefore, it can be filled with a static value, example, 100.PCT = THRESHOLD_ PROFILE.
Threshold- PercentageBig Decimal Optional MDN This variable indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.100000001 String Optional EVT This variable indicates the notification event ID.
In the current case, it is OVGLMT.NOTRST String Optional UNI This variable indicates the unit of remaining allowance and configured as a string value.
MON can be used for money.MON String Optional TIM This variable indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.1525169028 Long Optional T This variable indicates the time when the notification is generated.
It refers to the last three digits or milliseconds of the Unix timestamp.306 Long Optional ULI This variable indicates the spending limit counter threshold.
It is the value of overage defined on account.
If there is no overage defined on account, then this parameter has the value 0.THRESHOLD_ PROFILE.
Overage- ValueLong OptionalTable 209: TCP/IP notification variables for overage limit reached case (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1896Charging User Guide Rating and charging Variable name Description Example Type Mandatory/ Optional BAL This variable indicates the remaining allowance to next threshold.
It can be set to a static value of 0.THRESHOLD_ PROFILE.
Account- Current- ValueBIG DECIMAL Optional USE This variable indicates the overage defined on account.
If there is no overage defined on account, then this parameter has the value 0.0 Double Optional LNG This variable indicates the language of notification.LNG = “ ENGLISH” String OptionalTable 209: TCP/IP notification variables for overage limit reached case (continued) Note : If you configure the notification variable with value THRESHOLD_PROFILE.Overage-Value in rule actions, then it only contains value when Overage Flag is set TRUE in ThresholdProfileGroup.
8.21.7 Header fields and notification variables for sending TCP/IP notification The following section provides details on the notification variables used for TCP/IP notifications.
Header fields for sending TCP/IP notification The following header fields in a notification template are sent to a network node for handling Charging Data Records (CDRs).
Note : For notification using the northbound provisioning interface, SYSTEM context parameters as header parameters.
The header information is not defined in the notification template but are predefined attributes in the Notification Server.
Format of TCP/IP notification is as follows: MSGID=MASID:SPAID:HOSTID:CLIENTID:Sequentialnumber:@timecode:UsageSequenceNumber#RETRY0/1/2 Example: MSGID=TNWCRTAT7:2:3:3005:81806:@1458289358#RETRY0; The following table explains the fields in the notification template for sending a TCP/IP notification: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1897Charging User Guide Rating and charging Header field Description Example Type Mandatory/ Optional MASID This variable indicates the identifier of the physical system, such as system ID.
This is the NCC site ID that generates the notification.MASID = CALL_ COMMON.
Site_ ID or SYSTEM.
Site- IDString Mandatory SPAID This variable indicates the identifier of the application fixed against the NCC node.SPAID = CALL_ COMMON.
Application_ ID or SYSTEM.
OCS- Application- IDInteger Mandatory HOSTID This variable indicates the identifier of the host.HOSTID = CALL_ COMMON.
Host_ ID or SYSTEM.
Host- IDString Mandatory CLIENTID This variable indicates the client identifier within the host.
Note : As there is no separate client ID in NCC, the Client ID has the same value as the SPAID .CLIENTID = CALL_ COMMON.
Application_ ID or SYSTEM.
OCS- Application- IDString Mandatory Sequential Number This variable is the Sequence ID for the notification transaction.
It is sent by the notification server.5 Integer Mandatory Timecode This variable is the Unix timestamp of each message being sent.
It is updated with each retry and is sent by the notification server.525068484725 Long Mandatory Usage Sequence Number This variable is the notification processing sequence number of usage (bucket or counter) for which the notification is being sent.
It is sent by charging to NS so that same can be used by NS while sending1 Integer MandatoryTable 210: Header fields for sending TCP/IP notification to a network node Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1898Charging User Guide Rating and charging Header field Description Example Type Mandatory/ Optional the notification to TCP/ IP server.
Note : It is used only in CCR- U and CCR- T. #RETRY0/ 1/2 The number of retries that have been made to send the message without ACK.
It is sent by the notification server.
1#RETRY< X>, where < X> is the number of retries that have been made to send the message without ACK.0/1/2 Integer MandatoryTable 210: Header fields for sending TCP/IP notification to a network node (continued) 8.22 Auto-charge notification This feature provides the functionality to automatically recharge or renew a device or group when subscription is about to expire or subscription is about to empty : •In case of subscription is about to expire scenario, when the Send Notification action triggers in the lifecycle of a device or group, then NCC checks the special custom data in the device or group to decide which Notification Template ID is being sent.
The notification template should include DeviceId or GroupID , Notification Template ID , and Bundle ID .
•Similarly, for the subscription is about to empty scenario, the threshold for a device or group is configured for a desired value and when the threshold triggers, NCC checks the special custom data in the device or group to decide which Notification Template ID is being sent.
The notification template should include DeviceId or GroupID , Notification Template ID , and Bundle ID .
The auto-charge notification is sent by NCC to the third-party entity through notification of http type, which is configured in the Notification Server for notification template used for the auto-charge feature.
On receiving the auto-charge notification for a group, the third-party entity performs some set of steps to attach a new bundle to the group using template feature.
For example, ACNotifSetting is a custom data attribute of the group or the device.
Its value is enabled when the auto-charge feature is enabled.
If the ACNotifSetting is enabled, then NCC sends auto-charge notification template.
Otherwise, NCC sends expiry notification template.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1899Charging User Guide Rating and charging Variable name Description Format Count Mandatory/ Optional Subscriber CD This parameter is populated by the custom data associated with a device or group, which is filled by the operator provisioning system.Alphanumeric characters (a to z, A to Z, 0 to 9) , hyphen, underscore, @ This parameter supports a maximum of 20 characters.1 Mandatory Share ID This parameter indicates the Group ID linked to the subscription.Alphanumeric characters (a to z, A to Z, 0 to 9) , hyphen, underscore This parameter supports a maximum of 30 characters.1 Mandatory Auto Charge Plan NameThis parameter indicates the string read from the group custom data that is filled by the operator provisioning system.This parameter supports a maximum of 15 characters.1 MandatoryTable 211: Notification variables for sending auto-charge notification 8.22.
1 Sending auto-charge notification - Threshold To send the notification using threshold, the configuration is first defined at the Aggregate View under the Platform & Common .
This Aggregate View configuration is further attached to a group or device.
Example for sending auto-charge notification when device subscription is about to expire Consider a device that executes a threshold action ( SendNotification ) when the Aggregate View associated with the device and the auto-charge feature is enabled for the device.
Configuration: 1.Create three custom data as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1900Charging User Guide Rating and charging 2.Create a threshold profile group, which is set to ABSOLUTE_FROM_END with SendNotification action and three notification variables ( ShareID , SubcscriberCD , and AutoChargePlanName ) as shown in the following figure: 3.Attach this threshold profile group to the Aggregate View as shown in the following figure: 4.Attach this Aggregate View to the device with the following two subscriptions: a.Subscription1 for Bkt1=20 bytes b.Subscription2 for Bkt2=70 bytes Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1901Charging User Guide Rating and charging 8.22.2 Sending auto-charge notification - lifecycle Example for sending auto-charge notification when subscription is about to expire This scenario is performed to verify the notification parameter on REST API when the SendNotification action is configured on a subscription periodic lifecycle with bundle about to expire and auto-charge functionality enabled on device configurable custom data.
Configuration: 1.Create three custom data, namely ACNotifSetting , GroupID , and AutoChargePlan .
2.Create a periodic lifecycle with about to expire and with SendNotification action and rule with custom data attribute to enable the auto-charge feature and notification variables as shown in the following figure: 3.Create a bundle with periodic lifecycle.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1902Charging User Guide Rating and charging 4.The auto-charge notification can be either sent to a device or a group or both performing either of the following steps: •Create a device with the three custom data attributes that were created in the first step.
•Create a group with the three custom data attributes that were created in the first step.
•The following rule is used for sending the auto-charge notification for device and group in the same rule, where ACNotifiSetting , DeviceID , and AutoChargePlanName are the custom data on a group.
The SendNotification action is used on the custom parameters on as per the context type either device or group: The Custom-Data-Add , Custom-Data-Add-Immediate , Custom-Data-Update , Custom-Data- Remove , and Custom-Data-Remove-Immediate as shown in the following figure are also supported as custom parameters for a device or group: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1903Charging User Guide Rating and charging 5.Attach a bundle to the device or group to create a subscription.
Verification: 1.Verify whether auto-charge notification is sent with the notification variables when the subscription is about to expire.
NCC should send the auto-charge notification to the operator provisioning system using notification of http type configured in the Notification Server for notification template used for auto-charge feature.
2.Verify whether auto-charge notification is sent for REST notification.
8.23 Notifications for non-auto charge and connectivity criteria This feature provides information on notification for following cases: •Devices are barred or unbarred based on certain connectivity criteria.
•Volume Threshold (VT) notifications sent from threshold.
•Expiry Threshold (ET) notifications sent from lifecycle.
•AutoCharge (AC) custom data has the value disable.
This indicates that the group has not subscribed to the auto-charge feature.
•Provisioning interface make changes to the AV with Charging Service, AV with Charging Service and CAP, Bucket and Account.
This feature is applicable only to Absolute from Start (AFS) or Absolute from End (AFE) threshold and does not work for percentage thresholds.
That is, the provisioning gateway can trigger threshold actions only for AFS and AFE thresholds but not for percentage thresholds.
Bar and unbar notification The subsequent blocks provide information on the bar and unbar notification cases.
Bar notification Consider that a group has multiple devices associated and the group has not subscribed to the auto-charge feature.
In this case, when the group subscription is exhausted, then the Aggregate View (AV) unused value is zero.
NCC sends a notification to the operator provisioning system with well-defined parameters to take Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1904Charging User Guide Rating and charging further action such as bar all the devices of group.
The operator provisioning system triggers the PGW to bar all the devices of a group.
This is the bar notification case for volume threshold.
Similarly, when a device lifecycle moves to a state which is barred from an unbarred state, NCC sends a notification to the operator provisioning system with well-defined parameters to take further action such as bar a single device in the group.
The barred notification is sent when the device moves to the barred state.
This is the bar notification case (expiry threshold) linked to the device lifecycle state.
Unbar notification Consider that a group with exhausted subscription receives notification about the subscription status and refills its subscription due to which the AV unused value is increased to a non-zero value.
NCC sends a notification to the operator provisioning system with well-defined parameters to take further action if absolute from start threshold is defined such as unbar all the devices of a given group.
This is the unbar notification case for volume threshold.
Similarly, when a device lifecycle moves to unbarred state from barred state, NCC sends a notification with well-defined parameters to the operator provisioning system to take further action.
This is the unbar notification case (expiry threshold) linked to the device lifecycle state.
Following are the important points related to bar and unbar cases: •The notification variables are different for all the cases.
•It is assumed that the CCR-T is sent by PGW for all active sessions of devices are barred.
•It is assumed that the CCR-I is sent by PGW for all devices are unbarred.
•The barring and unbarring is done by the operator provisioning system.
NCC only sends notification to the operator provisioning system.
•A single notification is sent for each bar and unbar for group through threshold of AV with Charging Service, AV with Charging Service and CAP, bucket and account, that is sent to the operator provisioning system.
Notification variables for bar/unbar - Threshold The following table provides information on notification connectivity when sent from threshold.
Parameter Description AV Bucket Account Subscriber CD This variable can be sent with the value of custom data available on Group/ Device.
This custom data can be created and setCustom- Data ( Owner Device Id) on group/ device levelCustom- Data ( Owner Device Id) on group/ device levelCustom- Data ( Owner Device Id) on group level Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1905Charging User Guide Rating and charging Parameter Description AV Bucket Account by the operator provisioning system.
Share ID The Group Id/ Device Id of the AV/ bucket.SPR_ GROUP.
Group- Id/SPR_ DEVICE.
Device- IdSPR_ GROUP.
Group- Id/SPR_ DEVICE.
Device- IdSPR_ GROUP.
Group- Id/SPR_ DEVICE.
Device- Id Remaining data volumeThe current value.
In barred case, the value is 0, for unbarred case, the value is non- zero.THRESHOLD_ PROFILE.
AV-Current- Value THRESHOLD_ PROFILE.
AV-Unused- ValueTHRESHOLD_ PROFILE.
Bucket- Current- Value THRESHOLD_ PROFILE.
Bucket- Unused- ValueTHRESHOLD_ PROFILE.
Account- Current- Value THRESHOLD_ PROFILE.
Account- Unused- Value IMSI This is not sent by NCC.SPR_ DEVICE.
IMSI SPR_ DEVICE.
IMSI SPR_ DEVICE.
IMSI Line Status This is not sent by NCC.- - - Notification variables for bar/unbar - Lifecycle The following table provides information on notification connectivity when sent from lifecycle of device.
Parameter Description Example Subscriber CD The custom data Device ID attached to the first group fetched from device.
If Custom Data is not present in first group, the value of this variable is null.SPR_ GROUP.
Device ID Share ID The Group Id of the first group fetched from device.SPR_ GROUP- Group- Id IMSI This variable is set by NCC with the IMSI of a device.
Device must beSPR_ DEVICE.
IMSI Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1906Charging User Guide Rating and charging Parameter Description Example configured with IMSI as one of the identifier.
Line Status This variable can be filled with a static value.
NCC provides the Device lifecycle status ( old and new state) and validity time ( if available with that state) as a notification variable.
Example: Device lifecycle transitions from State A to State B, with action Send Notification action.
NCC sends State A and State B validity time and State A and State B name.LIFECYCLE.
From- State LIFECYCLE.
To-State LIFECYCLE.
Old- Validity- Time LIFECYCLE.
Next- Validity- Time Remaining data volume This variable is not sent by NCC.
- Example: Threshold actions of AFE 0 is triggered when a subscription is removed and AFS 0 is triggered when another subscription is added to group Here, AFE is Absolute from End and AFS is Absolute from Start.
Note that the threshold action associated with the percentage based thresholds are not triggered from provisioning gateway.
Prerequisite: 1.Create a threshold profile group TPG1 with TP1 value 0 AFS having the Send Notification action.
Create another threshold profile group TPG2 with TP2 value 0 AFE having Send Notification action.
AFS is shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1907Charging User Guide Rating and charging AFE is shown in the following figure: 2.Ensure that you have created group, subscription, and notification profile.
3.Create an AV of type volume having TPG1 and TPG2 and accumulating charging service attached to group G1.
4.The Group G1 has subscriptions such that sub1 has a bucket with value of 100 bytes.
Perform the following actions: 1.Remove the subscription sub1.
2.Add another subscription to group.
Following is the result of the actions performed: 1.The Send-notification actions of AFE 0 is triggered when the subscription sub1 is removed.
2.The Send-notification actions of AFS 0 is triggered when a subscription is added.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1908Charging User Guide Rating and charging Volume threshold notification variables The following notification variables for Volume threshold notification are supported for all type of AVs, counter, bucket, account related notifications.
These notification variables are applicable for threshold on group as well as device resources.
Attention : The notification variables listed in the subsequent tables are sample variables only and you can create custom variables based on your requirement.
For more variables, see Generic notification variables on page 1946 .
Parameter Description Applicable for resources Subscriber CD This variable is the custom data available on Group/ Device.
This custom data can be created and set by the operator provisioning system.
For notification through THR, it can also be filled, if needed, with the Device Id of that subscriber whose call has made the THR to reach.AV (all types) , Bucket, Counter, Account Share ID The Group Id/ Device Id.
AV (all types) , Bucket, Counter, Account Remaining data volume The current value.
Notification variables can be made available for both type of current value, that is, with and without reservation.AV (all types) , Bucket, Counter, Account Original data volume This variable is filled with a static value.
NCC provides notification variables which is sum of initial values of each resource being accumulated for AV.AV (all types) , Bucket, Counter, Account Threshold Type This variable is filled with a static value.AV (all types) , Bucket, Counter, Account Threshold This variable is filled with a static value.
NCC provides notificationAV (all types) , Bucket, Counter, Account Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1909Charging User Guide Rating and charging Parameter Description Applicable for resources variable for threshold value.
This is also applicable when the threshold is on individual bucket, counter, and account.
Expiry date of the line This variable is filled with a static value.AV (all types) , Bucket, Counter, Account Expiry date of the purchased data volumeThis variable is filled with a static value or it can be mapped to a custom data.AV (all types) , Bucket, Counter, Account Parameter Example Subscriber CD Custom- Data Share ID SPR_ GROUP.
Group- Id/SPR_ DEVICE.
Device- Id Remaining data volume THRESHOLD_ PROFILE.
AV-Current- Value THRESHOLD_ PROFILE.
AV-Unused- Value Original data volume THRESHOLD_ PROFILE.
AV-Initial- Value Threshold Type Custom- Data/ Static Threshold THRESHOLD_ PROFILE.
Threshold- Value ( " Threshold Name" ) Expiry date of the line Custom- Data/ Static Expiry date of the purchased data volume Custom- Data/ StaticTable 212: AV threshold notification variables Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1910Charging User Guide Rating and charging Parameter Example Subscriber CD Custom- Data Share ID SPR_ GROUP.
Group- Id/SPR_ DEVICE.
Device- Id Remaining data volume THRESHOLD_ PROFILE.
Account- Current- Value THRESHOLD_ PROFILE.
Account- Unused- Value Original data volume Custom- Data/ Static Threshold Type Custom- Data/ Static Threshold THRESHOLD_ PROFILE.
Threshold- Value ( " Threshold Name" ) Expiry date of the line Custom- Data/ Static Expiry date of the purchased data volume Custom- Data/ StaticTable 213: Account threshold notification variables Parameter Example Subscriber CD Custom- Data Share ID SPR_ GROUP.
Group- Id/SPR_ DEVICE.
Device- Id Remaining data volume THRESHOLD_ PROFILE.
Bucket- Current- Value THRESHOLD_ PROFILE.
Bucket- Unused- Value Original data volume THRESHOLD_ PROFILE.
Bucket- Initial- Value Threshold Type Custom- Data/ StaticTable 214: Bucket threshold notification variables Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1911Charging User Guide Rating and charging Parameter Example Threshold THRESHOLD_ PROFILE.
Threshold- Value ( " Threshold Name" ) Expiry date of the line Custom- Data/ Static Expiry date of the purchased data volume Custom- Data/ StaticTable 214: Bucket threshold notification variables (continued) Parameter Example Subscriber CD Custom- Data Share ID SPR_ GROUP.
Group- Id/SPR_ DEVICE.
Device- Id Remaining data volume THRESHOLD_ PROFILE.
Counter- Current- Value Original data volume Custom- Data/ Static/ 0 Threshold Type Custom- Data/ Static Threshold THRESHOLD_ PROFILE.
Threshold- Value ( " Threshold Name" ) Expiry date of the line Custom- Data/ Static Expiry date of the purchased data volume Custom- Data/ StaticTable 215: Counter threshold notification variables Example: VT notification for bucket with normal and CO instances Auto-charge feature is turned off on group.
Create the group and subscribe the bundle.
Create device and add it to the group.
Create the custom data - ExpiryDataLine and ExpiryDataPurchasedDataVolume for the group.
Create the account, threshold, Charging Service, and Bundle.
In the bundle, define a bucket with volume data of 300 byte.
In the threshold profile, define AFS Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1912Charging User Guide Rating and charging = 20.
The VT notifications are sent based on the variables defined in the threshold profile as shown in the following figure.
Subscription expiry notification variables The notification variables in the following table are applicable for the variables being created in the lifecycle of subscription from group as well as device.
The SPR_GROUP and SPR_DEVICE source context are available in the lifecycle for Send-Notification action only.
These source context are provided in rules in lifecycle which means the custom data and other attributes of Group and Device can be used in rules as notification variables.
If the subscription is attached to group, then SPR_GROUP context is available in the rule of lifecycle for the Send-Notification action.
Similarly, when a subscription is attached to the device, SPR_DEVICE source context is available in the rule of lifecycle for the Send-Notification action Notification variables for date of entity and periodic lifecycle of subscription are available.
That is, for the subscription, the validity date is in entity lifecycle and end date in periodic lifecycle are available which can be used in rules with notification variables.
When a notification is sent to end user using lifecycle, then the validity of their subscription can be informed.
Attention : The notification variables listed in the subsequent table are sample variables only and you can create custom variables based on your requirement.
For more variables, see Generic notification variables on page 1946 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1913Charging User Guide Rating and charging Parameter Description Behavior for Group subscriptionBehavior for Device subscription Subscriber CD This variable can be sent with the value of custom data available on Group.
This custom data can be created and set by the operator provisioning system.SPR_ GROUP.
Device- Id Custom DataSPR_ DEVICE.
Group- Id Custom Data Share ID The Group Id of the subscription.SPR_ GROUP.
Group- Id SPR_ DEVICE.
Device- Id Remaining data volume This variable is not sent by NCC.
It can be set to Null in notification template in NS or can be sent as a static value by charging or can be sent from any of the custom data at group.Static/ NULL Static/ NULL Original data volume This variable is filled with a static value.Static value Static value Threshold Type This variable is filled with a static value.Static data Static data Threshold This variable is filled with a static value.Static Static Expiry date of the line This variable is filled with a static value.Static data Static data Expiry date of the purchased data volumeThis is set to the expiry date of the group subscription.
The end time of entity and periodic lifecycle of subscription, subscription creation time,For entity lifecycle: •SUBSCRIPTION.
Creation- Time •LIFECYCLE.
Old- Validity- TimeFor entity lifecycle: •SUBSCRIPTION.
Creation- Time •LIFECYCLE.
Old- Validity- Time Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1914Charging User Guide Rating and charging Parameter Description Behavior for Group subscriptionBehavior for Device subscription can be made available as notification variable.•LIFECYCLE.
Next- Validity Time For periodic lifecycle: •SUBSCRIPTION.
Creation- Time •SUBSCRIPTION.
Start- Time •SUBSCRIPTION.
End- Time •LIFECYCLE.
Old- Validity- Time•LIFECYCLE.
Next- Validity Time For periodic lifecycle: •SUBSCRIPTION.
Creation- Time •SUBSCRIPTION.
Start- Time •SUBSCRIPTION.
End- Time •LIFECYCLE.
Old- Validity- Time Example 1: Entity Lifecycle for Subscription expiry notification This example is designed to send notification using the Send Notification action.
Send Notification Action 1 sends Validity Time of Active state, that is, 28 days timestamp as well as subscription creation time (see Entity lifecycle - preactive state on page 1916 ).
Send Notification Action 2 sends Validity Time of Active State (28 days) as well as Validity Time of Inactive state, that is, 2 days.
Following is the generic transition from StateA to StateB with Send Notification action.
Transition - From: StateA To State: StateB Action: Send Notification Action The following parameters are used for ExpiryDataPurchasedDataVolume variable: •StateA Validity Time •StateB Validity Time •Subscription Creation Time The subscription entity lifecycle has the preactive (Initial state), active, inactive, deactive (Barred) states.
Following is the configuration made for the group subscription entity lifecycle: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1915Charging User Guide Rating and charging Figure 102: Entity lifecycle The preactive state has the following event.
Figure 103: Entity lifecycle - preactive state Following is the event in active state.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1916Charging User Guide Rating and charging Figure 104: Entity lifecycle - active state Following is the event in inactive state.
Figure 105: Entity lifecycle - inactive state Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1917Charging User Guide Rating and charging Following is the event in deactive state.
Figure 106: Entity lifecycle - deactive state Example 2: Periodic Lifecycle for Subscription expiry notification This example is designed to send notification using the Send Notification action.
Send Notification Action 1, Send Notification Action 2, Send Notification Action 3 sends Subscription Start Time, Subscription End Time, and Subscription Entity Lifecycle current state Validity Time.
For periodic lifecycle, the following parameters are used for ExpiryDataPurchasedDataVolume variable: •Subscription Start Time •Subscription End Time •Subscription Entity LifeCycle current state Validity Time Following is the configuration made for the group subscription periodic lifecycle: Figure 107: Periodic lifecycle The preactive state transitions are as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1918Charging User Guide Rating and charging Figure 108: Periodic lifecycle - preactive state The notification event along with the rule defined in the active state is as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1919Charging User Guide Rating and charging Figure 109: Periodic lifecycle - active state The notify state is as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1920Charging User Guide Rating and charging Figure 110: Periodic lifecycle - notify state The deactive state is as follows: Figure 111: Periodic lifecycle - deactive state Notifications through northbound interface NCC triggers notification when the northbound provisioning interface makes either of the following changes: •AV with charging service •AV with charging service and cap, bucket, and account If a defined threshold is crossed when an AV is updated using the provisioning interface, then the notification action on the threshold of AV are executed.
The threshold at zero is optional.
However, if any threshold value is crossed and required configurations are done for that threshold, then NCC sends the configured notification action.
Note : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1921Charging User Guide Rating and charging Only the Send-Notification action is considered and the remaining actions, if defined, are considered when the next CCR request is received.
The notification action is considered when the update is made to the threshold of AV.
The threshold execution of threshold profile type ABSOLUTE_FROM_ZERO for account can be used at the time of provisioning.
During provisioning, the ABSOLUTE_FROM_ZERO profile is considered irrespective of whether the account balance is increased or decreased.
Only the send notification action of the threshold crossed is supported during provisioning.
The notification to end user is sent if the following conditions are met: •The available balance becomes equal to the threshold value.
•The notification action is Send-Notification .
The following context variables can be used: Context variable Description THRESHOLD.
Threshold- Trigger- Type This variable can be configured in result action, when you want to execute the actions during only provisioning or only Diameter call.
If this action is not defined, then THRESHOLD_ TRIGGER_ TYPE is treated for both Diameter call and provisioning and the notification is sent.
THRESHOLD_ PROFILE.
Is-Balance- Increased This variable can be used in a condition.
During provisioning, there can be following scenarios: •Increase balance using set/ adjust API.
For this scenario, the value of flag must be true.
•Decrease balance using set/ adjust API.
For this scenario, the value of flag must be false.
THRESHOLD_ PROFILE.
Is-Diameter- Call This variable can be used in a condition.
If the rule is executed on a call, its value is true and for provisioning its value is false.
Following are some points related to notification through north bound interface: •Whenever AV/bucket is filled, then the Absolute From Start (ABS) Thresholds get triggered and whenever AV/bucket is being decremented, the Absolute From End gets executed.
During provisioning, the behavior of ABS is different when compared to the Diameter call since during provisioning, ABS is triggered when AV/bucket is being filled whereas in Diameter call, the ABS is being triggered based on consumption from AV/bucket.
•Reservation is not restricted even after sending bar notification through threshold.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1922Charging User Guide Rating and charging •Lifecycle AV/bucket update is treated as provisioning request.
•For receiving bar/unbar notification, the required configuration is done on either all thresholds or chosen thresholds.
•Whenever AV/Bucket is incremented or decremented, then ABS and ABE executes respectively and only Send Notification action is triggered.
Rest of the actions are handled in upcoming Diameter call and same Send Notification action is not executed in upcoming Diameter call.
•Only the device or group custom data attribute can be taken to handle the Device/Group Bar/Unbar notification.
•The Threshold-Trigger-Type is used for configuration in threshold rules to differentiate between provisioning and Diameter call.
The supported values are PROVISION or DIAMETER.
•The Threshold_Profile.Is-Diameter-Call variable can be used in threshold to handle online or offline notification as well as handling of remaining actions of threshold in a Diameter call.
•If multiple actions are being configured on a single Threshold with one of the Action as Send Notification Action , then Send Notification Action gets triggered from provisioning.
And out of remaining actions, if any action has higher priority than Send Notification Action , then that action is executed during upcoming Diameter call.
But if none of the action out of remaining actions has higher priority than Send Notification Action , then no Action gets executed during upcoming Diameter call.
Priority of Threshold Actions - Reject>Notification-Reject>Notification-Stop>Send-Notification>Notification- Continue>Send-RAR •Only Send Notification action of threshold is triggered through provisioning.
•If the Send Notification has been triggered through provisioning for AFS, and same threshold is being crossed during upcoming Diameter call, then send notification action is not suppressed in Diameter call.
This is because, the AFS has different behavior for call and provisioning, whereas this notification is suppressed in case of AFE.
•If AV is created during runtime, then rules or thresholds do not get evaluated since rules or thresholds are evaluated only during update •A custom data attribute, for example, SPR_GROUP.IsBar , a sample shown in Example: Threshold actions of AFE 0 is triggered when a subscription is removed and AFS 0 is triggered when another subscription is added to group on page 1907 , can be taken to handle Device/Group Bar/Unbar notification.
•Triggering threshold through provisioning interface is applicable only for Thresholds and not CAP.
Examples: Example 1 AV initial value = 0 AV current value = 0 AV unused value = 0 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1923Charging User Guide Rating and charging TPG1 - Absolute from start T1 = 100, T2 = 200, T3 = 300, T4 = 400 A subscription is added, initial = current = unused = 90.
AV initial = current = unused = 90.
As the AV unused value has incremented, the threshold from list of Absolute from start thresholds is T1 = 100.
As no threshold is reached, so the Send Notification action is not triggered.
Therefore, as per the configuration, if no threshold is crossed then notification is not sent.
Example 2 AV initial value = 100 AV current value = 50 AV unused value = 50 TPG1 - Absolute from end T1 = 0, T2 = 10, T3 = 20, T4 = 30 Remove the subscription, initial = 50, current = 50, unused = 50.
AV initial = 50, current = 0, unused =0.
Since the AV unused value has decremented, only Absolute from end thresholds are considered.
It depends completely on provisioning that on which threshold of Absolute from end, you want to send bar notification.
The rule gets called on AV unused value.
If the rule to send bar notification action is configured on threshold T1, then rule is as follows: if SPR_GROUP.custom_data.Barred = false and THRESHOLD_PROFILE.Is-Diameter-Call = false then THRESHOLD.Threshold-Trigger-Type = ThresholdTriggerType_PROVISION // attribute set in result context, Actions will be triggered only if rules are evaluated using Provisioning interface / North bound and Then send barred notification and SPR_GROUP.custom_data.Barred = true else SPR_GROUP.custom_data.Barred = false and THRESHOLD_PROFILE.Is-Diameter-Call = true Then send barred notification and SPR_GROUP.custom_data.Barred = true Therefore, the bar notification is sent on threshold value 0 of Absolute from end.
Example 3: Notification sent using threshold on account when an account balance is updated through Diameter or provisioning call Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1924Charging User Guide Rating and charging Consider the following values: Account Initial Balance = 50 units TPG: Absolute from Zero TH1 = 10, TH2 = 40 Provisioning case: Consider that the account is provisioned by setting the account balance to 30 units.
When the balance is decreased from 50 to 30 units, the threshold rule is evaluated with account available balance and the threshold action of TH2 is executed.
To send the notification for balance decreased by provisioning, the following rules must be configured for TH1 and TH2.
Note that you can configure the ABSOLUTE_FROM_ZERO profile only for Kind of Unit = Money .
Here, the else condition, that is, Is-Diameter-Call = False gets executed.
The notification is sent to the end user and the action reject is not executed at the provisioning time.
Diameter call case: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1925Charging User Guide Rating and charging Consider the following values: Account Initial Balance = 50 units TPG: Absolute from Zero TH1 = 10, TH2 = 40 Assume that the balance gets reduced to 15 units.
The threshold rule is evaluated with the account available balance and the remaining threshold action of TH2 is executed.
Here, the remaining else condition is executed.
In this case, the notification is not sent.
This is because, the notification has already been sent during provisioning and only the remaining actions , that is, Reject gets executed.
8.24 Group notifications Notifications can be sent to group resources for the following cases: •Notification from lifecycle of the group : In this case, the lifecycle module includes Group ID in the notification request sent to NS.
•Notification from lifecycle of subscription attached to the group : In this case, the lifecycle module includes Group ID in the notification request sent to NS.
•Notification from the threshold attached to the group resources such as bucket, counter, and AV : In this case, the threshold rule includes the Group ID in the notification request sent to NS.
Within the rule, you can define the variable Notification-Destination to select either Device or Group such as THRESHOLD.Notification-Destination = NotificationDestinationType_DEVICE for notification.
In case of deviceGroupCounter, notifications are pushed to device or group depending on Notification-Destination.
If nothing is mentioned, the notification is sent to device.
If a rule with Notification-Destination is not specified, then a notification is triggered as follows: •For group counter, notification is sent to group.
•For device counter, notification is sent to device •For device-group counter, notification is sent based on the Notification-Destination defined.
•For device or group subscription counter, notification is sent based on the type of subscription (group or device).
•For AV, notification is sent based on the type of subscription (group or device).
•For group or device subscription bucket, notification is sent based on the type of subscription (group or device).
Configuring group notification Following are the methods to activate the group notification feature: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1926Charging User Guide Rating and charging •Configure the Notification-Destination in rules.
•Configure the subscription resource and attach it to a group for notifications.
Threshold reached attached with AV accumulates the subscription of group.
Threshold reached attached with counter accumulates the subscription of group.
Threshold reached attached with bucket accumulates the subscription of group.
Assumptions Following assumptions apply to the group notification feature: •The recipient of the group notification is decided by the Group Notification profile (available under Notification Management → Notification Preferences → ≡ → Group Notification Profiles ).
For NCC, only All Members and Group Admin , All Members except Group Admin , Group Admin , and None can be used.
See the following table for descriptions.
Value Description Group Selected Members The notifications are sent to selected members specified in the incoming request.
Group Admin The notifications are sent to only the group admin.
Group Admin and Selected Members The notifications are sent to the group admin and selected members specified in the incoming request.
All Members and Group Admin The notifications are sent to all group members including the group admin.
All Members except Group Admin The notifications are sent to all group members in the group except for the group admin.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1927Charging User Guide Rating and charging Value Description None No notification is sent.
•There is no dynamic parameter except Group Id.
•For group notification, the lifecycle EDR contains the tag recipient id with the value of first retrieved group administrator.
Group lifecycle notification The Send Notification action is enhanced to send notifications to group.
The groupId template parameter is added for group notification and can be used in the notification template.
For example, create a new group lifecycle.
Add the Send Notification Action for event Activate and provide the Notification Template Id .
Create a new group with the entity lifecycle created.
Whenever the configured event occurs on a group, the notification action is triggered for the group.
Group subscription notification The subscription type (TypeOfSubscription) checks and send notifications for group if the subscription type is Group.
For example, create a new subscription entity lifecycle.
Add the Send Notification Action for events Subscription Renewed Event , Activate , Deactivate and provide the Notification Template Id in the lifecycle entity.
Create a charging service and associate it to a new bundle.
Associate the entity lifecycle with the bundle created as shown in the following figure.
Associate this bundle to the group.
Whenever a configured event such as Subscription Renewed Event occurs on the group subscription, then notification action gets triggered for the group.
Attach the EnterpriseGroupLifeCycle and Bundle123 to the group entity (as shown in the following example).
Lifecycle creation: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1928Charging User Guide Rating and charging Ensure that you have created a charging service before creating the bundle.
Bundle creation: Ensure that you have created an account to associate with the bundle.
Group creation: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1929Charging User Guide Rating and charging Group threshold notification The subscription type (TypeOfSubscription) checks if the subscription type and Notification-Destination is Group.
Then notification is sent to the Group Admins or All Members.
A sample is shown in the following figure where a notification is from the threshold attached to group resources such as allowance limit (bucket), counters: Examples Example 1: Notification sent to admin when notification profile is set to GROUP ADMIN A notification is sent to group when the group subscription bucket usage is reached as per threshold defined.
The group notification profile is set to GROUP ADMIN .
Configure the following entities for this example: Entity Task Notification server Configure the Email and SMS servers.
Notification template Create a template with Name : Usage_ Notification_ Data , Notification Priority : Normal and the details as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1930Charging User Guide Rating and charging Entity Task Notification preferences Create a group notification profile.
See the figure after the table for details.
Thresholds Create the threshold profile group ( TPG1) .
See the figure after the table for details.
Counter Create a counter with Unit Type : Byte , Counter Type : Usage , Counter Consumption Type : All, Counter Scope : All, Threshold Profile Group ID List : TPG1 Charging Services Create bucket and tariff for non- monetary bucket.
Bundles Create a bundle with fee = 0 and associate the charging service created.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1931Charging User Guide Rating and charging Entity Task Account Create an account.
User Create a user.
Group Create the group with subscription ( bundle created) and select the Notification profile created for group.
Device Create the device with subscription ( bundle created) and link the user and group.
Notification preferences (Group notification profile): Thresholds (TPG1): Example 2: Notification from lifecycle linked to group subscription Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1932Charging User Guide Rating and charging A notification is sent to the users of the group when a subscription lifecycle is attached to the group.
The group notification profile is set to ALL MEMBERS .
Configure the following entities for this example: Entity Task Notification server Configure the Email server.
Notification template Create a template with Name : Recharge_ Template , Notification Priority : Normal and the details as shown in the following figure: Notification preferences Create a group notification profile with Name : Notification Profile1 , Type : Group Profile , Receiver : All Members , Channels : EMAIL , Notification Type : Usage , Local : True, Languages : ENGLISH Lifecycles Create the Enterprise Group subscription lifecycle with Name : Enterprise Group Lifecycle1 , Type : Object Status Lifecycle , Applicable to : Subscription , States : Active , Disconnected , Inactive .
See the lifecycle state figures after the table.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1933Charging User Guide Rating and charging Entity Task Counter Create counters - Device counter ( C1), Device Group counter ( C2) with Unit Type : MByte , Counter Type : Usage , Counter Scope : Self, Counter Consumption Type : All.
Charging Services Create two charging services - CS1 and CS2.
Bundles Create two bundles : Bundle1 with fee = 25 and Bundle 2 with fee = 30 accordingly and associate the charging services ( CS1 for Bundle1) ( CS2 for Bundle2) created.
Account Create an account.
User Create a user.
Group Create the group with subscription ( bundle created) and select the Enterprise Group Lifecycle1 created.
Device Create the device with subscription ( bundle1 created) and link the user and group.
Using the Add Counter option ( that displays once you mouse over the created record) , add the C1 device counter to Device and C2 device group counter to group.
Lifecycles (EnterpriseGroupLifecycle1): Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1934Charging User Guide Rating and charging 8.25 Resource-based notifications NCC allows operators to send notifications based on resource usage.
The Send-Notification action is supported for resource based counters.
BUCKET source context The following BUCKET source context can be used to select the algorithm to be used for the call.
Attribute name Description Bucket- Current- Charging- Step The current step if it is a step charge bucket.
Bucket- Name The name of the bucket which is being used while rating a call.
Bucket- Unit- Type The unit type of bucket such as TIME, MONEY, VOLUME, UNIT.
Bundle- Name The name of the bundle which is being used while rating a call.
Regular- Current- ValueThe regular bucket current value before reservation.
It is of type Big decimal.
The rules does not support operations between Big decimal and other types such as integer, long.Table 216: BUCKET source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1935Charging User Guide Rating and charging Attribute name Description Equal operation is not supported between Big decimal types.
Only > , <.
> =, <= are supported.
The following rules can result in failure: Rule 1: DYNAMIC_SLICE.Slice-Size = Bucket.Regular- Current-Value Here, slice size is of type Long.
Rule 2 : if Bucket.Regular-Current-Value = 1000 Total- Current- ValueThe sum of regular bucket current value and it' s carryover current value before reservation.
It is of type Big decimal.
The rules does not support operations between Big decimal and other types such as integer, long.
Equal operation is not supported between Big decimal types.
Only > , <.
> =, <= are supported.
The following rules can result in failure: Rule 1: DYNAMIC_SLICE.Slice-Size = Bucket.Total- Current-Value Here, slice size is of type Long.
Rule 2 : if Bucket.Total-Current-Value = 1000Table 216: BUCKET source context (continued) Additional information •If a bundle is added or removed, then the configuration of sending RAR must be done by operators.
•The carryover buckets are excluded from the BUCKET source context.
The rules applicable to normal bucket are applicable to carryover buckets as well.
Examples Example 1: Toggle speed based on data in XML notification Consider that a group has a device attached to it.
Group has subscribed to unlimited bundles which can be used by devices linked to it.
Device has its own bundle.
Operators can toggle the QoS based on data received in notification.
Once the device bundle is used up completely and there are no more resources available for the call, then unlimited bundles are used for the call.
In this case, operators can throttle the speed to LOW.
If another bundle becomes active (either by subscription renewal or a new subscription), the speed is set to HIGH.
The toggling of speed can be maintained in a custom data of device or can be managed using rules.
Once a notification is sent, custom data of device is updated.
The bundle usage can be tracked using the resource based counters.
Operators can select different slicing algorithm based on Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1936Charging User Guide Rating and charging the bucket used for the call.
That is, select dynamic algorithm for normal buckets and static algorithm for step-buckets.
Configure the following entities: 1.Create a custom data for Device IMSI-Throttling with HIGH as default value.
Attach this custom data to the Device.
2.Create charging services ( CS1 and CS2) for unlimited bundles to be used for the complex map.
3.Create a complex map ( CS-Reserve ) to be used in threshold rules.
4.Create a resource based counter and attach it to the Device.
Ensure to select Resource Based when you create a counter.
Note that, based on your requirement you can attach the resource based counter to a Device or Group.
5.Create a Notification Profile that contains the notification text to be sent.
In the current case, you can configure the notification content as follows: Device-ID=$[DEVICEID],GROUP-ID=$[GROUPID],IMSI=$[IMSI],E164= $[MSISDN],Throttling-Status=$[IMSI_Throttling_Status] 6.Configure a rule in Threshold to send notification for HIGH or LOW speed as follows: 7.Configure the quota management profile (slicing profile) as follows to select dynamic or static algorithm based on whether normal or step-bucket is used for the call.
For carryover bucket, rules applied for normal bucket are applicable.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1937Charging User Guide Rating and charging Example 2: Multiple scenarios Consider that a device is configured with a custom data and has the following subscriptions: •Unlimited Bundle B1 BOU with two charging services, having a bucket in CS1 in pass 0 and a free rate in CS2 in pass 1.
•Bundle B2 non-BOU having buckets in pass 0.
•Default bundle B3 non-BOU having step-bucket in pass 1.
The initial quota management profile (slicing profile) algorithm configuration is Dynamic slicing algorithm.
Scenario 1: The unlimited Bundle B1 BOU with bucket available is applicable and active.
The custom data of device is initially set to false, indicating that speed is HIGH.
Subscriber consumes from Bundle B1 and custom data is not changed and throttling notification is not sent.
Scenario 2: The unlimited Bundle B1 BOU with no buckets available and not applicable.
Subscriber consumes from Bundle B2, so custom data is not changed and throttling notification is not sent.
Scenario 3: The unlimited Bundle B1 BOU with no bucket available is applicable and active.
There is no other resource available.
The custom data of Device is initially set to false, indicating that speed is HIGH .
Subscriber consumes from Bundle B1 as free rate form pass 1.
The custom data is changed to True and throttling notification is sent.
If a subscriber reports another consumption from B1, then the custom data is not changed as its already True and notification is not sent.
Scenario 4: The unlimited Bundle B1 is not applicable and there is no other resource available in pass 0.
The custom data of device is True.
On consumption, default bundle B3 is used and the value of custom data is changed to false and throttling notification is sent.
Since B3 is configured with step-bucket, static algorithm is used instead of dynamic algorithm.
Scenario 5: The unlimited Bundle B1 BOU with no bucket available is applicable but expires.
There is no other resource available.
The custom data of device is True.
On consumption, the default bundle B3 is used and the value of custom data is changed to false and throttling notification is sent.
Since B3 is configured with step-bucket, static algorithm is used instead of dynamic algorithm.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1938Charging User Guide Rating and charging 8.26 Notification when bundle expires but buckets are available Notifications can be sent when a subscription expires (end date or validation date expires) and the buckets of that bundle subscription have not been completely consumed.
For example, consider that a subscription has 5 buckets, 4 are empty and 1 is non-empty.
When the subscription expires or renews, a notification can be sent to subscriber to indicate that the subscription is not empty.
This functionality is supported for Subscription lifecycle only.
If the following rules are configured on an Account lifecycle, then they are always evaluated to False .
The following functions provides capability to get the current balance of the buckets including and excluding the carry over balance for the subscription before and after renewal.
Has-Previous-Non-Empty-Buckets : This function is used in lifecycle rule and returns true if the subscription contains at least one bucket of its charging services that is not fully consumed before renewal or expiration.
Example: Has-Non-Empty-Buckets : This function is used in lifecycle rule and returns true if the subscription contains at least one bucket of its charging services that is not fully consumed after renewal or starting cycle.
Example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1939Charging User Guide Rating and charging Get-Previous-Bucket-Total-Value-By-Name : This function returns the balance value of the bucket based on its passed name.
It returns the balance including the carry over balance before the subscription is renewed or expired.
Example: Get-Bucket-Total-Value-By-Name : This function returns the balance value of the bucket based on its passed name.
It returns the balance including the carry over balance.
Example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1940Charging User Guide Rating and charging Get-Previous-Bucket-Value-By-Name : This function returns the regular bucket balance based on passed bucket name without carry over balance.
Example: Get-Bucket-Value-By-Name : This function returns the regular bucket balance based on passed bucket name without carry over balance.
Example: Get-Previous-Bucket-Total-Value-By-Type : This function returns the balance value of the bucket based on its passed type (KindOfUnit).
It returns the balance including the carry over balance before renewal or expiration.
Following are the available bucket types (KindOfUnit): •TIME •VOLUME •UNIT •MONEY Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1941Charging User Guide Rating and charging Example: Get-Bucket-Total-Value-By-Type : This function returns the balance value of the bucket based on its passed type.
It returns the balance including the carry over balance.
Example: Get-Previous-Bucket-Value-By-Type : This function returns the regular bucket balance based on passed KindOfUnit without carry over balance for previous subscription.
Example: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1942Charging User Guide Rating and charging Get-Bucket-Value-By-Type : This function returns the regular bucket balance based on passed bucket type without carry over balance.
Example: Following are some of the sample scenarios listed to understand when notifications can be sent: •00:00 time and BOU bundle expires today but any of the bucket is not zero, notification is sent in this case.
•00:00 time and BOU bundle expires today and all the buckets are consumed, notification is not sent in this case.
•02:25 time and Bundle renews today and all the buckets are consumed, notification is not sent in this case.
•00:00 time and Bundle renews today, and any of the bucket is not zero and is >= certain value, notification is sent in this case.
•At time of Bundle renewal, bucket 1 of type money is empty and bucket 2 of type volume is non empty, the notification is sent.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1943Charging User Guide Rating and charging Reading data from Subscription, Device, and Group NCC allows operators to get the required data per request and send them to notification template.
Following are the values that can be read: •MSISDN (E164) •IMSI •Group-Id •Device-Id •Bundle-Id •Custom data from Device and Group (for example, Mother Name) Example: 8.27 Notification for call rejection due to hard-stop Notification can be sent to a subscriber when the call cannot be established due to the entityCounter usage limit value with Reject action.
Following are the possible scenarios: •New call cannot be established •Ongoing call cannot reserve new quota Such notifications can be sent based on the configurations made, such as: •Configured times per period (configured once, times, or always per period) for each entityCounter: This can be applicable for all call types such as IMS/SMS/MMS/PS.
•Configured daily for each entityCounter: This can be applicable for one notification per day for PS call.
•Existing NCC behavior.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1944Charging User Guide Rating and charging Following is the rule example: 8.28 Skip notification using rule action The Notification Template ID field in Send Notification action of LifeCycle is mandatory and the default notification is sent even if the conditions do not apply.
NCC allows operators to change this behavior by skipping the notification using a rule action.
To ignore the notification in the LifeCycle Send Notification action, the action SYSTEM.Do-Nothing can be used.
Assumptions It is recommended that the SYSTEM.Do-Nothing action must not be configured with any other rule action in if or else statement.
Even if configured, then only the SYSTEM.Do-Nothing is executed and other actions are ignored.
Examples Example 1: Only SYSTEM.Do-Nothing is configured in the rule, no notification sent Following is the rule in LifeCycle: Actions: Send Notification Action Notification Template Id: testTemplate Rules: LifeCycleRule1 SYSTEM.Do-Nothing Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1945Charging User Guide Rating and charging Example 2: SYSTEM.Do-Nothing is configured in if part of rule table and rule is passed, no notification sent Following is the rule in LifeCycle: Actions: Send Notification Action Notification Template Id: testTemplate Rules: LifeCycleRule1 if SUBSCRIPTION.Get-Previous-Bucket-Total-Value-By-Type then SYSTEM.Do-Nothing Example 3: SYSTEM.Do-Nothing is configured in the else part of rule, if condition is passed, notification is sent Following is the rule in LifeCycle: Actions: Send Notification Action Notification Template Id: testTemplate Rules: LifeCycleRule1 if SUBSCRIPTION.Get-Previous-Bucket-Total-Value-By-Type (KindOfUnit_VOLUME)>500 then NOTIFICATION.Send-Notification("temp123", NotificationPolicy_ALWAYS_SEND) and NOTIFICATION.Notification-Variable("BundleId",SUBSCRIPTION.Bundle-Id, "temp123") and NOTIFICATION.Notification-Variable("IMSI",SPR_DEVICE.IMSI,"temp123") and NOTIFICATION.Notification-Variable("E164",SPR_DEVICE.E164,"temp123")and NOTIFICATION.Notification-Variable("Device-Id",SPR_DEVICE.Device-Id,"temp123") else LifeCycleRule1 SYSTEM.Do-Nothing Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1946Charging User Guide Rating and charging 8.29 Generic notification variables This section describes the threshold and lifecycle related notification variables configured under the VariableValue attribute of the Notification-Variable action of a rule.
For each variable pair ( VariableName and VariableValue ), a dedicated Notification-Variable action must be configured.
Once the notification variables are configured for a bucket or counter entity and threshold is reached, a notification message is sent to the Notification Server along with these variables.
These variables are defined within the text field of a given notification template on the Notification Server and they are replaced during the runtime with the dynamic values of these variables before sending the notification text to the users over SMS or emails as defined in the notification profile of a device.
Note : For more details on configuring a notification template, see the NOKIA Converged Charging Notification Service (NS) User Guide of the related release.
Threshold notification variables Notifications are sent to users when a threshold level is reached or exceeded.
The Notification Server supports the dynamic variable parts, which can be combined with the static text defined in the notification template within the Notification Server.
The service operators configure the dynamic variable notification in the threshold levels applied to any resource.
The custom data from a device or group is also available as notification variable.
Attention : The SM GUI displays more variables but currently, only the following listed variables are supported.
Attribute Source Context Applicable for resources Description Account- Def- Name THRESHOLD_ PROFILE Account Displays the account ID for which the threshold value is defined which further triggers a notification.
Account- Current- Value THRESHOLD_ PROFILE Account Displays the account value with reservation ( current value of the account) .
Account- End- Date THRESHOLD_ PROFILE Account Displays the end date of periodic lifecycle attached with account.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1947Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description Account- Entity- End- Date THRESHOLD_ PROFILE Account Displays the end date of entity lifecycle attached with account.
Account- Unused- Value THRESHOLD_ PROFILE Account Displays the unused account value or the current account value without reservation.
Action- Type THRESHOLD_ PROFILE Account, AV, Bucket, CounterDisplays the actions configured for the threshold.
Only some specific actions are considered for this parameter, such as: •Notification- Continue •Notification- Stop •Notification- Reject •Reject •Send- Notification •Send- RAR •Send- SNR Note : If multiple actions are configured, then the concatenated value of all actions separated by comma ( ,) is given.
AV-Initial- Value THRESHOLD_ PROFILE AV - All types Displays the AV initial value.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1948Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description AV-Current- Value THRESHOLD_ PROFILE AV - All types Displays the AV value with reservation ( current value of the AV) .
AV-Unused- Value THRESHOLD_ PROFILE AV - All types Displays the AV value without reservation ( unused value of AV) .
AV-Def- Name THRESHOLD_ PROFILE AV Displays the aggregate view name.
Account- Id SUBSCRIPTION Account Displays the account ID of the subscription used in the call, which can also be mapped to a custom data defined in the device.
Bucket- Current- Value THRESHOLD_ PROFILE Bucket Displays the current value of bucket with reservation.
Note : The maximum value allowed for bucket initial/ current is 922337203685477600.
Bucket- Def- Name THRESHOLD_ PROFILE Bucket Displays the bucket ID for which the threshold value is defined that triggers a notification.
Bucket- Or-Counter- Def- NameTHRESHOLD_ PROFILE Bucket, Counter Displays the ID of a bucket or counter for which the notification has to be sent.
Bucket- End- Value THRESHOLD_ PROFILE Bucket Displays the initial minus current, which refers to the bucket value that has been used till date.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1949Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description If a threshold has not been reached, then there is no notification with notification variables.
Note : This variable value is automatically generated by NCC and not specified by the service operator.
Bucket- End- Date THRESHOLD_ PROFILE Bucket Displays the Bucket Expiration Time received from the subscription of that bucket.
Bucket- Balance- Value THRESHOLD_ PROFILE Bucket Displays the remaining value of the bucket after committing the used quantities reported in USU, which refers to ( Initial bucket value) - committed ( USU in SCUR- U/T).
Bucket- Initial- Value THRESHOLD_ PROFILE Bucket Displays the initial bucket value.
Bucket- Or-Counter- Current- ValueTHRESHOLD_ PROFILE Bucket, Counter Displays the bucket or counter current value whatever is available.
Bucket- Unused- Value THRESHOLD_ PROFILE Bucket Displays the unused bucket value or the current value of bucket without reservation.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1950Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description Bucket- Current- Step THRESHOLD_ PROFILE Bucket Displays the current step of a step bucket, which is null for a normal bucket.
Bucket- Step Up-Time THRESHOLD_ PROFILE Bucket Displays the last step up time of step bucket, which is null for a normal bucket.
Bucket- Step Up-Value THRESHOLD_ PROFILE Bucket Displays the cumulative value of top- up done at a particular time in a slice, which is null for a normal bucket.
Bundle- Id SUBSCRIPTION Subscription Displays the bundle ID of the subscription.
Bundle- Name- Reserve THRESHOLD_ PROFILE Counter Displays the bundle name that contains the charging service, which has contributed more in reservation when a threshold is attached with the counter.
Bundle- Reserve- Type THRESHOLD_ PROFILE Counter Displays the device or group name containing the bundle, which has contributed more in reservation when the Threshold is attached with counter.
Carry- Over- Bucket- Current- ValueTHRESHOLD_ PROFILE Bucket Displays the carry over current value of bucket with reservation.
Carry- Over- Bucket- End- DateTHRESHOLD_ PROFILE Bucket Displays the carry over Bucket Expiration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1951Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description Time that comes from subscription of that bucket.
Charging- Service THRESHOLD_ PROFILE Account, Bucket, Counter Displays the name of the charging service.
It can also be mapped to a custom data with name, such as Segment defined in the device.
Charging- Service- Reserve THRESHOLD_ PROFILE Counter Displays the charging service name, which has contributed more in reservation.
Charging- Service- Reserve- TypeTHRESHOLD_ PROFILE Counter Displays the device or group name, which contains the charging service which has contributed more in reservation.
Counter- Current- Value THRESHOLD_ PROFILE Counter Displays the current value of a counter.
For example: THRESHOLD_PROFILE.
Counter-Current- Value Note : If usage limit and overage limit are configured for a counter, and multiple overage blocks are being consumed in a single call, then this attribute Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1952Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description has an overage usage till the previous overage block for which threshold is being executed.
For example, if Usage Limit is 10 GB and Overage Limit is 1 GB with threshold notification configured on 100% usage, and Counter- Current- Value jumps from 10 GB to 12 GB , then threshold notification has the following two notifications: 1.On consumption of 11 GB usage with Counter- Current- Value as 11 GB , the Current- Overage- Usage is 1 GB for Counter- Overage- Count of 1.
2.On consumption of 12 GB usage with Counter- Current- Value as 12 GB , the Current- Overage- Usage is 1 GB for Counter- Overage- Count of 2.
Counter- Current Value SPR_ GROUP SPR_ DEVICE SUBSCRIPTIONCounter Displays the current value of a provided counter.
For example, consider a group has two counters GC1 and GC2 .
A threshold is attached to counter GC1 .
Therefore, in the Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1953Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description notification of threshold attached to counter GC1 , we can configure to send another counter GC2 as well.
SPR_GROUP.Counter- CurrentValue ( "< Counter-Def-Name>" ) SPR_DEVICE.Counter- CurrentValue ( "< Counter-Def-Name> " ) SUBSCRIPTION.
Counter-CurrentValue ( "<Counter-Def- Name>" ) wherein Counter-Def- Name is GC1 and GC2 .
Counter- Def- Name THRESHOLD_ PROFILE Counter Displays the counter name for which the threshold value is defined that triggers a notification.
Counter- End- Date THRESHOLD_ PROFILE Counter For subscription counter, the counter end date is the end date of the subscription to which the counter is linked.
For device counter, group counter, and device group counter, the counter end date is taken from the account linked to the subscription.
Note : If multiple subscriptions are used in a call, then the Counter End Date is taken from the account ID of the first Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1954Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description subscription used in the call.
For example: THRESHOLD_PROFILE.
Counter-End-Date Counter- EndDate SPR_ GROUP SPR_ DEVICE SUBSCRIPTIONCounter Displays the counter end date.
For subscription counter, the counter end date is the end date of the subscription to which the counter is linked.
For device counter, group counter, and device group counter, the counter end date is taken from the account linked to the subscription.
Note : If multiple subscriptions are used in a call, then the Counter End Date is taken from the account ID of the first subscription used in the call.
For example, consider a group has two counters GC1 and GC2 .
A threshold is attached to counter GC1 .
Therefore, in the notification of threshold attached to counter GC1 , we can configure to send another counter GC2 as well.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1955Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description SPR_GROUP.Counter- CurrentValue ( "< Counter-Def-Name>" ) SPR_DEVICE.Counter- CurrentValue ( "< Counter-Def-Name> " ) SUBSCRIPTION.
Counter-CurrentValue ( "<Counter-Def- Name>" ) wherein Counter-Def- Name is GC1 and GC2 .
Counter- End- Value THRESHOLD_ PROFILE Counter Displays the maximum limit value stored in a counter.
This is an absolute value of the counter threshold corresponding to the Notification-Stop , Notification-Reject , and Reject actions.
Note : Counter percentage type thresholds and overage thresholds are not considered for this attribute.
Counter- Overage- Count THRESHOLD_ PROFILE Counter As overage limit blocks keep on repeating multiple times, this attribute provides the count of the ongoing overage block.
For example, if usage limit is 5 GB , overage limit is 2 GB, and Counter- Current- Value is 9.5 GB , then this attribute gives 3 depicting third overage block, which is ongoing.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1956Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description Note : If multiple overage blocks are being consumed in a single call, then this parameter has an overage count of overage block ( current or previous) , for which threshold is being executed.
For example, if Usage Limit is 10 GB , Overage Limit is 1 GB with threshold notification on 100% usage, and Counter- Current- Value jumps from 10 GB to 12 GB in a call, then threshold notification for overage count is 1 (on 11 GB usage) and Counter- Overage- Count is 2 (on 12 GB usage) .
Counter- Overage- Limit THRESHOLD_ PROFILE Counter Displays the overage limit in the counter instance.
Counter- Reset- Timestamp THRESHOLD_ PROFILE Counter Displays the last reset time of the counter instance.
Counter- Threshold- PercentageTHRESHOLD_ PROFILE Counter If the percentage threshold is being executed, then this attribute contains the percentage threshold value.
For example, if threshold is applied at 90% , then this attribute value is 90.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1957Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description Note : For absolute thresholds, this attribute value remains 0.
Counter- Update- TimestampTHRESHOLD_ PROFILE Counter Displays the value when a counter instance was updated by create/ update/ delete/ read operation or BCR, such as, Last Admin Update or Billing Cycle Timestamp .
Counter- Usage- Limit THRESHOLD_ PROFILE Counter Displays the prorated usage limit in the counter instance.
Current- Overage- Usage THRESHOLD_ PROFILE Counter If the overage limit is specified, then current usage in ongoing overage block is calculated as: Current counter value – ( Usage limit + ( Overage limit * (overage count - 1) )) For example, if Usage Limit is 5 GB , Overage Limit is 2 GB, and Counter- Current- Value is 9.5 GB , then this attribute value is 0.5 GB .
If no overage limit is defined, then this attribute value remains 0.
Note : If multiple overage blocks are being consumed in a single call, then this attribute has an overage Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1958Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description usage of that overage block only ( current or previous) , for which threshold is being executed.
For example, if Usage Limit is 5 GB and Overage Limit is 1 GB with threshold notification configured on 50% and 100% usage, and also Counter- Current- Value jumps from 10 GB to 12.5 GB in a call, then the threshold notification has three notifications: 1.On 100% consumption of first overage block (previous) , which means on 11 GB usage, with Counter- Current- Value as 11 GB, Current- Overage- Usage as 1 GB , and Counter- Overage- Count as 1.
2.On 100% consumption of second overage block (previous) , which means on 12 GB usage, with Counter- Current- Value as 12 GB, Current- Overage- Usage as 1 GB , and Counter- Overage- Count as 2.
3.On 50% consumption of third overage Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1959Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description block ( current) , which means on 12.
5 GB usage, with Counter- Current- Value as 12.5 GB, Current- Overage- Usage as 0.5 GB and Counter- Overage- Count as 3.
Current- Used- Value THRESHOLD_ PROFILE Bucket, Counter The amount used towards the threshold in bucket.
For counter, it indicates the amount used towards the threshold in counter.
delta- To-Next- Threshold THRESHOLD_ PROFILE Bucket, Counter The delta value to next threshold, that is, the difference between a counter current value and upcoming Threshold value.
Note : Counter percentage type thresholds and overage thresholds are not considered for this attribute.
description SUBSCRIPTION Subscription Displays the description of the subscription.
E164 SPR_ DEVICE Account The MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.
First- Reserve- Rate THRESHOLD_ PROFILE Resource based Counter Displays the Rate ID which is associated with the Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1960Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description entity that is first used in reservation.
Last- Update- Timestamp THRESHOLD_ PROFILE Bucket, Counter The value when a counter/ bucket was updated by any method.
For example, CRUD operation or BCR, that is, Last Admin Update or Billing Cycle Timestamp.
Notification- Generation- TimestampTHRESHOLD_ PROFILE Account, Bucket, Counter The Unix timestamp when the notification is generated.
This is the current time period in seconds.
Notification- Generation- Timestamp- MillisTHRESHOLD_ PROFILE Account, Bucket, Counter The time when the notification is generated for a counter.
It refers to the last three digits or milliseconds of the Unix timestamp.
Notification- Event CALL_ COMMON Account, Bucket, Counter, AV (All types)Displays the notification event.
Overage- Allowance THRESHOLD_ PROFILE Account Displays the overage allowance limit.
Overage- Flag THRESHOLD_ PROFILE Account Displays the flag to identify whether the current threshold is on account overage value.
Overage- Value THRESHOLD_ PROFILE Account Displays the overage value of an account to which a threshold is attached.
Reserve- Rate THRESHOLD_ PROFILE Resource based Counter Displays the Rate ID which is associated with the Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1961Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description entity for which maximum reservation has taken place.
Reserve- Entity- Name THRESHOLD_ PROFILE Counter Displays the name of entity from which maximum reservation has taken place.
Reserve- Entity- Type THRESHOLD_ PROFILE Counter Displays the type of entity from which maximum reservation has taken place, and this can have one of the 3 values; BUCKET , ACCOUNT , or NOCHARGE .
Subscription- State- Validity- End- DateTHRESHOLD_ PROFILE Subscription, Subscription counterDisplays the end date of entity lifecycle attached with the subscription.
This value is null when there is no time configured in the entity lifecycle state.
Note : This time is available only when threshold is applied on subscription or subscription counter.
For example, Entity End Time = 2019- 11-11 17: 36:56 IST .
(In this case, the date format of end time depends how the notification template is configured. )
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1962Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description State- Validity- End- Date SUBSCRIPTION Subscription Subscription counterDisplays the end date of entity lifecycle attached with the subscription.
This value is null when there is no time configured in the entity lifecycle state.
Note : This time is available only when threshold is applied on subscription or subscription counter.
For example, Entity End Time = 2019- 11-11 17: 36:56 IST .
(In this case, the date format of end time depends how the notification template is configured. )
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1963Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description Threshold- Compute- Recurrence- CountTHRESHOLD_ PROFILE Account, Bucket, Counter, AVCounter, AVIf a threshold is recurring, then it is recurrence value in the threshold- crossed action.
Threshold- Crossing- Value THRESHOLD_ PROFILE Account, Bucket, Counter, AVCounter, AVThe value at which the threshold is crossed.
Threshold- Current- Absolute- ValueTHRESHOLD_ PROFILE Bucket, Counter The current value of the counter or bucket with reservation.
Threshold- Current- Percentage- ValueTHRESHOLD_ PROFILE Bucket, Counter The percentage value of a current value of bucket, or 100 for a counter.
Threshold- Is-Crossed THRESHOLD_ PROFILE Account, Bucket, Counter, AVCounter, AVDisplays the value as True if a threshold is exceeded; otherwise, displays the value as False .
Threshold- Percentage THRESHOLD_ PROFILE Bucket, Counter Buckets can have threshold percentage value.
For absolute threshold, the Percentage of absolute limit is calculated.
This means if the threshold level is set to 900 and the Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1964Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description bucket initial value is 1000, then it is 90 percent in the notification.
Counters can only have threshold as absolute start type.
To calculate the percentage of the absolute limit, the maximum limit value of counter is the one which has threshold defined with action Notification- stop/ Notification- Reject, and Reject.
Example : Two thresholds of absolute start of 900 MB and 1000 MB are defined in a counter with action Notification- send and Notification- stop/ Notification- Reject respectively.
In this case, the threshold percentage is calculated as 90% and 100% .
Threshold- Profile- Compute- IntervalTHRESHOLD_ PROFILE Account, Bucket, Counter, AV (All types)Displays the threshold interval value for the Threshold- Profile- Interval- Count .
Threshold- Profile- Interval- CountTHRESHOLD_ PROFILE Bucket, Counter Displays the current interval number, before the call.
Threshold- Recurrence- CountTHRESHOLD_ PROFILE Account, Bucket, Counter, AVCounter, AVDisplays the number of times the threshold has been crossed.
For non- Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1965Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description recurring thresholds, this must always be 0.
Threshold- Value THRESHOLD_ PROFILE Account, Bucket, Counter, AVCounter, AVDisplays the value on which threshold is defined.
Total- Overage- Usage THRESHOLD_ PROFILE Counter Displays the total usage in overage blocks when the overage limit is specified.
The total overage usage is calculated as ( Current- Counter- Value - Counter- Usage- Limit ).
For example, if Usage Limit is 5 GB , Overage Limit is 2 GB, and Current- Counter- Value is 8.5 GB , then this attribute calculates the total usage in overage block, which means 3.5 GB .
If no overage limit is defined, then this attribute value remains zero.
Note : If multiple overage blocks are being consumed in a single call, then this attribute has total overage usage till that overage block ( current or previous) for which threshold is being executed.
For example, if Usage Limit is 5 GB and Overage Limit Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1966Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description is 1 GB with threshold notification configured on 50% and 100% usage, and also Counter- Current- Value jumps from 10 GB to 12.5 GB in a call, then the threshold notification has three notifications: 1.On 100% consumption of first overage block (previous) , which means on 11 GB usage, with Counter- Current- Value as 11 GB, Total- Overage- Usage as 1 GB , and Counter- Overage- Count as 1.
2.On 100% consumption of second overage block (previous) , which means on 12 GB usage, with Counter- Current- Value as 12 GB, Total- Overage- Usage as 2 GB , and Counter- Overage- Count as 2.
3.
On 50% consumption of third overage block ( current) , which means on 12.
5 GB usage, with Counter- Current- Value as 12.5 GB , Total- Overage- Usage as 2.5 GB and Counter- Overage- Count as 3.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1967Charging User Guide Rating and charging Attribute Source Context Applicable for resources Description Unit- Of-Remaining- AllowanceTHRESHOLD_ PROFILE Account, Bucket Displays the type of unit for a bucket or account.
Note : For an account, the unit is only MONEY type.
Used- Service- Units CALL_ COMMON Account, Bucket, Counter, AV (All types)Displays the reported units in CCR from CCR- U/T.
The Bucket Current Value or Counter Current Value within the variables are sent in the base unit to their type as follows: •For Volume type, the value is sent in bytes.
•For Time type, the value is sent in seconds.
•For Unit type, the value is sent in absolute value of units.
•For Money type, the value is sent with precision.
For example, 1234.56.
Lifecycle notification variables The custom data from a device or group is also available as notification variable.
The following table lists the lifecycle related notification variables.
Attribute Source Context Applicable for entity Description Creation- Time SUBSCRIPTION Subscription Displays the creation time of a subscription.
description SUBSCRIPTION Subscripton Displays the description of a subscription.
From- State LIFECYCLE Account, Subscription, Device, GroupDisplays the current state of a subscription or account.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1968Charging User Guide Rating and charging Attribute Source Context Applicable for entity Description IMSI SPR_ DEVICE Account, Subscription, Device, GroupDisplays the IMSI of the device for which a notification is sent.
Next- Validity- Time LIFECYCLE Account, Subscription, Device, GroupDisplays the new validity time of a subscription or account.
Old- Validity- Time LIFECYCLE Account, Subscription, Device, GroupDisplays the old validity time of a subscription or account.
Start- Time SUBSCRIPTION Account, Subscription, Device, GroupDisplays the start time of a subscription.
To-State LIFECYCLE Account, Subscription, Device, GroupDisplays the state to which a subscription or account transitions.
8.30 updateDeltaDevice and updateDeltaGroup APIs The updateDeltaDevice and updateDeltaGroup APIs allow operators to modify the delta information of a Device and Group.
If multiple devices are attached to a Group, then all the Device details are not needed to update the Group.
For example, consider that a Group has 10 devices attached to it.
Operator wants to remove a single Device6 , then only the details of Device6 must be sent in the request to remove it.
The details of other 9 devices linked are not needed in the request.
Note : Only the root level variables and list objects are considered for delta updates.
Delta update of fields within nested object is not considered and entire object gets updated.
API operations Operators can perform the following operations using the updateGroup API: •Subscribe a new bundle •Subscribe multiple bundles Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1969Charging User Guide Rating and charging •Remove a bundle •Remove multiple subscriptions using one request •Add a device •Add multiple devices •Update a notification profile Operators can perform the following operations using the updateDevice API: •Add a new IMSI •Add a new MSISDN •Remove an existing MSISDN •Update a notification profile Examples Example 1: Delta Device update to add or modify a single variable Operators can send the following API request to modify the delta information of a Device.
The subAction parameter defines the action to perform.
The following request adds a notification profile named Notification1 to the Device Device1 if a notification profile does not exist for Device1 .
Otherwise, the API request replaces the existing value of notification profile for Device1 .
https://<SM_IP>:8443/services/ServiceManager/subscriber/deltaUpdate/Device?subAction=modify Request: { "id":Device1", "notificationProfile":"Notification1" } Example 2: Delta Device update to modify a collection variable The API request performs the following actions: •Removes the existing groups from Device1 .
•Adds Group2 to Device1 .
•Adds a notification profile named Notification2 to Device1 if a notification profile does not exist.
Otherwise, the API request replaces the existing value of notification profile for Device1 .
https://<SM_IP>:8443/services/ServiceManager/subscriber/deltaUpdate/Device?subAction=modify Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1970Charging User Guide Rating and charging Request: { "id":Device1", "groups":["Group2"] "notificationProfile":"Notification2" } Example 3: Delta Device update to add a collection variable The API request adds the identity value to Device1 .
That is, the API appends the defined identity value to the existing device identities list if this identity value is not already added.
https://<SM_IP>:8443/services/ServiceManager/subscriber/deltaUpdate/Device?subAction=add Request: { "id":Device1", "identities":[ { "identityType:"E164", "value:"12345678" }] "notificationProfile":"Notification3" } Example 4: Delta Device update to remove a collection variable The API request removes the already added subscription from Device1 whose subscription id is provided in the request.
Note : To update a value of collection element, it is recommended to first remove and then add it.
To update a collection with only one element, you can send the entire object with subAction=modify.
https://<SM_IP>:8443/services/ServiceManager/subscriber/deltaUpdate/Device?subAction=remove Request: { "id":Device1", "subscriptions":[{id":"e29591f1-1530-48b0-9cfb-cac06e6a5908"}] Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1971Charging User Guide Rating and charging "identities":[ { "identityType:"E164", "value:"12345678" }] } Example 5: Delta Group update to modify a single variable Adds a notification profile named Notification5 to the Group named Group1 if a notification profile does not exist.
Otherwise, the API request replaces the existing value of notification profile for Group1 .
https://<SM_IP>:8443/services/ServiceManager/subscriber/deltaUpdate/Group?subAction=modify Request: { "id":Group1", "notificationProfile":"Notification5" } Example 5: Delta Group update to remove a collection variable The API request removes the already added aggregate view named GrpAV from Group1 .
https://<SM_IP>:8443/services/ServiceManager/subscriber/deltaUpdate/Group?subAction=remove Request: { "id":Group1", "aggregateViewIdList":["GrpAV"] } 8.31 Patch APIs to modify Account BCR date The Account's BCR can be changed by setting the updateTransition parameter to true in the patch API and sending the billing information in the API request.
Following are the cases of BCR: •Immediate BCR : The account's BCR is immediately changed and the next BCR occurs on the scheduled time that is sent in the billing information in API request.
All the subscriptions aligned to the Account's BCR date (that is, subscription without it's own periodic lifecycle) renews/expires on the new BCR date.
•Future BCR : The account's BCR is changed to a future date.
The billing information is updated and no action is taken since the next BCR date does not change.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1972Charging User Guide Rating and charging Immediate BCR NCC performs the following tasks when the BCR is set to Immediate BCR .
•Updates the Account's billing information and Account's endTime.
•Deletes the old scheduled transition entry (from TEM) and schedules a new transition as per the new endTime of Account.
•Sends the Re-authorization request for all data sessions associated with the Account to assure that the VT alignment is correct based on the new BCR date.
•Processes the Refund Fee .
If a subscription has prorate configuration, then the prorate calculation is done as per the new BCR date and refund is processed.
•Checks for the renewal mode of subscription.
The following points provide details on the value of renewal mode with different configuration: 1.If a Subscription has it's own PLC with action RenewSubscriptionAction , the Renewal Mode = ALL.
2.If a Subscription has it's own PLC with ResetSubscriptionAction , the Renewal Mode = RESET.
3.If a Subscription has it's billing cycle, the Renewal Mode = BILLING_ONL Y.
If BundleActivationType = ON_SESSION, the Renewal Mode = BILLING_ONL Y.
4.In all other cases, the Renewal Mode = NONE.
The fee is refunded only in case 2 (PLC with ResetSubscriptionAction ), case 3 (BundleActivationType = ON_SESSION), and case 4 (no PLC).
Example: Immediate BCR Consider that the Account A1 has following billing information: •Day Of Month = 25 •Day Of Week = SUNDAY •Hour Of Day = 0 •Account Start Time = Oct 1, 2020 11:00 AM IST •Account End Time = Oct 25, 2020 12:00 AM IST Here, the Account A1 BCR time is Oct 25, 2020 12:00 AM IST.
The patch API to update the billing information of Account is triggered on 05-10-2020 with the following billing information parameters: •Day Of Month = 20 •Day Of Week = SUNDAY •Hour Of Day = 0 •updateTransition = true The requestedEndTime < configuredEndTime [20-10-2020 < 25-10-2020].
In this case of Immediate BCR, NCC performs the following tasks: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1973Charging User Guide Rating and charging •Updates the Account's billing information and Account's endTime.
•Deletes the old scheduled transition entry (from TEM) and schedules a new transition as per new endTime of Account.
Future BCR date changes NCC performs the following logic when the BCR is set to Future BCR : •No action is taken for future BCR date and billing information is updated.
•For the next BCR date, the Account and all the subscriptions linked to the Account's BCR date are modified to align with the new BCR date.
•The Account uses the new BCR date going forward.
•If the patch API request has only billing information (Day Of Month, Day Of Week, Hour Of Day) with updateTransition parameter set to true, RAR is not triggered.
•If the patch API request has billing information along with other parameters such as Overage-Limit, Time-Zone, updateTransition parameter set to true, RAR is triggered.
Example: Future BCR Consider that the Account A1 has following billing information: •Day Of Month = 25 •Day Of Week = SUNDAY •Hour Of Day = 0 •Account Start Time = Oct 1, 2020 11:00 AM IST •Account End Time = Oct 25, 2020 12:00 AM IST Here, the Account A1 BCR time is Oct 25, 2020 12:00 AM IST.
The patch API to update the billing information of Account is triggered on 05-10-2020 with the following billing information parameters: •Day Of Month = 28 •Day Of Week = SUNDAY •Hour Of Day = 0 •updateTransition = true The requestedEndTime < configuredEndTime [28-10-2020 < 25-10-2020] is false, this is the case of Future BCR.
Here, the Account's billing information is updated by Patch API code.
Additional information related to Immediate and Future BCR While using the Profile Patch and Account Patch API to update the Account's billing information, the granularity factor is considered based on the periodicity of lifecycle associated with the Account entity.
For example, if the periodicity is Monthly, then granularity is atleast one day.
Consider a scenario where the Account has the monthly periodicity, billing information is as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1974Charging User Guide Rating and charging •DayOfMonth = 29 •DayOfWeek = TUESDAY •HourOfDay = 0 Operator wants to update the billing cycle to 29-Nov-2020 and passes the following billing parameters in the Profile Patch or Account Patch API on 29-Nov-2020 10:00:00 AM.
•DayOfMonth = 29 •DayOfWeek = TUESDAY •HourOfDay = 0 •updateTransition = true The resultant date is 30-Dec-2020.
This is because, the request is sent on 29-Nov-2020 10:00:00 AM to update the end time to 29-Nov-2020 00:00:00, which is not possible since 29-Nov-2020 00:00:00 is already passed.
Hence, to update the end date to 29-Nov-2020, operator must update the HourOfDay parameter to 23, instead of 0.
The new time is calcualted as 29-Nov-2020 23:00 PM IST.
For refund fee, if the new BCR date is set to 29-Dec-2020, which is a future date, then no fee is refunded.
Fee is refunded only in case of Immediate BCR.
For the case where the HourOfDay parameter is set to 23, the BCR date is 29-Nov-2020, then the refund happens based on the granularity set as follows: •Granularity level is set to Default or Days, then no fee is refunded.
•Granularity level is set to HOURS, then fee is refunded.
The Granularity level can be set in the Bundle entity as shown in the following figure: 8.32 Change bundle or subscription functionality Operators can change the subscription for a device or group using the SM GUI or the ( updateDevice , updateGroup , updateChangePlan ) REST API.
Operators can also cancel the subscription by setting a parameter in the updateChangePlan API.
If a call is in-progress when a subscription is changed, a RAR is sent and in the next CCR-U or CCR-T message, the usage allocated from the old subscription is charged and quota is allocated from the new subscription.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1975Charging User Guide Rating and charging When the change bundle option is executed, if the Aggregate View (AV) is configured on a device or group, then the corresponding update reflects in the AV.
Note : This feature is applicable only to charging module.
A subscription must have a final state configured (as shown in the following figure).
If a final state is not configured, then see Change bundle - without final lifecycle state on page 1986 for information on the action NCC performs in such cases.
For carry-over logic, the change bundle feature is applicable only when you have a single bucket attached and that is of the same unit type.
This restriction is applicable only for Immediately and Immediately with prorating options.
With IMMEDIATE_BACKDATED option, carry-over works even when bundle has more than one bucket.
Following are the supported modes for changing the bundle: •Immediately •Immediately with prorating •On next cycle •IMMEDIATE_BACKDATED - Note that this option is available only from REST API and not from SM GUI.
Note : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1976Charging User Guide Rating and charging For Immediately , Immediately with prorating , IMMEDIATE_BACKDATED modes, if there are calls in- progress, then a RAR is triggered for sessions using old subscription and change bundle EDR gets generated.
Configuration to send SNR for new counters To trigger SNR for new counters after ChangePlan execution, the following configuration must be done in thresholds.
Ensure that you select the OCS Policy Threshold option during threshold creation.
Following is the threshold configuration for counters: Threshold for subscription (ABY) counter Threshold for multi bundle (TBY) counter Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1977Charging User Guide Rating and charging Parameters in updateDevice, updateGroup, and updateChangePlan REST API Attention : It is recommended to use the updateChangePlan API to change bundle or subscription.
The updateDevice and updateGroup API supports the following parameters to change the bundle: Parameter name Type Supported values Description refer Bundle Name string Indicates the bundle name.
refer Bundle Customize flag True FalseIndicates whether the bundle is customized.
If this flag is set as True , then the charging service, bucket definition, counter definition, bundle name, lifecycle name, and carry over details areTable 217: updateDevice and updateGroup API parameters Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1978Charging User Guide Rating and charging Parameter name Type Supported values Description considered in the changed subscription for the device.
bundle Change Carry Over flag True FalseIndicates whether the carry over is enabled.
type OfBundle Change string Immediate Immediate_ Minus_ Used Next_ Billing_ Cycle IMMEDIATE_ BACKDATEDIndicates the change type, such as Immediate , Immediate_ Minus_ Used , or Next_ Billing_ Cycle , or IMMEDIATE_ BACKDATED .Table 217: updateDevice and updateGroup API parameters (continued) Note : NCC considers the timezone ID of an account while using REST API to update the end date of subscription.
The updateChangePlan API supports the following parameters to change the bundle: Parameter name Type Supported values Description Mandatory/ Optional ID Type string Indicates the device or group.
Mandatory ID string Indicates the device ID or group ID depending on the ID type.Mandatory OldBundle Name string Indicates the name of the bundle that needs to be replaced.Mandatory New Bundle Name string Indicates the name of the new bundle to replace the old bundle.
Note that, if the Change Plan Option is Cancel , then the New Bundle Name parameter is ignored irrespective of its value.Mandatory Change Plan Option string Immediate Immediate_ Minus_ Used Next_ Billing_ CycleIndicates the change type.
Cancel is used to cancel the change plan for Next_ Billing_ Cycle .
See SubscriptionMandatoryTable 218: updateChangePlan API parameters Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1979Charging User Guide Rating and charging Parameter name Type Supported values Description Mandatory/ Optional Cancel IMMEDIATE_ BACKDATEDactivation - Cancel on page 1984 for an example related to the Cancel option.
Attention : If a carryover is done from/ to a multi- Bucket Bundle, the carryover value remains 0 for Change Plan with IMMEDIATE, IMMEDIATE_ MINUS_ USED, NEXT_ BILL_ CYCLE, and IMMEDIATE_ BACKDATED options.
Carry Over Flag flag True FalseIndicates whether the carry over is enabled.Optional OldSubscription Instance ID string Indicates the ID of old subscription.
Note that it is required when there are multiple instances of same bundle.Optional Customize Flag flag True FalseIndicates whether the bundle values need to be customized.
If this flag is set as True , then the customized values of new bundle are processed.OptionalTable 218: updateChangePlan API parameters (continued) Results of updateDevice, updateGroup, and updateChangePlan REST API operations The updateDevice , updateGroup , and updateChangePlan APIs can provide any of the following results: •OK: Successful For Cancel option, if the existing bundle has information about the new bundle to get activated in the next billing cycle, then NCC removes the information about the new bundle from the existing bundle in a device or group and returns a success message.
•NOK: Failure or error message and instance lists are returned If the result is NOK due to multiple instances of the subscription and operator has not provided the instance ID for which the change bundle is needed, then all instances of the subscription are returned.
Therefore, in the next request, the operator specifies the instance ID for which the change bundle is needed.
For Cancel option, if the bundle is subscribed multiple times, then the instance ID for old subscription is required.
Otherwise, NCC returns NOK with instance lists.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1980Charging User Guide Rating and charging Change bundle mode selection using SM GUI The following figure shows the Change Bundle option available in the device entity.
Once you click Change Bundle option, the new bundle along with the different modes to apply change appear as shown in the following figure: Subscription activation - Immediately For Immediately activation mode, the old bundle is moved to final state and new subscription is immediately subscribed to a device or group.
Example: Subscription activated using Immediately mode Bob has a 5 GB subscription, out of which, only 3 GB is used.
When the Immediately activation mode is executed, the current subscription is changed to a new subscription of 8 GB.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1981Charging User Guide Rating and charging Bob gets a new 8 GB subscription.
After BCR also, Bob gets 8 GB subscription.
If the carry over flag is set and the new bundle supports carryover, then the carry over bucket value in old bundle is transferred to carry over the bucket value in a new bundle.
Subscription activation - Immediately with prorating For Immediately with prorating mode, the old bundle is moved to final state and then the new bundle is subscribed.
NCC sets the current value of new bucket with (initial value of new bucket - used value of old bucket) when a new bundle is subscribed.
If the used value of old bucket is greater than the initial value of the new bucket, then the current value of new bucket is set to zero.
If there are calls in progress, then the reserved amount is also treated as used value.
Example 1: Subscription activated using Immediately with prorating mode Consider the following two variants: •Variant 1 : Bob has a 5 GB subscription, out of which, only 3 GB has been used.
When the Immediately with prorating activation mode is executed, Bob gets a new plan of 8 GB but the current value of the new bucket is 5 GB (8 GB - 3 GB).
From the next billing cycle, Bob gets 8 GB subscription and the carry over flag is ignored.
•Variant 2 : Bob has a 8 GB subscription, out of which, only 7 GB has been used.
When the Immediately with prorating activation mode is executed, Bob gets a new plan of 5 GB but the current value of the new bucket is 0 GB (5 GB - 7 GB).
From the next billing cycle, Bob gets 5 GB subscription and the carry over flag is ignored.
Example 2: Immediate with prorating (IMMEDIATE_MINUS_USED) and carry over options for normal and customized bundle This example shows that using the updateGroup API, operators can change the normal to custom bundle along with IMMEDIATE_MINUS_USED and Carry over options enabled.
Consider that a group has a bundle with bucket and counter as shown in the following figure.
When the bundle details are changed using the updateGroup API with typeofBundleChange set to IMMEDIATE_MINUS_USED and bundlechangeCarryOver set to True , the new values sent in the updateGroup API is set accordingly as shown in the figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1982Charging User Guide Rating and charging The following figure shows the group subscription lifecycle (Object Status Lifecycle) before the updateGroup API is executed.
The following figure shows the group subscription data after the updateGroup API is executed to change the bundle data.
The following figure shows the value of group bucket and counter data after the updateGroup API is executed to change the bundle data.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1983Charging User Guide Rating and charging Subscription activation - On next cycle When BCR happens, NCC checks whether the changed bundle exists for a subscription.
If yes, then the old subscription is moved to final state and the new subscription is subscribed to a device or group.
For further transactions, the new bundle is used.
If the carry over flag is set, then the leftover bucket value is carried to the new subscription.
The details of old and new subscriptions such as bundle, charging service, counter, and bucket are recorded in the CDR.
Example : Bob has a 5 GB subscription, out of which 4 GB is used and the carry-over flag is set to True .
After BCR, Bob is subscribed to a new 6 GB subscription.
Since, carry-over flag was set, the leftover bucket value of 1 GB is carried to the new subscription and the total value of new data bucket is 7 GB.
Subscription activation - Cancel Operators can use the Cancel option in the ChangePlan API to cancel the change the bundle or subscription scheduled for Next_Billing_Cycle .
Example : A device has a bundle A. BCR date is 10th June.
On 3rd June, the ChangePlan REST API with Next_Billing_Cycle is invoked to change Bundle A with Bundle B with customized information.
On 7th June, the ChangePlan REST API with Cancel is invoked for Bundle A .
The Bundle B with customized information is removed from bundle A.
On 9th June, ChangePlan REST API with Cancel is invoked for Bundle A again and nothing happens for Bundle A .
On 10th June, Bundle A BCR happens as scheduled and ChangePlan API is not executed.
Subscription activation - IMMEDIATE_BACKDATED Operators can use the IMMEDIATE_BACKDATED option from REST API (change plan, update device, update Group) only and not from SM GUI.
In this option, old bundle is moved to final state and then new bundle is subscribed.
NCC sets the current and unused value of new bucket to current value of same name bucket in old bundle.
If after setting this, the initial value of new bucket is less than its 'unused value' (that is, value with Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1984Charging User Guide Rating and charging reservation), then the initial value is adjusted to be set to unused value only for current bill cycle and bucket gets its own initial value from next bill cycle.
Also, carry-over, if applicable, is calculated from this old bucket and set as carry-over in new bucket.
If the new value crosses any threshold configured in new bucket/counter, then those thresholds are marked as crossed and no actions are performed for those thresholds.
This option is also applicable to counters, and current value of new counter is set to current value of same name counter in old bundle.
If a new bundle subscription has a new bucket with different name, it is created with its initial value and nothing is copied from old subscription.
This same approach is applied to counters as well.
If there was any reservation from old bucket or counter before change plan, then during their commit (that is, CCR-U or CCR-T request), new bucket or counter (in new bundle) is also modified as follows: •For new bucket : During under commit of old bucket, leftover-units (reserved value - unitsToCommit) are added to current and unused values of new bucket (and old bucket).
After this update, if the initial value of new bucket is less than unused value, then the initial value is adjusted to be same as unused value only for current bill cycle.
This is not applicable if carry over is enabled for new bucket.
So, leftover-units are not added to new bucket in under commit (or to carryover bucket instance in case reservation was done from old carry over bucket instance before change plan).
For exact commit and over commit of old bucket, there is no change in existing behavior.
In exact commit, only old bucket is modified.
In over commit, old bucket is modified for reserved value and the over-committed value is deducted from new bucket's current and unused values.
•For new counter : During exact and under commit of old counter, units to commit are added to new counter.
During over commit of old counter, the reserved value of old counter and over committed value is added to new counter (reserved value is added to old counter).
Thresholds are updated for new bucket/counter instance after updating current value.
Thresholds are executed in old bucket and counter instance for the units committed in old bucket and counter instance respectively.
Thresholds in new bucket and counter instance are updated in such a way that they are not executed for the units committed from old bucket and counter instance reservation.
Example 1: Subscription activated using IMMEDIATE_BACKDATED mode Variant 1 : Bob has a 5 GB subscription, out of which 3 GB has been used, so current value is 2 GB.
When the Immediate_Backdated mode is executed (with same name bucket), then Bob gets a new plan of 8 GB but the current value is 2 GB.
From the next billing cycle, Bob gets 8 GB subscription.
Variant 2 : Bob has a 8 GB subscription, out of which 1 GB has been used, so current value is 7 GB.
When the Immediate_Backdated activation mode is executed with a new plan of 5 GB (with same name bucket), Bob gets 7 GB as initial, current and unused value.
From the next billing cycle, Bob gets 5 GB subscription.
Carry over if applicable is applied.
Variant 3 : Bob has a 5 GB subscription, out of which 3 GB has been used, so current value is 2 GB.
It includes active reservation of 200 MB.
When the Immediate_Backdated mode is executed (with same name bucket), then Bob gets a new plan of 8 GB, but the current value is 2 GB.
During CCR-T of old subscription, value to commit is 100 MB, then remaining units from reserved value, that is, 100 MB (200 MB - 100 MB) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1985Charging User Guide Rating and charging are added to new subscription and its current value becomes 2.1 GB.
From the next billing cycle, Bob gets 8 GB subscription.
Variant 4 : Bob has a 5 GB subscription, out of which 3 GB has been used, so current value is 2 GB.
It includes active reservation of 200 MB.
When the Immediate_Backdated mode is executed (with same name bucket) with a new plan of 1 GB, then Bob gets initial, current and unused values as 2 GB.
Now, during CCR- T of old subscription, value to commit is 100 MB, then remaining units from reserved value, that is, 100 MB (200 MB - 100 MB) are added to new subscription and its initial, current and unused values become 2.1 GB.
From the next billing cycle, Bob gets 1 GB subscription.
Variant 5 : Bob has a subscription having TBY (Subscription counter), ABY (Multi Bundle Counter) counters, with current value as 3 GB for both counters.
When the Immediate_Backdated activation mode is executed with a new plan having same name counters, then the current value of new counters (ABY, TBY) in new subscription is also set to 3 GB.
Variant 6 : Bob has a subscription having TBY (Subscription counter), ABY (Multi Bundle Counter) counters, with current value as 3 GB for both counters.
It includes active reservation of 200 MB.
When the Immediate_Backdated activation mode is executed with a new plan having same name counters, then the current value of new counters (ABY, TBY) in new subscription is also set to 3 GB.
During CCR-T of old subscription, value to commit is 100 MB, then the committed value in old counter, that is, 100 MB is added to ABY and TBY counters in new subscription and current value of both the new counters become 3.1 GB.
Change bundle - without final lifecycle state When NCC executes ChangePlan for subscription using either Immediately with Prorating , Immediately , or Immediate_Backdated mode, and subscription does not have a final state configured within entity lifecycle, the subscription moves to barred state and this subscription cannot be used further.
NCC schedules deletion of this subscription after a configured time.
When NCC executes ChangePlan for subscription using On Next Cycle mode, and subscription does not have a final state configured within entity lifecycle, and the next reset/renew subscription action executes as per periodic lifecycle configured, then NCC performs the following actions: 1.Moves the subscription to a barred state and the subscription cannot be used further.
2.Schedules deletion of the subscription after a configured time.
Operators can configure/update the scheduled time using SM GUI.
To do this, change the value of the Me application preference Change-Plan:Subscription Scheduled Time Without Final State(in secs) .
The default value is 86400 seconds.
Note : For details on configuring ME application preferences, see Managed Elements section in Global Configuration Guide .
8.33 Data bundles with international roaming access The service operators can provide flexibility to subscribers to use the data bundles for both domestic and international roaming.
A daily spending limit can be configured for the data used during international Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1986Charging User Guide Rating and charging roaming.
If the daily spending limit is reached, then the throttling of speed (policy change) happens for the international roaming subscriber.
Configuration For the data bundles used during international roaming, all the counters are reset irrespective of whether they are linked to account or subscription.
Also, the SNR is sent for indicating the policy counter status when the counter is reached to configured threshold and again when the counter is reset to 0.
Configure the following entities: 1.Configure a threshold profile group with the Schedule-Event action.
Note that this action is applicable only for counters.
The syntax for Schedule-Event action is as follows: Schedule-Event ("<TIME_VALUE>", <TIME_UNIT>, <Action>) where •TIME_VALUE is the length of the period •TIME_UNIT is the period of unit, such as DAY, WEEK , MONTH •Action is the action to perform, such as RESET For example, the Schedule-Event action for daily counter reset is as follows: THRESHOLD.Schedule-Event ("1", TimeUnit_Days, ThresholdScheduledEventType_RESET) 2.Create a counter and link the threshold created in the previous step to it.
Threshold Profile Group IDs is the field name in the counter to link thresholds.
Set the OCS Policy Counter to true.
3.Create a charging service with data bucket.
Attach the threshold created with the data bucket.
4.Configure a data bundle and link the charging service created.
5.Create a device and link the counter.
See Pending counter reset logic on page 1691 for information regarding handling of pending counters.
Additional information Note the following important points: •Counter is reset at period defined in the Schedule-Event action.
It does not consider the periodicity defined in the linked account or subscription.
•If a counter has its own reset configuration, then it is not reset during account renewal.
Examples Example 1: Counter with its own periodicity In this example, the counter is reset at the period defined in the Schedule-Event action configured in the threshold profile group.
SNR is sent based on the configurations made.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1987Charging User Guide Rating and charging Consider that a device has the following subscription and counters linked to it: •A device subscription linked to account that renews at every 2 minutes.
•A device policy counter with normal configuration without the Schedule-Event action.
•A device policy counter with Schedule-Event action configuration that resets counter daily.
Configure the following entities to reset counter and send SNR for data bundle with roaming access: 1.Configure the Threshold profile group.
According to this configuration, when the threshold value is 0, SNR is set to HIGH (speed is at high rate) and the counter is reset daily.
The notification is sent with the data defined in the notification template.
When the threshold value of 50 GB is reached, the SNR is set to MEDIUM , that is, the speed is throttled to medium rate.
Set the OCS Policy Threshold to true .
2.Create a charging service with a data bucket and attach the threshold.
3.Configure a data bundle and link the charging service created.
4.Configure the following policy counters: Normal policy counter: Threshold is not linked to this counter.
Policy counter for reset: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1988Charging User Guide Rating and charging 5.Create a device and attach the data bundle and device counters (policy counters).
A data call is made and it crosses threshold at 50.
SNR throttles and status is set to MEDIUM .
Counter is reset at the scheduled time defined in the Schedule-Event action.
Example 2: Counter reset is due by its periodicity and is reset by call Consider that a device has the following subscription and counters linked to it: •A device subscription linked to account.
•A device policy counter with normal configuration without the Schedule-Event action.
•A device policy counter with Schedule-Event action configuration that resets counter daily.
The counter is reset when a call is triggered.
Following is the threshold configuration for counter scheduling.
According to this configuration, when the threshold value is 0, SNR is set to HIGH (speed is at high rate) and the counter is reset daily.
The notification is sent with the data defined in the notification template.
When the threshold value of 25 Byte is reached, the SNR is set to LOW , that is, the speed is throttled to low speed rate.
Set the OCS Policy Threshold to true .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1989Charging User Guide Rating and charging 8.34 Cost Bucket: As additional balance for call usage through tariff rules NCC has the capability to provide allowance (that is, additional balance) in the form of a separate plan to its users.
This allowance can be referred to as a monetary or non-monetary type of bucket within a charging service.
This allowance is made available to users through new plans, which means bundle subscription purchased over the user device.
Following are the capabilities of allowance along with promotional plan: •The separate allowance plan can be renewed or can be reset as per its billing cycle, which means the bucket follows the lifecycle of a bundle or account lifeycle (in case the bundle lifecycle is not present).
•The separate allowance plan can be prorated depending upon the day of purchase or activation of bundle plan.
•The Bundle on Use (BOU) functionality on allowance promotional plan, which means allowance can be subscribed to a device once the device starts using the plan.
•The aggregate view (AV) accumulating the allowance subscribed to a device by susbcribing the plan with additional allowances.
•The threshold action execution on monetary and non-monetary allowances are defined in a bundle.
Configuring the functionality In order to activate this functionality, the following flag needs to be configured in tariff rules for applicable resources or rate: The SelectRate_EXTERNAL flag is configured in the tariff rules of a charging service when a user wants to apply any rate as configured in the highest or lowest prioritized charging service or bundle apart from its own plan (bundle).
This flag is applied for non-monetary buckets.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1990Charging User Guide Rating and charging Note : The SelectRate_EXTERNAL flag is configured only for non-monetary buckets and for those specific plans in which tariff rules want to apply any other rates.
A new rule attribute Selected-Rate is set in the CALL_COMMON source context as a string type so that selected rate from one tariff can be used in the conditions or in Rating.Rate (result context) selection of the RATE .
Note : •For activating a Rate Only plan, that plan rate should have the highest priority amongst all plans or bundles.
•If the Rate Only plan with Rating.Rate(Rate1) or Any Plan with Rating.Rate (Rate2,Main-Balance) has a higher priority, then the Selected-Rate rule variable is set with the applicable rate.
•Help for CALL_COMMON.Selected-Rate in Rating.Rate() is currently not available in SM GUI.
For example: •For a charging service CS1 with Rating.Rate("Rate2") and CS2 with RATING.Rate (CALL_COMMON.Selected-Rate, "B1") , the charging of B1 is done with Rate2 .
•For RATING.Rate ( "CALL_COMMON.Selected-Rate", "B13" ) , an error code 5031 is returned as its only a bundle attached to the device.
Note : In the above two examples, we do not pick the rate from lower priority bundles.
Additional information •Allowances are additional balances; however, each allowance (with a bucket having separate instances) is not a shared bucket across bundles or plan.
•The secondary rate feature is not applicable to cost bucket or allowance features.
•The counter to be specified with resource, which is allowance accumulates the data consumption.
•The taxation fee is deducted using the only the main account balance and not from additional allowances.
•If a subscriber subscribes twice to the same allowance offer, then each instance contains a separate bucket.
•Multiple cost buckets are supported and is applied as per the priority of the bundle or charging service and the applicability condition set as TRUE .
•The rate is applied to allowance as per the priorities of the bundle or charging service and applicability condition set as TRUE .
•When Action Rate Only is defined in the tariff of RateOffer plan, it won't be charging from its own main account balance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1991Charging User Guide Rating and charging •When the SelectRate_EXTERNAL flag is defined in a rule against non-monetary bucket or main account balance, then rate is picked as per the priority or applicability of bundle or charging service.
•Taxation is applied to allowance; however, the taxation action should be configured with RATE action as per the existing plan.
•A bundle or charging service with only rate configured in its tariff rules is supported.
Pre-configuration for examples Following are the pre-configuration of the plan being used in the examples listed further: •Main-Balance Plan - A bundle with main account balance with a specified rate.
•Allowance Plan - A bundle with bucket of Money Type selected in the charging service and tariff rules.
•AllowanceMainBalancePlan - A bundle with bucket of Money Type and main account balance with a specified rate.
•NM-Allowance Plan - A bundle with bucket of Non-Monetary Type selected in the charging service and tariff rules.
•Rate Offer Plan - A bundle with no resource selected in the charging service or tariff rules, and only a specified rate in tariff.
Consider the following examples for better understanding of this feature: Example 1: Monetary allowance with Rate Offer Plan Monetary allowance with ANY rate Suppose a device has the following tariff configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1992Charging User Guide Rating and charging •Rate Offer Plan : CS1.Pass0 Rating.Rate(Rate0) •Allowance Plan : CS2.Pass0 Rating.Bucket-Selection(Allowance1) Note : As the Rate Offer Plan is applied with a higher priority, the monetary bucket is applied at Rate0 by default and no configuration flag is required for monetary bucket allowance.
RESUL T: As per the above configuration, for a device with Allowance Plan and Rate Offer Plan , Rate0 is applied to the MoneyAllowance .
Monetary allowance with SPECIFIC rate Suppose a device has the following tariff configuration: •Rate Offer Plan : CS1.Pass0 Rating.Rate(Rate0) •Allowance Plan : CS2.Pass0 Rating.Rate(Rate1,Allowance1) RESUL T: As per the above configuration, for a device with Allowance Plan and Rate Offer Plan but a specific rate, only Rate1 is applied to the Allowance1 .
Example 2: Non-monetary allowance with Rate Offer Plan Time allowance with NO rate Suppose a device has the following tariff configuration: •Rate Offer Plan : CS1.Pass0 Rating.Rate(Rate0) •NM-Allowance Plan : CS2.Pass0 Rating.Bucket-Selection(TimeAllowance) RESUL T: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1993Charging User Guide Rating and charging As per the above configuration, for a device with TimeAllowance and Rate Offer Plan , no rate is applied to the TimeAllowance .
Time allowance with ANY rate Suppose a device has the following tariff configuration: •Rate Offer Plan : CS1.Pass0 Rating.Rate(Rate0) •NM-Allowance Plan : CS2.Pass0 Rating.Bucket-Selection(TimeAllowance,SelectRate_EXTERNAL) RESUL T: As per the above configuration, for a device with TimeAllowance and Rate Offer Plan , only Rate0 is applied to the TimeAllowance .
Time allowance with SPECIFIC rate Suppose a device has the following tariff configuration: •Rate Offer Plan : CS1.Pass0 Rating.Rate(Rate0) •NM-Allowance Plan : CS2.Pass0 Rating.Rate(Rate1,TimeAllowance) Note : Rate Offer Plan is applied with a higher priority than the NM-Allowance Plan .
RESUL T: As per the above configuration, for a device with TimeAllowance and Rate Offer Plan , specific rate Rate1 is applied to the TimeAllowance and not Rate0 as per the Rate Offer Plan .
Example 3: Allowance Plan and AllowanceMainBalancePlan Suppose a device has an AllowanceMainBalancePlan , which has a monetary bucket of allowance of 20 United States dollars and purchases another allowance of 10 United States dollars ; both for the same account.
The rate is applied to both Allowance Plan and AllowanceMainBalancePlan .
The device has the following tariff configuration: •Allowance Plan : CS1.Pass0 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1994Charging User Guide Rating and charging Rating.Bucket-Selection(Allowance1) •AllowanceMainBalancePlan : CS2.Pass0 Rating.Rate(Rate1,Allowance2) and CS2.Pass1 Rating.Rate(Rate1,Main-Balance) Note : Allowance Plan is applied with a higher priority than the AllowanceMainBalancePlan .
RESUL T: As per the above configuration, Rate1 is applied to Allowance1 , Allowance2 , and Main–Balance .
After the consumption of 10 United States dollars allowance, the 20 United States dollars allowance is consumed, and then the main balance of 100 United States dollars .
Example 4: Rate Offer Plan on Main-Balance Plan Suppose a device has a Main-Balance Plan and a Rate Offer Plan for the same account.
The rate is configured in the Rate Offer Plan and it charges from the main account balance.
Note : In order to use ANY Rate , which is the Rate Offer Plan , the SelectRate_EXTERNAL configuration flag must be configured in the tariff configuration.
The device has the following tariff configuration: •Rate Offer Plan : CS1.Pass0 Rating.Rate(Rate0) •Main-Balance Plan : CS2.Pass0 Rating.Rate(Rate1,Main-Balance,SelectRate_EXTERNAL) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1995Charging User Guide Rating and charging RESUL T: As per the above configuration, Rate0 is applied to Main-Balance Plan even if it is configured with Rate1 .
Allowance consumption scenarios for a cost bucket As per the pre-configuration listed in the Pre-configuration for examples on page 1992 , the following behaviour is applicable in the allowance consumption scenarios: •Allowance consumption with counter for a cost bucket : Suppose a device has a Rate Offer Plan and Allowance Plan with the following tariff configuration: –Rate Offer Plan : CS1.Pass0 Rating.Rate(Rate0) –Allowance Plan : CS2.Pass0 Rating.Bucket-Selection(MoneyAllowance) Rating.Counter-Selection(Counter1) Rate0 is only applied to the MoneyAllowance .
The Counter1 is updated with consumption done from MoneyAllowance , which means that for an allowance plan, the allowance consumption should be accumulated in a subscription counter defined with applied rate from the Rate Only plan.
Note : The counter must be specified with the resource, that is allowance to accumulate the consumption.
•Allowance consumption and lifecycle for a cost bucket : The Allowance Plan is renewable or can be reset as per its billing cycle, which means the cost bucket follows the lifecycle of the bundle, or the account lifecycle in case the bundle lifecycle is not present.
For example: Suppose a prepaid account has a lifecycle of 60 days with bundle, which is subscribed to an Allowance Plan with a monetary type of bucket of 10 United States dollars and a lifecycle of one week.
As per the consumption from the monetary bucket, the value depreciates to 5 United States dollars within the first week.
At the end of Allowance Plan billing cycle, which is after one week, the monetary bucket is again renewed to 10 United States dollars .
•Allowance consumption using AV for a cost bucket : The AV accumulates allowance subscribed to a device by subscribing to the plan with additional allowances.
For example: Suppose a device has two allowance plans with monetary buckets defined in the charging service: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1996Charging User Guide Rating and charging –AllowancePlan1 has Bucket1 with a value of 10 United States dollars .
–AllowancePlan2 has Bucket2 with a value of 20 United States dollars .
AV is configured for bucket accumulation, wherein AV1 and two charging services; CS1 and CS2.
AV would have an accumulation of allowance, that is 30 United States dollars .
Now, a threshold is defined on AV at 50% of allowance consumption, which means whenever AV reaches 50% during the consumption of monetary bucket or allowance, threshold is triggered and a notification is sent to the user.
•BOU applicability on allowance consumption for a cost bucket : The BOU feature is applicable on allowance promotional plan, which means the allowance can be subscribed to a device once that device starts using the plan.
For example: Suppose there is an allowance bundle, which has a monetary type of bucket in the Charging Service with Selection in tariff, is configured with BOU functionality, that is to be activated at the time of session trigger.
Therefore, when the device starts a session, the BOU feature on the allowance bundle is activated for usage for that device.
•Prorating an allowance consumption for a cost bucket : A separate allowance plan can be prorated depending on the day of purchase or activation of the bundle plan.
For example: Suppose there is an allowance bundle, which has a monetary type of bucket of 100 United States dollars in the Charging Service with Selection in tariff, is configured with prorating functionality.
Therefore, when the device subscribes to the allowance bundle on 15th of a month, the prorated amount of 50 United States dollars is adjusted in the monetary bucket.
•Threshold execution on allowance consumption for a cost bucket : Threshold action can be executed on monetary and non-monetary allowances defined in a bundle.
For example: Suppose a device has an allowance plan with a monetary bucket of 50 United States dollars defined and selected in tariff for consumption.
Define a threshold of 50% on the monetary bucket allowance for Send-Notification action.
Therefore, when the device consumes the allowance and the current allowance value is 25 United States dollars , the threshold action is triggered and a notification is sent to the device.
•Applying taxation on allowance consumption for a cost bucket : Taxation can be applied on allowance consumption for a monetary type of bucket.
For example: Suppose a device has an Allowance Plan and a Rate Offer Plan with following tariff configuration: –Rate Offer Plan : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1997Charging User Guide Rating and charging CS1.Pass0 Rating.Rate(Rate0) RATING.Tax-Selection = "Tax1" –Allowance Plan : CS2.Pass0 Rating.Bucket-Selection(MoneyAllowance) Rate0 is only applied to MoneyAllowance and Tax1 of 25% is applied at Rate0 , which means while consuming the MoneyAllowance , an additional tax of 25% can be deducted.
•Applying rate external cost on allowance consumption for a cost bucket : The Rate External Cost can be applied to an allowance plan with a monetary type of bucket.
For example: Define a Rate External Cost of 10 on the main balance.
Therefore, when the device subscribes to the allowance plan with a monetary bucket of 100 United States dollars , allowance is consumed as per Rate External Cost configuration.
In this case, the Moneybkt1 is charged with connection cost of Rate1 and override-cost as 10 in both the following cases: 1.
–Bundle : Allowance Plan CS1.Pass0 RATING.Bucket-Selection=Moneybkt1 –Bundle : MainBalance Plan CS2.Pass0 RATING.Rate-External-Cost=(Rate1,MainBalance,10 ) 2.
–Bundle : MainBalance Plan CS1.Pass0 RATING.Rate-External-Cost=rate1,MainBalance,10 –Bundle : Allowance Plan CS2.Pass0 RATING.Bucket-Selection=Moneybkt1 8.35 Secondary monetary balance NCC allows service providers to have a secondary monetary balance in addition to the main account balance.
The secondary balance gets consumed before the main account balance irrespective of their Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1998Charging User Guide Rating and charging priority.
However, NCC recommends service providers to keep priority of secondary balance higher than main balance.
The secondary balance can be subscribed by a bundle with no tariff/rules/rate application.
The main account balance is consumed only after the secondary balance is completely exhausted.
If either the secondary balance, or main account balance is insufficient to fund the fee, then the fee gets deducted (depending on the Rate granularity configuration and Skip granularity flag settings) from a combination of secondary balance, and main account balance.
Consider the following examples to better understand this feature.
Example 1 : The following figure shows a case where Bob's device has two balances namely main and secondary balance.
On execution of the call, the call cost is covered by consuming the money from secondary balance.
In this case, the secondary balance has sufficient balance to fund the call.
Example 2 : The following figure shows a case where Bob's device has two balances namely main and secondary balance.
On execution of the call, the call cost is covered by consuming the money from secondary balance followed by main balance.
In this case, the secondary balance has insufficient balance to fund the call.
Hence, a combination of secondary and main balance is used for funding the call.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.1999Charging User Guide Rating and charging Note the following important points: •In the secondary balance feature implementation, the exhaustion of secondary balance exhaustion and then usage of main balance depends on the configuration of rate applied on the main balance with specific granularity and skip granularity for low balance configuration.
It also depends on these configurations which may result to some money units remaining in secondary balance and then movement to main balance for consumption.
•The terms "secondary monetary balance" and "secondary balance", "main account balance" and "main balance" are used interchangeably in the document.
•The secondary balance is also known as a cost bucket, that is, money bucket.
To avail this feature, the device/group has to subscribe to a secondary balance bundle.
To create a secondary balance bundle, a service provider has to first create a bucket/allowance limit and then create a charging logic/service with usage_type as secondary_balance with bucket/allowance limit that is already created.
•The cost bucket consumption can be updated in a counter of cost type with Call usage and consumption Type as ALL.
However, the cost bucket consumption cannot be updated in a counter with BOA activation Fee deduction for any consumption Type (All/Account and Bucket).
The Step Fee deductions from the cost bucket can be added in the counter of cost Type and consumption Type as ALL.
•Do not create the secondary balance in the middle of an upgrade.
You can create it when the upgrade is committed, that is, when the SM, ME, and DB upgrade is completed.
•During the BOU bundle activation or consumption from step bucket, if the BOU subscription type or Step subscription type is Device, then only the Device specific secondary balances are considered for BOU Fee and Step fee deduction.
•During the BOU bundle activation or consumption from step bucket, if the BOU subscription type or Step subscription type is Group, then only the Group specific secondary balances are considered for BOU Fee and Step fee deduction.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2000Charging User Guide Rating and charging •A new tag additionalBalanceInfo is added in the CDRs.
The additionalBalanceInfo tag is available only for BOU Activation on commit in SCUR calls and dumps in on commit CDR.
Single CDR, IEC call CDR does not contain this information.
•From the NCC GUI, this feature can be configured using the Balances entity.
Service providers can mention the balance name and secondary balance amount with priority as mandatory inputs.
The applicability condition is optional as per usecases.
When a secondary balance is created from NCC UI front end internally, the following configurations happen: –A charging logic/service is created with Usage_Type as SECONDARY_BALANCE.
–A bucket/allowance_limit is created with secondary balance value as initial value and its name as suffix.
For example, secondary balance as GOLDBALANCE, charging logic/service as GoldBalance, Bucket/ allowance limit as BalanceAllowanceLimit-GoldBalance.
Secondary balance applicability The secondary monetary balance is consumed before the main balance in following cases: •BOU Activation fees : When the BundleOnUse type (only for BOU On Commit) of bundle is activated during a call, the Bundle Activation Fee is deducted from the secondary monetary balance first and then main account balance.
Note the following assumptions considered for secondary balance implementation: –The secondary balance is supported for BOU with activation priority such as ON_COMMIT.
BOU on default or ON_RESERVATION is not supported for BOU Activation fee deduction from the secondary balance.
–If the BOU fee reservations are done by multiple devices, then the BOU bundle is activated when any of the device commits the reservation.
–If the BOU fee reservation is done from a low priority secondary balance bucket, and a high priority secondary balance bucket is renewed/Get Balance through Update bucket Instance API before the CCR-U, all the balance in high priority bucket is consumed first, and the reservation of low priority bucket is cancelled.
–The BOU Activation fee feature supports accumulation in a counter only for the configuration when the Consumption Type is ALL.
But, in case of secondary balance feature, whenever a BOU Activation fee is deducted from the secondary balance, irrespective of whether the Consumption Type is ALL, the counter is not accumulated.
The BOU Activation fee deducted from secondary balance with any Consumption Type is not supported.
–The BOU fee gets committed from where it has been reserved when BOU1 and BOU2 activation fee have been reserved from different resources (Account/Secondary Balance).
–When USU=0, then the reserved activation fee is reverted back and BOU is not activated.
•Step fees : The Step fee is deducted for the step up of a step-bucket from the secondary balance.
Once the secondary balance is exhausted, the main balance is consumed.
Note the following points related to the step fee reservation: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2001Charging User Guide Rating and charging –If the step fee reservation is done from a low priority secondary balance bucket, and a high priority secondary balance bucket is renewed before the CCR-U, the balance in high priority bucket is consumed, and the reservation of low priority bucket is cancelled.
–If the step fee reservation is done from the Account's previous values and on commit, the secondary balance has sufficient balance (Renew/Get Balance through Update bucket Instance API), then step fee is deducted from the secondary balance rather than Account's previous values and the reservation of account (from previous values) is cancelled.
–If the step fee reservation is done from both secondary balance and Account, then during Audit, step fee is canceled in the reserve order, that is, first from Account and then from secondary balances.
•Call usage : If a device has a secondary monetary balance, then during a call, the secondary balance is consumed first.
Once the secondary balance is exhausted, the main balance is consumed.
When a secondary balance is used as a resource, it uses the tariff (rate/tax) applied on the main balance.
The secondary balance is consumed before the main balance irrespective of the priority of the secondary balance charging service.
The secondary balance behavior is same as main balance.
The secondary balance is considered for call usage deduction only when rate is directly applied to the main balance, that is, Rate as rating action in Tariff.
NCC offers many other types of call rate applications/no other type RATE action, that is, threshold-Rate/Threshold-NextRate/NextRate (split charging) are applicable for call cost deductions from secondary balance.
•Rates : For normal rate, or any special rate applied for the consumption of a call request, the secondary balance is consumed before main balance.
Rate with a specific rate rounding factor can be applied in the tariff plan, and the rounded cost is deducted from the secondary balance before the main balance.
The external rate can also be applied to the secondary balance as per its behavior in the current NCC system.
The cost received as external rate gets deducted from the secondary balance first and then the main balance.
•Discount : When the discount is applied on the step up fee and call usage, the discounted cost is deducted from secondary balance first and then the main balance.
The discount for the call cost is the Call-Discount applied on the charging logic tariff.
For example, RATING.Call-Discount = 50.
•Taxation : When the taxation is applied on the rate of a call request, the tax added on the call cost is deducted from the secondary balance before the main balance.
Notes for feature implementation Attention : The following points are considered for implementation of the secondary balance feature: •The Step Fee deductions from the cost bucket can be added in the counter of cost Type and Consumption Type = ALL.
•Discount is applied based on the value of Use all step first parameter as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2002Charging User Guide Rating and charging –When Use all step first = true , then if the discount bundle priority configured is less than step bucket, then discount is not applied.
If the discount bundle priority configured is more than step bucket, then discount is applied.
–When Use all step first = false , then it depends on the configuration of discount at pass level, irrespective of discount bundle priority.
If the discount is at pass0, when the step is parsed at step2, and pass is at pass1, then discount is applied irrespective of bundle priority.
This is because, the step2 is always parsed after discount, thus discount gets applied.
•When the step bucket and main/secondary balance get considered at the time of call consumption, then connection cost is not considered.
•CDRs for secondary balance are logged only at CCR_U/T for StepCommit = TRUE.
See CDR/EDR Reference guide for more details.
•AV is not supported for secondary balance in case of free deduction.
•The secondary balance can be subscribed by a Device or Group through Bundle and the Charging logic can contain only a single MONEY BUCKET as a secondary balance.
This charging logic must have no tariff/rate and no thresholds applied to it.
•The secondary balance do not have tariffs/passes/rate directly applied to the secondary balance configuration.
•Multiple buckets cannot be defined for the secondary balance which are of Money type only.
•Any type of counters should not be configured to accumulate consumption from the secondary balance.
•Virtual policy counter is not supported with the secondary balance.
•The BOU Bundle Activation Fee deducted from the secondary balance cannot be accumulated in the counters.
•Any type of counter or spending limit must not be configured on the cost bucket.
If the cost bucket is configured with a counter or spending limit, it does not accumulate the following: –Call cost to be deducted from the secondary balance (cost bucket).
–BOU Activation Fee deducted from the cost bucket upon the activation of BOU bundle.
–Discount over Step Fee/BOU Activation fee deducted from the cost bucket.
–Step-Up Step Fee from the cost bucket while consuming the step bucket in the call request.
–Call cost applied by the special rate deducted from the secondary balance.
•Any limit/threshold with hard-stop, and soft-stop must not be configured over the secondary balance.
•Throttling QoS, and Send SNR use cases must not be configured on the secondary balance.
•Any kind of spending limits/session limits or multi-bundle counter limits in different features are not considered to be evaluated for secondary balance/cost bucket consumptions.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2003Charging User Guide Rating and charging •Threshold/Limit with a Notification-Continue action can be applied only to the secondary balance in which the consumption notification can be received by the device having the secondary balance bundle.
This type of use of threshold to send notification when money bucket/secondary balance is exhausted, that is, threshold at 100%, can be configured using REST (not through NCC UI) only.
Threshold is not applicable to any secondary balance/bucket.
•Split charging, Next-Rate/surcharge, pre-rating simulation, and application of granularity with or without step features cannot consume from the secondary balance (cost bucket).
•In a tariff rule configuration, a rate can be applied without any target.
It is known as the global rate.
However, it is restricted to be used with the secondary balance.
NCC supports another feature Cost Bucket: As additional balance for call usage through tariff rules on page 1990 .
It is recommended to use either the secondary balance feature or the other cost bucket feature.
Both cannot be operational together.
•Currently, taxation can be applied over the Step-Up fee.
However, the use cases to charge the Step- Fee or BOU activation fee from the secondary balance must not configure the taxation feature on fee deductions.
Taxation cost on fee cannot be deducted from the cost bucket.
•The fee deductions that are not supported from the secondary balance are as follows: –Bundle Fee, Renewal Fee, Fee Override, Lifecycle Action with Fee and Override Fee, Charge Fee Action, Renew subscription/account with Fee Action, Prorate with Fee activation and refund.
–Fee with any APIs is not deducted from the secondary balance.
•BOU activation fee can be deducted from the secondary balance but discount cannot be applied on it.
•Any debit operation API, for example E-commerce APIs, debit APIs on the main balance cannot be deducted from the secondary balance.
•The BundleOnUse and Step-Up logic are applicable for reservation, commit, and default.
However, for this feature only step up at commit and BOU at commit are supported.
•Split charging functionality is not supported for the secondary balance.
•Rate as per threshold and split charging with next threshold rate feature (ThresholdRate/ Threshold.NextRate) is not supported for the secondary balance.
•The secondary balance bundle, that is, a bundle containing a secondary balance charging logic with a money bucket cannot be subscribed as a BOU bundle.
•The secondary balance bundle, that is, a bundle containing a secondary balance charging logic with a money bucket cannot be subscribed as a Step Up bundle.
The secondary balance cannot be a tiered allowance or a step up bucket.
Configuration Note the following important points related to secondary balance configuration: •To avail a secondary balance, service provide must create a bundle which is a secondary balance.
This bundle must contain a charging logic (charging service) which is configured as a type secondary balance .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2004Charging User Guide Rating and charging •Service provider must create a charging logic with ENUM as usageType:"SECONDARY_BALANCE" with a single money bucket.
NCC determines the resource in this charging logic as a secondary balance.
Note that this resource must be a Money type bucket only and do not have any charging tariff plans.
•The bundle contains a charging logic of type Secondary_Balances.
This charging logic can have an applicability condition and priority across charging logic.
•The charging logic contains only a single money type bucket.
•This charging logic does not contain definition of any tariff/charging rules/pass/multi-pass/fall back rules.
•There is no selection of this Money Type bucket anywhere in the rule configuration.
Perform the following steps to create a secondary balance: 1.In the Charging configurator, create a secondary balance.
Note that you must PUBLISH the record to an ME.
Figure 112: Secondary balance 2.Create a charging logic (charging service) using API with ENUM as usageType:SECONDARY_BALANCE with a single money bucket.
NCC determines the resource in this charging logic as a secondary balance.
Note : A single money type of bucket can be added in this charging logic without threshold and counter.
When a charging logic is created using GUI, a bucket is automatically created.
However, while provisioning through API, a bucket definition must be created first and then a charging logic of secondary balance type must be created.
3.Create a bundle (services) that contains a charging logic (charging service) of type secondary_Balance.
This charging logic can have applicability condition and priority.
The charging logic contains a single money type bucket.
No tariff or charging rules or pass or multi-pass or fall back rules are defined in this charging logic.
You can select the secondary balance under the Logics option.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2005Charging User Guide Rating and charging Note : •The secondary balance (cost-bucket) is applied based on the charging service priority, and applicability conditions.
Secondary balance bundle is of the highest priority but with no Pass/ Tariff rules.
•Cost buckets must respect the priority of the bundles with rates, step buckets, and BOU Activation Fee.
•The cost bucket follows the lifecycle of the bundle.
Examples Case 1: BOU Activation Fee is charged from the secondary balance for parallel calls of device In this case, the BOU activation fee gets deducted successfully when the Device1 reserves BOU fees from the secondary balance, but the commit for Device2 comes prior to the Device1.
Following is the configuration needed for this use case.
1.Enable the application preferences - BOU Activation Priority, BOU Activation Fee enabled for CDR, Granularity skip for low balance, and EDR Generation Flag.
2.Create a periodic lifecycle for BOU Bundle with Charge Fee Action Success event, Account Reservation Success event, and Account Commit Success event.
3.Create a CS1 having secondary balance of SB15, cost bucket value of 15, and priority as 1.
4.Create an Allowance Limit of type Byte with a value of 100 Bytes.
5.Create a CS2 having a Data Allowance Limit of value 100 Bytes.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2006Charging User Guide Rating and charging 6.Create Bundle1 having Secondary Balance of SB15.
7.Create Bundle2 having CS2 with bundle fee as 10, Activation Type as On Use , Activation Fee of 15, and Activation Event as CallActivationEvent .
8.Create an Account with Balance of 100.
9.Create a device D1, and device D2 with the Subscription Index as Group.
10.Attach the Bundle1, and Bundle2 to the Group.
11.Attach Device D1, and Device D2 to the Group.
Configure the following ME application preferences: •Set BOU Activation Priority to ON_COMMIT .
•Set BOU Activation fee enabled in CDR to true .
•Set GRANULARITY SKIP FOR LOW BALANCE to true .
•Set EDR Generator Flag to true .
Note : For details on configuring the ME application preferences, see Managed Elements section in Global Configuration Guide .)
Following is the Group Overview which shows that the Group has two devices attached to it.
The Secondary balance bundle has 15.00 Money in it and a BOU bundle has a data bucket of 100 Bytes.
The state of the BOU bundle is PreActive.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2007Charging User Guide Rating and charging When a call is executed (SCUR-I) from Device1 with RSU=10, then the BOU Activation Fee of 15 is reserved from cost bucket.
The value of cost bucket becomes 0.
The value 10 is reserved from the allowance limit.
The BOU bundle state is still PreActive as the fee is not yet deducted.
When a call is executed (SCUR-I) from Device2 with RSU=20, the reservation is done from data bucket only.
The BOU Activation Fee is not reserved since its already reserved from Device1.
The total reservation is D1(10)+D2(20) = 30, and allowance limit = 70.
When SCUR-U is received for Device 2 with USU=20, RSU=5, then it commits 20 units and the activation fee also gets committed.
The BOU bundle state becomes Active The total reservation is D1(10)+D2(5) = 15, allowance limit = 65(80-15).
When the SCUR-U for Device 1 is received with USU=10, RSU=10, it commits 10 and reserves 10.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2008Charging User Guide Rating and charging When the SCUR-T for Device 1 is received with USU = 20, it commits 20 units.
SCUR-T for Device2 is received with USU = 10, it commits 10 units.
The commits happen from the data bucket.
Following is the result of this use case: 1.At SCUR-I for Device1, the Activation fee is reserved from the secondary balance.
2.At SCUR-U for Device2, the Activation fee is deducted from the secondary balance.
3.The BOU bundle gets activated on Commit and the periodic state is changed from PreActive to Active .
Case 2: Secondary balance is charged for Step Fee deduction on Step up before charging from the main balance •Create a rate object as follows: Name = RatePS , RateType = Byte , Granularity Level = Byte, Cost/Quantity = 3/1 B, Step Size = 0 KB, Connection Cost = 2.
•Create two step buckets having the following values: Name = stepbucket1, step1 = step size 20, step2 = step size 12 and step fee 7, step3 = stepsize 6 and step fee 8, step4 = stepsize 6 and step fee 5 .
Name = stepbucket2 , step1 = step size 12, step2 = stepsize 6 and step fee 8, step3 = stepsize 6 and step fee 5.
•Create three charging services (CS).
CS1 should have a step bucket (stepbucket1) applied at pass0 with a priority of 3000.
Step bucket is picked based on the 3GPP_GGSN_MCC_MNC value.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2009Charging User Guide Rating and charging •CS2 (CSStepBucketwithMainBalance) should have a step bucket (stepbucket2) along with the main balance.
StepBucket2 is applied at pass2, and the main balance is applied in another branch of pass2 with a priority of 20000.
•Create a secondary balance (SB) with the value of money as 50, and priority as 200.
•Create three bundles (bundle1, bundle2, and bundle3) having CS1, CSStepBucketwithMainBalance, and secondary balance (SB) respectively.
•Create an account, and device object.
•Create a group object having three subscriptions with all the three bundles.
•Set the application preference Step-Up On Commit to true.
8.36 Mapping device location to location policy counter status Overview This feature supports mapping the MCCMNC location of a device to a policy counter status associated with the Location Policy Counter ID of a device.
This mapping includes the following capabilities: •An MCCMNC can be directly mapped to an external location policy counter status value (for example, HOME for MCCMNC values considered to be within a user network).
•An MCCMNC can be mapped to a bundle name (this is expected to be used for TravelPass BOU bundles).
In this case, if the bundle is currently available for the device (for example, in the Active or Pre-Active state), then the policy counter status is used for the current location policy counter status.
Otherwise, if the bundle name is not currently available for the device, then a globally configured value for roaming should be sent (for example, ROAM ).
•If there is no entry in the table for the current MCCMNC of a device, then the globally configured value for roaming (for example, ROAM ) must be used as the location PC status for the device.
Previously, this feature supported only a single global table mapping MCCMNCs to a fixed bundle name.
Currently, the feature is enhanced to support mapping of MCCMNCs to multiple bundles associated with different price plans.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2010Charging User Guide Rating and charging The same MCCMNC location of a device can be mapped to separate policy counter status values associated with the Location Policy Counter ID of the device.
For example: If the device is in location1 and subscribed to bundle1 , then the location policy counter Id status can be TP2.
If the device is in location1 and subscribed to bundle2 , then location policy counter Id status can be ROAM (If location1 is mapped only for bundle1 but not bundle2 ), based on configuration.
Note : If the device has multiple bundles ( Base-Plan or TravelPass ), then the bundles should not have a common location.
If multiple bundles with common locations are provisioned to the same device, then the policy counter status configured in the bundle with higher priority is considered.
Configuration The following rules should be configured to map the location information to local policy counter status and roaming status.
BUNDLE.Roaming-Status and BUNDLE.Location-Counter-Status : Note : For details on Roaming-Status and Location-Counter-Status attributes, see BUNDLE result context on page 1263 .
Alternatively, the location information can be mapped to location policy counter status and roaming status using the following configuration (that is, configuring complex mapping table, CALL_COMMON.Get-Match- String attribute, and GY_POST_PROCESSING ruleset): CALL_COMMON.Get-Match-String Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2011Charging User Guide Rating and charging Note : For details on Get-Match-String attribute, see CALL_COMMON source context on page 377.
GY_POST_PROCESSING ruleset Figure 113: GY_POST_PROCESSING ruleset Note : If location policy counter status is fetched using BUNDLE rule (that is, through BUNDLE rule configuration for all bundles), then configuring GY_POST_PROCESSING ruleset is not required.
Complex mapping table: Figure 114: MCCMNC mapping table Figure 115: Policy counter status mapping table Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2012Charging User Guide Rating and charging Note : One of the two configuration methods can be selected to configure the mapping of device location to location policy counter status and roaming status.
Hybrid configuration is not recommended.
For the preceding figure, consider the following steps: 1.The MCCMNC of a device can be directly mapped to an external Location Policy Counter Status value.
For example, HOME for status value, which is considered as a user's own network.
2.If preceding directly mapping is empty, then use the MCCMNC of a device for mapping to multiple bundle names.
For example, current applicable bundle name is Travelpass-List .
Note : When multiple bundle names are configured in a complex mapping table, ";" should be used as the delimiter instead of ",".
3.If the bundle is currently available for the device and it is in the Active or Pre-Active state, then the PC status defined in the table is used for the current Location Policy Counter Status , and if these complex mapping tables are used in BUNDLE rule, then Roaming Status can also be fetched from the table.
4.If the bundle name is not currently available for the device or it is not in the Active or Pre-Active state, then a globally configured value for roaming should be used as the location policy counter status, for example ROAM .
5.For the preceding steps, if there is no entry in the table for the MCCMNC of a device, then the globally configured value for roaming (for example, ROAM ) must be used as the location PC status for the device.
6.After checking the preceding steps, it checks whether the new Location Policy Counter Status is same as the current stored Location Policy Counter Status of a device.
If not, then send an SNR with new Location Policy Counter Status ; but if yes, then there is no need to send an SNR.
Following are the supported call types: •Gy •IMS •Event •5G 8.36.
1 Update location for 5G and VoL TE MO call Update location for 5G calls Previously, the stored location of the device was updated based on the MCC and MNC values included within the eutraLocation IE in an N40 transaction received from a network.
Currently, nrLocation IE in an N40 transaction is prioritized over eutraLocation IE to update the stored location of the device.
When a 5G call is received, the stored location of the device is updated based on the following conditions: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2013Charging User Guide Rating and charging •If the nrLocation IE (ChargingDataRequest->pDUSessionChargingInformation->userLocationinfo- >nrLocation->ncgi->plmnId ) is present in the N40 transaction with non-zero MCC values, then the stored location of the device is updated based on those MCC and MNC values.
•If the nrLocation IE is either not present in the N40 transaction, or it does not contain non-zero MCC values, and if the eutraLocation IE (ChargingDataRequest->pDUSessionChargingInformation- >userLocationinfo->eutraLocation->ecgi->plmnId ) is present in the N40 transaction with non-zero MCC values, then the stored location of the device is updated based on those MCC and MNC values.
Configuration This feature is controlled by the application preferences Location Update Enhancement and Store location updates .
If Store location updates is set to true , and Location Update Enhancement is set to NCGI_SUPPORT_WITHOUT_UPDATE_TZ , then nrLocation IE is prioritized over eutraLocation IE to fetch the stored location details of the device (that is, the stored location details of the device are fetched first from the nrLocation IE).
If Location Update Enhancement is DISABLED , then the stored location details of the device are fetched from eutraLocation IE.
When a 5G call is received, following AVPs are checked: 1.userLocationInformation AVP (under PS information group AVP), which stores the exact user location and MCC MNC extracts from this AVP.
This AVP is mapped with 5G request parameter PDUSessionChargingInformation or userLocationInfo .
If the application preference Location Update Enhancement is set as NCGI_SUPPORT_WITHOUT_UPDATE_TZ , then nrLocation ncgi of userLocationInformation is checked for stored location details of the device, else eutraLocation ecgi of userLocationInformation is checked.
2.3gpp-ms-timezone AVP (under PS information group AVP), which stores the UE timezone.
This AVP is mapped from 5G request parameter PDUSessionChargingInformation or uetimezone .
The timeZoneId , sgsnMccMnc , and userLocationInfo attributes for 5G call, check each request message for location update, not only those request with user_location_update trigger type.
If the application preference Location Update Enhancement is set as NCGI_SUPPORT_WITHOUT_UPDATE_TZ , the device location is updated, and the 3gpp-ms-timezone AVP is not received, then the timezone stored in device is not cleared.
Note : When this feature is enabled, and if the MCC and MNC values of the device are updated from an N40 transaction which does not contain ueTimeZone IE, then the ueTimezone information of the device is not cleared while processing N40 transactions.
The ueTimezone information of the device is updated while processing N40 transactions only when a new ueTimezone is received from the network.
It can be cleared during Gy or Ro processing.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2014Charging User Guide Rating and charging Update location for VoL TE MO call When a message is received for VoL TE MO call, following AVPs are checked: Location updates received in VoL TE CCR-I transactions and VoL TE CCR-U updates with a location change trigger, which includes an Access-Network-Information AVP with an access-class header with a value of 3GPP-GERAN should have the ULI in the ANI used to update the MCCMNC and ULI for the device.
When this feature is enabled, ANI information received in VoL TE transactions without an access-class header of 3GPP- GERAN is not used to update the stored location information of a device.
1.Geo Location Type : RATType3Gpp.GERAN 2.User Location Id : cgi3gpp -> format : MCC MNC LAC CI -> length : 13 or 14 (MNC 2 or 3) 3.Identity Type : AccessInfoType.CGI 8.36.2 Actions associated with Location Policy Counter ID Action Description update/ update Location Policy Counter/ Device Used to add, update, or delete the Location Policy Counter ID in device entity based on global definition by providing the mandatory parameter Device ID .
For more information on Location Policy Counter ID and Location Policy Counter Status , refer to section Managed Element application preferences in the Global Configuration Guide .
8.36.3 Geographic location type mapped with database value The Geographic-Location-Type is set based on the location information extracted from the received AVPs or IEs.
The total location object is stored in the database.
The supported geographic location types are listed in the following table: Geographic location type Type code Value saved in database CGI 0 0Table 219: Geographic location type mapped with database value Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2015Charging User Guide Rating and charging Geographic location type Type code Value saved in database SAI 1 1 RAI 2 2 TAI 128 3 ECGI 129 4 TAI and ECGI 130 5 NCGI 135 7 5GS TAI 136 8 5GS TAI and NCGI 137 9Table 219: Geographic location type mapped with database value (continued) Note : •For VoL TE call, the geographic location type RATType3Gpp.GERAN is mapped to CGI.
•For 5G call, if the stored location is fetched from eutraLocation IE, then the geographic location type is ECGI , and if the location is fetched from nrLocation IE, then the geographic location type is NCGI .
8.37 Slice management 8.37.
1 Dynamic slicing Dynamic slicing allows the operators to organize the networks to efficiently address different use cases.
It also allow the operators to design, deploy, customize, optimize the network slices running in the network, and dynamically allocate network resources that can maximize customer value; thus, increasing revenue opportunities.
Operators can distribute the network slices quickly on demand.
These slices can support the 5G’s network requirements for bandwidth, throughput, latency, and availability that provides opportunities for use cases such as IoT, smart cities.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2016Charging User Guide Rating and charging In NCC, for dynamic slicing, the dynamic quota algorithm provides a mechanism to allocate the right quota size for a reasonable amount of time.
This approach avoids blocking of quota for sessions not using it.
For centralized charging, when the call controller receives a network request with an empty RSU from the Packet Data Gateway (PGW), then depending on the different parameters specified in the charging system such as resources, different RAT type, heavy user, light user, medium group, large group, the slice size is computed accordingly.
The quota allocation can be provided to both group and individual resources of prepaid or postpaid accounts.
Both static and dynamic quota allocation can be provided based on the customer network.
The different quota allocation algorithms are available such as BASIC_ALGO , BUCKET_ALGO , DYNAMIC_ALGO , or DYNAMIC_ALGO_2 .
See Dynamic slicing algorithm configuration and variants on page 2018 for different variants available in NCC.
Note : •It is not recommended to configure the DefaultAction with Algo-Name .
However, if configured, then the Algo-Name is ignored.
•It is not recommended to configure VT as 0 in the quota management profile (slicing profile) entity rule.
If VT is configured as 0, then it is not considered as NOK scenario and the final value is read from the quota management profile (slicing profile) entity, bypassing the processing of DefaultAction .
8.37.
1.
1 Computation of dynamic slice output The following figure provides details on how the dynamic slice size gets computed.
Figure 116: Dynamic slicing NCC receives a Gy request with an empty RSU.
NCC considers this as a centralized call and uses the algorithm configured in the quota management profile (slicing profile) or the defined static values to Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2017Charging User Guide Rating and charging calculate the slice size.
The name of the quota management profile (slicing profile) is present in the application preference Default Dynamic slicing profile .
The quota management profile (slicing profile) uses the following three kind of inputs to compute the dynamic quota: •Gy AVPs with group type such as RAT, rating group.
•Specific algorithm with input parameters.
•Selection of quota allocation algorithm.
Along with the quota management profile (slicing profile) inputs, the OCS static data such as tariff, defined milestones (thresholds) are sent as input to the rule engine.
The rule engine with the help of three main components namely past usage pattern of the device, bucket, and algorithm engine, computes the dynamic quota slice.
8.37.
1.2 Dynamic slicing algorithm configuration and variants Dynamic algorithm calculates the slice size to be given to a device.
The subsequent sections provide information on the configuration, different approaches followed for slice computation such as quota management profile (slicing profile), dynamic algorithm, and parameterized dynamic algorithm (DYNAMIC_ALGO_2 ) used to calculate the slice size.
Important : It is not recommended not use slice reduction along with DYNAMIC_ALGO or DYNAMIC_ALGO_2 because slice reduction is itself an algorithm, which reduces the slice size based on upcoming Threshold.
However, if configured together, the behavior might change and it may lead to unexpected results.
Configuring the dynamic slicing functionality Configure the desired algorithm in the Quota Management Profile entity in the SM GUI to configure the dynamic slicing functionality.
Note : •It is recommended not to configure the DefaultAction with Algo-Name .
If configured, then the Algo-Name is ignored.
•It is recommended not to configure VT as 0 in the quota management profile (slicing profile) entity rule.
If VT is 0, then it is not considered as NOK scenario and the final value is read from the quota management profile (slicing profile) entity, bypassing the processing of DefaultAction .
If you want to customize the minimum and maximum slice size values using the Select-Algo parameter, which is available for the DYNAMIC_SLICE ruleset that allows you to select the DYNAMIC_ALGO_2 and contains the following three parameters: •Algo-Name : Currently, only DYNAMIC_ALGO_2 is supported, which is not case sensitive.
•Min Slice : It is an optional parameter, which indicates the minimum slice to be provided.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2018Charging User Guide Rating and charging •Max Slice : It is an optional parameter, which restricts the size of slice from algorithm.
The max value up to 9223372036854775807 is supported for Max slice value.
If both Min Slice and Max Slice are not configured, then the DYNAMIC_ALGO_2 algorithm behaves as DYNAMIC_ALGO .
If customization to the slice size is not needed, then you can select either DYNAMIC_ALGO , BASIC_ALGO , or BUCKET_ALGO using the DYNAMIC_SLICE.Algo-Name in the ruleset.
Quota management profile (Slicing profile) This is the basic default configuration that is easy to use and covers most common cases.
In case of centralized charging, rules are defined to calculate the exact value to be used in the dynamic quota management profile (slicing profile) and these rules contain algorithms that calculate the dynamic quota slice.
The rules defined in the quota management profile (slicing profile) entity provide flexibility to configure the dynamic slicing parameter based on different configuration.
The quota management profile (slicing profile) entity is not created at the time of NCC installation and has to be configured.
The default quota management profile (slicing profile) name must be created with dynamic profile name configured in the application preference Default Dynamic slicing profile .
You can modify the application preference and change the default name default_profile to a new name.
Rules defined in the quota management profile (slicing profile) have the highest priority.
They are checked one-by-one and the first rule to satisfy the condition is picked up for processing.
These inputs are available in the Dynamic Slice context in the quota management profile (Slicing profile) entity.
Rules define the slice based on the applicability condition and context.
The rules in dynamic quota management profile (slicing profile) contain the dynamic slicing algorithm configured to calculate the dynamic slice size or dynamic network parameters, such as Validity Time (VT) or Quota Holding Time (QHT).
The applicability condition may use Radio Access Type (RAT) and device ID derived from AVPs.
For example, we can either have a slicing algorithm or a rule for 2G smart phones and IoT devices, 3G smart phones and IoT devices, and 4G smart phones and IoT devices.
The context can be source context, bucket context, group context, device context, and session context.
Note : VT defines the time for which the dynamic quota remains active in the network, thus controlling the effective allocation of resources.
QHT defines the time for which the call session remains in the idle state.
Once QHT expires, the network reports back the usage and gets a new dynamic quota allocated.
Types of dynamic slicing algorithm Following are the types of dynamic slicing algorithm: •BASIC_ALGO : The basic algorithm does not consider any dynamic values.
This algorithm returns the static values - Slice Size = 2000, VT = 35, and QHT is Null.
•BUCKET_ALGO : This algorithm considers only the first bucket value if the current bucket value is greater than or equal to the value preconfigured in the algorithm.
For example, if Slice Size = Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2019Charging User Guide Rating and charging 1000, then the algorithm returns Slice Size = 1000, VT = 30, QHT is set as Null.
Else, if the current bucket value is less than the slice size, it returns the default slice size preconfigured in the quota management profile (slicing profile).
•DYNAMIC_ALGO : This algorithm computes the dynamic slice depending upon the group type, maximum number of devices in group, validity time, and other inputs.
Parameterized dynamic algorithm DYNAMIC_ALGO_2 The DYNAMIC_ALGO_2 algorithm facilitates operators to avoid the following situations by providing two configurable parameters, Minimum Slice Size and Maximum Slice Size .
•Consider that an active session is using a bucket and when the bucket current value reduces such that 20% of volume is available, then algorithm computes very small slices which leads to high TPS in the network.
To avoid this situation, minimum slice size can be used.
•There may be device starvation when a session with low volume consumption blocks its reserved volume data while the second session with higher volume consumption uses up its Granted Service Unit (GSU).
To avoid this situation, maximum slice size can be used, which allows capping the maximum slice for the sessions.
The DYNAMIC_ALGO_2 uses the DYNAMIC_ALGO to calculate the slice size and provides flexibility for operators to configure two additional optional parameters, Minimum Slice Size and Maximum Slice Size configured in the quota management profile (slicing profile) rule.
It ensures that the calculated slice size is in between minimum and maximum slice size configured.
This algorithm is same as DYNAMIC_ALGO with an addition of two configurable minimum slice size and maximum slice size parameters.
The value slice size is set based on the configurations made: •If you configure only the Minimum Slice Size with DYNAMIC_ALGO_2 , then the default value for Maximum Slice Size is the total volume of the bucket.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2020Charging User Guide Rating and charging •If you configure only the Maximum Slice Size , then the value of Minimum Slice Size is zero.
•If you configure the Minimum Slice Size greater than Maximum slice size or Minimum Slice Size equal to Maximum Slice Size , then the configuration is considered as invalid and algorithm performs the following actions: –Does not compute the slice size but returns the static slice size, if configured in the same rule –Otherwise, static slice configured in the quota management profile (slicing profile) entity is returned The following figure shows an invalid configuration where the Minimum Slice Size is greater than the Maximum Slice Size .
In this case, the DYNAMIC_ALGO_2 is not executed and the static slice size defined in the rule, which is 20 in the current case is returned.
•Following is the valid configuration for Minimum Slice Size and Maximum Slice Size : –Minimum Slice Size must be less than the Maximum Slice Size .
–Both the Minimum Slice Size and Maximum Slice Size must be greater than zero Example : Minimum Slice Size = 10 and Maximum Slice Size = 200 is a valid configuration.
The algorithm does not compute slice size more than bucket total available balance.
For cases where the bucket available balance is less than Minimum Slice Size configured, the bucket available balance is returned and not the Minimum Slice Size .
Note the following points: •For the idle sessions where a Payment Gateway reports its usage as zero by sending USU zero in update request (CCR-U), the DYNAMIC_ALGO_2 returns the Minimum Slice Size configured.
•For the idle sessions where a Payment Gateway reports its usage as zero by sending USU zero in update request (CCR-U) and DYNAMIC_ALGO is configured, then the DYNAMIC_ALGO returns the static slice size configured in the rule or static slice size configured in the quota management profile (slicing profile) entity.
The following figure shows the configuration of static slice size in the rule.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2021Charging User Guide Rating and charging Attention : The maximum and minimum slices can increase the Transactions Per Second (TPS).
Therefore, it is recommended to configure the algorithm to its best optimized parameters.
See the Additional information on page 1535 for important points related to quota management profile (slicing profile) parameters.
8.37.
1.3 Dynamic quota algorithm priority The following shows the order in which the quota is allocated based on the slicing algorithm.
The highest priority is given to the dynamic quota based on the rule action.
That is, whenever a rule is defined, it is given the highest priority and the algorithm associated is executed, therefore, that slice is computed.
The next priority is given to the default rule action in which the static quota is provided.
This is followed by the quota management profile (slicing profile) in which the static value is defined in the quota management profile (slicing profile) entity.
8.37.
1.4 Dynamic algorithm parameters Following are the parameters for the DYNAMIC_ALGO algorithm.
Parameter Description Usage of device This parameter decides the slice size for a device.
It is derived from the speed by which data is consumed by the device with respect to time.
For example, if one device consumes 10 MB in 10 minutes gets bigger slice size than the device which consumes 10 MB in 30 minutes.
There are two ways by which resources are allocated.
They are as follows: •Group subscription : The slice size is calculated by considering the usage of device ( for a particular MSCC) with respect to the complete usage of all the devices ( of all MSCCs) of same group.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2022Charging User Guide Rating and charging Parameter Description •Device subscription : Diameter call from a device comes for different rating groups or MSCCs.
The device usage for different MSCCs is tracked separately.
The slice size for a call for one MSCC is calculated by considering the usage of the device for all other MSCCs.
Note : The data stored in for Dynamic Past Usage of devices related to rating group gets cleared when the device is removed from NCC.
Bucket milestones Milestone ( Threshold) defined at bucket to restrict the slice computed and send Adaptive RARs.
Milestone is a percentage threshold applied on bucket with dynamic milestone flag set to true and empty rule container in the Threshold Profile Group.
Milestone ensures that the slice size should not be completely calculated on the device usage only.
If the slice size gets calculated completely based on device’ s usage and the usage of device is fast, then other devices in the group cannot get slice for usage.
If the consumption of bucket is about to reach a milestone, then to avoid deprivation of slices to other devices in the group, the algorithm reduces the slice size of device even if the usage of device is fast.
Note the following important points related to the bucket milestones parameter: •If a milestone ( threshold) is configured, then the milestone ( threshold) is crossed when the committed ratio is less than or equal to milestone and commit and reservation ratio is greater than or equal to milestone and error range ( 1%).
Milestone crossed = committed ratio <= milestone and committed ratio + reservation ratio >= (milestone + error range (1%)) Committed ratio = ( Bucket initial value - Bucket unused value) / Bucket initial value.
Bucket unused value means bucket balance without reservation.
Committed ratio + reservation ratio = ( Bucket initial value - Bucket current value) / Bucket initial value.
Bucket current value means bucket balance with reservation.
•If a milestone is not configured with quota management profile ( slicing profile) , then a default milestone of 100% is considered.
The milestone is crossed when the committed ratio is less than milestone and commit and reservation ratio is greater than or equal Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2023Charging User Guide Rating and charging Parameter Description to milestone.
The error range is not considered in this case of 100% milestone.
Milestone crossed = committed ratio <= milestone and committed ratio + reservation ratio >= milestone Validity time of a session A configurable time of the session validity and one of the key parameter for reducing the slice size to avoid slice deprivation conditions.
Consider that a slice size calculated for a device by the algorithm can be consumed in x hours.
This slice size is adjusted based on the Validity Time of the session of the device.
For example: Consider the slice calculated as per device characteristics is 100 MB.
It gets consumed in 4 hours by the device.
But the validity of session for that device is only 2 hours.
Therefore, slice size is adjusted according to 2 hours of consumption of device rather than 4 hours.
Reduction of slice size on the basis of validity time is a part of post calculation of algorithm.
Number of lines ( N) Line represents the Devices with rating group, that is, the number of lines represents the number of devices with rating groups in a group that share a group resource.
For example, if there are 4 devices in a group and each device creates two sessions each from two different rating groups, then the number of lines is 4 * 2 = 8.
Even if the number of devices in a group is different than the maximum number of lines in quota management profile ( slicing profile) , the number of lines mentioned in quota management profile is considered in the slice size calculation.
It does not consider the number of devices that exist in a group.
For example, consider that there is a group with 10 devices and the maximum number of lines in quota management profile ( slicing profile) is mentioned 15.
Then, for algorithm, the number of devices consuming from group resource is 15 and not 10.
Note : Bigger the value of N, smaller the slice that gets allocated to the devices in a group.
The DYNAMIC_ALGO_2 has the following optional parameters in addition to the parameters listed in the preceding table.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2024Charging User Guide Rating and charging Parameter Description Min Slice Size Max Slice SizeMin Slice Size and Max Slice Size parameters are available in the quota management profile ( slicing profile) entity.
An input to the algorithm from the rule that is used to ensure that the slice size calculated is within the min and max slice size range.
If the Min Slice Size is y and the calculated slice size by algorithm is x, then x is always greater than or equal to y.
If the Max Slice Size is z and the calculated slice size by algorithm is x, then x is always less than or equal to z.
Note : The Min Slice Size and Max Slice Size are optional parameters used only for DYNAMIC_ ALGO_ 2.
For dynamic algorithm parameters used in quota management profile (slicing profile), see Slice reduction on page 2031 .
Note the following points: •The dynamic slice calculation considers that the given bucket resource can be consumed in 30 days (where 30 days is taken as a reference as a month).
This is applicable even if the days in a month are 28/29/31 (such as February, January and so on) where the lifecycle of bucket resource is monthly or any other periodicity of lifecycle, that is, hourly/daily/weekly/yearly.
Thus, the quota calculated is not as per the actual bill cycle of the bucket resource but always 30 days is considered for internal calculations.
•In case of bucket switching, the applicable bucket is considered as a new resource and the device past usage is not considered to compute the slice size.
That is, the computed slice size for the new bucket does not consider the speed at which the data was being consumed by the device (usage per hour) from the previous resource or bucket.
Bucket switching can happen in many scenarios and some of them are highlighted as follows : –Bucket is configured with the Charging step entity and a step-up operation is done on it.
–Bucket of type volume is exhausted and switched to the next applicable and available resource volume bucket.
Note that, for dynamic slicing, only volume type bucket is applicable.
–Bucket switching happens when a bucket of high priority is topped up or renewed in between the Diameter calls.
8.37.
1.5 Examples Consider the following examples to get a better understanding of this feature: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2025Charging User Guide Rating and charging Example 1: RAR is sent correctly when slice is calculated using dynamic algorithm This example shows that the RAR messages are sent correctly when the dynamic algorithm is used to calculate the slice size.
Preconditions : Provision the following entities using the SM GUI: 1.Create a quota management profile (quota management profile (slicing profile)) entity with default_profile having a rule with parameters: Min Slice Size = 4096 Bytes (4 KB) , Max Slice Size = 1048576000 Bytes (1000 MB) and Algo Name = DYNAMIC_ALGO_2 , VT = 7200 seconds , and Max- Number-Of-Devices-In-Group = 10.
2.Create a threshold with Dynamic Milestone Flag set to True , Kind of Unit as VOLUME with 70% and 90% thresholds as shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2026Charging User Guide Rating and charging 3.Create a charging service with bucket of 7516192768 Bytes (7 GB) and associate the milestone threshold created.
4.Create a bundle with the charging service created in the previous step.
5.Create an account.
6.Create a group having subscription of the created bundle with account created.
7.Create four devices having parent group created in the previous step.
Post-conditions : 1.A centralized SCUR call is triggered from device 1 such that CCR-I1: RSU = Empty, GSU = 4175663 bytes.
2.A centralized SCUR call is triggered from device 2 such that CCR-I: RSU = Empty, GSU = 4175663 bytes 3.CCR-U1 is executed from device 1 such that CCR-U1: USU= 5261334936 Bytes, RSU = Empty.
USU is 70% of bucket initial value, that is, committed ratio is equal to 70% milestone.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2027Charging User Guide Rating and charging 4.CCR-I2 is triggered from device 1 with a different session where RSU = Empty.
In this case, RAR is triggered for active session of Group resource for milestone 70.
Since committed ratio is 0.70 which is equal to milestone 70 and committed + reserve ratio is greater than milestone 70 + error, that is, 0.01.
Note : The committed ratio is calculated by subtracting the available balance value (without reservation) from total balance of bucket.
The committed + reservation ratio is calculated by subtracting the available balance value (with reservation) from total initial volume of bucket.
5.A centralized SCUR call is triggered from device 3 such that CCR-I: RSU = Empty.
6.CCR-U2 is triggered from device 1 such that CCR-U1: USU= 1503238554 Bytes, RSU = Empty.
USU is 90% of bucket initial value, that is, committed ratio is equal to 90% milestone.
In this case, RAR is triggered for active session of Group resource for milestone 90.
Since the committed ratio is 0.90 which is equal to milestone 90 and committed ratio + reserve ratio is greater than milestone 90 + error, that is, 0.01 7.A centralized SCUR call is triggered from device 4 such that CCR-I: RSU = Empty.
8.CCR-T is executed for all active sessions.
The Dynamic Past Usage (DPU) object and bucket instance are set correctly.
Example 2: Minimum slice is considered as RSU when output of dynamic algorithm 2 is less than minimum slice size This example shows that the minimum slice defined in the quota management profile (slicing profile) is used if the dynamic algorithm 2 output is less than the minimum slice.
Preconditions: Provision the following entities using the SM GUI.
1.Create a quota management profile (slicing profile) entity with name default_profile having a rule with parameters: Algo Name = DYNAMIC_ALGO_2, Min Slice Size = 4194304 Bytes (4 MB), Max Slice Size = 6442450944 Bytes (6 GB), Max-Number-Of-Devices-In-Group = 10, and VT = 5400 seconds as shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2028Charging User Guide Rating and charging 2.Create a threshold with Dynamic Milestone Flag set to TRUE , Kind of Unit is VOLUME , with 70% and 100% thresholds as shown in the following figure.
3.Create a charging service with bucket of 1 GB and associate the milestone threshold created in the previous step.
4.Create a bundle with the charging service created in the previous step.
5.Create an account and set the balance to 100.
6.Create a group and associate the subscription (bundle) created and link the created account to it.
7.Create a device with parent group created in the previous step.
Post-conditions: •Bob makes a data call from the device created.
This triggers NCC to receive a centralized call with empty RSU, CCR-I.
The CCR-U has USU of 2 bytes, RSU is empty.
CCR-T is 10 bytes.
•NCC uses the default_profile configuration for processing the call.
The DYNAMIC_ALGO_2 output from CCR-I is 447392 is compared with the minimum slice size defined, which is 4194304.
Since the output of algorithm 2 is less than the minimum slice size configured, the final slice size is the minimum slice size, which is 4194304.
Since commit is done in CCR-U with less data, that is, 2 bytes, device usage becomes small and the output calculated from algorithm 2 is 2702 which is less than the minimum slice size configured.
Therefore, the final slice size is minimum slice size, which is 4194304.
The result code 2001 (DIAMETER_SUCCESS) is sent.
The dynamic past usage value and the values in bucket instance are set correctly, sample shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2029Charging User Guide Rating and charging Example 3: Successful dynamic slicing call with dynamic algorithm and 3G RAT_Type using group resource volume bucket This example verifies the centralized SCUR call is successful with a dynamically calculated slice size determined using the DYNAMIC_ALGO for RG = 10 with RAT-Type= 1 for 3G using group resource volume bucket.
Preconditions: The quota management profile (slicing profile) entity is provisioned as follows: •Group Nokia has a big volume bucket attached to the subscription.
•Set the default dynamic quota management profile (slicing profile) name as default_profile in the application preference Default Dynamic slicing profile .
•RSV configuration : –Rating-Group = 10 and Call-Sub-Type = Volume_Based ; RSU-Unit-Type = UnitType.TVOL –Default-Roaming-Decision = HOME •Quota management profile (slicing profile) : –Name = default_profile –Rule0 is configured with Call-Sub-Type = Volume_Based and RAT-Type = 1 for 3G and Call- Roaming-Status = HOME , SPR_GROUP.GROUP_TYPE = LARGE result the action to be; Algo-Name = AlgoName.Dynamic_Algo , Max-Number-Of-Devices-In-Group = 1000 , and VT= 28800 .
–Rule1 is configured with Call-Sub-Type = Volume_Based and RAT-Type = 6 for 4G and Call- Roaming-Status = HOME , SPR_GROUP.GROUP_TYPE = MEDIUM result the action to be; Algo- Name = AlgoName.BUCKET_ALGO , Max-Number-Of-Devices-In-Group = 500, and VT= 86400 .
Post-conditions: •Centralized volume based call is triggered for devices of LARGE group, such that Rule0 conditions are met.
Dynamic slice algorithm computes the slice size considering the Max-Number-Of-Devices-In- Group = 1000 and VT = 28800 (8 hours) .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2030Charging User Guide Rating and charging •Centralized volume based call is triggered for devices of MEDIUM group such that Rule1 conditions are met.
Dynamic slice algorithm computes the slice size considering the Max-Number-Of-Devices-In- Group = 500 and VT = 86400 (24 hours) .
8.37.2 Slice reduction Without slice reduction, threshold is not considered during reservation, which result in delay in triggering the associated rule actions and produced incorrect behavior.
For example, if a threshold level is configured to send a notification to the user once the data usage reaches 80% of the account balance, then the notification was sent only at commit despite of the reservation logic realizing that the threshold level is crossing 80% at the time of reservation.
In this case, the actions associated with the threshold level led to inaccurate results as logic took the decision at commit and by that time, the current usage already crossed the defined threshold value by a significant gap.
Therefore, to reduce this gap, the slice reduction feature was introduced to make the actions associated with the threshold value more accurate.
Slice reduction checks the upcoming threshold values defined for a (main or carry-over) bucket, counter, account balance, or Aggregate View (AV) and its associated actions, such as Notification , Notification-Stop , Notification-Reject , Send-SNR , or Send-RAR at the time of reservation.
With slice reduction, when the current usage approaches the upcoming threshold values, the slice size is reduced in such a way that the result of actions become more accurate for the defined threshold values.
This feature is applicable to both centralized and decentralized charging calls and performed for all defined threshold actions.
Important : It is recommended not to use the slice reduction feature with DYNAMIC_ALGO or DYNAMIC_ALGO_2 because the slice reduction logic is itself an algorithm, which reduces the slice size depending on the upcoming threshold values.
However, if the slice reduction logic and DYNAMIC_ALGO or DYNAMIC_ALGO_2 are configured together, then the feature behavior might change and this may lead to unexpected results.
8.37.2.
1 Parameters for controlling slice size Following two parameters are defined in the quota management profile (slicing profile) rule for controlling the slice size: •Slice Allocation Factor : This parameter is defined in 0-100% and is calculated on the delta between current usage (committed quantity + reserved quantity) and threshold value.
•MIN Slice Size : This parameter indicates the minimum slice to be allocated and is defined in bytes.
It is applicable to the Granted Service Unit () of the volume type.
Note : The slice reduction takes place even when the MIN Slice Size is not configured in the quota management profile (slicing profile)or its value is set as zero.
However, for the slice reduction to take place, the Slice Allocation Factor parameter must be configured in the quota management profile (slicing profile) to a value greater than zero.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2031Charging User Guide Rating and charging 8.37.2.2 Delta value calculation and RSU modification NCC consider all upcoming thresholds for deciding slice size and to allocate units from a particular resource.
The follwing logic is used for delta value and RSU modification: 1.The following delta values are calculated: •Minimum delta : The difference between the immediate upcoming threshold and current value.
•Stop delta: Immediate stop action threshold delta.
•Reject delta: Immediate reject action threshold delta.
2.Slice size is calculated on the basis of the Minimum delta value as follows: •If MIN Slice Size < RSU (from network or quota management profile (slicing profile)) < Minimum delta , then RSU is not modified.
•If RSU > Minimum delta > MIN Slice Size , then replace RSU with Minimum delta .
•If RSU > Minimum delta < MIN Slice Size and action is other than reject, then RSU is replaced with MIN Slice Size .
If action is reject, RSU is replaced with Minimum delta .
3.If Stop delta and Reject delta are not configured, then the already calculated RSU is considered.
4.If calculated RSU < Stop delta or Reject delta , than also already calculated RSU is considered.
5.If Stop delta < calculated RSU < Reject delta , then RSU remains same and Stop delta value is granted in response.
6.If Reject delta < calculated RSU < Stop delta , then RSU is modified to Reject delta and it is granted.
7.If calculated RSU is more than both Reject delta and Stop delta , then check which delta is less among both: •If Stop delta < Reject delta , then RSU is set according to Reject delta and available balance is set according to Stop delta .
•If Reject delta < Stop delta , then RSU available balance is set according to Reject delta .
8.Once RSU is decided, NCC tries to allocate all units from same resource.
9.If all reservations are done from single resource, the answer is returned.
10.If partial reservation is done from the first resource, then balance is checked from other available resources.
If another resource is available, then slice size is re-calculated for the next resource.
11.The same delta calculation logic is executed.
Only delta is calculated, RSU is not modified.
12.If remaining units to be charged (RSU – GSU) is a.less than Stop delta and Reject delta : no action is taken.
b.more than Reject delta , then RSU is modified as GSU + Reject delta .
c.more than Stop delta then RSU remain same, but available balance is modified.
13.Slice reduction logic is executed for all resources that are used for reservation.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2032Charging User Guide Rating and charging Slice size configured in quota management profile ( slicing profile) or dynamically calculatedInput RSUReduce RSUGranted GSU Diameter response codeDescription De-centralized call NA Min SliceMin Slice 2001 No threshold/ continue threshold delta and Min Slice is available in resource.
NA Min SliceRemaining resource or continue Delta2002 No threshold/ continue threshold delta, and Min Slice is not available in resource and no other resource is available to charge.
NA Min SliceMin Slice 2001 Stop and reject threshold delta greater than Min Slice.
NA Reject DeltaReject Delta 2001 Reject delta is less than Min Slice.
NA< Min Slice Min SliceStop Delta 2002 Stop delta is less than Min Slice and no other resource is available.
NA Input RSUInput RSU 2001 No threshold and available balance more than RSU, or Min threshold delta is more than RSU.
NA Min DeltaMin Delta 2001 Minimum threshold less than RSU but more than Minimum slice.
NA Min SliceMin Slice 2001 Minimum threshold is less than RSU, Min slice with continue action, and there is enough resource.
NA> Min Slice Min SliceRemaining resource or continue Delta2002 Minimum threshold is less than RSU, Min slice with continue action, and there is not enough resource.Table 220: Slice reduction and RSU modification Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2033Charging User Guide Rating and charging Slice size configured in quota management profile ( slicing profile) or dynamically calculatedInput RSUReduce RSUGranted GSU Diameter response codeDescription NA Reject DeltaReject Delta 2001 Reject Delta is less than Min slice.
NA Min SliceStop Delta 2002 Stop Delta is less than Min Slice and resource is not available Centralized call < Min Slice - - - Wrong configuration; slice size must be equal to or more than min slice size.
However, in this case the behavior is similar to De- centralized Call with slice size less than min slice size.
≥Min Slice sizeNA - - - Similar to behavior of De- centralized Call with slice size > Min Slice as mentioned above.Table 220: Slice reduction and RSU modification (continued) 8.37.2.3 Counter on reservation A counter is updated only at the time of commit and therefore, reservation request for a counter is to be stored so that both current value and reservation value of a counter is taken into account while executing the actions associated with a threshold or cap on counter on reservation.
The following call flow is considered for counter on reservation: 1.When a reservation request is received, identify all the counters applicable to this call.
2.Store the list of all applicable counters used during this call.
3.Reservation from a specific entity (account, bucket, or No-Charge ) takes place.
For example, we have a device D1 and a device counter C1, which is configured with the device D1.
The device D1 is subscribed with a device subscription Sub1 , and the subscription has a counter C2 and a bucket B1.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2034Charging User Guide Rating and charging A call is initiated from device D1 with an RSU of 40 MB.
The amount is reserved from the bucket B1.
Both counters C1 and C2 are applicable to the call.
The current values of the counters remain unchanged while its new attribute is also incremented with a value of 40 MB.
The map associated with the counters are also updated with session ID and reserved values.
8.37.2.4 Spending limit counter NCC supports slice reduction functionality for direct debit (reservation) and ECUR calls with call type SMS and MMS.
During reservation, this facilitates operators to stop SMS/MMS when the threshold value defined in the spending limit counter is reached.
Note the following assumptions: •Applicable to decentralized calls only.
•For direct debit (SMS) and ECUR (MMS), the specific service unit is always 1.
•Over commit scenarios are not handled, that is, service specific unit = 1 in initial, service unit = 2 in terminate.
•The SMS/MMS type of calls consume from the main balance account.
•SMS-MO is direct debit and SMS-MT, MMS-MO, MMS-MT are ECUR.
•TTC on SMS/MMS is not handled.
•The threshold actions Reject and Notification-Reject can only be used to limit the counter at a specific value.
If Stop or Notification-Stop is used, then the counter limit can be crossed.
•In this quota management profile (slicing profile), define SAF parameter to enable slice reduction.
SAF must be 100 only since in certain cases operator wants either full RSU or nothing (zero).
•Min-Slice must not be defined, that is, it must be 0.
•Notification is sent at COMMIT only, that is, for ECUR call at CCR-Terminate.
Example : Consider the following example to understand the slice reduction for spending limit counter.
Scenario : Consider that the spending limit is 20 and Notification-Continue is defined at 50% and Notification-Reject is applied at 100%.
When an SMS ECUR call is executed, NCC performs the following logic: •When the counter value reaches 10, then notification is sent and call continues.
•When the counter value reaches 19.6, then the call is rejected as the defined rate is 0.5.
Pre-conditions : 1.Create a rate as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2035Charging User Guide Rating and charging Field Value Name Rate_ Unit Rate Type Unit Granularity Level Unit For the next Type NORMAL Total Quantity 0 unit Cost/ Quantity 0.2/1 unit Step Size 1 unitTable 221: Rate 2.Create a threshold with Notification-Continue at 50% and Notification-Reject action at 100%.
Field Value Group Name TPG_ 1 Application Type CHARGING Kind of Unit MONEY Reservation Threshold false OCS Policy Threshold falseTable 222: Threshold Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2036Charging User Guide Rating and charging Field Value Dynamic Milestone Flag false Description AbsolutefromstartTable 222: Threshold (continued) 3.Create a counter (Group counter) with the previously defined threshold having ULI value as 20.
Field Value Counter Name Group_ Counter Counter Consumption Type ALL Usage Limit 20 Unit Type Money Threshold Profile Group IDs TPG_ 1Table 223: Counter Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2037Charging User Guide Rating and charging Field Value Counter Consumption List N/A Counter Type COST Align Granularity TRUE Overage Limit 0 Counter Scope HIERARCHY OCS Policy Counter false Overage Threshold Profile Group IDs N/ATable 223: Counter (continued) 4.Create a charging service with charging from main balance.
Apply two tariffs.
In the first tariff, MSCC with service identifier 0 is applied and external rate of 0.1 is applied.
In the second tariff, MSCC with service identifier 1 is applied and external rate of 0.5 is applied.
Field Value Name CS_1 Priority 1 Category Default CategoryTable 224: Charging Service Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2038Charging User Guide Rating and charging 5.Create a bundle with the previously defined charging service and subscribe this bundle to a Group.
Field Value Name Bundle Fee 0 Charging Service List CS_1 Bundle Activation Type NORMALTable 225: Bundle 6.Create an Account with main balance 100.
Field Value Account ID AccountTable 226: Account Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2039Charging User Guide Rating and charging Field Value Account Type PREPAID Hour of Day 0 Day of Week SUNDAY Day of Month 2 Overage Limit 999999999 Without Reservation 100 With Reservation 100Table 226: Account (continued) 7.Create a Group and attach the device to the Group and attach the Group counter to the Group that is created.
Field Value Name device Identifier Type E164 Identifier 12345678 Day Light Saving false Device Type NORMAL Allow Overage trueTable 227: Device Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2040Charging User Guide Rating and charging Field Value Sy/Nchf OCS Enabled false Associations Subscription Index Group_ First Category List Default Category Groups GroupTable 227: Device (continued) Field Value ID Group Name Group Traversal Order TOP_ DOWN Devices device Entity Name Default Group Lifecycle Entity State Active Subscriptions Bundle Name Bundle Account Name AccountTable 228: Group Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2041Charging User Guide Rating and charging Field Value Entity State ActiveTable 228: Group (continued) 8.In the quota management profile (slicing profile) entity, define the Slice Allocation Factor (SAF) as 100 as follows: Field Value Profile Name default_ profile Slice Size 10 Quota Holding Time 10 Validity Time 100 Ignore Reserved Quota NOTable 229: Quota management profile (slicing profile) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2042Charging User Guide Rating and charging Post-conditions : 1.When the SMSMO ECUR call for service identifier 0 is executed, the counter value is updated to 0.1.
2.The Group counter is updated through update/EntityCounterInstance API with value 9.8.
The counter value becomes 9.9.
3.When another SMSMO ECUR call for service identifier 0 is executed, the Group counter value becomes 10.0 and threshold of 50% is reached and notification is sent.
4.The Group counter is updated through update/EntityCounterInstance API with value 9.6.
The counter value becomes 19.6.
5.When another SMSMO ECUR call for service identifier 1 is executed, the call fails with result code 4012 since the threshold is applied at 100%, that is, ULI is 20.
8.37.2.5 Account main balance limit when charging step is used Notification-stop action is applied on the counter when multiple thresholds are executed, which limits the Account main balance when charging step is used.
Action evaluation of Notification-Stop Notification–stop action is applied when the counter limit of threshold is applied.
The notification is not sent, and the step-up is not done as the threshold limit crosses and the action Notification–stop is applied, and the counter value is not incremented above the limit.
However, it is possible that charging from main balance can be done where the rate applied on main balance is less than 1 CHF.
When the subscriber consumes from the main balance limit, the upcoming threshold is reached and the notification is sent accordingly.
The notification is not sent when the charging Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2043Charging User Guide Rating and charging is yet to be done from the step bucket.
The charging is not done as the limit is applied on it to stop the usage.
The counter value can be present between the thresholds or with the counter current value as zero .
Example 1 We have a subscriber group that is attached to the subscriber account through a subscription TO_LEBAR1 .
TO_LEBARA1 is the base plan (Access component) with lowest priority.
This bundle has a tariff in pass-2 .
Subscriber group has a parent (known here as Site Group level) defined which is known as Site Group.
Parent has PO_BU_TAPACK_1M_R1 bundle.
Device is linked to the subscriber group.
Auto Install TPACK bundle includes set of two bundles: • –PO_BU_TAPACK_1M_R1 : No bucket, no threshold, installed at site level, bundles rules are defined to install PO_BU_TAPACK_1M_R1-SUB bundle at Subscriber Group level.
–PO_BU_TAPACK_1M_R1-SUB : Bucket with Charging Step such that 524288000 bytes = 29CHF .
Threshold in Charging Service for notification and re-installation of PO_BU_TAPACK_1M_R1 bundle at Subscriber group only.
This bundle is installed at Subscriber group level.
–Counter DataRaomingCounter_50 : This is to count and restrict the account main balance usage for data.
It is having threshold which defines 50% notification at value 25CHF , 100% usage notification at value 49CHF and Notification Stop at 50CHF .
Configuration –Current counter value is 29.
–Bundle PO_BU_TAPACK_1M_R1 is at site group level.
–Bundle PO_BU_TAPACK_1M_R1-SUB is at Subscriber group level.
–Execute session to exhaust the bundle PO_BU_TAPACK_1M_R1-SUB .
Expected Result Once bundle PO_BU_TAPACK_1M_R1-SUB is exhausted charging moves to TO_LEBARA1 bundle and DataRoamingCounter Value is not beyond 50 (when threshold is applied as limit on 50 with Action - Notification-Stop ).
Example 2 We have a subscriber group that is attached to the subscriber account through a subscription TO_LEBAR1 .
TO_LEBARA1 is the base plan (Access component) with lowest priority.
This bundle has a tariff in pass-2 .
Subscriber group has a parent (known here as Site Group level) defined which is known as Site Group.
Parent has PO_BU_TAPACK_1M_R1 bundle.
Device is linked to the subscriber group.
Auto Install TPACK bundle includes set of two bundles: • –PO_BU_TAPACK_1M_R1 : No bucket, no threshold, installed at site level, bundles rules are defined to install PO_BU_TAPACK_1M_R1-SUB bundle at Subscriber Group level.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2044Charging User Guide Rating and charging –PO_BU_TAPACK_1M_R1-SUB : Bucket with Charging Step such that 524288000 bytes = 29CHF .
Threshold in Charging Service for notification and re-installation of PO_BU_TAPACK_1M_R1 bundle at Subscriber group only.
This bundle is installed at Subscriber group level.
–Counter DataRaomingCounter_50 : This is to count and restrict the account main balance usage for data.
It is having threshold which defines 50% notification at value 25CHF , 100% usage notification at value 49CHF and Notification Stop at 50CHF .
Configuration –Current counter value is 24.
–Bundle PO_BU_TAPACK_1M_R1 is at site group level.
–Bundle PO_BU_TAPACK_1M_R1-SUB is at Subscriber group level.
–Execute the session to exhaust the bundle PO_BU_TAPACK_1M_R1-SUB .
Expected Result Once bundle PO_BU_TAPACK_1M_R1-SUB is exhausted charging moves to TO_LEBARA1 bundle and DataRoamingCounter Value is not beyond 50 (when threshold is applied as limit on 50 with Action - Notification-Stop ).
Example 3 This example is to check step bucket that is Time-Pulse, when multiple thresholds are crossed in the same request.
Configuration •DataRoamingCounter_50 with Threshold1 Abs 25, Notification-con ,Threshold2 Abs 49, Notification- con and Threshold3 Abs 50, Notification-stop.
•Bucket is the kind of step bucket with 3CHF/MB a step.
•No rate is applied to the Step Bucket.
Scenario Current Counter Value = 48.5 , Current volume balance left in the Step-bucket = 900KB .
Expected Result The Step up does not happen as counter applied is with threshold at 50s.
Additional information •Single or multiple threshold can be crossed in same request.
•No notification will be sent when the step up is not done.
•No normal rate is configured more than 1 CHF.
•No external rate is being configured for SCUR Gy/IMS/NCHF request.
•Rate is not applied to the Step-Bucket.
•Rate is not configured as it crosses multiple thresholds.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2045Charging User Guide Rating and charging •Notification-stop action is supported.
•Reject and Notification-Reject actions are not supported.
8.37.2.6 Delta value calculation for counters Following is the delta value calculation logic using thresholds of all applicable counters during a call: 1.To calculate the counter delta value, examine each threshold profile group attached to the counter.
The thresholds are fetched from each threshold profile group and evaluated against the current usage (committed quantity + reserved quantity).
Note : If the Ignore Reserved Quota is set as Counter in a quota management profile (slicing profile) and No-Charge billing is done, then the reserved quantity for delta calculation is ignored.
2.Consider both recurring and non-recurring thresholds.
3.Consider the Threshold Profile Type , such as Absolute from Start and Percentage as per the following conditions: •If the usage limit is not defined in a counter, then the delta is calculated only from absolute thresholds and the delta value calculated as per the upcoming threshold is returned.
If the difference between upcoming threshold and current value is negative, then the value returned is zero.
•If the usage limit is defined in a counter, then delta calculation also considers percentage thresholds and overage thresholds (if available) as explained further: a.First, calculate delta from usage thresholds considering both percentage and absolute thresholds.
b.While processing the usage thresholds, if the difference between the upcoming threshold and current usage value is negative, then zero value is assigned to delta and control is returned as no further processing of overage threshold is required, which becomes the case of minimum slice allocation.
c.If there are no upcoming usage thresholds, which means delta from usage threshold is -1, then process the overage thresholds for delta calculation.
d.If a delta value greater than 0 is returned from usage thresholds, then iterate the overage thresholds as well.
e.For delta calculation from overage thresholds, first calculate delta value from current overage block thresholds.
The current overage block is calculated based on counter current value.
As explained in point (b) to (d), we can have delta values as 0, -1, or greater than 0. f.If there is no upcoming threshold in current overage block, which means delta is -1, then calculate delta from the next overage block.
For example: If Usage Limit = 100 Bytes and Overage Limit = 20 Bytes with Overage Threshold at 10 Bytes .
Now, counter value = 111 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2046Charging User Guide Rating and charging Bytes , which refers to the first overage block and there is no upcoming threshold in overage block 1 as overage threshold as 10 Bytes is crossed.
So, the upcoming threshold is at 10 Bytes of overage block 2 (that is reached at counter value 130).
Delta is calculated as 19. g.Compare the delta from usage block and overage block, and return the minimum value as counter delta.
8.37.2.7 Monetary to unit conversion for threshold on monetary resources The following call flow is considered for monetary to unit conversion for threshold on monetary resources 1.If threshold is configured on the monetary resource, then check for the upcoming threshold value.
2.Find the difference between the (sum of committed and reserved values) and upcoming event value.
3.Calculate the maximum amount used in the current request using the formula: (Value from point 2 * factor) / 100 4.Pass the value from point 3 to money for unit conversion logic with an RSU.
5.Check whether the input cost grants RSU passed as input or calculates the maximum possible RSU from input cost.
6.Return either the RSU value pass as input or some other value, which is less than the RSU to be used in the slice reduction logic.
Note : The existing rate calculation logic is re-used partially.
8.37.2.8 Bucket on reservation The upcoming thresholds are calculated based on the committed and reserved quantities of AV and those thresholds are used along with the threshold or cap values associated with a bucket or counter to determine the dynamic slice size.
Find all AVs corresponding to the bucket and execute the bucket threshold reservation to find the bucket delta value.
Find all AVs corresponding to the bucket and execute the bucket threshold reservation to find the bucket delta value following the given steps: 1.To calculate this AV delta, examine each threshold profile group attached to AV.
The thresholds are fetched from each threshold profile group and evaluated against the unused AV value.
If the threshold value is less than the unused AV value, then add the difference between threshold value and current value of AV to the AV delta.
2.All the Threshold Profile Type , such as Absolute from Start , Absolute from End , and Percentage are considered.
3.Both recurring and non-recurring thresholds are considered.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2047Charging User Guide Rating and charging 4.While processing the thresholds, if the difference between the upcoming threshold and current usage value is negative, then zero value is assigned to delta and control is returned as no further processing is required.
This becomes the case of minimum slice allocation.
5.After calculating the AV delta, first find the minimum of these AV deltas and this minimum AV delta is compared with the bucket delta (calculated in point 2) to find the minimum delta out of these two values.
6.Whichever delta value (AV delta or bucket delta) is minimum is then used with the counter delta value for slice reduction.
The AV initial value, current value, and unused value are fetched from carry-over utility.
If the Threshold flag is set as True , then it includes the carry-over bucket values.
Otherwise, if the Threshold flag is set as False , then the carry-over buckets are not included while returning these values.
For example: 1.Consider a device D1 is attached to a subscription S1 and bundle BL.
2.The bundle B1 contains charging services CS1 and CS2.
CS2 contains a volume bucket B1 (200 bytes) and B2 (200 bytes).
3.BL contains threshold T1 at 50 with Absolute from start with stop action.
CS2 contains time bucket B3 (500 seconds).
4.Aggregate volume bucket AV1 contains charging services CS1 and CS2 attached to the device D1.
AV contains balance of buckets B1 and B2 along with threshold (T2) action as continue at 20 with Absolute from start action.
AV Initial = 400 bytes AV Current = 400 bytes AV Unused = 400 bytes 5.An initial reserve request arrives with RSU = 20 bytes from B1.
Then, execute threshold reservation for BL as well as AV1.
The bucket delta for B1 is calculated as 50 and AV delta for AV is calculated as 20.
6.Minimum slice size = 10 bytes and allocation factor is 90%.
7.The minimum delta between bucket delta and AV delta are selected.
Therefore, minimum delta = 20.
Since, there is no applicable counter, slice reduction uses the above delta to calculate dynamic slice.
The dynamic RSU comes out to be 18 bytes and the reservation of 18 bytes is done from BL and AV1 current value is also updated according to reserved value.
8.37.2.9 Configuration Follow the given step to configure slice reduction: 1.Calculate the delta (D) between current usage (committed quantity + reserved quantity) and upcoming threshold values.
2.Apply the Slice Allocation Factor (SAF) value on the above delta (D) value using the Slice Allocation Factor parameter defined in the quota management profile (slicing profile) rule.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2048Charging User Guide Rating and charging 3.Compare the above calculated value with the Requested Service Units (RSU) and identify the smaller value as SMIN .
4.Compare the MIN Slice Size or SAS value with SMIN and grant the one with larger value.
8.37.2.
10 Implementing slice reduction feature in centralized calls Consider the following points when slice reduction feature is applied to the centralized charging call: •This feature is applicable only when both Slice Allocation Factor and MIN Slice Size parameters are present in the quota management profile (slicing profile) object rule provisioned.
However, if DYNAMIC_ALGO_2 is used, then MIN Slice Size passed to the DYNAMIC_ALGO_2 is considered.
If this feature is not configured with DYNAMIC_ALGO_2 , then the MIN Slice Size is considered as 0 by default.
If both DYNAMIC_ALGO_2 and MIN Slice Size is configured, then preference is given to the MIN Slice Size configured by the DYNAMIC_ALGO_2 .
•If no quota management profile (slicing profile) rule is provisioned in the slicing profile object, then the DefaultAction is considered.
However, if both Slice Allocation Factor and MIN Slice Size parameters are present in the default actions object rule, then execute the slice reduction feature.
•If the threshold value or cap limit is not defined, then the default MIN Slice Size is always considered in cases where the RSU is less than the MIN Slice Size parameter value.
Example: Consider the following example for understanding the slice reduction feature implementation.
1.Assume that there is a user with a subscription of 2 GB with a notification defined at 80% threshold (1638 MB) and a Send-SNR action defined at 100% (2048 MB).
2.The slice size (granted service units) calculated by the centralized slicing is 50 MB.
3.The current usage of the user is 1550 MB.
4.When a CCR-U is received from PGW with USU = 50 MB, the current usage of the user becomes 1600 MB.
The allocation of another 50 MB at reservation crosses the notification threshold defined at 80%.
5.The slice size is calculated as per the slice reduction feature logic.
Let us consider that the slice size comes to be 38 MB and the same is set as GSU in CCA sent to the PGW.
6.When a CCR-U is received from PGW with USU = 38 MB, the current usage of the user becomes 1638 MB.
It reaches to 80% of usage threshold and thus, a notification is sent to the user.
7.A couple of more CCR and CCA messages are exchanged between the PGW and OCS node.
At a given point of time, the current usage of user becomes 1950 MB.
8.When a CCR-U is received from PGW with USU = 50 MB, the current usage of the user becomes 2000 MB.
The allocation of another 50 MB at reservation crosses the Send-SNR threshold defined at 100%.
9.The slice size is calculated as per the slice reduction feature logic.
Let us consider the slice size comes to be 48 MB and the same is set as GSU in CCA sent to the PGW.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2049Charging User Guide Rating and charging 10.When a CCR-U is received from PGW with USU = 48 MB, the current usage of the user becomes 2048 MB.
It reaches to 100% of usage threshold, a Send-SNR action is performed and the data consumption speed is degraded.
8.37.2.
11 Implementing slice reduction feature in decentralized calls Consider the following points when slice reduction feature is applied to the decentralized charging call: •If the default quota management profile (slicing profile) entity is not configured, then the call is not rejected in a decentralized call.
Set the values of Slice Allocation Factor and MIN Slice Size as zero, VT is set to 10.
•If the quota management profile (slicing profile) rules are not configured and DefaultAction is non- empty, then trigger the DefaultAction for rule execution.
As per the result, use the values of QHT , VT, SliceSize , MIN Slice Size , Slice Allocation Factor accordingly.
Note : In case, there is no result from DefaultAction , then it populates the QHT or VT accordingly from the slice profile entity or the default values, as available.
•In case of decentralized charging, the RSU value sent by Packet Data Gateway (PGW) should always be greater than the MIN Slice Size parameter value.
If the RSU value is less than the MIN Slice Size parameter value, then the MIN Slice Size parameter value is considered.
•If the quota management profile (slicing profile) rules are configured, then execute the rule provisioned for quota management profile (slicing profile) entity and set the values of QHT , VT, SliceSize , MIN Slice Size , and Slice Allocation Factor accordingly.
Example: Executing cap action after reducing the allocated slice size for a decentralized call Attention : Cap is supported only through API and this support will be deprecated in the future.
It is recommended to use Threshold for Cap-related function and migrate the existing Cap configuration to Threshold.
The following example shows that cap actions, such as Send-RAR (Reauthorize call) , Reject , or Notification-Stop (Stop using the resource) are executed on committed quantities but the allocated slice size is reduced while approaching the cap value.
This results to trigger the cap actions at more accurate values.
Preconditions: 1.Bob has an iPhone associated with a data counter and device subscription.
2.The device subscription is further associated with another data counter (subscription counter) and a data bucket of 2 GB balance.
3.A cap limit is applied on the subscription counter with a defined action Reject to reject call after consuming more than 120 MB of balance.
For example, after consuming 120 MB of balance, further calls are rejected and a notification is sent to Bob that consumption of resources beyond 120 MB is not allowed.
4.SAF is configured as 70% and MIN Slice Size = 30 in quota management profile (slicing profile) rule.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2050Charging User Guide Rating and charging Post-conditions: •When the iPhone initiates a data call with an RSU of 50 MB, the amount required to complete the call is reserved from the data bucket associated with the device subscription.
•Both the counters, individual data counter associated with the iPhone and the data counter associated with the device subscription, are applicable for the call charges.
Note : The cap associated with the subscription counter is considered at the time of reservation for the call.
•The quota management profile (slicing profile) rule is executed at the time of reservation and the RSU value is calculated by this feature as delta = 120- 0 = 120.
Apply SAF = 0.7 * 120 = 84.
However, given that RSU is less than 84, the RSU is kept as 50 MB only.
For example, the cap limit is 120 MB beyond which the cap action is set to Reject .
Thus, the iPhone completes the call consuming 50 MB from the device bucket.
•The iPhone again initiates a call with an RSU of 80 MB.
At the time of reservation, the RSU value is recalculated as: Delta = 120 - 50 = 70.
Apply SAF = 0.7 * 70 = 49 and reduce the slice to 49 because the cap limit of 120 MB is approaching.
•The iPhone cannot be granted more than 70 MB as cap of 120 MB is crossed.
iPhone completes the call and cap action is triggered when 120 MB is crossed in commit and then further calls are rejected because the applied cap limit has reached.
Therefore, usage of the slice reduction logic allows modification of RSU at the time of call reservation.
This helps to control the consumption of resources associated with the device.
8.37.2.
12 Additional information Following are some important points to note for this feature: •This feature does not consider milestones while calculating the slice size.
•There is no recommended value for the Slice Allocation Factor and MIN Slice Size , but smaller the value of these two parameters, more accurate is the threshold or cap.
However, smaller values may impact the performance, therefore, you need to set the value of these parameters to work out both balance performance and accuracy.
•Threshold 0 for bucket is not supported.
Hence, it is recommended to configure threshold other than 0, that is, minimum 1 byte or equal to minimum slice configured in the quota management profile (slicing profile).
•The slice reduction logic checks the upcoming threshold for over-commit case.
It makes the threshold or cap actions more accurate, but it does not guarantee 100% accuracy due to dynamic scenarios, which contribute to data calls.
Following is an example case: –Given that this feature works with respect to the minimum slice allocation, in case of parallel calls (multiple MSCC or group sharing) on the same resource, there is a possibility that the minimum Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2051Charging User Guide Rating and charging slice allocated to each MSCC or parallel calls may cross the threshold or cap only at the time of reservation.
This may eventually lead to cross the threshold or cap at commit.
•During slicing reduction, implicit threshold is considered as 100% of the bucket's initial value.
Therefore, if no upcoming threshold is present for bucket, then this value of 100% is used to compute the delta.
Refer to Example 5: Bucket with implicit threshold on page 2056 for an example on how the delta it is computed.
•For AV scenarios, slice reduction for multiple threshold handling is considered only if Aggregate Type = Charging Service (only for Bucket).
•For BOU, slice reduction is considered only if BOU Activation Priority is ON_COMMIT.
BOU activation works in all or nothing mode.
While charging activation fee, if REJECT Threshold action is received, it cannot move to next resource for charging.
If STOP Threshold action is received, then also BOU is not activated, but it moves to the next resource for charging requested units.
•Multiple thresholds do not work with UC self counter.
8.37.2.
13 Examples Consider the following examples for a better understanding of slicing reduction.
8.37.2.
13.
1 Example 1: Slice reduction with account thresholds The following example shows how the final slice reduction value is calculated.
Preconditions: Perform the following steps: 1.Create a quota management profile (slicing profile) with Slice Allocation Factor = 70 and MIN Slice Size = 30.
2.Create an account A1 with main account balance set as 100 and overage limit = 0.
3.Create a threshold profile group TPG1 with threshold profile set to ABSOLUTE_FROM_ZERO for threshold Th1 = 30.
4.The threshold Th1 rule is set with the following Notification Action and Notification Variable : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2052Charging User Guide Rating and charging 5.Associate the threshold profile group TPG1 with the account A1.
Post-conditions: The final slice reduction is calculated as: •Main account balance = 100 •Upcoming threshold value = 30 •Delta value = main account balance - upcoming threshold value = 100 - 30 = 70 •SAF slice size = Delta value * SAF = 70 * 0.7 = 49 Therefore, the final slice reduction value is 49 for the above example.
8.37.2.
13.2 Example 2: Implementing slice reduction for an AV bucket The following example describes how slice reduction feature helps to calculate the minimum slice size for an AV bucket.
Preconditions: 1.Consider a device D1 attached to a subscription S1 with a bundle B1.
2.Bundle B1 contains two charging services CS1 and CS2: •CS1 contains a volume bucket B1 (100 bytes) and B2 (100 bytes).
B1 contains a threshold T1 at 40 bytes with a Absolute from start with stop action.
•CS2 contains a time bucket B3 (500 seconds).
3.An AV bucket with CS1 and CS2 is attached to the device D1.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2053Charging User Guide Rating and charging 4.An aggregate view contains balance of buckets B1 and B2 with threshold action (T2) set as Absolute from start .
AV initial = 200 bytes AV current = 200 bytes AV unused = 200 bytes Post-conditions: •An initial reserve request arrives with RSU set as 20 bytes from B1.
•The slice reduction feature is executed, which calculates dynamic RSU as 10 bytes considered B1 and AV bucket.
•The allocation factor is set as 100% and minimum slice size as 10 bytes.
•The reservation is done from B1 and AV current value is also updated according to the reserved value.
•A commit request is received from B1 for 40 bytes.
•The commit request from B1 is initiated, balance is updated and threshold is evaluated.
•Update the AV current value and unused value based on committed value.
•Evaluate AV thresholds.
Threshold T2 is crossed.
•Handover commit.
Update B1 balance and evaluate its thresholds and set action.
Threshold T1 is crossed.
•Update AV balance and evaluate its thresholds and set action.
8.37.2.
13.3 Example 3: Executing threshold action of bucket after reducing the allocated slice size for a decentralized call This example shows that threshold actions continue to be executed on committed quantities but the allocated slice size is reduced while approaching the threshold value.
This results to trigger the threshold actions at more accurate values.
Preconditions: 1.John has an iPhone subscribed to a device subscription associated with a data bucket of 200 MB balance.
2.The threshold is defined, for example the threshold sends a notification when 50 percent of the total resources, that is 100 MB of bucket balance is consumed.
Slice Allocation Factor = 50% MIN Slice Size = 30 Post-conditions: •When the iPhone initiates a data call with an RSU of 40 MB, then the amount required to complete the call is reserved from the bucket balance of 200 MB.
The quota management profile (slicing profile) rule is executed at the time of reservation and the RSU is modified for the upcoming event value.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2054Charging User Guide Rating and charging Given that delta = 100, apply SAF = 0.5 * 100 = 50 and keep the RSU as 40 MB only since RSU is less than calculated slice since RSU is less than the calculated slice.
•iPhone commits 40 MB and requests another call with RSU 100 MB.
•RSU is modified and delta = 100 - 40 = 60 and apply SAF = 0.5 * 60 = 30.
Therefore, RSU is changed to 30 and 100 MB threshold is not crossed, and later, on the committed value, threshold is triggered notifying John about the remaining balance after 100 MB is used.
•John can commit a new call checking the available balance in his device bucket.
In this case, if slicing reduction logic was not executed, then the threshold value may not have triggered a notification until 140 MB of the total resource were used up.
But due to modified RSU using slice reduction, John received an early notification because the RSU was modified.
8.37.2.
13.4 Example 4: Applying slice reduction functionality on a multi-bundle counter The following example explains how the slice reduction functionality is applied on a multi-bundle counter.
Note : If the Notification-Stop threshold action of a multi-bundle counter having is crossed, then during the reservation for parallel call, delta for the slice is calculated with next priority multi- bundle counter instead of granting MIN Slice Size .
The highest priority multi-bundle counter is ignored for parallel calls in case the counter has a Notification-Stop threshold action.
See Multi- bundle restrictions for restrictions applicable to multi-bundle counter.
Preconditions: 1.A base bundle is defined with two charging services: - The first charging service is associated with a multi-bundle counter ABY, which has a threshold of 50 GB.
- The second charging service is associated with a subscription counter TBY, which has a threshold of 15 GB.
2.Define a domestic databoost bundle with a multi-bundle counter ABB, which has a Notification-Stop threshold at 10 GB.
3.The quota management profile (slicing profile) has a SAF of 50% and MIN Slice Size of 1 GB.
4.Subscribe a device to the base bundle.
Post-conditions: •Execute domestic calls from a device till the ABY counter value becomes 40 GB.
Verify whether the ABY counter threshold is considered for slice reduction.
•The device subscribes to domestic databoost bundle.
•For next data reservation, the ABB counter is considered for slice reduction.
•Execute more calls, such that the ABB counter value reaches 9.5 GB.
•Execute a tethered call and verify whether the MIN Slice Size of 1 GB is granted.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2055Charging User Guide Rating and charging Now, the committed value of the ABB counter is 9.5 GB, and (committed + reserved) value is 10.5 GB.
•Execute domestic call.
Verify in slice reduction whether MIN Slice Size is granted and ABY counter delta value is considered for determining the slice size.
8.37.2.
13.5 Example 5: Bucket with implicit threshold During slice reduction if no upcoming threshold is present for bucket then the implicit threshold of 100% is used to compute the delta.
This example explains this scenario: Preconditions: 1.Quota management profile (slicing profile): min slice size = 5 B, slice size = 1024, and Slice Allocation Factor (SAF) = 10%.
2.There is Cap at 50 B with Send-RAR action.
Cap is applied on the counter.
3.There is a Bucket having initial value of 5000 B.
Execution: 1.Execute a SCUR call.
2.For CCR-I, execute a centralized call in which granted units = 5 B.
3.For CCR-U, execute a call with USU = 60 B, granted units = 494 B.
4.The current value of bucket = 4940 B (5000 – 60); the delta is 4940 B 5.After applying SAF = 10%, the value becomes 494 B; therefore, the granted units are 494 B.
8.37.3 Allow a fixed VolumeQuotaThreshold for Diameter Gy quota allocation With this feature, a fixed VolumeQuotaThreshold (VQT) is added to a quota allocated, which is sent back to the network when a soft-stop limit is reached irrespective of whether the system is not configured to ignore the reservation quota.
For information on soft-stop scenarios, refer to Soft-stop scenarios on page 2058 section.
This feature supports the configuration in the system to define separate filter-ID values on a per rating group basis.
It also returns the Granted Service Unit (GSU) value as zero, and triggers a Final Unit Action (FUA) set as Restrict-Access under the following conditions: •Within UC Time of day (TOD) restricted interval.
•Access is barred for a device, subscription, or account.
•A hard-stop limit is reached.
For information on hard-stop scenarios, refer to Hard-stop scenarios on page 2057 section.
While applying the slice reduction functionality to align the latest allocated GSU to an upcoming counter threshold, this feature excludes the allocated (in-flight) quota and provides parallel reservation or allocation of quota to different rating groups as per the minimum distance to the threshold limit applied.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2056Charging User Guide Rating and charging Note : For 5G requests, Final-Unit-Indication-Restriction-Filter-Rule AVP with post-deny as input, is not supported.
For final unit indication, use RATING.Final-Unit-Indication-Filter-Id AVP (for both 4G/5G) instead.
Hard-stop scenarios The hard-stop refers to the ability to stop using the resource and return GSU value as zero with a successful result-code and an FUA set as Restrict-Access for different hard-stop triggers, such as TOD restricted interval, barred access for a device, subscription, or account, and hard-stop reached scenarios as explained in the following table: Scenario Stoppage Type Behavior Result UC bundle on base plan Reject Hard- stop is met as UC is applied to provide no further usage even when a resource is available.
Reject Hard- stop is met when x limit applied by the bundle even when a resource is available.Normal bundle on base plan Stop Hard- stop is met when x limit of the bundle has applied a soft- stoppage but the resources are exhausted.
OR No other next resource, such as bucket, counter, or bundle is available.
Barring a device, account, or subscriptionNA A device, account, or subscription gets barred in any initial or update requests.Performs the following actions: •Sends the GSU value as zero with a successful result code 2001 .
•Sends an FUA set as Restrict- Access with Filter- Id as configured for a particular rating group in global configuration.
•Opens an active session.Table 230: Hard-stop: Stop using resource or bundle Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2057Charging User Guide Rating and charging Scenario Stoppage Type Behavior Result TOD applied by UC bundle NA TOD restrictions applied by UC bundle.Table 230: Hard-stop: Stop using resource or bundle (continued) Note : For all hard-stop scenarios, the threshold action is only set as Notification-Reject or Reject actions.
Soft-stop scenarios The soft-stop refers to the ability to identify the soft-stop scenarios (as explained in the following table) and addition of fixed VQT in quota allocated to network.
Scenario Stoppage Type Behavior Result Continue UC has been notified as soft- stop stoppage.Soft- stop by UC bundle on base plan Stop x limit is applied by UC to be notified as soft- stop stoppage even when other resources are available, like buckets or counters without their limits being reached.
Continue Bundle has applied x limit as a soft- stop to itself.Soft- stop by bundle on base plan Notification- Stop x limit is applied by bundle to be notified as soft- stop stoppage even when resources are available.Performs the following actions: •Adds a fixed VQT in GSU quota allocation.
•No FUA is sent.
•No check is required irrespective of whether another resource is available or not.Table 231: Soft-stop: Adding of fixed VQT as defined in quota management profile (slicing profile) in GSU (Quota Granted) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2058Charging User Guide Rating and charging 8.37.3.
1 Configuration The following settings can be configured for this feature: •Configure the Volume-Quota-Threshold-Algo parameter in quota management profile (slicing profile) rule under Dynamic_Slice and can have one of the following values: –FIXED_ADD_IN_GSU : When configured as FIXED_ADD_IN_GSU , then the Volume-Quota- Threshold parameter in quota management profile (slicing profile) rule specifies the absolute value used to set AVP in CCA message sent back to the network.
It is added to the derived quota amount to determine the GSU value when GSU is not a final slice.
–PERCENTAGE : When configured as PERCENTAGE , the Volume-Quota-Threshold parameter value in quota management profile (slicing profile) rule is configured in % and calculated on the granted volume quota sent in CCA message.
By default, the value of this action attribute is set as PERCENTAGE to achieve the existing slice reduction functionality.
This parameter is also defined per MSCC or rating group.
Depending on the type of algorithm used, the Volume-Quota-Threshold parameter is calculated and sent back to the network in CCA message.
•Configure separate filter ID values for any of the triggering events (hard-stop, TOD, or Device-Barred ) and also enable specific rating groups to use a different value.
This functionality is further used by UC to send a configurable Filter-ID with Restrict-Access .
•Configure the Ignore Reserved Quota parameter to determine whether reservation quota needs to be considered in slice reduction logic or not.
This parameter can have one of the following values: –No: When the parameter value is set as No, it means reserved quota is not ignored during slice allocation or reduction mechanism.
–Counter : When the parameter value is set as Counter , it means that in case of No-Charge , the reserved quota is ignored and during slice allocation or reduction mechanism, the current value is considered.
By default, this parameter is set as No.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2059Charging User Guide Rating and charging Note : Counter value is only applicable for No-Charge .
This logic is not applicable when quota is allocated from bucket or main balance charging as they are not generally allowed to go negative.
•Check the value of the Is-Gsu-Zero attribute.
Following figure shows an example snapshot of the CALL_COMMON.Is-Gsu-Zero attribute with the RATING_POST_PROCESSING rule set.
In the above figure: –RATING.GSU-Value : For Set GSU in AVP with 2001 –CALL_COMMON.Is-Gsu-Zero : To check whether anything is allocated –CALL_COMMON.Call-Trigger-Type : Refers to the current Trigger-Type for MSCC The value of the Is-Gsu-Zero attribute is required when rating does not allocate any units from resources for a current MSCC.
If CALL_COMMON.Is-Gsu-Zero = BooleanEnum_TRUE and (check whether GSU 0 is allocated by rating) CALL_COMMON.Call-Trigger-Type present and CALL_COMMON.Call-Trigger-Type != "SOFT_STOP" Then RATING.GSU-Value = 0 (Set Provided GSU in CCA AVP of MSCC) Supported trigger types which are only supported to add in complex map: •ACCOUNT_BARRED •DEVICE_BARRED •HARD_STOP Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2060Charging User Guide Rating and charging •SOFT_STOP •TIME_OF_DAY •SUBSCRIPTION_BARRED In addition, the VQT value can be updated in the RATING_POST_PROCESSING rule based on the allocated quota size.
Rule example for VQT-Value: if CALL_COMMON.Call-Type=CallType_PS and CALL_COMMON.getGSUValue present and CALL_COMMON.getGSUValue > 0 and CALL_COMMON.getGSUValue < 600 then RATING.GSU-Value = 600 and RATING.VQT-Value = 100 and RATING.Final-Unit-Action-Terminate This feature exhibits the following behaviour based on the values of given parameters: If... Then.
..
The Volume- Quota- Threshold- Algo per rating group is set as VQTType_ FIXED_ ADD_ IN_GSU , and The Ignore Reserved Quota parameter is set as No,The quota allocation is considered while determining the new quota allocation, and either hard- stop behavior or soft- stop behavior is followed based on the configuration.
The Volume- Quota- Threshold- Algo per rating group is set as VQTType_ FIXED_ ADD_ IN_GSU , and The Ignore Reserved Quota parameter is set as Counter ,The quota allocation is not considered while determining the new quota allocation in case of No-Charge counter, and either hard- stop behavior or soft- stop behavior is followed based on the configuration.
The Volume- Quota- Threshold- Algo per rating group is set as VQTType_ PERCENTAGE , and The Ignore Reserved Quota parameter is set as No,The quota allocation is considered while determining the new quota allocation.
Also, VQT is not added to GSU.
The Volume- Quota- Threshold- Algo per rating group is set as VQTType_ PERCENTAGE , andThe quota allocation is not considered while determining the new quota allocation in case of No-Charge counter.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2061Charging User Guide Rating and charging If... Then.
..
The Ignore Reserved Quota parameter is set as Counter , The Volume- Quota- Threshold- Algo per rating group is not defined, and The Ignore Reserved Quota parameter is set as No,This feature is disabled.
The Volume- Quota- Threshold- Algo per rating group is not defined, and The Ignore Reserved Quota parameter is set as Counter ,This feature is disabled.
AVP handling AVP handling The FUA AVP is configured with the Filter-ID parameter to handle 4G Gy and 5G Nchf requests: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2062Charging User Guide Rating and charging Note : This FUA AVP is already handled.
However, with Filter-ID parameter, its implementation is done for restrict-access or redirect options for both 4G Gy and NCHF requests.
The RATING_POST_PROCESSING is the rule set in which the FUA with Filter-ID option is exposed.
8.37.3.2 Additional information Consider the following points for this feature: •For this feature, centralized based charging is applied with static slicing.
However, no dynamic slicing algorithm is applied.
•The Volume-Quota-Threshold-Algo parameter does not impact the quota allocated from a bucket or buckets allocated to other data session, or flows are considered while determining new quota allocation using the slice reduction logic.
•This feature is only applicable to multi-bundle counters or subscription counters.
•When a hard-stop limit is reached, it implies that the associated data flow does not have a rating group configured as Always Allowed but Countable .
Note : The hard-stop limit specified as a requirement in this feature only considers the threshold being applied as Notification-Reject or Reject action.
•This feature is not applicable to the following charging entities/scenarios: –Device, group, or device-group counter –Aggregate view scenarios –Group CAP scenarios 8.37.3.3 Examples Consider the following examples for a better understanding of this functionality: Example 1: Slice reduction functionality applied on unused counter value for parallel calls when configured to ignore the quota allocated to other data sessions This example shows that slice reduction functionality works on the unused counter value in case of parallel calls when the Ignore Reserved Quota is set as Counter , VQT is added in GSU if it is not the last slice and hard-stop is false.
Preconditions: •Create a Do more Unlimited bundle having two charging services; one for tethered data and one for non-tethered data with No-Charge configuration for both the charging services.
•Create two counters for the Do more Unlimited bundle , which are multi-bundle counter ABY that accumulates both domestic and tethered data consumption, and a subscription counter TBY that Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2063Charging User Guide Rating and charging accumulates only tethered data consumption (charging service with applicability criteria of RG = 3303 ).
•Define a threshold for TBY counter to throttle ( SNR=low ) speed after 15k MB of data usage.
•Define a threshold for ABY counter to throttle ( SNR=low ) speed after 22k MB of data usage.
Also, configure a notification for the ABY counter has a usage limit set as 20000 and usage limits for Notification-Continue at 50%, 75%, 90%, and 100%.
The overage limit is set as 5000 with 90% near overage limit.
•Create a quota management profile (slicing profile) with following parameters: –Slice Allocation Factor = 100 –MIN Slice Size = 0 byte –Slice Size = 4000 MB –Fixed VQT = 200 MB •Set the Ignore Reserved Amount to Counter .
•Set the hard-stop to false.
•Configure notification template.
Post-conditions: Execute a centralized SCUR with domestic call ( RG = 3300 ) as mentioned below: 1.CCR-I: RSU=empty, GSU=4200 MB 2.CCR-U1: USU=4000 MB, GSU=4200 MB, RSU=empty 3.CCR-U2: USU=4000 MB, GSU=2200 MB, RSU=empty 4.CCR-U3: USU=2000 MB, GSU=4200 MB, RSU=empty 5.CCR-U4: USU=4000 MB, GSU=1200 MB, RSU=empty 6.CCR-U5: USU=1000 MB, GSU=3200 MB, RSU=empty 7.CCR-U6: USU=3000 MB, GSU=2200 MB, RSU=empty 8.CCR-U7: USU=2000 MB, GSU=2200 MB, RSU=empty Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2064Charging User Guide Rating and charging 9.CCR-U8: USU=2000 MB, GSU=2700 MB, RSU=empty 10.CCR-U9: USU=2500 MB, GSU=700 MB, RSU=empty 11.CCR-U10: USU= 500 MB, GSU=4200 MB, RSU=empty 12.CCR-T: USU= 4000 MB Result: After executing the preceding calls, this example verifies the following: •When the data usage is from the Do more Unlimited bundle for tethered data usage, ABY and TBY counters are incremented.
Also, when TBY counter value becomes 15 GB, SNR is triggered to throttle the speed.
•Once, the subscriber subscribes to first data booster, charging begins from the data booster bundle for new reservation.
The old reservation in update is charged from the Do more Unlimited bundle only.
In this case, only the ABY counter is updated.
•If the first data booster bucket is exhausted, charging is done from the second data booster.
Once, both the data boosters are exhausted, charging starts from the Do more Unlimited bundle .
•If the ABY data counter value reaches 50 GB, an SNR is triggered and throttling is done.
Example 2: Slice reduction functionality when GSU with VQT as final GSU reaches quota limit This example shows that in slice reduction functionality, when VQT is added in GSU as final GSU reaches quota limit, the total quota is allocated.
Preconditions: •Create a Do more Unlimited bundle having two charging services; one for tethered data and one for non-tethered data with No-Charge configuration for both the charging services.
•Create two counters for the Do more Unlimited bundle , which are multi-bundle counter ABY that accumulates both domestic and tethered data consumption, and a subscription counter TBY that accumulates only tethered data consumption (charging service with applicability criteria of RG = 3303 ).
•Define a threshold for TBY counter to throttle ( SNR=low ) speed after 15k MB of data usage.
•Define a threshold for ABY counter to throttle ( SNR=low ) speed after 22k MB of data usage.
Also, configure a notification for the ABY counter has a Notification-Reject at 20k MB.
•Create a quota management profile (slicing profile) with following parameters: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2065Charging User Guide Rating and charging –Slice Allocation Factor = 100 –MIN Slice Size = 200 MB –Slice Size = 4000 MB –Fixed VQT = 200 MB •Set the Ignore Reserved Amount to Counter .
•Set the hard-stop to true.
•Configure notification template.
Post-conditions: Execute a centralized SCUR with domestic call ( RG = 3300 ) as mentioned below: 1.CCR-I: RSU=empty, GSU=4200 MB 2.CCR-U1: USU=15900 MB, GSU=4100 MB, FUA with restrict access 3.CCR-U2: USU=4100 MB, GSU=0 MB, RSU=empty, FUA with restrict access 4.CCR-T: USU= 0 MB Example 3: GSU returned as zero with success result code for a multi-MSCC call with different rating group and device barred condition This example shows that for a multi-MSCC call with different rating group and device barred condition, GSU is set as 0 with success code 2001 and an FUA is sent with filter-id as per the mapping in complex map for INITIAL and UPDATE requests.
Preconditions: •Create a charging service, bundle, device, and account.
•Create a device entity lifecycle with timer set as 10 seconds, which changes the state from Active to Barred and again, back to Active .
And, after 90 seconds, it changes the state from Barred to Active .
•Create an SCUR-I call with RG=8 and RG=3300 .
•Create a device entity lifecycle with Barred state and the device is also in the Barred state.
•Create a complex map with proper entries of rating group and trigger type as follows: –For initial request: rating group = * , trigger type = is-barred , filter-id = INITIAL_DeviceBarred Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2066Charging User Guide Rating and charging –For update request (RG=8): rating group = *,trigger type = DEVICE_BARRED,filter-id = all_device_barred –For update request (RG=3300): rating group = 3300 ,trigger type = DEVICE_BARRED ,filter-id = Test1 Post-conditions: •Execute an SCUR call when a device is Barred state, then in INITIAL request CCR-I1: RSU= 10, GSU=10 MB , RG = 8, RSU= 15, GSU=15 MB , RG = 3300 •Execute an SCUR call when a device is Barred state, then in UPDATE request CCR-I1: RSU= 10, GSU=10 MB , RG = 8, RSU= 15, GSU=15 MB , RG = 3300 CCR-U1: USU= 15, GSU=15 MB, RG = 8, USU= 20, GSU=20 MB , RG = 3300 Result: After executing the preceding calls, this example verifies the following: •The output for an SCUR call when device is in Barred state in INITIAL request: 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is INITIAL_DeviceBarred .
When a device gets unbarred in an UPDATE request.
Execute an SCUR call with: USU= 10, RSU= 20 MB , RG = 8, RSU= 15, USU= 20 MB , RG = 3300 The output is: USU is granted as direct debit and for RSU, reservation is done.
•The output for an SCUR call when device is in Barred state in UPDATE request: For RG=8 : 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is all_device_barred .
For RG=3300 : 1.Result code is 2001 .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2067Charging User Guide Rating and charging 2.GSU is set as 0.
3.filter-id is Test1 .
When device gets unbarred in a TERMINATE request.
Execute an SCUR call with: USU= 10 MB, RG = 8, USU= 20 MB , RG = 3300 The output is: USU is granted as direct debit.
Example 4: GSU returned as zero with success result code for a multi-MSCC call with different rating group and subscription barred condition This example shows that for a multi-MSCC call with different rating group and subscription barred condition, GSU is set as 0 with success code 2001 and an FUA is sent with filter-id as per the mapping in complex map for UPDATE request.
Preconditions: •Create a charging service, bundle, device, and account.
•Create a subscription entity lifecycle with timer set as 10 seconds, which changes the state from Active to Barred .
And, after 90 seconds, it changes the state from Barred to Active .
•Create an SCUR-I call with RG=3300 and RG=3310 .
•Create a subscription entity lifecycle with Barred state.
•Create a complex map with proper entries of rating group and trigger type as follows: –For update request (RG=3300): rating group = *,trigger type = SUBSCRIPTION_BARRED,filter-id = SUB_BARRED –For update request (RG=3310): rating group = 3310 ,trigger type = SUBSCRIPTION_BARRED ,filter-id = All_SubBarred Post-conditions: •Execute an SCUR call when a subscription is in Barred state, then in INITIAL request CCR-I1: RSU= 10, GSU= 10 MB , RG = 3300 CCR-I1: RSU= 10, GSU= 10 MB , RG = 3310 •Execute an SCUR call when a subscription is in Barred state, then in UPDATE request Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2068Charging User Guide Rating and charging CCR-I1: RSU= 10, GSU=10 MB , RG = 3300, RSU= 10, GSU=10 MB , RG = 3310 CCR-U1: USU= 10, GSU=10 MB , RG = 3300, USU= 10, GSU=10 MB , RG = 3310 Result: After executing the preceding calls, this example verifies the following: •The output for an SCUR call when subscription is in Barred state in INITIAL request: For RG=3300 : 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is SUB_BARRED .
For RG=3310 : 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is All_SubBarred .
When subscription gets unbarred in an UPDATE request.
Execute an SCUR call with: CCR-U1: USU= 15, RSU= 20, RG = 3300 CCR-U1: USU= 15, RSU= 30, RG = 3310 The output is: USU is granted as direct debit and for RSU, reservation is done for both MSCC (RG = 3300 and RG = 3310).
•The output for an SCUR call when subscription is in Barred state in UPDATE request: For RG=3300 : 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is SUB_BARRED .
For RG=3310 : 1.Result code is 2001 .
2.GSU is set as 0.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2069Charging User Guide Rating and charging 3.filter-id is All_SubBarred .
•When subscription gets unbarred in a TERMINATE request.
Execute an SCUR call with: USU= 10 MB, RG = 3310, USU= 20 MB , RG = 3300 The output is: USU is granted as direct debit.
Example 5: GSU returned as zero with success result code for a multi-MSCC call with different rating group and account barred condition This example shows that for a multi-MSCC call with different rating group and account barred condition, GSU is set as 0 with success code 2001 and an FUA is sent with filter-id as per the mapping in complex map for UPDATE request.
Preconditions: •Create a charging service, bundle, device, and account.
•Create an account entity lifecycle with timer set as 10 seconds, which changes the state from Active to Barred .
And, after 90 seconds, it changes the state from Barred to Active .
•Create an SCUR-I call with RG=3300 and RG=3310 .
•Create an account entity lifecycle with Barred state.
•Create a complex map with proper entries of rating group and trigger type as follows: –For update request (RG=3300): rating group = *,trigger type = ACCOUNT_BARRED,filter-id = AccountBarred –For update request (RG=3310): rating group = 3310 ,trigger type = ACCOUNT_BARRED ,filter-id = All_AccountBarred Post-conditions: •Execute an SCUR call when an account is in Barred state, then in INITIAL request CCR-I1: RSU= 10, GSU= 10 MB , RG = 3300 CCR-I1: RSU= 10, GSU= 10 MB , RG = 3310 •Execute an SCUR call when an account is in Barred state, then in UPDATE request CCR-I1: RSU= 10, GSU=10 MB , RG = 3300, RSU= 10, GSU=10 MB , RG = 3310 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2070Charging User Guide Rating and charging CCR-U1: USU= 10, GSU=10 MB , RG = 3300, USU= 10, GSU=10 MB , RG = 3310 Result: After executing the preceding calls, this example verifies the following: •The output for an SCUR call when account is in Barred state in INITIAL request: For RG=3300 : 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is AccountBarred .
For RG=3310 : 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is All_AccountBarred .
When account gets unbarred in an UPDATE request.
Execute an SCUR call with: USU= 15, RSU= 20, RG = 3300 USU= 15, RSU= 30, RG = 3310 The output is: USU is granted as direct debit and for RSU, reservation is done for both MSCC (RG = 3300 and RG = 3310).
•The output for an SCUR call when account is in Barred state in UPDATE request: For RG=3300 : 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is AccountBarred .
For RG=3310 : 1.Result code is 2001 .
2.GSU is set as 0.
3.filter-id is All_AccountBarred .
When account gets unbarred in a TERMINATE request.
Execute an SCUR call with: USU= 10 MB, RG = 8, USU= 20 MB , RG = 3300 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2071Charging User Guide Rating and charging The output is: USU is granted as direct debit.
8.38 Allow threshold profile groups to be updated for devices previously subscribed to a bundle CAUTION : When a rule is created, modified, removed, or loaded, it takes a minimum of 30 seconds to load the RSV.
For any action that updates the rules (for example, a TPG value is updated from 10 to 20, an action is updated, or a Tariff Rule action is modified), the changes take effect after ~30 seconds.
Operators must wait for this time interval (30 seconds), to consider the change for feature implementation/execution.
This feature supports the ability to update thresholds defined within a Threshold Profile Group (TPG) in a counter, bucket, account, and Aggregate View (AV), which further applies to devices or groups to already attached TPGs.
The thresholds can be updated in the following means: •Changing the threshold values for existing thresholds.
•Removing an existing threshold.
•Adding new thresholds.
•Adding or modifying threshold conditions and actions in rule For example: Suppose there is a counter with ULI set as 5 GB and OLI set as 2 GB .
Threshold1 is applied at 50% for ULI notifiication and Threshold2 is applied at 100% for OLI notification, such as when counter value is 2.5 GB and 7 GB respectively, the ULI or OLI notification can be sent.
However, as per this feature, if Threshold1 value is changed to 25% for ULI notification and Threshold2 value is changed to 50% for OLI notification action, then whenever the next Gy request is received (and as per the current counter value), a notification is sent at 1.25 GB and 6 GB for ULI and OLI notifications, respectively.
Note : The TPG updates take effect only for those entities (which can be bucket, account, counter, or AV) that were a part of the current Diameter call when the next event is received from the network so that the impact is distributed over the time instead of overloading many updates all at the same time.
8.38.
1 Additional information Consider the following points for this feature: •This feature is applicable to Gy/Sy, NCHF, and VoLte/IMS calls.
•Any parallel updates in RSV with an entity containing rule should not be executed in the same time window.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2072Charging User Guide Rating and charging •The TPG definition is instantly updated but the update to RSV might take some sync up time.
•Once threshold definitions are updated, SNR actions defined in them are immediately picked for the policy counters on which threshold profile group is attached.
For other actions, thresholds are evaluated only after rule engine or RSV is updated with the new threshold rules.
Default time to start reloading of rules or RSV is 30 seconds.
•The usage type counters are considered for update to SNR related and policy counter state.
•If the counters for resource type and threshold are applied to those counters with values other than zero, then it does not send the updated SNR policy counter state.
•This feature supports the change in threshold value of type provisioning as well.
For example, if threshold of type is provisioned with a value as 10 and applied on a bucket resource with a current value as 7, then a user can update the value from 10 to 5, which means using provisioning when a bucket value is updated to 5, the provisioning threshold is executed and the configured notification is evaluated.
•The usage limit (ULI) can also be applied to counter resources with application of threshold (TPG) of percentage type.
The execution of ULI is as per the threshold applied on the ULI and further, the update as well.
For example, suppose a ULI of 5 GB is applied on counter and a threshold of 100% is applied on the ULI to receive a notification on consumption of 5 GB .
Now as per this feature, if threshold value is updated to 50% , then when the next Gy request is received, the notification is sent out as per threshold value 50% , which means, if counter value is 2.5 GB , then a notification is sent to the user.
8.38.2 Examples Consider the following examples for better understanding of this feature: Example 1: Behavior in case of Absolute thresholds This example enables us to understand the behavior of this feature in case of absolute thresholds.
Preconditions: 1.Subscribe a device to a bundle with a single unlimited counter defined as a policy counter, which is mapped to an external policy counter ID.
2.Include the threshold profile group in the bundle's counter, which further consists of a single absolute (throttling) threshold at 10 GB .
If the threshold value remains less than 10 GB , then the associated policy counter ID has a policy counter status of 1; whereas, if the data usage reaches the absolute threshold value or exceeds it, then the policy counter status changes to 2.
3.There are currently active Gy and Sy sessions for the device.
4.Considering that the current usage of counter is 9.8 GB , the associated policy counter has a policy counter status of 1.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2073Charging User Guide Rating and charging Execution of call: 1.A CCR-U is received for the device reporting usage of 200 MB .
This causes the counter value to reach the 10 GB absolute threshold triggering an SNR to be sent reporting a new policy counter status of 2 for the associated policy counter ID.
2.Due to a temporary disaster condition, the TPG associated with the bundle is updated to change the absolute value for the single threshold from 10 GB to 20 GB .
No action is taken for any existing data flows until new transactions are received from the network.
3.Another CCR-U is received reporting usage of 1 GB , which brings the usage of counter to 11 GB .
The CHF detects that the TPG associated with the subscribed bundle's counter has changed and the previous version is now out of date.
Therefore, the updated TPG is loaded and the system detects that the PC status for the policy counter associated with the counter whose value is 11 GB is changed because usage is now below the single threshold, so an SNR is generated for the associated policy counter ID with a PC status of 1.
4.The TPG used for the bundle is again updated, and this time adding a de prioritization threshold at 5 GB with a PC status of U1.
Again, no other action is taken for existing data flows until subsequent transactions are received.
5.An update profile API is invoked to change the BCR date of the account funding the bundle of the device, so that the next BCR date occurs on an earlier date.
This in turn, triggers the CHF to send an RAR for the active Gy session.
6.A CCR-U is received in response to the RAR sent in the previous step reporting an additional 500 MB of usage so that the counter value is updated to 11.5 GB.
At this point, the CHF detects that the TPG for the bundle subscribed to the device has been updated and loads the new TPG version, which in turn, results in the system detecting that the policy counter status has changed due to the addition of the new de-prioritization threshold triggering another SNR with a PC status value of U1 for the associated policy counter ID.
7.The disaster condition is resolved and the TPG is again updated to change the originally defined threshold back from 20 GB to 10 GB.
8.An initial Nchf_SpendingLimitControl_Create transaction is received, which triggers the CHF to detect whether TPG of the subscribed bundle has been updated, then the system reloads the latest version of TPG.
As the current value of the counter is above the original threshold, this triggers an SNR with a policy counter status value of 2 for the policy counter ID associated with the counter for the previously active Sy session, and the same policy counter ID and policy counter status value of 2 is returned in the response to the Nchf_SpendingLimitControl_Subscribe transaction as well.
Example 2: Behavior in case of Percentage thresholds Preconditions: 1.Subscribe a device to a bundle with a single counter with a defined counter usage limit of 10 GB.
2.Map the counter to a policy counter.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2074Charging User Guide Rating and charging 3.Include the TPG in the bundle, which has a single threshold for 100% of the counter ULI.
When usage is less than 100% of the counter ULI, the associated policy counter ID has a policy counter status of 1.
Whereas, when usage reaches or exceeds 100% of the defined usage limit, the PC status changes to 2.
4.There are currently active Gy and Sy sessions for the device.
5.The current usage of the counter is 6 GB , so the associated policy counter has a policy counter status of 1.
Execution of call: 1.The TPG associated with the bundle is updated to add a new threshold at 50% of the counter’s defined usage limit – with an associated PC status value of U1.
No action is taken for any existing data flows until new transactions are received from the network.
2.A CCR-U is received reporting usage of 500 MB bringing the counter’s usage to 6.5 GB.
The CHF detects that the TPG associated with the subscribed bundle has changed, which in turn, results in the system loading the new version of the TPG.
As the counter’s current usage is now greater than the new 50% threshold (= 5 GB given the counter’s 10 GB usage limit) an SNR is generated for the associated policy counter ID with a PC status of U1.
3.The TPG used for the bundle is again updated – this time to change the threshold value added in the first step from 50% to 75% of the counter limit.
4.Another CCR-U is received – reporting an additional 500 MB of usage so that the counter value is updated to 7 GB.
At this point, the CHF detects that the TPG for the bundle subscribed to the device has been updated and loads the new TPG version, which in turn, results in the system detecting that the current counter’s value is now below the first threshold (75% => 7.5 GB) and triggering an SNR with a policy counter status of 1 for the policy counter ID associated with the counter.
8.39 Carry-over for bundles This feature introduces the capability to carry over parts of a recurring bundle when a subscription is either renewed or reset for the next billing cycle.
For example, consider a monthly recurring bundle consisting of voice minutes, SMS, and data.
The voice minutes are configured to carry over in the monthly bundle.
At the end of the bundle period, the monthly bundle is renewed and balance for SMS and data services are reset.
The balance for voice minutes is also reset and available for use along with the pre-renewal balance.
The carried over balance is made available to an end user following either of the given scenarios: •In the first case, the carried over balance is made available only for one billing cycle.
At the end of each billing cycle, the carried over balance is overwritten, which means that the last unused carried over balance is lost.
•In the second case, the carried over balance does not expire.
At the end of each billing cycle, the new carried over balance is added to the existing carried over balance.
You can configure the maximum value of the amount that is carried over from the main bucket over the reset or renew billing cycle.
If any limit is defined for the carried over amount, then the final balance is capped to that limit.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2075Charging User Guide Rating and charging Attention : If a carryover is done from/to a multi-Bucket Bundle, the carryover value remains 0 for ChangePlan with IMMEDIATE, IMMEDIATE_MINUS_USED, NEXT_BILL_CYCLE, and IMMEDIATE_BACKDATED options.
8.39.
1 Configuration If the carry-over feature is configured, then either the initial value of the main bucket balance or the combined value of the main bucket balance and carried over bucket balance is used to calculate the threshold level.
The ThresholdNotificationType application preference is considered only when threshold is configured in percentage.
For more information refer Example 3: Threshold notification is triggered when the total of remaining bucket balance and carry-over balance exceeds the defined limit on page 2078 and Example 4: Total of remaining bucket balance and carry-over balance triggers a low-level threshold notification on page 2078 .
The carry over feature impacts the calculation of dynamic slicing as well.
The combined value of the main bucket balance and carried over balance is considered for dynamic slicing calculation.
For information on dynamic slicing functionality, see the Dynamic slicing on page 2016 section.
For information on Charging Data Records (CDRs) to record the carried over amount, see the NOKIA Smart Plan Suite CDR/EDR Reference guide.
8.39.2 Examples Consider the following examples for better understanding of this functionality: Example 1: Carry-over balance is made available only for one billing cycle Bob has a device associated with a bucket balance of 500 MB monthly recurring subscription.
After consumption for a month, it is found that only 300 MB is used and remaining 200 MB is available to be carried over to the next billing cycle to be used along with the renewed bucket balance of 500 MB.
If at the end of the next billing cycle, only 100 MB is used from the bucket balance, then only the remaining 400 MB bucket balance is carried over to the next billing cycle and the previous carried over 200 MB bucket balance is discarded.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2076Charging User Guide Rating and charging Figure 117: Carry-over bundle is made available only for one billing cycle 1.SM refers to Shared Monthly , which means only a bundle with a charging service containing a bucket.
2.SM CO refers to Shared Monthly Carry-Over bucket.
3.Period refers to the billing cycle.
Example 2: Defining the cap limit of carry-over balance Bob has a device associated with a bucket balance of 500 MB monthly recurring subscription.
The cap limit applied to the carried over bucket balance is 300 MB.
After consumption for a month, only 300 MB is used and the remaining 200 MB is available to be carried over to the next billing cycle.
If at the end of the next billing cycle, only 100 MB is used from the bucket balance, then only the remaining 400 MB bucket balance is added to the existing carried over bucket balance.
Since, after adding the new carried over balance to the existing carried over balance, the cap applied to the carried over bucket balance (300 MB) exceeds, the carried over bucket balance is limited only to 300 MB or the cap limit.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2077Charging User Guide Rating and charging 1.SM refers to Shared Monthly , which means only a bundle with a charging service containing a bucket.
2.SM CO refers to Shared Monthly Carry Over bucket.
3.Period refers to the billing cycle.
Example 3: Threshold notification is triggered when the total of remaining bucket balance and carry-over balance exceeds the defined limit Bob has a device associated with a recurring bundle of 1 GB configured with a 20 percent threshold notification.
At the end of the first billing cycle, only 500 MB of the bucket balance is consumed and the remaining 500 MB is available to be carried over to the next billing cycle.
The carried over balance is added to the renewed bucket balance of 1 GB and the total bundle balance is 1.5 GB.
The notification is triggered when the total of the remaining bucket balance and carried over bucket balance exceeds 20 percent of 1 GB, which is 200 MB.
Example 4: Total of remaining bucket balance and carry-over balance triggers a low-level threshold notification Bob has a device associated with a recurring bundle of 1 GB configured with a low-level threshold notification of 20 percent.
At the end of the first billing cycle, only 100 MB of the bucket balance is consumed and the remaining 900 MB is available to be carried over to the next billing cycle.
The carried over balance is added to the renewed bucket balance of 1 GB and the total bundle balance is 1.9 GB.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2078Charging User Guide Rating and charging The notification is triggered when the total of remaining bucket balance and carried over bucket balance exceeds 20 percent of 1.9 GB, which is 380 MB.
8.40 SNR action and QoS handling when charging resources are exhausted or updated The Send-SNR action on exhaustion of Aggregate Value (AV) can be achieved by configuring a threshold on AV exhaustion using an optional rule parameter that conveys the policy counter name within the Send-SNR action with the existing rule parameter of the policy counter status using the SM GUI or REST API.
The AV can be either of the following types: •Charging service •Charging service and Cap •Counter Note : •The Send-SNR action scenario is applicable to AV and buckets.
If AV is not used, then apply the same threshold configuration on the buckets.
For buckets with ChargingStep , the thresholds are configured only on zero value (as THRESHOLD_PROFILE.has-More-Steps is computed and set in the source context only when the unused value of the AV is zero).
•This feature can be configured for a policy counter when the Resource Based Flag is set to True in the counter definition.
No threshold should be attached to the policy counter, which is attached to a group or device.
•The policy counter name defined within the Send-SNR action of the threshold action must be attached either to a device or group depending on whether the AV or bucket is attached to a device or group.
•The Policy Threshold Flag should be checked in a threshold attached to the AV.
This feature allows AV or bucket to send an SNR during the provisioning or during a Diameter call when AV or bucket balance is updated.
If a CCR-U or CCR-T request is received, then at commit, a Send-SNR action is sent from the AV or bucket to throttle the speed to low when the committed value on the bucket or AV (accumulating charging services having single or multiple buckets or counters) is exhausted.
For information on step-charge scenario while handling a Send-SNR action for an AV, see the Step-charge scenario while handling Send-SNR action for AV on page 2083 section.
Sending an SNR during provisioning or call To send an SNR when AV is exhausted or incremented during provisioning or during a call, configure a threshold on AV updates.
The threshold is configured with a rule attribute SY.SEND-SNR with the following format: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2079Charging User Guide Rating and charging •The policy counter name and its state is configured for the Send-SNR action as C1,Low where C1 is the policy counter name and Low is the counter state.
•However, if you need to configure two counters, then it is configured as Send-SNR action as C1,Low;C2,High where C1,C2 indicate the policy counter names with Low and High as the counter states.
8.40.
1 Examples Example 1: Sending an SNR during provisioning when AV balance is updated This example indicates that a QoS is set from low to high and vice-versa when an AV has a step-charge bucket and the last step is consumed in commit.
It also indicates an SNR on provisioning when the AV is incremented or decremented using REST API.
Prerequisites: 1.Create two charging services: a.Create the first charging service CS1 having a bucket with initial value 100 MB and a policy usage counter C4.
b.Create the second charging service CS2 with a step bucket having 2 steps of 50 MB each, and no charge in the next pass.
2.Create a bundle with the two charging services CS1 and CS2.
3.Create a volume type threshold profile group (TPG) with the OCSPolicyThreshold flag set as True and rule with Send-SNR action ( C1,Low;C2,High;C3,Low;C5,High;C4,Low ).
4.The threshold value is set as 0 MB -Absolute from end and is used during the call.
Create two more thresholds ABS and ABE for provisioning the SNR with action condition isDiameterCall=false and result context with action triggerType=provisioning , which triggers the Send-SNR action to toggle all counters.
The two thresholds ABS and ABE have threshold configured on value 0.
5.Create an AV of type Byte accumulating both the charging services created before and the TPGs.
6.Create counters C1, C2, C3, C5, and C6 of type MByte,usage/all/all with an OCSPolicyCounter and resourceBased flags set as True .
7.Create a device and a group having that device.
Associate the above created counters C1, C5, and C6 to the group, C2 to the device-group, and C3 to the device.
Add the previously created AV to this group and subscribe the bundle to this group.
8.Set the default signalling state in the SLA (initial) flag as False .
9.Create a quota management profile (slicing profile) with Slice Size set as 104857600 bytes or 10 MB , SAF set as 100% and Minimum Slice Size set as 2097152 bytes or 2 MB .
Scenario: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2080Charging User Guide Rating and charging 1.Execute a centralized SCUR call such that: CCR-I: RSU = empty and GSU = 10 MB CCR-U1: USU = 100 MB, RSU = empty, and GSU = 10 MB CCR-U2: USU = 50 MB, RSU = empty and GSU = 10 MB CCR-T: USU= 100 MB 2.Update bucket1 to 50 MB so that AV is incremented.
3.Update bucket1 to 0 MB so that AV is decremented.
Result: 1.Before receiving the CCR-U1 request, all counters state were set to default, which is -99.
When the CCR-U2 request is received, threshold is triggered but given that we have a step bucket, SNR is not triggered.
The SNR is triggered on receiving a CCR-T request when the AV gets exhausted and an SNR is sent with the values of C1, C3, and C4 set as Low, and the values of C2 and C5 set as High .
2.If a bucket is incremented after the call, then the ABS provisioning threshold is triggered and an SNR is sent with updated counter value as per the configuration.
3.If a bucket is decremented after increment, then the ABE provisioning threshold is triggered and an SNR is sent with updated counter value as per the configuration.
Note : During provisioning, ABE threshold is considered for sending SNR in case of decrement in value and ABS threshold is considered for sending SNR in case of increment in value.
Example 2: Sending an SNR through Diameter call Prerequisites: 1.Create two charging services CS1 and CS3 having individual buckets with initial value of 100 MB each.
2.Create another charging service CS2 with no charge.
3.Create a bundle with the charging services CS1, CS2, and CS3.
4.Create a volume type TPG with the OCSPolicyThreshold flag set as True and rule with Send-SNR action ( C1,Low ).
The threshold value is set as 0 MB -Absolute from end .
5.Create an AV of type MByte accumulating all the charging services created before and the TPG.
6.Create a counter of type MByte, usage/all/all having the OCSPolicyCounter and resourceBased flags set as True .
7.Create a device and a group having that device.
Associate the above created counter to group and add above created AV to this group and subscribe the bundle to this group.
8.Create a quota management profile (slicing profile) with Slice Size set as 104857600 bytes or 10 MB , SAF set as 100% and Minimum Slice Size set as 2097152 bytes or 2 MB .
Scenario: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2081Charging User Guide Rating and charging Execute a centralized SCUR call such that: CCR-I: RSU = empty and GSU = 100 MB CCR-U1: USU = 100 MB, RSU = empty, and GSU = 100 MB CCR-U2: USU = 99 MB, RSU = empty, and GSU = 2 MB CCR-T: USU = 100 MB Result: 1.In CCR(U1) and CCR(U2), the counter state is set as default( -99) given that in CCR(U1), complete reservation is done from AV and in CCR(U2), 1 MB is reserved from AV.
In CCR(T), QoS is set to low and SNR is sent with counter value set as Low because AV becomes 0 in terminate.
2.In CCR(U2) as after commit, remaining value in AV is 1 MB.
Therefore, 1 MB is reserved from AV as slice reduction is done as per the configuration and remaining 1 from no charge as min slice is 2 MB.
8.41 Step-charge functionality A subscriber may have a tariff plan with a group bundle or individual bundle.
When the bundle is consumed completely and the volume of bundle is zero, subscriber cannot make data calls.
To provide more flexibility to subscribers, operators can define bucket steps so that the bucket value increments when the volume is zero.
That is, the operators can define bundles with step configuration and bucket amount available in steps.
When such bundles are subscribed, the bucket is initialized to the first step value and these steps are managed by an entity named as Charging Step .
The steps can be added, deleted, or modified using the SM GUI or REST API and the number of steps is reset at subscription reset or subscription renewal at the start of the next billing cycle when a bucket is reset to its first step value.
Note that the priority of main bundle is greater than the priority of step bundles.
NCC uses the bundles for calls based on the configuration made.
Operators can also define a fee for the steps.
That is, during a call, when the step bundle is used, operators can charge fee for each step increment.
If the account does not have sufficient amount for fee, then next charging service is selected for the call.
The last step defined in the Charging Step can be repeated until the plan is reset.
Currently, the step-up fee deduction and step count increment is done at the time of reservation.
You can change this behavior by setting the application preference, Step-up On Commit flag to True .
Once this flag is set to true, the Step-up fee deduction and step count increment is done at the time of commit.
See Example 6: Step up on commit (under commit scenario) on page 2101 .
Notifications can also be sent before an x amount, which is the sum of all buckets in Pass 0 is consumed.
This x amount threshold is managed using the aggregate view configured at group or device level.
See Step-charge threshold and notifications on page 2091 for more details.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2082Charging User Guide Rating and charging 8.41.
1 Step-charge customization If a bundle is configured with step-bucket and is subscribed to a Group or Device that has other subscription instances, then the following logic is followed when a call is triggered: •All the resources are consumed first that are configured in Pass 0 along with current step of step- bucket.
•The step-bucket is moved to next step when no other resource is left in Pass 0.
For example, consider that a Device has 5 subscriptions attached where the subscription 3 has a step- bucket with multiple steps.
When a call is triggered, in Pass 0, the resource is consumed from subscription 1, subscription 2, first step of subscription 3 followed by subscription 4 and subscription 5.
When no resource is left in Pass 0, the step-bucket is moved to next step of subscription 3 for usage.
This default behavior of step-bucket usage is applicable to all passes.
When a step is to be incremented in the charging step associated with a bucket, the bucket state must be checked if it is barred or final.
When reset is performed, the value must be reset to the first step.
Operators can modify this default behavior and provide flexibility to consume all the steps of step-bucket before moving to the next resource.
This is applicable even when some resource is available for usage.
For example, in the above scenario, all the steps of subscription 3 are consumed followed by subscription 4 and then subscription 5.
To enable this behavior, set the application preference Use All Steps First to true .
Refer to section Managed Element application preferences in the Global Configuration Guide for details on Use All Steps First application preference.
See Example 7: Step up on commit (custom behavior) on page 2101 and Example 8: Step up on reservation (custom behavior) on page 2102 for examples related to customized step-up behavior.
Limitations of step-charge Send-SNR scenario The THRESHOLD_PROFILE.has-More-Steps is a flag, which determines whether step-up is pending in a bucket or a bucket is accumulated by an AV (depending on which the threshold is attached to) using a Charging Step .
However, this flag cannot determine whether bucket step-up happened successfully or not.
Note : There is only one scenario wherein the bucket step fails even when charging steps are pending in the bucket.
It is when there is some fees attached on the next step, which is to be deducted from the account balance and account does not have enough balance to pay for the fee of the next step.
Therefore, in case of Charging Step with the fee, this rule attribute does not check fee availability and only checks any pending steps in the bucket or bucket accumulated by an AV.
8.41.2 Step-charge scenario while handling Send-SNR action for AV If the AV has a step-charge bucket and the steps of that bucket are outstanding, then the bucket balance is top-up in the next reservation.
Therefore, the AV value also increases and to avoid sending an SNR on the AV value during commit, the rule attribute SY.SEND-SNR is introduced in the THRESHOLD_PROFILE with the following format: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2083Charging User Guide Rating and charging if THRESHOLD_PROFILE.has-More-Steps = BooleanEnum.FALSE then SY.SEND-SNR = C1,Low Refer to the example Example 1: Sending an SNR during provisioning when AV balance is updated on page 2080 for more information.
8.41.3 Step-bundle examples Step-bundle without fee Consider that a device has group subscriptions and device subscriptions.
The group subscriptions have high priority with high QoS, and the device subscriptions have low priority with low QoS.
When all the group subscriptions exhaust, the device subscriptions with low QoS are consumed.
Operators can manage the high and low QoS using the resource based policy counters.
When the bundle with charging step configuration is initially subscribed to a group, the value of the first step is written into the initial value of the step charge bucket instance.
The following figure shows an example of step charge function.
Initially, only 1 GB of Shared Monthly (SM) bundle is available to the user and when this 1 GB of SM is exhausted, it moves to next available resource.
In the following example, shared bundle 1, shared bundle 2, shared bundle 3 is checked in the same order.
When all the shared bundles are consumed and there is no amount available, then you can step-up to SM bundle.
The top-up is performed incrementally.
After top-up, the initial value of SM becomes 2 GB out of which 1 GB is available for use.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2084Charging User Guide Rating and charging When a periodic subscription reset/renew happens, all the buckets are reset.
If a bucket has a step charge defined, then the value of bucket is set to the value of first step.
You can delete any step from existing Charging Step configuration.
For example, if step size is reduced from 3 to 2 during the call, all the instances linked to that step and currently are on step 3, continue and after exhaustion, no top-up is done.
Step-bundle with fee Consider that a bundle has 1 day periodic lifecycle.
A Charging Step of 1 step with 1 MB and bundle fee of 1 USD is defined.
This step repeats until reset/renewal of bundle.
The bundle fee for renewal is 1 USD.
The device subscribes to this bundle and 1 USD is deducted from the device account and the bucket has 1 MB.
Here, 1 USD is the bundle fee and not the step fee.
Following consumption is done: 1.CCR-I, RSU 0.1 MB on 17.8.2019 -> 0.1 MB is reserved and 0.9 MB is available 2.CCR-U, USU 0.1 MB, RSU 1.5 MB on 17.8.2019 -> Commit 0.1 MB, step-up is done, 1 USD is deducted from account and 1 MB is added to bucket, total bucket value is 1.9 MB, 1.5 MB is reserved from 1.9 MB and 0.4 MB is available 3.CCR-U, USU 1.5 MB, RSU 0.2 MB on 17.8.2019 -> Commit 1.5 MB, 0.2 MB is reserved and 0.2 MB is available 4.CCR-T, USU 0.2 MB -> Commit 0.2 MB, available is 0.2 MB The subscription is renewed and a renewal fee of 1 USD is deducted from the account and bucket has 1 MB available.
Following consumption is done: 1.CCR-I, RSU 0.1 MB on 18.8.2019 -> 0.1 MB is reserved and 0.9 MB is available 2.CCR-T, USU 0.1 MB on 18.8.2019 -> 0.1 MB is reserved and 0.9 MB is available Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2085Charging User Guide Rating and charging Configuring a charging step To configure a charging step, perform the following steps: 1.Configure the Charging Step entity.
2.Attach the Charging Step to a bucket in the Charging Services entity.
See Tiered Allowances (Charging Step) on page 1458 for parameter details.
8.41.4 Overriding Step-charge fee and Step Size For enhancing the functionality of the step charging feature, the following requirements are considered: •If a subscriber is calling from home location, a low step fee can be applied for a step bucket.
If the subscriber is calling from other roaming locations, a higher step fee can be applied for the same step bucket.
•The tax is fixed and does not vary based on location or zone.
Hence, varying tax based on steps is not required.
Taxation is not considered for rule based step size and step fee implementation.
•Step one for step charging cannot be configured using the rule configuration for the zone.
When the step bucket is selected, NCC considers the step size of the first step from the charging step static configuration.
•Addition of remaining step size of one zone to the other defined zone : –Subscriber can use the remaining step size of one zone (home location) in another zone (roaming location) if available.
It is available to the subscriber when the subscriber moves into the other zone (roaming location).
In case subscriber has finished the available steps and step size for all zones, then the subscriber can start using the other step bucket or normal bucket, if applicable.
–In case the subscriber reserves step fee in zone 1 (home location) and moves into zone 2 (roaming location), then due to the zone change, the network triggers NCC.
NCC commits the reserved amount of zone 1 (home location).
The new step fee for zone 2 (roaming location) is reserved, and the roaming location step size is allocated to the bucket.
In this case, the subscriber can use the remaining step size of zone 1 (home location) in zone 2 (roaming location), starting from step 2, if available.
–In case the subscriber reserves step fee in zone 2 (roaming location) and moves into zone 1 (home location) again during a call, then due to the zone change, the network triggers NCC.
NCC commits the reserved amount of zone 2 (roaming location).
The new step fee for zone 1 (home location) is reserved when the bucket is stepped in zone 1 (home location).
In this case, the subscriber can use the remaining step size of zone 2 in zone 1.
The remaining zone 1 step balance is added to the available balance.
•Unlimited steps usage scenario using rule : The unlimited steps scenario can be used with the step charging rule.
You can define the step size, and step fee for unlimited steps into tariff formula step override rules.
When you define unlimited steps for a step bucket, the defined step size and step fee for that zone are applied to all upcoming steps.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2086Charging User Guide Rating and charging –Tariff formula rule configuration for Home if CALL_COMMON.Call-Type = CallType_PS and CALL_COMMON.Call-Roaming-Status = RoamingDecision.HOME then RATING.Bucket-Selection = “Step_Bucket” and RATING.Bucket-Step-Override ( 2, 2, 20 ) RATING.Bucket-Step-Override ( unlimited, 4, 40 ) –Tariff formula rule configuration for Roaming if CALL_COMMON.Call-Type = CallType_PS and CALL_COMMON.Call-Roaming-Status = RoamingDecision.ROAMING then RATING.Bucket-Selection = “Step_Bucket” and RATING.Bucket-Step-Override ( 2, 5, 60 ) and RATING.Bucket-Step-Override ( unlimited, 7, 80 ) •Step Range definition using rule : A few products use the same step size and step fee are for certain steps.
The step size and step fee for the other steps may change.
In rule definition, it is possible to define same step fee and step size for a range of steps.
–Tariff formula rule configuration for Home if CALL_COMMON.Call-Type = CallType_PS and CALL_COMMON.Call-Roaming-Status = RoamingDecision.HOME then RATING.Bucket-Selection = “Step_Bucket” and RATING.Bucket-Step-Override ( 2-10, 2, 20 ) and RATING.Bucket-Step-Override ( 11, 3, 30 ) and Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2087Charging User Guide Rating and charging RATING.Bucket-Step-Override ( unlimited, 4, 40 ) –Tariff formula rule configuration for Roaming if CALL_COMMON.Call-Type = CallType_PS and CALL_COMMON.Call-Roaming-Status = RoamingDecision.ROAMING then RATING.Bucket-Selection = “Step_Bucket” and RATING.Bucket-Step-Override ( 2-10, 5, 60 ) and RATING.Bucket-Step-Override ( 11, 6, 50 ) and RATING.Bucket-Step-Override ( unlimited, 7, 80 ) •Parallel usage of step bucket using rules : If multiple devices use the same bundle with step bucket, then the NCC step charging logic can execute tariff formula charging step override rule configuration for multiple devices from the same step bucket.
•When the subscriber has twin SIMs, and has one Gy session from zone 1 using the first SIM, and another Gy session from zone 2 using the second SIM.
If the first commit pays the fee based on the current zone, then the second commit on the other Gy session should not pay the step fee unless the bucket is stepped.
Attention : Twin SIM feature supports configuring a device identifier with ONL Y two E164s and one IMSI.
It is NOT recommended to use more than two E164s and more than one IMSI.
•Rules for multiple zones can be configured within the tariff formula pass rules, with varying step size and step fee based on steps.
–Tariff formula rule configuration for Zone1 if CALL_COMMON.Call-Type = CallType_PS and CALL_COMMON.Call-Roaming-Status = RoamingDecision.Zone1 then RATING.Bucket-Selection = “Step_Bucket” and RATING.Bucket-Step-Override ( 2, 2, 20 ) and RATING.Bucket-Step-Override ( 3, 3, 30 ) and RATING.Bucket-Step-Override ( unlimited, 4, 40 ) –Tariff formula rule configuration for Zone2 if Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2088Charging User Guide Rating and charging CALL_COMMON.Call-Type = CallType_PS and CALL_COMMON.Call-Roaming-Status = RoamingDecision.Zone2 then RATING.Bucket-Selection = “Step_Bucket” and RATING.Bucket-Step-Override ( 2, 5, 50 ) and RATING.Bucket-Step-Override ( 3, 6, 60 ) and RATING.Bucket-Step-Override ( unlimited, 7, 70 ) –Tariff formula rule configuration for Zone3 if CALL_COMMON.Call-Type = CallType_PS and CALL_COMMON.Call-Roaming-Status = RoamingDecision.Zone3 then RATING.Bucket-Selection = “Step_Bucket” and RATING.Bucket-Step-Override ( 2, 8, 80 ) and RATING.Bucket-Step-Override ( 3, 9, 90 ) and RATING.Bucket-Step-Override ( unlimited, 10, 100 ) •Units of step size and step fee : NCC always considers the unit type defined in the charging step static configuration for the defined step size and step fee in the tariff formula rules.
The step fee and step size in the tariff formula rule configuration accept only the positive numeric values.
In case a charging step is not associated with a bucket, but the charging service rule formula is configured with the charging step definitions, then the NCC rating ignores the step override rule execution, and considers it as a normal bucket.
The Bucket-Step-Override rule contains the following attributes.
•Step-Number •Step-Fee •Step-Size Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2089Charging User Guide Rating and charging Attribute Criteria Description Step- Number Mandatory It indicates the current step to be overridden for step fee and step size.
Step- Fee Optional It indicates the step fee to be applied for charging the step override rule.
Step- Size Optional It indicates the step size to be applied for charging the step override rule.Table 232: Bucket-Step-Override rule attributes The Step-Number attribute in the Bucket-Step-Override rule can be configured as follows: Value type Description Specific Step Numbers.
For example: 2, 3, and so on.If the Step- Number is specified as a number, then the defined Step fee, and Step Size are applicable to the mentioned step number.
Step Number Range.
For example 2 to 12.If Step- Number is defined in a number range , then the defined Step fee, and Step Size are applicable to the mentioned range of step numbers.
Unlimited If the Step- Number is defined as unlimited, then the defined Step fee, and Step Size are applicable to all upcoming step numbers.
All If the Step- Number is defined as All, then the Step fee, and Step Size are applicable to all the step numbers defined in the charging step static configuration, except the unlimited step.Table 233: Configuring Step-Number attribute Note : Step-Number cannot take the value as 1.
To override the step fee, and step size for the step numbers, all the step numbers defined in the bucket step override rule should also be defined in the charging step static configuration.
If step number is not Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2090Charging User Guide Rating and charging defined in charging step static configuration, then bucket step override rule does not override the step fee, and step size for those steps.
8.41.5 Step-charge threshold and notifications Operators can send notifications before the extension (step-up) using aggregate view threshold applied on group or device subscriptions, for example, before x MB is consumed.
Notifications can also be sent after the successful extension (step-up).
Example: Notification sent before X MB consumption To send notification before X MB, for example, 10 MB is remaining in aggregate view, configure the following entities: •Create a charging service.
•Create a threshold profile group with following values: –Threshold Value = 10 MB –Threshold Profile Type = ABSOLUTE FROM END –Reservation Threshold = False •Create an aggregate view for group or device subscriptions and apply the threshold that is already created.
See Example 5: Step-up notification on page 2099 for details on step-up notification.
8.41.6 Increment counters for step-charge functionality Currently, the logic to deduct step-fee from an account has been enhanced to consider the applicable cost counters.
All applicable counters include global cost counters (device counters, group counters, or device-group counters) or subscription cost counters, which are updated with the step-fee as a part of call processing.
The step-fee is considered as a normal spending limit.
This enhancement in step-charge functionality considers the following points: •This logic is applicable only when the Step-up On Commit application preference flag is set as true .
•For global counters, both deductions from step-fee and main balance are counted.
•For subscription counters attached to step-bucket, only deduction from step-fee is counted.
•Before the step-fee reservation, cap, threshold, slice reduction logic is evaluated on all applicable step-bucket counters.
•The threshold and cap actions are executed at commit.
Note : AV logic is not fully supported for step counters.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2091Charging User Guide Rating and charging Examples Consider the following examples to understand this functionality in a better way: Preconditions: Consider the following counters: •Global cost counter CC1 , which can be a device counter or group counter.
•Global cost counter CC2 , which can be a device counter or group counter applicable to roaming zone.
A threshold is configured to Send-Notification action at 50% and another notification with Reject action at 100%.
•Subscription cost counter CC3 , subscription volume counter VC1, and step-bucket SB1 applicable for all conditions.
Example 1: A user makes a call in roaming with tariff rule as: •Bucket-Selection = SB1 Therefore, the expected output for counter update, CC1 and CC2 is applicable and subscription counter is not specified in tariff rule.
Example 2: A user makes a call in local zone or home zone with tariff rule as: •Bucket-Selection = SB1 Therefore, the expected output for counter update, CC1 and CC2 are not applicable and subscription counter is not specified in tariff rule.
Example 3: A user makes a call in roaming zone with tariff rule as: •Bucket-Selection = SB1 •Counter-Selection = CC3 Therefore, the expected output for counter update, CC1 , CC2 , and CC3 are applicable.
Example 4: A user makes a call in roaming zone with tariff rule as: •Bucket-Selection = SB1 •Counter-Selection = CC3 •Counter-Selection = VC1 Therefore, the expected output for counter update, VC1, CC1 , CC2 , and CC3 are applicable.
8.41.7 Additional information Following are some important points to note for this feature: •Do not top-up a bucket with step-charge configuration.
If a top-up is done, then the current step-size is increased.
•The category order is not considered.
•Carry-over works as per the configuration defined in the bucket entity.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2092Charging User Guide Rating and charging •The prorate or refund functionality works as per the configurations made.
•It is recommended not to delete the charging step when it has any active reference with the bucket.
•Operators cannot reduce the steps from 1 to 0.
•Subscription customization (template) is not supported.
•The fee defined for the step can be same or different based on your requirement.
•Modification to the first step value in Charging Step does not impact the attached bucket initial value.
To keep the data in synchronization, perform an update on the charging service to modify the bucket initial value as well.
•For step-up notification, ensure that only one threshold is embedded within a threshold profile.
For generic threshold configurations, separate threshold profiles or threshold profile groups can be used.
•It is recommended to configure a reference to bucket with Charging Step only in Pass 0.
•For step-up notification, add a condition of THRESHOLD_PROFILE.Bucket-Current-Step > 1 before Send-Notification action.
This ensures that the step-up notification is not sent during reservation from step 1 and is sent for all other steps.
8.41.8 Examples Consider the following examples for better understanding of this feature: Example 1: Device subscription to a step bundle In this example, a step bundle is created, which is subscribed by a device.
Perform the following steps to create a step bundle using the SM GUI.
1.Create a charging step using the Charging Step entity as shown in the following figure.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2093Charging User Guide Rating and charging 2.Create a charging service with bucket and link the charging step to it.
Once you select the Charging Step while bucket creation, the Initial Value field on the GUI is grayed out.
This means, the value of charging step is taken as the bucket initial value.
3.Create a step bundle and associate the charging service created in previous step.
4.Create an account to be associated with the device.
5.Create a device and add the step bundle as subscription.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2094Charging User Guide Rating and charging The device overview shows the bundle subscribed along with the initial value which is the step 1 value defined in the charging step.
Example 2: Consumption from multiple steps of a step bucket (OK case) A device has only device subscriptions as shown in the following figure: As shown in the preceding figure, the charging services are configured as follows: •CS1 (Bucket1) = 100 Byte •CS2 (Bucket2) = 100 Byte (3 steps are configured as 100, 100, 100) •CS3 (Bucket3) = 100 Byte First RSU is 200 bytes The reservation is done in the following manner: Bucket 1 -100 Bucket 2(Step-1) -100 Bucket 3 -0 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2095Charging User Guide Rating and charging The bucket values are as follows: •CS1 (Bucket 1) = 0 •CS2 (Step-1) = 0 •CS3 (Bucket 3) = 100 Second RSU is 300 bytes The reservation is done in the following manner: Bucket 3 -100 Bucket 2(Step-2) -100 Bucket 2(Step-3) -100 The bucket values are as follows: •CS1 (Bucket 1) = 0 •CS2 (Step-2, Step-3) = 0 •CS3 (Bucket 3) = 0 In the same request, consumption can be done from multiple steps of a Step Bucket if in between there was no consumption from any other bucket.
In the current case, first 100 bytes were consumed from Bucket 3 and then 200 bytes from Bucket2.
In this case, the RATING RESULT is OK.
Example 3: Consumption from multiple steps of a step bucket (POK case) A device has both device and group subscriptions as shown in the following figure.
Subscription Index is set as DEVICE_FIRST.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2096Charging User Guide Rating and charging Device subscription has three subscriptions as follows: •CS1 (Bucket1) = 100 Byte •CS2 (Step Bucket2) = 100 Byte (3 steps configured as 100, 100, 100) •CS3 (Bucket3) = 100 Byte Group subscription has three subscriptions as follows: •CS4 (Bucket4) = 100 Byte •CS5 (Step Bucket5) = 100 Byte (3 steps configured as 100, 100, 100) •CS6 (Bucket6) = 100 Byte RSU is 400 bytes The reservation is done in the following manner: Bucket 1 -100 Bucket 2(Step-1) -100 Bucket 3 -100 Only 300 bytes are reserved from buckets.
The bucket values are as follows: Device subscription: •CS1 (Bucket1) = 0 •CS2 (Step-1) = 0, Step-2 = 100, Step-3 = 100 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2097Charging User Guide Rating and charging •CS3 (Bucket3) = 0 Group subscription: •CS4 (Bucket4) = 100 •CS5 (Step Bucket5) = 100 (3 steps configured as 100, 100, 100) •CS6 (Bucket6) = 100 In this case, the RATING RESULT is POK .
In the same request, consumption cannot be done from multiple steps of a Step Bucket if in between some bytes were consumed from any other bucket.
Example 4: Mix match device subscription This example shows that the step charge does not work for mix match cases.
In this example, let us consider that a device has a mix-match subscription.
For mix-match Device-Group subscription, the category order is CS1 is 1, CS2 is 2, CS3 is 3, CS4 is 4, CS5 is 5, and CS6 is 6.
The following figure shows the mix-match device subscription: First device subscription has two subscriptions as follows: •CS1 (Bucket1) = 100 Byte •CS2 (Step Bucket2) = 100 Byte (3 steps configured as 100, 100, 100) Second group subscription has two subscriptions as follows: •CS3 (Bucket4) = 100 Byte •CS4 (Step Bucket5) = 100 Byte (3 steps configured as 100, 100, 100) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2098Charging User Guide Rating and charging Third device subscription has two subscriptions as follows: •CS5 (Bucket1) = 100 Byte •CS6 (Step Bucket2) = 100 Byte (3 steps configured as 100, 100, 100) RSU is 300 bytes The reservation is done in the following manner: Bucket 1 -100 Bucket 2(Step-1) -100 Bucket 3 -100 Step charging does not work in this case.
After reservation of 200 bytes from device subscription, the next reservation happens from the group subscription instead of device subscription bucket2 step-2 or device subscription bucket5.
The bucket values are as follows: First Device subscription: •CS1 (Bucket 1) = 0 •CS2 (Step-1) = 0, Step-2 = 100, Step-3 = 100 Second Group subscription: •CS3 (Bucket 1) = 0 •CS4 (Step Bucket 5) = 100 (3 steps configured as 100, 100, 100) Third Device subscription: •CS5 (Bucket 1) = 100 •CS6 (Step Bucket 2) = 100 (3 steps configured as 100, 100, 100) In this case, the RATING RESULT is OK.
Example 5: Step-up notification For step-up notification, create a threshold with the following values and attach it to a step bucket.
•Threshold value = 0 Byte •Threshold profile type = ABSOLUTE FROM START •Reservation Threshold = True The following figure shows the threshold profile group configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2099Charging User Guide Rating and charging The following figure shows the threshold rule configured: Note that the step bucket must be defined in the Charging Services entity.
This step bucket can be attached to a step in the Charging Step entity.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2100Charging User Guide Rating and charging Example 6: Step up on commit (under commit scenario) Consider that an account has a balance of 100 units and has the following two bundles: •Bundle 1 has a 1 MB normal volume bucket and •Bundle 2 has a step-up bucket of 1 step with a step fee of 1 unit per step with unlimited option selected The application preference parameter Step-up On Commit is set to True .
A CCR(I) arrives with an empty RSU and NCC grants units as shown in the following table.
Note that the step up fee is deducted from the account only when the actual usage is committed.
Account balanceBundle 1 Bundle 2 Current Step USU GSU Without ReservationWith ReservationPass0- Bucket1Pass0- Bucket2Pass1- Stepbucket Initial valueCurrent value Before call100 100 1 MB 0 MB 0 MB 0 MB 1 CCR( I) 5 MB 96 100 0 MB 0 MB 4 MB 0 MB 1 CCR( U) 2.2 MB 5 MB 93 98 0 MB 0 MB 7 MB 0.8 MB 3 CCR( T) 2.1 MB 96 96 0 MB 0 MB 4 MB 0.70 MB 5 Example 7: Step up on commit (custom behavior) Consider that the step charging from step buckets is configured with steps and step fees in Pass 0 and step-up is configured to be done at commit.
The Use All Steps First application preference parameter is set to true .
The account has a balance of 100 units and has the following bundles: •Bundle 1 has a normal bucket without steps •Bundle 2 has a step-bucket with step size of 4 MB, 7 MB, and 5 MB, step fee is 2 units for second step, 1 unit for third step •Bundle 3 has a normal bucket without steps Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2101Charging User Guide Rating and charging Account balanceBundle 1 Bundle 2 Bundle 3 USU GSU Without ReservationWith ReservationBucket 1 Step Bucket Bucket 3 Initial value Current valueCurrent Step Before call 100 100 1 MB 4 MB 4 MB 1 10 MB CCR( I) 5 MB 100 100 0 MB ( 1 MB is reserved)4 MB 0 MB ( 4 MB is reserved)1 10 MB CCR( U1) 5 MB 5 MB 98 100 0 MB ( 1 MB is commited)11 MB 2 MB ( 4 MB is committed + 5 MB is reserved)1 10 MB CCR( U2) 5 MB 5 MB 97 98 0 MB 16 MB 2 MB ( 5 MB is committed + 5 MB is reserved)2 10 MB CCR( U3) 5 MB 5 MB 97 97 0 MB 16 MB 0 MB ( 5 MB is commited + 2 MB is reserved)3 7 MB ( 3 MB is reserved) CCR( T) 5 MB 97 97 0 MB 16 MB 0 MB ( 2 MB is commited)3 7 MB ( 3 MB is committed) Example 8: Step up on reservation (custom behavior) Consider that the step charging from step buckets is configured with steps and step fees in Pass 0 and step-up is configured to be done at reservation.
The Use All Steps First application preference parameter is set to true .
The account has a balance of 100 units and has the following bundles: •Bundle 1 has a normal bucket without steps •Bundle 2 has a step-bucket with step size of 4 MB, 7 MB, and 5 MB, step fee is 2 units for second step, 1 unit for third step •Bundle 3 has a normal bucket without steps Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2102Charging User Guide Rating and charging Account balanceBundle 1 Bundle 2 Bundle 3 USU GSU Without ReservationWith ReservationBucket 1 Step Bucket Bucket 3 Initial value Current valueCurrent Step Before call 100 100 1 MB 4 MB 4 MB 1 10 MB CCR( I) 7 MB 98 98 0 MB ( 1 MB is reserved)11 MB 5 MB ( 6 MB is reserved)2 10 MB CCR( U1) 5 MB 7 MB 98 98 0 MB ( 1 MB is commited)11 MB 0 MB ( 4 MB is committed + 7 MB is reserved)2 10 MB CCR( U2) 5 MB 7 MB 97 97 0 MB 16 MB 0 MB ( 5 MB is committed + 7 MB is reserved)3 10 MB CCR( U3) 5 MB 7 MB 97 97 0 MB 16 MB 0 MB ( 5 MB is commited + 2 MB is reserved)3 5 MB ( 5 MB is reserved) CCR( T) 5 MB 97 97 0 MB 16 MB 0 MB ( 2 MB is commited)3 7 MB ( 3 MB is committed) 8.42 Adding custom-defined tags at rating level using Add-CDR action This feature enables to add custom-defined CDR tags at rating level using Add-CDR action.
These CDR tags are dynamically updated for a Gy request call.
A new trigger RESOURCE_POST_PROCESSING has been introduced and the Add-CDR action supports the functionality to add a CDR tag at rating level only in case of RESOURCE_POST_PROCESSING trigger at: •CHARGING_SERVICE_LEVEL •RESOURCE_LEVEL The RESOURCE_POST_PROCESSING is evaluated after the consumption of resource (for example, bucket, counter, No-Charge , or main account balance) only in UPDATE and TERMINATE calls, and not in INITIAL call.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2103Charging User Guide Rating and charging For a resource-level tag, the resource type (such as, bucket, No-Charge , main account balance, Device counter, Device- Group counter, Group counter, Multi-bundle counter, or Subscription counter) must be defined.
Note : Apart from Subscription type of counter, the custom-defined CDR tags are not dumped at charging service level for other types of counters.
Override parameter If multiple Call-Result.Add-CDR actions are configured with same tag name, then all of them are logged in the CDR, which means it is possible to have multiple custom CDR entries with same tag name, at a given level in the CDR.
An optional parameter Override is introduced to overwrite the custom tags with same name.
This parameter is only supported in the RESOURCE_POST_PROCESSING trigger, and all triggers of Add-CDR for MSCC level.
If this parameter is configured and set to OVERRIDE , then only the last tag-value pair is logged in the CDR.
This parameter is supported for other rule triggers at MSCC level.
MNP data in CDR tag The MNP data fetched can be dumped into CDR as follows: CALL_RESULT.Add-CDR("Tag_STRING",Value_BASE,AVPLevel_ENUM) Example : CALL_RESUL T.Add-CDR("Info1",NUMBER_PORTABILITY.Get- Value("453178900",0),AVPLevel_COMMAND_LEVEL) 8.42.
1 Additional information Following are some important points regarding this functionality: •The RATING_POST_PROCESSING trigger is not used for this feature configuration.
•This functionality is not applicable to threshold execution using provisioning interface, such as Gy request calls.
•The existing functionality of Add-CDR action continues the same way to ensure backward compatibility.
•The Add-CDR functionality on threshold is considered only for COMMIT scenarios and not on reservation for threshold or other rule sets.
•The threshold configuration model is a threshold profile group with only one Threshold Profile Type , such as Percentage , Absolute from Start , or Absolute from End .
•When multiple thresholds are crossed in a single threshold profile group, the last threshold crossed is considered for triggering the action.
•This feature supports only the following consumption resources: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2104Charging User Guide Rating and charging –Bucket –Counter ( Device , Device- Group , Group , Multi-bundle , or Subscription type) –Main account balance –No-Charge (with applicable rule variables) •In case of multiple thresholds of different Threshold Profile Type with same value, the last threshold crossed is considered as per the following order of threshold profile: Absolute from Start → Percentage → Absolute from End .
8.42.2 Examples Consider the following examples for better understanding of this feature: Example 1: Custom-defined tag dumped at charging service level when a charging service matches with a complex map configuration for RESOURCE_POST_PROCESSING trigger This example states the support of RESOURCE_POST_PROCESSING trigger and the new variables for executing the Add-CDR action as per resource and the custom-defined tag CStariffAMACode is dumped at the charging service level when a charging service matches with a complex map configuration.
Provisioning: 1.Create the following charging services: a.BBProfesNat_CS and apply bucket bucket3 to it with a value of 10 bytes: b.BBProfesNat_CS1 and apply bucket bucket1 to it with a value of 200 bytes: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2105Charging User Guide Rating and charging 2.Create a bundle bundle1 with BBProfesNat_CS and BBProfesNat_CS1 charging services.
3.Subscribe a device to the bundle as shown in the following figure: 4.Create a complex map CS_AMA_mapping with the following configuration: 5.Create a rule under the RESOURCE_POST_PROCESSING trigger, and suitable rule variables and Rating Group: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2106Charging User Guide Rating and charging 6.Execute a multi-MSCC call in roaming state of the device: CCR (I) - RG - 3300, RSU = 10 CCR (I) - RG - 3310, RSU = 10 CCR (U1) - RG - 3300, RSU = 10 , USU = 10 CCR (U1) - RG - 3310, RSU = 10, USU = 10 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2107Charging User Guide Rating and charging CCR (T) - RG – 3300 , USU – 10 and RG – 3310 , USU = 10 Verification: 1.Check that for CCR(U1) for RG 3300 , the CSTariffAMACode 483 tag is getting dumped.
2.Check that for CCR(U1) for RG 3310 , the CSTariffAMACode 485 tag is getting dumped.
3.Check that for CCR(T) requests for RG 3300 and 3310 , the CSTariffAMACode 485 is getting dumped.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2108Charging User Guide Rating and charging Example 2: Custom-defined tag dumped at bucket level in accordance with the threshold crossed This example states that there is a step-bucket having only one threshold profile group, which is further associated with 3 types of threshold profiles ( Percentage , Absolute from Start , or Absolute from End ) with Percentage threshold being the first crossed threshold.
A custom-defined tag crossedThresholdAMACode is properly dumped at the bucket level in accordance with the threshold crossed.
Provisioning: 1.Create a charging step ChargingStep with following configuration: 2.Create a threshold profile group TPG1 having following three types of thresholds: •Percentage type threshold ( ThresholdPercent1 ) is set at 30% Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2109Charging User Guide Rating and charging •Absolute from End type threshold ( AbsoluteEndThreshold1 ) is set at 60 •Absolute from start thresold ( AbsoluteStartThreshold1 ) is set at 60 3.Create a bucket bucket1 and select the charging step ChargingStep and threshold TPG1 inside it.
The initial value of bucket is 100.
4.Create a step-up bucket with following configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2110Charging User Guide Rating and charging 5.Create a charging service CS1 and select bucket1 to it.
6.Create a bundle, account, and device as shown in the following figure: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2111Charging User Guide Rating and charging 7.Create a complex map with following configuration: 8.Create another complex map with following configuration: Subscription description: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2112Charging User Guide Rating and charging 9.Create a rule object with rule variable and rule group under the RESOURCE_POST_PROCESSING trigger: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2113Charging User Guide Rating and charging 10.Execute a multi-MSCC decentralized SCUR call with RG=3300 and RG=3310 : CCR(I): RG=3300 : RSU= 10 bytes , GSU=10 bytes , RG=3310 : RSU= 10 bytes, GSU=10 bytes CCR(U1): RG=3300 : USU=10 bytes, RSU= 10 bytes, GSU=10 bytes RG=3310 : USU=10 bytes, RSU= 10 bytes, GSU= 10 bytes CCR(U2): RG=3300 : USU= 10 bytes, RSU= 10 bytes, GSU=10 bytes (ThresholdPercent1 is reached here as total usage is 30 bytes) RG=3310 : USU= 10 bytes, RSU = 10 bytes, GSU= 10 bytes (AbsoluteEndThreshold1 is reached here as total usage is 40 bytes) CCR(T'): RG=3300 : USU=10 bytes RG=3310 : USU=10 bytes (AbsoluteStartThreshold1 is reached here as total usage is 60 bytes) Verification: •Check that in CCR(U2) when 10 bytes are consumed for RG 3300 then threshold is crossed for ThresholdPercent1 and tag crossedThresholdAMACode with value 5467 is dumped at bucket level.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2114Charging User Guide Rating and charging •Check that in CCR(U2) when 10 bytes are consumed for RG 3310 then threshold is crossed for AbsoluteEndThreshold1 and tag crossedThresholdAMACode with value 5469 is dumped at bucket level.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2115Charging User Guide Rating and charging •Check that in CCR(T) when 10 bytes are consumed for RG 3310 then threshold is crossed for AbsoluteStartThreshold1t and tag crossedThresholdAMACode with value 5468 is dumped at bucket level.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2116Charging User Guide Rating and charging •Check that the stepAMACode tag is dumped at charging service level for the step-up bucket.
•Check that the CStariffAMACode tag is dumped at charging service level when subscription description matches with the complex map configuration: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2117Charging User Guide Rating and charging 8.43 Resource post processing evaluation on RESERVATION Execution of RESOURCE_POST_PROCESSING on reservation supports to save custom field in session through Add-CustomField-In-Session and also supports to add custom CDR tags through the action Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2118Charging User Guide Rating and charging attribute Add-CDR .
This works only when Resource-Trigger-Applicable = RESERVATION is also configured along with these actions.
If not configured, by default it works for resource COMMIT .
Figure 118: Add custom tag in CDR Figure 119: Add custom field in session Additional information •Execution of RESOURCE_POST_PROCESSING on reservation is done only when complete reservation is performed successfully.
•Execution of RESOURCE_POST_PROCESSING during reservation supports only for consumption of resources, that is, bucket, main balance, counter, and no-charge.
•Threshold source contexts in RESOURCE_POST_PROCESSING trigger is applicable during RESERVATION as follows: –For reservation type threshold: Account: Thresholds on reservation are not applicable for account.
So, source context attributes related to threshold in RESOURCE_POST_PROCESSING trigger is not applicable during reservation.
Bucket: Reservation type thresholds are applicable in RESOURCE_POST_PROCESSING trigger during reservation.
So, source context attributes related to bucket threshold are applicable in RESOURCE_POST_PROCESSING on reservation.
–For commit type threshold: For commit type thresholds, the two source contexts RESOURCE_POST_PROCESSING.Last- Crossed-Threshold-Of-TPG (TPG) and RESOURCE_POST_PROCESSING.Find-TPG-By-Prefix are applicable in reservation, which was earlier applicable for commit only.
•For terminate request, the CALL_RESULT.Resource-Trigger-Applicable should not be updated to ResourceTriggerApplicable_RESERVATION .
This can be configured in rules as show in the following image: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2119Charging User Guide Rating and charging CALL_RESULT.Resource-Trigger-Applicable is set to ResourceTriggerApplicable_RESERVATION only for RESERVATION .
It should not be set to ResourceTriggerApplicable_RESERVATION in case of COMMIT .
8.44 Split-charging Split-charging (or rate splitting) is used to apply an extra charge for calls (voice, data, SMS, MMS) originated from specific locations when the user is in roaming.
Operators use this feature to support specific scenarios of EU regulations to add a surcharge when a call is originated from Switzerland, Isle of Man, Faroe Island, and Principate of Monaco.
Following formula illustrates the surcharge behavior: Roaming tariff = Domestic tariff + Regulated surcharge (with Regulated capping) 8.44.
1 Configuration Multiple rate (or bucket output) from tariff In this scenario, the charging takes place in one go with the following two rates: •Primary rate (or the domestic rate): The primary rate can be from the following: –No charge –Bucket (monetary or non-monetary) –Main balance •Second rate (or regulated surcharge): The secondary rate from tariff output can be from the following: –Bucket (monetary or non-monetary) –Main balance Note : For non-monetary secondary Bucket selection, RATING.next-rate action cannot be used.
Only the following actions can be used: •RATING.Next-Bucket-Granularity-Selection •RATING.Next-Bucket-Selection Following are some possible configurations: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2120Charging User Guide Rating and charging Primary resource Secondary resource Supported?
Rate ( Money) : Bucket / Account Next- Rate ( Money) Bucket/ AccountYes Bucket selection without rate Next- Rate ( Money) Yes Bucket selection with Rate Next- Rate ( Money) Yes No charge Next- Rate ( Money) Yes Rate ( Money) Bucket selection without rate Yes Bucket selection with Rate Bucket selection without rate No Bucket selection without rate Bucket selection without rate No No charge Bucket selection without rate Yes No charge Bucket selection with Rate Yes Rate ( Money) Bucket selection with Rate Yes Bucket selection without rate Bucket selection with Rate No Bucket selection with rate Bucket selection with Rate No No charge No charge No Rate ( Money) No charge No Bucket selection without rate No charge No Bucket selection with rate No charge NoTable 234: Possible configurations for primary and secondary resources Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2121Charging User Guide Rating and charging Surcharge CAP configuration The CAP is configured in such a way that it depends on various network parameters.
This is done by configuring rule attribute in RSV.
The value received from the rule is passed to rating logic in call common object.
In the rule, the operator can assign value for parameters on basis of network information, use a complex map to configure various values on basis of MCC/MNC or call type, and assign it to this variable directly.
Following are some rule examples: •SESSION_PARAMETERS.Surcharge-Time-Cap-Rate •SESSION_PARAMETERS.Surcharge-Volume-Cap-Rate •SESSION_PARAMETERS.Surcharge-Unit-Cap-Rate These variables are used only in GY_PRE_PROCESSING , IMS_CALL_ESTABLISHMENT , IMS_CALL_MODIFICATION , and IMS_CALL_TERMINATION triggers.
Note that Reflection cost can be set only using API.
Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity Use case 1: Primary volume bucket No Rate |No Rate Volume Bucket |Volume Bucket Rate2 |Rate2 NORMAL 2 5 10 4 |NORMAL 0.4 0.35 1 10 0 NORMAL 3 10 20 3 |NORMAL 0.3 0.3 1 20 0 NORMAL 1 1 0 3 |NORMAL 1 0.35 1 0 0Table 235: Surcharge calculation scenarios Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2122Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity CAP Rate 7 20 | Connection cost is not considered for Cap rate.
|If there is no rate with primary resource, granularity for secondary rate is ignored.
Use case 2: Primary volume bucket No Rate |No Rate Volume Bucket |Volume Bucket Rate2 |Rate2 NORMAL 2 5 10 10 |NORMAL 0.4 0.35 1 10 0 Reflection Cost 3 0 0 0 |Reflection Cost 3 3 0 0 0 NORMAL 1 1 0 0 |NORMAL 1 0.35 1 0 0 CAP Rate 7 20 | |Reflection cost is not considered for CAP rate, it remains unchanged.
Use case 3: Primary volume bucket No Rate |No Rate Volume Bucket |Volume Bucket Rate2 |Rate2Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2123Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity NORMAL 2 5 10 10 |NORMAL 0.4 0.35 1 10 0 Fixed Cost 8 0 20 0 |Fixed Cost 8/20= .4.35* 20=70 20 0 NORMAL 1 1 0 0 |NORMAL 1 0.35 1 0 0 CAP Rate 7 20 | Use case 4: Combine two rates with all normal Rate1 |Rate1 NORMAL 4 10 30 0 |NORMAL 0.4 0.4 1 10 0 NORMAL 6 1 0 0 |NORMAL 0.4 0.4 1 20 0 Rate2 |NORMAL 6 6 1 0 0 NORMAL 6 5 10 0 |Rate2 NORMAL 6 10 20 0 |NORMAL 1.2 1.1 1 10 0 NORMAL 7 1 0 0 |NORMAL 0.6 0.6 1 20 0 CAP Rate 3 2 |NORMAL 7 0 1 0 0 Combined Rate with cap calculation |NORMAL (0.4 + 1.1) = 1.51 10 0Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2124Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity |NORMAL (0.4 + 0.6) = 11 20 0 |NORMAL (6 + 0) = 61 0 0 Use case 5: Combine two rates with all normal and granularity Rate1 |Rate1 NORMAL 4 1 30 4 |NORMAL 4 4 1 12 3 NORMAL 6 1 0 5 |NORMAL 4 4 1 18 2 Rate2 |NORMAL 6 6 1 0 5 NORMAL 6 1 12 3 |Rate2 NORMAL 6 1 18 2 |NORMAL 6 1 1 12 3 NORMAL 7 1 0 6 |NORMAL 6 1 1 18 2 CAP Rate 5 1 |NORMAL 7 0 1 0 5 Combined Rate with cap calculation |NORMAL 4 + 1 = 51 12 3 |NORMAL 4 + 1 = 51 18 2Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2125Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity |NORMAL 6 + 0 = 61 0 5 Use case 6: Combine two rates with all normal step Rate1 |Rate1 NORMAL 4 1024 0 0 |NORMAL 0.00 390 6250.00 390 6251 30 0 Rate2 |NORMAL 0.00 390 6250.00 390 6251 20 0 NORMAL 6 1024 30 0 |NORMAL 0.00 390 6250.00 390 6251 0 0 NORMAL 6 1024 20 0 |Rate2 NORMAL 7 1024 0 0 |NORMAL 0.00 585 937 50.00 585 937 51 30 0 CAP Rate 15 1024 |NORMAL 0.00 585 937 50.00 585 937 51 20 0 |NORMAL 0.00 683 593 80.00 683 593 81 0 0 |Combined Rate with cap calculationTable 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2126Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity |NORMAL 0.00 976 562 51 30 0 |NORMAL 0.00 976 562 51 20 0 |NORMAL 0.01 074 218 81 0 0 Use case 7: Combine two rates with fixed rate and reflection cost Rate1 |Rate1 FIXED_ COST 4 1 0 0 |FIXED_ COST 4 4 1 30 0 |REFLECTION_ COST0 0 1 0 0 |FIXED_ COST 0 0 1 20 0 |FIXED_ COST 0 0 1 0 0 Rate2 |Rate2 FIXED_ COST 6 1 30 0 |FIXED_ COST 6 6 1 30 0 REFLECTION_ COST6 1 0 0 |REFLECTION_ COST6 6 1 0 0 FIXED_ COST 6 1 20 0 |FIXED_ COST 6 6 1 20 0Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2127Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity FIXED_ COST 9 1 0 0 |FIXED_ COST 9 8 1 0 0 CAP Rate 16 2 |Combined Rate with cap calculation |FIXED_ COST (0 + 6) = 101 30 0 |REFLECTION_ COST(0 + 6) = 61 0 0 |FIXED_ COST (0 + 6) = 61 20 0 |FIXED_ COST (0 + 8) = 81 0 0 |If there is a fixed- cost step with an infinite step, then that step is not considered for CAP calculation.
This is applicable for both primary and secondary rates.
However, if primary is fixed and secondary is more than cap, then only secondary is adjusted and primary is not considered.
Use case 8: Combine two rate with reflection and normal with granularity |Rate1 |REFLECTION_ COST0 0 0 0 0 Rate1 |NORMAL 4 4 1 20 2 NORMAL 4 1 30 4 NORMAL 4 4 1 10 4Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2128Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity NORMAL 6 1 0 5 |NORMAL 6 6 1 0 5 |Rate2 Rate2 |REFLECTION_ COST6 6 1 0 0 NORMAL 6 4 1 20 2 REFLECTION_ COST6 1 0 0 |NORMAL 7 4 1 10 4 NORMAL 6 1 20 2 |NORMAL 7 2 1 0 5 NORMAL 7 1 0 6 |Combined Rate with cap calculation |REFLECTION_ COST6 1 0 0 |NORMAL 4 + 4 = 81 20 2 |NORMAL 4 + 4 = 81 10 4 |NORMAL 6 + 2 = 81 0 5 | Cap Rate 8 1 | |Reflection cost and connection are not considered for CAP.Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2129Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity Use case 9: Combine two rates with fixed and normal granularity |Rate1 Rate1 |NORMAL 0.8 0.8 1 30 0 NORMAL 4 5 30 5 |NORMAL 6 6 1 20 2 NORMAL 6 1 0 5 |NORMAL 6 6 1 0 5 Rate2 |Rate2 FIXED_ COST 6 1 30 0 |FIXED 0.2 * 30 = 60.075 * 30 = 2.
251 30 0 NORMAL 6 1 20 2 |NORMAL 6 0 1 20 2 NORMAL 7 1 0 6 |NORMAL 7 0 1 0 5 |Combined Rate with cap calculation CAP Calculation 3.5 4 | |NORMAL/ Fixed (0.8 + 0.075) = 0.8751 30 0 |NORMAL (6 + 0) = 61 20 2 |NORMAL 6 + 0 = 131 0 5Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2130Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity Fixed cost is divided by duration to get the value for cap Rate comparison.
Use case 10: Combine two rates with different granularity Rate1 |Rate1 NORMAL 0.5 1 120 60 |NORMAL 0.5 0.5 1 120 45 NORMAL 1 1 0 60 |NORMAL 1 1 1 0 45 Rate2 |Rate2 NORMAL 1 1 0 45 |NORMAL 1 0.75 1 120 45 |NORMAL 1 0.25 1 0 45 Cap 5 4 |Combined Rate with cap calculation |Combined Rate |NORMAL (0.5 + 0.75) = 1.251 120 45 |NORMAL (1 + 0.
25) = 1.
251 0 45 Use case 11: Combine two rate with different granularity multi- step Rate1 |Rate1Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2131Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity NORMAL 0.5 1 120 60 |NORMAL 0.5 0.5 1 45 45 NORMAL 1 1 0 60 |NORMAL 0.5 0.5 75 45 Rate2 |NORMAL 1 1 1 0 45 NORMAL 1 1 45 45 |Rate2 NORMAL 1 1 0 45 |NORMAL 1 0.75 1 45 45 |NORMAL 1 0.75 75 45 Cap 5 4 |NORMAL 1 0.25 1 0 45 |Combined Rate with cap calculation |NORMAL (0.5 + 0.75)= 1.251 45 45 |NORMAL (0.5 + 0.75) = 1.251 75 45 |NORMAL (1 + 0.
25) = 1.
251 0 45 Use case 12: Combine two rates with fixed cost and normal step Rate1 |Rate1Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2132Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity Fixed Cost 60 1 120 0 |Fixed Cost 0.5 * 45 = 22.
50.5 1 45 45 NORMAL 1 1 0 60 |Fixed Cost 0.5 * 75 = 37.
50.5 75 45 Rate2 |NORMAL 1 1 1 0 45 NORMAL 1 1 45 45 |Rate2 NORMAL 1 1 0 45 |NORMAL 1 0.75 1 45 45 |NORMAL 1 0.75 75 45 Cap 5 4 |NORMAL 1 0.25 1 0 45 |Combined Rate |NORMAL (0.5 + 0.75) = 1.251 45 45 |NORMAL (0.5 + 0.75) = 1.251 75 45 |NORMAL (1 + 0.
25) = 1.
251 0 45 Use case 13: Combine two rates, second with fixed step Rate1 |Rate1Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2133Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity Normal 1 1 45 0 |Normal 1 1 1 45 45 NORMAL 1 1 0 60 |Normal 1 1 75 45 Rate2 |NORMAL 1 1 1 0 45 Fixed 60 1 120 45 |Rate2 NORMAL 1 1 0 45 |Fixed ( Int) 0.5 * 45 = 22.
5(0.25 * 45) = 11.251 45 45 |Fixed( Int) 0.5 * 75 = 37.
518.75 1 75 45 Cap 5 4 |Fixed( Actual) 60 30 1 120 0 |NORMAL 1 0.25 1 0 45 |Combined Rate |NORMAL (1 + 0.
25) = 1.
251 45 45 |NORMAL (0.5 + 0.75) = 1.251 75 45 |NORMAL (1 + 0.
25) = 1.
251 0 45Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2134Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity Use case 14: Combine two rates, both rates have fixed cost Rate1 |Rate1 Fixed Cost 22.5 1 45 0 |Fixed 0.5 * 45=22.
522.5 1 45 0 NORMAL 1 1 0 60 |Normal 1 1 75 45 Rate2 |NORMAL 1 1 1 0 45 Fixed Cost 60 1 120 45 |Rate2 NORMAL 1 1 0 45 |Fixed ( Int) 0.5 * 45 = 22.
5(0.5* 45)=22.
51 45 0 |Fixed( Int) 0.5 * 75 = 37.
5(0.25* 45)=18.
751 75 0 Cap 5 4 |Fixed( Actual) 41.25 1 120 0 |NORMAL 1 0.25 1 0 45 |Combined Rate |NORMAL (1 + 0.
25) = 1.
251 45 45Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2135Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity |NORMAL (0.5 + 0.75) = 1.251 75 45 |NORMAL (1 + 0.
25) = 1.
251 0 45 Use case 15: Secondary resource as non- moneytary bucket, without granularity Rate1 Rate1 NORMAL 12 1 10 1 NORMAL 12 12 1 10 0 NORMAL 11 1 0 10 NORMAL 11 11 1 0 0 No rate Volume bucket Cap 5 6 Cap is considered only if secondary resource is of type money.
If there is no rate with secondary resource, granularity for primary rate is ignored.
Use case 16: Secondary resource as non- moneytary bucket, with granularity Rate1 Rate1 NORMAL 5 1 0 7 NORMAL 5 5 1 0 5 Rate2 Rate2Table 235: Surcharge calculation scenarios (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2136Charging User Guide Rating and charging Configuration Actual calculation Step Type Cost Quantity Duration GranularityStep Type Cost Updated Cost Quantity Duration Granularity NORMAL 4 1 0 5 NORMAL 4 4 1 0 5 If both primary and secondary have rate, then the lower granularity is considered for both rates.Table 235: Surcharge calculation scenarios (continued) 8.44.2 Split-charging behavior In case of combined rates If both primary and secondary cost are charged from the same main balance, then the two rates are combined to create a single rate.
Following are some important points to consider for the combination: 1.If two steps have different granularity, then the lower of both is considered in the resultant rate.
2.While combining normal rate and fixed rate, introduce one new step in resultant rate with step size quantity as one and cost as complete fixed cost plus cost of 1 quantity from normal step.
Following table shows few example for combination of two rates and there steps: Note that Reflection cost can be set only using API.
Step Type Cost Quantity Duration Granularity Repetitive Flag Case 1: Combine two rates with all normal Rate1 NORMAL 4 10 30 0 false Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2137Charging User Guide Rating and charging Step Type Cost Quantity Duration Granularity Repetitive Flag NORMAL 6 1 0 0 false Rate2 NORMAL 6 5 10 0 false NORMAL 6 10 20 0 false NORMAL 7 1 0 0 false Combined rate NORMAL 16 10 10 0 false NORMAL 10 10 20 0 false NORMAL 13 1 0 0 false Case 2: Combine two rates with all normal and granularity Rate1 NORMAL 4 1 30 4 false NORMAL 6 1 0 5 false Rate2 NORMAL 6 1 10 3 false NORMAL 6 1 20 2 false NORMAL 7 1 0 6 false Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2138Charging User Guide Rating and charging Step Type Cost Quantity Duration Granularity Repetitive Flag Combined rate NORMAL 10 1 10 3 false NORMAL 10 1 20 2 false NORMAL 13 1 0 5 false Case 3: Combine two rates with all normal step Rate1 NORMAL 4 1024 0 0 false Rate2 NORMAL 6 1024 30 0 false NORMAL 6 1024 20 0 false NORMAL 7 1024 0 0 false Combined rate NORMAL 10 1024 30 0 false NORMAL 10 1024 20 0 false NORMAL 11 1024 0 0 false Case 4: Combine two rates with fixed rate and reflection cost Rate1 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2139Charging User Guide Rating and charging Step Type Cost Quantity Duration Granularity Repetitive Flag FIXED_ COST 4 1 0 0 false Rate2 FIXED_ COST 6 1 30 0 false REFLECTION_ COST 6 1 0 0 false FIXED_ COST 6 1 20 0 false FIXED_ COST 7 1 0 0 false Combined rate FIXED_ COST 10 1 30 0 false REFLECTION_ COST 6 1 0 0 false FIXED_ COST 6 1 20 0 false FIXED_ COST 7 1 0 0 false Case 5: Combine two rates with reflection and normal with granularity Rate1 NORMAL 4 1 30 4 false NORMAL 6 1 0 5 false Rate2 REFLECTION_ COST 6 1 0 0 false Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2140Charging User Guide Rating and charging Step Type Cost Quantity Duration Granularity Repetitive Flag NORMAL 6 1 20 2 false NORMAL 7 1 0 6 false Combined rate REFLECTION_ COST 6 1 0 0 false NORMAL 10 1 20 2 false NORMAL 11 1 10 4 false NORMAL 13 1 0 5 false Case 6: Combine two rates with fixed and normal granularity Rate1 NORMAL 4 1 30 4 false NORMAL 6 1 0 5 false Rate2 FIXED_ COST 6 1 30 0 false NORMAL 6 1 20 2 false NORMAL 7 1 0 6 false Combined rate FIXED_ COST 10 1 1 0 false Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2141Charging User Guide Rating and charging Step Type Cost Quantity Duration Granularity Repetitive Flag NORMAL 4 1 29 0 false NORMAL 12 1 20 2 false NORMAL 13 1 0 5 false Reduced allocation on the basis of surcharge CAP defined in rule If EU-Cap is configured in rule, then cap value in CALL_COMMON is used to limit the monetary charges for each MSCC in the call request.
Primary rate and secondary rates are calculated by the following logic: 1.Primary cost (0 for cap if tariff output is non-monetary bucket) + secondary cost cannot be greater than CAP rate (if configured).
2.If it is more than the CAP rate, then the secondary rate is adjusted so that the total does not exceed CAP rate .
3.The primary rate is never adjusted.
If a secondary rate is not configured, then EU-Cap is not used.
Example Units from more than one resource of money type are reserved and CAP is reached.
Configuration: •Tariff 1: Output Rate1 (1 for 1 unit) main balance, Rate2 (1 for 1) main balance, Value = 10 •Tariff 2: Output Main-Balance2, Rate3 and Main-Balance2, Rate 4, Value = 20 •RSU = 10, EU-CAP is 12 Calculation: 1.From the first Tariff Main Balance, only 5 units can be allocated (cost is 5 for primary charge and 5 for secondary charges) = 10.
2.The remaining units are allocated from the next resource Main Balance 2 (cost is 5 for primary charge and 5 for secondary charges) = 10.
3.Total cost is 10 + 10 = 20 4.However, as EU-CAP is 12 and the primary rate cannot be reduced, only the secondary rate is reduced.
5.So secondary rate from secondary resource is not reserved.
Also, already reserve cost of secondary rate from Main Balance 1 is partially de-allocated.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2142Charging User Guide Rating and charging Slice reduction logic Slice reduction is used to reduce slice size when reserved units plus consumed unit are near threshold/CAP or have already crossed threshold/CAP.
As threshold evaluation takes place at the time of a commit, if slice size is not reduced at the time of reservation then the threshold may overshoot and the threshold action may be delayed.
•Two different resources with the different rate or same rate: This logic enables to calculate delta is evaluated twice, once for the first resource and then for the second resource.
The minimum of the two deltas is considered for final delta.
•Single resource with the same rate or different rate: For same rate, the cost is doubled for each step.
If the rate is different, the cost is combined at each step to create a single rate for estimation.
First, the estimation request is run, and the output is an unit which can be allocated from this resource.
It can be equal to the requested unit or less than the requested unit.
On the basis of the output, re-rating for primary and secondary rate is done.
Rating logic For split charging, counter behavior remains unchanged, charging service may return more than one resource.
The first resource becomes the primary resource, and the other resource is called a secondary resource used to charge the surcharge amount for roaming calls.
•Two different resources with different rate or the same rate: If there are different resources as output of the tariff rule then rating logic is executed twice, ones with each resource.
The minimum of units allocated by each rate call is considered for reservation.
•Single resource with same rate or different rate: When there is a single resource to charge from, then both rates are combined and used for estimation.
After the estimated units to be charged from the resource are calculated, normal flow for reservation indivisibly for each rate is followed.
Over-commit logic If there is not enough balance during over-commit in either primary or secondary rate, then both primary and secondary are evaluated (minimum of both) and the remaining balance is considered as lost credit.
Threshold and CAP If both primary and secondary resources are used from tariff, and the threshold is configured on any of the resources, then the resources are ignored and the next charging service or pass is considered.
TTC handling The implementation of secondary rate works well with Time-Tariff Switch.
If, during a call, the TTS occurs then the call is charged from primary rate and secondary rate as per configuration, before and after TTS.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2143Charging User Guide Rating and charging 8.44.3 Additional information Following are important points regarding this feature: •Surcharge CAP limit is applicable per MSCC.
•FUP is not considered for split charging.
•For secondary, step-charge and BOU are not allowed.
•If a rule output for the secondary rate is non-monetary, then the call fails.
•Same tax is used for both primary and secondary.
There is no provision to configure a separate tax for secondary rate.
•CAP is applicable only if secondary resource is of type money.
•Global rate configuration is not supported for secondary resource.
•If one of the resource is without a rate, then granularity is ignored for others as well.
8.44.4 Charging from the same resource Charging from the same resource scenario combines the following: •Rate rounding at tariff level (also applicable for secondary rate) •Surcharge configuration through tariff Without this feature, rate rounding works with split charging, but rounding is applicable separately for primary and secondary costs.
This feature rounds the combined cost of primary and secondary if they are charged from the same resource.
In the CCR request, this mechanism performs the cost rounding (combined for primary and secondary if configured), saves delta cost, and this delta cost is adjusted in the next CCR request, and subsequently to all the upcoming requests till the final terminate request is received for the subscriber.
Following CDR/EDR tags are available for this feature (refer to CDR/EDR Reference for detail descriptions of these new tags).
•calculatedPrimaryCost •calculatedSecondaryCost Example for same resource Rule: RATING.Rate ( "rate02", "Main Balance" ) and RATING.Next-Rate ( "rate02", "Main Balance" ) and RATING.Rate-RoundingFactor = 0.1 Result: Rate02 => 0.02 €/ 1 Byte In the following tables, AD indicates available delta and PD indicates previous delta.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2144Charging User Guide Rating and charging Request typeRSU USU Calculated cost without roundingMinus from ADRounded costAD PD Final AD ( stored in database)Rounded cost committed Initial Primary 3 0.06 0 0.1 0.04 0 0.08 0 Secondary 3 0.06 0.02 0.1 0.08 0.04 0 0 Update 1 Primary 3 0.08 0.1 Secondary 3 0.1 Primary 5 0.1 0.02 0.1 0.08 0.08 0.08 Secondary 5 0.1 0.02 0.1 0.08 0.08 0 Update 2 primary 5 0.1 Secondary 5 0.1 Primary 4 0.08 0 0 0 0.08 0.02 Secondary 4 0.08 0.08 0.1 0.02 0 0 Terminate Primary 4 0 Secondary 4 0.1 Total cost 24 0.48 Lost delta 0.020.5Table 236: Calculation for exact-commit scenario Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2145Charging User Guide Rating and charging Request typeRSU Over- committed USUUSU Calculated cost without roundingMinus from ADRounded costAD PD Final AD ( stored in database)Rounded cost committed Initial Primary 3 0.06 0 0.1 0.04 0 0.08 0 Secondary 3 0.06 0.02 0.1 0.08 0.04 0 0 Update 1 Primary 8 3 0.08 0.1 Secondary 8 3 0.1 Primary 5 0.1 0.02 0.1 0.08 0.08 0.1 Secondary 5 0.1 0.02 0.1 0.08 0.08 0.1 Primary 5 0.1 0.02 0.1 0.08 0.08 Secondary 5 0.1 0.02 0.1 0.08 0.08 Update 2 Primary 5 0.1 Secondary 5 0.1 Primary 4 0.08 0 0 0 0.08 0.02 Secondary 4 0.08 0.08 0.1 0.02 0 0 Terminate 6 0.04 Primary 4 0 Secondary 4 0.1 Primary Overcommit2 0.04 0.02 0.1 0.08 0.02 0.1 Secondary Overcommit2 0.04 0 0 0.04 0.04 Total costTable 237: Calculation for over-commit scenario Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2146Charging User Guide Rating and charging Request typeRSU Over- committed USUUSU Calculated cost without roundingMinus from ADRounded costAD PD Final AD ( stored in database)Rounded cost committed 38 0.76 Lost delta 0.
040.8Table 237: Calculation for over-commit scenario (continued) Request typeRSU USU Calculated cost without roundingMinus from AD/ Under- commit: minus from PDRounded costAD PD Final AD ( stored in database)Rounded cost committed Initial Primary 6 0.06 0.06 0.1 0.04 0 0.08 0 Secondary 6 0.06 0.02 0.1 0.08 0.04 0 0 Update 1 Primary 6 0.1 Secondary 6 0.1 Primary 4 0.04 0 0 0.04 0.08 0 Secondary 4 0.04 0 0 0 0.04 Update 2 Primary 2 0.02 0 0 0.06 0 0.04 Secondary 2 0.02 0 0 0.04 0.02 Primary 2 0.02 0 0 0.02 0.04 0 Secondary 2 0.02 0 0 0 0.02 Terminate Primary 2 0Table 238: Calculation for under-commit scenario Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2147Charging User Guide Rating and charging Request typeRSU USU Calculated cost without roundingMinus from AD/ Under- commit: minus from PDRounded costAD PD Final AD ( stored in database)Rounded cost committed Secondary 2 Total cost 20 0.2Table 238: Calculation for under-commit scenario (continued) Counter logic for the same resource If the counter usage attribute is not set, then the counter value increments to the rounded value of the combined cost of primary and secondary tariff.
If the counter usage attribute is set to primary or secondary, then the counter increments separately for primary or secondary cost based on the configuration.
In this case, primary and secondary cost are rounded separately instead of rounding the combined cost.
For example - consider the following configuration: •Primary call rate: 65p for 60 secs (fixed rate), and then 65p/60 secs (normal rate) with granularity of 1 sec.
•Secondary call rate: 243p for 60 secs (fixed rate), and then 243p/60 secs (normal rate) with granularity of 1 sec.
•Call duration = 65 sec •Primary call cost = 65p for first 60 secs + 65 x (5/60)p for remaining 5 secs.
65p + 5.417p = 70.417p → 71p (rounded cost) •Secondary call cost = 243p for first 60 secs + 243 x (5/60)p for remaining 5 secs.
243p + 20.25p = 263.25p → 264p (rounded cost) •Total cost = primary call cost + secondary call cost.
70.417p + 263.25p = 333.667p → 334p (rounded cost) •Default counter is increased by 334p.
•Primary usage type counter is increased by 71p.
•Secondary usage type counter is increased by 264p.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2148Charging User Guide Rating and charging 8.45 Configuring rounding mechanism at rate level Overview This feature provides a new rounding mechanism to charge the calls with a configurable rate rounding factor at Global or Tariff Rate level.
This cost rounding is applicable only for monetary resources (that is, main balance and money buckets).
This rounding mechanism is over and above the existing NCC rounding mechanisms for calculation precision and DB precision (defined in the application preferences Calculation Precision and DB_PRECISION , see Charging application preferences on page 44 for details).
The cost is rounded to the next decimal place based on the configured rate rounding factor (according to the current round-up rounding mechanism, that is CEIL ).
The tax/discount is applied first to the rate cost, and the calculation precision/database precision rounding is performed.
After this, the new rounding mechanism is applied to round the total call cost (including tax, discount, calculation, and DB precision).
The rate rounding factor is applicable only to the cost computed by the rate applied for ON-CALL consumption/deductions.
It is not applied on any other NCC entities, cost deductions like CC_MONEY/ External-Internal REST APIs/External-Cost/BOU, or Step Fees, if used for deductions on monetary balance.
The cost computed for a specific CCR is rounded using the rounding mechanism, and the delta cost is adjusted in the next CCR request.
The delta cost is adjusted in all the upcoming requests till the end of the call.
The cost-rounding mechanism is applicable to Voice/VoL TE calls only.
It is not applicable for Data, SMS, MMS, and 5G calls although there is no change in the existing usage-based rounding mechanism.
When the rate rounding mechanism is applied on spending limit, the rounded cost is considered for quota allocation.
When rate rounding mechanism is applied with TTC, the USU_Before (TTC) is charged according to the new rounding mechanism, and if there is any remaining delta cost, then that is used for computation of USU_AFTER (TTC) commit.
Important points •Cost rounding is applicable over the tax, discount, DB precision, and calculation precision.
•Cost rounding is applicable for the monetary resources (money bucket, or main balance).
•To apply the cost-rounding mechanism on the monetary resource, the monetary balance should have the same decimal precision as the configured rate rounding factor.
For example, if DB_PRECISION is 5, the rounding mechanism is CEIL , available balance = 2.33745, and the configured rate rounding factor is 0.01, then the account balance considered for the cost calculated by NCC with this cost-rounding mechanism is 2.33, considered up to 2nd decimal place with floor rounding.
This is done to avoid any ambiguities in the monetary balance utilization.
•If spending limit is applied with soft stop condition (that is, Notification-Stop action is applied in threshold), and if the delta cost is remaining, that delta cost is used because user has already paid this delta cost on reaching this soft-stop condition and moving to the next resource.
•If spending limit is applied with hard stop condition (that is, Notification-Reject/Reject action is applied in threshold), and if there is any delta cost remaining, then that delta cost is not used.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2149Charging User Guide Rating and charging •For call consumption when NCC charging mechanism moves to next resource, before switching to next resource for further reservation, delta cost of previous committed resource (if any) is consumed first, and then remaining quantities are charged from the next available resource.
•If TTC (TTC not supported by client/TTC supported by client) is triggered due to the BCR of the resource that is being consumed in the call, then the USU_Before (TTC) is charged as per the new rounding mechanism.
If there is any remaining delta cost then that is used for the computation of USU_After (TTC) commit.
•For Threshold-Rate /Threshold-Next-Rate , if the threshold is crossed, then the delta cost calculated from the rate configured in the previous threshold is used in the next threshold rate calculations.
•Rate rounding factor is applied individually to the cost computed by the primary rate and secondary rate.
Currently, the shared resources are not supported in split charging.
•When the cost-rounding mechanism is applied at Global level for a set of subscribers/devices, then all the associated monetary resources of that device are deducted with the rounded cost of the call usage as per the global rate rounding factor.
For example, if the device has purchased two subscriptions from two separate accounts (account balance), if based on device custom data the rate rounding factor is applied globally, then it is applicable for the call usage deduction for both the accounts/monetary buckets.
•When the cost-rounding mechanism is applied at tariff rate level, for a set of subscribers/devices purchasing the subscription that contains that tariff rate, the rate rounding configuration applies the rate rounded cost according to the rate rounding factor to its applied monetary resources.
•It is not recommended to configure the rate rounding factor at both Global and Tariff level.
Configure it either at GY_PRE_PROCESSING (Global) or Tariff level.
•When rate rounding factor is defined at Global level, its configuration is common for all MSCCs in the same request.
CAUTION : It is not recommended to change the rate rounding factor for the devices/subscribers (for example, DB Precision, Calculation Precision, Rounding Mechanism) applied globally or at tariff rate level, because it impacts the monetary consumptions for the ongoing cost calculations for that particular device.
If it is changed during ongoing calls for the applied devices, it results in precision lost credit scenarios for the subscribers/devices.
Configuration This section describes the rate rounding factor configuration and its applicability: •The rate rounding factor can be configured at the Global level (Charging RSV) or a specific rate level (Tariff) plan.
•The rate rounding factor can be applied in the following triggers.
–Tariff rule –Charging RSV: GY_PRE_PROCESSING trigger rule –Charging RSV: GY_CREDIT_REQUEST trigger rule Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2150Charging User Guide Rating and charging It is recommended to apply it in only one of the trigger points.
•If applied for multiple triggers (Global/Tariff), preference is given in the order: Tariff > Gy_Pre_Processing > Gy_Credit_Request.
•For rate rounding to be applicable on monetary resource (main balance or money buckets), the tariff rule should have at least one of the following actions: –Rate –Next-Rate –Threshold-Rate –Threshold-Next-Rate •When the rate rounding factor is defined at Global level, its configuration is common for all the MSCCs in the same request.
•In split charging scenarios, if applied with primary and secondary resources, the rate rounding factor configuration is common for both the resources.
•If the rate rounding factor is defined as a negative value, 0, or less than the database precision/ calculation precision (application preferences DB_PRECISION and Calculation Precision ), then it is ignored, and the feature is disabled.
For example: If DB_PRECISION = 2 (that is, 1/100 = 0.01) and Calculation Precision = 5 (that is, 1/100000 = 0.00001), then the rate rounding factor should be greater than or equal to 0.01.
Examples of rate rounding factor: 0.5, 0.05, 0.1, or 0.01.
Rule configuration Charging Logic: Canvas mode Charging logic: Code mode Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2151Charging User Guide Rating and charging Charging RSV: GY_PRE_PROCESSING trigger Charging RSV: GY_CREDIT_REQUEST trigger Application preference for skipping granularity To consume monetary resources completely before switching to next resource, set the application preference GRANULARITY SKIP FOR LOW BALANCE to true as follows: Formula used for calculating cost rounding Consider NCC_Current_Cost computed from the rate configuration (including tax, discount, calculation, and database precision).
1.NumberOfSteps = NCC_Current_Cost/ RateRoundingFactor.
The result is rounded up to next integer 2.Final Rounded Cost = NumberOfSteps ✕ RateRoundingFactor.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2152Charging User Guide Rating and charging Examples Example 1: When the rate rounding factor is applied at Global level Configuration •Rate configuration –Connection cost = 0.02 –Charging step1: cost = 0.55; duration = 60; granularity = 0; quantity = 1; stepType = FIXED_COST –Charging step2: cost = 0.55; duration = 0; granularity = 0; quantity = 60; stepType = NORMAL •Define rate rounding factor as 0.1 in the Gy_PRE_PROCESSING trigger in RSV.
•Charging from main balance/monetary buckets.
Call consumption 1.CCR (I) RSU = 60 •NCC Cost = 0.02 + 0.55 = 0.57 •NumberOfSteps = 0.57/0.1 = 5.7 (rounded to 6) •RoundedCost = 6 ✕ 0.1 = 0.6 •Delta Cost = 0.6 – 0.57 = 0.03 2.CCR (U): USU = 60 => 0.6 committed •RSU = 60: Adjust delta cost from previous request = 0.03 •NCC Cost = (60 ✕ 0.55)/60 = 0.55 •Cost after adjustments = 0.55 – 0.03 = 0.52 •Apply cost rounding formula on 0.52.
The result is 0.6.
•New delta = 0.6 – 0.52 = 0.08 3.CCR(T): USU = 60 => 0.6 committed from resource.
•Final delta cost at the end of call is 0.08.
Example 2: When the rate rounding factor is applied at Tariff Rate level Configuration •Rate configuration –Connection cost = 1 –Charging step: cost = 1.2; duration = 0; granularity = 1; quantity=60; stepType = NORMAL •Define rate rounding factor as 0.5 in tariff rule.
•Charging from main balance/monetary buckets.
Call consumption Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2153Charging User Guide Rating and charging 1.CCR (I) RSU = 60 •NCC Cost = 1+ (1.2 ✕ 60/60) = 2.2 •NumberOfSteps = 2.2/0.5 = 4.4 (rounded to 5) •RoundedCost = 5 ✕ 0.5 = 2.5 •Delta Cost = 2.5 – 2.2 = 0.3 2.CCR (U): USU = 60 => 2.5 committed •RSU = 60: Adjust delta cost from previous request = 0.3 •NCC Cost = 60 ✕ 1.2/60 = 1.2 •Cost after adjustments = 1.2 – 0.3 = 0.9 •Apply cost rounding formula on 0.9.
The result is 1.
•New delta = 1 – 0.9 = 0.1 3.CCR(T): USU = 60 => 1 committed from resource.
•Final delta cost at the end of call is 0.1.
8.46 FUP affecting surcharge The Block-Next-Rate action in the THRESHOLD_PROFILE source context blocks the next rate, so that only the primary rate is applied.
A default user is charged with both primary and secondary tariff.
When the configured threshold for FUP is reached, the Block-Next-Rate action is set to True , so that only primary tariff is charged.
FUP Counter The FUP counter can be provisioned both on device level and group level.
•There is no surcharge before the FUP limit threshold.
•Upon reaching the FUP limit, the call is charged with both primary tariff, and secondary tariff.
•FUP counter supports the related Near Threshold and Limit Reach notifications.
•FUP subscription, unsubscribe, and query by external system is done through REST API.
Usage based FUP •The Fair Usage Policy is purely usage based.
•The FUP parameter defines the SMS, MMS, voice (outgoing or incoming), and data usage, within a month or the billing period, that a subscriber is allowed to roam in the EU without incurring a surcharge.
•A separate usage threshold is defined for each kind of traffic.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2154Charging User Guide Rating and charging •The number of EU roaming days are monitored at the subscriber level from the start of the billing period (daily, weekly, monthly or annual time period), or start of the month.
•The first EU roaming event of the day is used to trigger the day counter.
•Any usage beyond the threshold is charged at a domestic charge in addition with surcharge.
It is capped at EU tariff rates.
In such conditions the surcharge can be applied also to the incoming calls.
•The roaming counter is reset at the end of the month, or end of the billing period to restart the monitoring.
•The FUP value should be defined at the global level or the domestic tariffs so that the policy threshold can be varied based on the type of tariff or product subscribed.
FUP may not be applied for some tariff or products.
For specific subscribed and active products, the FUP counter should not be increased.
8.47 Pre-rating simulation Using pre-rating simulation the operator can know the rate and the charging service selected by tariff processor in advance on some specific categories of charging services and use the result during normal rating.
The secondary rate, that is, the next rate can also be returned in the result.
Consider the scenario of a subscriber who has one or more base tariffs (charging services with rates, low priority), with no additional package, or the additional package has exhausted.
In this case, the base tariffs are considered and evaluated during pre-rating simulation.
The result from pre-rating simulation can be used during normal rating.
For secondary rate, consider a scenario where a subscriber has a 40 GB bundle that is applicable for both home and roaming.
The counter FUP is subscribed and the configured threshold for FUP is 24 GB.
When data session starts in roaming, the counter FUP at 25 GB (threshold limit reached), then Next-Rate is allowed.
Data session is rejected and notification is sent to subscriber.
When the configured threshold for Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2155Charging User Guide Rating and charging FUP limit is reached, the Block-Next-Rate action is not used and the secondary rate can be applied.
See FUP scenarios on page 2157 for more information.
Pre-Rating simulation feature is enhanced to return the secondary rate ( Next-Rate ).
The CALL_COMMON.Pre-Rating-Simulation-Next-Rate variable is available in the source context CALL_COMMON .
It contains the value of the secondary rate ( Next-Rate ).
Note : Pre-Rating Simulation is not executed for usageType Wholesale .
It only runs for usage type Normal .
8.47.
1 Configuration Result context The following result context is provided to enable pre-rating simulation: GY_PRE_PROCESSING.Pre-Rating-Simulation-Enabled-For-Categories = [ "Category-Pre-Rate-1", "Category-Pre-Rate-2" ] The list of categories eligible for pre-rating processing are provided in the attribute Pre-Rating-Simulation- Enabled-For-Categories .
If this result context attribute is configured and has some values, then pre-rating simulation is done before tariff processing.
After this the tariff processing is done the result context can be used in applicability or tariff rules.
Source context CALL_COMMON.Pre-Rating-Simulation-CS (with the selected charging service) CALL_COMMON.Pre-Rating-Simulation-Rate (with the selected rate) CALL_COMMON.Pre-Rating-Simulation-Next-Rate (with the selected rate) 8.47.2 Example For pre-rating simulation it is assumed that subscriber has one or more underlying tariffs (that is, Charging Services with rates, low priority), which define the basic behaviour when subscriber does not buy any package or his package is already depleted.
These underlying tariffs are considered and evaluated during pre-rating simulation.
Therefore, the result from pre-rating simulation can be used during normal rating call flow.
See the following scenarios: •Bucket is not applicable when specific underlying tariff is provisioned: Applicability condition of bucket check whether CALL_COMMON.Pre-Rating-Simulation-CS (selected Charging Service in pre-rating simulation) is not equal to specific tariff.
•Bucket can be deducted by rounded call units (for example, kB or MB).
It might be desired (especially for voice calls) that bucket granularity follows granularity of rate of underlying tariff.
CALL_COMMON.Pre-Rating-Simulation-Rate (selected rate from pre-rating simulation) is used to control granularity of bucket.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2156Charging User Guide Rating and charging •High-priority tariff have specific rates for selected traffic; however, other traffic follow rates of underlying tariff: CALL_COMMON.Pre-Rating-Simulation-Rate (selected rate from pre-rating simulation) is used in tariff formula to charge the call.
•Cost bucket grants free credit to the subscriber, but it follows rate of underlying tariff and not any other high-priority tariffs: CALL_COMMON.Pre-Rating-Simulation-Rate (selected rate from pre-rating simulation) is used in tariff formula to charge the call with this rate from subscription cost bucket.
•CALL_COMMON.Pre-Rating-Simulation-Next-Rate contains the value of secondary rate.
8.47.3 FUP scenarios Example 1: FUP limit not reached A subscriber has a 40 GB bundle applicable to home and roaming.
The counter FUP is subscribed and it is 14 GB.
When a subscriber starts a data session while roaming and counter FUP is at 14 GB, that is, below threshold limit, then Block-Next-Rate is applied and session is allowed.
Example 2: FUP limit with two bundles A subscriber has a 40 GB bundle (Bundle A) applicable to home and roaming.
The bundle (Bundle A) has a FUP limit at 20GB.
The Bundle B has a 10 GB home and roaming bucket.
The counter FUP is subscribed and Counter Scope is set to Multi-Bundle or SELF .
When a subscriber starts a data session while roaming and counter FUP is at 25 GB, that is, threshold limit is reached, then Next-Rate is allowed, session is rejected and a notification is sent to subscriber.
Example 3: Additional add-on to allow use of data again The data session gets blocked when the bundle is exhausted.
To continue using data session, a subscriber can buy additional bundle.
Consider that a subscriber has a 40 GB bundle (Bundle A) applicable to home and roaming.
The bundle (Bundle A) has a FUP limit at 20 GB.
The Bundle B has a 10 GB home and roaming bucket.
The counter FUP is subscribed and Counter Scope is set to Multi-Bundle or SELF .
When a subscriber starts a data session while roaming and counter FUP is at 25 GB, that is, threshold limit is reached, then Next-Rate is allowed, session is rejected and a notification is sent to subscriber.
When a new bundle, Bundle C is subscribed, the data session is allowed.
8.48 Late rating Late rating refers to performing offline rating and charging for data, voice, SMS, and MMS at a time later than the actual time.
This is particularly useful in roaming scenarios where the roaming data may be available late.
When NCC receives a late event, it can be configured to rate and charge the call from the bucket allowance and status per the actual event timestamp.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2157Charging User Guide Rating and charging For example, if a subscriber belongs to Group 1 until 31 May (00:00) to and to Group 2 from 1 June (00:00), and late rating request is received on 2nd June for 29th May, then charging can be done from Group 1.
If bundles and charging services are modified, then both old data and new data are available depending on the time of request.
Also, subscription history and group history are maintained in Device and Group entities internally.
Note : Version information of bundles and charging services is available only via REST API.
8.48.
1 Rule attribute for late rating The rule attribute GY_MESSAGE.Is-Late-Rating is used to decide whether threshold action is to be executed for late rating events.
Refer to section GY_MESSAGE source context on page 421for information about applicability of this tag.
8.48.2 Late rating with versioning Previously, late calls were handled based on the subscription history.
Currently, the late rating calls use an appropriate charging logic version based on the late event timestamp.
This feature provides the following functionalities: •Late calls select an appropriate bundle/charging version based on the late event timestamp.
•In case of BCR, the late event timestamp selects the maximum applicable version activation date.
It does not select the time at which the version was published.
•Versioning is triggered, in case of late call with immediate versioning.
Pre-configuration for scenarios Following are the pre-configurations for the scenarios listed further: •History Period - Greater than 0.
•Max Number of Histories - Greater than 0.
•Threshold Profile Group (TPG) - A TPG that sends an email notification at 50%.
•Threshold Profile Group (TPG) - A TPG that sends an SNR at 20GB, 30GB, and 50GB.
•Allowance Limit 1 - With an initial value of 50GB.
•Allowance Limit 2 - With an initial value of 50 min.
•Charging Logic 1 - With Allowance Limit 1 .
•Charging Logic 2 - With Allowance Limit 2 .
•Create an Account , User , Device , Service , and Subscription .
Scenario 1: Late rating when versioning is disabled.
1.Disable versioning at SM and ME (Set the application preference Versioning Enabled to false ).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2158Charging User Guide Rating and charging 2.Create a subscription to ChLogic1 with an allowance limit of 50GB, and ChLogic2 with an allowance limit of 50 min/monthly BCR.
3.Trigger BCR ( BCR1 ).
4.Trigger BCR again ( BCR2 ).
5.Late rating call consumes 10GB and 35 min from the current cycle after BCR2 .
Result: 10GB and 35 min is consumed from the current cycle.
6.Late rating call consumes 2GB and 12 min from the previous cycle after BCR1 .
Result: 2GB and 12 min is consumed from the bucket history (second cycle) 7.Late rating call consumes 4GB and 2 min from the first cycle before BCR1 .
Result: 4GB and 2 min is consumed from the bucket history (first cycle).
8.Late rating call consumes 50 min.
Result: Fails with an error code 4012 (Quota Limit Reached).
Scenario 2: Late rating with versioning at BCR.
1.Enable versioning at SM and ME (Set the application preference Versioning Enabled to true ).
2.Create a subscription to ChLogic1 with an allowance limit of 50GB, and ChLogic2 with an allowance limit of 50 min/monthly BCR.
3.Create V2.0 ChLogic1 with an allowance limit of 60GB.
Create V2.0 ChLogic2 with an allowance limit of 70 min.
4.Trigger BCR ( BCR1 ).
5.Late rating call consumes 10GB and 35 min from the current cycle after BCR1 .
Result: 10GB and 35 min is consumed from the current cycle ( V2.0 ChLogic ).
6.Late rating call consumes 2GB and 12 min from the previous cycle before BCR1 .
Result: 2GB and 12 min is consumed from the previous cycle - bucket history.
7.Late rating call consumes 55GB from the previous cycle.
Result: Fails with an error code 4012 (Quota Limit Reached).
Scenario 3: Late rating with immediate versioning.
1.Enable versioning at SM and ME (Set the application preference Versioning Enabled to true ).
2.Create a subscription to V1.0 ChLogic1 with an allowance limit of 50GB, and V1.0 ChLogic2 with an allowance limit of 50 min/monthly BCR.
3.Create V2.0 ChLogic1 with an allowance limit of 60GB.
Create V2.0 ChLogic2 with an allowance limit of 70 min.
4.Online call 5.Late rating call with timestamp after the online call Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2159Charging User Guide Rating and charging Result: Consumed from the current cycle.
6.Late rating call with timestamp before the online call.
Result: Consumed from the current cycle.
Scenario 4: Late rating with carry-over buckets when versioning is disabled.
1.Disable versioning at SM and ME (Set the application preference Versioning Enabled to false ).
2.Create a subscription to ChLogic1 with a bucket of 60GB/monthly BCR.
3.Trigger BCR ( BCR1 ).
4.Trigger BCR again ( BCR2 ).
5.Late rating call consumes 2GB from the current cycle after BCR2 .
Result: 2GB is consumed either from carry-over bucket or original bucket, based on the priority.
6.Late rating call consumes 4GB from the previous cycle after BCR1 .
Result: 4GB is consumed from the current cycle carry-over bucket.
Scenario 5: Late rating with carry-over buckets when versioning is enabled (BCR versioning).
1.Enable versioning at SM and ME (Set the application preference Versioning Enabled to true ).
Enable the History (Set the Late Call Consumption Logic to ORIGINAL_BUCKET ).
2.Create a subscription to ChLogic1 with carry-over bucket of 50GB/monthly BCR.
3.Create V2.0 ChLogic1 with carry-over bucket of 60GB.
4.Trigger BCR ( BCR1 ).
5.Late rating call consumes 2GB from the current cycle after BCR1 .
Result: 2GB is consumed either from carry-over bucket or original bucket, based on the priority.
6.Late rating call consumes 2GB from the previous cycle before BCR1 .
Result: 2GB is consumed from the carry-over bucket.
7.Disable the History (Set the Late Call Consumption Logic to CURRENT_BUCKET ).
8.Late rating call consumes 3GB from the previous cycle before BCR1 .
Result: 3GB is consumed either from carry-over bucket or original bucket, based on the priority.
Scenario 6: Late rating with carry-over buckets when versioning is enabled (Immediate versioning).
1.Enable versioning at SM and ME (Set the application preference Versioning Enabled to true ).
Enable the History (Set the Late Call Consumption Logic to ORIGINAL_BUCKET ).
2.Create a subscription to ChLogic1 with carry-over bucket of 50GB/monthly BCR.
3.Create V2.0 ChLogic1 with carry-over bucket of 60GB.
4.Immediate Event Call (IEC) consumes 1GB.
5.Trigger BCR ( BCR1 ).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2160Charging User Guide Rating and charging 6.Late rating call consumes 10GB from the current cycle after BCR1 .
Result: 10GB is consumed either from carry-over bucket or original bucket, based on the priority.
7.Late rating call consumes 2GB from the previous cycle before BCR1 .
Result: 2GB is consumed either from carry-over bucket or original bucket, based on the priority.
8.Disable the History (Set the Late Call Consumption Logic to CURRENT_BUCKET ).
9.Late rating call consumes 3GB from the previous cycle before BCR1 .
Result: 3GB is consumed either from carry-over bucket or original bucket, based on the priority.
Scenario 7: Late rating call triggers the version change, if it is not triggered.
1.Enable versioning at SM and ME (Set the application preference Versioning Enabled to true ).
2.Create a subscription to V1.0 ChLogic1 with an allowance limit of 50GB, and V1.0 ChLogic2 with an allowance limit of 50 min.
3.Create V2.0 ChLogic1 with an allowance limit of 60GB, and V2.0 ChLogic2 with an allowance limit of 70 min.. 4.Late rating call.
Result: Initial Value of allowance limit 1 = 60GB, Initial Value of allowance limit 2 = 70 min.
Scenario 8: Notifications with late rating calls.
1.Create a subscription to ChLogic1 with an allowance limit of 10GB, including a threshold that sends an email notification at 50%/monthly BCR.
2.Create V2.0 ChLogic1 with an allowance limit of 20GB, including a threshold that sends an email notification at 50%.
3.Trigger BCR ( BCR1 ).
4.Late rating call consumes 12GB from the current cycle after BCR1 .
Result: Notification is sent 5.Late rating call consumes 6GB from the previous cycle before BCR1 .
Result: Notification is not sent.
Scenario 9: SNR with late rating calls.
1.Create a subscription to V1.0 ChLogic1 with an allowance limit of 50GB, and a Policy Counter including a threshold that sends SNR at 20GB, 30GB and 50GB/monthly BCR.
2.Create V2.0 ChLogic1 with an allowance limit of 60GB, and a Policy Counter including a threshold that sends SNR at 20GB, 30GB, and 50GB.
3.Trigger BCR ( BCR1 ).
4.Late rating call consumes 21GB from the current cycle after BCR1 .
Result: SNR is sent Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2161Charging User Guide Rating and charging 5.Late rating call consumes 21GB from the previous cycle before BCR1 .
Result: SNR is not sent.
Scenario 10: Late call consumption when the history is disabled.
1.Disable the History (Set the Late Call Consumption Logic to CURRENT_BUCKET ).
2.Create a subscription to V1.0 ChLogic1 with an allowance limit of 50GB, and a rate of 2$/GB.
3.Create V2.0 ChLogic1 with an allowance limit of 60GB, and a rate of 4$/GB.
4.Trigger BCR ( BCR1 ).
5.Late rating call consumes 70GB from the previous cycle before BCR1 .
Result: Consume 60GB from Bucket1 V2.0 ChLogic1 .
Once fully consumed, then charge from V1.0 ChLogic1 overage rate1 (after bucket) 2$/1GB.
Scenario 11: Late call consumption when the history is disabled, and bucket consumption exceeds the bucket balance.
1.Disable the History (Set the Late Call Consumption Logic to CURRENT_BUCKET ).
2.Create a subscription to V1.0 ChLogic1 with an allowance limit of 50GB.
3.Create V2.0 ChLogic1 with an allowance limit of 60GB.
4.Trigger BCR ( BCR1 ).
5.Late rating call consumes 70GB from the previous cycle before BCR1 .
Result: Call fails with the result code 4012 (Quota Limit Reached).
8.49 Apply a Charging Service only if another Bundle is active This feature enables the option to apply a Charging Service for a subscriber only if another Bundle is active on its profile.
For example, a subscriber has a Bucket of 100 SMS per month.
The subscriber can get a promotional plan of 10% discount on voice calls only if the SMS bundle is active.
To enable this feature, the condition attribute ActiveSubscriptions.Bundle.Id is used in rule, which returns a list of bundles that are active (not in Barred state).
It is available in source contexts SPR_DEVICE and SPR_GROUP , for several triggers (refer to sections SPR_DEVICE source context on page 1111 and SPR_GROUP source context on page 1163 for applicable triggers).
In contrast, if Subscription.Bundle.Id is used in rule, it returns all (active and barred) bundles.
Example Subscription for Device 1.Create two bundles, DefaultBundle and MyBundle .
Mark both as Active .
2.In Rules and Variables , select an applicable trigger (for example, APPLICABILITY ).
Add a rule variable InBundle as shown in the following figure.
In the default value field, select FALSE .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2162Charging User Guide Rating and charging 3.Create a Charging Service and use the variable in Applicability or Tariff (using different Rate) and check that the variable is true .
Link the Charging Service to the bundle DefaultBundle .
4.Configure the rule SPR_DEVICE.ActiveSubscriptions.Bundle.Id contains "MyBundle" for APPLICABILITY or TARIFF in the Charging Service.
Also do the same configuration in a THRESHOLD.
5.If MyBundle is active, send notification for it to the Subscriber.
Else, notification is not sent.
Subscription for Group The configuration for Group subscription is similar to Device subscription described in the previous steps.
However, in steps 2 and 4, for the if condition in the rule, use SPR_GROUP.ActiveSubscriptions.Bundle.Id contains "MyBundle" .
8.50 Correlation charging for voicemail call retrieval Correlated charging mechanism establishes a correlation between the instances of normal outgoing call and the possible network-initiated call originated by the same subscriber.
The subscriber is not charged for two call instances separately.
Correlated charging is applied to charge just one leg of the call with highest rate.
For example, a subscriber is listening to a voicemail message, and has the option to automatically call the subscriber who has left a message.
If he does that, then a network-initiated call is generated from the subscriber to the message originator.
This is treated as the second call.
The existing voicemail retrieval call Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2163Charging User Guide Rating and charging is treated as the first call, which still continues while the second call is in progress.
If correlated charging is configured, only one of the calls with the highest rate is charged.
The following actions are available in GY_PRE_PROCESSING trigger to configure this feature: •GY_PRE_PROCESSING.Valid-Call-Correlation Usage: GY_PRE_PROCESSING.Valid-Call-Correlation = VirtualRG_LONG When correlated charging is active for leg 1, NCC creates a virtual MSCC using source contexts populated from the paired leg 2 session.
The virtual MSCC uses the virtual RG defined for correlated session.
•GY_PRE_PROCESSING.Establish-Correlation Applying highest rate for leg 1 During correlated session NCC picks the highest rate from leg 1 (rate 1) and leg 2 (rate 2), and applies it to leg 1.
•If rate 2 > rate 1: NCC switches to rate 2 at correlation time.
Returns back to rate 1 once correlation finishes and leg1 continues.
•If rate 1 ≥ rate 2: rate 1 is applied.
Note : •Rate comparison is done for normal step cost/quantity value between two rates.
•No-charge is considered as zero rate.
•If bucket is applied in one of the legs, the bucket is used for correlated session duration.
If bucket is applied to both legs, the leg1 bucket is used first.
•When switching from rate 1 to rate 2 at correlation time, flat-charge and N-free is not applied again and new rate is applied as soon as N-free of previous rate ends.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2164Charging User Guide Rating and charging Applying zero rate for leg 2 If leg 2 has zero rate, during correlated session NCC picks rate of leg 1 (rate 1).
Leg 2 remains free of charge (zero rate with original rate2).
Rule example Rule to mark leg1 of the call as valid for correlation GY_PRE_PROCESSING rule 1 if IMS_SERVICE_INFO.Called-Party-Address = "121" then GY_PRE_PROCESSING.Valid-Call-Correlation ( 999 ) Rule to establish correlation from leg 2 of the call GY_PRE_PROCESSING rule 2 if CONVERSION.Match-Regular-Expression ( GyCCR.Service-Information.IMS- Information.Application-Server-Information.Application-Server, "ni-oick=55" ) = "ni-oick=55" then GY_PRE_PROCESSING.Establish-Correlation = BooleanEnum_TRUE CDR The field correlatedCharging is available in CDR for this feature.
The following values are generated for this tag: •leg1 : Correlated charging active for leg1.
•leg2 : Correlated charging active for leg2.
8.51 Emergency loan A prepay subscriber is eligible for the loan (overdraft) service if its account has been active for at least 30 days.
Subscribers who are eligible for the loan service may opt-in through an API request from the operators' IT systems.
Opted-in subscribers may opt-out again at any time, but remain eligible for the loan service.
Operator can configure whether, and how much, to charge a activation fee for opting in to the loan service.
Subscribers who are opted-in to the loan service receive a calling credit loan as per the loan amount (configured by the operator) when their balance reaches zero or goes below a defined low credit.
The loan Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2165Charging User Guide Rating and charging may be used for a chargeable event, with no change in the subscriber’s price plan.
There is no limit to the number of times a subscriber may receive a loan provided they do not already have an outstanding loan.
Operators can charge subscribers a service fee for every calling credit loan they receive, but it is charged when the subscriber opts out from the service.
Loan example The following table and figure demonstrate a sample loan configuration and account balance after loan opt-in.
Name Type Loan amount Activation feeService fee Service fee paid only if loan used IOU Recurrent £3 £0 £0.45 Y ETS One- time 450 HUF 0 HUF 120 HUF NTable 239: Examples - loan configuration Figure 120: Example - Account balance after loan Opt-In Scenarios for sending notifications Following are some scenarios in which operators can configure to send notifications to the subscribers: •If a subscriber with account loan state Initial and main balance at a configured threshold value (say zero) executes a call, then the subscriber receives a notification for failure with option to opt-in for loan service as shown in the following example: You are running low on credit.
To top up, call ###.
To borrow £3, SMS ABC to ### or call ### for free.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2166Charging User Guide Rating and charging •Opted-in subscribers with a low balance also receive a notification.
•Opted-in subscribers making a chargeable event that enters the loan portion of their balance receive a notification once the event is complete, as shown in the following example: You are now using your £3 credit.
This amount and a 45p service fee will be deducted from your next topup.
•Operator tries to reset the loan state from Opt-in /Opt-out to Initial .
•Subscriber opts out from loan service.
EDR The operator receives related EDRs for subscriber opt-in or opt-out, or resetting loan state.
Refer to CDR/ EDR Reference for more information.
8.51.
1 Loan operations Loan activation (opt-in), deactivation (opt-out), and reset are performed using the following APIs: •TMF API: PATCH /tmf-api/accountManagement/v4/billingAccount/{id} •Native API: /services/ServiceManager/LoanRequest If a loan operation is triggered by the TMF API containing account ID (as mandatory parameter), then it internally triggers the native LoanRequest API for the respective operation.
Loan activation (opt in) Subscribers who are eligible for the loan service may opt-in through an API request to NCC from an IT systems.
Opted-in subscribers may opt-out anytime and still remain eligible for the loan service.
Operators can apply a charge (as activation fee) or no charge for opting in to the loan service.
Subscribers who are opted in to the loan service receive a calling credit loan as per the configured loan amount by the operator.
The loan may be used for any chargeable event.
There is no limit on the number of times a subscriber may receive a loan provided they do not already have one outstanding remaining debt.
Loan deactivation (opt out) If main balance is enough to pay remaining debt: •Remaining debt is deducted from main balance.
•Loan is cleared.
•EDR and notification are generated.
If main balance is NOT enough to pay remaining debt: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2167Charging User Guide Rating and charging •Remaining debt is NOT deducted from main balance.
•Main Balance remains the same.
•Loan is NOT cleared.
•EDR and notification are generated.
Loan reset Reset from Initial-to-Initial loan state is Allowed.
•Main balance remains the same.
•Remaining debt is cleared.
•EDR and notification are generated.
8.51.2 Loan rejection Operator can configure loan (opt-in) rejection on the basis of configurable conditions and applicable rules.
For example, in device, CustomData can be configured as ClassOfService.
With appropriate configuration in loan pre-processing rules, operator can create condition on ClassOfService and reject the loan/opt-in for the device.
Note : If the device custom data is same as the value that is configured in rule for Reject-Loan action, then the Opt-In request is rejected.
Configuration To execute the native API or TMF billingAccount API for Opt-In , Opt-Out , or Reset request, provide the LoanRequest attributes described in LOAN_REQUEST source context on page 581.
LOAN_REQUEST source context contains the LoanRequest attributes which are described in the following table: Note : Account and device information should be provided in the loan request.
Either one of them or both can be provided to process the loan request.
Use result context action LOAN_RESULT.Reject-Loan to configure the loan rejection.
Refer to LOAN_RESULT result context on page 1282 for details.
Default error If no error code and description is configured in rule, then the following default error is returned: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2168Charging User Guide Rating and charging Error codeError description 403 Loan is rejected as per configuration by customer.
Examples Example 1: Opt-In request is rejected for MBB Prepay •Configuration: Device1 is configured with MSISDN as 9923212123, and has ClassOfService custom data as MBB_Prepay .
The rule is configured as follows: If Device.ClassOfService=MBB_Prepay then Reject-Loan •Execution: TMF billingAccount API is executed for Opt-In request (Loan request).
•Result: Opt-In request is rejected with a detailed error response: "SM_LOAN_REQUEST_FAILED: 500: ERROR DESCRIPTION: Loan is rejected as per configuration by customer."
8.51.3 Loan usage threshold Loan usage threshold is applied (to account) to receive notification when loan consumption is started.
•NCC does not allow any threshold value if the loanUsageFlag is true in TPG, because NCC provides loan usage notification during the call execution.
•TPG applied to get loan usage notification (loanUsageFlag = true) is applicable only for threshold profile Type Absolute from Zero and can be applied only to Account.
•In NCC GUI, TPG configuration for loan usage must be selected with Account loan balances .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2169Charging User Guide Rating and charging •For loan usage notification, NCC allows to configure only one TPG of loanUsageFlag = true .
•With loan usage notification threshold, features like overage, recurring, threshold on reservation, OCS policy, and dynamic milestone, are not applicable and their related application preferences must be kept as false .
•Send Notification and Add-EDR actions are supported in loan usage threshold.
Hard-Stop, Soft-Stop, SNR/RAR scenarios are not supported.
Slice reduction logic with loan usage threshold If slice allocation factor is set to 100% in slicing profile and loan usage threshold is configured, then slice reduction logic grants additional 1 base unit (byte/second/unit) to the GSU when the nearest delta comes from loan usage threshold.
This is done to avoid extra updates towards NCC since notification is expected when account balance < Loan-Amount and not when account balance = Loan-Amount .
This is in-line with behavior for other thresholds which are crossed when committed units are same as granted units.
If two thresholds (for example, loan balance threshold and main balance threshold) have the same value, then REJECT and STOP have higher priority.
If actions are same, loan balance threshold is given lower priority.
Important : In the logic of adding 1 unit to loan usage delta, consider the following points: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2170Charging User Guide Rating and charging 1.If REJECT or STOP are configured within GSU and GSU+1 units, then 1 unit is not added to GSU.
In this scenario, the REJECT/STOP actions have priority over loan threshold.
2.Delta value from loan usage threshold must be greater than 0.
If delta value = 0, then minimum slice with CONTINUE action is executed.
3.Slice allocation factor must be 100%.
If slice allocation factor is <100%, then it indicates that the allocated slice is explicitly reduced.
In this scenario, 1 unit is not added.
4.The recommended threshold action with loan threshold is CONTINUE .
8.51.4 Pre-call announcement with loan Operators can configure an announcement or notification for insufficient credit, or low credit (at threshold).
The following figures show scenarios for insufficient credit announcement at initial and opt-in states.
For an example scenario, refer to Example 3: Pre-call announcement for low balance and unable to fund on page 2195 .
Figure 121: Insufficient credit announcement at initial state Figure 122: Insufficient credit announcement at opt-in state Important : •Announcement parameters are not supported for thresholds applicable to loan balance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2171Charging User Guide Rating and charging •Announcement parameters for announcement frequency and priority are not supported for the following: –RSV rules for RATING_POST_PROCESSING trigger, for insufficient credit (unable to fund) (default frequency is always ) –Threshold applicable to MainBalance (absolute from zero) (default Frequency is always ).
•Announcement information through low balance and standard plan is not supported.
If both are configured in threshold rules, then both announcement information are be sent in response.
•If announcement information attributes are configured in multiple rule groups of RATING_POST_PROCESSING trigger, then announcement information with the last rule group is sent in response.
8.51.5 Loan repayment Loan repayment using top-up API is available through recharge microservice.
When a top-up is done, the amount is first used for loan repayment, and the remaining amount is used for account recharge.
It can be configured if the top-up amount can/cannot be used for loan repayment.
When a top-up is done, the trigger PRE_RECHARGE can be evaluated (as shown in the following figure) to check if any pending loan repayment has to be done with the top-up amount.
Figure 123: Rule to evaluate if loan repayment has to be done •TRUE : The loan repayment is not done from top-up amount.
The entire top-up amount is credited to the account balance.
•FALSE : The loan repayment is done from the top-up amount.
•If this action is not provided, the default value is FALSE .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2172Charging User Guide Rating and charging Logic for loan repayments Loan repayment depends on the following: •type of loan subscribed •whether the loan is used or not •value set in parameter Service fee paid only if loan used The following logic applies for loan repayments: Loan used?Service fee paid only if loan usedType Main Balance (MB) and Loan Amount (LA) relationResult Loan State Used TRUE One- timeMB < LA •Main balance is granted the top- up amount •The remaining debt is cleared •Loan is NOT granted AGAINInitial Not usedTRUE One- timeMB ≥ LA •Main balance is granted the top- up amount •The remaining debt is NOT cleared •Loan is NOT granted AGAINOpt- In Used FALSE Recurrent MB < LA •Main balance is granted the top- up amount •The remaining debt is cleared •Loan is granted AGAIN and remaining debt is addedOpt- In Not usedFALSE Recurrent MB ≥ LA •Main balance is granted the top- up amount •The service fee is deducted and remaining debt is adjusted •Loan is NOT granted AGAINOpt- InTable 240: Loan repayment logic Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2173Charging User Guide Rating and charging Note : If Loan entity for recurrent loan using which loan has been opted-in is deleted after opting- in, then loan repayment using top-up API is done considering the loan as one-time loan and the fee is paid only if Service fee paid only if loan used is true .
8.51.6 Service fee updates If service fee defined in the loan configuration is updated, then the consider the following points.
Warning : Service fee update is only supported for specific custom scenarios.
It is not recommended to change the loan parameters.
However, in exceptional scenarios if the loan parameters are updated, then they become effective only when subscribers opt-in to loan service again.
•If loan was used, Service fee paid only if loan used = true , and service fee is updated, then old service fee is deducted at the time of loan repayment/opt-out.
New service fee is applicable after subscribers opts-in again to loan service.
•If loan was NOT used, Service fee paid only if loan used = true , and service fee if updated, then service fee is NOT deducted at the time of loan repayment/opt-out.
•If loan was NOT used, Service fee paid only if loan used = false , and service fee if updated, then old service fee is deducted at the time of repayment of loan amount or opt-out.
New service fee is applicable after subscriber opts-in again to loan service.
•For recurrent or partial repayment, if loan state is opt-in, then old service fee is applicable.
Once the loan is opted out, then new service is applicable.
8.51.7 Important points •Loan Amount configured in Loan should be greater than 0.
•Loan is applicable only for monetary balance.
•Only one loan can be granted to an account at a time.
•If Account Loan State is OPT-IN , no further loan can be granted to Account.
•If Account Loan State is OPT-OUT , but the account has a loan instance (as main balance of account was insufficient to pay remaining debt during OPT-OUT), no further loan can be granted to the Account.
•During OPT-IN, EDRs of adjustBalance are also generated along with loan operation EDRs.
•Operator must configure the following: –TPG with rules to have low balance notification at opt-in/opt-out/initial –TPG with Loan Balance Usage = TRUE .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2174Charging User Guide Rating and charging •Existing TPG needs to be modification for Account Main Balance Notification to have flexibility based on loan instances (through rule conditions) to get different types of notification or to get loan instances variables in notifications.
•Account Custom Data is not mandatory for eligibility of availing loan.
•Loan is not applicable for Groups.
•Creation and updation of loan definition can be done by native APIs/GUI.
(These are not supported using TMF APIs.)
•If the main balance is not sufficient to grant the activation fee, then main balance is reduced to zero and loan is granted.
•Loan to grant a Bundle (as Loan) is not allowed.
•CustomData for eligibility/ineligibility is not mandatory for this feature.
However, it is described here to provide configuration for the operators who want to use CustomData in Account for other Loan states.
•NCC supports only three loan states: Initial → Opt-In → Opt-out.
•If an operator has a requirement to update the CustomData of the Account, that should be done by the existing NCC API.
NCC does not update it automatically as part of loan feature.
•It is recommended to have Overage Limit as 0 in account.
8.51.8 Loan as Bundle In addition to an amount-based loan, NCC provides an option of a bundle-based loan.
When this type of loan is opted-in, a new subscription is given to the user without deducting any bundle fee.
The loan service fee and bundle fee are deducted from the subscriber account balance at the time of repayment (top-up) or opting out from the loan service.
A Subscriber's account can opt in only to one loan.
Only loan as Bundle or loan as amount can be created at a time.
If we are creating loan as Bundle then loan amount should be null or 0.
Loan activation (opt in) During OPT_IN, if the loan that contains bundleName with loanAmount =0, then subscription is created without deducting the bundle fee from account balance.
That is, if subscription is taken from loan and if Account has insufficient fund, then also the Subscription is created.
Along with bundleFee, the serviceFee is added to the remaining debt, which must be re-payed at the time of OPT_OUT or top up.
Also, if there is an activation fee and it is less that account balance, then account balance is adjusted with activation fee.
If activation fee is more than effective account balance then account balance is set to 0.
The subscription created via Bundle based loan has an associated loanID .
Similarly, the loan instance has an associated subscription ID.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2175Charging User Guide Rating and charging Loan deactivation (opt out) During OPT_OUT, if the account has sufficient balance then the remainingDebt is re-payed and the loan instance in account is deleted.
If account does not have sufficient balance, then state is changed to OPT_OUT and remaining debt is adjusted with the account balance.
For example, if remaining debt is 20 and account balance is 15, then remaining debt becomes 5.
Note : The subscription that was created for bundle-based loan remains active on the device even after loan has been opted out.
Loan reset During RESET, the total remainingDebt is set to 0 (irrespective of the accountBalance), loan instance in account is deleted, and the loan state is changed to INITIAL.
Note : The subscription that was created for bundle-based loan remains active on the device even after loan has been reset.
Repayment of loan as a bundle during recharge If an account has availed loan as a bundle, when recharge is done loan debt is repaid.
During recharge on an account, if a loan as bundle is associated with that account and loan remaining debt is more than zero, then the recharge amount is first used to repay the loan amount.
Scenario Result Loan state is set to Loan remaining balance Recharge amount > loan remaining debtAmount left after repaying the debt is added to the Account main balance.INITIAL 0 Recharge amount = loan remaining debtThe whole recharge amount is used to repay the debt.INITIAL 0 Recharge amount < loan remaining debtThe whole recharge amount is used to repay the debt.No change in the loan state.Loan remaining debt minus Recharge amountTable 241: Scenarios of repayment if no rules are set for partial payment Note : During debt repayment for loan as a bundle, irrespective of the value of payFeeIfLoanUsed, loanServiceFee is repaid during topup/recharge.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2176Charging User Guide Rating and charging Partial loan repayment during recharge Operator can either configure the percentage of recharge amount or absolute amount in rules, which can be used to repay the loan.
•Adjust-TopUpPercentage-For-Loans is used to configure the percentage of recharge amount for loan repayment.
•Adjust-TopUpAmount-For-Loan is used to configure the absolute amount from recharge amount for loan repayment.
•If both the actions Adjust-TopUpPercentage-For-Loans and Adjust-TopUpAmount-For-Loan are available in rules, then only Adjust-TopUpPercentage-For-Loans is considered.
•Percentage adjustment is done only if the percentage is greater than zero.
If percentage is more than 100, the total top-up amount is considered for loan repayment.
•Absolute adjustment is done only if the value is greater than zero.
If absolute adjustment value is more than top-up amount, the total top-up amount is considered for loan repayment.
Example: Adjust-TopUpPercentage-For-Loans •RECHARGE_RESUL T.Adjust-TopUpPercentage-For-Loan = 75.
•Out of the recharge amount, 75% is used for loan debt repayment and remaining 25% is added in the account main balance.
•If amount needed for debt repayment is less than 75% of recharge amount, then remaining amount is added to account main balance.
•If amount needed for debt repayment is greater than or equal to 75% of recharge amount, then all 75% of recharge amount is used of loan debt repayment.
Example: Adjust-TopUpAmount-For-Loan •RECHARGE_RESUL T.Adjust-TopUpAmount-For-Loan = 10.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2177Charging User Guide Rating and charging •An amount of 10 from the recharge amount is used for loan debt repayment and remaining amount is added in the account main balance.
•If amount needed for debt repayment is less than 10, then remaining amount (10 - amount used for loan debt repayment) is added to account main balance.
•If amount needed for debt repayment is greater than or equal to 10, then the complete amount of 10 is used for loan debt repayment.
8.51.9 Examples 8.51.9.
1 Example 1: Loan usage as main balance, low balance notifications on call, and loan usage notification 1.Configure the following ME application preferences: a.EDR Logging Enabled = true b.AutoGen SPR Ids = true c.EDR Generator Flag = true 2.Configure the following rule in LOAN_PRE_PROCESSING trigger.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2178Charging User Guide Rating and charging Figure 124: Rule to enable IOU grant if Account custom data is 'Eligible' Figure 125: Rule to reject loan if already in Opt-In state Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2179Charging User Guide Rating and charging Figure 126: Rule to reject loan if already in Opt-Out state 3.Configure rule in LOAN_POST_PROCESSING trigger, to send the notification based on the loan operation: 4.The device purchases a subscription Bundle1 , with Account A1, and User is attached to the device.
5.Configure Account Balance with a Main Balance = £1.00 and with OverageLimit = 0, and attach User to the Account.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2180Charging User Guide Rating and charging 6.Create a loan with the following configuration: Name Type Loan amount Activation feeService feeService fee paid only if loan used IOU Recurrent £3.00 0 £0.45 Selected ( True) 7.Account has a TPG with Absolute from zero as Threshold for Low Balance Set at £1 with Send Notification action based on the Account Loan State.
Following figure provides an example to have flexibility based on loan instances (through rule conditions) to get different types of notification or to get loan instance variables in notifications: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2181Charging User Guide Rating and charging 8.To receive loan usage notification, apply a TPG with Loan Usage flag=true with Send Notification action as well with Account: Figure 127: Account with TPG having loan usage enabled Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2182Charging User Guide Rating and charging Figure 128: Loan usage flag notification template 9.The following figure shows the account overview with two TPGs attached: Execution 1.Opt-In using TMF API for Account with Custom data as In-Eligible.
The request is rejected as per the rule configured.
2.Execute TMF request to change the Custom Data from Ineligible to Eligible.
3.Execute Opt-in request using TMF API.
Check that Opt-In is successful with Loan as main Balance £ 4.
Remaining Debt becomes £ 3.45. notification of Loan Opt-In is generated.
EDR is generated.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2183Charging User Guide Rating and charging 4.Subscriber executes a call, resulting to consumption of £ 0.30.
As a result, the main balance of the account becomes £ 3.70.
5.Execute Opt-out request using TMF API.
Main-Balance remaining = £0.70 (that is, £3.00 has been successfully paid back).
Subscriber account state is Opt-Out.
EDR is generated.
Opt-Out Notification is generated.
6.Execute Opt-in Request using TMF API.
Opt-In is successful with loan as main Balance £ 3.7.
Remaining Debt is £ 3.45.
Notification of loan Opt-In is generated.
EDR is generated.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2184Charging User Guide Rating and charging 7.Subscriber executes a call, resulting in consumption of £3.2.
Subscriber's main balance becomes £0.5.
Two notifications are generated.
As balance granted as loan has been used for the consumption of the call, so (i) Loan Usage Notification is sent and the (ii) low balance threshold notification is also triggered as the MainBalance is less that £ 1.
8.Execute RESET request using TMF API.
Reset is successful and the MainBalance remains as 0.5.
Notification is triggered for RESET.
EDR is generated.
8.51.9.2 Example 2 Common configuration 1.Configure the following ME application preferences: a.EDR Logging Enabled = true b.AutoGen SPR Ids = true c.EDR Generator Flag = true Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2185Charging User Guide Rating and charging 2.Create custom data at Account for In-Eligible /Eligible: 3.Configure the following rule in LOAN_PRE_PROCESSING trigger.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2186Charging User Guide Rating and charging Figure 129: 4.Configure the following rule in LOAN_POST_PROCESSING trigger.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2187Charging User Guide Rating and charging 5.Configure the following rule in POST_RECHARGE trigger in Recharge RSV.
6.Configure Notification Templates for rules – Loan Pre/Post Processing.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2188Charging User Guide Rating and charging 7.Configure Notification Template for Recharge: 8.Set Account TPG Loan Usage Flag as true Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2189Charging User Guide Rating and charging Figure 130: If operator wants to send EDR/notification only in Diameter call 9.Configure loan usage flag notification template: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2190Charging User Guide Rating and charging Prepay Subscriber activates a £3 Loan service (via TMF API) with repayment - Success Configurations 1.Configure Device1 with E164 = 3507000011.
Device purchases subscription with any bundle with Account3507 and user is attached to the device.
2.The Account Balance configured has a MainBalance = £1.00, and with OverageLimit = 0 and the User is attached to the Account.
3.Create a Loan Entity LoanIOU with following Configuration: Name Type Loan amount Activation feeService fee Service fee paid only if loan used Loan IOU Recurrent £3.00 0 £0.45 Selected ( True) 4.Account has a TPG, with Absolute from zero as Threshold for Low Balance Set at £1 with Send Notification action based on the Account Loan State.
5.Account also has a TPG with Loan Usage flag =true with Send Notification action.
6.Subscriber Account is in Initial Loan State and subscriber doesn not have loan.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2191Charging User Guide Rating and charging 7.Subscriber Account custom Data for Loan is InEligible .
8.Rule is configured in LOAN_PRE_PROCESSING tigger, that IOU loan should be granted if Account Custom data is Eligible .
9.Rule is configured in LOAN_POST_PROCESSING trigger to send the Notification based on the Loan Operation.
Execution 1.Opt-In using TMF API for Account with Custom data as In-Eligible.
The request is rejected.
2.Execute TMF request to change the Custom Data from Ineligible to Eligible.
3.Opt-In using TMF API.
Check that Opt-In is successful with Loan as main Balance £ 1.
Remaining Debt becomes £ 3.45.
Notification for of Loan Opt-In are generated.
EDR is generated.
4.Subscriber executes a call, resulting to consumption of £ 1.18.
As a result, main balance of the account becomes £ 2.82.
Loan usage notification and EDR are generated.
Lone type is one-time and loan is used Configuration Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2192Charging User Guide Rating and charging 1.Configure Device1 with E164 as Device3465, with Account as Account3465 for BundleMB3404 and user is attached to the device.
2.The Account Balance configured has a MainBalance of £ 4.35, with Overage Limit at 0, and the User is attached to the Account.
3.Create a Loan Entity with following Configuration: Name Type Loan amount Activation feeService fee Service fee paid only if loan used ETS1 One- time £5.00 0 £0.5 Clear ( False) 4.Subscriber Account is in Initial Loan State and subscriber does not have a loan.
5.Subscriber Account custom Data for Loan is Eligible .
6.Rule is configured in LOAN_PRE_PROCESSIONG trigger and Rule is configured in LOAN_POST_PROCESSIONG trigger, to send the notification based on the loan operation.
Execution 1.Execute Opt-in request using TMF API.
Following is the account overview after opt-in: 2.Subscriber executes a call, resulting to consumption of £ 4.88.
Subscriber's main balance becomes £ 4.47.
Refer to the following account overview: 3.Execute a recharge request via rechargeRequest API with amount as £ 6.00 and Remaining debt =£ 5.5.
•Main balance remaining = £ 4.97 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2193Charging User Guide Rating and charging •Loan is used, remaining debt is cleared, and loan is NOT granted again (as of one-time_.
•Remaining debt as £ 0, loan amount = 0.
•Subscriber account state is INITIAL.
•Recharge EDR is generated.
•Recharge notification is generated.
Prepay subscriber repays the one-time loan (with Service fee paid only if loan used = FALSE), loan used as main balance before repayment, but top-up amount is less than loan amount Configuration •Loan is used as main balance.
•Top-up amount < loan amount •Top-up amount < service fee.
•Main balance before loan opt-in: 4.35 •Loan amount £5 •Service fee: £ .5 •Remaining debt: 5.5 •Loan type: one-time •Service fee paid if Loan is Used: False Execution •After loan opt-in, main balance is £ 9.35 (includes loan amount £5) •Call consumption is done and main balance after usage of loan balance is £4.47 •Top-up of £ 0.45 is done on main balance (top-up amount ≤ service fee) Result Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2194Charging User Guide Rating and charging Because the loan was used as main balance, the service fee is deducted at time of repayment/recharge as part of remaining debt.
•Service fee is adjustment with top-up •Remaining debt is updated and main balance remains the same •Remaining debt = 5.5 - 0.45 = 5.05 •Main balance = 4.47 •Loan state: opt-in 8.51.9.3 Example 3: Pre-call announcement for low balance and unable to fund Configuration 1.Configure the following ME application preferences: a.EDR Logging Enabled = true b.AutoGen SPR Ids = true c.EDR Generator Flag = true 2.Configure rule in LOAN_PRE_PROCESSING trigger, to reject loan if Custom Data Eligibility is not Eligible.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2195Charging User Guide Rating and charging 3.Configure rule in LOAN_POST_PROCESSING trigger, to send the notification based on the loan operation.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2196Charging User Guide Rating and charging 4.Configure rule in RATING_POST_PROCESSING trigger to send an Announcement when the account has insufficient credit (Unable to Fund).
5.Create Slicing Profile with Slice-Allocation-Factor=100 and Min-Slice-Size= 1.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2197Charging User Guide Rating and charging 6.Create a Rate with 0.3 cost for 1 sec.
Apply this rate in Charging Logic and then in Bundle B1.
7.Configure Device1 with E164 = 123456890.
The device purchases a subscription Bundle1, with Account A1, and User is attached to the device.
8.The Account Balance configured has a Main Balance of £1.00, and with Overage Limit at 0 and the User is attached to the Account.
9.Create a loan with the following configuration: Name Type Loan amount Activation feeService feeService fee paid only if loan used IOU Recurrent £3.00 0 £0.45 Selected ( True) 10.Account has a TPG with Absolute from zero as Threshold for Low Balance Set at £1 with Announcement action based on the Account Loan State.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2198Charging User Guide Rating and charging Figure 131: TPG for low balance at 1 11.Account also has a TPG with Loan Usage flag=true with Send Notification action Figure 132: TPG for loan usage 12.Subscriber Account is in Initial Loan State and subscriber does not have loan.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2199Charging User Guide Rating and charging Execution 1.Execute Opt-In request for Account.
The request is successful with Loan as main Balance £ 4.00.
Notification of Loan Opt-In is sent.
2.Subscriber executes a call (Call-I; CCR-I: RSU = 10; CCR-U: USU=0; RSU=10 CCR-T; USU=4).
Call is successful.
Since it is expected to have Loan Usage Notification once Account Balance < Loan Amount GSU which will be granted will be 4 as Delta to be granted from loan Amount is 1, Operator needs to configure Slice Allocation Factor : 100% and Minimum Slice : 1As per NCC current Slice Reduction functionality GSU is granted with +1 addition such as to avoid trigger of additional CCR towards NCC Notification is expected for account balance < loan amount.Loan Usage Threshold with Slice Allocation factor will grant additional 1 base unit (byte/second/unit) when slice allocation factor is set as 100% in slicing profile.
This is to keep it inline with other threshold behaviour which will be crossed when committed units are same as granted units.
3.Subscriber executes another call (Call-II; CCR-I: RSU = 6; CCR-U: USU=0, RSU=6; CCR-T: USU=6).
Call is executed successfully.
Low Balance notification is sent.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2200Charging User Guide Rating and charging 4.Subscriber executes another call (Call-III; CCR-I: RSU = 1; CCR-U: USU=0; RSU=1; CCR-T; USU=1).
Call is executed successfully.
Announcement is sent corresponding to the Loan State at CCR-Initial.
5.Subscriber executes another call (Call-IV; CCR-I: RSU = 2; CCR-U: USU=0; RSU=2; CCR-T; USU=2).
Call is executed successfully.
Announcement is sent corresponding to the Loan State at CCR-Initial.
6.Subscriber executes another call (Call-V; CCR-I: RSU = 2).
Announcement is sent for Insufficient Balance (Unable to Fund) as main balance is less than minimum call charge.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2201Charging User Guide Rating and charging 8.51.9.4 Example 4: Lifecycle action - Reset Loan Action ResetLoanAction is applied to ONL Y account PLC/ELC.
This action is triggered to reset the loan and clear the remaining debt.
As a result, Account Loan state is reset to Initial, that is, loan instance is cleared and main balance remains the same.
An EDR is generated for this action.
If ResetAccountAction is applied Account main balance is reset to zero.
Figure 133: Initial Account overview Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2202Charging User Guide Rating and charging Figure 134: Reset Loan Action configuration Figure 135: Account overview after lifecycle reset event 8.52 Lengthening of bill cycle The default NCC behavior when the account BCR date is changed using PATCH APIs is as follows: •Immediate BCR - The new value of billing information parameters is less than the next occurrence of BCR date.
For example: If the current account bill cycle period is from 09/09 to 09/10 and on 15/09 , the account DoM is updated to 25/09 , then the account bill cycle period is updated immediately from 09/09 to 25/09 , and the next BCR occurs on 25/09 .
•Future BCR - The new value of billing information parameters is higher than the next occurrence of BCR date.
For example: If the current account bill cycle period is from 09/09 to 09/10 and on 20/09 , the account DoM is updated to 15/09 , then only the account DoM is changed to 15/09 immediately, and the Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2203Charging User Guide Rating and charging Account End Time is not updated.
The account bill cycle is updated with new BCR date upon the occurrence of next BCR date (that is, 09/10 ).
The updated bill cycle is from 09/10 to 15/10 .
Note : For more details on the behavior of NCC when PATCH APIs are used to modify the account BCR date, see Patch APIs to modify Account BCR date on page 1972 Currently, when the BCR is set to Future BCR , the bill cycle period is not updated (lengthened) immediately.
This feature provides the functionality to lengthen the bill cycle immediately.
If the application preference Prolong current BC period when BCR changed is set to true , and account BCR date is changed using the PATCH APIs, then the account bill cycle parameters are modified immediately, and the current bill cycle period is updated (that is, Account End Time is set to Requested End Time) .
Note : When the application preference Prolong current BC period when BCR changed is set to false , then the NCC default behavior is applicable (that is, the behavior when account BCR date is changed using PATCH APIs).
Note the following important points related to this feature: •If the bill cycle parameters are modified such that the Requested End Time is greater than the Configured End Time , then the bill cycle is lengthened.
•If the bill cycle parameters are modified such that the Requested End Time is less than the Configured End Time , then the bill cycle is shortened.
•All the subscriptions aligned to the account period lifecycle (that is, subscriptions without their own periodic lifecycle) renew/expire on the new BCR date.
•Proration of linked subscriptions (allowances, counters, fees, and so on) is calculated according to the updated BCR date.
•RAR functionality is supported.
Examples Example 1: Shortening of bill cycle Account bill cycle period is 09/09 to 09/10 .
On 15/09 , the account DoM is updated to 25/09 .
Account bill cycle is updated immediately as 09/09 to 25/09 .
The next BCR occurs on 25/09 .
The bill cycle has been shortened.
Example 2: Lengthening of bill cycle Account bill cycle period is 09/09 to 09/10 .
On 20/09 , the account DoM is updated to 15/10 .
Account bill cycle is updated immediately as 09/09 to 15/10 .
The next BCR occurs on 15/10 .
The bill cycle has been lengthened.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2204Charging User Guide Rating and charging 8.53 Counting bundle subscription and renewal fees into spending limit counters This feature enables operators to count bundle subscription fee/bundle renewal fees into cost-based spending limit counters.
NCC can update applicable cost based counters for deducting bundle subscription fee/bundle renewal fee.
All the applicable counters, whether global counters (device counters, group counters) or multi-bundle counters, are updated with bundle subscription fee/bundle renewal fee, upon bundle subscription/renewal.
Bundle subscription/renewal fail if counter spending limit is reached.
Configuration Use the following configurations so that usage counter counts BoU bundle activation fee, Bundle subscription fee, and Bundle renewal fee: •Set the application preference Increase Counter for Bundle Fee as 2.
(For more information about this application preference, refer to Charging application preferences on page 44.)
•Applicability condition: SUBSCRIPTION.Type-Of-Count = ENUM_Bundle-Subscription- Renewal-Fee (For more information, refer to SUBSCRIPTION source context on page 1174 .)
Important considerations The following are not supported for this feature: •Subscription counter •Multi-bundle counters for group •Cost bucket •Secondary balances 8.54 Updating subscription custom data This feature provides the functionality to create service (bundle) custom data.
Custom data is supported at both service level and subscription level.
When a new subscription is created for a device or group, the custom data can be customized using template API.
If custom data is not defined in the API, then the default values defined at the time of creating the service are considered.
The update/Subscription API can be used to update the custom data for the existing subscriptions.
Service (Bundle) custom data can be updated through versioning.
Custom data is an optional parameter.
Configuration The subscription custom data can be accessed in rules.
The triggers in which subscription custom data is available are as follows: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2205Charging User Guide Rating and charging •CHARGING LOGIC APPLICABILITY and TARIFF •THRESHOLD •RATING_POST_PROCESSING •RESOURCE_POST_PROCESSING •CALL_RULE_VARIABLES •BUNDLE Note : •RATING_POST_PROCESSING trigger is supported only when the application preference Dynamic Notification Custom Flag is enabled.
•THRESHOLD trigger does not support Aggregate View (AV) functionality.
The subscription custom data is available as a notification variable so that it can be sent in the notification content.
The following actions in RESOURCE_POST_PROCESSING , RATING_POST_PROCESSING , TARIFF and THRESHOLD triggers are configured to update custom data for a subscription entity: Custom-Data-Add , Custom-Data-Add-Immediate , Custom-Data-Remove , and Custom-Data-Remove- Immediate .
Add-CDR action generates the subscription custom data for every subscription used during the call.
Subscription custom data is generated at the subscription level in CDR.
Note : It is recommended to use the Add-CDR action in RESOURCE_POST_PROCESSING and THRESHOLD triggers with SERVICE_LEVEL for bucket, counter, No-Charge , or main account balance as this trigger is evaluated after committing each resource that is used during the call.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2206Charging User Guide Rating and charging Additional information •The Call-Result.Add-CDR functionality on threshold is considered only for COMMIT scenarios and not on reservation for threshold or other rule sets.
•This feature supports only the following consumption resources: –Bucket –Counter ( Device , Device- Group , Group , or Subscription type) –Main account balance –No-Charge (with applicable rule variables) •If multiple Call-Result.Add-CDR actions are configured with the same tag name, and the action parameter is configured as OVERRIDE , then only the last tag and value pair is logged in the CDR.
•Upgrade use case (upgrading to NCC version 22.7 or higher with subscription custom data support): –Before the upgrade, the bundles and subscriptions of device/group have no service/subscription custom data.
–After the upgrade, the bundles and subscriptions can have service/subscription custom data.
There are two ways to support the upgrade case, which are as follows –Define new bundle version (Immediately or NEXT_BCR) to define service level custom data with a default value.
After the new call or next BCR, the existing subscription has subscription level custom data with the default value.
–Add the subscription level custom data through update/Subcription API for an existing subscription.
Note : Previously, if new call/BCR or update/Subscription API is received to add new custom data, and queried through getdata/device or getdata/group, then subscription level custom data does not exist.
Currently, after new call/BCR or update/Subscription API, and a query through getdata/device or getdata/group, the subscription level custom data appears.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2207Charging User Guide Rating and charging 8.55 Counters 8.55.
1 Policy counter This feature supports the policy counters where the policy counter status can be modified based on location information.
Different counters can be defined to track the usage based on the location.
For example, when a user is in home location, the usage can be tracked in the base counter, whereas when a user in roaming location, the usage can be tracked in the roaming counter.
The Policy Counter (PC) IDs can be defined to indicate the status of the home and roaming counters.
A location PC ID can be defined to indicate the user's current zone to the PCRF.
Different tariff plans get activated based on the location.
Note : The defined policy counter ID must not exist in the device.
Configuring a policy counter status Perform the following steps to configure a policy counter: 1.Create a custom data string to define a location and attach it to a device.
2.Create the complex maps data to define the mapping between MCCMNC, Country, and Location.
3.Create a threshold with rule to trigger SNR message with location such as home, roam and so on.
4.Create and attach counter to the device and enable the policy counter and resource based options.
Attach the previously defined threshold to it.
Note that the device counter is the PC ID for location.
5.Create a THRESHOLD trigger and define two rule variables Country and Location in it.
Note : •Whenever a usage limit notification is sent for a policy counter, it can cause the change in status of the policy counter.
•Only one policy threshold can be associated with a policy counter.
•Multiple normal thresholds can be associated with a policy counter.
Example Bob has an iPhone device and originates a 5G data call when in Canada and Brazil.
The PC status is set based on the location.
For this example, configure the following entities: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2208Charging User Guide Rating and charging Entity Task Mapping tables Configure the complex map MCCMNC.
NCC takes MCCMNC as input and provides at least two output.
Custom data Create a custom data for Device type.
Thresholds Create the thresholds of different types with same rule.
Counter Create the counters of different types and attach to the device as Device counter type.
Device Create a device and attach the device counter and custom data to it.
Rules and Variables Create a THRESHOLD trigger and define two variables Country and Location in it.
Mapping tables Following is the complex map table.
From SM GUI, navigate to Charging Configurator > Mapping tables .
MCCMNC [key]Country [value]Location [value] 302380 CANADA ROAM 310410 US HOME 301234 MEXICO ROAM 403370 BRAZIL ROAM Custom data Create the following custom data.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2209Charging User Guide Rating and charging Field Value Name Locationpass1 Context Type DEVICE Required false Read Only false Value Type String Multi Value trueTable 242: Locationpass1 Device Create the device and configure the custom data while attaching it to the device.
Field Value Key Locationpass1 Type String Value BRAZIL, CANADA Thresholds Create two different types of absolute threshold profile (THR) threshold TPG333331 and TPG333332 with the same rule.
Threshold - Byte (Kind of Unit = Volume) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2210Charging User Guide Rating and charging Threshold - Second (Kind of Unit = Time) Counter Create two different types of counter and attach them to device as Device Counter type.
Counter - Byte (Unit Type = Byte) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2211Charging User Guide Rating and charging Counter - Second (Unit Type = Second) Rules and variables Create the THRESHOLD rule trigger and define Country and Location rule variables in it.
Trigger Type = THRESHOLD, Rule variable = Country Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2212Charging User Guide Rating and charging Trigger Type = THRESHOLD, Rule variable = Location NCC actions Consider that the iPhone device is in Canada and the custom data Locationpass1 is CANADA and BRAZIL.
NCC performs the following logic based on the MCCMNC values: •The CCRi with MCCMNC = 302380 is received.
Since CANADA is in the custom data Locationpass1 list, Locationpass1 is used for location PC status.
•The CCRi with MCCMNC = 301234 is received.
Since MEXICO is not in the custom data Locationpass1 list, ROAM is used for location PC status.
•The CCRi with MCCMNC = 310410 is received.
Since US is configured as HOME zone in the complex mapping table, HOME is used for location PC status.
8.55.2 Virtual policy counters A virtual policy counter (VPC) is a policy counter (PC) that neither exists in NCC nor is attached with a device.
VPCs are supported for multiple Sy or N28 interfaces.
Following information must be considered for VPCs: •The execution of SY.Send-SNR action is defined in the threshold with the OCS Policy Threshold parameter set to True , and attached to a bucket or counter.
•The VPCs are mapped with buckets, counters, and subscription lifecycles.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2213Charging User Guide Rating and charging •The VPCs are attached to multiple buckets, counters, and lifecycles.
•The policy buckets are included in all Sy or N28 messages, similar to that of PCs.
•An SNR is sent when VPC or PC status is triggered by the provisioning interface.
•All PCs are included in SNR or SLA message irrespective of the state change.
•Some specific policy states are specified when a PC or VPC is detached from the device based on the application preference Removed Signalling State Value .
•The behavior of VPCs is not tested for group configuration and counters.
•VPCs are not supported for aggregate view and accounts.
•A bucket is treated as a policy-type bucket when it has a threshold defined, with the OCS Policy Threshold parameter set to True available in threshold.
Note : To send SNR in provisioning, provide rule THRESHOLD.Threshold-Trigger- Type=ThresholdTriggerType_PROVISION in threshold.
This action should be present with SY.Send- SNR actions.
Also, VPC feature should be enabled (to know how to enable/disable VPC feature, refer to the application preference Virtual Policy Counter Support ).
Rule example: THRESHOLD.Threshold-Trigger-Type=ThresholdTriggerType_PROVISION and SY.Send-SNR= "HIGH" Application preferences The following application preferences are available for VPCs (see Charging application preferences on page 44 for definitions).
•Virtual Policy Counter Support •Default Signalling State Value •Include All Policy Counters in SNR •Aggregate Counter Priority •Removed Signalling State Value Note : Once the status of flag Virtual Policy Counter Support is changed from ON to OFF or vice versa, then the new behavior is be more consistent on the new subscription taken.
For older subscriptions, policy counter name/status over Sy interface may be slightly inconsistent because of the current information for the old instances in database.
VPC support in Send-SNR action for threshold The Send-SNR action in threshold is defined with pair of parameters, for example, Sy.Send-SNR = “VPC, State” .
The first parameter is the VPC name and the second parameter is the Policy state.
Although there can be multiple pairs of parameters in the Send-SNR action, only the first pair is considered.
For example, if Sy.Send-SNR = “VPC1, State1;VPC2,State2;VPC3,State3” is defined, then only VPC1, State1 is considered.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2214Charging User Guide Rating and charging In the Send-SNR action, the first parameter in a pair is optional.
If only one parameter is provided, then it is considered as the state.
In this scenario, the Bucket name or Counter name is sent as the policy counter ID (PCID) to the PCRF over Sy/N28 interface.
See the following scenarios.
Scenario 1: Virtual Policy Counter Support flag is ON and Bundle is subscribed: •If threshold action is configured on Bucket/Counter as SY.Send-SNR="VPC,High" then in SLA/SNR, policy counter name will be VPC and policy counter state will be High .
•If threshold action is configured like SY.Send-SNR="High" then in SLA/SNR, policy counter name will be Counter/Bucket Definition name and policy counter state will be High .
Scenario 2: Virtual Policy Counter Support flag is OFF and Bundle is subscribed: •If threshold action is configured as SY.Send-SNR="VPC,High" then in SLA/SNR, policy counter name will be Counter Definition name and policy counter state will be VPC,High .
•If threshold action is configured on counter as SY.Send-SNR="High" then in SLA/SNR, policy counter name will be Counter Definition name and policy counter state will be High .
Figure 136: Example: VPC in Send-SNR action In this example, as the threshold can be attached to multiple Bucket(s)/Counter(s), VPC1 can be shared by multiple Bucket(s)/Counter(s).
When the threshold is executed, the PC name and state provided in the Send-SNR action are sent to the PCRF over Sy/N28 interface in SLA and SNR.
A Bucket/Counter is linked to only one PCID.
If multiple PCIDs are configured in different Send-SNR actions in the threshold linked to one Bucket/Counter, then the first occurrence of the PCID is considered as the PCID for that Bucket/Counter.
Sorting logic of VPCs A sorting logic resolves the conflict wherein multiple VPCs with the same name become eligible to be sent to the PCRF.
If multiple resources are updated during a data session through provisioning or lifecycle, then it leads to execution of linked thresholds having Send-SNY with the same VPC name.
The sorting logic is enabled if the application preference Virtual Policy Counter Support is set to BUCKET_COUNTER .
Rules to follow at conflict situation is as below Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2215Charging User Guide Rating and charging The priority is applicable for both SLR and SNR and for both Sy and N28 interfaces.
1.A PC with an active subscription has higher preference over a PC with barred subscription.
2.If a PC is associated with multiple active subscriptions or all barred subscriptions then: •The PC linked to non-exhausted bucket or counter is selected.
•If all buckets or counters are exhausted, then the PC associated with a bucket or counter having the latest exhaustion time is selected.
Note : Exhaustion of bucket and counter is derived using the following rule: •When the bucket balance reaches zero, it is considered as exhausted and the time when the exhaustion happens becomes the exhaustion time of the bucket.
•When a counter reaches a value that triggers the threshold action, the counter is said to be exhausted and the time when exhaustion happens becomes the exhaustion time of the counter.
If the Notification-Reject or Reject action is triggered when a counter reaches the threshold value, then this is considered as a hard-stop scenario for counter.
3.If there are multiple non-exhausted buckets or counters OR multiple buckets or counters with the same exhaustion time, then the PC linked with the highest charging service priority is selected.
For aggregate counters, priority is based on the application preference Aggregate Counter Priority .
4.If all above factors are same for multiple buckets or counters, then the following logic is followed: Application preference Value Selection CREATION TIME The PC linked to the earliest subscription creation time is selected.CS Selection Order END TIME The PC linked to earliest subscription expiry time is selected.
5.If there is still a conflict, the first PC in the conflict list is picked.
Note : An SNR is not sent if there is no change is policy state.
For example, if signalling state for a PC is High and on expiry of the current bucket there is another bucket for use with PC status High , then no SNR or notification is sent.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2216Charging User Guide Rating and charging Sending SNR via provisioning commands If values of Policy Buckets or Counters are updated via provisioning command and the new value changes the Policy state of a resource, then SNR is sent to PCRF as defined in the Send-SNR configuration of threshold.
In order to execute threshold over the provisioning interface, the configuration described in the following figure is used.
Figure 137: Rule configuration for SNR via provisioning command This also applies when a new subscription is attached to the Device and it has some Policy Bucket(s) and/or Counter(s) defined.
TCP/IP notification parameters This section defines the configuration for sending a TCP/IP notification when a SNA is received.
The SNA_MANAGEMENT trigger gets evaluated when an SNA is received, and SySession is successfully updated in the database, thereby indicating a change in policy counter status.
If SNA is not received, then notification is not triggered for that call.
However, in the next call, a notification is triggered if SNA is received.
The SNA_MANAGEMENT source context in the SNA_MANAGEMENT trigger is used to send notification parameters.
These parameters can be used in TCP/IP notifications sent using NS.
Note : •It is recommended to use this trigger if there is a need to avoid notification of Policy state change (as there is no Policy state change).
In such case, it is not recommended to configure notification for Policy state change in individual Bucket/Counter threshold; rather it should be configured in the SNA_MANAGEMENT trigger.
•In NS, custom behavior in Notification Template must be set as DVS .
Application preference For the notification to be sent, the application preference Virtual Policy Counter Support must be set to BUCKET_COUNTER .
Rule configuration The following figure presents a sample rule for configuring SNA notifications.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2217Charging User Guide Rating and charging Figure 138: Example: Rule configuration for SNA notification Two rule variables Current-SySession-Index and Total-SySession-Count are available under SNA_MANAGEMNT source context.
These are used in rule condition to configure the number of notifications sent in case of multiple Sy sessions.
For sample usage of Current-SySession-Index , see Example: Rule configuration for SNA notification on page 2218 .
TCP/IP notification variables and headers The parameters described in the following table are available in SNA_MANAGEMNT for notification.
Name Description Type Example APNRTRCOS Indicates the name of the charging service.
Create a custom data dictionary with ID as Segment and content type as DEVICE.
Attach custom data in device with key as Segment.
Priority of custom data is higher.String COS = SNA_ MANAGEMENT.
Class- Of-Service MDN Indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.String MDN = SPR_ DEVICE.
E164 ACT Indicates the Account ID of subscription ( for Bucket) /Account ID associated with first subscription ( for Counter) .
Create a custom data dictionary with ID as Billing Account ID andString APNRTRACT = SNA_ MANAGEMENT.
Billing- Account- IdTable 243: TCP/IP notification variables for Send-SNA Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2218Charging User Guide Rating and charging Name Description Type Example content type as DEVICE.
Attach custom data in device with key as Billing Account ID.
Priority of custom data is higher.
TIM Indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.Long TIM = SNA_ MANAGEMENT.
Unix- Timestamp T Indicates the time when the notification is generated for a Bucket/ Counter.
It refers to the last three digits or milliseconds of the Unix timestamp.Long T = SNA_ MANAGEMENT.
Unix- Timestamp- Ms CID Indicates the discount ID.
It is the identifier of the Bucket/ Counter for which notification is sent.String CID = SNA_ MANAGEMENT.
Discount- Id PPCS Indicates pre- event Policy Bucket/ Counter status.String PPCS = SNA_ MANAGEMENT.
Pre- Policy- Counter- Status NPCS Indicates post- event Policy Bucket/ Counter status.String NPCS = SNA_ MANAGEMENT.
Post- Policy- Counter- Status PCID Indicates policy counter ID.
For non- virtual policy counters, it is same as discount ID.String PCID = SNA_ MANAGEMENT.
Policy- Counter- IdTable 243: TCP/IP notification variables for Send-SNA (continued) 1.All variables are optional.
Name Description Example MASID This variable indicates the identifier of the physical system, such as system ID.
This is the NCC site ID that generates the notification.MASID = SNA_ MANAGEMENT.
Site- IDTable 244: Header fields for sending TCP/IP notification Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2219Charging User Guide Rating and charging Name Description Example SPAID This variable indicates the identifier of the application fixed against the NCC node.SPAID = SNA_ MANAGEMENT.
Application- ID HOSTID This variable indicates the identifier of the host.HOSTID = SNA_ MANAGEMENT.
Host- ID CLIENTID This variable indicates the client identifier within the host.
Note : As there is no separate client ID in NCC, the Client ID has the same value as the SPAID.CLIENTID = SNA_ MANAGEMENT.
Application- IDTable 244: Header fields for sending TCP/IP notification (continued) 1.All fields are required.
2.All fields are of string type.
Enabling Policy-Counter-Status-Change notification When the policy counter status changes during an active Sy session, a notification is sent using the SNA_MANAGEMENT trigger.
However, if the Sy session is not present or SNA is not received, then the notification is not sent.
This feature provides the functionality to send a notification upon the policy counter status change, regardless of the Sy session.
Note : The Policy-Counter-Status-Change notification is independent of Sy session.
This feature is applicable only to the following types of counters: •Policy-counters (device, subscription, group, multi-bundle, and so on) •Virtual Policy Counters based on counters •Virtual Policy Counters based on buckets •Lifecycle Policy Counters Note : •This feature is not applicable to location-based policy counters and TOD policy counters.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2220Charging User Guide Rating and charging •No notification exchange or trigger execution for SLR/SLA.
Configuration For details on the attributes to configure the Policy-Counter-Status-Change notification, see POLICY_COUNTER_STATUS_CHANGE source context on page 1087 Application preference Configure the following ME application preference to enable the Policy-Counter-Status-Change notification: •Set Enable SNR throttling and Keep-Alive to true .
Rule configuration The following figures present sample rules for configuring Policy-Counter-Status-Change notifications based on the Trigger-Source attribute.
Note : Trigger-Source attribute specifies the event (call, lifecycle, and provisioning) which triggers the Policy-Counter-Status-Change notification.
•If Trigger-Source is CALL : •If Trigger-Source is PROVISIONING : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2221Charging User Guide Rating and charging •If Trigger-Source is LIFECYCLE : Policy-Counter-Status-Change notification variables The parameters described in the following table are available in POLICY_COUNTER_STATUS_CHANGE trigger for notification.
Name Description Type Example COS Indicates the name of the charging service.
Create a custom data dictionary with ID asString COS = POLICY_ COUNTER_ STATUS_Table 245: Policy-Counter-Status-Change notification variables Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2222Charging User Guide Rating and charging Name Description Type Example Segment and content type as DEVICE.
Attach custom data in device with key as Segment .
Priority of custom data is higher.CHANGE.
Class- Of- Service TIM Indicates the Unix timestamp when the notification is generated.
This is the current time period in seconds.Long TIM = POLICY_ COUNTER_ STATUS_ CHANGE.
Unix- Timestamp T Indicates the time when the notification is generated for a Bucket/ Counter.
It refers to the last three digits or milliseconds of the Unix timestamp.Long T = POLICY_ COUNTER_ STATUS_ CHANGE.
Unix- Timestamp- Ms DISC Indicates the bucket or counter definition Id.String DISC = POLICY_ COUNTER_ STATUS_ CHANGE.
Discount- Id BUN Indicates the bundle name ( without MVNO) corresponding to the subscription that is present in the bucket, or counter.String BUN = POLICY_ COUNTER_ STATUS_ CHANGE.
Bundle- Name CHS Indicates the charging service name ( without MVNO) that is present in the bucket, or counter.String CHS= POLICY_ COUNTER_ STATUS_ CHANGE.
Charging- ServiceTable 245: Policy-Counter-Status-Change notification variables (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2223Charging User Guide Rating and charging Name Description Type Example USU Indicates the Used Service Units corresponding to a single MSCC.
Note : This attribute is present only for CALL scenario ( that is, when the value of Trigger- Source is CALL .Big decimal USU = POLICY_ COUNTER_ STATUS_ CHANGE.
Usage- From- Last- CCR BACT Indicates the Billing Account Id as defined in the Custom Data Dictionary of Device.
If Billing Account ID custom data is not present in the device, then this attribute contains the account Id.String BACT = POLICY_ COUNTER_ STATUS_ CHANGE.
Billing- Account- Id ACT Indicates the Account ID of subscription ( for Bucket) /Account ID associated with first subscription ( for Counter) .
Create a custom data dictionary with ID as Billing Account ID and content type as DEVICE.
Attach custom data in device with key as Billing Account ID.String ACT = POLICY_ COUNTER_ STATUS_ CHANGE.
Billing- Account- IdTable 245: Policy-Counter-Status-Change notification variables (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2224Charging User Guide Rating and charging Name Description Type Example Priority of custom data is higher.
NPCS Indicates post- event Policy Bucket/ Counter status.String NPCS = POLICY_ COUNTER_ STATUS_ CHANGE.
Post- Policy- Counter- Status PCID Indicates policy counter ID.
For non- virtual policy counters, it is same as discount ID.String PCID = POLICY_ COUNTER_ STATUS_ CHANGE.
Policy- Counter- Id PPCS Indicates pre- event Policy Bucket/ Counter status.String PPCS = POLICY_ COUNTER_ STATUS_ CHANGE.
Pre- Policy- Counter- Status MDN Indicates the MSISDN value or device that triggers the notification.
The variable is the E. 164 number configured in the device.String MDN = SPR_ DEVICE.
E164 DVI Indicates Id of a device.
String DVI = SPR_ DEVICE.
Device- Id TS It specifies the event which triggers this notification.
It has the following possible values: •CALL •LIFECYCLEString TS = POLICY_ COUNTER_ STATUS_ CHANGE.
Trigger- SourceTable 245: Policy-Counter-Status-Change notification variables (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2225Charging User Guide Rating and charging Name Description Type Example •PROVISIONINGTable 245: Policy-Counter-Status-Change notification variables (continued) Note : All fields are optional.
Lifecycle changes for different entities When VPC is enabled, there are some changes in the Send-SNR event via lifecycle based on entity type.
Device When lifecycle is configured for a Device, in addition to policy counters, it also looks for Policy Buckets for the Device.
Subscription When lifecycle is configured for a Subscriptions, in addition to Subscription policy counter, it also looks for PCs/VPCs/Policy Buckets attached to the Device and its other Subscription if the Subscription is of Device type.
If Subscription is of group type, it also looks policy counters and policy Buckets for other subscriptions of the Groups.
Account When lifecycle is configured for an Account, in addition to policy counters related to Accounts, it also matches Policy Buckets/VPCs attached to all subscriptions of Devices and all subscriptions of Groups linked to Accounts.
8.55.3 Dynamic policy counter This feature enables the use of Diameter Sy interface to transfer Quality of Service (QoS) information by using the dynamic value of policy counter identifier (such as, PC_<RG>_<APN>_<Framed-IP-Address> ).
The dynamic value of policy counter identifier can be determined by the dynamic values of specific parameters received in the Gy CCR request.
For example: •<RG> - Rating Group •<APN> - Access Point Name retrieved from the Called-Station-Id AVP •<Framed-IP-Address> - which is retrieved from the Framed-IP-Address AVP and it can either be an IPv4 or IPv6 address The policy counter status can be HIGH or LOW depending on the bucket or counter from which reservation is done.
Note : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2226Charging User Guide Rating and charging A dynamic policy counter should only be configured as a virtual counter on the resource-based counter of a device.
Resource-based counter enhancement For a resource-based counter, the SNR is sent based on the resource used for maximum reservation.
Threshold is applied with configuration Absolute From Start and value 0 to process the Counter Signalling State in every reservation.
Following are the context variables added to resource-based counters to determine the states based on the given configurations: Name of context variable Description Reserve- Entity- Name Name of the entity ( which can be Bucket Def Id , Counter Def Id , or Account Id) from which the maximum reservation has taken place.
Reserve- Entity- Type Type of entity ( ENTITY_ BUCKET , ENTITY_ ACCOUNT , or NOCHARGE ) from which the maximum reservation has taken place.
Recommended configuration for this feature Configure the following ME application preferences to enable this feature: •Set Virtual Policy Counter Support to BUCKET_COUNTER .
•Set Default Signalling State Value to HIGH .
•Set Dynamic Policy Counter Identifier to ENABLED .
If the Dynamic Policy Counter Identifier is set as ENABLED , then an Sy session is created without any policy counter information as the Dynamic Policy Counter Name is not available at the time of Sy session creation.
–NCC does not send policy counter information in SLA and instead sends the following error code 4241, which states Sy Experimental-Result-Code = DIAMETER_ERROR_NO_AVAILABLE_POLICY_COUNTERS .
–In case of SLR intermediate call, NCC sends an error code 4241, which states Sy Experimental- Result-Code = DIAMETER_ERROR_NO_AVAILABLE_POLICY_COUNTERS .
Note : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2227Charging User Guide Rating and charging If this feature is used for both charging and policy components, then also set the Sy Accept SNR for Failed Session policy application preference as true apart from the preceding policy application preferences.
Once, the Gy session is established and first quota is granted, NCC sends an SNR only for low QoS scenarios.
In case of high QoS scenario, NCC does not send an SNR as default QoS applied at the beginning of the session is also high QoS.
The default signalling state is derived from the Default Signalling State Value in the system property and it is set to HIGH for dynamic policy counter.
•For first call, when policy counter state is HIGH but not already present in the database, NCC saves the dynamic policy counter with default signalling state set as HIGH and does not send out any SNR.
•For first call, when policy counter state is LOW but not already present in the database, NCC saves the dynamic policy counter with signalling state as LOW and also sends out an SNR.
•For subsequent calls, when policy counter state is different from the previous SNR state sent out, then NCC sends out a new SNR and saves the policy counter state in database.
•For subsequent calls, when policy counter state is same as the previous SNR state, no changes are performed and no SNR is sent out.
•In case of subscription renewal through lifecycle, the buckets and counter gets reset.
SNR is not sent at the time of subscription renewal as there is no corresponding Gy request that defines the parameters of the dynamic policy counter name.
Follow this recommended configuration to understand the working of this feature: 1.Create three bundles; UBD1 , UBD2 , and UBD3 .
2.Each bundle has two charging services, one for bucket consumption and the other one for non-policy counter consumption, such as: 3. a.For bundle UBD1 : •CSBucket1 with tariff as Rating.Bucket-Selection = "Bucket1" .
•CSCounter1 with tariff as RATING.Counter-Selection = “CSCounter1" and RATING.No-Charge b.For bundle UBD2 : •CSBucket2 with tariff as Rating.Bucket-Selection = "Bucket2" .
•CSCounter2 with tariff as RATING.Counter-Selection = “CSCounter2" and RATING.No-Charge c.For bundle UBD3 : Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2228Charging User Guide Rating and charging •CSBucket3 with tariff as Rating.Bucket-Selection = "Bucket3" , and no charging service for counter consumption.
4.Configure the following thresholds to send notification at a required time frame or data consumption: 5.Configure the threshold to send QoS notification through Sy interface by sending the dynamic policy counter ID and status at the time of reservation.
The following figure states an example of configuring threshold on a resource-based device counter: Here, the Reserve-Entity-Type describes the type of entity from which maximum reservation has taken place, and this can have one of the 3 values; ENTITY_BUCKET , ENTITY_ACCOUNT , or NOCHARGE .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2229Charging User Guide Rating and charging As shown in the figure below, the following rule variables are created under THRESHOLD trigger from respective parameters of Gy CCR request: Create the DPC_Identifier by concatenating the DPC_APN , DPC_FramedIP , and DPC_RG : 6.Configure the complex map as LOW for policy counter status: QoS variable : The LOW PC status can be send using the QoS variable: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2230Charging User Guide Rating and charging 7.
(Optional) Configure the following quota management profile (slicing profile) configuration: Examples Consider the following example for a better understanding of this feature: Example 1: Subscriber, which is already at a LOW state at the beginning of the data session switches to high QoS during a data session Call processing : 1.After recieving SLR, NCC does not send any policy counter information in SLA and instead, it sends the error code 4241, which states Sy Experimental-Result-Code = DIAMETER_ERROR_NO_AVAILABLE_POLICY_COUNTERS .
2.The LOW PC status is send out in the SNR at the initiation of session.
3.Suppose a bundle renewal takes place and the bucket entity is again reinstated and data consumption can again be initiated from bucket as bucket has sufficient balance.
Result: Verify that NCC sends out an SNR stating with status as HIGH after the bucket balance is refilled and the data session continues with reserving data from bucket balance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2231Charging User Guide Rating and charging 8.55.4 Mapping internal names with external names of policy counters For subscriber's policy counters and their status, OCS and PCRF communicate through the Sy interface.
The PCRF can have its own policy counter identifiers, and these may be required in the policy counter status reports.
NCC supports maintaining both internal (OCS) policy counter ID and external (PCRF) policy counter ID and define a mapping between the two.
To achieve this, a mapping table is created with the mapping of internal and external counters.
In the map, the key must have internal counter name and the value must have the external counter name.
The name of the mapping table is then configured in a rule variable in the GY_CREDIT_REQUEST trigger.
Configuration 1.Create a mapping table (in Charging → ☰ → Mapping tables ) containing one map key and one map value.
Provide the internal counter names in map key and external counter names in map value.
Define map structure with one map key and one map value as shown in the following figure: Configure map values as shown in the following figure: 2.Create a rule variable in the GY_CREDIT_REQUEST trigger, and configure the name of the mapping table in the default value field.
The default value for this field is set as PolicyCounterMap .
Change this to provide the name of the appropriate mapping table.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2232Charging User Guide Rating and charging Additional information •This feature is applicable only for PUSH mode, in which all available policy counters are sent in SLA.
•The CDRs generated for Sy interface contain the internal counter names.
•If a corresponding external counter name is not found for an internal counter, then the internal counter name is sent to PCRF.
•If multiple internal counter names are mapped to a single external policy counter name, then any one of the internal counters is sent to PCRF in SLA or SNR.
Example Consider the following mapping table: OCS counter ID PCRF counter ID C1 PC_1 C2 PC_2 C3 PC_1 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2233Charging User Guide Rating and charging OCS counter ID PCRF counter ID C4 - Following reports are prepared: •Policy-Counter-Status-Report {Policy-Counter-Identifier = "PC_1",Policy-Counter-Status = "Value1"} •Policy-Counter-Status-Report {Policy-Counter-Identifier = "PC_2",Policy-Counter-Status = "Value2"} •Policy-Counter-Status-Report {Policy-Counter-Identifier = "C4",Policy-Counter-Status = "Value4"} Note : 1.C1 and C3 have same external counter name, hence one is chosen randomly.
2.C4 is sent to PCRF as no explicit mapping found.
This only impacts Spending-Limit-Answer (SLA) and Spending-Status-Notification-Request (SNR).
OCS sends SLA/SNR with all policy counters by mapping their internal names to the external names and their status attached to the given Subscription-Id.
The flows of Spending-Limit-Request (SLR), Spending-Status-Notification-Answer (SNA), Session- Termination-Request (STR), and Session-Termination-Answer (STA) have no impact.
8.55.5 Session virtual counter Session virtual counter enables the operator to configure caps for subscribers for the entire charging session, whether the session is data, IMS, or SMS/MMS.
For example, for a subscriber it can be configured in such a way that he cannot spend more than 40 Euros from his account per session.
Configuration Session virtual counter can be configured in charging rules using the action attribute SESSION_PARAMETER.Session-Virtual-Counters .
For more information about the applicable triggers, refere to section SESSION_PARAMETERS result context on page 1292 .
See the following example for configuring two session virtual counters for a session: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2234Charging User Guide Rating and charging In the applicability condition for the counter, configure it to apply only to a specific group of premium numbers by using the Called-Party-Address AVP.
Following figure shows another example of provisioning session virtual counters for Gy session in GY_SESSION_ESTABLISHMENT rule set: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2235Charging User Guide Rating and charging By assigning a different counter and using conditions in rule or counter applicability condition, different caps can be applied for to the following: •Call Type •For IMS calls or SMS/MMS, it can be applied on the basis of premium numbers (called-party numbers).
•For PS calls, it can be applied on the basis of APN by checking Called-Station-ID AVP in rule.
When there are two usage types, session virtual counter can be configured to count only primary rate usage or next rate usage.
In this way, different CAP can be applied to different usage types.
This behavior is same as in normal counter.
To enable this, in counter applicability condition, the result context RATING.Select-Counter-Usage can be used as RATING.Select-Counter-Usage = CounterUsageType_PRIMARY .
Additional information •If session virtual counters are configured for a session, the behavior is same as normal counters.
•Limitations for Cap/limit of counter are also applicable for session virtual counters.
•Taxation is included in the call cost.
•Quota is adjusted to reach the call limit, as close as possible, following rate granularity.
•Notification is sent if the call gets disconnected due to reaching the limit.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2236Charging User Guide Rating and charging •In CDR, recordEventResult 28 (Call is rejected due to call cost cap reached.)
is generated for this scenario.
•For IMS session, when call is rejected due to session virtual counter, MSCC level result code in CCA message is 4012 (DIAMETER_CREDIT_LIMIT_REACHED).
•Root level result code is 4012 (by default).
It can be configured as 2001 (DIAMETER_SUCCESS) using RATING_POST_PROCESSING rule.
•In this scenario, IMS session is kept alive and a CCR-T closes the session.
8.55.6 Entity counter instance The entity counter instance is an instance of the counter.
Note : Any changes in the order of the hierarchy does not create or delete an instance of the counter for a group or device counter.
The entity of the counter instance is not deleted although the group or device is deleted.
Attention : NCC supports the counter functionality with counter of usage and cost type, that is, counter can accumulate the usage consumption or the cost deductions made.
However, the use cases of counters to accumulate the number of calls, that is, counter type as CALL is not supported currently and subjected for future enhancement of NCC product with required customer use cases.
Reset counter instances To reset the counter instances using the account lifecycle, an account reference is included within each instance of the counter.
Before adding a counter to a device or group, the device or group must have a subscription.
If not, then such counters are added without the account reference which cannot be fetched and reset using the account lifecycle.
For the given API requests, the list of subscriptions associated with the device or group entities are fetched.
From this list, the first subscription is considered and the account object associated with it is fetched.
This account object is passed as a parameter during the creation of the counter instance entity.
•addCounterToDevice Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2237Charging User Guide Rating and charging •addDeviceCounterToGroup •addGroupCounterToGroup Entity counter instance configuration Note : The parameters for entity counter instance cannot be configured using the SM GUI.
Parameter Description Options Mandatory/ Optional Counter Instance List capList The CAP lists to be added or removed for Counter instance.
The default value is Null.List< Threshold Profile Data> Optional capTemp Chg This parameter indicates whether cap list in counter is changed temporarily or permanently.
If it is true ( change temporarily) , Cap list will be recovered in next Billing Cycle.
The default value is false.Boolean Optional usgLmtTemp Chg This parameter indicates if the usage limit is changed temporarily or permanently.
If it is true, the usage limit will be recovered to original value in next Billing Cycle.
The default value is false.Boolean Optional thrhd Temp Chg This parameter indicates if threshold group are changed temporarily or permanently.
If it is true, the threshold groups will be rolled back in next Billing cycle.
The default value is false.Boolean Optional charging Service Id This attribute gets its charging service name when it is being created.String Optional Counter DefId The ID of a counter definition.
String Optional Counter InsId The ID of a counter instance.
String MandatoryTable 246: Parameters for entity counter instance Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2238Charging User Guide Rating and charging Parameter Description Options Mandatory/ Optional Current Value The value of the counter.
This value cannot be negative.
The default value is 0.Big Decimal Optional Default State The default state of the counter instance.
If it is in use, then the default state is set to 0.
The default value is -99 and it identifies the initial state of the counter.String Optional EndTime The end time of the counter instance.Long Optional exhaustion Time This attribute represents the time at which the counter is hard- stopped.Long Optional Last Reporting State The signaling state sent in last SLA.String Mandatory Last Reporting Time This attribute represents the time when last SLA sent for Sy interface.Long Mandatory Last SNRReporting State This field is updated with the current state of threshold when an SNR was sent.
The default value is -99 and it identifies the initial state of the counter.String Optional Last SNRReporting Time This field is updated with the time when an SNR was sent.Long Optional overage Limit This attribute defines the overage usage limit per counter within a bundle.
When a counter is selected in a different charging service, this parameter value can be changed.
Once, usage limit of the counter is reached, the overage limit is considered and subsequently triggers all threshold actions for the overage block.
The overage is applied repetitively to the counter.Big decimal OptionalTable 246: Parameters for entity counter instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2239Charging User Guide Rating and charging Parameter Description Options Mandatory/ Optional Note : The overage limit can be defined only when the usage limit is defined.
validity Time This attribute indicates the number of billing cycles ( including the current) for which the changes to the attributes such as ULI, OLI, TPG, OTPG remain valid.
Default value: 0.Digit Optional overage Threshold Profile Group Id ListThis attribute indicates the threshold profile group IDs on overage limit, which is the symbolic end limit of these threshold and is applicable after usage limit.
A subscriber can have only one policy threshold and multiple normal thresholds in overage threshold for policy counter.
Note : As overage limit is repetitive in nature, thresholds on overage limit are also repeatedly executed.List< String> Optional policy Counter Name This value is set if user has configured a Send- SNR action on a threshold associated with this counter.
Then this attribute represents the Virtual Policy Counter mentioned in Send- SNR action.
Example: SY.Send- SNR = “ VPC, HIGH” VPC is the Virtual Policy Counter name.String Optional Previous Value The value of the previous counter.
This value cannot be negative.Big Decimal Optional subs Id This attribute gets its subscription ID when it is being created.String Optional SyPolicy Counter The value is copied from the Counter Definition.Boolean OptionalTable 246: Parameters for entity counter instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2240Charging User Guide Rating and charging Parameter Description Options Mandatory/ Optional The supported values are as follows: •True: If the flag is true, the counter is an instance of the policy counter.
•False: If the flag is false, the counter is an instance of non policy counter.
threshold Profile Group IdList This attribute indicates the IDs of threshold profile group.
Following are the important points to note: •Only one policy threshold can be associated with a policy counter.
•Multiple normal thresholds can be associated with a policy counter.
Note : Percentage type thresholds are allowed only when usage limit is defined.List< string> Optional usage Limit This attribute defines the usage limit applied per counter within a bundle, that is charging service.
If this attribute is defined, then percentage type thresholds are allowed in the threshold Profile Group IdList with a symbolic end limit as usage limit.
When the counter is selected in a different charging service, this attribute is changed.Big decimal Optional Entity Counter Instance Id Attach Mode Value String Optional Coordinates The location of the entity.
Long Optional Entity Counter Instance Attach Mode This field allows you to select the Entity Counter Instance attach mode.entity Counter Instance Attach Mode OptionalTable 246: Parameters for entity counter instance (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2241Charging User Guide Rating and charging Parameter Description Options Mandatory/ Optional The supported values are as follows: •Device •Group •Device_ Group •SubscriptionTable 246: Parameters for entity counter instance (continued) See Additional information for usageLimit, thresholdProfileGroupList, capList parameters for more details.
Threshold Profile group instance list Note : The parameters for threshold profile group instance list cannot be configured using the SM GUI.
Some of the parameters listed in the table are linked to the calculations performed by internal logic.
Parameter Description Options Mandatory/ Optional Threshold Profile Group InstList Dynamic Milestone Milestone is a percentage type threshold when the Dynamic Milestone Flag is true with the empty rule container.
The supported values are as follows: •True: If the flag is true, then the threshold profile group is used as a milestone.
•False: If the flag is false, then the threshold profileBoolean MandatoryTable 247: Parameters for Threshold Profile group instance list Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2242Charging User Guide Rating and charging Parameter Description Options Mandatory/ Optional group is not used as a milestone.
ThPrfGrpDfName This field is the key parameter of the threshold profile group entity.String Optional Thrs PrfInsList Interval This field is for internal use only.
It is required for rule engine.Integer Mandatory Thresh InstList Thrs PrfDefName This field is the key parameter of the threshold profile entity.String OptionalTable 247: Parameters for Threshold Profile group instance list (continued) Overage Threshold Profile group instance list Note : The parameters for overage threshold profile group instance list cannot be configured using the SM GUI.
Some of the parameters listed in the table are linked to the calculations performed by internal logic.
Parameter Description Options Mandatory/ Optional Overage Threshold Profile Group InstList Dynamic Milestone Milestone is a percentage type threshold when the Dynamic Milestone Flag is true with the empty rule container.
The supported values are as follows:Boolean MandatoryTable 248: Parameters for Overage Threshold Profile group instance list Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2243Charging User Guide Rating and charging Parameter Description Options Mandatory/ Optional •True: If the flag is true, then the threshold profile group is used as a milestone.
•False: If the flag is false, then the threshold profile group is not used as a milestone.
ThPrfGrpDfName This field is the key parameter of the threshold profile group entity.String Optional Thrs PrfInsList Interval This field is for internal use only.
It is required for rule engine.Integer Mandatory Thresh InstList Thrs PrfDefName This field is the key parameter of the threshold profile entity.String OptionalTable 248: Parameters for Overage Threshold Profile group instance list (continued) Actions associated with a counter instance Action Description Create Used to create a counter instance.
Create Entity Counter Instance Used to create entity counter instance.
Delete Used to delete a counter instance.
Find Entity Counter Instance ByAccount Id Used to get the list of all entity counter instances for the given account ID.
Find SyPolicy Counter Signaling Info Used to get list of signaling state information for the given Entity Counter Instance Id.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2244Charging User Guide Rating and charging Action Description Read Used to display a particular counter instance entity as per the data retrieved from database.
The mandatory parameter is Counter Instance ID .
Remove Entity Counter Instance Used to remove the Entity Counter Instance from the database for the given Entity Counter Instance Id and Counter Id .
Reset Used to reset all the Entity Counter Instances and their threshold instances and caps associated with a given Account Id.
update Entity Counter Instance Used to update the current value, usage limit, and overage limit.
It also allows to add or remove a threshold list and overage Limit threshold list.
Update Entity Counter Instance Current Value Used to update current value for a given Entity Counter Instance Id and Counter Instance Class Id .
This method is only for internal purpose.
Update Entity Counter Instance Default State Used to update Entity Counter Instance Object after successfully updating the default State attribute of Counter Instance Class.
Update Used to update a particular counter instance entity in database.
The mandatory parameter is Counter Instance ID and Current Value is the only value updated.
Note : These actions are valid for internal purposes only and cannot be accessed using the SM GUI.
Additional information for usageLimit, thresholdProfileGroupList, capList parameters If a subscriber has a spending limit counter, NCC allows to set their own limit (threshold value).
Notifications can be defined at 80% and 100%.
The API update/EntityCounterInstance allows to change the usage limit in Counter Instance.
usageLimit is the parameter that allows subscriber to update the limit after subscribing to subscription (that is, counter).
If the entity counter usageLimit, thresholdProfileGroupList or capList is updated temporarily, in next billing cycle, those attributes are refreshed with the definition in counter.
RAR gets triggered based on the value of updateSession parameter in the update/EntityCounterInstance REST API.
After the attributes in Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2245Charging User Guide Rating and charging entityCounterInstance are updated successfully, Send-Notification action can be executed if configured in the Counter ruleset.
RAR is not considered for updating the group entityCounter instance.
Following is the rule example for update event: The COUNTERINFO source context type for COUNTER rule set has the following attributes: Attribute name Type Description Counter- Def- Name String The counter definition ID.
Counter- Current- Value BigDecimal The counter current value.
Counter- Usage- Limit BigDecimal The counter usage limit.
Counter- Overage- Limit BigDecimal The counter overage limit.
Counter- TPG- List String The counter threshold profile group list, separated with " ;".
Counter- CAP- List String The counter CAP list separated with " ;".
Counter- Overage TPG- List String The counter overage threshold profile group list separated with " ;".Table 249: COUNTERINFO source context Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2246Charging User Guide Rating and charging Attribute name Type Description Counter- Update- Event String The event name that is updating includes the following attributes: •Counter Value Updated •ULI Updated •OLI Updated •Threshold Profile Group Updated •CAP Updated •Overage Threshold Profile Group Updated •Threshold Profile Stoppage Type Toggled •CAP Stoppage Type Toggled •Counter UpdatedTable 249: COUNTERINFO source context (continued) Note : Stoppage type in Counter-Update-Event indicates the notification action type.
Notification-Reject is a hard stoppage type, others are soft stoppage type.
Whenever a counter threshold profile group stoppage type is updated, the toggled event name is set.
If an update request includes the counter value change and stoppage type change, the event name is set with the toggled event name, which has higher priority.
The Counter Updated is the default event name.
If the pre-defined event name cannot cover a specific counter update, this general event name Counter Updated is used.
The Counter-Update-Event attribute is set only in provisioning call for entity counter instance updating.
In provisioning call, the rule logic must be included under "if COUNTERINFO.Counter-Update-Event present", like the preceding example counter rule logic, the diameter call logic is not impacted.
8.55.7 Aggregation of usage in counters across subscription or bundle consumption using multi-bundle counters NCC allows same data consumption to be applied to multiple counters and up to a single bucket across multiple subscriptions of a device.
Counter with a scope as MULTI-BUNDLE can be used to compute the usage across subscriptions of a device.
Note : •The multi-bundle counters are the counters which can accumulate the usage or cost consumed from multiple bundles subscribed by the device.
However, if the bundle subscriptions are at Group level or hierarchy level, then the multi-bundle type of counter does not accumulate any usage or cost done from multiple bundles subscribed by the group.
•The multi-bundle counter use cases supported under customer requirements are for usage addition with a No-Charge action in rules and not specified in the Tariff rules action as selection.
The multi-bundle functionality with integration with other tariff rule actions such Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2247Charging User Guide Rating and charging as ThresholdRate/Next rate/Bucket/account are to be developed as per the customer- specific use case.
•The slice reduction feature, that is, hard stop/soft stop limits or spending limits execution on multi-bundle counters work only on one multi-bundle counter.
If more than one multi-bundle counters are subscribed to a Device subscription, then limits applied to only one multi-bundle is evaluated.
The limits applied on other multi-bundle counters are not evaluated.
•The aggregate usage cannot be applied to more than one bucket at the same time.
•It is recommended to apply different threshold on a counter or bucket as per base bundle plan using the SELECT COUNTER or SELECT BUCKET option for a particular charging service; instead of using the ADD BUCKET or ADD COUNTER option.
•Multi-bundle counters are not supported for groups.
To add accumulation from multiple bundles for group, use group counters.
This feature provides the following functionalities: •Adding new bundles (in support of new plans) to accumulate the usage in parallel with keeping the existing bundle configurations intact (which means without modifying or redefining the pre-existing bundle configurations).
This provides the flexibility to add new bundles or plans to interact with existing bundles that can be used in several other devices at the time of defining a new bundle.
•Allowing the same bucket ID or counter ID to be included in multiple bundles.
In case of unlimited data usage, the same counter ID or bucket ID can be used for different data base plans.
•Applying different threshold on the same Counter Definition ID as per the bundle plan purchased, which refers to the threshold as per bundle plan.
•Defining a bundle with number of renewals set to zero, so that the bundle expires and cannot be renewed when it reaches the End Date of the bundle, which can either be the BCR date of the subscriber account, or the end/renewal date of the periodic lifecycle in case the subscription has its own periodic lifecycle.
•When multiple data boost subscriptions are purchased (with same charging service priority) having counter of MULTI-BUNDLE type, then the subscription purchased later has a higher priority for MULTI- BUNDLE counter.
•Generating an EDR when a subscription expires and the number of remaining renewals is set as zero.
Note : A lifecycle can be configured so that only a single expiration EDR is triggered, and it is possible to subsequently remove the subscriptions from the device and account.
For example, by transitioning the subscription to a new state where it is subsequently deleted.
8.55.7.
1 Configuration Follow the given steps to configure this feature: 1.Create an RSV with CALL_RULE_VARIABLES trigger having two rule variables, for example, CrossUpdate and Index .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2248Charging User Guide Rating and charging Add these two variables to the COUNTER , TARIFF , and APPLICABILITY triggers as shown in the following figure: 2.Create a Threshold Profile Group (TPG) and cap for counters as specified in the following snapshots: •50 GB for domestic base plan counter ABY: •15 GB for tethered base plan counter TBY for throttling: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2249Charging User Guide Rating and charging •10 GB hard-stop for domestic data-boost counter ABB: 3.Create two multi-bundle counters ABY and ABB, and one subscription counter TBY as specified in the following snapshots: ABY counter: TBY counter: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2250Charging User Guide Rating and charging ABB counter: 4.Create three charging services; one for domestic base plan, second for tethered base plan, and the third for domestic data-boost as specified in the following snapshots: Charging service for ABY: Charging service for TBY: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2251Charging User Guide Rating and charging Charging service for ABB: NOTE: Set the priority of data-boost charging service higher than the base plan charging services.
5.Create two bundles DoMoreUnlimited and Domestic-data-boost as shown in the following figure: Do More Unlimited bundle Data-boost domestic bundle Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2252Charging User Guide Rating and charging 8.55.7.2 Additional information Following are some important points to note for this feature: •The aggregated view of Counter type does not have the option of accumulating multi-bundle counters.
•This feature is limited only for device subscriptions, which means applying multi-bundle counters for device subscriptions.
8.55.7.3 Examples Consider the following examples for a better understanding of this functionality: Example 1: Correct counters are incremented for tethered usage when two data-boosters are subscribed during a call for tethered usage and “Do More Unlimited” bundle usage is throttled Provisioning: 1.There is a Do More Unlimited bundle, which has two charging services; one for the tethered data and the other one for non-tethered data with NO CHARGE configuration applied to both the charging services.
Figure: Tariff formula of charging service for non-tethering data Figure: Tariff formula of charging service for tethering data Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2253Charging User Guide Rating and charging 2.There are the following two counters for the Do More Unlimited bundle: •Multi-bundle type counter named as ABY, which accumulates both domestic and tethered consumption.
•Subscription type counter named as TBY, which accumulates only tethered consumption and has an Applicability Condition of RG = 3303 (tethered consumption).
3.The TBY counter has a threshold to throttle ( SNR=low ) speed after 15 GB usage.
4.The ABY counter has a threshold to throttle ( SNR=low ) speed after 50 GB usage.
5.A non-renewable data-booster bundle of 5 GB (bucket TBB) is created for tethered consumption (having charging service with Applicability Condition of RG = 3303 ).
Figure: Tethered data-boost bucket Figure: Tethered data-boost charging service Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2254Charging User Guide Rating and charging Figure: Tethered data-boost bundle Result: •When a call is executed from 3303, data consumption is applied from the Do More Unlimited bundle.
Once the consumption is 15 GB, an SNR is triggered and the TBY state becomes low.
•Suppose a user subscribes a data-boost bundle for tethered consumption of 5 GB and after 3 GB of data consumption from the data-boost bundle, the user subscribes to another data-boost bundle.
Figure: Device overview after the data-boost bundle is purchased Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2255Charging User Guide Rating and charging •After consuming two more GBs, next reservation is from the second data-boost bundle until it is exhausted.
•After exhausting both the data-boosters, charging is again done from the Do More Unlimited bundle.
•When the ABY threshold reaches 50 GB, an SNR is triggered for the ABY counter as well.
Example 2: Purchase additional domestic data usage booster plan In this example, a new domestic data-boost bundle is made available to a subscriber's existing base unlimited plan, such as Start Unlimited , Do More Unlimited , or Get More Unlimited without modifying their existing data base plans.
Provisioning: 1.Define a Do More Unlimited bundle with two charging services: •Domestic CS for domestic data with domestic data counter ABB, which is a multi-bundle type counter.
•Tethered CS for tethered data with tethered counter TBY, which is a subscription type counter.
2.Create two rule variables: •CrossUpdate : This variable updates the data consumption across bundle in a specific multi- bundle counter.
When this variable is set as TRUE, then the highest priority multi-bundle counter is to be updated with DIFFERENT counting conditions.
This variable is usable for multi-bundle counter and bucket in tariff.
•Index : This variable allows a multi-bundle counter across update in case of SAME counting conditions.
It is usable only for multi-bundle counter.
3.Applicability condition of ABB counter: Index = Base bundle or CrossUpdate = True Result: •The new domestic data-boost bundle can be added to a device, which already has an unlimited data plan, with or without having purchased a tethered data-boost bundle.
•The tethered data-boost bundle has the following details: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2256Charging User Guide Rating and charging 8.55.8 Actual policy counter status in SLA Before this feature, when a subscriber was created and a subscription was purchased or already associated to a group but the resource was empty at the time of subscriber creation, the policy counter status being sent to PCRF by the OCS server was the default value (as -99) in the initial SLA as response.
However, the expected policy counter state was the actual policy counter state after evaluation of its policy threshold as configured by the service operator.
This feature provides the actual policy counter status as a result in SLA when a newly provisioned prepaid subscriber subscribes to a bundle, a bucket resource is created with zero volume, or a subscription is offered through ChangePlan .
For example, Create a group with 4 bundles and attach a policy counter to the group.
Apply an Aggregate View (AV) to the group, which has SO threshold applied on it.
A group policy counter, which is a resource-based counter has a threshold applied for the first data consumption ( Absolute from Start ) at zero.
The threshold at zero for provisioning as Absolute from Start with policy counter state as validVolume and the threshold at zero for Diameter request as Absolute from End with policy counter state as NoValidVolume .
As per the previous behavior, if a device was attached the group and the group had a subscription but there was no volume in the group, which meant that subscription had buckets with zero initial value, then the policy counter state being returned was -99, which was mapped at PCRF as HIGH .
Therefore, when PGW sent a Gy CCR at OCS, no volume was there on the group subscription, a CLR is returned back to the network, and subscriber was never redirected to the portal for top-up.
With this feature, if a device is being attached the group and the group has a subscription but there is no volume in the group, which means subscription has buckets with zero initial value, then the policy counter state is returned as defined, which is noValidVolume because bucket though exists but has zero initial value mapped at PCRF as REDIRECT .
Therefore, PGW results to Gy CCR(i) request after the redirect and accordingly, the call flow continues.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2257Charging User Guide Rating and charging Additional information Consider the following points for this feature: •This functionality is applicable to: –AV on device, group, or both.
–create Bucket , ChangePlan , and a new subscription created particularly for a new subscriber.
•AV is of Charging Service type and applied to a group.
•There are no adaptation for counter resources.
•Bucket is always created in the subscription.
•During a subscription add or update, if an AV or bucket has both old unused value (before subscription add or update) and new unused value (after subscription add or update) as zero, then thresholds of type Absolute from End is evaluated.
Example With this example, it is verified that the actual policy counter state in SLA and SNR are sent when a threshold is attached to a policy counter and AV.
Provisioning: 1.Set the Default Signaling State in SLA (Initial) as false .
2.Create a charging service CS1 with a bucket Bucket1 and bucket balance as zero.
Associate CS1 to a bundle Bundle1 .
3.Create two thresholds TPG_teeth003091 of Absolute from End type and TPG_ABS003091 of Absolute from Start type: For Absolute from End threshold: For Absolute from Start threshold: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2258Charging User Guide Rating and charging 4.Create an AV of Charging Service type and attach the TPG_teeth003091 and TPG_ABS003091 thresholds to that AV.
5.Create a resource-based policy counter and attach the counter threshold ( Absolute from Start ) to it with following conditions: a.If charging is done from a device, then set the policy counter state as HIGH .
b.If charging is done from a group, then set the policy counter state as LOW .
6.Create an account, device (with charging group first), and a group.
7.Attach AV and counter to the group.
8.Attach subscription to the group.
Call processing: 1.Execute a Gx initial and terminate call.
2.Update the bucket balance using Bucket Update Instance API set to 20.
3.Execute a Gx initial call.
4.Execute a Gy call: CCR(I): RSU = 10 CCR(U): USU=10, RSU = 10 CCR(T): USU = 10 5.Execute a Gx terminate call.
Verification: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2259Charging User Guide Rating and charging 1.When the first Gx initial and terminate calls are triggered (when bucket balance is zero), the policy counter state is returned as LOW in SLA.
2.After the bucket update, when Gx initial call is executed, the policy counter state is returned as HIGH in SLA.
3.When a Gy call is initiated and CCR(I) request is triggered, SNR is sent with policy counter state is returned as LOW in SLA as charging is done from group.
8.56 Shadow balance Shadow balance is used to reserve a prepaid balance quota to be used in the current operator.
Shadow balance can be used only till the subscriber is associated with the operator.
When the subscriber migrates to another operator, the shadow balance is excluded from the current prepaid balance.
The value of shadow balance is null, by default.
Shadow balance is displayed only when it has a value other than null.
Shadow balance is a read-only value in the account overview in SM GUI.
Note : For details on account overview, see Subscriber Manager Guide .
Shadow balance can be administered through provisioning API.
It can be increased or decreased during call processing.
It is also reported in the generated CDR and EDR.
Configuring the shadow balance The services/ServiceManager/subscriber/create/Profile API is used to set the shadow balance during subscriber profile creation.
The shadowBalance parameter specifies the shadow balance quota within the main balance.
The services/ServiceManager/subscriber/update/adjustbalance/Account API with adjustMode parameter as SET is used to set the shadow balance independently from the main prepaid balance.
The balanceType parameter can be used to set the balance with the following values: •STDBAL : to set the standard balance.
This is the default value of balanceType .
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2260Charging User Guide Rating and charging •SHBAL : to set the shadow balance.
The services/ServiceManager/subscriber/getData/Account API (both GET and POST) can be used to get the current shadow balance when detailed account information is required (that is, when detailedQuery set as true ).
In case the current shadow balance is configured as null, then it is omitted from response.
Note : For more details on using the API, refer to the Swagger API documentation.
EDR tags shadowBalanceBefore and shadowBalanceAfter specify the shadow balance before and after the operation respectively.
If the shadow balance is configured using services/ServiceManager/subscriber/create/Profile API, and it is not provided in the input, then shadowBalanceBefore tag value is 0.
In this case, shadowBalanceBefore tag is omitted from the EDR.
If the shadow balance is configured using services/ServiceManager/subscriber/update/adjustbalance/ Account API, then the shadowBalanceBefore tag reports 0 in case shadowBalanceAfter EDR tag is not null.
Else, both tags are omitted from the EDR.
When the shadow balance is configured, errors can occur in the following cases: •Shadow balance is set to a negative value.
•Shadow balance larger than 0 but the main balance is negative.
•Shadow balance is larger than the current main balance.
•Main balance is smaller than current shadow balance.
•Main balance is negative and the current shadow balance is not 0.
Increasing the shadow balance The services/ServiceManager/RechargeRequest API is used to increase shadow balance along with normal prepaid balance.
Shadow balance can also be increased using the attribute RATING.Adjust-Shadow-Balance .
The rule configuration to increase the shadow balance is as follows: •PRE_RECHARGE trigger •POST_RECHARGE trigger : RATING.Adjust-Shadow-Balance is used to increase the shadow balance.
It is applicable only in case of successful increase in prepaid balance.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2261Charging User Guide Rating and charging Note : PRE_RECHARGE and POST_RECHARGE are recharge RSV triggers.
For details on configuring PRE_RECHARGE and POST_RECHARGE triggers, see Recharge User Guide .
The shadow balance values before and after the increase are reported in the shadowBalanceBefore and shadowBalanceAfter EDR tags.
If the shadow balance was null before the increase, then shadowBalanceBefore value is always 0.
Shadow balance values before and after the increase are reported in the response.
In case the shadow balance was null before the increase, then the value of shadow balance before the increase is reported as 0 in the response.
Decreasing the shadow balance The services/ServiceManager/subscriber/update/adjustbalance/Account API with adjustMode parameter as DECR is used to decrease the shadow balance along with main balance when the amount to charge is calculated externally to NCC.
If the amount to charge is larger than the current shadow balance, then shadow balance is decreased partially until it is reduced to 0.
The remaining amount is deducted only from available normal prepaid balance.
Note : For more details on using the API, refer to the Swagger API documentation.
If the shadow balance is configured as null before the decrease, then it cannot be not decreased.
The shadow balance values before and after the decrease are reported in the shadowBalanceBefore and shadowBalanceAfter EDR tags.
shadowBalanceBefore and shadowBalanceAfter EDR tags are omitted when shadow balance before the decrease is null.
Shadow balance is decreased along with the main balance during call processing in the following cases: •Traffic charge (including e-Commerce usage through REST API).
•Fee deduction (BOU fee and step-up fee).
Shadow balance usage and its value after charging are reported in following CDR tags: •shadowBalanceCommitted : Shadow balance used for charging.
•accountInfo/shadowBalanceAfter : Shadow balance remaining after charging.
•bouFeeShadowBalanceCommitted : Shadow balance used for BOU fee deduction.
•bouFeeShadowBalanceAfter : Shadow balance remaining after BOU fee deduction.
•stepUpFeeShadowBalanceCommitted : Shadow balance used for step-up fee deduction.
•stepUpFeeShadowBalanceAfter : Shadow balance remaining after stepUp fee deduction Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2262Charging User Guide Rating and charging These tags are omitted when shadow balance is not used during traffic charge or fee deduction.
Note : For more details on CDR and EDR tags, see CDR/EDR Reference Guide .
8.57 Domestic call identification This feature allows you to consider international calls as domestic calls based on Carrier Identification Code (CIC).
International calls with a specific CIC are treated as domestic voice calls for the purpose of rating.
The CIC based on which international calls are treated as domestic voice calls can be configured using the rule attributes IMS-Information.Carrier-Select-Routing-Information and IMS-Information.Carrier-Identification- Code In addition to CIC during the VoL TE call processing, the presence of specific subscriptions can also be checked for treating international calls as domestic calls.
Configuration The following rule configuration takes effect to enable this feature: •IMS-Information.Carrier-Select-Routing-Information : This attribute provides the Carrier-Select- Routing-Information value from the IMS-Information.
•IMS-Information.Carrier-Identification-Code : This attribute extracts the carrier identification code from the Carrier-Select-Routing-Information AVP.
The first four digits of Carrier-Select-Routing- Information AVP constitute the carrier identification code.
For example: Carrier-Select-Routing-Information = 0010;cic-context=+1.
Carrier identification code extracted is 0010 (first four digits of the AVP).
Use cases Use case 1: Prepaid subscriber makes a VoL TE call to Canada and call is treated as domestic 1.Subscriber makes a VoL TE call to Canada.
2.CCR-I has the Carrier-Select-Routing-Information AVP containing Carrier Identification Code (CIC X).
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2263Charging User Guide Rating and charging 3.Rule configuration indicates VoL TE call with CIC X is treated as a domestic call.
4.Subscriber is not charged for the call to Canada.
Use case 2: Prepaid subscriber makes a VoL TE call to the Czech Republic 1.Subscriber makes a VoL TE call to Czech Republic.
2.CCR-I has the Carrier-Select-Routing-Information AVP containing Carrier Identification Code (CIC) Y.
3.Rule configuration indicates that VoL TE call with CIC Y is treated as international call.
4.Subscriber is charged for the call the Czech Republic.
Use case 3: Usage Control (Wholesale or Retail) subscriber makes a VoL TE call to Canada not during TOD and the number is not on the blocked list 1.Subscriber makes a VoL TE call to Canada.
2.CCR-I has the Carrier-Select-Routing-Information AVP containing Carrier Identification Code (CIC) X.
3.Rule configuration indicates that VoL TE call with CIC X is treated as a domestic call.
4.Subscriber is not charged for the call to Canada, and usage is calculated as a domestic call.
5.Carrier Identification Code is stored in the ASN.1 record.
Use case 4: Usage Control (Wholesale or Retail) subscriber makes a VoL TE call to Czech Republic 1.Subscriber makes a VoL TE call to Czech Republic.
2.CCR-I has the Carrier-Select-Routing-Information AVP containing Carrier Identification Code (CIC) Y.
3.Rule configuration indicates CIC Y is treated as an international call.
4.Subscriber is charged for the call to the Czech Republic as a normal VoL TE ILD call, and usage is calculated.
5.Carrier Identification Code is stored in the ASN.1 record.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2264Charging User Guide Appendix: Result codes 9Appendix: Result codes 9.
1 Charging result codes Overview The following table lists charging result codes available in NCC.
# Result code 10000 CALL_ OK 10001 CALL_ OK_ PARTIAL_ RESERVE 10002 CALL_ OK_ LOST_ CREDIT 10003 CALL_ OK_ LOST_ CREDIT_ DEVICE_ BARRED 10004 CALL_ OK_ LOST_ CREDIT_ SUB_ BARRED 10005 CALL_ OK_ PARTIAL_ RESERVE_ SUB_ BARRED 10006 CALL_ OK_ RSU_ VALUE_ ZERO 10007 CALL_ OK_ RSU_ NULL 10008 CALL_ OK_ PARTIAL_ RESERVE_ ACCOUNT_ BARRED 10009 CALL_ OK_ LOST_ CREDIT_ ACCOUNT_ BARRED 10010 CALL_ OK_ RESERVE_ FROM_ ACCOUNT 10011 CALL_ OK_ PARTIAL_ RESERVE_ FROM_ ACCOUNTTable 250: Charging result codes Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2265Charging User Guide Appendix: Result codes # Result code 10012 CALL_ OK_ LOST_ CREDIT_ GROUP_ BARRED 10013 CALL_ OK_ STEP_ BUCKET_ PARTIAL_ RESERVE 20000 NOT_ ENOUGH_ CREDIT 20004 NOT_ ENOUGH_ LOST_ CREDIT 20005 NOT_ ENOUGH_ CREDIT_ SUB_ BARRED 20006 NOT_ ENOUGH_ LOST_ CREDIT_ SUB_ BARRED 20007 NOT_ ENOUGH_ CREDIT_ ACCOUNT_ BARRED 20008 NEW_ RES_ NOT_ ALLOWED_ LOST_ CREDIT_ ACCOUNT_ BARRED 20009 NOT_ ENOUGH_ LOST_ CREDIT_ GROUP_ BARRED 20010 CALL_ COST_ CAP_ REACHED 30000 DB_CHARGING_ SERVICE_ NOT_ FOUND 30001 DB_ACCOUNT_ NOT_ FOUND 30002 DB_RATE_ NOT_ FOUND 30003 DB_SUBSCRIPTION_ LIST_ NOT_ FOUND 30004 DB_ACCOUNT_ OPERATION_ EXCEPTION 30005 DB_CONVERTER_ NOT_ FOUND 30006 DB_SESSION_ NOT_ FOUNDTable 250: Charging result codes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2266Charging User Guide Appendix: Result codes # Result code 30007 DB_BUCKET_ OPERATION_ EXCEPTION 30008 DB_SESSION_ CREATION_ ERROR 30009 DB_RE_UNIT_ TYPE_ NOT_ FOUND 30010 DB_DYNAMIC_ SLICING_ PROFILE_ NOT_ FOUND 40000 BILLING_ QTY_ INITIALIZATION_ ERROR 40002 SUBSCRIPTION_ ID_NULL_ IN_SUBSCRIPTION_ LIST 40003 RULE_ ENGINE_ RATE_ ID_MISSING_ FOR_ ACCOUNT 40004 RULE_ ENGINE_ RESUL T_ NOT_ VALID 40005 RULE_ ENGINE_ RESUL T_ EMPTY 40006 RULE_ ENGINE_ RATE_ MISSING_ FOR_ MONETARY_ BUCKET 40007 RATE_ CALCULATION_ ERROR 40008 SESSION_ ALREADY_ EXISTS 40009 RULE_ ENGINE_ ERROR 40010 RULE_ NOT_ APPLICABLE 40011 RULE_ NOT_ APPLICABLE_ SUB_ BARRED 40001 GENERIC_ RATING_ ERROR 41000 SUBSCRIPTION_ INSTANCES_ NOT_ FOUNDTable 250: Charging result codes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2267Charging User Guide Appendix: Result codes # Result code 41001 ACCOUNT_ REF_ NOT_ FOUND_ IN_CS_INSTANCE 41002 INVALID_ CHARGING_ STEP_ IN_RATE 41003 INVALID_ GRANUALITY_ STEP 41004 CHARGING_ SERVICE_ LIST_ EMPTY 41005 RULE_ SET_ NULL 41006 RULE_ RATE_ NOT_ FOUND 41007 RATE_ CONFIGURATION_ ERROR 41008 CHARGING_ SERVICE_ NOT_ FOUND_ IN_SUBSCRIPTION 41009 NO_ SUBSCRIPTION_ ATTACHED_ WITH_ DEVICE 41010 INVALID_ RATE_ CONFIGURATION 41011 RATE_ ERROR_ MUL TISTEP_ NOT_ SUPPORTED 41012 ALL_ SUBSCRIPTIONS_ BARRED 41013 NEW_ RES_ NOT_ ALLOWED_ DEVICE_ BARRED 41014 NEW_ RES_ NOT_ ALLOWED_ ALL_ SUB_ BARRED 41015 INVALID_ REQUEST_ TYPE 41016 RSU_ VALUE_ ZERO 41017 ATTACHED_ SUBSCRIPTION_ CATEGORY_ MISSING_ IN_DEVICETable 250: Charging result codes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2268Charging User Guide Appendix: Result codes # Result code 41018 SUBSCRIPTION_ UNSUBSCRIBE 41019 NEW_ RES_ NOT_ ALLOWED_ ACCOUNT_ BARRED 41020 VALIDATION_ FAILURE 41021 NEW_ RES_ NOT_ ALLOWED_ GROUP_ BARRED 41022 ALL_ GROUPS_ BARRED 41023 CALL_ REJECTED_ FROM_ TARIFF_ FORMULA 45000 CC_SOURCE_ CONTEXT_ MISSING 45001 CC_DEVICE_ CONTEXT_ MISSING 45002 CC_COMMON_ CALL_ CONTEXT_ MISSING 45004 CC_SERVICE_ INFO_ CONTEXT_ MISSING 45005 CC_REQUEST_ TYPE_ MISSING 45006 CC_REQUEST_ TYPE_ IS_NOT_ EVENT_ REQUEST 45007 CC_REQUEST_ ACTION_ MISSING 45008 CC_REQUEST_ ACTION_ IS_NOT_ DIRECT_ DEBIT 45009 CC_CALL_ TYPE_ MISSING 45010 CC_RSU_ MISSING 45011 CC_SERVICE_ CONTEXT_ ID_MISSINGTable 250: Charging result codes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2269Charging User Guide Appendix: Result codes # Result code 45012 CC_SUBSCRIPTION_ ID_LIST_ MISSING 45013 CC_DEVICE_ ID_MISSING 45014 CC_SERVICE_ INFO_ AVP_ MISSING 45016 CC_RSU_ UNIT_ TYPE_ MISSING 45017 CC_RSU_ IVOL_ VALUE_ MISSING 45018 CC_RSU_ BASECCUNITTYPE_ MISSING 45019 CC_RSU_ LIST_ EMPTY 45020 CC_RSU_ OVOL_ VALUE_ MISSING 45021 CC_RSU_ SERVICE_ SPECIFIC_ VALUE_ MISSING 45022 CC_RSU_ TVOL_ VALUE_ MISSING 45023 CC_RSU_ TIME_ VALUE_ MISSING 45024 CC_USU_ MISSING 45025 CC_RATING_ GROUP_ MISSING 45026 CC_SESSION_ ID_MISSING 45027 CC_DIRECT_ DEBIT_ IN_CENTRALIZED 45028 CC_NULL_ RSU_ UNIT_ TYPE_ IN_CENTRALIZED 45029 CC_RG_SI_MISSINGTable 250: Charging result codes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2270Charging User Guide Appendix: Result codes # Result code 50000 TPA_ SYSTEM_ DYNAMIC_ SLICING_ ERROR 60004 BM_ OVER_ COMMIT 60005 BM_ NOT_ FOUNDTable 250: Charging result codes (continued) 9.2 5G result codes Overview This section provides information about the 5G and MUU result codes available in NCC.
Result Code Cause Description 200 - HTTP 200 OK response.
201 - Successfully created.
204 - Success with no content.
400 INVALID_ API The APIName and version are not found on the server.
400 INVALID_ MSG_ FORMAT The message Content- Type is not application/ json or json body is not parsed.
400 MANDATORY_ IE_INCORRECT Mandatory params are incorrect in the Request message.
For example, for an enum with values True and False, any other value is provided.Table 251: 5G result codes Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2271Charging User Guide Appendix: Result codes Result Code Cause Description 400 MANDATORY_ IE_MISSING A mandatory parameter is missing from request message.
400 MANDATORY_ QUERY_ PARAM_ MISSINGThe session Id (that is, Charging Reference) is missing from the query parameter in URL.
400 OPTIONAL_ IE_INCORRECT Returned for Optional Attribute in request message.
404 RESOURCE_ URI_ STRUCTURE_ NOT_ FOUNDThe fixed part after the first variable part of ' apiSpecific Resource UriPar' is not found.
For, example, in http: //<IP_ME> :<HTTP2_ PORT> /nchf- convergedcharging/ v1/chargingdata/ {{Session Id}}/update , if there is a typo in update then this error is returned.
405 The request method is known by the server but is not supported by the target resource.
The server MUST generate an Allow header field in a 405 response containing a list of the currently supported methods of the target resource.
501 NATable 251: 5G result codes (continued) Result code Description SUCCESS The CHF grants the service to the enduser.
This applies to the rating group.
END_ USER_ SERVICE_ DENIED The CHF denies the service request due to service restrictions ( for example, terminate rating group) orTable 252: MUU result codes Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2272Charging User Guide Appendix: Result codes Result code Description limitations related to the end- user.
For example, the end user' s account could not cover the requested service.
CREDIT_ CONTROL_ NOT_ APPLICABLE The CHF determines that the service can be granted to the end user but no further credit control needed for the service.
QUOTA_ LIMIT_ REACHED The CHF denies the service request since the end user' s account could not cover the requested service.
If the request contained used units they shall be deducted, if applicable.
This applies to the rating group.
AUTHORIZATION_ REJECTED Request received for which the user could not be authorized.
USER_ UNKNOWN The server does not recognize the user.
RATING_ FAILED The CHF determines that the service cannot be rated due to insufficient rating input, incorrect parameter combination or unrecognized parameter, or parameter value.
This applies to the rating group.
QUOTA_ MANAGEMENT_ NOT_ APPLICABLE The CHF determines that the service can be granted to the end user without quota management, and used units shall be reported.
This applies to the rating group.Table 252: MUU result codes (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2273Charging User Guide Appendix: Custom scenarios 10 Appendix: Custom scenarios This appendix presents some additional custom scenarios.
10.
1 Charging VoL TE new directory assistance calls Overview NCC supports charging for Directory Assistance (DA) calls, by detecting DA query leg and DA transfer leg and applying different charging accordingly.
DA query When NCC receives VoL TE CCR-I with the following set of Service-Specific-Info AVP under IMS-Information , then it recognizes it as a DA query request and applies the DA query surcharge if configured.
Figure 139: DA query identification [Service-Specific-Info] [Service-Specific-Data] = 14 [Service-Specific-Type] = 2868904938 [Service-Specific-Info] [Service-Specific-Data] != 59 [Service-Specific-Type] = 2868904943 The tariff is applied as per call charging rate configuration.
Note : The DA query surcharge is applied when the first CCR-U with non-zero call usage or CCR-T with non-zero call usage is received.
In NCC, the following condition is used in tariff to identify a DA query call: IMS_SERVICE_INFO.Directory-Assistance=DirectoryAssistanceType_QUERY DA transfer When NCC receives VoL TE CCR-I with the following set of Service-Specific-Info AVP under IMS-Information , then it recognizes it as a DA transfer request and applies the DA transfer surcharge if configured.
The charge is applied per call rate configuration.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2274Charging User Guide Appendix: Custom scenarios Figure 140: DA transfer identification [Service-Specific-Info] [Service-Specific-Data] = 14 [Service-Specific-Type] = 2868904938 [Service-Specific-Info] [Service-Specific-Data] = 59 [Service-Specific-Type] = 2868904943 Note : The DA Transfer Surcharge is applied when the first CCR-U or CCR-T is received.
In NCC, the following condition is used in tariff to identify a DA transfer call: IMS_SERVICE_INFO.Directory-Assistance=DirectoryAssistanceType_TRANSFER Example: Differential charging for DA query and DA transfer calls In the following example, the tariff formula is configured in a way so that there is no charge for DA query calls and the DA transfer calls are charged.
Figure 141: Example: Charging service tariff rule for DA query and DA transfer Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2275Charging User Guide Appendix: Custom scenarios 10.2 OCS-based call redirection for VoL TE MO calls Overview For VoL TE calls there is a functionality to redirect a MO voice call to a configured destination using ABD table configuration.
This is usually used by operators to route calls to DA and customer care 611.
Mapping table and custom data configuration Configure appropriate custom data for device.
ABD routing is be supported for either the global level or device level for VoL TE calls.
Configure a mapping table with Pattern Type as REGEX_PATTERN as follows: Rule examples 611 calls When a successful CCA is returned and a routing number is configured then the FUI is set as follows: •Final-Unit-Action AVP is set as REDIRECT •Redirect-Address-Type AVP is set to the SIP URL •Redirect-Server-Address AVP is set as a configurable string The Requested-Party-Address AVP is used for ABD routing determination.
If this AVP is not populated, then Called-Party-Address AVP is used.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2276Charging User Guide Appendix: Custom scenarios DA calls For a DA query call, the TAS is sent to the OCS as a DA indicator.
For example, the TAS sends Primary Call Type = 14, Service Type != 59 (59 indicates DA transfer), and the Service Type is set to 35 (35 indicates ABD).
For a DA transfer call, there is no change to current behavior.
TAS sends Service Type = 59 to the OCS.
Free calls with 4011 result and FUI If an ABD call returns 4011 in the result (Command level result), it needs apply below logic: 1.Rule is used to determine whether VoL TE free call supports ABD routing.
2.If it returns true, then FUI for routing number is included for 4011 result in command level and only FUI related AVPs is included in category level.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2277Charging User Guide Appendix: Custom scenarios Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2278Charging User Guide Appendix: Custom scenarios 10.3 Emergency call scenarios Allowing emergency call even in barred state When NCC receives the following AVPs (along with other AVPs), the call is processed without rating, charging, or monitoring.
The call is processed even when the device is in barred state.
•CCR-Event with the following IMS-Information/Service-Specific-Info group AVP: –Service-Specific-Info/Service-Specific-Type = 1007 (Service Type) –Service-Specific-Info/Service-Specific-Data = 255 (Emergency Starts) •CCR-Event with the following Service-Specific-Info group AVP –Service-Specific-Info/Service-Specific-Type = 1007 (Service Type) –Service-Specific-Info/Service-Specific-Data = 256 (Emergency Ends) A result code 4011 - DIAMETER_CREDIT_CONTROL_NOT_APPLICABLE is returned and a CDR is generated for such calls.
Rule example The following figure presents the sample rule for the emergency calls for this scenario.
Figure 142: Sample rule for handling emergency calls Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2279Charging User Guide Appendix: Custom scenarios CDR example The following figure presents the CDR for IMS emergency call start and end.
The call was successful in this example even when the device was in Inactive state.
Figure 143: Sample CDR for IMS emergency call Option to lift data restrictions for emergency call and send notification The service provider can lift usage control (UC) restriction for data call when subscriber makes an emergency call.
This allows the subscriber to use data service in emergency case, such as IM, video, along with voice call and SMS.
This also includes “Emergency Call” notification to include the UC lift options, which indicates what call types are allowed to ignore UC restriction checks.
A call is treated as emergency call in the following scenarios: •for emergency event (CCR-E), if it is an emergency start/stop request.
•for CCR-I request for session call, if the called party address is in device data EmergencyNumbers list.
Note : Before loading the rule logic, create device custom data EmergencyNumbers with all the emergency numbers defined in it.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2280Charging User Guide Appendix: Custom scenarios Figure 144: Rule example: To identify an emergency call Figure 145: Rule example: Logic for emergency start/stop The rule action NOTIFICATION.Send-Notification is used to send the notification for emergency call.
The emergency call notification needs to include variables $[liftoption] in the notification variable.
The global IMS emergency lift option is defined as a rule variable.
This is compared with the device-level emergency lift option.
The one with lesser value is used as the final lift option using the source context SPR_DEVICE.Compared-Emergency-Level ( <input Level> ) .
The global variable for IMS emergency lift option (for example, globalLiftOptionIMS ) is used as the <input Level> parameter.
The notification variables $[liftoption] takes the following values: •ALL (lifting all call types) •DATA, VOICE, VIDEO, and ECOM •DATA, VOICE, and VIDEO •VOICE and VIDEO •SMS and MMS •NONE (lifting no call) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2281Charging User Guide Appendix: Custom scenarios The following figure provides example of configuring rule for notification after emergency call.
It provides two lift options, for example, ALL and DATA_VOICE_VIDEO_ECOM .
More options can be configured in a similar way.
Figure 146: Rule example: TCP/IP notification after emergency call If the lift option includes data call, and if device custom data sendRARForEmergencyCall is true , or variable globalSendRARForEmergencyCall is true , then the rule result includes NOTIFICATION.Send-RAR = "SendRAR" .
This action results in sending RAR to all current ongoing Gy and 5G sessions.
Note : Before loading the rule logic, the device custom data sendRARForEmergencyCall (Boolean type) must be defined.
Figure 147: Rule example: Logic for sending emergency call RAR 10.4 Vendor-specific announcement AVPs definition Overview The AVPs covered in this section are vendor-specific AVPs defined to handle various charging scenarios unique to specific environments.
These AVPs are not defined by the generic standards and therefore are specific to network elements from the vendor used in specific scenarios.
All Diameter AVP Headers contain Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2282Charging User Guide Appendix: Custom scenarios an optional field called Vendor-ID.
The Vendor-ID field is present if the V bit is set in the AVP Flags field.
The vendor identifier is used in the Vendor-ID field of the AVP header and in the Vendor-Id AVP.
The Vendor- Id AVP is used to identify the vendor in the Vendor-Specific-Application-Id and Experimental-Result-Code grouped AVPs.
The Vendor-Id AVP, as part of the Vendor-Specific-Application-Id grouped AVP, contains the value of 10415, which is the IANA registered value for '3GPP' in 3GPP TS 29.230.
Since these AVPs are vendor specific, each AVP uses the vendor-specific Vendor-ID to indicate who defined the AVP and how this AVP is used.
10.4.
1 AVP definitions Announcement-Instructions AVP The Announcement-Instructions AVP is of type grouped and is used by the OCS to provide announcement instructions to the TAS.
This allows the TAS to establish appropriate connection with the announcement units.
The information carried in this AVP is used by TAS to inform the MRF what announcements to play.
This AVP is included as part of the CCA response message when announcement are required.
The Announcement-Instructions AVP has the following ABNF grammar: Announcement-Instructions :: = < AVP Header: 700> [ Announcement-Number ] [ Announcement-Type ] [ Announcement- Order ] [ Announcement-Variable-Part ] [ Announcement-Prompt-Collect-Parameter ] Announcement-Number AVP The Announcement-Number AVP contains the announcement number to be played when this AVP is received.
This AVP should contain an announcement number to be correlated to a system announcement based on TAS vendor implementation (the correlation may be direct or may be done via a mapping table).
Announcement-Order AVP The Announcement-Order AVP contains the relative order/sequence for this announcement (applies when multiple instances of Announcement-Instructions AVP are included).
It is an optional AVP within the Announcement-Instructions AVP.
It specifies the order for each announcement starting from 1.
If it is missing or if it has a value 0, then this indicates that the order is not important.
This is populated based on the order in which the announcements are generated within the OCS logic where there are multiple announcements to be played at the same point in a call.
Announcement-Type AVP The Announcement-Type AVP indicates when an announcement is to be played.
It is an optional AVP within the Announcement-Instructions AVP.
It can have a pre-defined set of values as shown in the following table: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2283Charging User Guide Appendix: Custom scenarios Values Descriptor Description Used by TAS Used by OCS 0 PREQUOTA_ ANNOUNCEMENTThis indicates a pre- quota announcement is requested prior to the quota is used.YES YES 1 POSTQUOTA_ ANNOUNCEMENTThis indicates a post- quota announcement is requested after the quota is usedYES YES 2 PROMPT_ AND_ COLLECTAttention : This value is reserved for future use.
This indicates a prompt and collect sessions is requested.
This means that TAS has to perform a prompt and collect session and pass the information collected (Service- Specific- Type = 1015 ) back to OCS.
OCS can then make appropriate decisions affecting the call handling.YES YES Announcement-Variable-Part-Data AVP The Announcement-Variable-Part-Data AVP contains the data corresponding to the type of data specified in Announcement-Variable-Part-Type AVP.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2284Charging User Guide Appendix: Custom scenarios Announcement-Variable-Part-Type AVP The Announcement-Variable-Part-Type AVP contains the type of units carried in the Announcement- Variable- Part-Data .
It can have a pre-defined set of values as shown in the following table.
AVP value to be used in network as specified in following the table.
Values Descriptor Description Used by TAS Used by OCS 0 INTEGER Integer ( A string of numbers, which is announced as a single number, up to 10 digits)YES YES 1 NUMBER Number ( A string of numbers, which is announced as individual digits, up to 24 digits)YES YES 2 TIME Time ( A time string in the form HHMM)YES YES 3 DATE Date ( A Date string in the form: MMDDYYYYYES YES 4 PRICE Price ( A currency string, in the format AAAAAABB [ AAAAAA is the integral part, BB is the decimal part] and string identifying the type of currency)YES YES Announcement-Variable-Part AVP The Announcement-Variable-Part AVP is used by the OCS to provide additional details on how the announcement must be handled by the TAS.
This AVP is used when variable parts need to be applied as part of the announcement, to be signalled in the connection between TAS and MRF.
The AVPs shall be used to build MSCML documents for SIP INFO messages sent to the MRF.
It has the following ABNF grammar: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2285Charging User Guide Appendix: Custom scenarios Announcement-Variable-Part :: = < AVP Header: 704> [ Announcement-Variable-Part- Type ] [ Announcement-Variable-Part-Data ] Announcement-Prompt-Collect-Parameter AVP Attention : The Announcement-Prompt-Collect-Parameter AVP and its child AVPs (that is, Announcement-Prompt-Collect-Interruptible , Announcement-Prompt-Collect-MinDigits , and Announcement-Prompt-Collect-MaxDigits ) are reserved for future use.
The Announcement-Prompt-Collect-Parameter AVP is used by the OCS to provide announcement prompt and collect parameters for the TAS.
Announcement-Prompt-Collect-Parameter] :: = < AVP Header: 708> [Announcement- Prompt-Collect-Interruptible] [Announcement-Prompt-Collect-MinDigits] [Announcement-Prompt-Collect-MaxDigits] Announcement-Prompt-Collect-Interruptible AVP The Announcement-Prompt-Collect-Interruptible AVP is used by the OCS to provide one of announcement prompt and collect parameters for the TAS.
Announcement-Prompt-Collect-MinDigits AVP The Announcement-Prompt-Collect-MinDigits AVP is used by the OCS to provide one of announcement prompt and collect parameters for the TAS.
Announcement-Prompt-Collect-MaxDigits AVP The Announcement-Prompt-Collect-MaxDigits AVP is used by the OCS to provide one of announcement prompt and collect parameters for the TAS.
10.4.2 Setting vendor specific attributes (VSAs) in dictionary The AVPs defined in AVP definitions on page 2283 are available when VSAs are set in the dictionary and announcement associated values are set in rules.
CustomVendorDefinition.xml Modify the /opt/tpa/ conf/sac/diameter/vsa/CustomVendorDefinition.xml dictionary file as follows: <vendor id="10415" name="Announcement"/> AttributeDefinitionAnnouncement.xml Modify the /opt/tpa/conf/sac/diameter/vsa/AttributeDefinitionAnnouncement.xml dictionary file as follows: <attribute code="700" vendorName="LUCENT" name="Announcement- Instructions" format="GROUPED" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"> <groupedAttributeSyntax> <optional attributeName="Announcement- Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2286Charging User Guide Appendix: Custom scenarios Number"/> <optional attributeName="Announcement-Type"/> <optional attributeName="Announcement-Order"/> <optional attributeName="Announcement- Variable-Part"/> <optional attributeName="Announcement-Prompt-Collect- Parameter"/> </groupedAttributeSyntax> </attribute> <attribute code="701" vendorName="LUCENT" name="Announcement-Number" format="UNSIGNED32" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"/> <attribute code="702" vendorName="LUCENT" name="Announcement-Order" format="UNSIGNED32" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"/> <attribute code="703" vendorName="LUCENT" name="Announcement-Type" format="UNSIGNED32" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"></attribute> <attribute code="705" vendorName="LUCENT" name="Announcement-Variable-Part-Data" format="UTF8STRING" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"/> <attribute code="706" vendorName="LUCENT" name="Announcement-Variable-Part-Type" format="ENUMERATED" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"> <enumeratedAttributeSyntax> <enumeration value="0" name="INTEGER" display="INTEGER"/> <enumeration value="1" name="NUMBER" display="NUMBER"/> <enumeration value="2" name="TIME" display="TIME"/ > <enumeration value="3" name="DATE" display="DATE"/> <enumeration value="4" name="PRICE" display="PRICE"/> </enumeratedAttributeSyntax> </ attribute> <attribute code="704" vendorName="LUCENT" name="Announcement- Variable-Part" format="GROUPED" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"> <groupedAttributeSyntax> <optional attributeName="Announcement-Variable- Part-Type"/> <optional attributeName="Announcement-Variable-Part- Data"/> </groupedAttributeSyntax> </attribute> <attribute code="709" vendorName="LUCENT" name="Announcement-Prompt-Collect-Interruptible" format="ENUMERATED" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"> <enumeratedAttributeSyntax> <enumeration value="0" name="False" display="False"/> <enumeration value="1" name="True" display="True"/> </enumeratedAttributeSyntax> </attribute> <attribute code="710" vendorName="LUCENT" name="Announcement-Prompt- Collect-MinDigits" format="UNSIGNED32" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"/ > <attribute code="711" vendorName="LUCENT" name="Announcement-Prompt- Collect-MaxDigits" format="UNSIGNED32" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"/ > <attribute code="708" vendorName="LUCENT" name="Announcement-Prompt- Collect-Parameter" format="GROUPED" mFlag="OPTIONAL" pFlag="OPTIONAL" vFlag="REQUIRED" encrypt="false" register="true" proprietary="true"> <groupedAttributeSyntax> <optional attributeName="Announcement-Prompt- Collect-Interruptible"/> <optional attributeName="Announcement-Prompt-Collect- Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2287Charging User Guide Appendix: Custom scenarios MinDigits"/> <optional attributeName="Announcement-Prompt-Collect-MaxDigits"/> </groupedAttributeSyntax> </attribute> ChargingVsaToContextMapping.xml Modify the /opt/tpa/conf/sac/diameter/rule/ChargingVsaToContextMapping.xml dictionary file as follows: <diameterToRuleContextMap xmlns="diameterRuleContextMap"> <vsaToContext> <vsaToRuleSourceContexts> <!-- TODO --> </vsaToRuleSourceContexts> <vsaToRuleResultContexts> <vsaRuleResultContext> <context type="GY"/> <customizedAttributes parentAttributeName="Multiple-Services-Credit-Control"> <vendorInfo> <name>LUCENT</name> <includeAttribute name="Announcement- Instructions"/> <includeAttribute name="Announcement-Instructions.Announcement- Number"/> <includeAttribute name="Announcement-Instructions.Announcement- Type"/> <includeAttribute name="Announcement-Instructions.Announcement-Order"/ > <includeAttribute name="Announcement-Instructions.Announcement-Variable- Part.Announcement-Variable-Part-Type"/> <includeAttribute name="Announcement- Instructions.Announcement-Variable-Part.Announcement-Variable-Part- Data"/> <includeAttribute name="Announcement-Instructions.Announcement- Prompt-Collect-Parameter.Announcement-Prompt-Collect-Interruptible"/ > <includeAttribute name="Announcement-Instructions.Announcement- Prompt-Collect-Parameter.Announcement-Prompt-Collect-MinDigits"/> <includeAttribute name="Announcement-Instructions.Announcement-Prompt- Collect-Parameter.Announcement-Prompt-Collect-MaxDigits"/> </vendorInfo> </ customizedAttributes> </vsaRuleResultContext> </vsaToRuleResultContexts> </ vsaToContext> </diameterToRuleContextMap> 10.5 Call scenarios for Event Charging with Unit Reservation calls Call controller end-to-end SMS call Consider that call controller uses a credit request profile and PDF rules to determine CallType , subCallType , and Roaming status.
The call controller interface accepts and processes the call from the network, and then interfaces directly with the Rating Engine where rating rules determine the applicable charging service.
The Rating Engine uses applicability conditions and tariffs to charge from a bucket using more PDF rules.
After processing the CCR message, call controller retrieves the actions from the Rating Engine and constructs a CCA message by populating its GSU, thresholds, and VT for each MSCC in the MSCC list from the CCR message.
The device lifecycle is invoked on device attached.
For CCR-E or CCR-I message with a successful command result code, the call controller sessionManager notifies the lifeCycleManager to handle the state transition before sending the response with CCA message.
In this example, following CCR-I contains the AVPs available for ECUR for the destination host or realm and session ID (pcef1.diam.originRealm1.com;343039;1521266195) on the Gy and Ro interface: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2288Charging User Guide Appendix: Custom scenarios First level AVP name Second level AVP name Lowest level AVP name Example values Session- Id - - pcef1.
diam.
origin Realm1.
com; 343039; 1521266195 Origin- Host - - pcef1.
diam.
origin Realm1.
com Origin- Realm - - origin Realm1.
com Destination- Realm - - jRealm Auth- Application- Id - - 4 Service- Context- Id - - 32274@ 3gpp.
org CC-Request- Number - - 0 CC-Request- Type - - 1 (INITIAL_ REQUEST) Origin- State- Id - - 1473342807 Event- Timestamp - - Sep 8, 2016 1: 53:31 PM Subscription- Id-Data - 390000000000001 and Grouped Value 2Subscription- Id Subscription- Id-Type - IMSI E.164 Multiple- Services- Indicator - - 1 (MUL TIPLE_ SERVICES_ SUPPORTED) service- context- Id - - 32274@ 3gpp.
org User- Name - - -Table 253: Use of call control AVPs ECUR Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2289Charging User Guide Appendix: Custom scenarios First level AVP name Second level AVP name Lowest level AVP name Example values CC-Correlation- Id - - > Termination- Cause - - 5 User- Equipment- Info- Type - 0 (IMEISV) User- Equipment- Info User- Equipment- Info- Value - 4970686f6e65 ( iPhone) CC-Time 10 CC-Money Unit- Value, Currency- Code CC-Total- Octets 225 CC-Input- Octets 200 CC-Output- Octets 25Requested- Service- Unit CC-Service- Specific- Units 1 Service- Identifier - 121 Rating- Group - 8Multiple- Services- Credit- Control Reporting- Reason - 8 (POOL_ EXHAUSTED) User- Equipment- Info - User- Equipment- Info- Type 0 (IMEISV) User- Equipment- Info- Value 01010101Service- Information PS-Information (based on 32.
274, sub set of 32.
299) 3GPP- User- Location- Info -Table 253: Use of call control AVPs ECUR (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2290Charging User Guide Appendix: Custom scenarios First level AVP name Second level AVP name Lowest level AVP name Example values 3GPP- RAT- Type 6 (EUTRAN) 3GPP- MS-Time Zone 1100 ( GMT + 2 hours 45 minutes No Adjustment) PDP- Address PDP- Address Family PDP- Address Address–PDP- Address Family = 1 ( IPv4) –PDP- Address Address = 94.1.21.1.1 3GPP- SGSN- MCC- MNC 302720 SMS- Information Client- Address Client- Address Family Client- Address AddressClient- Address Family = 1 ( IPv4) Client- Address Address = 94.1.21.1.2 Originating- SCCP- Address Family1 (IPv4) Originating- SCCP- Address Originating- SCCP- Address Address94.1.21.1.3 Address- Type 2 (IPv4 Address) Address- Data 94.21.1.4 Address- Domain Domain- Name vfit.comOriginator- Received- Address 3GPP- IMSI- MCC- MNC 310015Service- Information ( continued) SMSC- Address SMSC- Address Family 1 (IPv4)Table 253: Use of call control AVPs ECUR (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2291Charging User Guide Appendix: Custom scenarios First level AVP name Second level AVP name Lowest level AVP name Example values SMSC- Address Address 94.1.21.1.5 SM-Message- Type 0 (SUBMISSION) Interface- Id mobile Interface- Port 8999 Interface- Text SMSTEXTOriginator- Interface Interface- Type 1 (MOBILE_ ORIGINATING) Destination interfaces: •Interface- Id •Interface- Port •Interface- Text •Interface- TypeDestination interfaces ( example) •Interface- Id = mobile •Interface- Port = 8999 •Interface- Text = SMSTEXT •Interface- Type = 1 ( MOBILE_ ORIGINATING)Service- Information ( continued) Recipient Info Recipient- Address Address- Type2 (IPv4 Address) Address- Data 94.21.1.6 Address- DomainService- Information ( continued) Domain- Name 3GPP- IMSI- MCC- MNC Addressee- TypeExample values: •Domain- Name = vfit.
com;Table 253: Use of call control AVPs ECUR (continued) Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2292Charging User Guide Appendix: Custom scenarios First level AVP name Second level AVP name Lowest level AVP name Example values •3GPP- IMSI- MCC- MNC = 310015 •Addressee- Type = 0 ( TO) Recipient- Received- Address Address- TypeAddress- Type = 2 ( IPv4 Address) Address- Data Address- Data = 94.
21.1.7 Address- Domain Domain- Name 3GPP- IMSI- MCC- MNCDomain- Name = vfit.
com 3GPP- IMSI- MCC- MNC = 310015 Recipient- SCCP- Address SMSC- Address FamilySMSC- Address Family = 1 ( IPv4) SMSC- Address Address SMSC- Address Address = 94.1.21.1.8Service- Information ( continued) SM-Protocol- ID 00000004Table 253: Use of call control AVPs ECUR (continued) The Call Type is processed from the credit request profile as SMS and generates the following rule tables within the contexts of call controller and CCR-I: If... Then.
.. Rule table 1: GY_MESSAGE.
Service-Context-Id == 32274@ 3gpp.
orgCALL_RESULT.Default-Roaming-Decision = Roaming Decision.
HOME Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2293Charging User Guide Appendix: Custom scenarios If... Then.
.. Rule table 2: GY_MESSAGE.
Multiple-Services-Credit- Control.Rating-Group == 8CALL_RESULT.Call-Sub-Type = CallSubType.
SMS_ MO When the credit request profile based rules are evaluated, the Call Type is processed and the rule tables are matched to configure the Roaming Status as HOME and the call-Sub-Type as SMS-MO indicating a mobile SMS message, which means the CALL_RESULT ResultContext are returned as the following policy decision results: •CALL_RESULT.Default-Roaming-Decision = HOME •CALL_RESULT.Call-Sub-Type = SMS_MO Call controller processes the CCR using the service Id to request a number of units for the call as follows: •requestedUnit •TIME:10 •TVOL:225 •IVOL:200 •OVOL:25 •SERVICE_SPECIFIC:1 A call context is created for the session pcef1.diam.originRealm1.com;343039;1521266195 triggering a call to the Rating Engine to get a rating request for the session.
Upon evaluating and matching the Rating Rule table, Applicability Condition_SMS_1 (the third rule table), a value of true is added for the RATING.Charging-Service-Applicable action.
The Rating Rule table in the Rating Engine evaluates how a call is charged by matching a rule that adds a tariff action to select a value from the SMSbucket .
The bucket balance is checked and if there is enough in the bucket balance, then the amount requested is deducted and reserved.
A response is then updated with the granted service units as requested in a CCA message.
The CCA contains the given AVPs for the destination host/realm and session id (pcef1.diam.originRealm1.com;343039;1521266195 ) on the Gy and Ro interface: •Result-Code with Value(s):2001 •CC-Request-Type with Value(s):1 •CC-Request-Number with Value(s):0 •Multiple-Services-Credit-Control with Value(s): Grouped Value 1 •Granted-Service-Unit with Value(s): Grouped Value 1 Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2294Charging User Guide Appendix: Custom scenarios •CC-Time with Value(s):0 •CC-Money = Unit Value=1, Currency Code=Euro •CC-Total-Octets with Value(s):0 •CC-Input-Octets with Value(s):0 •CC-Output-Octets with Value(s):0 •CC-Service-Specific-Units with Value(s):1 •Service-Identifier with Value(s):121 •Rating-Group with Value(s):8 •Result-Code with Value(s):2001 •Validity-Time with Value(s):10 •Credit-Control-Failure-Handling with Value(s):0 •CC-Session-Failover with Values(s):0 Call Controller failure handling A call controller supports the Credit-Control-Failure-Handling AVP in the CCA (Initial and Update) and CC- Session-Failover in the CCA (Initial and Update) through RSV.
Note : CCFH and CCSF AVPs are not supported at MSCC level, and are supported at root level only.
Therefore, rules cannot be applied at MSCC level for CCFH and CCSF AVPs, and, CCFH and CCSF AVPs are not applicable for IEC calls.
Credit-Control-Failure-Handling AVP NCC supports the following values of the Credit-Control-Failure-Handling AVP in a CCA message: •TERMINATE (0) •CONTINUE (1) •RETRY_AND_TERMINATE (2) •IGNORE (3) NCC performs the following logic based on the values set: •If the value of CCFH AVP is configured as IGNORE in active RSV, then CCFH AVP is not returned in CCA message.
•If the value is NULL , then CCFH AVP is returned in CCA message as TERMINATE .
The values of CCFH can be configured as an output of the rule as shown in the following figure.
To do this, log into the SM GUI and navigate to Common Configuration > Charging tab and select Rules and Variables from the drop-down list.
Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2295Charging User Guide Appendix: Custom scenarios Figure 148: CCFH sample CC-Session-Failover AVP The CC-Session-Failover AVP contains information about whether moving the credit-control message stream to a backup server during an ongoing credit-control session is supported.
It can have either of the following values: •FAILOVER_NOT_SUPPORTED (0) •FAILOVER_SUPPORTED(1) •IGNORE (2) The value of this AVP is selected while processing an active RSV.
If the value is configured as IGNORE or the default parameter is missing in the active RSV, then the CCSF AVP is not returned in a CCA message.
The values of the CCSF AVP can be configured as an output of the rule as shown in the following figure.
To do this, log into the SM GUI and navigate to Platform & Common > Charging tab and select Rules and Variables from the drop-down list.
Figure 149: CCSF sample Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2296Charging User Guide Appendix: Custom scenarios 10.6 Specific charging scenarios Charging behavior across the subscription billing cycle NCC behaves in the following manner when a reservation and its corresponding commit happens across a subscription billing cycle reset or renewal time: •The current values of buckets and counter for each user subscription are memorized during the reset or renewal time, which means the current values of buckets and counters are the values of buckets and counters before the reset or renewal time.
Therefore, after reset or renewal of the user subscription, there are two types of values for buckets or counters: 1.Memorized values of buckets and counters, also referred to as the Previous Billing Cycle (PreBC) values, and 2.Actual values of buckets and counters after the reset or renewal of subscription, also referred to as the Post Billing Cycle (PostBC) values.
•The timestamp when the buckets or counters for a user subscription got reset or renewed is memorized.
•If an update request is received from the service provider network to report the used quantities, then a check is performed to see whether the subscription reset or renewal time is between the previous request and the current request.
If the check confirms that the subscription reset or renewal time is between the previous request and current request, then quantities of used resources are committed as per the following logic: –In case of over-commit scenarios, PreBC buckets or counters are updated with the last reserved quantities and PostBC buckets or counters are updated with over-commit quantities.
–In case of under-commit scenarios, PreBC buckets or counters are updated with the reported quantities.
If a bucket is preconfigured for carry-over feature, then unused quantities are evaluated with reference to carry-over feature and the carry over is updated accordingly.
Note : The behavior of NCC as explained in this section is applicable only when a single reset or renewal of a user subscription takes place between a previous request and current request.
The BucketCommittedUnitsBR , CounterUpdatedValueBR , and CarryOverTRValue CDR tags are generated during an update to PreBC buckets or counters.
For information on BucketCommittedUnitsBR , CounterUpdatedValueBR , CarryOverTRValue CDR tags, see the NOKIA Converged Charging CDR/EDR Reference guide.
Charging behavior on execution of the Reset Account action NCC behaves in the following manner (similar to Charging behavior across the subscription billing cycle on page 2297 ) when a reservation and its corresponding commit happens across the account reset time: Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2297Charging User Guide Appendix: Custom scenarios •The values of balance and available balance attributes of the account balance before reset are memorized during reset time.
Therefore, after reset there are following two types of values of the account balance: 1.Memorized values, that is, also referred as PreBC values.
2.Actual values of an account after the reset, that is, also referred to as Post Billing Cycle (PostBC) values.
•The timestamp when the account got reset is memorized.
•If an update request is received from the service provider network to report the used quantities, then a check is performed to see whether the account reset time is between the previous and the current request.
If the check confirms that the account reset time is between the previous and current request, then quantities of used resources are committed as per the following logic: –In case of over-commit scenarios, PreBC balance units are updated with the last reserved quantities and PostBC balance units are updated with over-commit quantities.
–In case of under-commit scenarios, PreBC balance units are updated with the reported quantities.
The accountCommittedUnitsBR CDR tags are generated during an update to PreBC balance values.
For information on accountCommittedUnitsBR CDR tags, see the NOKIA Converged Charging CDR/EDR Reference guide.
Also, during cancel reservation or audit request, if reset has occurred between previous and current request, then reservation is canceled from the PreBC balance values.
Example: Reset the main balance at the end of a billing cycle Provisioning: 1.Create an account with customized periodic lifecycle.
2.Configure the Reset Account action in the periodic lifecycle with an end time.
3.Set the main account balance to 12 using the Adjust Account REST API.
Result: The Reset Account action is triggered without the reset value using the Trigger API.
The current value of the account is reset to 0 considering the reset value is not specified in the Reset Account action.
Following is a sample CDR (Note that all parameters are not shown in this sample): Name Tag Data Record Type 0 LIFECYCLE_ RECORD Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2298Charging User Guide Appendix: Custom scenarios Name Tag Data invoked By 1 Reset Account Action triggered Entity Type 1 Account reset Value 1 0 account Balance Before Reset 1 12.0 account Balance After Reset 1 0 result 1 Success Nokia Converged Charging Release 22.9P556766-DN1000054947-R22.9 1 ©2023 Nokia.
Nokia Confidential Information Use subject to agreed restrictions on disclosure and use.2299
