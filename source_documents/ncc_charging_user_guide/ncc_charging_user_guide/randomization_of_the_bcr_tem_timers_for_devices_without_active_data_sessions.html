<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="BCR TEM timer randomization for devices without active data sessions" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>BCR TEM timer randomization for devices without active data sessions</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">BCR TEM timer randomization for devices without active data
        sessions</h1>
<div class="body conbody">
        <p class="p">This feature addresses randomizing BCR processing for devices which do not have any
            active data sessions and subscriptions associated with these devices still have their
            BCR processing triggered exactly on the BCR date. If significant percentage of devices
            are present without active data sessions with a common BCR date (for example, for all
            accounts with the same day of month as their BCR date) it may result in a BCR processing
            storm for a potentially large number of devices/accounts at the same time.</p>

        <p class="p">As a result, an external notification server may get a storm of notifications and may not
            be able serve all. This feature helps to avoid a possible BCR storm, by introducing
            randomization of the BCR TEM timers for subscriptions/accounts associated with devices
            with no active data sessions over the same range used for devices with active data
            sessions.</p>

        <ul class="ul" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__ul_h54_tnw_tvb">
            <li class="li">This feature is applicable only for devices.</li>

            <li class="li">Among all the lifecycle entities, only the BCR TEM timer of Account and subscription
                are considered for randomization.</li>

            <li class="li">Suspended subscriptions and subscriptions corresponding to BOU bundles are not
                considered for randomization.</li>

            <li class="li">Maintaining the order of executions is only considered when adding/updating the end
                time of a subscription with all related subscriptions and accounts under the same
                device.</li>

            <li class="li">In Service (Bundle) if <strong class="ph b">Disable tariff time change</strong> is <var class="keyword varname">true</var>,
                then adding a new subscription ignores randomization, and BCR time in TEM is aligned
                to BCR time of the entity. If subscription is added in an existing profile and
                linked to account renewal, then TEM timer of the funding account is reset to the
                original value.</li>

            <li class="li">If this feature is enabled and <em class="ph i">tolerance</em> is configured in lifecycle, then
                offset or randomization added by <em class="ph i">tolerance</em> is overridden by
                randomization.</li>

            <li class="li">This feature depends on other features. So before using this feature enable the
                following ME application preferences by setting the values to an integer greater
                than 0:<ul class="ul" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__ul_abg_3nq_5vb">
                    <li class="li">VT Adjustment Factor Prepaid</li>

                    <li class="li">VT Adjustment Factor</li>

                </ul>
</li>

            <li class="li">If randomization is enabled, the periodicity of an account or subscription must not
                be less than the value configured in the application preference <strong class="ph b">VT Adjustment
                    Factor</strong> or <strong class="ph b">VT Adjustment Factor Prepaid</strong>.</li>

            <li class="li">If this feature is enabled, and the functionality to define renewal priority for
                subscriptions is also enabled, then while adding the random factor to TEM events,
                the subscription with higher priority is scheduled before the lower priority TEM
                events. <div class="note" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__note_y2v_d5l_hyb"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> This functionality is applicable only to
                    subscriptions with their own PLC. For more details, see <a class="xref" href="defining_renweal_order_of_subscriptions_associated_with_an_account.html">Defining renewal priority of subscriptions</a>.</div>
</li>

        </ul>

        <div class="section" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__section_bpr_ymw_tvb"><h2 class="title sectiontitle">Configuration</h2>
            
            <p class="p">To enable this feature, set the application preference <code class="ph codeph">Enable Randomization
                    Of BCR When No Active Session</code> to <var class="keyword varname">true</var>. As a result,
                a random number is generated for VT adjustment. The default value is
                    <var class="keyword varname">false</var>.</p>

        </div>

        <div class="section" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__section_apk_g4q_5vb"><h2 class="title sectiontitle">Calculation</h2>
            
            <ul class="ul" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__ol_kyt_h4q_5vb">
                <li class="li">If the subscriptions are funded by postpaid account, then the BCR TEM timer is
                    modified with time, calculated using following
                        formula:<pre class="pre codeblock" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__codeblock_igr_dpq_5vb"><code>T1 + RAND [1 second, VTAF]</code></pre><p class="p">where</p>
<ul class="ul" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__ul_jgq_kpq_5vb">
                        <li class="li">TI = next BCR value of Account</li>

                        <li class="li">VTAF = validity timer adjustment factor</li>

                    </ul>
</li>

                <li class="li">If the subscriptions are funded by prepaid account, then the BCR TEM timer is
                    modified with time, calculated using following
                        formula:<pre class="pre codeblock" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__codeblock_nhv_mpq_5vb"><code>T1 + RAND[1 second, VTAFprepaid]</code></pre><p class="p">where</p>
<ul class="ul" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__ul_d1w_ppq_5vb">
                        <li class="li">TI = next BCR value of Account</li>

                        <li class="li">VTAFprepaid = validity timer adjustment factor for prepaid account</li>

                    </ul>
</li>

                <li class="li">If the subscription has its own PLC with next BCR date between T1 (account BCR
                    date) and T2 (BCR date of the other subscription), then the BCR TEM timer is
                    calculated using following
                        formula:<pre class="pre codeblock" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__codeblock_fbp_qpq_5vb"><code>T3 + RAND[1 second, MIN[VTAFprepaid, T2R-T1R]</code></pre><p class="p">where</p>
<ul class="ul" id="randomization_of_the_bcr_tem_timers_for_devices_without_active_data_sessions__ul_erf_spq_5vb">
                        <li class="li">T1R = randomized value for T1</li>

                        <li class="li">T2R = randomized value for T2 next BCR value</li>

                    </ul>
</li>

            </ul>

        </div>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>