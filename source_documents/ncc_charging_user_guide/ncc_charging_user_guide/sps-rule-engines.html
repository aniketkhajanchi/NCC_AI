<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Rule engine" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="id9YZ-09018-UG00-PCZZA-d1e14568" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Rule engine</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="id9YZ-09018-UG00-PCZZA-d1e14568">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Rule engine</h1>
<div class="body conbody">
    <p class="p">This chapter describes rule authoring, the common NCC Diameter rule engine architecture and
      operations, the composition of a rule for all applications, along with variables, and mapping
      for the specific application rule engine operations used to manage the traffic handled by
      NCC. </p>

    <p class="p">Each application (Diameter Configuration and NCC) has their own robust rule engine with rule
      system functionality that is specifically designed for the application.</p>

    <p class="p">The application specific rule engines are organized into groups of pre-defined scenarios
      called rule system versions (RSVs). Each RSV contains a collection of rule groups that
      implement a customized NCC message modification and additional behavior each time a Diameter
      message is received or whenever the rule engine is invoked by the application. </p>

<div class="section"><h2 class="title sectiontitle">Rule authoring</h2>
<p class="p">The rule engines evaluate the rules and return the results as shown in the following figure. </p>

<div class="fig fignone"><span class="figcap"><span class="fig--title-label">Figure: </span>Overall rule processing</span>
                                                  
                                                  <img class="image break" src="../images/overallruleprocessing_default.png" height="360" width="480" />
                                                </div>

<p class="p">Rules are used to customize NCC behaviors when certain events occur. Rules can be used for many
        things, including sending and customizing notifications, generating event logs, modifying
        session parameters, defining system charging, and for making customized charging decisions.
        For example, when a session is established, you might want to customize getting information
        from a CCR for a type of roaming to enact the correct rating and charging on a call.</p>

<p class="p">The Rule Engines operates in a simple input and output concept. The input is the data available
        for an invocation along with a set of rules to be invoked. The output is a result returned
        from the invocation. The Rule Engine implements an event-driven, forward-chaining rule
        evaluation algorithm using production style rules on invocation. When required, NCC requests
        that the Rule Engine executes a particular Trigger via an interface available to NCC. </p>

<p class="p">All rules in the rule group that make up the Trigger are evaluated by the appropriate rule
        engines as their conditions are matched. A top level rule group is generated from any
        profile that exists. In each group, the first rule (in the order of precedence ) whose
        conditions are met is executed. The actions specified in the rule are returned to NCC, where
        the appropriate steps are performed for the action (for example, action values to accept or
        reject the application session request). </p>

<p class="p">After the application plugins have been sequenced, the rules and messages are evaluated and invoked by the system to process the specific functionality in the sequence of, and by, the installed application plugins. That is, rules are written such that as they cascade through the system the rule whose conditions are matched first is executed offering an order of precedence as shown in the following diagram.</p>

<div class="fig fignone"><span class="figcap"><span class="fig--title-label">Figure: </span>Rule precedence by application
                                                  plugin</span>
                                                  
                                                  <img class="image break" src="../images/ddmappplugins12_default.png" />
                                                </div>

<p class="p">For the Diameter Rule Engine functionality, when a Diameter message arrives at NCC, the rule
        engine can be invoked up to two times depending on whether the message is a Diameter Request
        or Answer: once for the scenario of a basic message type Trigger, and again for the specific
        message type Trigger. The rule engine first parses the incoming message as either a Diameter
        answer or a Diameter request message and invokes the appropriate request/answer Trigger.
        Once the generic processing is complete, NCC rule engine may be invoked again to execute the
        Trigger for the specific message type. The rule processing flow is shown in the following
        figure.</p>

<div class="fig fignone"><span class="figcap"><span class="fig--title-label">Figure: </span>Diameter rule processing flow</span>
                                                  
                                                  <img class="image break" src="../images/diarulengineflow1_default.gif" height="210" width="504" />
                                                </div>

<p class="p">When a trigger occurs, such as a message arriving at NCC, the associated set of rules from the
        profiles configured are evaluated. The rules, with access to all of the data available,
        determine the service, rating, and charging for the device, group, and account. NCC will
        then take the appropriate action as shown in the following figure.</p>

<div class="fig fignone"><span class="figcap"><span class="fig--title-label">Figure: </span>NCC rule processing flow</span>
                                                  
                                                  <img class="image break" src="../images/chargingruleflow1_default.gif" />
                                                </div>

<p class="p">Rules are organized into (potentially large) groups called Triggers. All triggers are pre-defined
        in NCC and are evaluated by the appropriate rule engine. Although you can define the
        contents of the Triggers, you cannot introduce new Triggers. </p>

<p class="p">A rule group is a set of rules associated with a trigger that may be associated with a rule system version. Each rule group contains one or more groups of conditions and associated actions. When an event happens in the system, the corresponding Trigger is invoked, and then all rule groups that belong to the Trigger are evaluated and the Rule Groups are executed in an order of precedence.</p>

<p class="p">For Charging rules, the selection of a specific Trigger is automatic by NCC depending on the
        profile you are working in and not visible to the operator that is authoring the rules.
        However, if you are provisioning with an API or configuring a rule variable, you are
        required to add the Trigger.</p>

<p class="p">A rule belongs to a rule group and is built from the options available in the rule conditions and
        actions. Triggers determine when the associated rule tables are analyzed and as message
        processing flows are executed in NCC, specific Triggers are applied.</p>

<p class="p">See the respective application user guides for more information about their specific rule engines.</p>

</div>

</div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>