<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Using new complex map versioning" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="using_complex_map_versioning" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Using new complex map versioning</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="using_complex_map_versioning">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Using new complex map versioning</h1>
<div class="body conbody">
        <p class="p">Operators can choose to use the new versioning schema of mapping tables or continue using
            the existing mapping tables APIs.</p>

        <div class="section" id="using_complex_map_versioning__section_gbz_lnt_1qb"><h2 class="title sectiontitle">Upgrade</h2>
            
            <p class="p">To use the new versioning schema, operators must run a script after the ISU or
                installation when the ISU or installation is completed. This script is located at:
                    <span class="ph filepath">/opt/tpa/sbin/ConfiguratorTranslationMappingTable.sh</span> and
                must be executed only once from any SM pod. After executing this script, some of the
                old mapping table APIs are disabled. After the upgrade, operators can Read, Delete,
                and Update the Mapping tables from the GUI. Note that for Create, Clone, Provision
                and Unprovision, GUI cannot be used. These operations must be done using the new
                APIs.</p>

        </div>

        <div class="section" id="using_complex_map_versioning__section_pjj_mnt_1qb"><h2 class="title sectiontitle">Rollback</h2>
            
            <p class="p">To rollback a post-upgrade, use the
                    <span class="ph filepath">/opt/tpa/sbin/ConfiguratorRollbackMappingTable.sh</span> script.
                This script must be executed only once from any SM pod. After executing this script,
                some of the disabled APIs are enabled again and GUI can be used to perform
                operations. </p>

            <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> The script is made for a localhost IP address. If the post-upgrade must be done on
                a specific SM pod, then change the IP address to one of these pods.</div>

        </div>

        <div class="section" id="using_complex_map_versioning__section_ggx_mnt_1qb"><h2 class="title sectiontitle">Testing upgrade and rollback</h2>
            
            <div class="p">To test upgrade, create a reference-based mapping table as follows using the SM GUI.
                    <ol class="ol" id="using_complex_map_versioning__ol_hgr_yxt_1qb">
                    <li class="li">Configure the mapping table as follows. Note that these are sample values.<div class="p">
                            <table cellpadding="4" cellspacing="0" summary="" id="using_complex_map_versioning__table_dxn_4qt_1qb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Mapping Tables</span></caption><colgroup><col style="width:50%" /><col style="width:50%" /></colgroup><thead class="thead" style="text-align:left;">
                                        <tr class="row">
                                            <th class="entry cellrowborder" style="vertical-align:top;" id="d11570e83">Parameter</th>

                                            <th class="entry cellrowborder" style="vertical-align:top;" id="d11570e86">Value</th>

                                        </tr>

                                    </thead>
<tbody class="tbody">
                                        <tr class="row">
                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e83 ">Map Name</td>

                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e86 ">RefBasedMap</td>

                                        </tr>

                                        <tr class="row">
                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e83 ">Version</td>

                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e86 ">v1</td>

                                        </tr>

                                        <tr class="row">
                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e83 ">Map Keys</td>

                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e86 ">k</td>

                                        </tr>

                                        <tr class="row">
                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e83 ">Reference Based Map</td>

                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e86 ">true</td>

                                        </tr>

                                        <tr class="row">
                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e83 ">Map Values</td>

                                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d11570e86 ">v</td>

                                        </tr>

                                    </tbody>
</table>

                        </div>
<div class="p">The map appears as
                            follows:<pre class="pre codeblock"><code><strong class="ph b">Map Name</strong>  <strong class="ph b">Version</strong>  <strong class="ph b">Keys</strong>  <strong class="ph b">Values</strong> ..
         RefBasedMap        v1             k          v</code></pre></div>
</li>

                    <li class="li">
                        <p class="p">Run the <strong class="ph b">ConfiguratorTranslationMappingTable.sh</strong> script and verify
                            that the version is removed. </p>

                        <pre class="pre codeblock"><code><strong class="ph b">Map Name</strong>  <strong class="ph b">Version</strong>  <strong class="ph b">Keys</strong>  <strong class="ph b">Values</strong> ..
         RefBasedMap                     k          v</code></pre>
                    </li>

                    <li class="li">
                        <p class="p">To test rollback, run the shell script
                                <strong class="ph b">ConfiguratorRollbackMappingTable.sh</strong> and verify that the map
                            is changed to its original state, that is, version is added back.</p>

                        <pre class="pre codeblock"><code><strong class="ph b">Map Name</strong>  <strong class="ph b">Version</strong>  <strong class="ph b">Keys</strong>  <strong class="ph b">Values</strong> ..
         RefBasedMap        v1             k          v</code></pre>
                    </li>

                </ol>
</div>

        </div>

    </div>
<div class="footer"><hr /><p>Installation and Upgrade Guide • P556766-DN1000055103-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>