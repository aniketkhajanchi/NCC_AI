<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Offline CDR generation for 5G inbound roaming" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="offline_cdr_generation_for_inbound_roaming" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Offline CDR generation for 5G inbound roaming</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="offline_cdr_generation_for_inbound_roaming">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Offline CDR generation for 5G inbound roaming</h1>
<div class="body conbody">
        <div class="section" id="offline_cdr_generation_for_inbound_roaming__section_z4b_chn_p4b">
            <p class="p">Inbound roaming refers to allowing subscribers from other operators to access the
                home network. This section provides information about the configurations required to
                allow 5G inbound roamers to home network. Rating and charging are not done for the
                inbound roamer. However, appropriate CDR is generated for the call.</p>

        </div>

        <div class="section" id="offline_cdr_generation_for_inbound_roaming__section_a5b_fjn_p4b"><h2 class="title sectiontitle">Identification of 5G inbound roamer</h2>
            
            <p class="p">For an incoming request if the device is available in NCC, then the call is processed
                as a normal call. 4G calls are rejected with error <var class="keyword varname">404 - Unknown
                    Subscriber</var>.</p>

            <p class="p">If the device is not available in NCC and the call is identified as 5G, and if the
                parameter
                    <var class="keyword varname">/pDUSessionChargingInformation/userInformation/roamerInOut</var>
                has the value <var class="keyword varname">IN_BOUND</var>, then the call is further processed on the
                basis of the application preference <em class="ph i">Support for Inbound Roaming</em>.</p>

        </div>

        <div class="section" id="offline_cdr_generation_for_inbound_roaming__section_spd_p3n_p4b"><h2 class="title sectiontitle">Application preference</h2>
            
            <p class="p">The application preference <em class="ph i">Support for Inbound Roaming</em> is used to allow, deny,
                and configure the call processing. Refer to the following table for its valid values
                and descriptions.</p>

            <table cellpadding="4" cellspacing="0" summary="" id="offline_cdr_generation_for_inbound_roaming__table_f3z_rkn_p4b" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Support for Inbound Roaming</span></caption><colgroup><col style="width:7.757951900698215%" /><col style="width:17.92086889061288%" /><col style="width:74.3211792086889%" /></colgroup><thead class="thead" style="text-align:left;">
                        <tr class="row">
                            <th class="entry cellrowborder" style="vertical-align:top;" id="d444108e83">Value</th>

                            <th class="entry cellrowborder" style="vertical-align:top;" id="d444108e86">Enabled/disabled</th>

                            <th class="entry cellrowborder" style="vertical-align:top;" id="d444108e89">Description</th>

                        </tr>

                    </thead>
<tbody class="tbody">
                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e83 ">0</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e86 ">Disabled (default)</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e89 ">The call is rejected with error <var class="keyword varname">404 - Unknown
                                    Subscriber</var>.</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e83 ">1</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e86 ">Enabled</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e89 ">A roaming agreement can be configured in a complex map (see <a class="xref" href="#offline_cdr_generation_for_inbound_roaming__section_kfc_lrn_p4b">Complex map configuration</a>). The call is processed/rejected on the basis of
                                the availability of the HPLMN ID (MCC-MNC) of the device in the
                                roaming agreement as follows:<ul class="ul" id="offline_cdr_generation_for_inbound_roaming__ul_l2r_hxs_p4b">
                                    <li class="li">Available: The call is processed.</li>

                                    <li class="li">Not available: The call is rejected with error 403. The
                                        incoming call is barred for the inbound roamer.</li>

                                </ul>
The request parameter
                                    <var class="keyword varname">/pDUSessionChargingInformation/pduSessionInformation/hPlmnId</var>
                                carries the  HPLMN ID (MCC-MNC) of the device.</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e83 ">2</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e86 ">Enabled</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e89 ">The call is processed. The roaming agreement does not matter.
                                Complex map or rule configuration is not required as described in
                                the following sections. Inbound roaming facility is enabled for all
                                inbound roamers irrespective of their HPLMN ID (MCC-MNC).</td>

                        </tr>

                        <tr class="row">
                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e83 ">3</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e86 ">Enabled</td>

                            <td class="entry cellrowborder" style="vertical-align:top;" headers="d444108e89 ">The call is processed if it is an inbound roaming call. The same
                                logic as applicable for value 2 is followed. For N40 requests where
                                the device identity is unknown and the request is not triggered by
                                inbound roaming, if the value of this parameter is set to 3, then
                                NCC generates the CDR as received in the request.<ul class="ul" id="offline_cdr_generation_for_inbound_roaming__ul_gr2_hbv_5qb">
                                    <li class="li">Command level SUCCESS result code is returned in the
                                        response message</li>

                                    <li class="li">Unknown subscriber metrics is generated</li>

                                    <li class="li">Rating is not processed</li>

                                    <li class="li">The tags corresponding to the request parameters are
                                        generated only if they are present in the request. (NCC
                                        generates the CDR only for the information present in the
                                        incoming request.)</li>

                                </ul>
</td>

                        </tr>

                    </tbody>
</table>

        </div>

        <div class="section" id="offline_cdr_generation_for_inbound_roaming__section_kfc_lrn_p4b"><h2 class="title sectiontitle">Complex map configuration</h2>
            
            <p class="p">For outbound roaming, only the MCC-MNC and roaming status are configured as key and
                values in the complex map. For inbound roaming, roaming agreement can be configured
                in the complex map as shown in the following figure.</p>

            <div class="fig fignone" id="offline_cdr_generation_for_inbound_roaming__fig_mjj_bsn_p4b">
                <img class="image break" id="offline_cdr_generation_for_inbound_roaming__image_mxd_fsn_p4b" src="../images/comp_map_inb_rom.png" />
            </div>

        </div>

        <div class="section" id="offline_cdr_generation_for_inbound_roaming__section_ejm_v24_p4b"><h2 class="title sectiontitle">Rule configuration</h2>
            
            <p class="p">In the <var class="keyword varname">GY_CREDIT_REQUEST</var> trigger, if the concatenation of MCC and
                MNC (available in HPLMN ID in the
                    <var class="keyword varname">/pDUSessionChargingInformation/pduSessionInformation/hPlmnId</var>
                parameter of the request) matches with the roaming agreement complex map, then this
                returns <var class="keyword varname">Inbound-Roaming-Agreement</var> action as
                    <var class="keyword varname">true</var>/<var class="keyword varname">false</var>. If it is
                    <var class="keyword varname">true</var>, then the call is processed and a CDR is generated for
                the call.</p>

            <div class="sectiondiv"><strong class="ph b">Rule 1</strong><p class="p">Create a rule variable, for example,
                        <var class="keyword varname">mccmnc</var> to store the concatenation of MCC and MNC if both
                    are present as shown in the following figure.</p>
<p class="p">MCC value source
                    context:</p>
<pre class="pre codeblock"><code>NCHF_CHARGING_MESSAGE.PDUSessionChargingInformation.PDUSessionInfo.hPlmnId.mcc</code></pre><div class="p">MNC
                    value source
                    context:<pre class="pre codeblock"><code>NCHF_CHARGING_MESSAGE.PDUSessionChargingInformation.PDUSessionInfo.hPlmnId.mnc</code></pre>
                </div>
<div class="fig fignone" id="offline_cdr_generation_for_inbound_roaming__fig_zlh_ml4_p4b">
                    <img class="image break" id="offline_cdr_generation_for_inbound_roaming__image_avv_nl4_p4b" height="288" src="../images/inb_roam_1.png" width="576" />
                </div>
</div>
            <div class="sectiondiv">
                <p class="p"><strong class="ph b">Rule 2</strong></p>

                <p class="p">The value of <var class="keyword varname">SESSION_PARAMETERS.Inbound-Roaming-Agreement</var> is
                    set to <var class="keyword varname">true</var> if the agreement matches. Else it is set to
                        <var class="keyword varname">false</var>.</p>

                <div class="fig fignone" id="offline_cdr_generation_for_inbound_roaming__fig_azq_1q4_p4b">
                    <img class="image break" id="offline_cdr_generation_for_inbound_roaming__image_rpj_bq4_p4b" height="288" src="../images/inb_roam_2.png" width="576" />
                </div>

            </div>
        </div>

    </div>
<div class="footer"><hr /><p>Charging User Guide • P556766-DN1000054947-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>