<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="SM/IG 3" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="Bookmark41" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>SM/IG 3</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="Bookmark41">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">SM/IG 3</h1>
<div class="body conbody">
    <ol class="ol" id="Bookmark41__ol_az4_2rj_3tb">
      <li class="li"><span class="ph">NCC</span> is at Helm revision 3.</li>

      <li class="li">Update the <span class="ph filepath">Inputs.xlsx</span> file with these values and regenerate Helm
          overrides:<ol class="ol" type="a" id="Bookmark41__ol_bz4_2rj_3tb">
          <li class="li"><span class="ph uicontrol">Deployment Type</span> = <code class="ph codeph">migrate to sso</code> in the Common
            tab's Global section. </li>

        </ol>
</li>

      <li class="li">Upgrade <span class="ph">NCC</span>. <ol class="ol" type="a" id="Bookmark41__ol_cz4_2rj_3tb">
          <li class="li">chf-routing will make Servicemanager inaccessible by returning HTTP code 503 (service
            unavailable) to all incoming traffic.</li>

          <li class="li">CGF (DR) chart(release name=dr) in case of IG system will reimport User and Role
            Management realm with SSO configurations. </li>

        </ol>
</li>

      <li class="li"><span class="ph">NCC</span> is at Helm revision 4.</li>

      <li class="li">Scale down User and Role Management pods.</li>

      <li class="li">Perform a backup of SM/IG 4 User and Role Management from the MariaDB pod.</li>

      <li class="li">Disable MariaDB replication on SM/IG 3.</li>

      <li class="li">Restore MariaDB backup taken from SM/IG 4 on all User and Role Management pods in SM/IG 3.
          <ol class="ol" type="a" id="Bookmark41__ol_dz4_2rj_3tb">
          <li class="li">After the data restore, the SM/IG 2 SSO configurations will be lost for dr-cdr realm.
          </li>

        </ol>
</li>

      <li class="li">Enable MariaDB replication on SM/IG 3.</li>

      <li class="li">Scale up User and Role Management pods.</li>

      <li class="li">Update <span class="ph filepath">Inputs.xlsx</span> with these values and regenerate Helm overrides:
          <ol class="ol" type="a" id="Bookmark41__ol_ez4_2rj_3tb">
          <li class="li">Set <span class="ph uicontrol">MariaDB Replication Enabled</span> = <code class="ph codeph">true</code> in
            SM/IG 3 tab's CKEY section.</li>

          <li class="li"><span class="ph uicontrol">Deployment Type</span> = <code class="ph codeph">in-service upgrade</code> in the
            Common tab's Global section.</li>

          <li class="li"><span class="ph uicontrol">Reimport DR realm</span> = <code class="ph codeph">true</code> in IG 3 tab's DR
            section in case of IG system.</li>

          <li class="li"><span class="ph uicontrol">Enable SSO</span> = <code class="ph codeph">true</code> in the Common tab's Global
            section. </li>

        </ol>
</li>

      <li class="li">Helm Upgrade NCC. <ol class="ol" type="a" id="Bookmark41__ol_fz4_2rj_3tb">
          <li class="li">User and Role Management will recreate Gateway to enable geo-redundant data
            replication.</li>

          <li class="li">chf-routing will make Servicemanager accessible again for incoming traffic.</li>

          <li class="li">Backup cronjobs will be enabled for User and Role Management.</li>

          <li class="li">CGF (DR) will reimport SSO data.</li>

        </ol>
</li>

      <li class="li"><span class="ph">NCC</span> is at Helm revision 5.</li>

    </ol>

    <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> 
      <ul class="ul">
        <li class="li">These items are impacted when the Servicemanager is inaccessible. <ul class="ul">
            <li class="li">All provisioning traffic.</li>

            <li class="li">Servicemanager related REST API calls.</li>

            <li class="li">Servicemanager GUI access.</li>

            <li class="li">SS7 USSD requests are impacted because of its dependence on Servicemanager's service
              name.</li>

            <li class="li">SS7 communicates with Servicemanagers through its service name since performance
              degradation happens when primary and secondary Servicemanager FQDNs are used. </li>

          </ul>
</li>

        <li class="li">When the User and Role Management GUI is down, authentication requests and all GUIs are
          inaccessible.</li>

        <li class="li">When User and Role Management is down, CGF (DR)'s dr-ui pods try to reach User and Role
          Management and crashloopback after seven failed attempts. If that happens, delete and
          recreate those dr-ui pods.</li>

        <li class="li">When <span class="ph uicontrol">Reimport DR realm</span> = <code class="ph codeph">true</code> and
            <span class="ph uicontrol">Deployment Type</span> = <code class="ph codeph">in-service upgrade</code> in the
            <span class="ph filepath">Inputs.xlsx</span> file, CGF (DR) chart (release name=dr) reupload DR
          realm to User and Role Management when an in-service upgrade is done. To avoid reimports
          in future in-service upgrades, set <span class="ph uicontrol">Reimport DR realm</span> =
            <code class="ph codeph">false</code>.</li>

        <li class="li">When <span class="ph uicontrol">Deployment Type</span> = <code class="ph codeph">in-service upgrade</code> in the
            <span class="ph filepath">Inputs.xlsx</span> file, backup cronjobs are enabled for the MariaDB for
          User and Role Management.</li>

      </ul>

    </div>

  </div>
<div class="footer"><hr /><p>Operations, Administration, and Maintenance Guide • P556766-DN1000055092-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>