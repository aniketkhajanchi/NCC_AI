<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="concept" />
<meta name="DC.title" content="Kafka topic monitoring" />
<meta name="prodname" content="Nokia Converged Charging" />
<meta name="version" content="Release 23.8" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="kafka_topic_monitoring" />
<link rel="stylesheet" type="text/css" href="../../web/css/commonltr.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/styles.min.css" />
<link rel="stylesheet" type="text/css" href="../../web/css/common-extended.css" /><title>Kafka topic monitoring</title>
<script src="../web/js/nswtc.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
<script src="../../web/css/../js/script.min.js" language="javascript" type="text/javascript">/*(◎_◎;)*/</script>
</head>
<body id="kafka_topic_monitoring">
<div class="header"><div id="feedback-link-placeholder" class="feedback-link"></div><hr /></div><h1 class="title topictitle1" id="ariaid-title1">Kafka topic monitoring</h1>
<div class="body conbody">
        <p class="p">Kafka input stream monitors the number of pending (uncollected) messages in the topic for
            the configured consumer group.</p>

        <p class="p">Inside Kafka broker, the data is stored in a topic and a topic consists of one or more
            partitions. When producing messages, the producer writes the data into a specific
            partition. As it writes data it keeps track of the last “write position” in each
            partition. This is called Latest Offset, also known as Log End Offset. Each partition
            has its own independent Latest Offset. In a similar way, each consumer keeps track of
            the the last “committed position” in each partition whose data it is consuming. This is
            called the consumer offset. If the message producing rate is higher than the consuming
            rate, a difference starts to appear between the producer and consumer offset values,
            which is called consumer lag. Kafka input stream monitors the aggregated consumer lag
            value, meaning the sum of the consumer lag values in each partition.</p>

        <p class="p">There are three threshold levels that can be defined for monitoring the consumer lag –
            high, low and clear.  These threshold levels are defined in the node parameters of CG Kafka Collector Node.</p>

        <ul class="ul" id="kafka_topic_monitoring__ul_nmb_vhc_tmb">
            <li class="li">If the consumer lag exceeds the low threshold value, a warning is raised as an early
                notification and to advise the administrator to scale out the solution by either
                increasing the number of consumer threads or increasing the number of Kafka input
                streams.</li>

            <li class="li">If the consumer lag falls below the clear threshold value (and low or high level
                thresholds were previously reached), an information message is sent out to indicate
                that the consumer lag is back to normal again, that is, within acceptable
                boundaries.</li>

            <li class="li">If the consumer lag exceed the high threshold value, an error is raised. Kafka input
                stream cannot keep up with the producer any more and scaling out is required.</li>

        </ul>

        <div class="note"><div class="notetitle"><img src="../../web/css/../images/note.svg" title="note-icon" class="noteicon" />Note:</div> Unlike with the other overload properties described in <a class="xref" href="overview_pausing_all_kafka_collection.html#SPS_CDR_Streams_Stream_Overview_pausing_all_kafka_collection">Pausing all input collection</a>, exceeding any of the thresholds does not pause the record collection.</div>

        <table cellpadding="4" cellspacing="0" summary="" id="kafka_topic_monitoring__table_tnp_kkc_tmb" class="table" frame="border" border="1" rules="all"><caption><span class="tablecap"><span class="table--title-label">Table: </span>Threshold levels</span></caption><colgroup><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /><col style="width:33.33333333333333%" /></colgroup><thead class="thead" style="text-align:left;">
                    <tr class="row">
                        <th class="entry cellrowborder" style="vertical-align:top;" id="d4026e71">Threshold level</th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d4026e74">Action when defined properties reach threshold</th>

                        <th class="entry cellrowborder" style="vertical-align:top;" id="d4026e77">Action when defined properties are back to below threshold</th>

                    </tr>

                </thead>
<tbody class="tbody">
                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e71 ">Clear</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e74 ">-</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e77 ">
                            <p class="p">Clears the alert if an alert was raised earlier for reaching Low or
                                High threshold.</p>

                        </td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e71 ">Low</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e74 ">
                            <p class="p">Raises a warning indicating that the consumer lag has exceeded the
                                threshold. Current consumer lag value is displayed.</p>

                            <p class="p">Check node parameter <code class="ph codeph">ConsumerMaxPollRecords</code> in Kafka
                                input stream and consider increasing the value.</p>

                            <p class="p">Advise to scale out the solution. For more information on scaling see
                                    <a class="xref" href="overview_scaling.html#SPS_CDR_Streams_Stream_Overview_scaling">Scaling</a>.</p>

                        </td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e77 ">-</td>

                    </tr>

                    <tr class="row">
                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e71 ">High</td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e74 ">
                            <p class="p">Raises an error indicating that the consumer lag has exceed the
                                threshold. Current consumer lag value is displayed.</p>

                            <p class="p">Check node parameter <code class="ph codeph">ConsumerMaxPollRecords</code> in Kafka
                                input stream and consider increasing the value.</p>

                            <p class="p">Advise to scale out the solution. For more information on scaling see
                                    <a class="xref" href="overview_scaling.html#SPS_CDR_Streams_Stream_Overview_scaling">Scaling</a>.</p>

                        </td>

                        <td class="entry cellrowborder" style="vertical-align:top;" headers="d4026e77 ">
                            <p class="p">-</p>

                        </td>

                    </tr>

                </tbody>
</table>

    </div>
<div class="footer"><hr /><p>Overview Guide • P556766-DN1000054925-R23.8 • 1 • <a href="../home.html">Cover</a> • ©2023 Nokia. Nokia Confidential Information • Use subject to agreed restrictions on disclosure and use.</p></div></body>
</html>